<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[æœ¬ç«™ç®€ä»‹]]></title>
      <url>/2048/10/24/%E6%9C%AC%E7%AB%99%E7%AE%80%E4%BB%8B/</url>
      <content type="html"><![CDATA[<p>è¿™é‡Œä¸»è¦æ˜¯æˆ‘è‡ªå·±å­¦ä¹ ç¬”è®°ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š</p>
<h1 id="ç®—æ³•ä¸æ•°æ®ç»“æ„">1. ç®—æ³•ä¸æ•°æ®ç»“æ„</h1><p>ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨æœ¬ç«™ç»Ÿç§°ä¸ºç®—æ³•ï¼ˆäº‹å®ä¸Šè¿˜æ˜¯å¾ˆæœ‰å¿…è¦ææ¸…ç®—æ³•å’Œæ•°æ®ç»“æ„çš„å…³ç³»ï¼‰ã€‚<a href="http://jiayi797.github.io/categories/%E7%AE%97%E6%B3%95/">ç®—æ³•åˆ†ç±»ä¼ é€é—¨</a>ï¼šä¸»è¦å›´ç»•Leetcodeä¸­çš„å„ç§é¢˜å‹æ•´ç†çš„ã€‚æ¯ç¯‡æ–‡ç« ä¹‹ä¸‹éƒ½æ˜¯ç›¸å…³æ¦‚å¿µåŠç›¸å…³é¢˜ã€‚æ€»ç»“èµ·æ¥æœ‰ä»¥ä¸‹ä¸“é¢˜ï¼š</p>
<h2 id="æ•°ç»„ä¸æ•°æ¨¡å—">1.1. æ•°ç»„ä¸æ•°æ¨¡å—</h2><ul>
<li><a href="/2017/12/11/ç®—æ³•-æ•°ç»„ä¸æ•°/" title="ç®—æ³•-æ•°ç»„ä¸æ•°">ç®—æ³•-æ•°ç»„ä¸æ•°</a>ã€‚æ•´ç†äº†æ•°ç»„ç›¸å…³çš„é¢˜ã€‚ä¸ªäººæ„Ÿè§‰æ•°ç»„éœ€è¦çš„æŠ€å·§ç›¸å¯¹å¤šä¸€äº›ã€‚æ¯”å¦‚å­æ•°ç»„ã€åŒæŒ‡é’ˆã€æ»‘åŠ¨çª—å£ç­‰ç­‰ã€‚</li>
<li><a href="/2017/11/16/Java-String/" title="Java-String">Java-String</a> ã€‚ä¹‹æ‰€ä»¥å°†Stringæ”¾å…¥æ•°ç»„ï¼Œæˆ‘æ˜¯è§‰å¾—ç”±äºstråº•å±‚å°±æ˜¯ä¸€ä¸ªcharç±»å‹çš„æ•°ç»„ã€‚</li>
<li><a href="/2017/11/24/ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾/" title="ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾">ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾</a>ã€‚äºŒåˆ†æŸ¥æ‰¾æ˜¯æœ‰åºæ•°ç»„æŸ¥æ‰¾targetçš„æœ‰åˆ©ç®—æ³•ã€‚</li>
<li><a href="/2018/01/19/ç®—æ³•-ä½æ“ä½œ/" title="ç®—æ³•-ä½æ“ä½œ">ç®—æ³•-ä½æ“ä½œ</a> ã€‚ ä½æ“ä½œå¯¹äºæŸäº›ç¨‹åºçš„ä¼˜åŒ–æ¥è¯´ï¼Œè¿˜æ˜¯èµ·ç€å¾ˆå¤§çš„ä½œç”¨ã€‚ç†è§£è®¡ç®—æœºå¤„ç†æ•°å­—çš„æ–¹å¼ï¼Œæ‰ä¼šå†™å‡ºæ›´å¥½çš„ç¨‹åºã€‚</li>
</ul>
<h2 id="åŠ¨æ€è§„åˆ’">1.2. åŠ¨æ€è§„åˆ’</h2><ul>
<li><a href="/2017/11/17/ç®—æ³•-DP/" title="ç®—æ³•-DP">ç®—æ³•-DP</a> ã€‚æœ¬æ¥åŠ¨æ€è§„åˆ’åº”è¯¥æ”¾å…¥æ•°ç»„é‡Œï¼Œå› ä¸ºDPå¾ˆå¤šéƒ½æ˜¯åº”ç”¨åœ¨æ•°ç»„é‡Œè§£å†³é‡å¤è®¡ç®—çš„é—®é¢˜ã€‚ä½†è¿™å—å¯¹æˆ‘æ¥è¯´å®åœ¨æ˜¯æœ‰ç‚¹éš¾ã€‚å› æ­¤ç‰¹æ„å¼€å‘ã€‚</li>
<li><a href="/2017/11/02/ç®—æ³•-DP-é’¢æ¡åˆ‡å‰²é—®é¢˜/" title="ç®—æ³•-DP-é’¢æ¡åˆ‡å‰²é—®é¢˜">ç®—æ³•-DP-é’¢æ¡åˆ‡å‰²é—®é¢˜</a> ã€‚ã€Šç®—æ³•å¯¼è®ºã€‹çš„åŠ¨æ€è§„åˆ’ç« èŠ‚ç¬”è®°ã€‚</li>
</ul>
<h2 id="é“¾è¡¨æ¨¡å—">1.3. é“¾è¡¨æ¨¡å—</h2><ul>
<li><a href="/2017/12/04/ç®—æ³•-é“¾è¡¨/" title="ç®—æ³•-é“¾è¡¨">ç®—æ³•-é“¾è¡¨</a>ã€‚é“¾è¡¨çš„åŸºæœ¬åŸç†å’Œæ“ä½œéå¸¸é‡è¦ï¼Œæ¯”å¦‚å¢ã€åˆ ã€åè½¬ã€åˆå¹¶ã€æ‰¾ä¸­ç‚¹ç­‰ç­‰ã€‚æ¶‰åŠåˆ°çš„æŠ€å·§ä¸å¤šï¼Œå¤§æ¦‚å°±æ˜¯dummy Nodeå’Œå¿«æ…¢æŒ‡é’ˆï¼Œä¸ªäººè§‰å¾—å…¶ç»ˆæåŸåˆ™å°±æ˜¯é“¾è¡¨è¿™ä¸ªæ•°æ®ç»“æ„çš„å½¢å¼ï¼Œä»¥åŠè¿™ä¸ªå½¢å¼é€ æˆäº†å“ªäº›ä¼˜ç¼ºç‚¹ã€‚</li>
</ul>
<h2 id="æ ‘æ¨¡å—">1.4. æ ‘æ¨¡å—</h2><ul>
<li><a href="/2017/11/28/ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»/" title="ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»">ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»</a> ã€‚æ ‘ä¸Šé¢çš„å¾ˆå¤šä¸œè¥¿ä¸é“¾è¡¨å¾ˆç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½ä¸èƒ½è®¿é—®å®ƒå‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰ã€‚è€Œæ ‘çš„å‰ä¸­åéå†ä½“ç°äº†DFSçš„æ€æƒ³ï¼Œå±‚åºéå†ä½“ç°äº†BFSçš„æ€æƒ³ï¼Œè¿™ä¸¤ä¸ªéƒ½æ˜¯æ ‘çš„æœç´¢é—®é¢˜ã€‚å½“ç„¶åœ¨äºŒå‰æ ‘é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªåˆ†æ²»çš„æ€æƒ³ï¼Œå°†å¤§é—®é¢˜åˆ†è§£ä¸ºä¸ç›¸å¹²çš„å­é—®é¢˜ï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚</li>
<li><a href="/2017/11/03/ç®—æ³•-å †/" title="ç®—æ³•-å †">ç®—æ³•-å †</a> ã€‚å †ï¼Œä¹Ÿå°±æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæˆ‘çš„ç†è§£ï¼Œå®ƒæ˜¯æ ‘ä¸ªç»“æ„ï¼Œå§‹ç»ˆç»´æŠ¤æ ‘é¡¶ä¸ºæå€¼ã€‚</li>
<li><a href="/2017/11/13/ç®—æ³•-Trieæ ‘/" title="ç®—æ³•-Trieæ ‘">ç®—æ³•-Trieæ ‘</a> ã€‚ ç”¨æ ‘çŠ¶ç»“æ„è¡¨ç¤ºå¾ˆå¤šä¸ªå•è¯ï¼Œä»¥æ­¤åŠ é€Ÿå•è¯çš„æœç´¢ã€‚æˆ‘æƒ³é‡‡ç”¨æ­¤ç»“æ„çš„åŸå› åœ¨äºå•è¯ä¸­çš„å­—æ¯åªæœ‰26ä¸ªï¼Œæ•°åˆ†æ”¯è¾ƒå°‘ã€‚å¦‚æœæ˜¯ä¸­æ–‡çš„è¯ææ€•æƒ…å†µå°±ä¸é‚£ä¹ˆä¹è§‚äº†ã€‚ï¼ˆä½†è¿™ä»…ä»…æ˜¯ä¸ªäººçŒœæµ‹ï¼Œå¾…éªŒè¯ï¼‰</li>
<li><a href="/2018/01/23/ç®—æ³•-çº¿æ®µæ ‘/" title="ç®—æ³•-çº¿æ®µæ ‘">ç®—æ³•-çº¿æ®µæ ‘</a> ã€‚ä»‹ç»äº†çº¿æ®µæ ‘çš„æ¦‚å¿µå’Œä¸€é“ç»å…¸é¢˜ç›®</li>
</ul>
<h2 id="å›¾æ¨¡å—">1.5. å›¾æ¨¡å—</h2><ul>
<li><a href="/2017/11/21/ç®—æ³•-DFS/" title="ç®—æ³•-DFS">ç®—æ³•-DFS</a> ã€‚æ·±åº¦ä¼˜å…ˆéå†çœ‹ä¼¼ç®€å•ï¼Œä½†äº‹å®ä¸Šå†™èµ·ç¨‹åºæ¥è¿˜æ˜¯æœ‰ç‚¹æ£˜æ‰‹çš„ã€‚å› ä¸ºæ¯é“é¢˜çš„è¾¹ç•Œæ¡ä»¶ä¸åŒï¼Œç»†èŠ‚ä¹‹å¤„å°±ä¸åŒäº†ã€‚</li>
<li><a href="/2017/12/21/ç®—æ³•-å›æº¯æ³•/" title="ç®—æ³•-å›æº¯æ³•">ç®—æ³•-å›æº¯æ³•</a> ã€‚ å›æº¯æ³•æ˜¯ä¸€ç§é€‰ä¼˜æœç´¢æ³•ï¼Œä¸€èˆ¬ä¸DFSè”åˆä½¿ç”¨ã€‚ç»å…¸çš„å…«çš‡åé—®é¢˜éå¸¸å¥½åœ°è¯ é‡Šäº†å›æº¯æ³•ã€‚</li>
<li><a href="/2017/11/05/ç®—æ³•-å¹¶æŸ¥é›†/" title="ç®—æ³•-å¹¶æŸ¥é›†">ç®—æ³•-å¹¶æŸ¥é›†</a> ã€‚ å¹¶æŸ¥é›†éå¸¸é€‚ç”¨äºè§£å†³åŠ¨æ€è¿é€šæ€§çš„é—®é¢˜ã€‚å¦‚æœå›¾æ˜¯é™æ€çš„ï¼Œå…¶å®DFSæ›´å¿«ä¸€äº›ã€‚</li>
<li><a href="/2018/01/11/ç®—æ³•-å›¾/" title="ç®—æ³•-å›¾">ç®—æ³•-å›¾</a> ã€‚æ ‘å…¶å®æ˜¯ä¸€ç§æœ‰å¼ºçº¦æŸçš„å›¾ã€‚è€Œå›¾é‡Œç®—æ³•éå¸¸å¤šï¼Œæˆªæ­¢ç°åœ¨è¿™ç¯‡æ–‡ç« æ¶‰åŠåˆ°çš„åªæœ‰æ‹“æ‰‘æ’åºã€‚</li>
<li><a href="/2017/03/23/ç®—æ³•-å•æºæœ€çŸ­è·¯å¾„é—®é¢˜/" title="ç®—æ³•-å•æºæœ€çŸ­è·¯å¾„é—®é¢˜">ç®—æ³•-å•æºæœ€çŸ­è·¯å¾„é—®é¢˜</a> ã€‚æ—©æœŸçš„æ–‡ç« ã€‚</li>
<li><a href="/2017/03/26/ç®—æ³•-æœ€å°ç”Ÿæˆæ ‘ç®—æ³•/" title="ç®—æ³•-æœ€å°ç”Ÿæˆæ ‘ç®—æ³•">ç®—æ³•-æœ€å°ç”Ÿæˆæ ‘ç®—æ³•</a> ã€‚è¿™ç¯‡æ–‡ç« å†™å¾—æ¯”è¾ƒæ—©äº†ã€‚ç®€å•åœ°æè¿°äº†æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ã€‚</li>
</ul>
<h2 id="æ•£åˆ—è¡¨">1.6. æ•£åˆ—è¡¨</h2><ul>
<li><a href="/2018/01/14/Java-HashMapçš„åŸç†æ¢ç©¶/" title="Java-HashMapçš„åŸç†æ¢ç©¶">Java-HashMapçš„åŸç†æ¢ç©¶</a> ã€‚å¯¹Javaä¸­HashMapçš„å®ç°è¿›è¡Œäº†ç®€å•çš„æ•´ç†ã€‚</li>
<li><a href="/2018/01/28/Java-HashtableåŸç†æ¢ç©¶/" title="Java-HashtableåŸç†æ¢ç©¶">Java-HashtableåŸç†æ¢ç©¶</a> </li>
<li><a href="/2018/01/29/Java-LinkedHashMapåŸç†æ¢ç©¶/" title="Java-LinkedHashMapåŸç†æ¢ç©¶">Java-LinkedHashMapåŸç†æ¢ç©¶</a> </li>
<li><a href="/2017/12/25/ç®—æ³•-å¸¸è§æ•°æ®ç»“æ„/" title="ç®—æ³•-å¸¸è§æ•°æ®ç»“æ„">ç®—æ³•-å¸¸è§æ•°æ®ç»“æ„</a> ã€‚è¿™ç¯‡æ–‡ç« æ•´ç†äº†å‡ é“æˆ‘è‡ªå·±è®¤ä¸ºè¾ƒå¤æ‚çš„Hashç›¸å…³é¢˜ã€‚</li>
</ul>
<h1 id="ç³»ç»Ÿè®¾è®¡">2. ç³»ç»Ÿè®¾è®¡</h1><p>ç³»ç»Ÿè®¾è®¡è¿™é‡Œå‘æ¯”è¾ƒå¤§ã€‚</p>
<ul>
<li><a href="/2018/01/15/ç³»ç»Ÿè®¾è®¡-æ–°é²œäº‹ç³»ç»Ÿ/" title="ç³»ç»Ÿè®¾è®¡-æ–°é²œäº‹ç³»ç»Ÿ">ç³»ç»Ÿè®¾è®¡-æ–°é²œäº‹ç³»ç»Ÿ</a> </li>
<li><a href="/2018/01/21/ç³»ç»Ÿè®¾è®¡-è®¾è®¡Uber/" title="ç³»ç»Ÿè®¾è®¡-è®¾è®¡Uber">ç³»ç»Ÿè®¾è®¡-è®¾è®¡Uber</a> </li>
<li><a href="/2018/01/27/ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•/" title="ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•">ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•</a> 
</li>
</ul>
<h1 id="Java">3. Java</h1><p>å¾…å¡«å‘</p>
<h1 id="æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ">4. æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ </h1><h2 id="æœºå™¨å­¦ä¹ åŸºç¡€">4.1. æœºå™¨å­¦ä¹ åŸºç¡€</h2><p>åŸºç¡€çš„æ¨¡å‹ä¸»è¦äº†è§£äº†ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯çº¿æ€§æ¨¡å‹ï¼Œä¸€ä¸ªæ˜¯æ ‘æ¨¡å‹ã€‚</p>
<h3 id="çº¿æ€§æ¨¡å‹">4.1.1. çº¿æ€§æ¨¡å‹</h3><ul>
<li><a href="/2017/02/28/æœºå™¨å­¦ä¹ ç®—æ³•-PLA-çº¿æ€§æ„ŸçŸ¥æœº/" title="æœºå™¨å­¦ä¹ ç®—æ³•-PLA-çº¿æ€§æ„ŸçŸ¥æœº">æœºå™¨å­¦ä¹ ç®—æ³•-PLA-çº¿æ€§æ„ŸçŸ¥æœº</a>  </li>
<li><a href="/2017/03/02/æœºå™¨å­¦ä¹ ç®—æ³•-LR/" title="æœºå™¨å­¦ä¹ ç®—æ³•-LR">æœºå™¨å­¦ä¹ ç®—æ³•-LR</a>  </li>
<li><a href="/2017/03/03/æœºå™¨å­¦ä¹ ç®—æ³•-SVM/" title="æœºå™¨å­¦ä¹ ç®—æ³•-SVM">æœºå™¨å­¦ä¹ ç®—æ³•-SVM</a>  </li>
<li>â€‹</li>
</ul>
<h3 id="æå‡æ–¹æ³•">4.1.2. æå‡æ–¹æ³•</h3><ul>
<li><a href="/2017/03/04/æœºå™¨å­¦ä¹ ç®—æ³•-boostingå’Œbagging/" title="æœºå™¨å­¦ä¹ ç®—æ³•-boostingå’Œbagging">æœºå™¨å­¦ä¹ ç®—æ³•-boostingå’Œbagging</a>  </li>
<li><a href="/2017/03/05/æœºå™¨å­¦ä¹ ç®—æ³•-AdaBoost/" title="æœºå™¨å­¦ä¹ ç®—æ³•-AdaBoost">æœºå™¨å­¦ä¹ ç®—æ³•-AdaBoost</a>  
</li>
</ul>
<h3 id="æå‡æ ‘">4.1.3. æå‡æ ‘</h3><h1 id="ç«èµ›">5. ç«èµ›</h1><p>å¾…å¡«å‘</p>
<p>===========================================================</p>
<p>è·¯æ¼«æ¼«å…¶æ‚ è¿œå…®ï¼Œå¾å°†ä¸Šå®¶è€Œæ±‚ç´¢ã€‚</p>
<p>===========================================================</p>
<a id="more"></a>]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-LinkedHashMapåŸç†æ¢ç©¶]]></title>
      <url>/2018/01/29/Java-LinkedHashMap%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/</url>
      <content type="html"><![CDATA[<p>åœ¨ä¹‹å‰çš„ <a href="/2018/01/27/ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•/" title="ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•">ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•</a>  ä¸€æ–‡é‡Œæˆ‘ç”¨åˆ°äº†LinkedHashMapã€‚è¿™æ˜¯æœ€è¿‘åˆšæ¥è§¦åˆ°çš„ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ã€‚åœ¨æ­¤è¿›è¡ŒåŸç†çš„æ¢ç©¶ã€‚</p>
<p>LinkedHashMap æ˜¯ HashMap çš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒ<strong>ä¿ç•™æ’å…¥çš„é¡ºåº</strong>ï¼Œå¦‚æœéœ€è¦è¾“å‡ºçš„é¡ºåºå’Œè¾“å…¥æ—¶çš„ç›¸åŒï¼Œé‚£ä¹ˆå°±é€‰ç”¨ LinkedHashMapã€‚</p>
<p>LinkedHashMap å®ç°ä¸ HashMap çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒLinkedHashMap ç»´æŠ¤ç€ä¸€ä¸ªè¿è¡Œäºæ‰€æœ‰æ¡ç›®çš„åŒé‡é“¾æ¥åˆ—è¡¨ã€‚æ­¤é“¾æ¥åˆ—è¡¨å®šä¹‰äº†è¿­ä»£é¡ºåºï¼Œè¯¥è¿­ä»£é¡ºåºå¯ä»¥æ˜¯æ’å…¥é¡ºåºæˆ–è€…æ˜¯è®¿é—®é¡ºåºã€‚</p>
<p>æ³¨æ„ï¼Œæ­¤å®ç°ä¸æ˜¯åŒæ­¥çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®é“¾æ¥çš„å“ˆå¸Œæ˜ å°„ï¼Œè€Œå…¶ä¸­è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ä»ç»“æ„ä¸Šä¿®æ”¹äº†è¯¥æ˜ å°„ï¼Œåˆ™å®ƒå¿…é¡»ä¿æŒå¤–éƒ¨åŒæ­¥ã€‚</p>
<p>æ ¹æ®é“¾è¡¨ä¸­å…ƒç´ çš„é¡ºåºå¯ä»¥åˆ†ä¸ºï¼šæŒ‰æ’å…¥é¡ºåºçš„é“¾è¡¨ï¼Œå’ŒæŒ‰è®¿é—®é¡ºåº(è°ƒç”¨ get æ–¹æ³•)çš„é“¾è¡¨ã€‚é»˜è®¤æ˜¯æŒ‰æ’å…¥é¡ºåºæ’åºï¼Œå¦‚æœæŒ‡å®šæŒ‰è®¿é—®é¡ºåºæ’åºï¼Œé‚£ä¹ˆè°ƒç”¨getæ–¹æ³•åï¼Œä¼šå°†è¿™æ¬¡è®¿é—®çš„å…ƒç´ ç§»è‡³é“¾è¡¨å°¾éƒ¨ï¼Œä¸æ–­è®¿é—®å¯ä»¥å½¢æˆæŒ‰è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚</p>
<a id="more"></a>
<p><strong>Demo1ï¼šæŒ‰ç…§æ’å…¥é¡ºåº</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</div><div class="line"></div><div class="line">map.put(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">map.put(<span class="number">2</span>,<span class="number">2</span>);</div><div class="line">map.put(<span class="number">3</span>,<span class="number">3</span>);</div><div class="line"></div><div class="line">Iterator iter = map.entrySet().iterator();</div><div class="line"><span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">  Map.Entry entry = (Map.Entry) iter.next();</div><div class="line">  System.out.println(entry.getKey() + <span class="string">"="</span> + entry.getValue());</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">è¾“å‡ºï¼š</div><div class="line"></div><div class="line"><span class="number">1</span>=<span class="number">1</span></div><div class="line"><span class="number">2</span>=<span class="number">2</span></div><div class="line"><span class="number">3</span>=<span class="number">3</span> <span class="comment">// æœ€è¿‘æ’å…¥çš„å…ƒç´ æœ€åå‡ºæ¥</span></div></pre></td></tr></table></figure>
<p><strong>Demo2ï¼šæŒ‰ç…§æ’å…¥ã€è®¿é—®é¡ºåº</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;(capacity, <span class="number">0.75f</span>, <span class="keyword">true</span>); <span class="comment">// æ³¨æ„è¿™ä¸ªtrue</span></div><div class="line"></div><div class="line">map.put(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">map.put(<span class="number">2</span>,<span class="number">2</span>);</div><div class="line">map.put(<span class="number">3</span>,<span class="number">3</span>);</div><div class="line"></div><div class="line">map.get(<span class="number">1</span>);</div><div class="line"></div><div class="line">Iterator iter = map.entrySet().iterator();</div><div class="line"><span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">  Map.Entry entry = (Map.Entry) iter.next();</div><div class="line">  System.out.println(entry.getKey() + <span class="string">"="</span> + entry.getValue());</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">è¾“å‡ºï¼š</div><div class="line"></div><div class="line"><span class="number">2</span>=<span class="number">2</span></div><div class="line"><span class="number">3</span>=<span class="number">3</span></div><div class="line"><span class="number">1</span>=<span class="number">1</span> <span class="comment">// æœ€è¿‘è®¿é—®çš„å…ƒç´ æœ€åå‡ºæ¥</span></div></pre></td></tr></table></figure>
<h1 id="LinkedHashMapå®ç°">1. LinkedHashMapå®ç°</h1><p>å¯¹äº LinkedHashMap è€Œè¨€ï¼Œå®ƒç»§æ‰¿ä¸ HashMap(<code>public class LinkedHashMap&lt;K,V&gt; extends HashMap&lt;K,V&gt; implements Map&lt;K,V&gt;</code>)ã€åº•å±‚ä½¿ç”¨å“ˆå¸Œè¡¨ä¸åŒå‘é“¾è¡¨æ¥ä¿å­˜æ‰€æœ‰å…ƒç´ ã€‚å…¶åŸºæœ¬æ“ä½œä¸çˆ¶ç±» HashMap ç›¸ä¼¼ï¼Œå®ƒé€šè¿‡é‡å†™çˆ¶ç±»ç›¸å…³çš„æ–¹æ³•ï¼Œæ¥å®ç°è‡ªå·±çš„é“¾æ¥åˆ—è¡¨ç‰¹æ€§ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æ LinkedHashMap çš„æºä»£ç ã€‚</p>
<h1 id="æˆå‘˜å˜é‡">2. æˆå‘˜å˜é‡</h1><p>LinkedHashMap é‡‡ç”¨çš„ hash ç®—æ³•å’Œ HashMap ç›¸åŒï¼Œä½†æ˜¯å®ƒé‡æ–°å®šä¹‰äº†æ•°ç»„ä¸­ä¿å­˜çš„å…ƒç´  Entryï¼Œè¯¥ Entry é™¤äº†ä¿å­˜å½“å‰å¯¹è±¡çš„å¼•ç”¨å¤–ï¼Œè¿˜ä¿å­˜äº†å…¶ä¸Šä¸€ä¸ªå…ƒç´  before å’Œä¸‹ä¸€ä¸ªå…ƒç´  after çš„å¼•ç”¨ï¼Œä»è€Œåœ¨å“ˆå¸Œè¡¨çš„åŸºç¡€ä¸Šåˆæ„æˆäº†åŒå‘é“¾æ¥åˆ—è¡¨ã€‚çœ‹æºä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* The iteration ordering method for this linked hash map: &lt;tt&gt;true&lt;/tt&gt;</div><div class="line">* for access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order.</div><div class="line">* å¦‚æœä¸ºtrueï¼Œåˆ™æŒ‰ç…§è®¿é—®é¡ºåºï¼›å¦‚æœä¸ºfalseï¼Œåˆ™æŒ‰ç…§æ’å…¥é¡ºåºã€‚</div><div class="line">*/</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> accessOrder;</div><div class="line"><span class="comment">/**</span></div><div class="line">* åŒå‘é“¾è¡¨çš„è¡¨å¤´å…ƒç´ ã€‚</div><div class="line"> */</div><div class="line"><span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt; header;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* LinkedHashMapçš„Entryå…ƒç´ ã€‚</div><div class="line">* ç»§æ‰¿HashMapçš„Entryå…ƒç´ ï¼Œåˆä¿å­˜äº†å…¶ä¸Šä¸€ä¸ªå…ƒç´ beforeå’Œä¸‹ä¸€ä¸ªå…ƒç´ afterçš„å¼•ç”¨ã€‚</div><div class="line"> */</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">HashMap</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</div><div class="line">    Entry&lt;K,V&gt; before, after;</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>LinkedHashMap ä¸­çš„ Entry é›†æˆäº HashMap çš„ Entryï¼Œä½†æ˜¯å…¶å¢åŠ äº† before å’Œ after çš„å¼•ç”¨ï¼ŒæŒ‡çš„æ˜¯ä¸Šä¸€ä¸ªå…ƒç´ å’Œä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ã€‚</p>
<h1 id="åˆå§‹åŒ–">3. åˆå§‹åŒ–</h1><p>é€šè¿‡æºä»£ç å¯ä»¥çœ‹å‡ºï¼Œåœ¨ LinkedHashMap çš„æ„é€ æ–¹æ³•ä¸­ï¼Œå®é™…è°ƒç”¨äº†çˆ¶ç±» HashMap çš„ç›¸å…³æ„é€ æ–¹æ³•æ¥æ„é€ ä¸€ä¸ªåº•å±‚å­˜æ”¾çš„ table æ•°ç»„ï¼Œä½†é¢å¤–å¯ä»¥å¢åŠ  accessOrder è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤ä¸º falseï¼Œä»£è¡¨æŒ‰ç…§æ’å…¥é¡ºåºè¿›è¡Œè¿­ä»£ï¼›å½“ç„¶å¯ä»¥æ˜¾å¼è®¾ç½®ä¸º trueï¼Œä»£è¡¨ä»¥è®¿é—®é¡ºåºè¿›è¡Œè¿­ä»£ã€‚å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor,<span class="keyword">boolean</span> accessOrder)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(initialCapacity, loadFactor);</div><div class="line">    <span class="keyword">this</span>.accessOrder = accessOrder;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“ LinkedHashMap çš„ Entry å…ƒç´ ç»§æ‰¿ HashMap çš„ Entryï¼Œæä¾›äº†åŒå‘é“¾è¡¨çš„åŠŸèƒ½ã€‚åœ¨ä¸Šè¿° HashMap çš„æ„é€ å™¨ä¸­ï¼Œæœ€åä¼šè°ƒç”¨ init() æ–¹æ³•ï¼Œè¿›è¡Œç›¸å…³çš„åˆå§‹åŒ–ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ HashMap çš„å®ç°ä¸­å¹¶æ— æ„ä¹‰ï¼Œåªæ˜¯æä¾›ç»™å­ç±»å®ç°ç›¸å…³çš„åˆå§‹åŒ–è°ƒç”¨ã€‚</p>
<p>ä½†åœ¨ LinkedHashMap é‡å†™äº† init() æ–¹æ³•ï¼Œåœ¨è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•å®Œæˆæ„é€ åï¼Œè¿›ä¸€æ­¥å®ç°äº†å¯¹å…¶å…ƒç´  Entry çš„åˆå§‹åŒ–æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Called by superclass constructors and pseudoconstructors (clone,</div><div class="line">* readObject) before any entries are inserted into the map.  Initializes</div><div class="line">* the chain.</div><div class="line">*/</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">  header = <span class="keyword">new</span> Entry&lt;&gt;(-<span class="number">1</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">  header.before = header.after = header;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="putæ–¹æ³•">4. putæ–¹æ³•</h1><p>LinkedHashMap å¹¶æœªé‡å†™çˆ¶ç±» HashMap çš„ put æ–¹æ³•ï¼Œè€Œæ˜¯é‡å†™äº†çˆ¶ç±» HashMap çš„ put æ–¹æ³•è°ƒç”¨çš„å­æ–¹æ³•:<br><code>void recordAccess(HashMap m)</code><br><code>void addEntry(int hash, K key, V value, int bucketIndex)</code><br><code>void createEntry(int hash, K key, V value, int bucketIndex)</code><br>æä¾›äº†è‡ªå·±ç‰¹æœ‰çš„åŒå‘é“¾æ¥åˆ—è¡¨çš„å®ç°ã€‚æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­å·²ç»è®²è§£äº†HashMapçš„putæ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé‡æ–°è´´ä¸€ä¸‹ HashMap çš„ put æ–¹æ³•çš„æºä»£ç ï¼š</p>
<p>HashMap put ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. è®¡ç®—keyçš„hashCodeå€¼ã€‚å…¶ç›®çš„æ˜¯ä¸ºäº†å°½å¯èƒ½çš„è®©é”®å€¼å¯¹å¯ä»¥åˆ†ä¸åˆ°ä¸åŒçš„æ¡¶ä¸­</div><div class="line"><span class="number">2</span>. æ ¹æ®hashCodeå¾—åˆ°åœ¨tableä¸­çš„ç´¢å¼•i</div><div class="line"><span class="number">3</span>. å°†valueæ’å…¥åˆ°tableä¸­ï¼š</div><div class="line">	<span class="number">3.1</span> å¦‚æœtable[i]ä¸ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸¤ä¸ªkeyçš„hashå€¼é‡å äº†ã€‚é‚£å°±æ ¹æ®keyå°†å€¼æ’å…¥table[i]æŒ‡å‘çš„é“¾è¡¨ä¸­ï¼š</div><div class="line">		<span class="number">3.1</span>.1 è¦ä¹ˆè¦†ç›–åŸæ¥çš„å€¼ï¼ˆæ›¾ç»æœ‰è¿‡è¿™ä¸ªkeyï¼‰</div><div class="line">		<span class="number">3.1</span>.2 è¦ä¹ˆæ’å…¥é“¾è¡¨æœ«å°¾ï¼ˆæ›¾ç»æ²¡æœ‰è¿‡è¿™ä¸ªkeyï¼‰ â€“&gt; è°ƒç”¨addEntry()</div><div class="line">	<span class="number">3.2</span> å¦‚æœtable[i]ä¸ºç©ºï¼Œå°±ç›´æ¥æ’å…¥ â€“&gt; è°ƒç”¨addEntry()</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> putForNullKey(value);</div><div class="line">        <span class="keyword">int</span> hash = hash(key); <span class="comment">// è·å–hashå€¼</span></div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length); <span class="comment">// è·å–tableé‡Œçš„ç´¢å¼•</span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="keyword">null</span>; e = e.next) &#123; <span class="comment">// éå†table[i]çš„æ¯ä¸ªå€¼</span></div><div class="line">            Object k;</div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123; <span class="comment">// è¦†ç›–åŸæ¥çš„</span></div><div class="line">                V oldValue = e.value;</div><div class="line">                e.value = value;</div><div class="line">                e.recordAccess(<span class="keyword">this</span>); <span class="comment">// åœ¨linkedHashMapä¸­é‡å†™</span></div><div class="line">                <span class="keyword">return</span> oldValue;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        modCount++;</div><div class="line">        addEntry(hash, key, value, i); <span class="comment">// åœ¨linkedHashMapä¸­é‡å†™</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‡å†™æ–¹æ³•ï¼š</p>
<p>LinkedHashMapå°†æœ€æ–°æ·»åŠ çš„å…ƒç´ ä¿æŒåœ¨é“¾è¡¨headerã€‚ä¹Ÿå°±æ˜¯å½“æ–°å»ºä¸€ä¸ªentryèŠ‚ç‚¹æ—¶ï¼Œå°†entryåŠ å…¥åˆ°é“¾è¡¨å¤´éƒ¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * This method is invoked by the superclass whenever the value</div><div class="line">     * of a pre-existing entry is read by Map.get or modified by Map.set.</div><div class="line">     * If the enclosing Map is access-ordered, it moves the entry</div><div class="line">     * to the end of the list; otherwise, it does nothing.</div><div class="line">     */</div><div class="line"><span class="comment">//è®°å½•è®¿é—®é¡ºåº</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;</div><div class="line">    LinkedHashMap&lt;K,V&gt; lm = (LinkedHashMap&lt;K,V&gt;)m;</div><div class="line">    <span class="keyword">if</span> (lm.accessOrder) &#123;</div><div class="line">        lm.modCount++;</div><div class="line">        remove();</div><div class="line">        addBefore(lm.header); <span class="comment">// å°†å½“å‰è®¿é—®çš„å¯¹è±¡æ’å…¥åˆ°headerä¹‹å‰</span></div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</div><div class="line">    <span class="comment">// è°ƒç”¨createæ–¹æ³•ï¼Œå°†æ–°å…ƒç´ ä»¥åŒå‘é“¾è¡¨çš„çš„å½¢å¼åŠ å…¥åˆ°æ˜ å°„ä¸­ã€‚</span></div><div class="line">    createEntry(hash, key, value, bucketIndex);</div><div class="line"></div><div class="line">    <span class="comment">// åˆ é™¤eldestå…ƒç´ </span></div><div class="line">    Entry&lt;K,V&gt; eldest = header.after;</div><div class="line">  	<span class="comment">//å¦‚æœæœ‰å¿…è¦ç§»é™¤æœ€è€çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ç§»é™¤ã€‚LinkedHashMapé»˜è®¤removeEldestEntryæ€»æ˜¯è¿”å›false</span></div><div class="line">    <span class="comment">//ä¹Ÿå°±æ˜¯è¿™é‡Œifé‡Œé¢çš„è¯­å¥æ°¸è¿œä¸ä¼šæ‰§è¡Œ</span></div><div class="line">    <span class="comment">//è¿™é‡ŒremoveEldestEntryä¸»è¦æ˜¯ç»™LinkedHashMapçš„å­ç±»ç•™ä¸‹çš„ä¸€ä¸ªé’©å­</span></div><div class="line">    <span class="comment">//å­ç±»å®Œå…¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦é‡å†™removeEldestEntryï¼Œåé¢æˆ‘ä¼šä¸¾ä¸ªç°å®ä¸­çš„ä¾‹å­ğŸŒ°</span></div><div class="line">    <span class="keyword">if</span> (removeEldestEntry(eldest)) &#123;</div><div class="line">        removeEntryForKey(eldest.key);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (size &gt;= threshold)</div><div class="line">            resize(<span class="number">2</span> * table.length);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// åœ¨æ–°å»ºèŠ‚ç‚¹ä¹‹åè°ƒç”¨ addBefore æ–¹æ³•å°†æ–°æ·»åŠ çš„èŠ‚ç‚¹æ”¾åœ¨headerä¹‹å‰</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">createEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</div><div class="line">    HashMap.Entry&lt;K,V&gt; old = table[bucketIndex];</div><div class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> Entry&lt;K,V&gt;(hash, key, value, old);</div><div class="line">    table[bucketIndex] = e;</div><div class="line">    <span class="comment">// è°ƒç”¨å…ƒç´ çš„addBreforeæ–¹æ³•ï¼Œå°†å…ƒç´ eåŠ å…¥åˆ°headerä¹‹å‰</span></div><div class="line">    e.addBefore(header);</div><div class="line">    size++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* Inserts this entry before the specified existing entry in the list.</div><div class="line">*/</div><div class="line"><span class="comment">// å°†thisæ·»åŠ åˆ°existingEntryä¹‹å‰</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addBefore</span><span class="params">(Entry&lt;K,V&gt; existingEntry)</span> </span>&#123;</div><div class="line">    after  = existingEntry;</div><div class="line">    before = existingEntry.before;</div><div class="line">    before.after = <span class="keyword">this</span>;</div><div class="line">    after.before = <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* Removes this entry from the linked list.</div><div class="line"> */</div><div class="line"><span class="comment">//åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œéœ€è¦æŠŠ</span></div><div class="line"><span class="comment">//1. å‰ç»§èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆ æŒ‡å‘ è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹</span></div><div class="line"><span class="comment">//2. åç»§èŠ‚ç‚¹çš„å‰ç»§æŒ‡é’ˆ æŒ‡å‘ è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ç»§èŠ‚ç‚¹</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</div><div class="line">  before.after = after;</div><div class="line">  after.before = before;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">removeEldestEntry</span><span class="params">(Map.Entry&lt;K,V&gt; eldest)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="getæ–¹æ³•">5. getæ–¹æ³•</h1><p>LinkedHashMap é‡å†™äº†çˆ¶ç±» HashMap çš„ get æ–¹æ³•ï¼Œå®é™…åœ¨è°ƒç”¨çˆ¶ç±» getEntry() æ–¹æ³•å–å¾—æŸ¥æ‰¾çš„å…ƒç´ åï¼Œå†åˆ¤æ–­å½“æ’åºæ¨¡å¼ accessOrder ä¸º true æ—¶ï¼Œè®°å½•è®¿é—®é¡ºåºï¼Œ<strong>å°†æœ€æ–°è®¿é—®çš„å…ƒç´ æ·»åŠ åˆ°åŒå‘é“¾è¡¨çš„è¡¨å¤´ï¼Œå¹¶ä»åŸæ¥çš„ä½ç½®åˆ é™¤</strong>ã€‚ç”±äºçš„é“¾è¡¨çš„å¢åŠ ã€åˆ é™¤æ“ä½œæ˜¯å¸¸é‡çº§çš„ï¼Œæ•…å¹¶ä¸ä¼šå¸¦æ¥æ€§èƒ½çš„æŸå¤±ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</div><div class="line">    <span class="comment">// è°ƒç”¨çˆ¶ç±»HashMapçš„getEntry()æ–¹æ³•ï¼Œå–å¾—è¦æŸ¥æ‰¾çš„å…ƒç´ ã€‚</span></div><div class="line">    Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;)getEntry(key);</div><div class="line">    <span class="keyword">if</span> (e == <span class="keyword">null</span>)</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    <span class="comment">// è®°å½•è®¿é—®é¡ºåºã€‚</span></div><div class="line">    e.recordAccess(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">return</span> e.value;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è®°å½•è®¿é—®é¡ºåº</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;</div><div class="line">    LinkedHashMap&lt;K,V&gt; lm = (LinkedHashMap&lt;K,V&gt;)m;</div><div class="line">    <span class="comment">// å¦‚æœå®šä¹‰äº†LinkedHashMapçš„è¿­ä»£é¡ºåºä¸ºè®¿é—®é¡ºåºï¼Œ</span></div><div class="line">    <span class="comment">// åˆ™åˆ é™¤ä»¥å‰ä½ç½®ä¸Šçš„å…ƒç´ ï¼Œå¹¶å°†æœ€æ–°è®¿é—®çš„å…ƒç´ æ·»åŠ åˆ°é“¾è¡¨è¡¨å¤´ã€‚  </span></div><div class="line">    <span class="keyword">if</span> (lm.accessOrder) &#123;</div><div class="line">        lm.modCount++;</div><div class="line">        remove();</div><div class="line">        addBefore(lm.header);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* Removes this entry from the linked list.</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</div><div class="line">    before.after = after;</div><div class="line">    after.before = before;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**clearé“¾è¡¨ï¼Œè®¾ç½®headerä¸ºåˆå§‹çŠ¶æ€*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line"> <span class="keyword">super</span>.clear();</div><div class="line"> header.before = header.after = header;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æ’åºæ¨¡å¼">6. æ’åºæ¨¡å¼</h1><p>LinkedHashMap å®šä¹‰äº†æ’åºæ¨¡å¼ accessOrderï¼Œè¯¥å±æ€§ä¸º boolean å‹å˜é‡ï¼Œå¯¹äºè®¿é—®é¡ºåºï¼Œä¸º trueï¼›å¯¹äºæ’å…¥é¡ºåºï¼Œåˆ™ä¸º falseã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å¿…æŒ‡å®šæ’åºæ¨¡å¼ï¼Œå…¶è¿­ä»£é¡ºåºå³ä¸ºé»˜è®¤ä¸ºæ’å…¥é¡ºåºã€‚</p>
<p>è¿™äº›æ„é€ æ–¹æ³•éƒ½ä¼š<strong>é»˜è®¤æŒ‡å®šæ’åºæ¨¡å¼ä¸ºæ’å…¥é¡ºåº</strong>ã€‚å¦‚æœä½ æƒ³æ„é€ ä¸€ä¸ª LinkedHashMapï¼Œå¹¶æ‰“ç®—æŒ‰ä»è¿‘æœŸè®¿é—®æœ€å°‘åˆ°è¿‘æœŸè®¿é—®æœ€å¤šçš„é¡ºåºï¼ˆå³è®¿é—®é¡ºåºï¼‰æ¥ä¿å­˜å…ƒç´ ï¼Œé‚£ä¹ˆè¯·ä½¿ç”¨ä¸‹é¢çš„æ„é€ æ–¹æ³•æ„é€  <code>LinkedHashMapï¼špublic LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder)</code></p>
<p>è¯¥å“ˆå¸Œæ˜ å°„çš„è¿­ä»£é¡ºåºå°±æ˜¯æœ€åè®¿é—®å…¶æ¡ç›®çš„é¡ºåºï¼Œè¿™ç§æ˜ å°„å¾ˆé€‚åˆæ„å»º LRU ç¼“å­˜ã€‚LinkedHashMap æä¾›äº† removeEldestEntry(Map.Entry<k,v> eldest) æ–¹æ³•ã€‚è¯¥æ–¹æ³•å¯ä»¥æä¾›åœ¨æ¯æ¬¡æ·»åŠ æ–°æ¡ç›®æ—¶ç§»é™¤æœ€æ—§æ¡ç›®çš„å®ç°ç¨‹åºï¼Œé»˜è®¤è¿”å› falseï¼Œè¿™æ ·ï¼Œæ­¤æ˜ å°„çš„è¡Œä¸ºå°†ç±»ä¼¼äºæ­£å¸¸æ˜ å°„ï¼Œå³æ°¸è¿œä¸èƒ½ç§»é™¤æœ€æ—§çš„å…ƒç´ ã€‚</k,v></p>
<p>æˆ‘ä»¬ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­è¯¦ç»†ä»‹ç»å…³äºå¦‚ä½•ç”¨ LinkedHashMap æ„å»º LRU ç¼“å­˜ã€‚</p>
<h1 id="æ€»ç»“">7. æ€»ç»“</h1><p>å…¶å® LinkedHashMap å‡ ä¹å’Œ HashMap ä¸€æ ·ï¼šä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œä¸åŒçš„æ˜¯å®ƒå®šä¹‰äº†ä¸€ä¸ª Entry<k,v> headerï¼Œè¿™ä¸ª header ä¸æ˜¯æ”¾åœ¨ Table é‡Œï¼Œå®ƒæ˜¯é¢å¤–ç‹¬ç«‹å‡ºæ¥çš„ã€‚LinkedHashMap é€šè¿‡ç»§æ‰¿ hashMap ä¸­çš„ Entry<k,v>,å¹¶æ·»åŠ ä¸¤ä¸ªå±æ€§ Entry<k,v> before,after,å’Œ header ç»“åˆèµ·æ¥ç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ¥å®ç°æŒ‰æ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåºæ’åºã€‚</k,v></k,v></k,v></p>
<h1 id="ä½¿ç”¨LinkedHashMapå®ç°LRU-Cache">8. ä½¿ç”¨LinkedHashMapå®ç°LRU Cache</h1><p>LinkedHashMap çš„è®¿é—®åºå¯ä»¥æ–¹ä¾¿åœ°ç”¨æ¥å®ç°ä¸€ä¸ª LRU Cacheã€‚åœ¨è®¿é—®åºæ¨¡å¼ä¸‹ï¼Œå°¾éƒ¨èŠ‚ç‚¹æ˜¯æœ€è¿‘ä¸€æ¬¡è¢«è®¿é—®çš„èŠ‚ç‚¹ (least-recently)ï¼Œè€Œå¤´éƒ¨èŠ‚ç‚¹åˆ™æ˜¯æœ€è¿œè®¿é—® (most-recently) çš„èŠ‚ç‚¹ã€‚å› è€Œåœ¨å†³å®šå¤±æ•ˆç¼“å­˜çš„æ—¶å€™ï¼Œå°†å¤´éƒ¨èŠ‚ç‚¹ç§»é™¤å³å¯ã€‚</p>
<p>ä½†æ˜¯ï¼Œç”±äºé“¾è¡¨æ˜¯æ— ç•Œçš„ï¼Œä½†ç¼“å­˜å¾€å¾€æ˜¯èµ„æºå—é™çš„ï¼Œå¦‚ä½•ç¡®å®šä½•æ—¶ç§»é™¤æœ€è¿œè®¿é—®çš„ç¼“å­˜å‘¢ï¼Ÿå‰é¢åˆ†æè¿‡ï¼Œåœ¨ <code>afterNodeInsertion</code> ä¸­ï¼Œä¼šè°ƒç”¨ <code>removeEldestEntry</code> æ¥å†³å®šæ˜¯å¦å°†æœ€è€çš„èŠ‚ç‚¹ç§»é™¤ï¼Œå› è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ LinkedHashMap çš„å­ç±»ï¼Œå¹¶é‡å†™ <code>removeEldestEntry</code> æ–¹æ³•ï¼Œå½“ Enrty çš„æ•°é‡è¶…è¿‡ç¼“å­˜çš„å®¹é‡æ˜¯è¿”å› true å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> LinkedHashMap&lt;Integer, Integer&gt; cache;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> caplicity;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LRUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.caplicity = capacity;</div><div class="line">        cache = <span class="keyword">new</span> LinkedHashMap&lt;Integer, Integer&gt;(capacity, <span class="number">0.75f</span>, <span class="keyword">true</span>)&#123;</div><div class="line">            <span class="comment">// è¶…å‡ºå®¹é‡å°±åˆ é™¤æœ€è€çš„å€¼</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">removeEldestEntry</span><span class="params">(Map.Entry&lt;Integer,Integer&gt; eldest)</span></span>&#123;</div><div class="line">                <span class="keyword">return</span> size() &gt; capacity;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> cache.getOrDefault(key, -<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</div><div class="line">        cache.put(key,value);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">9. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://liujiacai.net/blog/2015/09/12/java-linkedhashmap/" target="_blank" rel="external">Java å®¹å™¨æºç åˆ†æä¹‹ LinkedHashMap</a></li>
<li><a href="http://wiki.jikexueyuan.com/project/java-collection/linkedhashmap.html" target="_blank" rel="external">LinkedHashMap çš„å®ç°åŸç†</a></li>
<li><a href="http://liujiacai.net/blog/2015/09/12/java-linkedhashmap/" target="_blank" rel="external">Java LinkedHashMapæºç è§£æ</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-HashtableåŸç†æ¢ç©¶]]></title>
      <url>/2018/01/28/Java-Hashtable%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/</url>
      <content type="html"><![CDATA[<p>å’Œ HashMap ä¸€æ ·ï¼ŒHashtable ä¹Ÿæ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œå®ƒå­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹ã€‚</p>
<p>Hashtable åœ¨ Java ä¸­çš„å®šä¹‰ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hashtable</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;  </span></div><div class="line">    <span class="keyword">extends</span> <span class="title">Dictionary</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;  </div><div class="line">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>ä»æºç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>Hashtableç»§æ‰¿äºDictionaryç±» â€”â€” ä»»ä½•å¯å°†é”®å€¼æ˜ å°„åˆ°ç›¸åº”å€¼çš„ç±»çš„ä¸€ç§æŠ½è±¡çˆ¶ç±»ã€‚æ¯ä¸ªé”®å’Œå€¼éƒ½æ˜¯å¯¹è±¡ã€‚</li>
<li>å®ç°äº†Map<k,v>, Cloneable, java.io.Serializable æ¥å£</k,v></li>
</ul>
<a id="more"></a>
<h1 id="æˆå‘˜å˜é‡">1. æˆå‘˜å˜é‡</h1><p>Hashtableæ˜¯é€šè¿‡â€æ‹‰é“¾æ³•â€å®ç°çš„å“ˆå¸Œè¡¨ã€‚å®ƒåŒ…æ‹¬å‡ ä¸ªé‡è¦çš„æˆå‘˜å˜é‡ï¼štable, count, threshold, loadFactor, modCountã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * The hash table data.</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt;[] table;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * The total number of entries in the hash table.</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> count;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * The table is rehashed when its size exceeds this threshold.  (The</div><div class="line">     * value of this field is (int)(capacity * loadFactor).)</div><div class="line">     *</div><div class="line">     * <span class="doctag">@serial</span></div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> threshold;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * The load factor for the hashtable.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@serial</span></div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> loadFactor;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * The number of times this Hashtable has been structurally modified</div><div class="line">     * Structural modifications are those that change the number of entries in</div><div class="line">     * the Hashtable or otherwise modify its internal structure (e.g.,</div><div class="line">     * rehash).  This field is used to make iterators on Collection-views of</div><div class="line">     * the Hashtable fail-fast.  (See ConcurrentModificationException).</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> modCount = <span class="number">0</span>;</div></pre></td></tr></table></figure>
<ul>
<li>tableæ˜¯ä¸€ä¸ªEntry[] æ•°ç»„ç±»å‹ã€‚è€ŒEntryå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼ˆåœ¨ä¹‹å‰çš„Java-HashMapçš„åŸç†æ¢ç©¶ä¸€é—®æ¶‰åŠè¿‡ï¼‰ã€‚å“ˆå¸Œè¡¨çš„â€key-valueé”®å€¼å¯¹â€éƒ½æ˜¯å­˜å‚¨åœ¨Entryæ•°ç»„ä¸­çš„</li>
<li>countæ˜¯Hashtableçš„å¤§å°ï¼Œå®ƒæ˜¯Hashtableä¿å­˜çš„é”®å€¼å¯¹çš„æ•°é‡</li>
<li>thresholdæ˜¯Hashtableçš„é˜ˆå€¼ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒæ•´Hashtableçš„å®¹é‡ã€‚threshold = å®¹é‡*åŠ è½½å› å­</li>
<li>loadFactor æ˜¯åŠ è½½å› å­</li>
<li>modCountæ˜¯ç”¨æ¥å®ç°fail-fastæœºåˆ¶ï¼ˆåœ¨ä¹‹å‰çš„Java-HashMapçš„åŸç†æ¢ç©¶ä¸€é—®æ¶‰åŠè¿‡ï¼‰çš„</li>
</ul>
<h1 id="æ„é€ æ–¹æ³•">2. æ„é€ æ–¹æ³•</h1><p>Hashtable ä¸€å…±æä¾›äº† 4 ä¸ªæ„é€ æ–¹æ³•ï¼š</p>
<ul>
<li><code>public Hashtable(int initialCapacity, float loadFactor)</code>ï¼š ç”¨æŒ‡å®šåˆå§‹å®¹é‡å’ŒæŒ‡å®šåŠ è½½å› å­æ„é€ ä¸€ä¸ªæ–°çš„ç©ºå“ˆå¸Œè¡¨ã€‚useAltHashing ä¸º booleanï¼Œå…¶å¦‚æœä¸ºçœŸï¼Œåˆ™æ‰§è¡Œå¦ä¸€æ•£åˆ—çš„å­—ç¬¦ä¸²é”®ï¼Œä»¥å‡å°‘ç”±äºå¼±å“ˆå¸Œè®¡ç®—å¯¼è‡´çš„å“ˆå¸Œå†²çªçš„å‘ç”Ÿã€‚</li>
<li><code>public Hashtable(int initialCapacity)</code>ï¼šç”¨æŒ‡å®šåˆå§‹å®¹é‡å’Œé»˜è®¤çš„åŠ è½½å› å­ (0.75) æ„é€ ä¸€ä¸ªæ–°çš„ç©ºå“ˆå¸Œè¡¨ã€‚</li>
<li><code>public Hashtable()</code>ï¼šé»˜è®¤æ„é€ å‡½æ•°ï¼Œå®¹é‡ä¸º 11ï¼ŒåŠ è½½å› å­ä¸º 0.75ã€‚</li>
<li><code>public Hashtable(Map&lt;? extends K, ? extends V&gt; t)</code>ï¼šæ„é€ ä¸€ä¸ªä¸ç»™å®šçš„ Map å…·æœ‰ç›¸åŒæ˜ å°„å…³ç³»çš„æ–°å“ˆå¸Œè¡¨ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Constructs a new, empty hashtable with the specified initial</div><div class="line">     * capacity and the specified load factor.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>      initialCapacity   the initial capacity of the hashtable.</div><div class="line">     * <span class="doctag">@param</span>      loadFactor        the load factor of the hashtable.</div><div class="line">     * <span class="doctag">@exception</span>  IllegalArgumentException  if the initial capacity is less</div><div class="line">     *             than zero, or if the load factor is nonpositive.</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hashtable</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+</div><div class="line">                                               initialCapacity);</div><div class="line">        <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Load: "</span>+loadFactor);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (initialCapacity==<span class="number">0</span>)</div><div class="line">            initialCapacity = <span class="number">1</span>;</div><div class="line">        <span class="keyword">this</span>.loadFactor = loadFactor;</div><div class="line">        table = <span class="keyword">new</span> Entry[initialCapacity];</div><div class="line">        threshold = (<span class="keyword">int</span>)Math.min(initialCapacity * loadFactor, MAX_ARRAY_SIZE + <span class="number">1</span>);</div><div class="line">        useAltHashing = sun.misc.VM.isBooted() &amp;&amp;</div><div class="line">                (initialCapacity &gt;= Holder.ALTERNATIVE_HASHING_THRESHOLD);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Constructs a new, empty hashtable with the specified initial capacity</div><div class="line">     * and default load factor (0.75).</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>     initialCapacity   the initial capacity of the hashtable.</div><div class="line">     * <span class="doctag">@exception</span> IllegalArgumentException if the initial capacity is less</div><div class="line">     *              than zero.</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hashtable</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(initialCapacity, <span class="number">0.75f</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Constructs a new, empty hashtable with a default initial capacity (11)</div><div class="line">     * and load factor (0.75).</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hashtable</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(<span class="number">11</span>, <span class="number">0.75f</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Constructs a new hashtable with the same mappings as the given</div><div class="line">     * Map.  The hashtable is created with an initial capacity sufficient to</div><div class="line">     * hold the mappings in the given Map and a default load factor (0.75).</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> t the map whose mappings are to be placed in this map.</div><div class="line">     * <span class="doctag">@throws</span> NullPointerException if the specified map is null.</div><div class="line">     * <span class="doctag">@since</span>   1.2</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hashtable</span><span class="params">(Map&lt;? extends K, ? extends V&gt; t)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(Math.max(<span class="number">2</span>*t.size(), <span class="number">11</span>), <span class="number">0.75f</span>);</div><div class="line">        putAll(t);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="putæ–¹æ³•">3. putæ–¹æ³•</h1><ol>
<li>å¦‚æœvalueä¸ºç©ºï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</li>
<li>è®¡ç®—keyçš„hashå€¼ï¼Œå¹¶æ ¹æ®hashå€¼è·å¾—keyåœ¨tableæ•°ç»„ä¸­çš„ä½ç½®indexã€‚å¦‚æœtable[index]ä¸ä¸ºç©ºï¼Œåˆ™è¿›è¡Œè¿­ä»£ã€‚å¦‚æœé‡åˆ°ç›¸åŒçš„keyï¼Œåˆ™ç›´æ¥æ›¿æ¢ï¼Œå¹¶è¿”å›æ—§çš„valueã€‚</li>
<li>å¦åˆ™ï¼Œå°†å…¶æ’å…¥åˆ°table[index]çš„ä½ç½®ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;<span class="comment">// æ³¨æ„synchronizedå…³é”®å­—</span></div><div class="line">        <span class="comment">// ç¡®ä¿valueä¸ä¸ºnull</span></div><div class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//ç¡®ä¿keyä¸åœ¨hashtableä¸­</span></div><div class="line">        <span class="comment">//é¦–å…ˆï¼Œé€šè¿‡hashæ–¹æ³•è®¡ç®—keyçš„å“ˆå¸Œå€¼ï¼Œå¹¶è®¡ç®—å¾—å‡ºindexå€¼ï¼Œç¡®å®šå…¶åœ¨table[]ä¸­çš„ä½ç½®</span></div><div class="line">        <span class="comment">//å…¶æ¬¡ï¼Œè¿­ä»£indexç´¢å¼•ä½ç½®çš„é“¾è¡¨ï¼Œå¦‚æœè¯¥ä½ç½®å¤„çš„é“¾è¡¨å­˜åœ¨ç›¸åŒçš„keyï¼Œåˆ™æ›¿æ¢valueï¼Œè¿”å›æ—§çš„value</span></div><div class="line">        Entry tab[] = table;</div><div class="line">        <span class="keyword">int</span> hash = hash(key);</div><div class="line">        <span class="keyword">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = tab[index] ; e != <span class="keyword">null</span> ; e = e.next) &#123;</div><div class="line">            <span class="keyword">if</span> ((e.hash == hash) &amp;&amp; e.key.equals(key)) &#123;</div><div class="line">                V old = e.value;</div><div class="line">                e.value = value;</div><div class="line">                <span class="keyword">return</span> old;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        modCount++;</div><div class="line">        <span class="keyword">if</span> (count &gt;= threshold) &#123;</div><div class="line">            <span class="comment">// Rehash the table if the threshold is exceeded</span></div><div class="line">            <span class="comment">//å¦‚æœè¶…è¿‡é˜€å€¼ï¼Œå°±è¿›è¡Œrehashæ“ä½œ</span></div><div class="line">            rehash();</div><div class="line"></div><div class="line">            tab = table;</div><div class="line">            hash = hash(key);</div><div class="line">            index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Creates the new entry.</span></div><div class="line">        <span class="comment">//å°†å€¼æ’å…¥ï¼Œè¿”å›çš„ä¸ºnull</span></div><div class="line">        Entry&lt;K,V&gt; e = tab[index];</div><div class="line">        <span class="comment">// åˆ›å»ºæ–°çš„EntryèŠ‚ç‚¹ï¼Œå¹¶å°†æ–°çš„Entryæ’å…¥Hashtableçš„indexä½ç½®ï¼Œå¹¶è®¾ç½®eä¸ºæ–°çš„Entryçš„ä¸‹ä¸€ä¸ªå…ƒç´ </span></div><div class="line">        tab[index] = <span class="keyword">new</span> Entry&lt;&gt;(hash, key, value, e);</div><div class="line">        count++;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨Hashtableçš„å®¹é‡ä¸º5ï¼Œå·²ç»å­˜åœ¨äº†(5,5)ï¼Œ(13,13)ï¼Œ(16,16)ï¼Œ(17,17)ï¼Œ(21,21)è¿™ 5 ä¸ªé”®å€¼å¯¹ï¼Œç›®å‰ä»–ä»¬åœ¨Hashtableä¸­çš„ä½ç½®å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-11-20-00.png" alt=""> </p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ’å…¥ä¸€ä¸ªæ–°çš„é”®å€¼å¯¹ï¼Œput(16,22)ï¼Œå‡è®¾key=16çš„ç´¢å¼•ä¸º1.ä½†ç°åœ¨ç´¢å¼•1çš„ä½ç½®æœ‰ä¸¤ä¸ªEntryäº†ï¼Œæ‰€ä»¥ç¨‹åºä¼šå¯¹é“¾è¡¨è¿›è¡Œè¿­ä»£ã€‚è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å…¶ä¸­æœ‰ä¸€ä¸ªEntryçš„keyå’Œæˆ‘ä»¬è¦æ’å…¥çš„é”®å€¼å¯¹çš„keyç›¸åŒï¼Œæ‰€ä»¥ç°åœ¨ä¼šåšçš„å·¥ä½œå°±æ˜¯å°†newValue=22æ›¿æ¢oldValue=16ï¼Œç„¶åè¿”å›oldValue=16.</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-11-20-39.png" alt=""> </p>
<p>ç„¶åæˆ‘ä»¬ç°åœ¨å†æ’å…¥ä¸€ä¸ªï¼Œput(33,33)ï¼Œkey=33çš„ç´¢å¼•ä¸º3ï¼Œå¹¶ä¸”åœ¨é“¾è¡¨ä¸­ä¹Ÿä¸å­˜åœ¨key=33çš„Entryï¼Œæ‰€ä»¥å°†è¯¥èŠ‚ç‚¹æ’å…¥é“¾è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-11-21-00.png" alt=""> </p>
<h1 id="getæ–¹æ³•">4. getæ–¹æ³•</h1><p>ç›¸æ¯”è¾ƒäº put æ–¹æ³•ï¼Œget æ–¹æ³•åˆ™ç®€å•å¾ˆå¤šã€‚å…¶è¿‡ç¨‹å°±æ˜¯é¦–å…ˆé€šè¿‡ hash()æ–¹æ³•æ±‚å¾— key çš„å“ˆå¸Œå€¼ï¼Œç„¶åæ ¹æ® hash å€¼å¾—åˆ° index ç´¢å¼•ï¼ˆä¸Šè¿°ä¸¤æ­¥æ‰€ç”¨çš„ç®—æ³•ä¸ put æ–¹æ³•éƒ½ç›¸åŒï¼‰ã€‚ç„¶åè¿­ä»£é“¾è¡¨ï¼Œè¿”å›åŒ¹é…çš„ key çš„å¯¹åº”çš„ valueï¼›æ‰¾ä¸åˆ°åˆ™è¿”å› nullã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123; <span class="comment">// æ³¨æ„synchronizedå…³é”®å­—</span></div><div class="line">        Entry tab[] = table;</div><div class="line">        <span class="keyword">int</span> hash = hash(key);</div><div class="line">        <span class="keyword">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = tab[index] ; e != <span class="keyword">null</span> ; e = e.next) &#123;</div><div class="line">            <span class="keyword">if</span> ((e.hash == hash) &amp;&amp; e.key.equals(key)) &#123;</div><div class="line">                <span class="keyword">return</span> e.value;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="Hashtableéå†æ–¹å¼">5. Hashtableéå†æ–¹å¼</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1ã€ä½¿ç”¨keys()</span></div><div class="line">Enumeration&lt;String&gt; en1 = table.keys(); </div><div class="line">    <span class="keyword">while</span>(en1.hasMoreElements()) &#123;</div><div class="line">    en1.nextElement();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//2ã€ä½¿ç”¨elements()</span></div><div class="line">Enumeration&lt;String&gt; en2 = table.elements();</div><div class="line">    <span class="keyword">while</span>(en2.hasMoreElements()) &#123;</div><div class="line">    en2.nextElement();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//3ã€ä½¿ç”¨keySet()</span></div><div class="line">Iterator&lt;String&gt; it1 = table.keySet().iterator();</div><div class="line">    <span class="keyword">while</span>(it1.hasNext()) &#123;</div><div class="line">    it1.next();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//4ã€ä½¿ç”¨entrySet()</span></div><div class="line">Iterator&lt;Entry&lt;String, String&gt;&gt; it2 = table.entrySet().iterator();</div><div class="line">    <span class="keyword">while</span>(it2.hasNext()) &#123;</div><div class="line">    it2.next();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Hashtable-ä¸-HashMap-çš„ç®€å•æ¯”è¾ƒ">6. Hashtable ä¸ HashMap çš„ç®€å•æ¯”è¾ƒ</h1><ol>
<li>HashTable åŸºäº Dictionary ç±»ï¼Œè€Œ HashMap æ˜¯åŸºäº AbstractMapã€‚Dictionary æ˜¯ä»»ä½•å¯å°†é”®æ˜ å°„åˆ°ç›¸åº”å€¼çš„ç±»çš„æŠ½è±¡çˆ¶ç±»ï¼Œè€Œ AbstractMap æ˜¯åŸºäº Map æ¥å£çš„å®ç°ï¼Œå®ƒä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å®ç°æ­¤æ¥å£æ‰€éœ€çš„å·¥ä½œã€‚</li>
</ol>
<ol>
<li>HashMap çš„ key å’Œ value éƒ½å…è®¸ä¸º nullï¼Œè€Œ Hashtable çš„ key å’Œ value éƒ½ä¸å…è®¸ä¸º nullã€‚HashMap é‡åˆ° key ä¸º null çš„æ—¶å€™ï¼Œè°ƒç”¨ putForNullKey æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œè€Œå¯¹ value æ²¡æœ‰å¤„ç†ï¼›Hashtableé‡åˆ° nullï¼Œç›´æ¥è¿”å› NullPointerExceptionã€‚</li>
</ol>
<ol>
<li>Hashtable æ–¹æ³•æ˜¯åŒæ­¥ï¼Œè€ŒHashMapåˆ™ä¸æ˜¯ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æºç ï¼ŒHashtable ä¸­çš„å‡ ä¹æ‰€æœ‰çš„ public çš„æ–¹æ³•éƒ½æ˜¯ synchronized çš„ï¼Œè€Œæœ‰äº›æ–¹æ³•ä¹Ÿæ˜¯åœ¨å†…éƒ¨é€šè¿‡ synchronized ä»£ç å—æ¥å®ç°ã€‚æ‰€ä»¥æœ‰äººä¸€èˆ¬éƒ½å»ºè®®å¦‚æœæ˜¯æ¶‰åŠåˆ°å¤šçº¿ç¨‹åŒæ­¥æ—¶é‡‡ç”¨ HashTableï¼Œæ²¡æœ‰æ¶‰åŠå°±é‡‡ç”¨ HashMapï¼Œä½†æ˜¯åœ¨ Collections ç±»ä¸­å­˜åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•ï¼šsynchronizedMap()ï¼Œè¯¥æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä½œä¸ºä¸€ä¸ªå°è£…çš„å¯¹è±¡æ¥è¿”å›ã€‚</li>
</ol>
<h1 id="å‚è€ƒèµ„æ–™">7. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="http://wiki.jikexueyuan.com/project/java-collection/hashtable.html" target="_blank" rel="external">æå®¢å­¦é™¢ï¼ŒHashtable çš„å®ç°åŸç†</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•]]></title>
      <url>/2018/01/27/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1-%E7%BC%93%E5%AD%98%E7%AE%97%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>åœ¨å­¦ç³»ç»Ÿè®¾è®¡çš„æ—¶å€™è®¾è®¡åˆ°äº†ç¼“å­˜è¿‡æœŸç®—æ³•ã€‚åœ¨æ­¤è¯¦ç»†ç ”ç©¶ä¸€ä¸‹ä»‹ä¸ªã€‚</p>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª<a href="http://www.cnblogs.com/s-b-b/p/6047954.html" target="_blank" rel="external">è¯¦è§£ä¸‰ç§ç¼“å­˜è¿‡æœŸç­–ç•¥LFUï¼ŒFIFOï¼ŒLRUï¼ˆé™„å¸¦å®ç°ä»£ç ï¼‰</a></p>
<p>ç¼“å­˜æœºåˆ¶ï¼šå…ˆåˆ†é…ä¸€å®šçš„ç¼“å­˜ç©ºé—´ã€‚ä½¿ç”¨æ•°æ®çš„æ—¶å€™å…ˆæŸ¥è¯¢ç¼“å­˜ç©ºé—´ä¸­æ˜¯å¦æœ‰è¯¥æ•°æ®çš„ç¼“å­˜ã€‚å¦‚æœæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ã€‚å¦‚æœæ²¡æœ‰çš„è¯å»å…¶å®ƒåœ°æ–¹æŸ¥è¯¢ï¼Œç„¶ååŒæ—¶å°†æŸ¥è¯¢åˆ°çš„ç»“æœæ”¾å…¥ç¼“å­˜ç©ºé—´ï¼Œæ–¹ä¾¿ä¸‹æ¬¡è°ƒç”¨ã€‚ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUser</span><span class="params">(user_id)</span>:</span></div><div class="line">	user = cache.get(user_id)</div><div class="line">    <span class="keyword">if</span> user :</div><div class="line">      <span class="keyword">return</span> user</div><div class="line">    user = database.get(user_id)</div><div class="line">    cache.set(key, user)</div><div class="line">    <span class="keyword">return</span> user</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setUser</span><span class="params">(user)</span>:</span></div><div class="line">  cache.delete(user.user_id)</div><div class="line">  database.set(user)</div></pre></td></tr></table></figure>
<p>ç¼“å­˜æœºåˆ¶å°±åƒä¸Šé¢æ‰€è¯´çš„é‚£æ ·ã€‚<code>cache</code> ä¸€èˆ¬æ˜¯æœ‰æœ‰æ•ˆæœŸçš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœç¼“å­˜ä¸­è¿™ä¸ªæ•°æ®è¿‡æœŸäº†ï¼Œé‚£å°±ä»ç¼“å­˜ä¸­æ¸…ç†å‡ºå»ã€‚è€Œ<code>cache</code> çš„å®ç°è¿‡ç¨‹å’Œæ·˜æ±°æœºåˆ¶ä¸åŒï¼Œä¼šå¯¼è‡´ä¸åŒçš„æ€§èƒ½è¡¨ç°ã€‚å¸¸è§çš„å°±æ˜¯IFIOï¼ŒLRUï¼ŒLFUç¼“å­˜è¿‡æœŸç­–ç•¥ã€‚</p>
<ol>
<li>FIFO(First In First Out) : å…ˆè¿›å…ˆå‡ºã€‚æ·˜æ±°æ‰å¾ˆä¹…ä»¥å‰è¿›æ¥çš„æ•°æ®ï¼Œè€Œæ–°æ•°æ®ç­‰åˆ°ä¹‹åå†æ·˜æ±°ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚</li>
<li>LRU (Least recently used) : æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚æ·˜æ±°æœ€è¿‘ä¸é€‚ç”¨çš„æ•°æ®</li>
<li>LFU (Least frequently used) : æœ€è¿‘ä½¿ç”¨æ¬¡æ•°æœ€å°‘ã€‚æ·˜æ±°æ‰ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„é¡µé¢ã€‚</li>
</ol>
<a id="more"></a>
<h1 id="FIFO">1. FIFO</h1><p>æŒ‰ç…§â€œå…ˆè¿›å…ˆå‡ºï¼ˆFirst Inï¼ŒFirst Outï¼‰â€çš„åŸç†æ·˜æ±°æ•°æ®ï¼Œæ­£å¥½ç¬¦åˆé˜Ÿåˆ—çš„ç‰¹æ€§ï¼Œæ•°æ®ç»“æ„ä¸Šä½¿ç”¨é˜Ÿåˆ—Queueæ¥å®ç°ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-15-54-58.png" alt=""> </p>
<ol>
<li><p>æ–°è®¿é—®çš„æ•°æ®æ’å…¥FIFOé˜Ÿåˆ—å°¾éƒ¨ï¼Œæ•°æ®åœ¨FIFOé˜Ÿåˆ—ä¸­é¡ºåºç§»åŠ¨ï¼›</p>
</li>
<li><p>æ·˜æ±°FIFOé˜Ÿåˆ—å¤´éƒ¨çš„æ•°æ®ï¼›</p>
</li>
</ol>
<h1 id="LRU">2. LRU</h1><p>ï¼ˆLeast recently usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•æ ¹æ®æ•°æ®çš„å†å²è®¿é—®è®°å½•æ¥è¿›è¡Œæ·˜æ±°æ•°æ®ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¹Ÿæ›´é«˜â€ã€‚</p>
<p>æœ€å¸¸è§çš„å®ç°æ˜¯ä½¿ç”¨ä¸€ä¸ªé“¾è¡¨ä¿å­˜ç¼“å­˜æ•°æ®ï¼Œè¯¦ç»†ç®—æ³•å®ç°å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-15-56-25.png" alt=""> </p>
<ol>
<li>æ–°æ•°æ®æ’å…¥åˆ°é“¾è¡¨å¤´éƒ¨ï¼›</li>
</ol>
<ol>
<li><p>æ¯å½“ç¼“å­˜å‘½ä¸­ï¼ˆå³ç¼“å­˜æ•°æ®è¢«è®¿é—®ï¼‰ï¼Œåˆ™å°†æ•°æ®ç§»åˆ°é“¾è¡¨å¤´éƒ¨ï¼›</p>
</li>
<li><p>å½“é“¾è¡¨æ»¡çš„æ—¶å€™ï¼Œå°†é“¾è¡¨å°¾éƒ¨çš„æ•°æ®ä¸¢å¼ƒã€‚</p>
</li>
</ol>
<p><strong>LeetCodeé¢˜ï¼š146. LRU Cache</strong></p>
<p>è¦ç”¨O(1)çš„æ—¶é—´å¤æ‚åº¦å®ŒæˆLRUç®—æ³•ã€‚</p>
<p>æˆ‘çš„æ€è·¯ï¼šåŒé“¾è¡¨ + <code>HashMap&lt;key, Node&gt;</code> </p>
<p>ä»£ç è´¼é•¿</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å®šä¹‰é“¾è¡¨</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkList</span></span>&#123;  </div><div class="line">    <span class="comment">// é“¾è¡¨èŠ‚ç‚¹å®šä¹‰</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        <span class="comment">// èŠ‚ç‚¹çš„keyå’Œval</span></div><div class="line">        <span class="keyword">int</span> key;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        Node next;<span class="comment">// åä¸€ä¸ªèŠ‚ç‚¹</span></div><div class="line">        Node prev; <span class="comment">// å‰ä¸€ä¸ªèŠ‚ç‚¹</span></div><div class="line">        Node(<span class="keyword">int</span> key,<span class="keyword">int</span> val)&#123;</div><div class="line">            <span class="keyword">this</span>.val = val;</div><div class="line">            <span class="keyword">this</span>.key = key;</div><div class="line">            next = <span class="keyword">null</span>;</div><div class="line">            prev = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    Node dummyHead; <span class="comment">// é“¾è¡¨å¤´</span></div><div class="line">    Node dummyTail; <span class="comment">// é“¾è¡¨å°¾</span></div><div class="line">    <span class="keyword">int</span> size; <span class="comment">// é“¾è¡¨é•¿åº¦</span></div><div class="line">    <span class="keyword">int</span> capacity; <span class="comment">// å®¹é‡</span></div><div class="line">    HashMap&lt;Integer, Node&gt; keyNodeHash; <span class="comment">// æ ¹æ®keyå¯»æ‰¾èŠ‚ç‚¹ä½ç½®çš„Hashè¡¨</span></div><div class="line">    LinkList(<span class="keyword">int</span> capacity)&#123;</div><div class="line">        dummyHead = <span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">        dummyTail = <span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">        dummyHead.next = dummyTail;</div><div class="line">        dummyTail.prev = dummyHead;</div><div class="line">        <span class="keyword">this</span>.capacity = capacity;</div><div class="line">        size = <span class="number">0</span>;</div><div class="line">        keyNodeHash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// å¯¹å¤–å‡½æ•°ï¼Œå°†keyï¼Œvalueæ’å…¥åˆ°é“¾è¡¨ä¸­</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(keyNodeHash.containsKey(key))&#123;</div><div class="line">            <span class="comment">// æ›¾ç»æœ‰è¿™ä¸ªkeyæ—¶ï¼Œè¦æ›´æ–°èŠ‚ç‚¹ä¸”ç½®é¡¶ï¼ˆç›¸å½“äºæŠŠåŸæ¥çš„é‚£ä¸ªåˆ æ‰äº†ï¼ŒåŠ äº†ä¸ªæ–°çš„ï¼‰</span></div><div class="line">            Node e = keyNodeHash.get(key); <span class="comment">// è·å–èŠ‚ç‚¹</span></div><div class="line">            e.val = val; <span class="comment">// æ›´æ–°èŠ‚ç‚¹å€¼</span></div><div class="line">            setFirst(e);  <span class="comment">// å°†è¿™ä¸ªèŠ‚ç‚¹ç½®é¡¶</span></div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(size &gt;= capacity)&#123;</div><div class="line">            <span class="comment">// å½“é“¾è¡¨é•¿åº¦å¤§äºå®¹é‡æ—¶ï¼Œåˆ é™¤æœ«å°¾çš„èŠ‚ç‚¹,ä¸”ä»hashè¡¨ä¸­åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹</span></div><div class="line">            keyNodeHash.remove(deleteTail().key);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æ·»åŠ èŠ‚ç‚¹ï¼Œä¸”åŠ å…¥hashè¡¨</span></div><div class="line">        keyNodeHash.put(key, addFirst(key, val)); </div><div class="line">    &#125;</div><div class="line"><span class="comment">// å¯¹å¤–å‡½æ•°ï¼Œè·å–keyçš„value</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(keyNodeHash.containsKey(key))&#123;</div><div class="line">            Node setFirstNode = keyNodeHash.get(key);</div><div class="line">            setFirst(setFirstNode); <span class="comment">// å°†è¿™ä¸ªèŠ‚ç‚¹ç½®é¡¶</span></div><div class="line">            <span class="keyword">return</span> keyNodeHash.get(key).val;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"><span class="comment">// å°†èŠ‚ç‚¹curræ’å…¥åˆ°é“¾è¡¨é¦–</span></div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">addFirst</span><span class="params">(Node curr)</span></span>&#123;</div><div class="line">        curr.next = dummyHead.next;</div><div class="line">        dummyHead.next.prev = curr;</div><div class="line">        dummyHead.next = curr;</div><div class="line">        curr.prev = dummyHead;</div><div class="line">        ++size;</div><div class="line">        <span class="keyword">return</span> curr;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å°†key valueçš„èŠ‚ç‚¹æ’å…¥é“¾è¡¨é¦–</span></div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">addFirst</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">        Node curr = <span class="keyword">new</span> Node(key, val);</div><div class="line">        <span class="keyword">return</span> addFirst(curr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// å°†èŠ‚ç‚¹eç½®é¡¶ï¼ˆæ”¾åˆ°é“¾è¡¨é¦–éƒ¨ï¼‰</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setFirst</span><span class="params">(Node e)</span></span>&#123;</div><div class="line">        queue.delete(e);</div><div class="line">        queue.addFirst(e);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ä»é“¾è¡¨ä¸­åˆ é™¤èŠ‚ç‚¹e</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Node e)</span></span>&#123;</div><div class="line">        Node prev = e.prev;</div><div class="line">        Node next = e.next;</div><div class="line">        prev.next = next;</div><div class="line">        next.prev = prev;</div><div class="line">        e.prev = <span class="keyword">null</span>;</div><div class="line">        e.next = <span class="keyword">null</span>;</div><div class="line">        --size;</div><div class="line">    &#125;</div><div class="line">     <span class="comment">// åˆ é™¤é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">deleteTail</span><span class="params">()</span></span>&#123;</div><div class="line">        Node deleted = dummyTail.prev;</div><div class="line">        delete(deleted);</div><div class="line">        <span class="keyword">return</span> deleted;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸»ä»£ç </span></div><div class="line">LinkList queue ;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">LRUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</div><div class="line">    queue = <span class="keyword">new</span> LinkList(capacity);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">    <span class="comment">//System.out.println("get" + key);</span></div><div class="line">    <span class="keyword">return</span> queue.getValue(key);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</div><div class="line">    <span class="comment">//System.out.println("add" + key + "\t" + value);</span></div><div class="line">    queue.add(key, value);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="LFU">3. LFU</h1><p>ï¼ˆLeast Frequently Usedï¼‰ç®—æ³•æ ¹æ®æ•°æ®çš„å†å²è®¿é—®é¢‘ç‡æ¥æ·˜æ±°æ•°æ®ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¦‚æœæ•°æ®è¿‡å»è¢«è®¿é—®å¤šæ¬¡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„é¢‘ç‡ä¹Ÿæ›´é«˜â€ã€‚</p>
<p>LFUçš„æ¯ä¸ªæ•°æ®å—éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œæ‰€æœ‰æ•°æ®å—æŒ‰ç…§å¼•ç”¨è®¡æ•°æ’åºï¼Œå…·æœ‰ç›¸åŒå¼•ç”¨è®¡æ•°çš„æ•°æ®å—åˆ™æŒ‰ç…§æ—¶é—´æ’åºã€‚</p>
<p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-15-58-34.png" alt=""> </p>
<ol>
<li>æ–°åŠ å…¥æ•°æ®æ’å…¥åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼ˆå› ä¸ºå¼•ç”¨è®¡æ•°ä¸º1ï¼‰ï¼›</li>
<li>é˜Ÿåˆ—ä¸­çš„æ•°æ®è¢«è®¿é—®åï¼Œå¼•ç”¨è®¡æ•°å¢åŠ ï¼Œé˜Ÿåˆ—é‡æ–°æ’åºï¼›</li>
<li>å½“éœ€è¦æ·˜æ±°æ•°æ®æ—¶ï¼Œå°†å·²ç»æ’åºçš„åˆ—è¡¨æœ€åçš„æ•°æ®å—åˆ é™¤ã€‚</li>
</ol>
<p>å®ç°æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘keysçš„å¢åˆ ï¼Œç„¶åå†å¤–éƒ¨ä¿æŒä¸€ä¸ªkey,valueçš„å¯¹åº”å…³ç³»å³å¯ã€‚æ•°æ®ç»“æ„çš„è®¾è®¡å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p> <img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-15-46-58.png" alt=""> </p>
<p>é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªåŒé“¾è¡¨ã€‚é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> count; <span class="comment">// ä»£è¡¨æœ¬èŠ‚ç‚¹å†…çš„æ•°æ®æ‰€å¯¹åº”çš„è®¿é—®æ¬¡æ•°</span></div><div class="line">  LinkedHashSet&lt;Integer&gt; keys; <span class="comment">// æœ¬èŠ‚ç‚¹å†…çš„æ‰€æœ‰æ•°æ®çš„keys</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œkeysæ˜¯ä¸€ä¸ªLinkedHashSetï¼Œå®ƒå¯ä»¥æŒ‰ç…§æ•°æ®çš„æ’å…¥é¡ºåºè¾“å‡ºï¼Œæ¯æ¬¡è¾“å‡ºéƒ½æ˜¯å…ˆè¾“å‡ºè€æ•°æ®ï¼Œæœ€åè¾“å‡ºæ–°æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬ä»¥leetcodeç»™çš„æ ·ä¾‹è¯´æ˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">LFUCache cache = new LFUCache( 2 /* capacity */ );</div><div class="line"></div><div class="line">cache.put(1, 1);</div><div class="line">cache.put(2, 2);</div><div class="line">cache.get(1);       // returns 1</div><div class="line">cache.put(3, 3);    // evicts key 2</div><div class="line">cache.get(2);       // returns -1 (not found)</div><div class="line">cache.get(3);       // returns 3.</div><div class="line">cache.put(4, 4);    // evicts key 1.</div><div class="line">cache.get(1);       // returns -1 (not found)</div><div class="line">cache.get(3);       // returns 3</div><div class="line">cache.get(4);       // returns 4</div></pre></td></tr></table></figure>
<p>ä¸€å¼€å§‹æ’å…¥<code>cache.put(1, 1); cache.put(2, 2);</code> ï¼Œå˜æˆè¿™æ ·</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-15-49-24.png" alt=""> </p>
<p>ç„¶åæˆ‘ä»¬æ‰§è¡Œ<code>cache.get(1); // returns 1</code>ï¼Œé‚£ä¹ˆå˜æˆäº†ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-15-52-31.png" alt=""> </p>
<p>ç„¶åæˆ‘ä»¬æ‰§è¡Œ<code>cache.put(3, 3);    // evicts key 2</code> ã€‚æ­¤æ—¶æ•°æ®ä¸ªæ•°å¤§äºå®¹é‡2äº†ï¼Œå°±è¦å…ˆæŠŠæœ€è€çš„åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯2ï¼Œç„¶åæ’å…¥æ–°æ•°æ®ã€‚å˜æˆäº†ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-29-15-53-36.png" alt=""> </p>
<p>ä¹‹åçš„æ“ä½œä¸å†ç”»å›¾é˜è¿°ã€‚</p>
<p>é‚£ä¹ˆæ€»çš„ä¼ªä»£ç ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">List&lt;Node&gt; lists;</div><div class="line">HashMap &lt;key, value&gt; kv;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> not exsit &lt;key,value&gt; in kvï¼Œ <span class="keyword">return</span> -<span class="number">1</span></div><div class="line">   <span class="keyword">else</span> </div><div class="line">     move key to next Node <span class="comment">// å°†keyæŒªåˆ°ä¸‹ä¸€ä¸ªcountèŠ‚ç‚¹é‡Œ</span></div><div class="line">     <span class="keyword">return</span> key.value</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> exsit &lt;key,OldValue&gt; in kv :  <span class="comment">// å¦‚æœæ›¾ç»å­˜åœ¨key</span></div><div class="line">    remove key from key.node  <span class="comment">// å°±å…ˆä»listçš„æŸä¸ªnodeä¸­å°†keyå»é™¤</span></div><div class="line">  put &lt;key,value&gt; to kv  <span class="comment">// ç»™kvé‡ŒåŠ å…¥key,value</span></div><div class="line">  add &lt;key&gt; to count=<span class="number">1</span> node <span class="comment">// å°†keyåŠ å…¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123; <span class="comment">// ä¸»é“¾è¡¨çš„èŠ‚ç‚¹</span></div><div class="line">        Node next;</div><div class="line">        Node prev;</div><div class="line">        LinkedHashSet&lt;Integer&gt; keys;</div><div class="line">        <span class="keyword">int</span> count;</div><div class="line">        Node(<span class="keyword">int</span> count)&#123;</div><div class="line">            <span class="keyword">this</span>.count = count;</div><div class="line">            keys = <span class="keyword">new</span> LinkedHashSet&lt;&gt;();</div><div class="line">            next = <span class="keyword">null</span>;</div><div class="line">            prev = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> Node dummyHead;</div><div class="line">    <span class="keyword">private</span> Node dummyTail;</div><div class="line">    <span class="keyword">private</span> HashMap&lt;Integer, Integer&gt; keyValueMap;</div><div class="line">    <span class="keyword">private</span> HashMap&lt;Integer,Node&gt; keyNodeMap;</div><div class="line">    <span class="keyword">int</span> capacity;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LFUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.capacity = capacity;</div><div class="line">        keyValueMap = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">// æå‰å­˜å‚¨æ¯ä¸ª&lt;key,value&gt;ï¼Œè¿™æ ·åœ¨ä¹‹åå¤„ç†çš„æ—¶å€™ï¼Œåªéœ€è¦å¤„ç†keyã€‚</span></div><div class="line">        keyNodeMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        dummyHead = <span class="keyword">new</span> Node(<span class="number">0</span>);</div><div class="line">        dummyTail = <span class="keyword">new</span> Node(Integer.MAX_VALUE);</div><div class="line">        dummyHead.next = dummyTail;</div><div class="line">        dummyTail.prev = dummyHead;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(keyValueMap.containsKey(key))&#123;</div><div class="line">            increaseCount(key);</div><div class="line">            <span class="keyword">return</span> keyValueMap.get(key);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(capacity == <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(keyValueMap.containsKey(key))&#123;</div><div class="line">            keyValueMap.put(key,value);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">if</span>(keyValueMap.size() &gt;= capacity)&#123;</div><div class="line">                <span class="comment">// å½“å…ƒç´ ä¸ªæ•°å¤§äºå®¹é‡æ—¶ï¼Œå¼¹å‡ºæœ€ä¸ä½¿ç”¨ä¸”æœ€ä¹…è¿œçš„é‚£ä¸ª</span></div><div class="line">                removeOld();</div><div class="line">            &#125;</div><div class="line">            keyValueMap.put(key,value);</div><div class="line">            addTohead(key);</div><div class="line">        &#125;</div><div class="line">        increaseCount(key);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addTohead</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">        dummyHead.keys.add(key);</div><div class="line">        keyNodeMap.put(key, dummyHead);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å°†keyæŒªåˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">increaseCount</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">        <span class="comment">//è·å–keyæ‰€åœ¨çš„node</span></div><div class="line">        Node node = keyNodeMap.get(key);</div><div class="line">        node.keys.remove(key);</div><div class="line">        keyNodeMap.remove(key);</div><div class="line"></div><div class="line">        <span class="comment">// å°†keyæ‰€å¯¹åº”çš„ç‚¹ç§»åˆ°ä¸‹ä¸€ä¸ªnode</span></div><div class="line">        <span class="keyword">if</span>(node.next == dummyTail)&#123;</div><div class="line">            addNext(node);</div><div class="line">        &#125;</div><div class="line">        node.next.keys.add(key);</div><div class="line">        keyNodeMap.put(key, node.next);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ç»™nodeèŠ‚ç‚¹æ·»åŠ ä¸‹ä¸€èŠ‚ç‚¹</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addNext</span><span class="params">(Node node)</span></span>&#123;</div><div class="line">        Node newNext = <span class="keyword">new</span> Node(node.count + <span class="number">1</span>);</div><div class="line">        newNext.next = node.next;</div><div class="line">        newNext.prev = node;</div><div class="line">        node.next.prev = newNext;</div><div class="line">        node.next = newNext;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ç§»é™¤least frequency used key</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">removeOld</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(keyValueMap.size() == <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="comment">// å› ä¸ºå¯èƒ½å­˜åœ¨keysä¸ºç©ºçš„èŠ‚ç‚¹ï¼Œå› æ­¤è¦éå†çœ‹çœ‹</span></div><div class="line">        Node curr = dummyHead;</div><div class="line">        <span class="keyword">while</span> (curr.keys.isEmpty())&#123;</div><div class="line">            curr = curr.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> LFUKey = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> n : curr.keys)&#123;</div><div class="line">            LFUKey = n;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        curr.keys.remove(LFUKey);</div><div class="line">        keyNodeMap.remove(LFUKey);</div><div class="line">        keyValueMap.remove(LFUKey);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ³¨ï¼šæœ¬æ¥æƒ³ç€ç”¨ä¼˜å…ˆé˜Ÿåˆ—å®ç°ã€‚ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ‰æ ·ä¾‹ä¸èƒ½é€šè¿‡ã€‚æ°”æ­»äº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LFUCache</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> time = <span class="number">0</span>;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">int</span> counter;</div><div class="line">        <span class="keyword">int</span> key;</div><div class="line">        <span class="keyword">int</span> value;</div><div class="line">        <span class="keyword">int</span> timeStamp;</div><div class="line">        Node(<span class="keyword">int</span> key, <span class="keyword">int</span> value)&#123;</div><div class="line">            <span class="keyword">this</span>.key = key;</div><div class="line">            <span class="keyword">this</span>.value = value;</div><div class="line">            <span class="keyword">this</span>.timeStamp = time++;</div><div class="line">            <span class="keyword">this</span>.counter = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">(<span class="keyword">int</span> value)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.counter = <span class="number">1</span>;</div><div class="line">            <span class="keyword">this</span>.value = value;</div><div class="line">            <span class="keyword">this</span>.timeStamp = time++;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">" key="</span> + key + <span class="string">",value="</span> + value + <span class="string">",counter="</span> + counter;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.counter == o.counter) <span class="keyword">return</span> <span class="keyword">this</span>.timeStamp - o.timeStamp;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.counter - o.counter;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PivotQueue</span></span>&#123;</div><div class="line">        PivotQueue(<span class="keyword">int</span> capcity)&#123;</div><div class="line">            <span class="keyword">this</span>.capcity = capcity;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> capcity;</div><div class="line">        <span class="keyword">private</span> ArrayList&lt;Node&gt; arr = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">public</span> HashMap&lt;Integer, Node&gt; keyIdxMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> size;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLeft</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getRight</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> (i &lt;&lt; <span class="number">1</span>) + <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getParent</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> (i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¯¹å¤–æ¥å£ï¼Œæ ¹æ®keyè·å¾—value</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(capcity==<span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(!keyIdxMap.containsKey(key)) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                Node curr = keyIdxMap.get(key);</div><div class="line">                <span class="keyword">return</span> get(curr);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¯¹å¤–æ¥å£ï¼Œå°†&lt;key,value&gt;æ’å…¥</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(capcity==<span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">            System.out.println(time + <span class="string">" adding "</span>+key+<span class="string">"\t"</span>+value);</div><div class="line">            <span class="keyword">if</span>(keyIdxMap.containsKey(key))&#123;</div><div class="line">                reset(arr.indexOf(keyIdxMap.get(key)), value);</div><div class="line">                <span class="comment">//System.out.println("arr" + arr);</span></div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (size &gt;= capcity)&#123;</div><div class="line">                poll();</div><div class="line">            &#125;</div><div class="line">            Node curr = <span class="keyword">new</span> Node(key, value);</div><div class="line">            arr.add(curr); <span class="comment">// å°†curråŠ åˆ°æœ«å°¾</span></div><div class="line">            keyIdxMap.put(curr.key, curr);</div><div class="line">            <span class="comment">// shiftUp</span></div><div class="line">            shiftUp(arr.size() - <span class="number">1</span>);</div><div class="line">            shiftDown(arr.indexOf(curr));</div><div class="line">            ++size;</div><div class="line">            <span class="comment">//System.out.println("keyMap" + keyIdxMap);</span></div><div class="line">            <span class="comment">// System.out.println("arr" + arr);</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç§æœ‰æ¥å£ï¼Œå¼¹å‡ºå †é¡¶å…ƒç´ </span></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">poll</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="comment">//System.out.println("polled "+arr.get(0).key + "," + arr.get(0).value);</span></div><div class="line">            <span class="keyword">int</span> result = arr.get(<span class="number">0</span>).value;</div><div class="line">            keyIdxMap.remove(arr.get(<span class="number">0</span>).key);</div><div class="line">            swap(<span class="number">0</span>, arr.size() - <span class="number">1</span>);</div><div class="line">            arr.remove(arr.size() - <span class="number">1</span>);</div><div class="line">            --size;</div><div class="line">            shiftDown(<span class="number">0</span>);</div><div class="line"></div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç§æœ‰æ¥å£ï¼Œæ ¹æ®currè·å–valueï¼ŒåŒæ—¶æ›´æ–°currèŠ‚ç‚¹åœ¨æ ‘ä¸­çš„é¡ºåº</span></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(Node curr)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> result = curr.value;</div><div class="line">            ++curr.counter;</div><div class="line">            curr.timeStamp = time++;</div><div class="line">            <span class="comment">// node.counterå˜å¤§ä¹‹åï¼Œå¯èƒ½ä¼šæ¯”å®ƒçš„å­èŠ‚ç‚¹å¤§ï¼Œå› æ­¤è¦å‘ä¸‹ç§»</span></div><div class="line">            shiftDown(arr.indexOf(curr));</div><div class="line">            <span class="comment">//System.out.println("arr" + arr);</span></div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç§æœ‰æ¥å£ï¼Œå°†ç¬¬iç‚¹çš„èŠ‚ç‚¹ç½®é¡¶</span></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> value)</span></span>&#123;</div><div class="line">            arr.get(i).reset(value);</div><div class="line">            <span class="comment">//nodeå˜ä¸ºæ–°çš„èŠ‚ç‚¹</span></div><div class="line">            shiftUp(i);</div><div class="line">            shiftDown(i);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç§æœ‰æ¥å£ï¼Œç½®æ¢iå’Œj çš„å€¼</span></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">            Node a = arr.get(i);</div><div class="line">            <span class="keyword">int</span> aCounter = a.counter, aKey = a.key, aValue = a.value, aTimeStamp = a.timeStamp;</div><div class="line">            Node b = arr.get(j);</div><div class="line">            a.counter = b.counter;</div><div class="line">            a.key = b.key;</div><div class="line">            a.value = b.value;</div><div class="line">            a.timeStamp = b.timeStamp;</div><div class="line">            b.counter = aCounter;</div><div class="line">            b.key = aKey;</div><div class="line">            b.value = aValue;</div><div class="line">            b.timeStamp = aTimeStamp;</div><div class="line">            keyIdxMap.replace(a.key, a);</div><div class="line">            keyIdxMap.replace(b.key, b);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shiftUp</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i == <span class="number">0</span> || arr.get(i).compareTo(arr.get(getParent(i))) &gt; <span class="number">0</span>)&#123;</div><div class="line">                <span class="comment">// node &gt; parentï¼Œä¸ç”¨å†ç»§ç»­äº†</span></div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// node &lt; parentï¼Œéœ€è¦å°†nodeå‘ä¸Šç§»åŠ¨</span></div><div class="line">            swap(i, getParent(i));</div><div class="line">            shiftUp(getParent(i));</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shiftDown</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i &gt;= arr.size()) <span class="keyword">return</span>;</div><div class="line">            <span class="keyword">int</span> left = getLeft(i), right = getRight(i);</div><div class="line">            <span class="keyword">if</span>(left &gt;= arr.size() &amp;&amp; right &gt;= arr.size()) <span class="keyword">return</span>;</div><div class="line">            <span class="keyword">int</span> smallest = i;</div><div class="line">            <span class="keyword">if</span>(left &lt; arr.size() &amp;&amp; arr.get(smallest).compareTo(arr.get(left)) &gt; <span class="number">0</span>)&#123;</div><div class="line">                <span class="comment">// smallest &gt; left</span></div><div class="line">                smallest = left;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(right &lt; arr.size() &amp;&amp; arr.get(smallest).compareTo(arr.get(right)) &gt; <span class="number">0</span>)&#123;</div><div class="line">                <span class="comment">// smallest &gt; right</span></div><div class="line">                smallest = right;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(smallest == i) <span class="keyword">return</span>;</div><div class="line">            swap(smallest, i);</div><div class="line">            shiftDown(smallest);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    PivotQueue pivotQueue;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LFUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</div><div class="line">        pivotQueue = <span class="keyword">new</span> PivotQueue(capacity);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> result = pivotQueue.getValue(key);</div><div class="line">        System.out.println(time + <span class="string">" getting "</span>+key + <span class="string">" result = "</span> + result);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</div><div class="line">        pivotQueue.add(key, value);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] arg)</span></span>&#123;</div><div class="line">        LFUCache obj = <span class="keyword">new</span> LFUCache(<span class="number">2</span>);</div><div class="line"></div><div class="line">        obj.put(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">        obj.put(<span class="number">2</span>,<span class="number">2</span>);</div><div class="line">        obj.get(<span class="number">1</span>);</div><div class="line">        obj.put(<span class="number">3</span>,<span class="number">3</span>);</div><div class="line">        obj.get(<span class="number">2</span>);</div><div class="line">        obj.get(<span class="number">3</span>);</div><div class="line">        obj.put(<span class="number">4</span>,<span class="number">4</span>);</div><div class="line">        obj.get(<span class="number">1</span>);</div><div class="line">        System.out.println(obj.get(<span class="number">3</span>));;</div><div class="line">        System.out.println(obj.get(<span class="number">4</span>));;</div><div class="line"><span class="comment">//        obj.put(1,1);</span></div><div class="line"><span class="comment">//        obj.put(2,2);</span></div><div class="line"><span class="comment">//        obj.get(1);</span></div><div class="line"><span class="comment">//        obj.put(3,3);</span></div><div class="line"><span class="comment">//        obj.get(2);</span></div><div class="line"><span class="comment">//        obj.get(3);</span></div><div class="line"><span class="comment">//        obj.put(4,4);</span></div><div class="line"><span class="comment">//        obj.get(1);</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç³»ç»Ÿè®¾è®¡ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç³»ç»Ÿè®¾è®¡-ä»ç”¨æˆ·ç³»ç»Ÿä¸­ç†è§£æ•°æ®åº“ä¸ç¼“å­˜]]></title>
      <url>/2018/01/26/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1-%E4%BB%8E%E7%94%A8%E6%88%B7%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98/</url>
      <content type="html"><![CDATA[<p>å¤§çº²</p>
<ul>
<li>Memcached</li>
<li>ç”¨æˆ·è®¤è¯ - Authentication - ä¿æŒç™»å½•çŠ¶æ€</li>
<li>SQL vs NoSQL</li>
<li>Friendship</li>
<li>å¦‚ä½•æ‰©å±•ï¼Ÿ<ul>
<li>Sharding</li>
<li>Consistent Hashing</li>
<li>Replica</li>
</ul>
</li>
</ul>
<a id="more"></a>
<ul>
<li><p>Scenario åœºæ™¯</p>
<ul>
<li>æ³¨å†Œã€ç™»å½•ã€æŸ¥è¯¢ã€ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹</li>
<li>å“ªä¸ªéœ€æ±‚é‡æœ€å¤§ï¼Ÿâ€”â€”æŸ¥è¯¢</li>
</ul>
</li>
<li><p>æ”¯æŒ 100M DAU</p>
</li>
<li><p>æ³¨å†Œï¼Œç™»å½•ï¼Œä¿¡æ¯ä¿®æ”¹ QPS çº¦</p>
<ul>
<li>100Mç”¨æˆ· * 0.1æ¬¡æ¯å¤© / 86400ç§’ ~ 100</li>
<li>0.1 = å¹³å‡æ¯ä¸ªç”¨æˆ·æ¯å¤©ç™»å½•+æ³¨å†Œ+ä¿¡æ¯ä¿®æ”¹</li>
<li>å³°å€¼Peak = 100 * 3 = 300</li>
</ul>
</li>
<li><p>æŸ¥è¯¢çš„QPS çº¦</p>
<ul>
<li>100 Mç”¨æˆ· * 100æ¬¡æ¯å¤© / 86400ç§’ ~ 100kæ¬¡</li>
<li>100 = å¹³å‡æ¯ä¸ªç”¨æˆ·æ¯å¤©ä¸æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ç›¸å…³çš„æ“ä½œæ¬¡æ•°ï¼ˆæŸ¥çœ‹å¥½å‹ï¼Œå‘ä¿¡æ¯ï¼Œæ›´æ–°æ¶ˆæ¯ä¸»é¡µï¼‰</li>
<li>å³°å€¼Peak = 100k * 3 = 300 k</li>
</ul>
</li>
<li><p>Service æœåŠ¡ â€”â€” æ‹†åˆ†å­ç³»ç»Ÿ</p>
<ul>
<li>ä¸€ä¸ª AuthService è´Ÿè´£ç™»å½•æ³¨å†Œ</li>
<li>ä¸€ä¸ª UserService è´Ÿè´£ç”¨æˆ·ä¿¡æ¯å­˜å‚¨ä¸æŸ¥è¯¢</li>
<li>ä¸€ä¸ª FriendshipService è´Ÿè´£å¥½å‹å…³ç³»å­˜å‚¨ </li>
</ul>
</li>
<li><p>å­˜å‚¨<br>QPSä¸æ•°æ®åº“çš„å…³ç³»</p>
<ul>
<li><p>MySQL / PosgreSQL ç­‰ SQL æ•°æ®åº“çš„æ€§èƒ½<br>çº¦ 1k QPS è¿™ä¸ªçº§åˆ«</p>
</li>
<li><p>MongoDB / Cassandra ç­‰ ç¡¬ç›˜å‹NoSQL æ•°æ®åº“çš„æ€§èƒ½<br>çº¦ 10k QPS è¿™ä¸ªçº§åˆ« </p>
</li>
<li><p>Redis / Memcached ç­‰ å†…å­˜å‹NoSQL æ•°æ®åº“çš„æ€§èƒ½<br>100k ~ 1m QPS è¿™ä¸ªçº§åˆ«</p>
</li>
<li><p>ä»¥ä¸Šæ•°æ®æ ¹æ®æœºå™¨æ€§èƒ½å’Œç¡¬ç›˜æ•°é‡åŠç¡¬ç›˜è¯»å†™ã¿åº¦ä¼šæœ‰åŒºåˆ«</p>
</li>
<li><p>æ€è€ƒï¼š</p>
<ul>
<li><p>æ³¨å†Œï¼Œç™»å½•ï¼Œä¿¡æ¯ä¿®æ”¹ï¼Œ300 QPSï¼Œé€‚åˆä»€ä¹ˆæ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Ÿ</p>
<p>å¦‚æœæ˜¯MySQL / PosgreSQL â€”â€” 300å°<br>å¦‚æœæ˜¯MongoDB / Cassandra â€”â€” 30å°<br>å¦‚æœæ˜¯Redis / Memcached â€”â€” 3å°<br>ï¼ä½†è¿˜æ˜¯è¦æ ¹æ®æ•°æ®åº“çš„åŸºæœ¬ä¿¡æ¯é€‰æ‹©</p>
</li>
<li><p>ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢é€‚åˆä»€ä¹ˆæ•°æ®å­˜å‚¨ç³»ç»Ÿ ï¼Ÿ</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="UserService-æœåŠ¡">1. UserService  æœåŠ¡</h1><p><strong>ç”¨æˆ·ä¿¡æ¯å­˜å‚¨ä¸æŸ¥è¯¢</strong></p>
<p>ç”¨æˆ·ç³»ç»Ÿç‰¹ç‚¹ï¼šè¯»éå¸¸å¤šï¼Œå†™éå¸¸å°‘ã€‚<strong>å¯¹äºè¯»å¤šå†™å°‘çš„ç³»ç»Ÿï¼Œä¸€å®šè¦ä½¿ç”¨Cacheä¼˜åŒ–</strong>ã€‚</p>
<p>é—®é¢˜ï¼šçˆ¬è™«ç³»ç»Ÿæ˜¯è¯»å¤šå†™å°‘è¿˜æ˜¯å†™å¤šè¯»å°‘ï¼Ÿâ€”â€”å†™å¤šè¯»å°‘ã€‚ç»™äººç”¨çš„ï¼Œä¸€èˆ¬æ˜¯è¯»å¤šå†™å°‘ã€‚ç»™æœºå™¨ç”¨çš„ï¼Œä¸€èˆ¬æ˜¯è¯»å°‘å†™å¤šã€‚</p>
<p><strong>Cache</strong></p>
<ul>
<li>Cache æ˜¯ä»€ä¹ˆï¼Ÿ<ul>
<li>ç¼“å­˜ï¼ŒæŠŠä¹‹åå¯èƒ½è¦æŸ¥è¯¢çš„ä¸œè¥¿å…ˆå­˜ä¸€ä¸‹<br>ä¸‹æ¬¡è¦çš„æ—¶å€™ï¼Œç›´æ¥ä»è¿™é‡Œæ‹¿ï¼Œæ— éœ€é‡æ–°è®¡ç®—å’Œå­˜å–æ•°æ®åº“ç­‰</li>
<li>å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª Java ä¸­çš„ HashMap</li>
<li>key-value çš„ç»“æ„</li>
</ul>
</li>
<li>æœ‰å“ªäº›å¸¸ç”¨çš„ Cache ç³»ç»Ÿ/è½¯ä»¶ï¼Ÿ<ul>
<li>Memcachedï¼ˆä¸æ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼‰</li>
<li>Redisï¼ˆæ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼‰</li>
</ul>
</li>
<li>Cache ä¸€å®šæ˜¯å­˜åœ¨å†…å­˜ä¸­ä¹ˆï¼Ÿ<ul>
<li>ä¸æ˜¯</li>
<li>Cache è¿™ä¸ªæ¦‚å¿µï¼Œå¹¶æ²¡æœ‰æŒ‡å®šå­˜åœ¨ä»€ä¹ˆæ ·çš„å­˜å‚¨ä»‹è´¨ä¸­</li>
<li>File System ä¹Ÿå¯ä»¥åšCache â€”â€” ç›¸å¯¹äºç½‘ç»œè€Œè¨€ï¼Œæ¯”å¦‚è®¿é—®æœ¬åœ°ç¡¬ç›˜æ¯”è®¿é—®ç½‘ç»œå¿«ã€‚å¯ä»¥åœ¨æœ¬åœ°åšCache</li>
<li>CPU ä¹Ÿæœ‰ Cache</li>
</ul>
</li>
<li>Cache ä¸€å®šæŒ‡ Server Cache ä¹ˆï¼Ÿ<br>ä¸æ˜¯ï¼ŒFrontend / Client / Browser ä¹Ÿå¯èƒ½æœ‰å®¢æˆ·ç«¯çš„ Cache </li>
</ul>
<p><strong>Memcached</strong> </p>
<p>Memcachedæ˜¯ä¸€æ¬¾è½¯ä»¶ï¼Œä½†æ˜¯å†…å­˜å‹çš„ï¼Œä¸åœ¨ç¡¬ç›˜æŒä¹…åŒ–ã€‚</p>
<p>ä½¿ç”¨ä¾‹å­ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-21-59-38.png" alt=""> </p>
<p>ttl â€”â€” è¿™ä¸ªkeyåœ¨è¿™ä¸ªcacheä¸­å­˜å‚¨å¤šå°‘ç§’</p>
<p>å¦‚æœä¸è®¾ç½®ttlï¼Œå¯èƒ½éšæ—¶è¢«åˆ æ‰</p>
<p>å¸¸è§ç¼“å­˜æ·˜æ±°ç®—æ³•ï¼šLFU Cache, LRU Cache ,è¿™ä¸¤ä¸ªç®—æ³•å¾ˆå¸¸è§ï¼Œè¦çœ‹çœ‹</p>
<p>è§æœ¬ç«™é“¾æ¥<a href="/2018/01/27/ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•/" title="ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•">ç³»ç»Ÿè®¾è®¡-ç¼“å­˜ç®—æ³•</a></p>
<p><strong>Cache Asideæ¨¡å‹</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-36-05.png" alt=""> </p>
<p><strong>Memcachedå¦‚ä½•ä¼˜åŒ–DBæŸ¥è¯¢ï¼Ÿ</strong></p>
<p>çœ‹ä¸‹é¢ä¸¤ä¸ªä»£ç ï¼</p>
<ol>
<li>getUser<br>å¦‚æœå­˜åœ¨ï¼Œå°±è¿”å›</li>
<li>setUser<br>å…ˆè¦æŠŠcacheé‡Œåˆ æ‰ï¼ç„¶åå†å†™å…¥dbï¼</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-03-37.png" alt=""> </p>
<p>ä¸ºä»€ä¹ˆè¦å…ˆåˆ æ‰cache,ç„¶åå†™å…¥DBå‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. å…ˆsetDB --&gt; åsetCache</div><div class="line">ä¸‡ä¸€å†™å…¥DBå¤±è´¥äº†å‘¢ï¼Ÿâ€”â€” ç³»ç»Ÿè¿”å›ç”¨æˆ·é‡è¯•ï¼Œä¸ä¼šå¯¼è‡´dbä¸cacheä¹‹é—´çš„æ•°æ®ä¸ä¸€è‡´</div><div class="line">ä¸‡ä¸€å†™å…¥cacheå¤±è´¥äº†ï¼Ÿ â€”â€” dbé‡Œæ˜¯æ–°æ•°æ®ï¼Œcacheæ˜¯å°±æ•°æ® --&gt; æ•°æ®ä¸ä¸€è‡´å“‡</div><div class="line"></div><div class="line"><span class="number">2</span>. å…ˆsetCache --&gt; å setDB</div><div class="line">ä¸‡ä¸€å“ªä¸ªæŒ‚äº†ï¼Œä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼</div><div class="line"></div><div class="line"><span class="number">3</span>. å…ˆDeleteCache --&gt; åsetDB</div><div class="line">ä¸‡ä¸€setDBæŒ‚äº†ï¼Œè¿˜æ˜¯ä¼šæ•°æ®ä¸€è‡´ï¼ŒæŒºå¥½æŒºå¥½</div><div class="line">ä½†æ˜¯ä¸èƒ½ä¿æŒæ•°æ®åŒæ­¥ï¼Œå¯èƒ½æœ‰å»¶è¿Ÿï¼ˆè·å–çš„åŒæ—¶åˆšå¥½è¢«æ”¹äº†ï¼Œggã€‚ä½†æ¦‚ç‡å°çš„å¾ˆï¼Œæ²¡å•¥ï¼‰</div><div class="line"></div><div class="line"><span class="number">3</span>. å…ˆsetDB --&gt; åDelteCache</div><div class="line">ä¸‡ä¸€DelteCacheå¤±è´¥äº†ï¼Œä¼šç•™ä¸‹è„æ•°æ®</div></pre></td></tr></table></figure>
<h1 id="AuthService-æœåŠ¡">2. AuthService æœåŠ¡</h1><ul>
<li>ç”¨æˆ·æ˜¯å¦‚ä½•å®ç°ç™»é™†ä¸ä¿æŒç™»é™†çš„ï¼Ÿ<ul>
<li>ä¼šè¯è¡¨ Session</li>
</ul>
</li>
<li>ç”¨æˆ· Login ä»¥å<ol>
<li>åˆ›å»ºä¸€ä¸ª session å¯¹è±¡</li>
<li>å¹¶æŠŠ session_keyï¼ˆå…¨å±€å”¯ä¸€çš„ï¼‰ ä½œä¸º cookie å€¼è¿”å›ç»™æµè§ˆå™¨</li>
<li>æµè§ˆå™¨å°†è¯¥å€¼è®°å½•åœ¨æµè§ˆå™¨çš„ cookie ä¸­</li>
<li>ç”¨æˆ·æ¯æ¬¡å‘æœåŠ¡å™¨å‘é€çš„è®¿é—®ï¼Œéƒ½ä¼šè‡ªåŠ¨å¸¦ä¸Šè¯¥ç½‘ç«™æ‰€æœ‰çš„ cookie</li>
<li>æ­¤æ—¶æœåŠ¡å™¨æ£€æµ‹åˆ°cookieä¸­çš„session_keyæ˜¯æœ‰æ•ˆçš„ï¼Œå°±è®¤ä¸ºç”¨æˆ·ç™»é™†äº†</li>
</ol>
</li>
<li>ç”¨æˆ· Logout ä¹‹å<ul>
<li>ä» session table é‡Œåˆ é™¤å¯¹åº”æ•°æ®</li>
</ul>
</li>
<li>é—®é¢˜ï¼šSession Table å­˜åœ¨å“ªå„¿ï¼Ÿ<ul>
<li>A: æ•°æ®åº“</li>
<li>B: ç¼“å­˜ â€”â€” æ–¹ä¾¿äº›ï¼Œä½†å¦‚æœæ˜¯å¤§ç½‘ç«™ï¼Œä¸€æ—¦æœ‰ä¸ªæœºå™¨æŒ‚äº†ï¼Œä¼šæœ‰å¥½å¤šäººåŒæ—¶ç™»å½•ã€‚ä¼šggï¼Œç®€ç›´å™©æ¢¦</li>
<li>æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šå­˜åœ¨æ•°æ®åº“é‡Œï¼Œå¦‚æœè®¿é—®è¿‡å¤šï¼Œå¯ä»¥ç”¨Cacheä¼˜åŒ–</li>
</ul>
</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-21-13.png" alt=""> </p>
<p><strong>å°ç»“</strong></p>
<ul>
<li>å¯¹äº User System è€Œè¨€<ul>
<li>å†™å¾ˆå°‘</li>
<li>è¯»å¾ˆå¤š</li>
</ul>
</li>
<li>å†™æ“ä½œå¾ˆå°‘ï¼Œæ„å‘³ç€ï¼šä»QPSçš„è§’åº¦æ¥è¯´ï¼Œä¸€å° MySQL å°±å¯ä»¥æå®šäº†</li>
<li>è¯»æ“ä½œå¾ˆå¤šï¼Œæ„å‘³ç€ï¼šå¯ä»¥ä½¿ç”¨ Memcached è¿›è¡Œè¯»æ“ä½œä¼˜åŒ–</li>
<li>è¿›ä¸€æ­¥çš„é—®é¢˜ï¼Œå¦‚æœè¯»å†™æ“ä½œéƒ½å¾ˆå¤šï¼Œæ€ä¹ˆåŠï¼Ÿ<ul>
<li>æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ›´å¤šçš„æ•°æ®åº“æœåŠ¡å™¨åˆ†æ‘Šæµé‡</li>
<li>æ–¹æ³•äºŒï¼šä½¿ç”¨åƒ Redis è¿™æ ·çš„è¯»å†™æ“ä½œéƒ½å¾ˆå¿«çš„ Cache-through å‹ Database<br>Memcached æ˜¯ä¸€ä¸ª Cache-aside å‹çš„ Databaseï¼ŒClient éœ€è¦è‡ªå·±è´Ÿè´£ç®¡ç† Cache-miss æ—¶æ•°æ®çš„ loading </li>
</ul>
</li>
</ul>
<p><strong>Redisä»‹ç»</strong></p>
<p>æ˜¯ä¸€ç§Cache-throughå‹ï¼Œå°±æ˜¯æŠŠcacheå’Œdbè¿›è¡Œäº†æ‰“åŒ…ã€‚ä¸åƒMemcachedé‚£æ ·ï¼Œcacheä¸dbæ˜¯åˆ†å¼€çš„ï¼ˆCache Asideï¼‰ï¼Œéœ€è¦è‡ªå·±å®ç°æŸ¥è¯¢çš„é€»è¾‘ã€‚</p>
<p>è€ŒRedisæ˜¯ä¸€ç§æ‰“åŒ…äº†çš„ï¼ŒDBä¸Cacheæ˜¯ä¸€èµ·çš„ã€‚ä¹Ÿå°±æ˜¯Cache-throughï¼Œå¦‚ä¸‹å›¾ï¼›</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-38-03.png" alt=""> </p>
<h1 id="FriendshipServiceæœåŠ¡">3. FriendshipServiceæœåŠ¡</h1><ul>
<li>å•å‘å¥½å‹å…³ç³»ï¼šå¾®åš<br><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-40-35.png" alt=""> </li>
<li>åŒå‘å¥½å‹å…³ç³»ï¼šå¾®ä¿¡<ul>
<li>æ–¹æ¡ˆ1ï¼šå­˜ä¸ºä¸¤æ¡ä¿¡æ¯ï¼ŒAå…³æ³¨äº†Bï¼ŒBå…³æ³¨äº†A</li>
<li>æ–¹æ¡ˆ2ï¼šå­˜ä¸ºä¸€æ¡ä¿¡æ¯ï¼ˆå•å‘è¾¹è®¤ä¸ºæ˜¯åŒå‘è¾¹ï¼Œä½†æŸ¥è¯¢å‰éœ€è¦æ’åºï¼‰ï¼Œä½†æŸ¥è¯¢çš„æ—¶å€™éœ€è¦æŸ¥ä¸¤æ¬¡ </li>
</ul>
</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-42-37.png" alt=""> </p>
<ul>
<li>å¥½å‹å…³ç³»æ‰€æ¶‰åŠçš„æ“ä½œéå¸¸ç®€å•ï¼ŒåŸºæœ¬éƒ½æ˜¯ key-valueï¼š<ul>
<li>æ±‚æŸä¸ª user çš„æ‰€æœ‰å…³æ³¨å¯¹è±¡</li>
<li>æ±‚æŸä¸ª user çš„æ‰€æœ‰ç²‰ä¸</li>
<li>A å…³æ³¨ B â†’ æ’å…¥ä¸€æ¡æ•°æ®</li>
<li>A å–å…³ B â†’ åˆ é™¤ä¸€æ¡æ•°æ® </li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®åº“çš„æ¯”è¾ƒå’Œé€‰æ‹©">3.1. æ•°æ®åº“çš„æ¯”è¾ƒå’Œé€‰æ‹©</h2><p><strong>é—®é¢˜ï¼šå¥½å‹å…³ç³»å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ</strong></p>
<ol>
<li>å¤§éƒ¨åˆ†æƒ…å†µï¼Œç”¨SQLæˆ–è€…NoSQLéƒ½è¡Œã€‚</li>
<li>éœ€è¦æ”¯æŒTransactionï¼ˆäº¤æ˜“ï¼‰çš„è¯ä¸èƒ½é€‰NoSQL<br>äº¤æ˜“åŒæ–¹å¿…é¡»åŒæ—¶æˆåŠŸã€åŒæ—¶å¤±è´¥ï¼</li>
<li>ä¸€èˆ¬SQLæ›´æˆç†Ÿï¼Œè€ŒNoSQLå¾ˆå¤šäº‹æƒ…éƒ½è¦äº²è‡ªå†™ï¼ˆvalueéœ€è¦è‡ªå·±åºåˆ—åŒ–ã€å¤šçº§ç´¢å¼•ä¹Ÿè¦è‡ªå·±å†™ï¼‰</li>
<li>å¦‚æœæƒ³çœæœåŠ¡å™¨è·å¾—æ›´é«˜æ€§èƒ½ï¼ŒNoSQLæ›´å¥½ã€‚ç¡¬ç›˜å‹çš„NoSQLè¦æ¯”SQLå¿«å¾ˆå¤šå¾ˆå¤šã€‚</li>
</ol>
<p><strong>SQLä¸NoSQLå­˜å‚¨æ–¹å¼</strong></p>
<p><strong>SQL</strong></p>
<p>SQLçš„åˆ—ä¸€èˆ¬æ˜¯æŒ‡å®šå¥½çš„ï¼Œä¸å¯ä»¥éšæ„æ·»åŠ ã€‚</p>
<p>ä¸€æ¡æ•°æ®ä¸€èˆ¬ä»¥rowä¸ºå•ä½ï¼ˆå–å‡ºæ•´ä¸ªrowä½œä¸ºä¸€æ¡æ•°æ®ï¼‰</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-23-13-29.png" alt=""> </p>
<p><strong>NoSQL</strong></p>
<p>NoSQLçš„åˆ—æ˜¯åŠ¨æ€çš„ï¼Œæ— é™å¤§ï¼Œå¯ä»¥éšæ„æ·»åŠ ã€‚</p>
<p>ä¸€æ¡æ•°æ®ä¸€èˆ¬ä»¥â€œæ ¼å­â€ä¸ºå•ä½ï¼Œ<code>row_key + column_key1-value1 + column_key2-value2 + ...</code></p>
<p>æ¯”å¦‚row_keyæ˜¯user_idï¼Œå…¶å®ƒçš„éƒ½æ˜¯ä¸€äº›å±æ€§ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-23-12-22.png" alt=""> </p>
<p>åªéœ€è¦æå‰å®šä¹‰å¥½column_keyæœ¬èº«çš„å½¢å¼ï¼ˆæ˜¯ä¸€ä¸ªintè¿˜æ˜¯ä¸€ä¸ªint+str)</p>
<p><strong>å¦‚æœå­˜åœ¨SQLé‡Œ</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-54-01.png" alt=""> </p>
<p>æŸ¥è¯¢å¥½å‹å…³ç³»æ—¶ï¼Œå¯¹äºæŒ‡å®šuser_id,åªéœ€è¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">select bigger_user_id from friendship where smaller_user_id = $user_id</div><div class="line">select smaller_user_id from friendship where bigger_user_id = $user_id</div></pre></td></tr></table></figure>
<p>å…·ä½“åœ°è¯´ï¼Œä¾‹å¦‚ï¼ˆ1å’Œ2æ˜¯å¥½å‹ï¼Œ2å’Œ3æ˜¯å¥½å‹ï¼Œ3å’Œ1æ˜¯å¥½å‹ï¼‰ </p>
<ol>
<li>å¥½å‹å…³ç³»å­˜ä¸€ä»½</li>
</ol>
<p>æŸ¥è¯¢2çš„å¥½å‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-56-58.png" alt=""> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT * from friendship</div><div class="line">WHERE bigger_user_id = 2 OR</div><div class="line">smaller_user_id = 2;</div></pre></td></tr></table></figure>
<ol>
<li>å¥½å‹å…³ç³»å­˜ä¸¤ä»½</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-26-22-57-53.png" alt=""> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SELECT * from friendship</div><div class="line">WHERE from_user_id=2</div></pre></td></tr></table></figure>
<p><strong>å¦‚æœå­˜åœ¨NoSQL</strong></p>
<p>è€Œå¦‚æœå­˜åœ¨nosqlï¼Œæ‰€ä»¥éœ€è¦æ‹†åˆ†ä¸ºä¸¤æ¡æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Açš„å¥½å‹æœ‰B: key=A, value=B</div><div class="line">Bçš„å¥½å‹æœ‰A: key=B, value=A</div></pre></td></tr></table></figure>
<p>ä»¥Cassandraä¸ºä¾‹ï¼ˆè¿™æ˜¯ä¸€é“é¢˜ï¼Œå›å»åšåšï¼‰</p>
<ul>
<li>Cassandra æ˜¯ä¸€ä¸ªä¸‰å±‚ç»“æ„çš„ NoSQL æ•°æ®åº“ <a href="http://www.lintcode.com/problem/mini-cassandra/" target="_blank" rel="external">http://www.lintcode.com/problem/mini-cassandra/</a><ul>
<li>ç¬¬ä¸€å±‚ï¼šrow_key<ul>
<li>åˆç§°ä¸º hash_key</li>
<li>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ ç»Ÿæ‰€è¯´çš„ key-value ä¸­çš„ é‚£ä¸ªkey</li>
<li>ä»»ä½•çš„æŸ¥è¯¢éƒ½éœ€è¦å¸¦ä¸Šè¿™ä¸ªkeyï¼Œæ— æ³•è¿›è¡Œrange query</li>
<li>æœ€å¸¸ç”¨çš„row_key: user_id</li>
</ul>
</li>
<li>ç¬¬äºŒå±‚ï¼šcolumn_key<ul>
<li>æ˜¯æ’åºçš„ï¼Œå¯ä»¥è¿›è¡Œrange query</li>
<li>å¯ä»¥æ˜¯å¤åˆå€¼ï¼Œæ¯”å¦‚æ˜¯ä¸€ä¸ª timestamp + user_id çš„ç»„åˆ</li>
</ul>
</li>
<li>ç¬¬ä¸‰å±‚ï¼švalue</li>
<li>ä¸€èˆ¬æ¥è¯´æ˜¯ String</li>
<li>å¦‚æœä½ éœ€è¦å­˜å¾ˆå¤šçš„ä¿¡æ¯çš„è¯ï¼Œä½ å¯ä»¥è‡ªå·±åš Serialization<br>ä»€ä¹ˆæ˜¯ Serialization: æŠŠä¸€ä¸ª object / hash åºåˆ—åŒ–ä¸ºä¸€ä¸ª stringï¼Œæ¯”å¦‚æŠŠä¸€æ£µäºŒå‰æ ‘åºåˆ—åŒ–</li>
<li><a href="http://www.lintcode.com/problem/binary-tree-serialization/" target="_blank" rel="external">http://www.lintcode.com/problem/binary-tree-serialization/</a> </li>
</ul>
</li>
</ul>
<p>å¦‚æœæŠŠfriendShipæ”¾åœ¨Cassandraé‡Œï¼Œæ€ä¹ˆæ”¾ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">row_key ------ user id</div><div class="line"></div><div class="line">col_key ----- other user id</div><div class="line"></div><div class="line">value ----- å…¶å®ƒä¸œè¥¿</div></pre></td></tr></table></figure>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-14-50-11.png" alt=""> </p>
<h1 id="ç³»ç»Ÿå¦‚ä½•æ‰©å±•ï¼Ÿ">4. ç³»ç»Ÿå¦‚ä½•æ‰©å±•ï¼Ÿ</h1><p>100M çš„ç”¨æˆ·å­˜åœ¨ä¸€å° MySQL æ•°æ®åº“é‡Œä¹Ÿå­˜å¾—ä¸‹ï¼ŒStorageæ²¡é—®é¢˜ã€‚é€šè¿‡ Cache ä¼˜åŒ–è¯»æ“ä½œåï¼Œåªæœ‰ 300QPS çš„å†™ï¼ŒQPSä¹Ÿæ²¡é—®é¢˜ã€‚</p>
<p>é™¤äº†QPSï¼Œè¿˜éœ€è¦è€ƒè™‘ä»€ä¹ˆï¼Ÿ</p>
<h2 id="å•ç‚¹å¤±æ•ˆé—®é¢˜">4.1. å•ç‚¹å¤±æ•ˆé—®é¢˜</h2><ol>
<li>æ•°æ®æ‹†åˆ† Sharding / Hashkey <ol>
<li>æŒ‰ç…§ä¸€å®šçš„è§„åˆ™ï¼Œå°†æ•°æ®æ‹†åˆ†æˆä¸åŒçš„éƒ¨åˆ†ï¼Œä¿å­˜åœ¨ä¸åŒçš„æœºå™¨ä¸Š</li>
<li>è¿™æ ·å°±ç®—æŒ‚ä¹Ÿä¸ä¼šå¯¼è‡´ç½‘ç«™ 100% ä¸å¯ç”¨</li>
</ol>
</li>
<li>æ•°æ®å¤‡ä»½ Replica<ol>
<li>é€šå¸¸çš„åšæ³•æ˜¯ä¸€å¼ä¸‰ä»½ï¼ˆé‡è¦çš„äº‹æƒ…â€œå†™â€ä¸‰éï¼‰</li>
<li>Replica åŒæ—¶è¿˜èƒ½åˆ†æ‘Šè¯»è¯· </li>
</ol>
</li>
</ol>
<p>Cassandraä¸ºä¾‹çš„NoSQLè‡ªå¸¦Shardingï¼</p>
<p>SQLä¸å¸¦Shardingï¼Œè¦ç¨‹åºå‘˜è‡ªå·±å†™</p>
<h3 id="æ•°æ®æ‹†åˆ†">4.1.1. æ•°æ®æ‹†åˆ†</h3><p><strong>çºµå‘åˆ‡åˆ†ï¼š</strong></p>
<p>ä¸åŒçš„è¡¨æ”¾åœ¨ä¸åŒçš„æ•°æ®åº“ï¼Œæˆ–è€…æŒ‰ç…§ä½¿ç”¨é¢‘ç‡å°†ä¸åŒåˆ—æ”¾åœ¨ä¸åŒçš„æ•°æ®åº“ã€‚æ¯”å¦‚UserNameè¿™äº›ä¸æ€ä¹ˆè®¿é—®ï¼Œå¯ä»¥æ”¾åœ¨ä¸€ä¸ªæ•°æ®åº“ã€‚è€Œæ¨é€ä»€ä¹ˆçš„å¯ä»¥æ”¾åœ¨å¦ä¸€ä¸ªæ•°æ®åº“ã€‚</p>
<p>ç¼ºç‚¹ï¼šä¸‡ä¸€æŸå¼ è¡¨ç‰¹åˆ«å¤§ï¼Œæ¯”å¦‚æœ‰70äº¿ç”¨æˆ·ï¼Ÿè¿˜æ˜¯æœ‰å•ç‚¹å¤±æ•ˆé—®é¢˜ã€‚</p>
<p><strong>æ¨ªå‘åˆ‡åˆ†</strong></p>
<p>ä¸€ä¸ªè¡¨æ”¾åœ¨å¤šä¸ªæœºå™¨é‡Œã€‚å„æ”¾ä¸€ä»½ã€‚æ¯”å¦‚æœ‰10å°æœºå™¨ï¼Œæ•°æ®æŒ‰ç…§n%10å­˜å‚¨ã€‚</p>
<p>é—®é¢˜ï¼šåŠ å…¥ç°åœ¨æ–°åŠ äº†ä¸€å°ï¼Œé‚£ä¹ˆæ¯æ¡æ•°æ®éƒ½è¦æŒ‰ç…§n%11è¿›è¡Œé‡æ–°å­˜æ”¾ã€‚è¿‡å¤šæ•°æ®è¿ç§»ä¼šé€ æˆå¾ˆå¤šé—®é¢˜ï¼š</p>
<ol>
<li>æ…¢ï¼Œç‰µä¸€å‘åŠ¨å…¨èº«</li>
<li>è¿ç§»æœŸé—´ï¼ŒæœåŠ¡å™¨å‹åŠ›å¢å¤§ï¼Œå®¹æ˜“æŒ‚</li>
<li>å®¹æ˜“ã€æˆæ•°æ®çš„ä¸ä¸€è‡´æ€§ </li>
</ol>
<p>ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œå·¦å›¾å¯¹æ¯ä¸ªæ•°æ®%3ï¼Œé‚£ä¹ˆ0369å°±åœ¨ä¸€ä¸ªdbé‡Œï¼Œ14610åœ¨ä¸€ä¸ªdbï¼Œ25811åœ¨ä¸€ä¸ªdb</p>
<p>å³å›¾å¯¹æ¯ä¸ªæ•°æ®%4ï¼Œé‚£ä¹ˆ048åœ¨ä¸€ä¸ªdbï¼Œ159åœ¨ä¸€ä¸ªdbï¼Œ2610åœ¨ä¸€ä¸ªdbï¼Œ3711åœ¨ä¸€ä¸ªdb</p>
<p>æ©˜é»„è‰²è¡¨ç¤ºå·²ç»æŒªåŠ¨çš„æ•°æ®ï¼Œæˆ‘ä»¬å‘ç°75%çš„æ•°æ®æœ‰äº†ç§»åŠ¨ã€‚ç®€ç›´ç¾éš¾ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-15-03-16.png" alt=""> </p>
<p>è§£å†³â€”â€”<strong>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</strong>ï¼š</p>
<ul>
<li>å–æ¨¡çš„æ—¶å€™ä¸è¦æ¨¡æœºå™¨æ•°ç›®ï¼Œå¯ä»¥æ¨¡ä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œæ¯”å¦‚360ã€‚æ¯ä¸ªæœºå™¨è´Ÿè´£ä¸€æ®µåŒºé—´</li>
<li>åŒºé—´åˆ†é…ä¿¡æ¯è®°å½•ä¸ºä¸€å¼ è¡¨å­˜åœ¨ Web Server ä¸Šã€‚å¦‚ä¸‹å·¦å›¾ï¼Œå¦‚æœæ¨¡å‡ºæ¥çš„åœ¨180~359ï¼Œå°±æ”¾åœ¨DB1ï¼Œå¦‚æœæ¨¡å‡ºæ¥åœ¨0~179ï¼Œå°±æ”¾åœ¨DB0ã€‚</li>
<li>æ–°åŠ ä¸€å°æœºå™¨çš„æ—¶å€™ï¼Œåœ¨è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªä½ç½®æ’å…¥ï¼ŒåŒ€èµ°ç›¸é‚»ä¸¤å°æœºå™¨çš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</li>
<li>æ¯”å¦‚ n ä» 2 å˜åŒ–åˆ° 3ï¼Œåªæœ‰ 1/3 çš„æ•°æ®ç§»åŠ¨ </li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-27-15-05-55.png" alt=""> </p>
]]></content>
      
        <categories>
            
            <category> ç³»ç»Ÿè®¾è®¡ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-çº¿æ®µæ ‘]]></title>
      <url>/2018/01/23/%E7%AE%97%E6%B3%95-%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      <content type="html"><![CDATA[<h1 id="çº¿æ®µæ ‘å…¥é—¨">1. çº¿æ®µæ ‘å…¥é—¨</h1><p>æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª<a href="http://www.cnblogs.com/TenosDoIt/" target="_blank" rel="external">JustDoIT</a> å’Œ <a href="https://www.jiuzhang.com/article/kSiBNt/" target="_blank" rel="external">çº¿æ®µæ ‘çŸ¥è¯†ç‚¹æ€»ç»“</a></p>
<p>çº¿æ®µæ ‘ï¼Œç±»ä¼¼åŒºé—´æ ‘ï¼Œå®ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¿å­˜ä¸€æ¡çº¿æ®µï¼ˆæ•°ç»„ä¸­çš„ä¸€æ®µå­æ•°ç»„ï¼‰ï¼Œä¸»è¦ç”¨äºé«˜æ•ˆè§£å†³è¿ç»­åŒºé—´çš„åŠ¨æ€æŸ¥è¯¢é—®é¢˜ï¼Œç”±äºäºŒå‰ç»“æ„çš„ç‰¹æ€§ï¼Œå®ƒåŸºæœ¬èƒ½ä¿æŒæ¯ä¸ªæ“ä½œçš„å¤æ‚åº¦ä¸ºO(logn)ã€‚</p>
<p>çº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªåŒºé—´ï¼Œå­èŠ‚ç‚¹åˆ™åˆ†åˆ«è¡¨ç¤ºçˆ¶èŠ‚ç‚¹çš„å·¦å³åŠåŒºé—´ï¼Œä¾‹å¦‚çˆ¶äº²çš„åŒºé—´æ˜¯[a,b]ï¼Œé‚£ä¹ˆ(c=(a+b)/2)å·¦å„¿å­çš„åŒºé—´æ˜¯[a,c]ï¼Œå³å„¿å­çš„åŒºé—´æ˜¯[c+1,b]ã€‚çº¿æ®µæ ‘å½¢å¦‚ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-23-18-59-58.png" alt=""> </p>
<a id="more"></a>
<p>ä¸‹é¢æˆ‘ä»¬ä»ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ¥äº†è§£çº¿æ®µæ ‘ï¼Œé—®é¢˜æè¿°å¦‚ä¸‹:ä»æ•°ç»„arr[0â€¦n-1]ä¸­æŸ¥æ‰¾æŸä¸ªæ•°ç»„æŸä¸ªåŒºé—´å†…çš„æœ€å¤§å€¼ï¼Œå…¶ä¸­æ•°ç»„å¤§å°å›ºå®šï¼Œä½†æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ çš„å€¼å¯ä»¥éšæ—¶æ›´æ–°ã€‚ä»è¿™é¢˜å¯ä»¥çœ‹å‡ºï¼šåŒºé—´(a,b)çš„æœ€å¤§å€¼å’ŒåŒºé—´(b,c)çš„æœ€å¤§å€¼ä¸­ï¼Œå–è¾ƒå¤§çš„å°±æ˜¯åŒºé—´(a,c)çš„æœ€å¤§å€¼ã€‚å¾ˆæ˜æ˜¾è¿™ä¸ªæ“ä½œå…·æœ‰åŒºé—´çš„æ€§è´¨ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥è§£å†³è¿™ä¸ªåŒºé—´æœ€å¤§å€¼é—®é¢˜ã€‚æ ¹æ®è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æ„é€ å¦‚ä¸‹çš„äºŒå‰çº¿æ®µæ ‘ã€‚åŒºé—´çš„ç¬¬ä¸‰ç»´å°±æ˜¯åŒºé—´çš„æœ€å¤§å€¼ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-23-19-01-44.png" alt=""> </p>
<p>åŠ å…¥ç¬¬ä¸‰ç»´çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨æ„å»ºå®Œå·¦å³åŒºé—´åï¼Œæ ¹æ®å·¦å³åŒºé—´çš„æœ€å¤§å€¼æ›´æ–°å½“å‰åŒºé—´æœ€å¤§å€¼å³å¯ã€‚</p>
<p>å› ä¸ºæ¯æ¬¡å°†åŒºé—´é•¿åº¦ä¸€åˆ†ä¸ºäºŒï¼Œæ‰€æœ‰æ„é€ çš„èŠ‚ç‚¹ä¸ªæ•°ä¸ºï¼š</p>
<p>   n + 1/2 <em> n + 1/4 </em> n + 1/8 * n + â€¦</p>
<p>=   (1 + 1/2 + 1/4 + 1/8 + â€¦) * n</p>
<p>=   2n</p>
<p>æ‰€ä»¥æ„é€ çº¿æ®µæ ‘çš„æ—¶ç©ºå¤æ‚åº¦éƒ½ä¸ºO(n)ã€‚</p>
<h2 id="çº¿æ®µæ ‘å¸¸è§é¢˜å‹">1.1. çº¿æ®µæ ‘å¸¸è§é¢˜å‹</h2><p>ä¸€é“é¢˜å¯ä¸å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥åšï¼ŒåŸºæœ¬æ˜¯çœ‹è¿™é“é¢˜çš„æ“ä½œæœ‰æ²¡æœ‰<strong>åŒºé—´çš„æ€§è´¨</strong>ã€‚ä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªåŒºé—´ä¸Šçš„æ“ä½œæ˜¯å¦å¯ä»¥è½¬åŒ–ä¸ºä¸¤ä¸ªå­åŒºé—´ä¸Šçš„æ“ä½œã€‚</p>
<ul>
<li>æ±‚åŒºé—´å’Œï¼Œç§¯ï¼Œæœ€å°å€¼ï¼Œgcdç­‰</li>
<li>ä»¥å½“å‰èŠ‚ç‚¹çš„å€¼ä½œä¸ºèŠ‚ç‚¹å¤„ç†ã€‚ä¾‹å¦‚ç»™å‡ºNä¸ªæ•°å­—ï¼Œå†ç»™ä¸€ä¸ªæ•°ï¼Œé—®æ¯”è¿™ä¸ªæ•°å¤§çš„æœ‰å¤šå°‘ä¸ªã€‚</li>
<li>åŒºé—´åŠ å‡åŒä¸€ä¸ªå€¼ï¼Œæˆ–è€…åŒºé—´åŒæ—¶èµ‹ä¸€ä¸ªå€¼ã€‚</li>
</ul>
<h2 id="é“¾å¼çº¿æ®µæ ‘">1.2. é“¾å¼çº¿æ®µæ ‘</h2><p>æˆ‘ä»¬å¸¸è§çš„äºŒå‰æ ‘éƒ½æ˜¯é“¾å¼ç»“æ„ã€‚å› æ­¤æˆ‘ä»¬å…ˆå®Œæˆé“¾å¼çš„çº¿æ®µæ ‘ã€‚</p>
<p><strong>å»ºæ ‘</strong></p>
<p>å¤æ‚åº¦$O( n ) $</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">èŠ‚ç‚¹åŒºé—´å®šä¹‰</div><div class="line">(start, end) ä»£è¡¨èŠ‚ç‚¹çš„åŒºé—´èŒƒå›´</div><div class="line">max æ˜¯èŠ‚ç‚¹åœ¨(start, end)åŒºé—´ä¸Šçš„æœ€å¤§å€¼</div><div class="line">left, right æ˜¯å½“å‰èŠ‚ç‚¹åŒºé—´åˆ’åˆ†åçš„å·¦å³èŠ‚ç‚¹åŒºé—´</div><div class="line">**/</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SegmentTreeNode</span></span>&#123; <span class="comment">// èŠ‚ç‚¹</span></div><div class="line">  <span class="keyword">int</span> start, end;</div><div class="line">  <span class="keyword">int</span> max;</div><div class="line">  SegmentTreeNode left = <span class="keyword">null</span>, right = <span class="keyword">null</span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">SegmentTreeNode</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">int</span> max)</span></span>&#123;</div><div class="line">    <span class="keyword">this</span>.start = start;</div><div class="line">    <span class="keyword">this</span>.end = end;</div><div class="line">    <span class="keyword">this</span>.max = max;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ„é€ æ ‘</span></div><div class="line"><span class="function"><span class="keyword">public</span> SegmentTreeNode <span class="title">build</span><span class="params">(<span class="keyword">int</span>[] A)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> buildhelper(<span class="number">0</span>, A.length - <span class="number">1</span>, A);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å»ºæ ‘è€—æ—¶O(n)ï¼Œç©ºé—´O(n)</span></div><div class="line"><span class="function"><span class="keyword">public</span> SegmentTreeNode <span class="title">buildhelper</span><span class="params">(<span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">int</span>[] A)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(low &gt; high) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  SegmentTreeNode root = <span class="keyword">new</span> SegmentTreeNode(low, high, A[low]); <span class="comment">// æ ¹æ®èŠ‚ç‚¹åŒºé—´å·¦è¾¹ç•Œçš„å€¼ä¸ºèŠ‚ç‚¹èµ‹åˆå€¼</span></div><div class="line">  <span class="keyword">if</span>(low == high) <span class="keyword">return</span> root;</div><div class="line">  <span class="keyword">int</span> mid = (low + high) / <span class="number">2</span>; <span class="comment">// åˆ’åˆ†å½“å‰åŒºé—´çš„å·¦å³åŒºé—´</span></div><div class="line">  root.left = buildhelper(low, mid, A);</div><div class="line">  root.right = buildhelper(mid + <span class="number">1</span>, high, A);</div><div class="line">  root.max = Math.max(root.left.max, root.right.max); <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹å€¼</span></div><div class="line">  <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€äº›å˜ç§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¦‚æœéœ€è¦åŒºé—´æœ€å°å€¼</span></div><div class="line">root.min = Math.min(root.left.min, root.right.min);</div><div class="line"></div><div class="line"><span class="comment">// å¦‚æœéœ€è¦åŒºé—´å’Œ</span></div><div class="line">root.sum = root.left.sum + root.right.sum;</div></pre></td></tr></table></figure>
<p><strong>åŒºé—´æŸ¥è¯¢</strong></p>
<p>å¤æ‚åº¦ $O(log(n))$</p>
<p>æ„é€ çº¿æ®µæ ‘ç›®çš„æ˜¯ä¸ºäº†æ›´å¿«åœ°æŸ¥è¯¢ã€‚ä¾‹å¦‚ç»™å®šåŒºé—´ï¼Œè¦æ±‚åŒºé—´ä¸­çš„æœ€å¤§å€¼ã€‚è€Œçº¿æ®µæ ‘çš„åŒºé—´æŸ¥è¯¢æ“ä½œå°±æ˜¯å°†å½“å‰åŒºé—´åˆ†è§£ä¸ºè¾ƒå°çš„å­åŒºé—´ï¼Œç„¶åç”±å­åŒºé—´çš„æœ€å¤§å€¼å°±å¯ä»¥å¿«é€Ÿå¾—åˆ°éœ€è¦æŸ¥è¯¢åŒºé—´çš„æœ€å¤§å€¼ã€‚ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">query(<span class="number">1</span>,<span class="number">3</span>) = max(query(<span class="number">1</span>,<span class="number">1</span>), query(<span class="number">2</span>,<span class="number">3</span>)) = max(<span class="number">4</span>,<span class="number">3</span>) = <span class="number">4</span></div></pre></td></tr></table></figure>
<p>æŸ¥è¯¢å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(SegmentTreeNode root, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(low == root.start &amp;&amp; root.end == high)&#123;</div><div class="line">    <span class="comment">// å¦‚æœæŸ¥è¯¢åŒºé—´å°±æ˜¯å½“å‰èŠ‚ç‚¹åŒºé—´ï¼Œç›´æ¥è¾“å‡ºç»“æœ</span></div><div class="line">    <span class="keyword">return</span> root.max;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> mid = (root.start + root.end) / <span class="number">2</span>; <span class="comment">// å°†å½“å‰èŠ‚ç‚¹åŒºé—´åˆ†å‰²ä¸ºå·¦å³ä¸¤ä¸ªåŒºé—´</span></div><div class="line">  <span class="keyword">int</span> ans = Integer.MIN_VALUE;</div><div class="line">  <span class="comment">/**</span></div><div class="line">  [root.left,...,mid,...,root.right]</div><div class="line">         [low,                     high]</div><div class="line">  **/</div><div class="line">  <span class="keyword">if</span>(mid &gt;= low)&#123; <span class="comment">// å¦‚æœæŸ¥è¯¢åŒºé—´ä¸å·¦å­èŠ‚ç‚¹æœ‰äº¤é›†ï¼Œåˆ™æŸ¥è¯¢åŒºé—´çš„æœ€å¤§å€¼æœ‰å¯èƒ½æ˜¯å·¦å­èŠ‚ç‚¹çš„æœ€å¤§å€¼ã€‚</span></div><div class="line">    ans = Math.max(ans, query(root.left, low, high));</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(mid + <span class="number">1</span> &lt;= high)&#123; <span class="comment">// å¦‚æœæŸ¥è¯¢åŒºé—´ä¸å³å­èŠ‚ç‚¹æœ‰äº¤é›†ï¼Œåˆ™æŸ¥è¯¢åŒºé—´çš„æœ€å¤§å€¼æœ‰å¯èƒ½æ˜¯å³å­èŠ‚ç‚¹çš„æœ€å¤§å€¼ã€‚</span></div><div class="line">    ans = Math.max(ans, query(root.right, low, high));</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> ans;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å•ç‚¹æ›´æ–°</strong></p>
<p>å¤æ‚åº¦ $O(log(n))$</p>
<p>æ›´æ–°åºåˆ—ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¦‚ä½•æŠŠè¿™ç§å˜åŒ–ä½“ç°åˆ°çº¿æ®µæ ‘ä¸­å‘¢ï¼Ÿ</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-23-20-15-07.png" alt=""> </p>
<p>ä¾‹å¦‚è¦å°†ç¬¬4ä¸ªç‚¹æ›´æ–°ä¸º5.å°±è¦å˜åŠ¨3ä¸ªåŒºé—´çš„å€¼ï¼Œåˆ†åˆ«ä¸º[3,3], [2,3], [0,3]</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-23-20-16-03.png" alt=""> </p>
<p>æ”¹åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸è¿™ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å¶å­ç»“ç‚¹éƒ½è¦å˜åŠ¨ã€‚å¹¶ä¸”ï¼Œè¿™ä¸ªèŠ‚ç‚¹å˜åŠ¨åï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„å±æ€§å€¼ä¹Ÿæœ‰å¯èƒ½ä¼šå˜åŠ¨ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å°è±¡åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹çš„å±æ€§å€¼ï¼ˆä¾‹å¦‚å¯èƒ½å½±å“åˆ°æœ€å¤§å€¼ï¼‰ã€‚æ‰€ä»¥éœ€è¦ä»å¶å­èŠ‚ç‚¹ä¸€è·¯èµ°åˆ°æ ¹èŠ‚ç‚¹ã€‚</p>
<p>å•ç‚¹æ›´æ–°å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(SegmentTreeNode root, <span class="keyword">int</span> idx, <span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(root.start == root.end &amp;&amp; root.start == idx)&#123; <span class="comment">// æ‰¾åˆ°è¦æ”¹åŠ¨çš„å¶å­èŠ‚ç‚¹</span></div><div class="line">    root.max = val; </div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> mid = (root.start + root.end) / <span class="number">2</span>; <span class="comment">// å°†å½“å‰èŠ‚ç‚¹åŒºé—´åˆ†å‰²ä¸º2ä¸ªåŒºé—´</span></div><div class="line">  <span class="keyword">if</span>(idx &lt;= mid)&#123; <span class="comment">// å¦‚æœä¿®æ”¹èŠ‚ç‚¹åœ¨å·¦è¾¹</span></div><div class="line">    modify(root.left, idx, val);</div><div class="line">  &#125;<span class="keyword">else</span>&#123; <span class="comment">// å¦‚æœä¿®æ”¹èŠ‚ç‚¹åœ¨å³è¾¹</span></div><div class="line">    modify(root.right, idx, val);</div><div class="line">  &#125;</div><div class="line">  root.max = Math.max(root.right.max, root.left.max) ;<span class="comment">// æ›´æ–°</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„å¼çº¿æ®µæ ‘">1.3. æ•°ç»„å¼çº¿æ®µæ ‘</h2><p>ç”±äºè¾“å…¥çš„æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆæ ‘èŠ‚ç‚¹ä¸ªæ•°ä¸ä¼šå˜åŒ–ï¼Œè€Œä¸”çº¿æ®µæ ‘æ˜¯è¶‹äºå®Œå…¨äºŒå‰æ ‘çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨æ•°ç»„å½¢å¼çš„çº¿æ®µæ ‘ã€‚</p>
<p><strong>å»ºæ ‘</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// èŠ‚ç‚¹å®šä¹‰ä¸ä¸Šé¢ä¿æŒä¸€è‡´</span></div><div class="line"><span class="comment">// (start, end) ä»£è¡¨èŠ‚ç‚¹çš„åŒºé—´èŒƒå›´</span></div><div class="line"><span class="comment">// max æ˜¯èŠ‚ç‚¹åœ¨(start, end)åŒºé—´ä¸Šçš„æœ€å¤§å€¼</span></div><div class="line"><span class="comment">// left, right æ˜¯å½“å‰èŠ‚ç‚¹åŒºé—´åˆ’åˆ†åçš„å·¦å³èŠ‚ç‚¹åŒºé—´</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SegmentTreeNode</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> start, end;</div><div class="line">  <span class="keyword">int</span> max;</div><div class="line">  SegmentTreeNode left = <span class="keyword">null</span>, right = <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line">SegmentTreeNode[] SegmentTree; <span class="comment">// æ›¿ä»£åŸæ¥çš„root</span></div><div class="line"></div><div class="line">içš„å·¦èŠ‚ç‚¹ï¼šSegmentTree[<span class="number">2</span>*i + <span class="number">1</span>]</div><div class="line">içš„å³èŠ‚ç‚¹ï¼šSegmentTree[<span class="number">2</span>*i]</div><div class="line"></div><div class="line">å…¶å®ƒæ“ä½œéƒ½å·®ä¸å¤šï¼Œçœç•¥</div></pre></td></tr></table></figure>
<h1 id="ç›¸å…³é¢˜">2. ç›¸å…³é¢˜</h1><h2 id="Range-Sum-Query-Mutable">2.1. Range Sum Query - Mutable</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚æ•°ç»„çš„iåˆ°jçš„å’Œã€‚è€Œä¸”æ•°ç»„çš„å€¼å®æ—¶æ›´æ–°ã€‚</p>
<p>è€å¥—è·¯ä¸è¡Œäº†ï¼Œå°±è¶…æ—¶äº†ã€‚å¾—æ¢æ–°å¥—è·¯â€”â€”çº¿æ®µæ ‘</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// çº¿æ®µæ ‘èŠ‚ç‚¹å®šä¹‰  </span></div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">SegmentTreeNode</span></span>&#123;</div><div class="line">       <span class="keyword">int</span> start, end;</div><div class="line">       <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">       SegmentTreeNode left = <span class="keyword">null</span>, right = <span class="keyword">null</span>;</div><div class="line">       SegmentTreeNode(<span class="keyword">int</span> start, <span class="keyword">int</span> end)&#123;</div><div class="line">           <span class="keyword">this</span>.start = start;</div><div class="line">           <span class="keyword">this</span>.end = end;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="comment">// æ ‘æ ¹</span></div><div class="line">   SegmentTreeNode root;</div><div class="line">   </div><div class="line">   <span class="comment">// æ„é€ </span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">NumArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">       root = NumArrayHelper(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">private</span> SegmentTreeNode <span class="title">NumArrayHelper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(low &gt; high) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">       SegmentTreeNode node = <span class="keyword">new</span> SegmentTreeNode(low, high);</div><div class="line">       <span class="keyword">if</span>(low == high)&#123;</div><div class="line">           node.sum = nums[low];</div><div class="line">       &#125;<span class="keyword">else</span>&#123;</div><div class="line">           <span class="keyword">int</span> mid = (low + high) / <span class="number">2</span>;</div><div class="line">           node.left = NumArrayHelper(nums, low, mid);</div><div class="line">           node.right = NumArrayHelper(nums, mid + <span class="number">1</span>, high);</div><div class="line">           node.sum = node.right.sum + node.left.sum;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> node;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="comment">// æ›´æ–°èŠ‚ç‚¹</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">       updateHelper(root, i, val);</div><div class="line">   &#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">updateHelper</span><span class="params">(SegmentTreeNode node,<span class="keyword">int</span> idx, <span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(node.start == node.end)&#123;</div><div class="line">           <span class="keyword">if</span>(node.start == idx) node.sum = val;</div><div class="line">           <span class="keyword">else</span> System.out.println(<span class="string">"error"</span>);</div><div class="line">           <span class="keyword">return</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">int</span> mid = (node.start + node.end) / <span class="number">2</span>;</div><div class="line">       <span class="keyword">if</span>(idx &lt;= mid)&#123;</div><div class="line">           updateHelper(node.left, idx, val);</div><div class="line">       &#125;<span class="keyword">else</span>&#123;</div><div class="line">           updateHelper(node.right, idx, val);</div><div class="line">       &#125;</div><div class="line">       node.sum = node.left.sum + node.right.sum;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="comment">// æ±‚sum</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sumRange</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> sumRangeHelper(root, i, j);</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">sumRangeHelper</span><span class="params">(SegmentTreeNode node, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(node == <span class="keyword">null</span> || high &lt; node.start || low &gt; node.end) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       <span class="keyword">if</span>(node.start == low &amp;&amp; node.end == high) <span class="keyword">return</span> node.sum;</div><div class="line">       <span class="comment">/**</span></div><div class="line">        *    [node.start, ...mid..., node.end] nodeæ˜¯ä¸€ä¸ªè¾ƒå¤§çš„åŒºé—´</div><div class="line">        * 1.    [low, , high]                  æŸ¥æ‰¾åŒºé—´å®Œå…¨åœ¨å·¦å­åŒºé—´</div><div class="line">        * 2.                    [low....high]  æŸ¥æ‰¾åŒºé—´å®Œå…¨åœ¨å³å­åŒºé—´</div><div class="line">        * 3.     [low, ..........,high]        æŸ¥æ‰¾åŒºé—´è·¨è¶Šå·¦å³å­åŒºé—´      **/</div><div class="line">       <span class="keyword">int</span> mid = (node.start + node.end) / <span class="number">2</span>;</div><div class="line">       <span class="keyword">if</span>(high &lt;= mid)&#123;</div><div class="line">           <span class="keyword">return</span> sumRangeHelper(node.left, low, high);</div><div class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(low &gt; mid)&#123;</div><div class="line">           <span class="keyword">return</span> sumRangeHelper(node.right,low, high);</div><div class="line">       &#125;<span class="keyword">else</span>&#123;</div><div class="line">           <span class="keyword">return</span> sumRangeHelper(node.left, low, mid) + sumRangeHelper(node.right, mid + <span class="number">1</span>, high);</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç³»ç»Ÿè®¾è®¡-è®¾è®¡Uber]]></title>
      <url>/2018/01/21/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1-%E8%AE%BE%E8%AE%A1Uber/</url>
      <content type="html"><![CDATA[<p>å¤§çº²</p>
<ul>
<li>Uber ä» 0  åˆ° 1</li>
<li>Uber ä» 1 åˆ° 1ä¸‡</li>
<li>S2 ï¼š åœ°ç†ä¿¡æ¯åº“</li>
<li>Ringpop</li>
</ul>
<a id="more"></a>
<p><strong>ä»€ä¹ˆæ˜¯Uberï¼Ÿ</strong></p>
<p>ä¸€é”®æ‰“è½¦</p>
<p><strong>å¾ˆä¹…ä»¥å‰çš„Uber</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-16-54-01.png" alt=""> </p>
<p><strong>é—®é¢˜ï¼šQPS(æ¯ç§’è¯·æ±‚)æ˜¯å¤šå°‘å‘¢ï¼Ÿ</strong></p>
<p>åˆ†æé—®é¢˜ï¼šè¯·æ±‚æœ‰å“ªäº›ï¼Ÿ</p>
<ol>
<li>driverçš„å†™æœåŠ¡ : 100ä¸ªè½¦ ï¼Œ 4ç§’ä¸€æ¬¡ = 25</li>
<li>userçš„è¯»æœåŠ¡ : ä¼šè¯»ä¸€ä¸ªèŒƒå›´å†…çš„</li>
</ol>
<p><strong>é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦çº ç»“äºQPS?</strong></p>
<p>QPSç›´æ¥å†³å®šäº†åå°æœåŠ¡å™¨çš„é€‰æ‹©ï¼</p>
<p><strong>äººå¤ªå¤šæ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>æš´åŠ›æ¨ªå‘æ‰©å±•PHP</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-17-12-52.png" alt=""> </p>
<p>èƒ½ä¸èƒ½æ‰©å±•MySQLï¼Ÿ</p>
<p>å¦‚æœå°†MySQLåˆ†æˆå¥½å‡ ä¸ªæœåŠ¡å™¨å‘¢ï¼Ÿâ€”â€” è¯»çš„æ—¶å€™å¯èƒ½ä¼šå‘å„ä¸ªæœåŠ¡å™¨è¯·æ±‚ï¼Œç„¶åå†mergeå›æ¥ã€‚å¾ˆéº»çƒ¦å“‡ã€‚</p>
<p>çŸ¥è¯†ç‚¹ï¼š</p>
<p>æœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡æœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>è¿æ¥çš„è´Ÿè½½å‡è¡¡â€”â€”å¯ä»¥ç¼“å­˜ä¸‹æ¥éœ€è¦å†™å…¥çš„è¯·æ±‚</li>
</ol>
<p><strong>å…¶å®ƒæŒ‘æˆ˜</strong></p>
<ol>
<li>ä¸€ä¸ªå¸æœºèƒ½ä¸èƒ½å¸¦ä¸¤ä¸ªä¹˜å®¢ï¼Ÿï¼ˆè¿™ä¸ªæ¶æ„ä¸èƒ½è§£å†³ï¼‰</li>
<li>æœ‰æ²¡æœ‰å¯èƒ½ä¸¤ä¸ªå¸æœºä¸€ä¸ªè½¦ï¼Ÿ</li>
<li>ä¸€ä¸ªè´¦å·ä¸¤ä¸ªè½¦å‘¢ï¼Ÿ</li>
</ol>
<h1 id="è®¾è®¡">1. è®¾è®¡</h1><p><strong>ç¬¬ä¸€ä¸ªè§£å†³çš„é—®é¢˜åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>åˆ†å‘é—®é¢˜ï¼</p>
<p>æ•°æ®åº“è®¾è®¡ï¼š</p>
<ol>
<li>driver messge</li>
<li>passager message</li>
<li>driver - passager çš„å½“å‰çŠ¶æ€ ï¼š OD ã€å‡ºå‘æ—¶é—´ç­‰</li>
</ol>
<p>æ•°æ®åº“è®¾è®¡æ­¥éª¤ï¼š</p>
<ol>
<li>æ‰¾åˆ°æ‰€æœ‰å®ä½“</li>
<li>è®¾è®¡å®ä½“ä¹‹é—´çš„å…³ç³»</li>
</ol>
<p>ä¸ºä»€ä¹ˆç”¨MySQL ? </p>
<ol>
<li>ä¸€èˆ¬æ¥è¯´NoSQLä¸SQLæ€§èƒ½éƒ½å·®ä¸å¤š</li>
<li>MySQLç›¸å¯¹æ›´ç®€å•äº›</li>
</ol>
<p><strong>è¿˜ç¼ºä¸ªå•¥ï¼Ÿ</strong></p>
<p>æŒä¹…åŒ–çš„æ”¯ä»˜å¹³å°ï¼ï¼ˆBusiness Logicï¼‰</p>
<p>ä¸ºå•¥ç”¨python ? å› ä¸ºåå°å¤„ç†æ•°æ®æ›´æ–¹ä¾¿</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-17-27-46.png" alt=""> </p>
<p><strong>å‡çº§</strong></p>
<p>å½“è¯·æ±‚è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œå°±éœ€è¦ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</p>
<p>æœ€å¤§çš„è¯·æ±‚ï¼šå¸æœºåœ°ç†ä½ç½®çš„æ›´æ–°ï¼</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-17-29-48.png" alt=""> </p>
<p>mongoDBæ˜¯æ–‡æ¡£å‹çš„ï¼Œå¯¹æ¥è¿™ç§logæ˜¯éå¸¸å¥½çš„</p>
<p>å†å‡çº§ï¼Ÿ</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-17-32-22.png" alt=""> </p>
<p>js - æœåŠ¡é€»è¾‘</p>
<p>py - æ•°æ®é€»è¾‘</p>
<p><strong>å¦‚ä½•é¿å…å•ç‚¹å¤±è´¥ï¼Ÿ</strong></p>
<p>master - slaveæ¶æ„</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-21-17-34-17.png" alt=""> </p>
<ol>
<li>çƒ­å¤‡ä»½ï¼šå½“masteræŒ‚æ‰åç”¨slave</li>
<li>å¦‚æœèµ„æºæœ‰é™ï¼Œå¯ä»¥å¯¹å¤–å¼€æ”¾slaveçš„è¯»çš„æƒé™</li>
</ol>
<p>å„åŒºä¿¡æ¯éœ€è¦åŒæ­¥å—ï¼Ÿ</p>
<ol>
<li>ä¸€èˆ¬ä¸éœ€è¦</li>
<li>ä½†æ˜¯ï¼ï¼ï¼ï¼ç”¨æˆ·æ•°æ®ï¼ï¼ï¼ˆä¸‡ä¸€æœ‰çš„äººè·‘å»å›½å¤–å‘¢ï¼‰</li>
</ol>
<p>è¿™æ ·åˆ†åŒºï¼Œå¤©ç„¶ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ä¸‡ä¸€æœ‰ç”¨æˆ·åˆšå¥½åœ¨åˆ†å‰²çº¿ä¸Šã€‚ã€‚ã€‚ã€‚</p>
]]></content>
      
        <categories>
            
            <category> ç³»ç»Ÿè®¾è®¡ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-ä½æ“ä½œ]]></title>
      <url>/2018/01/19/%E7%AE%97%E6%B3%95-%E4%BD%8D%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<h2 id="ç›¸å…³é¢˜">0.1. ç›¸å…³é¢˜</h2><h2 id="Bitwise-AND-of-Numbers-Range">0.2. Bitwise AND of Numbers Range</h2><p>æ±‚m ~ nä¹‹é—´æ‰€æœ‰æ•°å­—çš„ä¸ã€‚</p>
<p>æ€è·¯ï¼šä¸€å¼€å§‹å°±æ˜¯æš´åŠ›ä¸ã€‚ä½†è¿™æ ·è¶…æ—¶äº†ã€‚</p>
<p>å‚è€ƒèµ„æ–™<a href="http://www.cnblogs.com/grandyang/p/4431646.html" target="_blank" rel="external">[LeetCode] Bitwise AND of Numbers Range æ•°å­—èŒƒå›´ä½ç›¸ä¸</a></p>
<p>æˆ‘ä»¬å…ˆä»é¢˜ç›®ä¸­ç»™çš„ä¾‹å­æ¥åˆ†æï¼Œ[5, 7]é‡Œå…±æœ‰ä¸‰ä¸ªæ•°å­—ï¼Œåˆ†åˆ«å†™å‡ºå®ƒä»¬çš„äºŒè¿›åˆ¶ä¸ºï¼š</p>
<p>101ã€€ã€€110ã€€ã€€111</p>
<p>ç›¸ä¸åçš„ç»“æœä¸º100ï¼Œä»”ç»†è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œæœ€åçš„æ•°æ˜¯è¯¥æ•°å­—èŒƒå›´å†…æ‰€æœ‰çš„æ•°çš„å·¦è¾¹å…±åŒçš„éƒ¨åˆ†ï¼Œå¦‚æœä¸Šé¢é‚£ä¸ªä¾‹å­ä¸å¤ªæ˜æ˜¾ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªèŒƒå›´[26, 30]ï¼Œå®ƒä»¬çš„äºŒè¿›åˆ¶å¦‚ä¸‹ï¼š</p>
<p>11010ã€€ã€€11011ã€€ã€€11100ã€€ã€€11101ã€€ã€€11110</p>
<p>å‘ç°äº†è§„å¾‹åï¼Œæˆ‘ä»¬åªè¦å†™ä»£ç æ‰¾åˆ°å·¦è¾¹å…¬å…±çš„éƒ¨åˆ†å³å¯ã€‚</p>
<p>ç›´æ¥å¹³ç§»må’Œnï¼Œæ¯æ¬¡å‘å³ç§»ä¸€ä½ï¼Œç›´åˆ°må’Œnç›¸ç­‰ï¼Œè®°å½•ä¸‹æ‰€æœ‰å¹³ç§»çš„æ¬¡æ•°iï¼Œç„¶åå†æŠŠmå·¦ç§»iä½å³ä¸ºæœ€ç»ˆç»“æœï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rangeBitwiseAnd</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">       <span class="comment">// ç»Ÿè®¡må’Œnçš„é«˜ä½ç›¸ç­‰çš„ä¸ªæ•°</span></div><div class="line">       <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">       <span class="keyword">while</span> (m != n)&#123;</div><div class="line">           m = m &gt;&gt; <span class="number">1</span>;</div><div class="line">           n = n &gt;&gt; <span class="number">1</span>;</div><div class="line">           ++counter;</div><div class="line">       &#125;</div><div class="line">       <span class="comment">// å°†må·¦ç§»counteræ¬¡å°±æ˜¯ç»“æœ</span></div><div class="line">       <span class="keyword">return</span> m &lt;&lt; counter;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Single-Number">0.3. Single Number</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ˜¯å•ä¸ªå‡ºç°çš„ï¼Œå…¶å®ƒéƒ½æ˜¯æˆå¯¹å‡ºç°ã€‚æ‰¾åˆ°è¿™ä¸ªå…ƒç´ ã€‚</p>
<p>æ€è·¯ï¼šç”±äº<code>x ^ 0 = x, x ^ x = 0 , å› æ­¤  x ^ x ^ y ^ z ^ z = y</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> Integer.MIN_VALUE;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> res = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</div><div class="line">            res ^= nums[i];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Reverse-Bits">0.4. Reverse Bits</h2><p>å°†æ— ç¬¦å·æ•´æ•°æŒ‰ä½åè½¬ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">reverseBits</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123; <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œä¸å¯ä»¥ç”¨ n &gt; 0çš„åˆ¤æ–­ï¼å› ä¸ºæ˜¯æ— ç¬¦å·çš„ï¼</span></div><div class="line">            result &lt;&lt;= <span class="number">1</span>;</div><div class="line">            result += (n &amp; <span class="number">1</span>); <span class="comment">// n &amp; 1 == n % 2</span></div><div class="line">            n &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Number-of-1-Bits">0.5. Number of 1 Bits</h2><p>æ±‚ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°çš„1bitçš„ä¸ªæ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hammingWeight</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)&#123;</div><div class="line">            counter += (n &amp; <span class="number">1</span>);</div><div class="line">            n &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Maximum-Product-of-Word-Lengths">0.6. Maximum Product of Word Lengths</h2><p>ç»™ä¸€äº›strã€‚æ±‚ä¸¤ä¸ªæ²¡æœ‰å…±æœ‰å­—æ¯çš„wordçš„é•¿åº¦ä¹˜ç§¯çš„æœ€å¤§å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProduct</span><span class="params">(String[] words)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[] bitCount = <span class="keyword">new</span> <span class="keyword">int</span>[words.length];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.length; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : words[i].toCharArray())&#123;</div><div class="line">            bitCount[i] |= (<span class="number">1</span> &lt;&lt; (c-<span class="string">'a'</span>)); <span class="comment">// å°†ç¬¬c-'a'ä½ ç½®ä¸º1</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.length; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; words.length; ++j)&#123;</div><div class="line">            <span class="keyword">if</span>((bitCount[i] &amp; bitCount[j]) == <span class="number">0</span>)&#123; <span class="comment">// å¦‚æœword[i]å’Œword[j]çš„ä¸ä¸º0ï¼Œåˆ™è¯´æ˜æ²¡æœ‰å…±æœ‰çš„å­—æ¯</span></div><div class="line">                max = Math.max(words[i].length() * words[j].length(), max);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> max;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç³»ç»Ÿè®¾è®¡-æ–°é²œäº‹ç³»ç»Ÿ]]></title>
      <url>/2018/01/15/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1-%E6%96%B0%E9%B2%9C%E4%BA%8B%E7%B3%BB%E7%BB%9F/</url>
      <content type="html"><![CDATA[<p>ç³»ç»Ÿè®¾è®¡é¢è¯•</p>
<ul>
<li>è®¾è®¡æŸç³»ç»Ÿ<ul>
<li>è®¾è®¡å¾®åš</li>
<li>è®¾è®¡Facebook</li>
<li>è®¾è®¡æ»´æ»´ã€Uber</li>
<li>è®¾è®¡å¾®ä¿¡</li>
<li>è®¾è®¡ç‚¹è¯„</li>
<li>è®¾è®¡çŸ­ç½‘å€ç³»ç»Ÿ Tiny URL</li>
<li>è®¾è®¡NoSQLæ•°æ®åº“</li>
</ul>
</li>
<li>æ‰¾é—®é¢˜<ul>
<li>ç½‘ç«™æŒ‚äº†æ€ä¹ˆåŠ</li>
<li>ç½‘ç«™å¤ªæ…¢æ€ä¹ˆåŠ</li>
<li>æµé‡å¢é•¿æ€ä¹ˆåŠ</li>
</ul>
</li>
</ul>
<a id="more"></a>
<p>è®¾è®¡æ–°é²œäº‹ç³»ç»Ÿâ€”â€”ç±»ä¼¼å¾®åšã€twitterçš„ç³»ç»Ÿã€‚</p>
<ul>
<li>ä»€ä¹ˆæ˜¯æ–°é²œäº‹ç³»ç»Ÿï¼Ÿnews feed ?<ul>
<li>æœ‹å‹åœˆã€å¾®åšçš„ä¿¡æ¯æµ</li>
<li>æœ‹å‹ä¿¡æ¯é›†åˆ</li>
</ul>
</li>
<li>æ ¸å¿ƒå› ç´ ï¼Ÿ<ul>
<li>å…³æ³¨ã€è¢«å…³æ³¨</li>
<li>æ¯ä¸ªäººçœ‹åˆ°çš„æ–°é²œäº‹æ˜¯ä¸åŒçš„</li>
</ul>
</li>
</ul>
<p>å¸¸è§é”™è¯¯ï¼šæ‰®æ¼”å…³é”®è¯å¤§å¸ˆï¼ˆè´Ÿè½½å‡è¡¡ã€Memcacheã€NodeJSã€MongoDBã€MySQLã€Shardingã€Consistent Hashingã€Master Slaveã€HDFSã€Hadoopâ€¦)</p>
<p>æ€è€ƒï¼šæˆ–è®¸åªæœ‰ä¸¤ä¸ªç”¨æˆ·å‘¢ï¼Ÿ</p>
<p>ç³»ç»Ÿè®¾è®¡é¢è¯•è¯„åˆ†æ ‡å‡†ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-15-21-52-24.png" alt=""> </p>
<h1 id="ç³»ç»Ÿè®¾è®¡4Såˆ†ææ³•">1. ç³»ç»Ÿè®¾è®¡4Såˆ†ææ³•</h1><ul>
<li>Scenario åœºæ™¯<ul>
<li>éœ€è¦è®¾è®¡å“ªäº›åŠŸèƒ½ã€åˆ°å“ªä¸ªç¨‹åº¦</li>
<li>è¯¢é—®</li>
</ul>
</li>
<li>Service æœåŠ¡<ul>
<li>å°†å¤§ç³»ç»Ÿæ‹†åˆ†ä¸ºå°æœåŠ¡</li>
<li>æ‹†åˆ†ã€Applicationã€æ¨¡å—åŒ–</li>
</ul>
</li>
<li>Storage å­˜å‚¨ï¼ˆæ¯”è¾ƒæ ¸å¿ƒçš„éƒ¨åˆ†ï¼‰<ul>
<li>æ•°æ®å¦‚ä½•å­˜å‚¨ä¸è®¿é—®</li>
<li>Schema/Data/SQL/NoSQL/File System</li>
</ul>
</li>
<li>Scale å‡çº§<ul>
<li>è§£å†³ç¼ºé™·ï¼Œå¤„ç†å¯èƒ½é‡åˆ°çš„é—®é¢˜</li>
<li>Sharding/ Optimize / Special Case</li>
</ul>
</li>
</ul>
<h1 id="è®¾è®¡Twitter">2. è®¾è®¡Twitter</h1><h2 id="åœºæ™¯">2.1. åœºæ™¯</h2><p><strong>åœºæ™¯è¿é—®</strong></p>
<ul>
<li>éœ€è¦è®¾è®¡å“ªäº›åŠŸèƒ½ï¼Ÿ</li>
<li>éœ€è¦æ‰¿å—å¤šå¤§è®¿é—®é‡ï¼Ÿ<ul>
<li>DAU - 150M+ (æ—¥æ´»è·ƒç”¨æˆ· - DAU - Daily Active User)</li>
<li>MAU 313M</li>
</ul>
</li>
</ul>
<p><strong>åœºæ™¯</strong></p>
<ul>
<li>å¹¶å‘ç”¨æˆ·<ul>
<li>æ—¥æ´»è·ƒ*æ¯ä¸ªç”¨æˆ·å¹³å‡è¯·æ±‚æ¬¡æ•°/ä¸€å¤©å¤šå°‘ç§’ = â€¦ = 100k</li>
<li>å³°å€¼ Peak = Average Concurrent User * 3 ~ 300k</li>
<li>å¿«é€Ÿå¢é•¿çš„äº§å“ â€”â€” MAX peak users in 3 mouth = Peak users * 2</li>
</ul>
</li>
<li>è¯»é¢‘ç‡ â€”â€” Read QPS (Queries Per Second)<ul>
<li>300k</li>
</ul>
</li>
<li>å†™é¢‘ç‡ â€”â€” Write QPS<ul>
<li>5K</li>
</ul>
</li>
</ul>
<p><strong>åˆ†æ</strong></p>
<ul>
<li>æšä¸¾åŠŸèƒ½<ul>
<li>æ³¨å†Œã€ç™»å½•</li>
<li>ç”¨æˆ·ä¸ªäººä¸»é¡µ</li>
<li>å‘ã€åˆ†äº«å¾®åš</li>
<li>ä¸Šä¼ å›¾ç‰‡ã€è§†é¢‘</li>
<li>æœç´¢</li>
<li>æ—¶é—´çº¿ã€ä¿¡æ¯æµ</li>
<li>å…³æ³¨ã€å–å…³</li>
</ul>
</li>
<li>å¯¹åŠŸèƒ½æ’åº</li>
</ul>
<p><strong>åˆ†æå‡ºQPSæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</strong></p>
<ul>
<li>QPS = 100 :<ul>
<li>ç¬”è®°æœ¬åšWebæœåŠ¡å™¨å°±å¯ä»¥</li>
</ul>
</li>
<li>QPS = 1K <ul>
<li>å¥½ç‚¹çš„WebæœåŠ¡å™¨å°±è¡Œ</li>
<li>éœ€è¦è€ƒè™‘Single Point Failureï¼ˆä¸‡ä¸€æŸæœåŠ¡æŒ‚äº†ï¼‰</li>
</ul>
</li>
<li>QPS = 1M<ul>
<li>è€ƒè™‘å»ºè®¾ä¸€ä¸ª1000å°çš„WebæœåŠ¡å™¨é›†ç¾¤</li>
<li>éœ€è¦è€ƒè™‘ç»´æŠ¤é—®é¢˜ï¼ˆä¸‡ä¸€ä¸€å°æŒ‚äº†ï¼‰</li>
</ul>
</li>
</ul>
<p>QPSå’ŒWeb Server(æœåŠ¡å™¨) / Database(æ•°æ®åº“) ä¹‹é—´çš„å…³ç³»</p>
<ul>
<li>ä¸€å°Web Serveræ‰¿å—é‡å¤§çº¦ä¸º1kçš„QPS (è€ƒè™‘åˆ°é€»è¾‘å¤„ç†æ—¶é—´ä»¥åŠæ•°æ®åº“æŸ¥è¯¢çš„ç“¶é¢ˆ)</li>
<li>ä¸€å°SQL Database æ‰¿å—é‡æ˜¯1kçš„QPS (å¦‚æœJOINå’ŒINDEX è¯·æ±‚æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªå€¼ä¼šæ›´å°)</li>
<li>ä¸€å°NoSQL Database (Cassandra) çº¦æ‰¿å—é‡æ˜¯10kçš„QPS</li>
<li>ä¸€å°NoSQL Database (å†…å­˜cacheå‹çš„) çº¦æ‰¿å—é‡æ˜¯1Mçš„QPS</li>
</ul>
<h2 id="æœåŠ¡">2.2. æœåŠ¡</h2><p>å°†å¤§ç³»ç»Ÿæ‹†åˆ†ä¸ºå°æœåŠ¡</p>
<ul>
<li>Replay é‡æ”¾éœ€æ±‚</li>
<li>Merge å½’å¹¶éœ€æ±‚</li>
</ul>
<p>ä»€ä¹ˆæ˜¯æœåŠ¡ Service?</p>
<ul>
<li>å¯ä»¥è®¤ä¸ºæ˜¯é€»è¾‘å¤„ç†çš„æ•´åˆ</li>
<li>å¯¹äºåŒä¸€ç±»é—®é¢˜çš„é€»è¾‘å¤„ç†å½’å¹¶åœ¨ä¸€ä¸ª Service ä¸­</li>
<li>æŠŠæ•´ä¸ª System ç»†åˆ†ä¸ºè‹¥å¹²ä¸ªå°çš„ Service </li>
</ul>
<p><strong>æœåŠ¡æ‹†è§£</strong></p>
<p>ä¸€ä¸ªæ€»è·¯ç”±ï¼Œå¯¹åº”å››ä¸ªæ¨¡å—ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-15-22-43-11.png" alt=""> </p>
<h2 id="å­˜å‚¨-â€”â€”-æœ€é‡è¦">2.3. å­˜å‚¨ â€”â€” æœ€é‡è¦</h2><p>æ•°æ®å¦‚ä½•å­˜å‚¨ä¸è®¿é—®</p>
<ol>
<li>ä¸ºæ¯ä¸ª Service é€‰æ‹©å­˜å‚¨ç»“æ„</li>
<li>ç»†åŒ–è¡¨ç»“æ„ </li>
</ol>
<p>ç¨‹åº = ç®—æ³• + æ•°æ®ç»“æ„</p>
<p>ç³»ç»Ÿ = æœåŠ¡ + æ•°æ®å­˜å‚¨</p>
<p><strong>æ•°æ®å¦‚ä½•å­˜å‚¨ä¸è®¿é—®</strong> </p>
<ul>
<li>å†…å­˜<ul>
<li>ä¸€äº›ä¸´æ—¶çš„ï¼Œä¸¢äº†æ²¡å…³ç³»çš„æ•°æ®ï¼Œå¯ä»¥ä¸ç”¨æŒä¹…åŒ–</li>
</ul>
</li>
<li>å…³ç³»å‹æ•°æ®åº“ SQL Database<ul>
<li>ç»“æ„åŒ–æ•°æ® é€‚åˆæ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­</li>
<li>ç”¨æˆ·ä¿¡æ¯ User Table</li>
</ul>
</li>
<li>éå…³ç³»å‹æ•°æ®åº“ NoSQL Database<ul>
<li>å°è°ƒæŸ¥ï¼šTwitterçš„å“ªäº›ä¿¡æ¯é€‚åˆæ”¾åœ¨éå…³ç³»å‹æ•°æ®åº“ä¸­ï¼Ÿ</li>
<li>æ¨æ–‡ Tweets</li>
<li>ç¤¾äº¤å›¾è°± Social Graph (followers)</li>
</ul>
</li>
<li>æ–‡ä»¶ç³»ç»Ÿ File System<ul>
<li>å°è°ƒæŸ¥ï¼šéç»“æ„åŒ–æ•°æ® é€‚åˆæ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­</li>
<li>å›¾ç‰‡ã€è§†é¢‘ Media Files </li>
</ul>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯å¯ä»¥æŒ‰ç…§å¦‚ä¸‹å›¾æ‰€ç¤ºè®¾è®¡Twitterçš„æ•°æ®å­˜å‚¨ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-15-22-51-24.png" alt=""> </p>
<p><strong>ç»“æ„åŒ–æ•°æ®å¦‚ä½•ç»†åŒ–è¡¨ç»“æ„ï¼Ÿ</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-15-22-52-54.png" alt=""> </p>
<h3 id="è·å–feed">2.3.1. è·å–feed</h3><h4 id="Pullæ¨¡å‹-â€”â€”-ä¸»åŠ¨æ¨¡å‹">2.3.1.1. Pullæ¨¡å‹ â€”â€” ä¸»åŠ¨æ¨¡å‹</h4><p>ç”¨æˆ·æŸ¥çœ‹news feedæ—¶ï¼Œè·å–æ¯ä¸ªå¥½å‹å‰100æ¡å¾®åšï¼Œåˆå¹¶å‡ºå‰100æ¡â€”â€”Kè·¯å½’å¹¶ç®—æ³•</p>
<p>å¤æ‚åº¦ï¼š</p>
<ul>
<li>News Feed â€“&gt; å‡å¦‚æœ‰Nä¸ªå…³æ³¨å¯¹è±¡ï¼Œåˆ™å¤æ‚åº¦ = Næ¬¡db readï¼ˆä¸å¯æ¥å—çš„å¤æ‚åº¦ï¼‰ + Kè·¯å½’å¹¶ï¼ˆå¯å¿½ç•¥ï¼‰</li>
<li>Post a tweet â€“&gt; ä¸€æ¬¡db write</li>
</ul>
<p>pull åŸç†å›¾ï¼š</p>
<ol>
<li>ç”¨æˆ·è¯·æ±‚æ¶ˆæ¯</li>
<li>è·å–å…³æ³¨åˆ—è¡¨</li>
<li>è·å–å…³æ³¨åˆ—è¡¨çš„å‰100tweets</li>
<li>mergeä¹‹åè¿”å›</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-22-22-49-28.png" alt=""> </p>
<p>pullæ¨¡å‹çš„ç¼ºé™·ï¼šNæ¬¡db readså¤ªæ…¢äº†ï¼Œè€Œä¸”å®ƒå‘ç”Ÿåœ¨ç”¨æˆ·è·å¾—news feedçš„è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œç®€ç›´è‡´å‘½</p>
<h4 id="Pushæ¨¡å‹-â€”â€”-è¢«åŠ¨æ¨¡å‹">2.3.1.2. Pushæ¨¡å‹ â€”â€” è¢«åŠ¨æ¨¡å‹</h4><ol>
<li>ä¸ºç”¨æˆ·å»ºä¸€ä¸ªlistï¼Œæ¯ä¸ªç”¨æˆ·çš„å¥½å‹å‘çš„tweetséƒ½åœ¨è¿™ä¸ªç”¨æˆ·çš„listé‡Œã€‚ï¼ˆå«åš<strong>fanout</strong>)</li>
<li>ç”¨æˆ·æƒ³çœ‹æ—¶ï¼Œåªéœ€è¦ä»è¯¥listé‡Œè¯»å–æœ€æ–°çš„100æ¡å³å¯</li>
</ol>
<p>å¤æ‚åº¦åˆ†æï¼š</p>
<ul>
<li>News feed â€“&gt; 1æ¬¡db read</li>
<li>post a tweet â€“&gt; nä¸ªç²‰ä¸ï¼Œéœ€è¦næ¬¡db writes ï¼Œè™½ç„¶æ²¡æœ‰readå¿«ï¼Œä½†æ˜¯å¯ä»¥å¼‚æ­¥æ‰§è¡Œçš„</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-22-23-04-04.png" alt=""> </p>
<p>pushæ¨¡å‹çš„ç¼ºé™·ï¼šä¸åŠæ—¶ã€‚æ˜æ˜Ÿçš„followersçš„æ•°ç›®å¯èƒ½å¾ˆå¤§ï¼Œç”¨æˆ·å»¶è¿Ÿæ…¢çš„å¾ˆã€‚</p>
<h4 id="Pollä¸Pushçš„é€‰æ‹©">2.3.1.3. Pollä¸Pushçš„é€‰æ‹©</h4><p>è€ƒè™‘åˆ°åƒµå°¸ç²‰ä¸æ´»è·ƒç”¨æˆ·ï¼Œå¾ˆå¤šéƒ½æ˜¯pullæ¨¡å‹ï¼Œä¸ºäº†åŠæ—¶ã€‚</p>
<p>çƒ­é—¨Social Appçš„æ¨¡å‹<br>â€¢ Facebook â€“ Pull<br>â€¢ Instagram â€“ Push + Pull<br>â€¢ Twitter â€“ Pull</p>
<p> è¯¯åŒº<br>â€¢ ä¸åšå®šæƒ³æ³•ï¼Œæ‘‡æ‘†ä¸å®š<br>â€¢ ä¸èƒ½è¡¨ç°å‡ºTradeoffçš„èƒ½åŠ›<br>â€¢ æ— æ³•è§£å†³ç‰¹å®šçš„é—®é¢˜ </p>
<h2 id="æ‰©å±•">2.4. æ‰©å±•</h2><p>ç¬¬ä¸€æ­¥ Step 1: Optimize</p>
<ul>
<li>è§£å†³è®¾è®¡ç¼ºé™· </li>
<li>Pull vs Pushâ€”â€”Normalize vs De-normalize</li>
<li>æ›´å¤šåŠŸèƒ½è®¾è®¡ ï¼šEdit, Delete, Media, Ads</li>
<li>ä¸€äº›ç‰¹æ®Šç”¨ä¾‹ ï¼šLady Gaga, Inactive Users</li>
</ul>
<p>ç¬¬äºŒæ­¥ Step 2: Maintenance</p>
<ul>
<li>é²æ£’æ€§ Robustï¼šå¦‚æœæœ‰ä¸€å°æœåŠ¡å™¨/æ•°æ®åº“æŒ‚äº†æ€ä¹ˆåŠ</li>
<li>æ‰©å±•æ€§ Scalabilityï¼šå¦‚æœæœ‰æµé‡æš´å¢ï¼Œå¦‚ä½•æ‰©å±• </li>
</ul>
<h3 id="è§£å†³pullçš„ç¼ºé™·">2.4.1. è§£å†³pullçš„ç¼ºé™·</h3><p>æœ€æ…¢çš„éƒ¨åˆ†å‘ç”Ÿåœ¨ç”¨æˆ·è¯»è¯·æ±‚æ—¶ï¼Œé‚£ä¹ˆå¯ä»¥:</p>
<ul>
<li>åœ¨DBè®¿é—®ä¹‹å‰åŠ å…¥cache</li>
<li>cacheæ¯ä¸ªç”¨æˆ·çš„timelineï¼š<ul>
<li>Næ¬¡DBè¯·æ±‚ â€“&gt; Næ¬¡cacheè¯·æ±‚</li>
<li>trade off : å¯ä»¥è€ƒè™‘åªè€ƒè™‘æœ€è¿‘çš„1000æ¡ä¹‹ç±»çš„</li>
</ul>
</li>
<li>cacheæ¯ä¸ªç”¨æˆ·çš„news feed<ul>
<li>æ²¡æœ‰cache news feedçš„ç”¨æˆ·ï¼šå½’å¹¶Nä¸ªç”¨æˆ·æœ€è¿‘çš„100æ¡tweetsï¼Œç„¶åå–å‡ºç»“æœçš„å‰100æ¡</li>
<li>æœ‰cache news feedçš„ç”¨æˆ·ï¼šå½’å¹¶Nä¸ªç”¨æˆ·åœ¨æŸä¸ªæ—¶é—´æˆ³ä¹‹åçš„æ‰€æœ‰tweets</li>
</ul>
</li>
</ul>
<h3 id="è§£å†³pushç¼ºé™·">2.4.2. è§£å†³pushç¼ºé™·</h3><ul>
<li>æµªè´¹ç©ºé—´<ul>
<li>ä½†å…¶å®æ²¡å•¥</li>
</ul>
</li>
<li>ä¸æ´»è·ƒç”¨æˆ·<ul>
<li>ç²‰ä¸æ’åºã€‚ä½†ä¹Ÿæ²¡å•¥ä½œç”¨</li>
</ul>
</li>
<li>å¤§é‡ç²‰ä¸é—®é¢˜ï¼Œæ— è§£ã€‚å› æ­¤å¯ä»¥å°è¯•åœ¨ç°æœ‰çš„æ¨¡å‹ä¸‹</li>
</ul>
<p>è¿›è¡Œä¼˜åŒ–ã€‚è¿˜å¯ä»¥å¯¹é•¿æœŸå¢é•¿è¿›è¡Œä¼°è®¡ï¼Œå¹¶è¯„ä¼°æ˜¯å¦å€¼å¾—è½¬åŒ–æ•´ä¸ªæ¨¡å‹ã€‚</p>
<h3 id="ç»“åˆ">2.4.3. ç»“åˆ</h3><p>Push ç»“åˆ Pull çš„ä¼˜åŒ–æ–¹æ¡ˆ</p>
<ul>
<li>æ™®é€šçš„ç”¨æˆ·ä»ç„¶ Push</li>
<li>å°† Lady Gaga è¿™ç±»çš„ç”¨æˆ·ï¼Œæ ‡è®°ä¸ºæ˜æ˜Ÿç”¨æˆ·</li>
<li>å¯¹äºæ˜æ˜Ÿç”¨æˆ·ï¼Œä¸ Push åˆ°ç”¨æˆ·çš„ News Feed ä¸­</li>
<li>å½“ç”¨æˆ·éœ€è¦çš„æ—¶å€™ï¼Œæ¥æ˜æ˜Ÿç”¨æˆ·çš„ Timeline é‡Œå–ï¼Œå¹¶åˆå¹¶åˆ° News Feed é‡Œ</li>
</ul>
<p>æ‘‡æ‘†é—®é¢˜</p>
<ul>
<li>æ˜æ˜Ÿå®šä¹‰ï¼š followers &gt; 1m</li>
<li>é‚“è¶…æ‰ç²‰ï¼š é‚“è¶…æŸå¤©ä¸åœçš„å‘å¸–åˆ·å±ï¼Œäºæ˜¯å¤§å®¶æœå–å…³ï¼Œä¸€å¤©æ‰äº†å‡ åä¸‡ç²‰ï¼Œå˜æˆäº†éæ˜æ˜Ÿã€‚</li>
</ul>
<p>è§£å†³æ–¹æ³•</p>
<ul>
<li>æ˜æ˜Ÿç”¨æˆ·å‘ Tweet ä¹‹åï¼Œä¾ç„¶ç»§ç»­ Push ä»–ä»¬çš„ Tweet åˆ°æ‰€æœ‰ç”¨æˆ·çš„ News Feed é‡Œ</li>
<li>åŸæ¥çš„ä»£ç å®Œå…¨ä¸ç”¨æ”¹äº†</li>
<li>å°†å…³æ³¨å¯¹è±¡ä¸­çš„æ˜æ˜Ÿç”¨æˆ·çš„ Timeline ä¸è‡ªå·±çš„ News Feed è¿›è¡Œåˆå¹¶åå±•ç¤º</li>
<li>ä½†å¹¶ä¸å­˜å‚¨è¿›è‡ªå·±çš„ News Feed åˆ—è¡¨ï¼Œå› ä¸º Push ä¼šæ¥è´Ÿè´£è¿™ä¸ªäº‹æƒ…ã€‚ </li>
</ul>
<p>ä¸ºä»€ä¹ˆæ—¢ç„¶å¤§å®¶éƒ½ç”¨Pullï¼Œæˆ‘ä»¬ä»ç„¶è¦å­¦ä¹ Pushï¼Ÿ</p>
<ul>
<li>ç³»ç»Ÿè®¾è®¡ä¸æ˜¯é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„æ–¹æ¡ˆ</li>
<li>è€Œæ˜¯é€‰æ‹©ä¸€ä¸ªæœ€åˆé€‚çš„æ–¹æ¡ˆ</li>
<li>å¦‚æœä½ æ²¡æœ‰å¾ˆå¤§çš„æµé‡ï¼ŒPushæ˜¯æœ€ç»æµæœ€çœåŠ›çš„åšæ³•</li>
<li>ç³»ç»Ÿè®¾è®¡é¢è¯•ä¹Ÿå¹¶ä¸æ˜¯æœŸæœ›ä½ ç­”å‡ºæœ€ä¼˜çš„è§£å†³æ–¹æ³•ï¼Œè€Œæ˜¯ä»ä½ çš„åˆ†æå½“ä¸­åˆ¤æ–­ä½ å¯¹ç³»ç»Ÿçš„ç†è§£å’ŒçŸ¥è¯†å‚¨å¤‡ã€‚</li>
</ul>
<p>ä»€ä¹ˆæ—¶å€™ç”¨ Pushï¼Ÿ</p>
<ul>
<li>èµ„æºå°‘</li>
<li>æƒ³å·æ‡’ï¼Œå°‘å†™ä»£ç </li>
<li>å®æ—¶æ€§è¦æ±‚ä¸é«˜</li>
<li>ç”¨æˆ·å‘å¸–æ¯”è¾ƒå°‘</li>
<li>åŒå‘å¥½å‹å…³ç³»ï¼Œæ²¡æœ‰æ˜æ˜Ÿé—®é¢˜ï¼ˆæ¯”å¦‚æœ‹å‹åœˆï¼‰</li>
</ul>
<p>ä»€ä¹ˆæ—¶å€™ç”¨ Pull ?</p>
<ul>
<li>èµ„æºå……è¶³</li>
<li>å®æ—¶æ€§è¦æ±‚é«˜</li>
<li>ç”¨æˆ·å‘å¸–å¾ˆå¤š</li>
<li>å•å‘å¥½å‹å…³ç³»ï¼Œæœ‰æ˜æ˜Ÿé—®é¢˜ </li>
</ul>
]]></content>
      
        <categories>
            
            <category> ç³»ç»Ÿè®¾è®¡ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-HashMapçš„åŸç†æ¢ç©¶]]></title>
      <url>/2018/01/14/Java-HashMap%E7%9A%84%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/</url>
      <content type="html"><![CDATA[<h1 id="HashMapæ¦‚è¿°">1. HashMapæ¦‚è¿°</h1><p>HashMapæ˜¯åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„éåŒæ­¥å®ç°ã€‚æ­¤å®ç°æä¾›æ‰€æœ‰å¯é€‰çš„æ˜ å°„æ“ä½œï¼Œå¹¶å…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®ã€‚æ­¤ç±»ä¸ä¿è¯æ˜ å°„çš„é¡ºåºï¼Œç‰¹åˆ«æ˜¯ä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜ã€‚</p>
<p>æ­¤å®ç°å‡å®šå“ˆå¸Œå‡½æ•°å°†å…ƒç´ é€‚å½“åœ°åˆ†å¸ƒåœ¨å„æ¡¶ä¹‹é—´ï¼Œå¯ä¸ºåŸºæœ¬æ“ä½œï¼ˆgetå’Œputï¼‰æä¾›ç¨³å®šçš„æ€§èƒ½ã€‚</p>
<p>è¿­ä»£colletctionè§†å›¾æ‰€éœ€è¦çš„æ—¶é—´ä¸HashMapå®ä¾‹çš„â€œå®¹é‡â€ï¼ˆæ¡¶çš„æ•°é‡ï¼‰åŠå…¶å¤§å°ï¼ˆé”®-å€¼æ˜ å°„å…³ç³»æ•°ï¼‰æˆæ¯”ä¾‹ã€‚æ‰€ä»¥å¦‚æœè¿­ä»£æ€§èƒ½å¾ˆé‡è¦ï¼Œåˆ™ä¸èƒ½å°†åˆå§‹å®¹é‡è®¾ç½®å¾—å¤ªé«˜ï¼Œæˆ–è€…å°†åŠ è½½å› å­è®¾ç½®çš„å¤ªä½ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHashMapæ˜¯ä¸åŒæ­¥çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªHashMapï¼Œè‹¥å…¶ä¸­æŸä¸ªçº¿ç¨‹ä¿®æ”¹äº†HashMapçš„ç»“æ„ï¼ˆå³åˆ é™¤æˆ–è€…æ·»åŠ æ˜ å°„å…³ç³»ï¼‰ï¼Œé‚£ä¹ˆå¿…é¡»è¦ä¿æŒå¤–éƒ¨åŒæ­¥ã€‚</p>
<a id="more"></a>
<h1 id="HashMapçš„æ•°æ®ç»“æ„">2. HashMapçš„æ•°æ®ç»“æ„</h1><p>åœ¨Javaä¸­ï¼Œæœ€åŸºæœ¬çš„ç»“æ„å°±æ˜¯æ•°ç»„å’ŒæŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰ã€‚HashMapå°±æ˜¯ç»“åˆäº†è¿™ä¸¤ç§ç»“æ„è¿›è¡Œå®ç°ã€‚</p>
<p><strong>HashMapå®é™…ä¸Šæ˜¯ä¸€ä¸ªâ€œé“¾è¡¨æ•£åˆ—â€çš„æ•°æ®ç»“æ„ï¼Œå³æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-14-21-36-42.png" alt=""> </p>
<p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒHashMap åº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚å½“æ–°å»ºä¸€ä¸ª HashMap çš„æ—¶å€™ï¼Œå°±ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ JDK ä¸­çš„ HashMap æºç è¿›è¡Œä¸€äº›å­¦ä¹ ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹æ„é€ å‡½æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal initial capacity: "</span> +</div><div class="line">                                               initialCapacity);</div><div class="line">        <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</div><div class="line">            initialCapacity = MAXIMUM_CAPACITY;</div><div class="line">        <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal load factor: "</span> +</div><div class="line">                                               loadFactor);</div><div class="line"></div><div class="line">        <span class="comment">// Find a power of 2 &gt;= initialCapacity</span></div><div class="line">        <span class="keyword">int</span> capacity = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (capacity &lt; initialCapacity)</div><div class="line">            capacity &lt;&lt;= <span class="number">1</span>;</div><div class="line"></div><div class="line">        <span class="keyword">this</span>.loadFactor = loadFactor;</div><div class="line">        threshold = (<span class="keyword">int</span>)Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + <span class="number">1</span>);</div><div class="line">        table = <span class="keyword">new</span> Entry[capacity]; <span class="comment">// æ–°å»ºæ•°ç»„</span></div><div class="line">        useAltHashing = sun.misc.VM.isBooted() &amp;&amp;</div><div class="line">                (capacity &gt;= Holder.ALTERNATIVE_HASHING_THRESHOLD);</div><div class="line">        init();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°ç¬¬18è¡Œ<code>table = new Entry[capacity];</code> å…¶å®æ˜¯åˆ›å»ºäº†ä¸€ä¸ª<code>Entry</code> çš„æ•°ç»„ï¼Œå…¶å¤§å°ä¸º<code>capacity</code> ã€‚é‚£ä¹ˆ<code>Entry</code> åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿçœ‹ä¸€ä¸‹æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">final</span> K key; <span class="comment">//é”®</span></div><div class="line">    V value;     <span class="comment">//å€¼</span></div><div class="line">    Entry&lt;K,V&gt; next; <span class="comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ --&gt; æ„æˆäº†é“¾è¡¨</span></div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç›®å‰è¿˜æ˜¯åªç€é‡æ ¸å¿ƒçš„éƒ¨åˆ†ï¼ŒEntry æ˜¯ä¸€ä¸ª static classï¼Œå…¶ä¸­åŒ…å«äº† key å’Œ valueï¼Œä¹Ÿå°±æ˜¯é”®å€¼å¯¹ï¼Œå¦å¤–è¿˜åŒ…å«äº†ä¸€ä¸ª next çš„ Entry æŒ‡é’ˆã€‚æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºï¼šEntry å°±æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œæ¯ä¸ª Entry å…¶å®å°±æ˜¯ä¸€ä¸ª key-value å¯¹ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¿™å°±æ„æˆäº†é“¾è¡¨ã€‚</p>
<h1 id="HashMapæ ¸å¿ƒæ–¹æ³•è§£è¯»">3. HashMapæ ¸å¿ƒæ–¹æ³•è§£è¯»</h1><h2 id="put-æ–¹æ³•">3.1. put()æ–¹æ³•</h2><p><strong>æµç¨‹å›¾</strong></p>
<p>ä¸‹é¢è¿™ä¸ªæµç¨‹å›¾å¾ˆå¥½åœ°è¯´æ˜äº†æ€»è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šä¸€æ­¥æ­¥åˆ†æè¿™ä¸ªæ­¥éª¤ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-14-21-57-57.png" alt=""></p>
<p><strong>put()ä¸»æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Associates the specified value with the specified key in this map.</div><div class="line">     * If the map previously contained a mapping for the key, the old</div><div class="line">     * value is replaced.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> key key with which the specified value is to be associated</div><div class="line">     * <span class="doctag">@param</span> value value to be associated with the specified key</div><div class="line">     * <span class="doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</div><div class="line">     *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</div><div class="line">     *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</div><div class="line">     *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</div><div class="line">     */</div><div class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</div><div class="line">        <span class="comment">//å…¶å…è®¸å­˜æ”¾nullçš„keyå’Œnullçš„valueï¼Œå½“å…¶keyä¸ºnullæ—¶ï¼Œè°ƒç”¨putForNullKeyæ–¹æ³•ï¼Œæ”¾å…¥åˆ°table[0]çš„è¿™ä¸ªä½ç½®</span></div><div class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> putForNullKey(value);</div><div class="line">        </div><div class="line">		<span class="comment">//1. é€šè¿‡è°ƒç”¨hashæ–¹æ³•å¯¹keyè¿›è¡Œå“ˆå¸Œï¼Œå¾—åˆ°å“ˆå¸Œä¹‹åçš„æ•°å€¼ã€‚</span></div><div class="line">        <span class="keyword">int</span> hash = hash(key);</div><div class="line">  </div><div class="line">        <span class="comment">//2. æ ¹æ®ä¸Šä¸€æ­¥éª¤ä¸­æ±‚å‡ºçš„hashå¾—åˆ°åœ¨æ•°ç»„ä¸­æ˜¯ç´¢å¼•i</span></div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length);</div><div class="line">  </div><div class="line">        <span class="comment">//3.1 å¦‚æœiå¤„çš„Entryä¸ä¸ºnullï¼Œåˆ™å¯»æ‰¾æ˜¯å¦å­˜åœ¨è¿‡key</span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="keyword">null</span>; e = e.next) &#123;</div><div class="line">            Object k;</div><div class="line">             <span class="comment">// 3.1.1è‹¥æ›¾ç»æœ‰è¿‡keyå€¼ï¼Œåˆ™ç›´æ¥è¦†ç›–</span></div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123;</div><div class="line">                V oldValue = e.value;</div><div class="line">                e.value = value;</div><div class="line">                e.recordAccess(<span class="keyword">this</span>);</div><div class="line">                <span class="keyword">return</span> oldValue;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">		<span class="comment">// 3.2ã€3.1.2 : å¦‚æœiå¤„Entryä¸ºç©ºï¼Œæˆ–è€…ä¸æ›¾å­˜åœ¨è¿‡keyï¼Œåˆ™æ·»åŠ key</span></div><div class="line">        modCount++;</div><div class="line">        addEntry(hash, key, value, i); <span class="comment">//æ ¹æ®è®¡ç®—å‡ºçš„ hash å€¼ï¼Œå°† key-value å¯¹æ”¾åœ¨æ•°ç»„ table çš„ i ç´¢å¼•å¤„</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹æ–¹æ³•çš„æ ‡å‡†æ³¨é‡Šï¼šåœ¨æ³¨é‡Šä¸­é¦–å…ˆæåˆ°äº†ï¼Œå½“æˆ‘ä»¬ put çš„æ—¶å€™ï¼Œå¦‚æœ key å­˜åœ¨äº†ï¼Œé‚£ä¹ˆæ–°çš„ value ä¼šä»£æ›¿æ—§çš„ valueï¼Œå¹¶ä¸”å¦‚æœ key å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•è¿”å›çš„æ˜¯æ—§çš„ valueï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å› nullã€‚</p>
<p>ä»ä¸Šé¢çš„æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼šå½“æˆ‘ä»¬å¾€ HashMap ä¸­ put å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæ ¹æ® key çš„ hashCode é‡æ–°è®¡ç®— hash å€¼ï¼Œæ ¹æ® hash å€¼å¾—åˆ°è¿™ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆå³ä¸‹æ ‡ï¼‰ï¼Œå¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸Šå·²ç»å­˜æ”¾æœ‰å…¶ä»–å…ƒç´ äº†ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªä½ç½®ä¸Šçš„å…ƒç´ å°†ä»¥é“¾è¡¨çš„å½¢å¼å­˜æ”¾ï¼Œæ–°åŠ å…¥çš„æ”¾åœ¨é“¾å¤´ï¼Œæœ€å…ˆåŠ å…¥çš„æ”¾åœ¨é“¾å°¾ã€‚å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œå°±ç›´æ¥å°†è¯¥å…ƒç´ æ”¾åˆ°æ­¤æ•°ç»„ä¸­çš„è¯¥ä½ç½®ä¸Šã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œputæ–¹æ³•ä¸»è¦åšäº†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>è®¡ç®—keyçš„hashCodeå€¼ã€‚å…¶ç›®çš„æ˜¯ä¸ºäº†å°½å¯èƒ½çš„è®©é”®å€¼å¯¹å¯ä»¥åˆ†ä¸åˆ°ä¸åŒçš„æ¡¶ä¸­</li>
<li>æ ¹æ®hashCodeå¾—åˆ°åœ¨tableä¸­çš„ç´¢å¼•i</li>
<li>å°†valueæ’å…¥åˆ°tableä¸­ï¼š<ol>
<li>å¦‚æœtable[i]ä¸ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸¤ä¸ªkeyçš„hashå€¼é‡å äº†ã€‚é‚£å°±æ ¹æ®keyå°†å€¼æ’å…¥table[i]æŒ‡å‘çš„é“¾è¡¨ä¸­ï¼š<ol>
<li>è¦ä¹ˆè¦†ç›–åŸæ¥çš„å€¼ï¼ˆæ›¾ç»æœ‰è¿‡è¿™ä¸ªkeyï¼‰</li>
<li>è¦ä¹ˆæ’å…¥é“¾è¡¨æœ«å°¾ï¼ˆæ›¾ç»æ²¡æœ‰è¿‡è¿™ä¸ªkeyï¼‰ â€“&gt; è°ƒç”¨<code>addEntry()</code></li>
</ol>
</li>
<li>å¦‚æœtable[i]ä¸ºç©ºï¼Œå°±ç›´æ¥æ’å…¥ â€“&gt; è°ƒç”¨<code>addEntry()</code></li>
</ol>
</li>
</ol>
<p><strong>addEntry()æ–¹æ³•</strong></p>
<p>addEntry(hash, key, value, i)æ–¹æ³•æ ¹æ®è®¡ç®—å‡ºçš„ hash å€¼ï¼Œå°† key-value å¯¹æ”¾åœ¨æ•°ç»„ table çš„ i ç´¢å¼•å¤„ã€‚addEntry æ˜¯ HashMap æä¾›çš„ä¸€ä¸ªåŒ…è®¿é—®æƒé™çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Adds a new entry with the specified key, value and hash code to</div><div class="line">     * the specified bucket.  It is the responsibility of this</div><div class="line">     * method to resize the table if appropriate.</div><div class="line">     *</div><div class="line">     * Subclass overrides this to alter the behavior of put method.</div><div class="line">     */</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> ((size &gt;= threshold) &amp;&amp; (<span class="keyword">null</span> != table[bucketIndex])) &#123;</div><div class="line">            resize(<span class="number">2</span> * table.length);</div><div class="line">            hash = (<span class="keyword">null</span> != key) ? hash(key) : <span class="number">0</span>;</div><div class="line">            bucketIndex = indexFor(hash, table.length);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        createEntry(hash, key, value, bucketIndex);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">createEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;</div><div class="line">        <span class="comment">// è·å–æŒ‡å®š bucketIndex ç´¢å¼•å¤„çš„ Entry</span></div><div class="line">        Entry&lt;K,V&gt; e = table[bucketIndex];</div><div class="line">        <span class="comment">// å°†æ–°åˆ›å»ºçš„ Entry æ”¾å…¥ bucketIndex ç´¢å¼•å¤„ï¼Œå¹¶è®©æ–°çš„ Entry æŒ‡å‘åŸæ¥çš„ Entr</span></div><div class="line">        table[bucketIndex] = <span class="keyword">new</span> Entry&lt;&gt;(hash, key, value, e);</div><div class="line">        size++;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“ç³»ç»Ÿå†³å®šå­˜å‚¨ HashMap ä¸­çš„ key-value å¯¹æ—¶ï¼Œå®Œå…¨æ²¡æœ‰è€ƒè™‘ Entry ä¸­çš„ valueï¼Œä»…ä»…åªæ˜¯æ ¹æ® key æ¥è®¡ç®—å¹¶å†³å®šæ¯ä¸ª Entry çš„å­˜å‚¨ä½ç½®ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠ Map é›†åˆä¸­çš„ value å½“æˆ key çš„é™„å±ï¼Œå½“ç³»ç»Ÿå†³å®šäº† key çš„å­˜å‚¨ä½ç½®ä¹‹åï¼Œvalue éšä¹‹ä¿å­˜åœ¨é‚£é‡Œå³å¯ã€‚</p>
<p><strong>hash()æ–¹æ³•</strong></p>
<p>hash(int h)æ–¹æ³•æ ¹æ® key çš„ hashCode é‡æ–°è®¡ç®—ä¸€æ¬¡æ•£åˆ—ã€‚æ­¤ç®—æ³•åŠ å…¥äº†é«˜ä½è®¡ç®—ï¼Œé˜²æ­¢ä½ä½ä¸å˜ï¼Œé«˜ä½å˜åŒ–æ—¶ï¼Œé€ æˆçš„ hash å†²çªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object k)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> h = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (useAltHashing) &#123;</div><div class="line">            <span class="keyword">if</span> (k <span class="keyword">instanceof</span> String) &#123;</div><div class="line">                <span class="keyword">return</span> sun.misc.Hashing.stringHash32((String) k);</div><div class="line">            &#125;</div><div class="line">            h = hashSeed;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//å¾—åˆ°kçš„hashcodeå€¼</span></div><div class="line">        h ^= k.hashCode();</div><div class="line">        <span class="comment">//è¿›è¡Œè®¡ç®—</span></div><div class="line">        h ^= (h &gt;&gt;&gt; <span class="number">20</span>) ^ (h &gt;&gt;&gt; <span class="number">12</span>);</div><div class="line">        <span class="keyword">return</span> h ^ (h &gt;&gt;&gt; <span class="number">7</span>) ^ (h &gt;&gt;&gt; <span class="number">4</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ HashMap ä¸­è¦æ‰¾åˆ°æŸä¸ªå…ƒç´ ï¼Œéœ€è¦æ ¹æ® key çš„ hash å€¼æ¥æ±‚å¾—å¯¹åº”æ•°ç»„ä¸­çš„ä½ç½®ã€‚å¦‚ä½•è®¡ç®—è¿™ä¸ªä½ç½®å°±æ˜¯ hash ç®—æ³•ã€‚å‰é¢è¯´è¿‡ HashMap çš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å½“ç„¶å¸Œæœ›è¿™ä¸ª HashMap é‡Œé¢çš„ å…ƒç´ ä½ç½®å°½é‡çš„åˆ†å¸ƒå‡åŒ€äº›ï¼Œå°½é‡ä½¿å¾—æ¯ä¸ªä½ç½®ä¸Šçš„å…ƒç´ æ•°é‡åªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ç”¨ hash ç®—æ³•æ±‚å¾—è¿™ä¸ªä½ç½®çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±å¯ä»¥çŸ¥é“å¯¹åº”ä½ç½®çš„å…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦çš„ï¼Œè€Œä¸ç”¨å†å»éå†é“¾è¡¨ï¼Œè¿™æ ·å°±å¤§å¤§ä¼˜åŒ–äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚</p>
<p>å¯¹äºä»»æ„ç»™å®šçš„å¯¹è±¡ï¼Œåªè¦å®ƒçš„ hashCode() è¿”å›å€¼ç›¸åŒï¼Œé‚£ä¹ˆç¨‹åºè°ƒç”¨ hash(int h) æ–¹æ³•æ‰€è®¡ç®—å¾—åˆ°çš„ hash ç å€¼æ€»æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æŠŠ hash å€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå…ƒç´ çš„åˆ†å¸ƒç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒå‡åŒ€çš„ã€‚ä½†æ˜¯ï¼Œâ€œæ¨¡â€è¿ç®—çš„æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåœ¨ HashMap ä¸­æ˜¯è¿™æ ·åšçš„ï¼šè°ƒç”¨ indexFor(int h, int length) æ–¹æ³•æ¥è®¡ç®—è¯¥å¯¹è±¡åº”è¯¥ä¿å­˜åœ¨ table æ•°ç»„çš„å“ªä¸ªç´¢å¼•å¤„ã€‚indexFor(int h, int length) æ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Returns index for hash code h.</div><div class="line">     */</div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">indexFor</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> length)</span> </span>&#123;  </div><div class="line">    <span class="keyword">return</span> h &amp; (length-<span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•éå¸¸å·§å¦™ï¼Œå®ƒé€šè¿‡ h &amp; (table.length -1) æ¥å¾—åˆ°è¯¥å¯¹è±¡çš„ä¿å­˜ä½ï¼Œè€Œ HashMap åº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œè¿™æ˜¯ HashMap åœ¨é€Ÿåº¦ä¸Šçš„ä¼˜åŒ–ã€‚åœ¨ HashMap æ„é€ å™¨ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Find a power of 2 &gt;= initialCapacity</span></div><div class="line"><span class="keyword">int</span> capacity = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (capacity &lt; initialCapacity)  </div><div class="line">        capacity &lt;&lt;= <span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¿è¯åˆå§‹åŒ–æ—¶ HashMap çš„å®¹é‡æ€»æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œå³åº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚</p>
<p>å½“ length æ€»æ˜¯ 2 çš„ n æ¬¡æ–¹æ—¶ï¼Œh&amp; (length-1)è¿ç®—ç­‰ä»·äºå¯¹ length å–æ¨¡ï¼Œä¹Ÿå°±æ˜¯ h%lengthï¼Œä½†æ˜¯ &amp; æ¯” % å…·æœ‰æ›´é«˜çš„æ•ˆç‡ã€‚è¿™çœ‹ä¸Šå»å¾ˆç®€å•ï¼Œå…¶å®æ¯”è¾ƒæœ‰ç„æœºçš„ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š</p>
<p>å‡è®¾æ•°ç»„é•¿åº¦åˆ†åˆ«ä¸º 15 å’Œ 16ï¼Œä¼˜åŒ–åçš„ hash ç åˆ†åˆ«ä¸º 8 å’Œ 9ï¼Œé‚£ä¹ˆ &amp; è¿ç®—åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>h &amp; (table.length-1)</th>
<th>hash</th>
<th></th>
<th>table.length-1</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>8 &amp; (15-1)ï¼š</td>
<td>0100</td>
<td>&amp;</td>
<td>1110</td>
<td>= 0100</td>
</tr>
<tr>
<td>9 &amp; (15-1)ï¼š</td>
<td>0101</td>
<td>&amp;</td>
<td>1110</td>
<td>= 0100</td>
</tr>
<tr>
<td>8 &amp; (16-1)ï¼š</td>
<td>0100</td>
<td>&amp;</td>
<td>1111</td>
<td>= 0100</td>
</tr>
<tr>
<td>9 &amp; (16-1)ï¼š</td>
<td>0101</td>
<td>&amp;</td>
<td>1111</td>
<td>= 0101</td>
</tr>
</tbody>
</table>
<p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼šå½“å®ƒä»¬å’Œ 15-1ï¼ˆ1110ï¼‰â€œä¸â€çš„æ—¶å€™ï¼Œäº§ç”Ÿäº†ç›¸åŒçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬ä¼šå®šä½åˆ°æ•°ç»„ä¸­çš„åŒä¸€ä¸ªä½ç½®ä¸Šå»ï¼Œè¿™å°±äº§ç”Ÿäº†ç¢°æ’ï¼Œ8 å’Œ 9 ä¼šè¢«æ”¾åˆ°æ•°ç»„ä¸­çš„åŒä¸€ä¸ªä½ç½®ä¸Šå½¢æˆé“¾è¡¨ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ—¶å€™å°±éœ€è¦éå†è¿™ä¸ªé“¾ è¡¨ï¼Œå¾—åˆ°8æˆ–è€…9ï¼Œè¿™æ ·å°±é™ä½äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°ï¼Œå½“æ•°ç»„é•¿åº¦ä¸º 15 çš„æ—¶å€™ï¼Œhash å€¼ä¼šä¸ 15-1ï¼ˆ1110ï¼‰è¿›è¡Œâ€œä¸â€ï¼Œé‚£ä¹ˆæœ€åä¸€ä½æ°¸è¿œæ˜¯ 0ï¼Œè€Œ 0001ï¼Œ0011ï¼Œ0101ï¼Œ1001ï¼Œ1011ï¼Œ0111ï¼Œ1101 è¿™å‡ ä¸ªä½ç½®æ°¸è¿œéƒ½ä¸èƒ½å­˜æ”¾å…ƒç´ äº†ï¼Œç©ºé—´æµªè´¹ç›¸å½“å¤§ï¼Œæ›´ç³Ÿçš„æ˜¯è¿™ç§æƒ…å†µä¸­ï¼Œæ•°ç»„å¯ä»¥ä½¿ç”¨çš„ä½ç½®æ¯”æ•°ç»„é•¿åº¦å°äº†å¾ˆå¤šï¼Œè¿™æ„å‘³ç€è¿›ä¸€æ­¥å¢åŠ äº†ç¢°æ’çš„å‡ ç‡ï¼Œå‡æ…¢äº†æŸ¥è¯¢çš„æ•ˆç‡ï¼è€Œå½“æ•°ç»„é•¿åº¦ä¸º16æ—¶ï¼Œå³ä¸º2çš„næ¬¡æ–¹æ—¶ï¼Œ2n-1 å¾—åˆ°çš„äºŒè¿›åˆ¶æ•°çš„æ¯ä¸ªä½ä¸Šçš„å€¼éƒ½ä¸º 1ï¼Œè¿™ä½¿å¾—åœ¨ä½ä½ä¸Š&amp;æ—¶ï¼Œå¾—åˆ°çš„å’ŒåŸ hash çš„ä½ä½ç›¸åŒï¼ŒåŠ ä¹‹ hash(int h)æ–¹æ³•å¯¹ key çš„ hashCode çš„è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ŒåŠ å…¥äº†é«˜ä½è®¡ç®—ï¼Œå°±ä½¿å¾—åªæœ‰ç›¸åŒçš„ hash å€¼çš„ä¸¤ä¸ªå€¼æ‰ä¼šè¢«æ”¾åˆ°æ•°ç»„ä¸­çš„åŒä¸€ä¸ªä½ç½®ä¸Šå½¢æˆé“¾è¡¨ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œå½“æ•°ç»„é•¿åº¦ä¸º 2 çš„ n æ¬¡å¹‚çš„æ—¶å€™ï¼Œä¸åŒçš„ key ç®—å¾—å¾— index ç›¸åŒçš„å‡ ç‡è¾ƒå°ï¼Œé‚£ä¹ˆæ•°æ®åœ¨æ•°ç»„ä¸Šåˆ†å¸ƒå°±æ¯”è¾ƒå‡åŒ€ï¼Œä¹Ÿå°±æ˜¯è¯´ç¢°æ’çš„å‡ ç‡å°ï¼Œç›¸å¯¹çš„ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å°±ä¸ç”¨éå†æŸä¸ªä½ç½®ä¸Šçš„é“¾è¡¨ï¼Œè¿™æ ·æŸ¥è¯¢æ•ˆç‡ä¹Ÿå°±è¾ƒé«˜äº†ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<p>æ ¹æ®ä¸Šé¢ put æ–¹æ³•çš„æºä»£ç å¯ä»¥çœ‹å‡ºï¼Œå½“ç¨‹åºè¯•å›¾å°†ä¸€ä¸ªkey-valueå¯¹æ”¾å…¥HashMapä¸­æ—¶ï¼Œç¨‹åºé¦–å…ˆæ ¹æ®è¯¥ key çš„ hashCode() è¿”å›å€¼å†³å®šè¯¥ Entry çš„å­˜å‚¨ä½ç½®ï¼šå¦‚æœä¸¤ä¸ª Entry çš„ key çš„ hashCode() è¿”å›å€¼ç›¸åŒï¼Œé‚£å®ƒä»¬çš„å­˜å‚¨ä½ç½®ç›¸åŒã€‚å¦‚æœè¿™ä¸¤ä¸ª Entry çš„ key é€šè¿‡ equals æ¯”è¾ƒè¿”å› trueï¼Œæ–°æ·»åŠ  Entry çš„ value å°†è¦†ç›–é›†åˆä¸­åŸæœ‰ Entry çš„ valueï¼Œä½†keyä¸ä¼šè¦†ç›–ã€‚å¦‚æœè¿™ä¸¤ä¸ª Entry çš„ key é€šè¿‡ equals æ¯”è¾ƒè¿”å› falseï¼Œæ–°æ·»åŠ çš„ Entry å°†ä¸é›†åˆä¸­åŸæœ‰ Entry å½¢æˆ Entry é“¾ï¼Œè€Œä¸”æ–°æ·»åŠ çš„ Entry ä½äº Entry é“¾çš„å¤´éƒ¨â€”â€”å…·ä½“è¯´æ˜ç»§ç»­çœ‹ addEntry() æ–¹æ³•çš„è¯´æ˜ã€‚</p>
<h2 id="get-æ–¹æ³•">3.2. get()æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Returns the value to which the specified key is mapped,</div><div class="line">     * or &#123;<span class="doctag">@code</span> null&#125; if this map contains no mapping for the key.</div><div class="line">     *</div><div class="line">     * &lt;p&gt;More formally, if this map contains a mapping from a key</div><div class="line">     * &#123;<span class="doctag">@code</span> k&#125; to a value &#123;<span class="doctag">@code</span> v&#125; such that &#123;<span class="doctag">@code</span> (key==null ? k==null :</div><div class="line">     * key.equals(k))&#125;, then this method returns &#123;<span class="doctag">@code</span> v&#125;; otherwise</div><div class="line">     * it returns &#123;<span class="doctag">@code</span> null&#125;.  (There can be at most one such mapping.)</div><div class="line">     *</div><div class="line">     * &lt;p&gt;A return value of &#123;<span class="doctag">@code</span> null&#125; does not &lt;i&gt;necessarily&lt;/i&gt;</div><div class="line">     * indicate that the map contains no mapping for the key; it's also</div><div class="line">     * possible that the map explicitly maps the key to &#123;<span class="doctag">@code</span> null&#125;.</div><div class="line">     * The &#123;<span class="doctag">@link</span> #containsKey containsKey&#125; operation may be used to</div><div class="line">     * distinguish these two cases.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@see</span> #put(Object, Object)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> getForNullKey();</div><div class="line">        Entry&lt;K,V&gt; entry = getEntry(key);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span> == entry ? <span class="keyword">null</span> : entry.getValue();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">getEntry</span><span class="params">(Object key)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> hash = (key == <span class="keyword">null</span>) ? <span class="number">0</span> : hash(key);</div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)];</div><div class="line">             e != <span class="keyword">null</span>;</div><div class="line">             e = e.next) &#123;</div><div class="line">            Object k;</div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp;</div><div class="line">                ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</div><div class="line">                <span class="keyword">return</span> e;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æœ‰äº†ä¸Šé¢å­˜å‚¨æ—¶çš„ hash ç®—æ³•ä½œä¸ºåŸºç¡€ï¼Œç†è§£èµ·æ¥è¿™æ®µä»£ç å°±å¾ˆå®¹æ˜“äº†ã€‚ä»ä¸Šé¢çš„æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼šä» HashMap ä¸­ get å…ƒç´ æ—¶ï¼Œé¦–å…ˆè®¡ç®— key çš„ hashCodeï¼Œæ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”ä½ç½®çš„æŸä¸€å…ƒç´ ï¼Œç„¶åé€šè¿‡ key çš„ equals æ–¹æ³•åœ¨å¯¹åº”ä½ç½®çš„é“¾è¡¨ä¸­æ‰¾åˆ°éœ€è¦çš„å…ƒç´ ã€‚</p>
<h2 id="å½’çº³">3.3. å½’çº³</h2><p>ç®€å•åœ°è¯´ï¼ŒHashMapåœ¨åº•å±‚å°†key-valueå½“æˆä¸€ä¸ªæ•´ä½“è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªæ•´ä½“å°±æ˜¯ä¸€ä¸ªEntryå¯¹è±¡ã€‚</p>
<ul>
<li>HashMapåº•å±‚é‡‡ç”¨ä¸€ä¸ª<code>Entry[]</code> æ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„key-valueå¯¹ã€‚</li>
<li>å½“éœ€è¦å­˜å‚¨ä¸€ä¸ªEntryå¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®hashç®—æ³•æ¥å†³å®šå…¶åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œå†æ ¹æ®equalsæ–¹æ³•å†³å®šå…¶åœ¨è¯¥æ•°ç»„ä½ç½®ä¸Šçš„é“¾è¡¨ä¸­çš„å­˜å‚¨ä½ç½®ã€‚</li>
<li>å½“éœ€è¦å–å‡ºä¸€ä¸ªEntryæ—¶ï¼Œä¹Ÿä¼šæ ¹æ®hashç®—æ³•æ‰¾åˆ°å…¶åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œå†æ ¹æ®equalsæ–¹æ³•ä»è¯¥ä½ç½®çš„é“¾è¡¨ä¸­å–å‡ºè¯¥Entryã€‚</li>
</ul>
<h1 id="HashMapç›¸å…³æœºåˆ¶">4. HashMapç›¸å…³æœºåˆ¶</h1><h2 id="resizeæœºåˆ¶ï¼ˆrehashï¼‰">4.1. resizeæœºåˆ¶ï¼ˆrehashï¼‰</h2><p>å½“HashMapä¸­çš„å…ƒç´ è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œhashå†²çªçš„å‡ ç‡ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼Œå› ä¸ºæ•°ç»„çš„é•¿åº¦æ—¶å›ºå®šçš„ã€‚æ‰€ä»¥ä¸ºäº†æé«˜æŸ¥è¯¢çš„æ•ˆç‡ï¼Œå°±éœ€è¦å¯¹HashMapçš„æ•°ç»„è¿›è¡Œæ‰©å®¹ã€‚é‚£ä¹ˆæ­¤æ—¶æœ€æ¶ˆè€—æ€§èƒ½çš„ç‚¹å°±å‡ºç°äº†ï¼šåŸæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®å¿…é¡»é‡æ–°è®¡ç®—å…¶åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå¹¶æ”¾è¿›å»ï¼Œè¿™å°±æ˜¯resizeæ“ä½œã€‚</p>
<p>é‚£ä¹ˆHashMapæ˜¯ä»€ä¹ˆæ—¶å€™è¿›è¡Œæ‰©å®¹çš„å‘¢ï¼Ÿå½“HashMapä¸­çš„å…ƒç´ è¶…è¿‡<code>threshold = (int)(capacity * loadFactor)</code> æ—¶ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹ã€‚loadFactorçš„é»˜è®¤å€¼ä¸º0.75ã€‚å…¶ä¸­thresholdæ˜¯HashMapçš„ä¸€ä¸ªå­—æ®µã€‚</p>
<p>æ¯æ¬¡æ‰©å®¹æ—¶ï¼Œéƒ½æ–°å»ºä¸€ä¸ª2å€çš„æ•°ç»„ï¼Œç„¶åé‡æ–°è®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚æœé¢„çŸ¥HashMapä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œé‚£ä¹ˆé¢„è®¾å…ƒç´ çš„ä¸ªæ•°å°±èƒ½æœ‰æ•ˆåœ°æé«˜HashMapçš„æ€§èƒ½ã€‚</p>
<p>è€Œè´Ÿè½½å› å­loadFactor è¡¡é‡çš„æ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨çš„ç©ºé—´ä½¿ç”¨ç¨‹åº¦ã€‚è´Ÿè½½å› å­è¶Šå¤§è¡¨ç¤ºæ•£åˆ—çš„è£…å¡«ç¨‹åº¦è¶Šé«˜ã€‚å¯¹äºä½¿ç”¨é“¾è¡¨æ³•çš„æ•£åˆ—è¡¨æ¥è¯´ï¼ŒæŸ¥æ‰¾å…ƒç´ çš„å¹³å‡æ—¶é—´æ˜¯$O(1+a)$ ã€‚aæ˜¯é“¾è¡¨å¹³å‡é•¿åº¦ã€‚å› æ­¤å¦‚æœè´Ÿè½½å› å­è¶Šå¤§ï¼Œå¯¹ç©ºé—´çš„åˆ©ç”¨æ›´å……åˆ†ï¼Œä½†æŸ¥æ‰¾æ•ˆç‡å°±ä¼šæ›´ä½ã€‚å¦‚æœè´Ÿè½½å› å­å¤ªå°ï¼Œæ•£åˆ—è¡¨çš„æ•°æ®åˆè¿‡äºç¨€ç–ï¼Œå¯¹ç©ºé—´é€ æˆä¸¥é‡æµªè´¹ã€‚</p>
<h2 id="HashMapçš„æ„é€ å™¨">4.2. HashMapçš„æ„é€ å™¨</h2><p>HashMapåŒ…å«ä»¥ä¸‹å‡ ä¸ªæ„é€ å™¨ï¼š</p>
<ul>
<li><code>HashMap()</code> : æ„å»ºä¸€ä¸ªåˆå§‹å®¹é‡ä¸º16ï¼Œè´Ÿè½½å› å­ä¸º0.75çš„HashMapã€‚</li>
<li><code>HashMap(int initialCapcity)</code> : æ„å»ºä¸€ä¸ªåˆå§‹å®¹é‡ä¸ºinitialCapcity, è´Ÿè½½å› å­ä¸º0.75çš„HashMapã€‚</li>
<li><code>HashMap(int initialCapacity, float loadFactor)</code> : ä»¥æŒ‡å®šåˆå§‹å®¹é‡ã€æŒ‡å®šçš„è´Ÿè½½å› å­åˆ›å»ºä¸€ä¸ªHashMapã€‚<ul>
<li>initialCapcity * loadFactorè¿‡å¤§æ—¶ï¼Œä¼šé€ æˆç©ºé—´çš„ä¸¥é‡æµªè´¹</li>
<li>initialCapcity * loadFactorè¿‡å°æ—¶ï¼Œä¼šé€ æˆæŸ¥æ‰¾æ•ˆç‡å¾ˆä½</li>
</ul>
</li>
</ul>
<h2 id="Fail-Fastæœºåˆ¶">4.3. Fail-Fastæœºåˆ¶</h2><p>æˆ‘ä»¬çŸ¥é“ java.util.HashMap ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤å¦‚æœåœ¨ä½¿ç”¨è¿­ä»£å™¨çš„è¿‡ç¨‹ä¸­æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº† mapï¼Œé‚£ä¹ˆå°†æŠ›å‡º ConcurrentModificationExceptionï¼Œè¿™å°±æ˜¯æ‰€è°“ fail-fast ç­–ç•¥ã€‚</p>
<p>ail-fast æœºåˆ¶æ˜¯ java é›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚ å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>
<p>ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹ A é€šè¿‡ iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹ A è®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œäº§ç”Ÿ fail-fast äº‹ä»¶ã€‚</p>
<p>è¿™ä¸€ç­–ç•¥åœ¨æºç ä¸­çš„å®ç°æ˜¯é€šè¿‡ modCount åŸŸï¼ŒmodCount é¡¾åæ€ä¹‰å°±æ˜¯ä¿®æ”¹æ¬¡æ•°ï¼Œå¯¹ HashMap å†…å®¹ï¼ˆå½“ç„¶ä¸ä»…ä»…æ˜¯ HashMap æ‰ä¼šæœ‰ï¼Œå…¶ä»–ä¾‹å¦‚ ArrayList ä¹Ÿä¼šï¼‰çš„ä¿®æ”¹éƒ½å°†å¢åŠ è¿™ä¸ªå€¼ï¼ˆå¤§å®¶å¯ä»¥å†å›å¤´çœ‹ä¸€ä¸‹å…¶æºç ï¼Œåœ¨å¾ˆå¤šæ“ä½œä¸­éƒ½æœ‰ modCount++ è¿™å¥ï¼‰ï¼Œé‚£ä¹ˆåœ¨è¿­ä»£å™¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šå°†è¿™ä¸ªå€¼èµ‹ç»™è¿­ä»£å™¨çš„ expectedModCountã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">HashIterator() &#123;</div><div class="line">    expectedModCount = modCount;</div><div class="line">    <span class="keyword">if</span> (size &gt; <span class="number">0</span>) &#123; <span class="comment">// advance to first entry</span></div><div class="line">    Entry[] t = table;</div><div class="line">    <span class="keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="keyword">null</span>)  </div><div class="line">        ;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­ modCount è·Ÿ expectedModCount æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰å°±è¡¨ç¤ºå·²ç»æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº† Mapï¼š</p>
<p>æ³¨æ„åˆ° modCount å£°æ˜ä¸º volatileï¼Œä¿è¯çº¿ç¨‹ä¹‹é—´ä¿®æ”¹çš„å¯è§æ€§ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">nextEntry</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (modCount != expectedModCount)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</div></pre></td></tr></table></figure>
<p>åœ¨ HashMap çš„ API ä¸­æŒ‡å‡ºï¼š</p>
<p>ç”±æ‰€æœ‰ HashMap ç±»çš„â€œcollection è§†å›¾æ–¹æ³•â€æ‰€è¿”å›çš„è¿­ä»£å™¨éƒ½æ˜¯å¿«é€Ÿå¤±è´¥çš„ï¼šåœ¨è¿­ä»£å™¨åˆ›å»ºä¹‹åï¼Œå¦‚æœä»ç»“æ„ä¸Šå¯¹æ˜ å°„è¿›è¡Œä¿®æ”¹ï¼Œé™¤éé€šè¿‡è¿­ä»£å™¨æœ¬èº«çš„ remove æ–¹æ³•ï¼Œå…¶ä»–ä»»ä½•æ—¶é—´ä»»ä½•æ–¹å¼çš„ä¿®æ”¹ï¼Œè¿­ä»£å™¨éƒ½å°†æŠ›å‡º ConcurrentModificationExceptionã€‚å› æ­¤ï¼Œé¢å¯¹å¹¶å‘çš„ä¿®æ”¹ï¼Œè¿­ä»£å™¨å¾ˆå¿«å°±ä¼šå®Œå…¨å¤±è´¥ï¼Œè€Œä¸å†’åœ¨å°†æ¥ä¸ç¡®å®šçš„æ—¶é—´å‘ç”Ÿä»»æ„ä¸ç¡®å®šè¡Œä¸ºçš„é£é™©ã€‚</p>
<p>æ³¨æ„ï¼Œè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºä¸èƒ½å¾—åˆ°ä¿è¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå­˜åœ¨éåŒæ­¥çš„å¹¶å‘ä¿®æ”¹æ—¶ï¼Œä¸å¯èƒ½ä½œå‡ºä»»ä½•åšå†³çš„ä¿è¯ã€‚å¿«é€Ÿå¤±è´¥è¿­ä»£å™¨å°½æœ€å¤§åŠªåŠ›æŠ›å‡º ConcurrentModificationExceptionã€‚å› æ­¤ï¼Œç¼–å†™ä¾èµ–äºæ­¤å¼‚å¸¸çš„ç¨‹åºçš„åšæ³•æ˜¯é”™è¯¯çš„ï¼Œæ­£ç¡®åšæ³•æ˜¯ï¼šè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºåº”è¯¥ä»…ç”¨äºæ£€æµ‹ç¨‹åºé”™è¯¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>åœ¨ä¸Šæ–‡ä¸­ä¹Ÿæåˆ°ï¼Œfail-fast æœºåˆ¶ï¼Œæ˜¯ä¸€ç§é”™è¯¯æ£€æµ‹æœºåˆ¶ã€‚å®ƒåªèƒ½è¢«ç”¨æ¥æ£€æµ‹é”™è¯¯ï¼Œå› ä¸º JDK å¹¶ä¸ä¿è¯ fail-fast æœºåˆ¶ä¸€å®šä¼šå‘ç”Ÿã€‚è‹¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ fail-fast æœºåˆ¶çš„é›†åˆï¼Œå»ºè®®ä½¿ç”¨â€œjava.util.concurrent åŒ…ä¸‹çš„ç±»â€å»å–ä»£â€œjava.util åŒ…ä¸‹çš„ç±»â€ã€‚</p>
<h2 id="HashMapçš„ä¸¤ç§éå†æ–¹å¼">4.4. HashMapçš„ä¸¤ç§éå†æ–¹å¼</h2><h2 id="ç¬¬ä¸€ç§">4.5. ç¬¬ä¸€ç§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ã€€ã€€Map map = <span class="keyword">new</span> HashMap();</div><div class="line">ã€€ã€€Iterator iter = map.entrySet().iterator();</div><div class="line">ã€€ã€€<span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">Map.Entry entry = (Map.Entry) iter.next();</div><div class="line">Object key = entry.getKey();</div><div class="line">Object val = entry.getValue();</div><div class="line">ã€€ã€€&#125;</div></pre></td></tr></table></figure>
<p>æ•ˆç‡é«˜,ä»¥åä¸€å®šè¦ä½¿ç”¨æ­¤ç§æ–¹å¼ï¼</p>
<h2 id="ç¬¬äºŒç§">4.6. ç¬¬äºŒç§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ã€€ã€€Map map = <span class="keyword">new</span> HashMap();</div><div class="line">ã€€ã€€Iterator iter = map.keySet().iterator();</div><div class="line">ã€€ã€€<span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">Object key = iter.next();</div><div class="line">Object val = map.get(key);</div><div class="line">ã€€ã€€&#125;</div></pre></td></tr></table></figure>
<p>æ•ˆç‡ä½,ä»¥åå°½é‡å°‘ä½¿ç”¨ï¼</p>
<h1 id="HashSet">5. HashSet</h1><p>åœ¨Javaé‡Œï¼Œå…¶å®HashSetå†…éƒ¨æ˜¯ä¸€ä¸ªHashMapã€‚æ­¤å¤„ä¸å†è¿‡å¤šé˜è¿°ã€‚</p>
<h1 id="å‚è€ƒèµ„æ–™">6. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="http://wiki.jikexueyuan.com/project/java-collection/hashmap.html" target="_blank" rel="external">æå®¢å­¦é™¢ï¼ŒHashMap çš„å®ç°åŸç†</a></li>
<li><a href="https://tech.meituan.com/java-hashmap.html" target="_blank" rel="external">ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿï¼ŒJava 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å›¾]]></title>
      <url>/2018/01/11/%E7%AE%97%E6%B3%95-%E5%9B%BE/</url>
      <content type="html"><![CDATA[<p>å¤§çº²</p>
<ul>
<li>Graph<ul>
<li>Clone Graph</li>
<li>Topological Sorting æ‹“æ‰‘æ’åº</li>
</ul>
</li>
<li>æœç´¢<ul>
<li>DFS</li>
<li>BFS ä¸¤ä¸ªåœºæ™¯<ul>
<li>å›¾çš„éå†ï¼ŒGraph Traversal</li>
<li>ç®€å•å›¾æ±‚æœ€çŸ­è·¯å¾„ï¼ŒShortest Path in Simple Graph</li>
</ul>
</li>
</ul>
</li>
</ul>
<a id="more"></a>
<h1 id="ä¾‹é¢˜1ï¼ŒClone-Graph">1. ä¾‹é¢˜1ï¼ŒClone Graph</h1><p>å…‹éš†å›¾ï¼</p>
<p><strong>æ–¹æ³•â€”â€”DFS</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> UndirectedGraphNode <span class="title">cloneGraph</span><span class="params">(UndirectedGraphNode node)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    Map&lt;UndirectedGraphNode, UndirectedGraphNode&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">return</span> dfs(node, map);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> UndirectedGraphNode <span class="title">dfs</span><span class="params">(UndirectedGraphNode node, Map&lt;UndirectedGraphNode, UndirectedGraphNode&gt; map)</span> </span>&#123;</div><div class="line">    <span class="comment">// å¦‚æœæœ‰è¿™ä¸ªèŠ‚ç‚¹äº†ï¼Œå°±ç›´æ¥è¿”å›</span></div><div class="line">    <span class="keyword">if</span>(map.containsKey(node)) <span class="keyword">return</span> map.get(node);</div><div class="line">    <span class="comment">// å¦åˆ™ï¼Œå…‹éš†è¿™ä¸ªèŠ‚ç‚¹</span></div><div class="line">    UndirectedGraphNode newNode = <span class="keyword">new</span> UndirectedGraphNode(node.label);</div><div class="line">    map.put(node, newNode);</div><div class="line">    List&lt;UndirectedGraphNode&gt; newNeighbors = newNode.neighbors;</div><div class="line">    <span class="keyword">for</span>(UndirectedGraphNode neighbor: node.neighbors) &#123;</div><div class="line">        newNeighbors.add(dfs(neighbor, map));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newNode;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2â€”â€”BFS + é˜Ÿåˆ—</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> UndirectedGraphNode <span class="title">cloneGraph</span><span class="params">(UndirectedGraphNode startNode)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(startNode == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  <span class="comment">//ç”¨BFSå¾—åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹</span></div><div class="line">  ArrayList&lt;UndirectedGraphNode&gt; nodes = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">  </div><div class="line">  <span class="comment">// å¤åˆ¶èŠ‚ç‚¹</span></div><div class="line">  HashMap&lt;UndirectedGraphNode, UndirectedGraphNode&gt; mapping = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">  <span class="keyword">for</span>(UndirectedGraphNode node : nodes)&#123;</div><div class="line">    UndirectedGraphNode newNode = <span class="keyword">new</span> UndirectedGraphNode(node.val);</div><div class="line">    mapping.put(node, newNode);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// å¤åˆ¶é‚»å±…</span></div><div class="line">  <span class="keyword">for</span>(UndirectedGraphNode node: nodes)&#123;</div><div class="line">    UndirectedGraphNode newNode = mapping.get(node);</div><div class="line">    <span class="keyword">for</span>(UndirectedGraphNode neighbor : node.neighbors)&#123;</div><div class="line">      newNode.neighbors.add(mapping.get(neighbor));</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mapping.get(startNode);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ArrayList&lt;UndirectedGraphNode&gt; <span class="title">bfs</span><span class="params">(UndirectedGraphNode startNode)</span></span>&#123;</div><div class="line">  <span class="comment">// bfs  + é˜Ÿåˆ—ï¼ å®½åº¦ä¼˜å…ˆç”¨é˜Ÿåˆ—ï¼ï¼ï¼ï¼</span></div><div class="line">  Queue&lt;UndirectedGraphNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">  <span class="comment">// è¿˜éœ€è¦åˆ¤æ–­è¿™ä¸ªç‚¹æ˜¯å¦è¢«è®¿é—®è¿‡ï¼</span></div><div class="line">  HashSet&lt;UndirectedGraphNode&gt; visited = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">  queue.offer(startNode);</div><div class="line">  visited.add(startNode);</div><div class="line">  <span class="keyword">while</span>(!queue.isEmpty())&#123;</div><div class="line">    UndirectedGraphNode head = queue.poll();</div><div class="line">    <span class="keyword">for</span>(UndirectedGraphNode neibor : head.neighbors)&#123;</div><div class="line">      <span class="comment">// if ä¸æ­£å¸¸çš„æƒ…å†µï¼Œå°±continue</span></div><div class="line">      <span class="keyword">if</span>(visited.contains(neibor))&#123; <span class="keyword">continue</span>; &#125;</div><div class="line">      queue.offer(neibor);</div><div class="line">      visited.add(neibor);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;UndirectedGraphNode&gt;(visited);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æ‹“æ‰‘æ’åº">2. æ‹“æ‰‘æ’åº</h1><p>ä¸‹é¢è¿™ä¸ªå›¾å‡è®¾æ˜¯ä¸€ç§ä¸Šè¯¾é¡ºåºï¼Œæ¯”å¦‚ä¸Š1ä¹‹å‰å¿…é¡»ä¸Š0ã€‚æ±‚è¿™ä¸ªå›¾çš„ä»»æ„ä¸€ä¸ªæ‹“æ‰‘æ’åºï¼ˆæŒ‰ç…§è¿™ä¸ªé¡ºåºä¸Šè¯¾åˆ™å¯ä»¥ä¸Šå®Œæ‰€æœ‰è¯¾ï¼‰</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-11-13-57-33.png" alt=""> </p>
<p>æ‹“æ‰‘æ’åºå¾ˆå¥½çš„å‚è€ƒèµ„æ–™ï¼š<a href="http://www.stoimen.com/blog/2012/10/01/computer-algorithms-topological-sort-of-a-graph/" target="_blank" rel="external">Topological Sort of a Graph</a> </p>
<p>æ‹“æ‰‘æ’åºçš„æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç»Ÿè®¡å½“å‰å…¥åº¦ä¸º0çš„ç‚¹ï¼ŒåŠ å…¥é˜Ÿåˆ—</li>
<li>å°†å½“å‰æ‰€æœ‰å…¥åº¦ä¸º0çš„ç‚¹åˆ æ‰ï¼Œå¹¶å°†è¿™äº›ç‚¹çš„ä¸‹ä¸€ç‚¹çš„è¿çº¿åˆ æ‰</li>
<li>é‡å¤1å’Œ2ï¼Œç›´åˆ°æ‰€æœ‰çš„ç‚¹éƒ½è¢«åˆ æ‰</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-11-16-43-48.png" alt=""> </p>
<p><strong>å¦ä¸€ç§æ‹“æ‰‘æ’åºç®—æ³•</strong></p>
<p>ä»ä»»æ„èŠ‚ç‚¹å¼€å§‹DFSï¼Œå¹¶è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„ç»“æŸæ—¶é—´ã€‚æœ€åå°†ç»“æŸæ—¶é—´ä»å¤§åˆ°å°æ’åºï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯æ‹“æ‰‘æ’åºã€‚</p>
<p>è¿™æ˜¯ç®—æ³•å¯¼è®ºä¸Šçœ‹åˆ°çš„ç®—æ³•ã€‚è¿™ä¸ªç®—æ³•åªé€‚ç”¨äºæœ‰å‘æ— ç¯å›¾çš„æ‹“æ‰‘æ’åºï¼Œå¹¶ä¸èƒ½åˆ¤æ–­æ˜¯å¦æœ‰ç¯ã€‚</p>
<h2 id="ä¾‹é¢˜2ï¼ŒTopological-Sorting">2.1. ä¾‹é¢˜2ï¼ŒTopological Sorting</h2><p>å®ç°æ‹“æ‰‘æ’åº</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. æŠŠæ‰€æœ‰å…¥åº¦ä¸º<span class="number">0</span>çš„ç‚¹æ”¾å…¥é˜Ÿåˆ—</div><div class="line"><span class="number">2</span>. å°†è¿™ä¸ªé˜Ÿåˆ—å¼€å§‹BFS</div><div class="line"><span class="number">3</span>. æ¯æ‹¿å‡ºä¸€ä¸ªç‚¹:ä¾‹å¦‚æ‹¿å‡º<span class="number">1</span>/<span class="number">2</span>/<span class="number">3</span>ï¼Œæ¯æ‹¿ä¸€ä¸ªï¼Œè¦å°†æ¯ä¸ªçš„å…¥åº¦å‡ä¸€</div><div class="line"></div><div class="line"><span class="comment">// é˜Ÿåˆ—ç»´æŠ¤å½“å‰å…¥åº¦ä¸º0çš„ç‚¹</span></div><div class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;DirectedGraphNode&gt; <span class="title">topSort</span><span class="params">(ArrayList&lt;DirectedGraphNode&gt; graph)</span></span>&#123;</div><div class="line">	ArrayList&lt;DirectedGraphNode&gt; result = <span class="keyword">new</span> ArrayList&lt;DirectedGraphNode&gt;();</div><div class="line">	<span class="comment">// ç»Ÿè®¡æ‰€æœ‰ç‚¹çš„å…¥åº¦</span></div><div class="line">	HashMap&lt;DirectedGraphNode, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(DirectedGraphNode node : graph)&#123;</div><div class="line">      <span class="keyword">for</span>(DirectedGraphNode neibor : node.neighbors)&#123;</div><div class="line">          <span class="keyword">if</span>(map.containsKey(neibor)) map.put(neibor, map.get(neibor) + <span class="number">1</span>);</div><div class="line">          <span class="keyword">else</span> map.put(neibor, <span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å°†æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹å…¥é˜Ÿåˆ—</span></div><div class="line">    Queue&lt;DirectedGraphNode&gt; q = <span class="keyword">new</span> LinkedList&lt;DirectedGraphNode&gt;();</div><div class="line">    <span class="keyword">for</span>(DirectedGraphNode node : graph)&#123;</div><div class="line">      <span class="keyword">if</span>(!map.containsKey(node))&#123;</div><div class="line">          q.offer(node);</div><div class="line">          result.add(node);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//BFS</span></div><div class="line">    <span class="keyword">while</span>(!q.isEmpty())&#123;</div><div class="line">    	DirectedGraphNode node = q.poll();</div><div class="line">        <span class="keyword">for</span>(DirectedGraphNode neibor : node.neighbors)&#123;</div><div class="line">        	q.put(neibor, q.get(neibor) - <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span>(q.get(neibor) == <span class="number">0</span>)&#123; <span class="comment">// ä¸€æ—¦å…¥åº¦ä¸º0ï¼Œå°±æ”¾åˆ°é˜Ÿåˆ—é‡Œ</span></div><div class="line">            	result.add(neibor);</div><div class="line">            	queue.offer(neibor);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Course-Schedule">2.2. Course Schedule</h2><p>ç»™né—¨è¯¾ï¼Œå’Œè¯¾ä¹‹é—´çš„å…ˆåä¸Šè¯¾é¡ºåºã€‚æ±‚è¿™äº›è¯¾èƒ½å¦æ­£å¸¸ä¾æ¬¡ä¸Šå®Œã€‚</p>
<p>æ€è·¯ï¼šå…¶å®å°±æ˜¯å¯»æ‰¾è¯¾ç¨‹ä¹‹é—´æœ‰æ²¡æœ‰ç¯è·¯ï¼Œå¦‚æœå­˜åœ¨ç¯è·¯ï¼Œé‚£å°±ä¸è¡Œï¼</p>
<p><strong>æ–¹æ³•1ï¼ŒBFS</strong></p>
<p>ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œä»–ä¸€å®šè‡³å°‘æœ‰ä¸€ä¸ª å…¥åº¦ä¸º0çš„ç»“ç‚¹ï¼Œä¸€ä¸ªå‡ºåº¦ä¸º0çš„ç»“ç‚¹ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä»å…¥åº¦å…¥æ‰‹ï¼š</p>
<ol>
<li>å…ˆæŠŠå…¥åº¦ä¸º0çš„ç»“ç‚¹åˆ é™¤äº†ã€‚</li>
<li>ç„¶åå†æŠŠåˆ é™¤åé‡æ–°æˆä¸ºå…¥åº¦ä¸º0çš„ç»“ç‚¹åˆ é™¤äº†ã€‚</li>
<li>ä¾æ¬¡å¾ªç¯ï¼Œæœ€åï¼Œ<span style="border-bottom:2px dashed black;">å¦‚æœï¼Œåˆ é™¤çš„ç»“ç‚¹ä¸ªæ•°ä¸ç­‰äºå›¾æ€»ç»“ç‚¹ä¸ªæ•°ï¼Œé‚£ä¹ˆï¼Œå°±æ˜¯æœ‰ç¯å›¾<span style="border-bottom:2px dashed black;">ã€‚</span></span></li>
</ol>
<p>æƒ³ç”¨BFSï¼Œé‚£å°±è‚¯å®šå¾—ç”¨é˜Ÿåˆ—äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] countIn(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)&#123;</div><div class="line">        <span class="keyword">int</span>[] Incounter = <span class="keyword">new</span> <span class="keyword">int</span>[numCourses];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] edges : prerequisites)&#123;</div><div class="line">            ++Incounter[edges[<span class="number">0</span>]];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Incounter;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canFinish</span><span class="params">(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)</span> </span>&#123;</div><div class="line">        <span class="comment">//æ‹“æ‰‘æ’åº</span></div><div class="line">        <span class="comment">// ç»Ÿè®¡æ¯ä¸ªç‚¹çš„å…¥åº¦</span></div><div class="line">        <span class="keyword">int</span>[] InCounter = countIn(numCourses, prerequisites);</div><div class="line">        <span class="comment">// å°†æ‰€æœ‰å…¥åº¦ä¸º0çš„ç‚¹æ”¾å…¥é˜Ÿåˆ—</span></div><div class="line">        Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(InCounter[i] == <span class="number">0</span>) queue.add(i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(queue.isEmpty()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="comment">//BFS</span></div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">            <span class="keyword">int</span> preCourse = queue.poll();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span>[] edage : prerequisites)&#123;</div><div class="line">                <span class="keyword">if</span>(edage[<span class="number">1</span>] != preCourse) <span class="keyword">continue</span>;</div><div class="line">                <span class="comment">// edageæ˜¯ä»edage[1]å‡ºå‘åˆ°edage[0]çš„è¾¹</span></div><div class="line">                --InCounter[edage[<span class="number">0</span>]];</div><div class="line">                <span class="keyword">if</span>(InCounter[edage[<span class="number">0</span>]] == <span class="number">0</span>)&#123;</div><div class="line">                    queue.add(edage[<span class="number">0</span>]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¦‚æœå½“å‰èŠ‚ç‚¹è¿˜å­˜åœ¨æœ‰å…¥åº¦çš„ç‚¹ï¼Œé‚£ä¹ˆå°±ä¸è¡Œ</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i : InCounter) <span class="keyword">if</span>(i != <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶äº†ï¼Œä¸Šé¢å¯»æ‰¾æ¯ä¸ªç‚¹çš„é‚»å±…çš„æ–¹æ³•å¤ªæš´åŠ›äº†ã€‚æˆ‘ä»¬å†ä¼˜åŒ–ä¸€ä¸‹ã€‚ ä¼˜åŒ–ç‚¹ï¼š  </p>
<ol>
<li>è®°å½•æ¯ä¸ªç‚¹çš„é‚»å±…</li>
<li>åœ¨æœ«å°¾è®°å½•å…¥åº¦ä¸º0çš„ç‚¹çš„ä¸ªæ•°ï¼</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">       <span class="keyword">int</span> inCounter;</div><div class="line">       List&lt;Integer&gt; neighbors;</div><div class="line">       Node()&#123;</div><div class="line">           inCounter = <span class="number">0</span>;</div><div class="line">           neighbors = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">private</span> Node[] countIn(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)&#123;</div><div class="line">       Node[] Incounter = <span class="keyword">new</span> Node[numCourses];</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i) Incounter[i] = <span class="keyword">new</span> Node();</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span>[] edges : prerequisites)&#123;</div><div class="line">           ++Incounter[edges[<span class="number">0</span>]].inCounter;</div><div class="line">           Incounter[edges[<span class="number">1</span>]].neighbors.add(edges[<span class="number">0</span>]);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> Incounter;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canFinish</span><span class="params">(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)</span> </span>&#123;</div><div class="line">       <span class="comment">//æ‹“æ‰‘æ’åº</span></div><div class="line">       <span class="comment">// ç»Ÿè®¡æ¯ä¸ªç‚¹çš„å…¥åº¦</span></div><div class="line">       Node[] InCounter = countIn(numCourses, prerequisites);</div><div class="line"></div><div class="line">       <span class="comment">// å°†æ‰€æœ‰å…¥åº¦ä¸º0çš„ç‚¹æ”¾å…¥é˜Ÿåˆ—</span></div><div class="line">       <span class="keyword">int</span> zeroIn = <span class="number">0</span>;</div><div class="line">       Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i)&#123;</div><div class="line">           <span class="keyword">if</span>(InCounter[i].inCounter == <span class="number">0</span>) &#123;queue.add(i); ++zeroIn;&#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span>(queue.isEmpty()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       <span class="comment">//BFS</span></div><div class="line">       </div><div class="line">       <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">           <span class="keyword">int</span> preCourse = queue.poll();</div><div class="line">           List&lt;Integer&gt; neibors = InCounter[preCourse].neighbors;</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> neibor : neibors) &#123;</div><div class="line">               --InCounter[neibor].inCounter;</div><div class="line">               <span class="keyword">if</span> (InCounter[neibor].inCounter == <span class="number">0</span>) &#123;</div><div class="line">                   queue.add(neibor);</div><div class="line">                   ++zeroIn;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="comment">// å¦‚æœå½“å‰èŠ‚ç‚¹è¿˜å­˜åœ¨æœ‰å…¥åº¦çš„ç‚¹ï¼Œé‚£ä¹ˆå°±ä¸è¡Œ</span></div><div class="line">       <span class="keyword">return</span> zeroIn == numCourses;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2ï¼ŒDFS</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        List&lt;Integer&gt; neibors = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> Node[] shift(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)&#123;</div><div class="line">        Node[] nodes = <span class="keyword">new</span> Node[numCourses];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i) nodes[i] = <span class="keyword">new</span> Node();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] edge : prerequisites)&#123;</div><div class="line">            nodes[edge[<span class="number">1</span>]].neibors.add(edge[<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> nodes;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">boolean</span>[] used;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(Node[] nodes, <span class="keyword">int</span> idx, <span class="keyword">boolean</span>[] visited)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(visited[idx]) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        visited[idx] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> neibor : nodes[idx].neibors)&#123;</div><div class="line">            <span class="keyword">if</span>(!dfs(nodes, neibor, visited)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        visited[idx] = <span class="keyword">false</span>;</div><div class="line">        used[idx] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canFinish</span><span class="params">(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)</span> </span>&#123;</div><div class="line">        <span class="comment">// è½¬åŒ–è¾¹é‚»å…³ç³»</span></div><div class="line">        Node[] nodes = shift(numCourses, prerequisites);</div><div class="line">        <span class="comment">// dfs</span></div><div class="line">        <span class="keyword">boolean</span>[] visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[numCourses];</div><div class="line">        used = <span class="keyword">new</span> <span class="keyword">boolean</span>[numCourses];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(used[i]) <span class="keyword">continue</span>; <span class="comment">// å‰ªæï¼Œå¦åˆ™ä¼šè¶…æ—¶ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹å·²ç»éå†è¿‡äº†ï¼Œå°±ä¸éœ€è¦éå†ç¬¬äºŒæ¬¡äº†</span></div><div class="line">            <span class="keyword">if</span>(!dfs(nodes, i, visited)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Course-Schedule-II">2.3. Course Schedule II</h2><p>ç»™ä¸€äº›è¯¾ç¨‹å…³ç³»ã€‚è¾“å‡ºä¸€ä¸ªåˆç†çš„ä¸Šè¯¾é¡ºåº</p>
<p><strong>æ–¹æ³•1ï¼ŒBFS</strong></p>
<p>ä¸€æ ·çš„å¥—è·¯å“‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        List&lt;Integer&gt; neighbors = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> degrees;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> Node[] helper(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)&#123;</div><div class="line">        Node[] nodes = <span class="keyword">new</span> Node[numCourses];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i) nodes[i] = <span class="keyword">new</span> Node();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] edge : prerequisites)&#123;</div><div class="line">            ++nodes[edge[<span class="number">0</span>]].degrees;</div><div class="line">            nodes[edge[<span class="number">1</span>]].neighbors.add(edge[<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> nodes;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] findOrder(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites) &#123;</div><div class="line">        <span class="comment">// ç¡®å®šæ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ï¼Œå’ŒèŠ‚ç‚¹çš„é‚»å±…</span></div><div class="line">        Node[] nodes = helper(numCourses, prerequisites);</div><div class="line">        <span class="comment">// å°†æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹å…¥æ ˆ</span></div><div class="line">        Queue&lt;Integer&gt; zeroDegrees = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> zeroCounter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span>[] order = <span class="keyword">new</span> <span class="keyword">int</span>[numCourses];</div><div class="line">        <span class="keyword">int</span> filled = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nodes[i].degrees == <span class="number">0</span>)&#123;</div><div class="line">                order[filled++] = i;</div><div class="line">                zeroDegrees.add(i);</div><div class="line">                ++zeroCounter;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// bfs</span></div><div class="line">        <span class="keyword">while</span> (!zeroDegrees.isEmpty())&#123;</div><div class="line">            <span class="keyword">int</span> originIdx = zeroDegrees.poll();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> destIdx : nodes[originIdx].neighbors)&#123;</div><div class="line">                --nodes[destIdx].degrees;</div><div class="line">                <span class="keyword">if</span>(nodes[destIdx].degrees == <span class="number">0</span>)&#123;</div><div class="line">                    order[filled++] = destIdx;</div><div class="line">                    zeroDegrees.add(destIdx);</div><div class="line">                    ++zeroCounter;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(zeroCounter == numCourses) <span class="keyword">return</span> order;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å¸¸è§æ•°æ®ç»“æ„]]></title>
      <url>/2017/12/25/%E7%AE%97%E6%B3%95-%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
      <content type="html"><![CDATA[<p><strong>å¤§çº²</strong></p>
<ul>
<li>çº¿æ€§<ul>
<li>é˜Ÿåˆ— - Queue</li>
<li>æ ˆ - Stack</li>
<li>å“ˆå¸Œ - Hash</li>
</ul>
</li>
<li>æ ‘å½¢<ul>
<li>å †/ä¼˜å…ˆé˜Ÿåˆ— - Heap / Priority Queue</li>
<li>TreeMap</li>
</ul>
</li>
</ul>
<a id="more"></a>
<h1 id="Hashç›¸å…³é—®é¢˜">1. Hashç›¸å…³é—®é¢˜</h1><h2 id="Insert-Delete-GetRandom-O-1">1.1. Insert Delete GetRandom O(1)</h2><p>è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤å’Œéšæœºå–çš„å¤æ‚åº¦éƒ½æ˜¯$O(1)$</p>
<p>æ³¨æ„ä¸€äº›æŠ€å·§ï¼Œç‰¹åˆ«æ˜¯removeæ—¶çš„æŠ€å·§ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Integer, Integer&gt; set;</div><div class="line">    ArrayList&lt;Integer&gt; nums;</div><div class="line">    <span class="comment">/**setçš„keyæ˜¯æ’å…¥çš„æ•°å­—ï¼Œvalueæ˜¯åœ¨numsä¸­çš„idx**/</span></div><div class="line">    java.util.Random rand = <span class="keyword">new</span> java.util.Random();</div><div class="line">    <span class="comment">/** Initialize your data structure here. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RandomizedSet</span><span class="params">()</span> </span>&#123;</div><div class="line">        set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        nums = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** Inserts a value to the set. Returns true if the set did not already contain the specified element. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(set.containsKey(val)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        set.put(val,nums.size());</div><div class="line">        nums.add(val);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** Removes a value from the set. Returns true if the set contained the specified element. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(set.containsKey(val))&#123;</div><div class="line">            <span class="comment">// ä¸ºäº†ä¿è¯åºå·æ­£ç¡®ï¼Œå…ˆè®©valä¸numsä¸­çš„æœ€åä¸€ä¸ªäº¤æ¢</span></div><div class="line">            <span class="keyword">int</span> idx = set.get(val);</div><div class="line">            <span class="keyword">int</span> lastVal = nums.get(nums.size() - <span class="number">1</span>);</div><div class="line">            set.replace(lastVal, idx);</div><div class="line">            nums.set(idx,lastVal);</div><div class="line">            set.remove(val);</div><div class="line">            nums.remove(nums.size() - <span class="number">1</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;<span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** Get a random element from the set. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRandom</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//System.out.println(rand.nextInt(nums.size()));</span></div><div class="line">        <span class="keyword">return</span> nums.get(rand.nextInt(nums.size())); <span class="comment">// æ³¨æ„è¿™ä¸ªç”¨æ³•</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Insert-Delete-GetRandom-O-1-Duplicates-allowed">1.2. Insert Delete GetRandom O(1) - Duplicates allowed</h2><p>å¦‚æœå…è®¸é‡å¤å…ƒç´ å‡ºç°ï¼Œé‚£ä¹ˆæ€ä¹ˆå®ç°ï¼Ÿ</p>
<p>é‚£å°±æŠŠidxå˜æˆidxåˆ—è¡¨ï¼</p>
<p>ï¼ˆä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è®¡æ•°å‘¢ï¼Ÿå› ä¸ºå¦‚æœåªè®¡æ•°çš„è¯ï¼Œéšæœºè¾“å‡ºæ—¶ï¼Œå…ƒç´ æ¯”ä¾‹å°±ä¸ç¬¦åˆåŸæ¥çš„æ¯”ä¾‹äº†ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Integer, ArrayList&lt;Integer&gt;&gt; set;</div><div class="line">ArrayList&lt;Integer&gt; nums;</div><div class="line">Random rand = <span class="keyword">new</span> Random();</div><div class="line"><span class="comment">/**key : å°±æ˜¯æ’å…¥çš„å€¼</span></div><div class="line"> * value :åœ¨numsä¸­çš„idx **/</div><div class="line"><span class="comment">/** Initialize your data structure here. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">RandomizedCollection</span><span class="params">()</span> </span>&#123;</div><div class="line">    set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    nums = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Inserts a value to the collection. Returns true if the collection did not already contain the specified element. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(set.containsKey(val))&#123;</div><div class="line">        set.get(val).add(nums.size());</div><div class="line">        nums.add(val);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        ArrayList idxs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        idxs.add(nums.size());</div><div class="line">        set.put(val,idxs);</div><div class="line">        nums.add(val);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Removes a value from the collection. Returns true if the collection contained the specified element. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(set.containsKey(val))&#123;</div><div class="line">        <span class="comment">// å¾…åˆ é™¤å…ƒç´ çš„idxsåˆ—è¡¨</span></div><div class="line">        ArrayList&lt;Integer&gt; idxs = set.get(val);</div><div class="line">        <span class="comment">// idx = idxs.get(0)</span></div><div class="line">        <span class="comment">// å°†numsæœ€åä¸€ä¸ªæŒªè¿‡æ¥</span></div><div class="line">        <span class="keyword">if</span>(idxs.get(<span class="number">0</span>) &lt; nums.size() - <span class="number">1</span>) &#123;</div><div class="line">            nums.set(idxs.get(<span class="number">0</span>), nums.get(nums.size() - <span class="number">1</span>));</div><div class="line">            <span class="comment">// æ›´æ–°setä¸­æŒªè¿‡æ¥çš„idx</span></div><div class="line">            ArrayList&lt;Integer&gt; lastIdxs = set.get(nums.get(idxs.get(<span class="number">0</span>)));</div><div class="line">            <span class="keyword">int</span> deleted = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (deleted &lt; lastIdxs.size()) &#123;</div><div class="line">                <span class="keyword">if</span> (lastIdxs.get(deleted) == nums.size() - <span class="number">1</span>) &#123;</div><div class="line">                    lastIdxs.remove(deleted);</div><div class="line">                &#125;</div><div class="line">                deleted += <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            lastIdxs.add(idxs.get(<span class="number">0</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// åˆ é™¤</span></div><div class="line">        nums.remove(nums.size() - <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(idxs.size() == <span class="number">1</span>)&#123;set.remove(val);&#125;</div><div class="line">        <span class="keyword">else</span>&#123;idxs.remove(<span class="number">0</span>);&#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Get a random element from the collection. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRandom</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(nums.size() == <span class="number">0</span>) <span class="keyword">return</span>  -<span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> nums.get(rand.nextInt(nums.size()));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Sort-Characters-By-Frequency">1.3. Sort Characters By Frequency</h2><p>é¢˜æ„ï¼šç»™ä¸€ä¸ªå­—ç¬¦ä¸²â€treeâ€ï¼ŒæŒ‰ç…§å­—æ¯é¢‘ç‡è¾“å‡ºâ€œeetrâ€æˆ–â€eertâ€</p>
<p>æ€è·¯ï¼šç›´æ¥ç”¨hashMapç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„æ¬¡æ•°ï¼Œç„¶åæŒ‰ç…§æ¬¡æ•°æ’åºå¹¶è¾“å‡ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">frequencySort</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        HashMap&lt;Character,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">char</span> c : s.toCharArray() )&#123;</div><div class="line">            <span class="keyword">if</span>( map.containsKey(c) )&#123;</div><div class="line">                map.replace(c,map.get(c)+<span class="number">1</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                map.put(c,<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        List&lt;Map.Entry&lt;Character,Integer&gt;&gt; list = <span class="keyword">new</span> LinkedList&lt;Map.Entry&lt;Character,Integer&gt;&gt;(map.entrySet());</div><div class="line">        Collections.sort( list, <span class="keyword">new</span> Comparator&lt;Map.Entry&lt;Character,Integer&gt;&gt;() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Map.Entry&lt;Character,Integer&gt; o1, Map.Entry&lt;Character,Integer&gt; o2)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> (o2.getValue()).compareTo( o1.getValue() );</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">int</span> times;</div><div class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder(s.length());</div><div class="line">        <span class="keyword">for</span> (Map.Entry&lt;Character,Integer&gt; entry : list) &#123;</div><div class="line">            times = entry.getValue();</div><div class="line">            <span class="keyword">while</span> (times&gt;<span class="number">0</span>)&#123;</div><div class="line">                result.append(entry.getKey());</div><div class="line">                --times;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜è¿˜æœ‰å¦ä¸€ç§ç²¾å¦™çš„O(n)æ€è·¯ï¼Œåªæ˜¯æœ‰ç‚¹æµªè´¹ç©ºé—´ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">frequencySort</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : s.toCharArray()) &#123;</div><div class="line">            <span class="keyword">if</span> (map.containsKey(c)) &#123;</div><div class="line">                map.put(c, map.get(c) + <span class="number">1</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                map.put(c, <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        List&lt;Character&gt; [] bucket = <span class="keyword">new</span> List[s.length() + <span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> key : map.keySet()) &#123;</div><div class="line">            <span class="keyword">int</span> frequency = map.get(key);</div><div class="line">            <span class="keyword">if</span> (bucket[frequency] == <span class="keyword">null</span>) &#123;</div><div class="line">                bucket[frequency] = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">            &#125;</div><div class="line">            bucket[frequency].add(key);</div><div class="line">        &#125;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> pos = bucket.length - <span class="number">1</span>; pos &gt;=<span class="number">0</span>; pos--) &#123;</div><div class="line">            <span class="keyword">if</span> (bucket[pos] != <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">char</span> num : bucket[pos]) &#123;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; map.get(num); i++) &#123;</div><div class="line">                        sb.append(num);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="æ ˆç›¸å…³">2. æ ˆç›¸å…³</h1><h2 id="æ‹¬å·åŒ¹é…é—®é¢˜">2.1. æ‹¬å·åŒ¹é…é—®é¢˜</h2><h3 id="Valid-Parentheses">2.1.1. Valid Parentheses</h3><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­å…ƒç´ ä¸º<code>{},(),[]</code>ã€‚åˆ¤æ–­æ‹¬å·æ˜¯å¦åˆæ³•</p>
<p>æ€è·¯ï¼šç”¨æ ˆï¼ï¼ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(<span class="keyword">char</span> a, <span class="keyword">char</span> b)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> (a == <span class="string">'&#123;'</span> &amp;&amp; b == <span class="string">'&#125;'</span>) ||</div><div class="line">            (a == <span class="string">'['</span> &amp;&amp; b == <span class="string">']'</span>) ||</div><div class="line">            (a == <span class="string">'('</span> &amp;&amp; b == <span class="string">')'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.length() &lt;= <span class="number">1</span>)<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    Stack&lt;Character&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(s.charAt(i) == <span class="string">'['</span> || s.charAt(i) == <span class="string">'&#123;'</span> || s.charAt(i) == <span class="string">'('</span>)&#123;</div><div class="line">            stack.push(s.charAt(i));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">if</span>(stack.empty() || !isMatch(stack.pop(),s.charAt(i)))</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Longest-Valid-Parentheses">2.1.2. Longest Valid Parentheses</h3><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­å…ƒç´ ä¸º<code>()</code> ã€‚åˆ¤æ–­æœ€é•¿åˆæ³•æ‹¬å·</p>
<p>æ€è·¯ï¼šç”¨æ ˆã€‚ä¸€å¼€å§‹æƒ³çš„å¤ªç®€å•ï¼Œä½†æ²¡é‚£ä¹ˆç®€å•ã€‚éš¾ç‚¹åœ¨äºå¦‚ä½•å¯»æ‰¾åˆæ³•ä¸²çš„å¼€å§‹ã€‚ä¾‹å¦‚<code>(()</code> è¿™ç§ï¼Œåº”è¯¥æ€æ ·è®°å½•å‘¢ï¼Ÿ</p>
<p>ä½†äº‹å®ä¸Šåº”è¯¥æ¢ä¸€ä¸ªè§’åº¦ï¼š</p>
<ol>
<li><code>stack</code>é‡Œé¢è£…çš„ä¸€ç›´æ˜¯â€œè¿˜æ²¡é…å¥½å¯¹çš„é‚£äº›å¯æ€œçš„æ‹¬å·çš„indexâ€</li>
<li>æ˜¯<code>&#39;(â€˜</code>çš„æ—¶å€™<code>push</code></li>
<li>æ˜¯<code>â€™)â€™</code>çš„æ—¶å€™ï¼Œè¯´æ˜å¯èƒ½é…å¯¹äº†ï¼›çœ‹<code>stack top</code>æ˜¯ä¸æ˜¯å·¦æ‹¬å·ï¼Œä¸æ˜¯çš„è¯ï¼Œ<code>push</code>å½“å‰çš„<code>â€™)â€™</code>ï¼ˆç®—æ˜¯ä¸€ç§å¯¹ä¹‹å‰<code>push</code>è¿›å»çš„æ‰€æœ‰ä¸œè¥¿çš„æ¸…é™¤ï¼‰</li>
<li>æ˜¯çš„è¯ï¼Œ<code>pop</code>é‚£ä¸ªé…å¯¹çš„å·¦æ‹¬å·ï¼Œç„¶å<code>update res</code>ï¼š<code>i</code>å’Œ<code>top</code>çš„ï¼ˆæœ€åä¸€ä¸ªé…ä¸æˆå¯¹çš„ï¼‰<code>index</code>ç›¸å‡ï¼Œå°±æ˜¯<code>i</code>å±äºçš„è¿™ä¸€æ®µçš„å½“å‰æœ€é•¿ã€‚å¦‚æœä¸€<code>pop</code>å°±æ•´ä¸ªæ ˆç©ºäº†ï¼Œè¯´æ˜å‰é¢å…¨é…å¥½å¯¹äº†ï¼Œé‚£<code>res</code>å°±æ˜¯æœ€å¤§<code>=i+1</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">longestValidParentheses</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    <span class="keyword">int</span> max = <span class="number">0</span>, curr = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span>[] arr = s.toCharArray();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(arr[i] == <span class="string">')'</span> &amp;&amp; !stack.empty() &amp;&amp; arr[stack.peek()] == <span class="string">'('</span>)&#123;</div><div class="line">            <span class="comment">// arr[i]ä¸arr[stack.peek()]åŒ¹é…æˆäº†ä¸€å¯¹æ‹¬å·</span></div><div class="line">            stack.pop();</div><div class="line">            <span class="keyword">if</span>(stack.empty())&#123;</div><div class="line">                max = i + <span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                max = Math.max(max, i - stack.peek());</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            stack.push(i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> max;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="è®¡ç®—é—®é¢˜">2.2. è®¡ç®—é—®é¢˜</h2><h3 id="Evaluate-Reverse-Polish-Notation">2.2.1. Evaluate Reverse Polish Notation</h3><p>è®¡ç®—<a href="http://en.wikipedia.org/wiki/Reverse_Polish_notation" target="_blank" rel="external">Reverse Polish Notation</a> å½¢å¼çš„æ•°å­—ã€‚å³ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[&quot;2&quot;, &quot;1&quot;, &quot;+&quot;, &quot;3&quot;, &quot;*&quot;] -&gt; ((2 + 1) * 3) -&gt; 9</div><div class="line"> [&quot;4&quot;, &quot;13&quot;, &quot;5&quot;, &quot;/&quot;, &quot;+&quot;] -&gt; (4 + (13 / 5)) -&gt; 6</div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šæ ˆï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isNum</span><span class="params">(String s)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.equals(<span class="string">"+"</span>) || s.equals(<span class="string">"-"</span>) || s.equals(<span class="string">"*"</span>) || s.equals(<span class="string">"/"</span>)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">evalRPN</span><span class="params">(String[] tokens)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(tokens.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    Stack&lt;String&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(String token : tokens)&#123;</div><div class="line">        <span class="keyword">if</span>(isNum(token))&#123;stack.push(token); <span class="keyword">continue</span>;&#125;</div><div class="line">        <span class="keyword">int</span> val2 = Integer.valueOf(stack.pop());</div><div class="line">        <span class="keyword">int</span> val1 = Integer.valueOf(stack.pop());</div><div class="line">        <span class="keyword">int</span> currResult = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(token.equals(<span class="string">"+"</span>))&#123;currResult = val1 + val2;&#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(token.equals(<span class="string">"-"</span>))&#123;currResult = val1 - val2;&#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(token.equals(<span class="string">"*"</span>))&#123;currResult = val1 * val2;&#125;</div><div class="line">        <span class="keyword">else</span> currResult = val1 / val2;</div><div class="line">        stack.push(String.valueOf(currResult));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> Integer.valueOf(stack.pop());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Basic-Calculator-II">2.2.2. Basic Calculator II</h3><p>æ±‚ä¸€ä¸ªè®¡ç®—å¼çš„å€¼ã€‚å…¶ä¸­è®¡ç®—å¼å«åŠ å‡ä¹˜é™¤ï¼Œä½†ä¸å«æ‹¬å·ã€‚</p>
<p><strong>æ–¹æ³•1ï¼Œæ ˆ</strong></p>
<p>ä¸€å¼€å§‹æ²¡æƒ³æ˜ç™½ã€‚å…¶å®æ€è·¯å¾ˆç®€å•ã€‚</p>
<p>å› ä¸ºä¹˜æ³•å’Œé™¤æ³•ä¸ä»…è¦çŸ¥é“ä¸‹ä¸€ä¸ªæ•°ï¼Œä¹Ÿè¦çŸ¥é“ä¸Šä¸€ä¸ªæ•°ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ªæ ˆæŠŠä¸Šæ¬¡çš„æ•°å­˜èµ·æ¥ï¼Œé‡åˆ°åŠ å‡æ³•å°±ç›´æ¥å°†æ•°å­—å‹å…¥æ ˆä¸­ï¼Œé‡åˆ°ä¹˜é™¤æ³•å°±æŠŠæ ˆé¡¶æ‹¿å‡ºæ¥ä¹˜æˆ–é™¤ä¸€ä¸‹æ–°æ•°ï¼Œå†å‹å›å»ã€‚æœ€åæˆ‘ä»¬æŠŠæ ˆé‡Œæ‰€æœ‰æ•°åŠ èµ·æ¥å°±è¡Œäº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] getNum(String s, <span class="keyword">int</span> i)&#123;</div><div class="line">        <span class="keyword">int</span> num  = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">            <span class="keyword">if</span>(Character.isDigit(s.charAt(i)))&#123;</div><div class="line">                num = num * <span class="number">10</span> + (<span class="keyword">int</span>)(s.charAt(i) - <span class="string">'0'</span>);</div><div class="line">                ++i;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">                ++i;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;num, i&#125;;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">char</span> sig = <span class="string">'+'</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·</span></div><div class="line">            <span class="keyword">if</span>(!Character.isDigit(s.charAt(i)) &amp;&amp; s.charAt(i) != <span class="string">' '</span>)&#123;</div><div class="line">                sig = s.charAt(i);</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·åé¢è·Ÿçš„æ•°å­—</span></div><div class="line">            <span class="keyword">int</span>[] temp = getNum(s, i);</div><div class="line">            <span class="keyword">int</span> num = temp[<span class="number">0</span>];</div><div class="line">            i = temp[<span class="number">1</span>];</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯åŠ å‡ï¼Œåˆ™åªéœ€è¦æŠŠåé¢çš„è¿™ä¸ªæ•°å­—pushè¿›æ ˆ</span></div><div class="line">            <span class="keyword">if</span>(sig == <span class="string">'+'</span>)</div><div class="line">                    stack.push(num);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'-'</span>)</div><div class="line">                    stack.push(-num);</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯ä¹˜é™¤ï¼Œåˆ™è¦æŠŠä¸Šä¸€ä¸ªæ•°å­—popå‡ºæ¥ä¸ä¸‹ä¸€ä¸ªæ•°å­—åšè¿ç®—ï¼Œç„¶åæ‰”å›æ ˆ</span></div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'*'</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(stack.empty()) stack.push(num);</div><div class="line">                <span class="keyword">else</span> stack.push(stack.pop() * num);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'/'</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(stack.empty()) stack.push(num);</div><div class="line">                <span class="keyword">else</span> stack.push(stack.pop() / num);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty())&#123;</div><div class="line">            result += stack.pop();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2</strong></p>
<p>æ ˆåªæ˜¯åœ¨ä¹˜é™¤çš„æ—¶å€™ç”¨åˆ°ï¼Œè€Œä¸”ä»…ä»…ç”¨åˆ°äº†ä¸Šä¸€ä¸ªæ•°å­—ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å»æ‰æ ˆï¼Œåªéœ€è¦ä¿ç•™ä¸Šä¸€ä¸ªæ•°å­—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] getNum(String s, <span class="keyword">int</span> i)&#123;</div><div class="line">    <span class="keyword">int</span> num  = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">        <span class="keyword">if</span>(Character.isDigit(s.charAt(i)))&#123;</div><div class="line">            num = num * <span class="number">10</span> + (<span class="keyword">int</span>)(s.charAt(i) - <span class="string">'0'</span>);</div><div class="line">            ++i;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">            ++i;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;num, i&#125;;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span> sig = <span class="string">'+'</span>;</div><div class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">    <span class="comment">// è·å–ç¬¬ä¸€ä¸ªæ•°å­—</span></div><div class="line">    <span class="keyword">int</span>[] temp = getNum(s, i);</div><div class="line">    <span class="keyword">int</span> lastNum = temp[<span class="number">0</span>];</div><div class="line">    i = temp[<span class="number">1</span>];</div><div class="line">    <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">        <span class="comment">// è·å–ç¬¦å·</span></div><div class="line">        <span class="keyword">if</span>(!Character.isDigit(s.charAt(i)) &amp;&amp; s.charAt(i) != <span class="string">' '</span>)&#123;</div><div class="line">            sig = s.charAt(i);</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// è·å–ç¬¦å·åé¢è·Ÿçš„æ•°å­—</span></div><div class="line">        temp = getNum(s, i);</div><div class="line">        <span class="keyword">int</span> num = temp[<span class="number">0</span>];</div><div class="line">        i = temp[<span class="number">1</span>];</div><div class="line">        <span class="comment">// å¦‚æœæ˜¯åŠ å‡ï¼Œåˆ™åªéœ€è¦æŠŠåé¢çš„è¿™ä¸ªæ•°å­—ä½œä¸ºlastNumï¼Œä¸”æŠŠä¸Šä¸€ä¸ªlastNumåŠ åˆ°resulté‡Œ</span></div><div class="line">        <span class="keyword">if</span>(sig == <span class="string">'+'</span>) &#123;</div><div class="line">            result += lastNum;</div><div class="line">            lastNum = num;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'-'</span>) &#123;</div><div class="line">            result += lastNum;</div><div class="line">            lastNum = -num;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¦‚æœæ˜¯ä¹˜é™¤ï¼Œé‚£å°±æŠŠè¿™ä¸ªæ•°å­—ä¸ä¸Šä¸€ä¸ªæ•°å­—ç›¸ä¹˜</span></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'*'</span>)&#123;</div><div class="line">            lastNum = lastNum * num;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'/'</span>)&#123;</div><div class="line">            lastNum = lastNum / num;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result + lastNum;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Basic-Calculator">2.2.3. Basic Calculator</h3><p>è¿™æ˜¯ä¸Šä¸€é¢˜çš„å‡çº§ç‰ˆã€‚è®¡ç®—å¸¦æ‹¬å·çš„åŠ å‡æ³•ã€‚</p>
<p>æˆ‘çš„æ€è·¯æ˜¯å°†æ‹¬å·å†…éƒ¨çš„è¿ç®—çœ‹åšä¸€ä¸ªæ•´ä½“ã€‚ä½†äº‹å®ä¸Šä¹‹åçœ‹é¢˜æ‰çŸ¥é“æ²¡æœ‰ä¹˜é™¤ã€‚ã€‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] calculateBase(String s, <span class="keyword">int</span> i) &#123;</div><div class="line">        <span class="keyword">if</span>(i &gt;= s.length()) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, <span class="number">0</span>&#125;;</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> LastNum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">')'</span>)&#123;</div><div class="line">                ++i;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·</span></div><div class="line">            <span class="keyword">char</span> sig = <span class="string">'+'</span>;</div><div class="line">            <span class="keyword">if</span>(!Character.isDigit(s.charAt(i)) &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">' '</span> &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">'('</span> &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">')'</span>)&#123;</div><div class="line">                sig = s.charAt(i);</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·åé¢çš„æ•°å­—</span></div><div class="line">            <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯æ‹¬å·ï¼Œé‚£å°±æŠŠæ‹¬å·åé¢çš„éƒ¨åˆ†çœ‹æˆä¸€ä¸ªæ•´ä½“</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'('</span>)&#123;</div><div class="line">                <span class="keyword">int</span>[] temp = calculateBase(s, i + <span class="number">1</span>);</div><div class="line">                i = temp[<span class="number">0</span>];</div><div class="line">                num = temp[<span class="number">1</span>];</div><div class="line">            &#125;<span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœä¸æ˜¯æ‹¬å·ï¼Œé‚£å°±æ­£å¸¸è®¡ç®—ï¼Œä¸åŸæ¥ä¸€æ ·</span></div><div class="line">                num = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">                    <span class="keyword">if</span>(Character.isDigit(s.charAt(i)))&#123;</div><div class="line">                        num = num * <span class="number">10</span> + (<span class="keyword">int</span>)(s.charAt(i) - <span class="string">'0'</span>);</div><div class="line">                        ++i;</div><div class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">                        ++i;</div><div class="line">                    &#125;<span class="keyword">else</span> &#123;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">          <span class="comment">// å¦‚æœæ˜¯åŠ å‡ï¼Œåˆ™åªéœ€è¦æŠŠåé¢çš„è¿™ä¸ªæ•°å­—ä½œä¸ºlastNumï¼Œä¸”æŠŠä¸Šä¸€ä¸ªlastNumåŠ åˆ°resulté‡Œ</span></div><div class="line">            <span class="keyword">if</span>(sig == <span class="string">'+'</span>)&#123;</div><div class="line">                result += LastNum;</div><div class="line">                LastNum = num;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'-'</span>)&#123;</div><div class="line">                result += LastNum;</div><div class="line">                LastNum = -num;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, result + LastNum&#125;;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> calculateBase(s, <span class="number">0</span>)[<span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>å¤§ç¥ä»£ç </strong></p>
<p>è‡ªå·±å†™çš„ä¾ç„¶å¾ˆå•°å—¦ã€‚ä¸‹é¢ç»ä»°ä¸€ä¸‹å¤§ç¥çš„ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// using stack to deal with parenthese</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        </div><div class="line">        Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> multiplier = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;s.length(); i++) &#123;</div><div class="line">            <span class="keyword">char</span> c = s.charAt(i);</div><div class="line">            <span class="comment">// è·å–æ•°å­—</span></div><div class="line">            <span class="keyword">if</span>(c&gt;=<span class="string">'0'</span> &amp;&amp; c&lt;=<span class="string">'9'</span>) &#123;</div><div class="line">                <span class="keyword">int</span> digit = c-<span class="string">'0'</span>;</div><div class="line">                num = num*<span class="number">10</span> + digit;</div><div class="line">             <span class="comment">// å¦‚æœæ˜¯åŠ å‡ï¼Œå°±æ­£å¸¸è®¡ç®—</span></div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">'+'</span>) &#123;</div><div class="line">                result += num*multiplier;</div><div class="line">                num = <span class="number">0</span>;</div><div class="line">                multiplier = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">'-'</span>) &#123;</div><div class="line">                result += num*multiplier ;</div><div class="line">                num = <span class="number">0</span>;</div><div class="line">                multiplier =-<span class="number">1</span>;</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯æ‹¬å·ï¼Œå°±å…ˆæŠŠåŸæ¥çš„resultçœ‹åšä¸€ä¸ªæ•´ä½“pushè¿›å»</span></div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">'('</span>) &#123;</div><div class="line">                stack.push(result);</div><div class="line">                stack.push(multiplier);</div><div class="line">                result = <span class="number">0</span>;</div><div class="line">                <span class="comment">// num = 0;</span></div><div class="line">                multiplier = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">')'</span>) &#123;</div><div class="line">                <span class="comment">// current result</span></div><div class="line">                result += num*multiplier;</div><div class="line">                <span class="comment">// last multiplier</span></div><div class="line">                result *= stack.pop();</div><div class="line">                result += stack.pop();</div><div class="line">                <span class="comment">// result = 0;</span></div><div class="line">                num = <span class="number">0</span>;</div><div class="line">                <span class="comment">// multiplier = 1;</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        result += num*multiplier;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Basic-Calculator-III">2.2.4. Basic Calculator III</h3><p>å¸¦æ‹¬å·çš„åŠ å‡ä¹˜é™¤ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] calculateBase(String s, <span class="keyword">int</span> i) &#123;</div><div class="line">        <span class="keyword">if</span>(i &gt;= s.length()) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, <span class="number">0</span>&#125;;</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> LastNum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">            <span class="keyword">while</span> (i &lt; s.length() &amp;&amp; s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">')'</span>)&#123;</div><div class="line">                ++i;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·</span></div><div class="line">            <span class="keyword">char</span> sig = <span class="string">'+'</span>;</div><div class="line">            <span class="keyword">if</span>(!Character.isDigit(s.charAt(i)) &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">' '</span> &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">'('</span> &amp;&amp;</div><div class="line">                    s.charAt(i) != <span class="string">')'</span>)&#123;</div><div class="line">                sig = s.charAt(i);</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (i &lt; s.length() &amp;&amp; s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è·å–ç¬¦å·åé¢çš„æ•°å­—</span></div><div class="line">            <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯æ‹¬å·ï¼Œé‚£å°±æŠŠæ‹¬å·åé¢çš„éƒ¨åˆ†çœ‹æˆä¸€ä¸ªæ•´ä½“</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'('</span>)&#123;</div><div class="line">                <span class="keyword">int</span>[] temp = calculateBase(s, i + <span class="number">1</span>);</div><div class="line">                i = temp[<span class="number">0</span>];</div><div class="line">                num = temp[<span class="number">1</span>];</div><div class="line">            &#125;<span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœä¸æ˜¯æ‹¬å·ï¼Œé‚£å°±æ­£å¸¸è®¡ç®—ï¼Œä¸åŸæ¥ä¸€æ ·</span></div><div class="line">                num = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (i &lt; s.length())&#123;</div><div class="line">                    <span class="keyword">if</span>(Character.isDigit(s.charAt(i)))&#123;</div><div class="line">                        num = num * <span class="number">10</span> + (<span class="keyword">int</span>)(s.charAt(i) - <span class="string">'0'</span>);</div><div class="line">                        ++i;</div><div class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">                        ++i;</div><div class="line">                    &#125;<span class="keyword">else</span> &#123;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// å¦‚æœæ˜¯åŠ å‡ï¼Œåˆ™åªéœ€è¦æŠŠåé¢çš„è¿™ä¸ªæ•°å­—ä½œä¸ºlastNumï¼Œä¸”æŠŠä¸Šä¸€ä¸ªlastNumåŠ åˆ°resulté‡Œ</span></div><div class="line">            <span class="keyword">if</span>(sig == <span class="string">'+'</span>)&#123;</div><div class="line">                result += LastNum;</div><div class="line">                LastNum = num;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'-'</span>)&#123;</div><div class="line">                result += LastNum;</div><div class="line">                LastNum = -num;</div><div class="line">                <span class="comment">// å¦‚æœæ˜¯ä¹˜é™¤ï¼Œé‚£å°±æŠŠè¿™ä¸ªæ•°å­—ä¸ä¸Šä¸€ä¸ªæ•°å­—ç›¸ä¹˜</span></div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'*'</span>)&#123;</div><div class="line">                LastNum = num * LastNum;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sig == <span class="string">'/'</span>)&#123;</div><div class="line">                LastNum = LastNum / num;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (i &lt; s.length() &amp;&amp; s.charAt(i) == <span class="string">' '</span>)&#123;</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, result + LastNum&#125;;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculate</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> calculateBase(s, <span class="number">0</span>)[<span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="å…¶å®ƒé—®é¢˜">2.3. å…¶å®ƒé—®é¢˜</h2><h3 id="Simplify-Path">2.3.1. Simplify Path</h3><p>ç®€åŒ–è·¯å¾„ã€‚<strong>path</strong> = <code>&quot;/a/./b/../../c/&quot;</code>, =&gt; <code>&quot;/c&quot;</code></p>
<p>æ­¤é¢˜æˆ‘è§‰å¾—å…³é”®ä¹‹å¤„åœ¨äºï¼ŒçŸ¥é“è·¯å¾„æ˜¯ç”±<code>/</code> ç¬¦å·åˆ†å‰²çš„ã€‚å› æ­¤å¯ä»¥ç”¨<code>/</code> å·åˆ†å‰²åè®¡ç®—</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> /../ä»£è¡¨ä¸Šä¸€å±‚è·¯å¾„</div><div class="line">/./ä»£è¡¨æœ¬å±‚è·¯å¾„</div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">helper</span><span class="params">(String path)</span></span>&#123;</div><div class="line">    Deque&lt;String&gt; stack = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    String[] segments = path.split(<span class="string">"/"</span>);</div><div class="line">    <span class="keyword">for</span>(String seg : segments)&#123;</div><div class="line">        <span class="keyword">if</span>(seg.length()== <span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(seg.equals(<span class="string">".."</span>))&#123;</div><div class="line">            <span class="keyword">if</span>(!stack.isEmpty()) stack.pop();</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(seg.equals(<span class="string">"."</span>))&#123;<span class="keyword">continue</span>;&#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            stack.push(seg);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">     <span class="keyword">while</span> (!stack.isEmpty())&#123;</div><div class="line">        sb.append(<span class="string">"/"</span>);</div><div class="line">        sb.append(stack.pollLast());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sb.length() == <span class="number">0</span> ? <span class="string">"/"</span> : sb.toString();</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">simplifyPath</span><span class="params">(String path)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> helper(path);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Min-Stack">2.3.2. Min Stack</h3><p>å®ç°ä¸€ä¸ªèƒ½å®æ—¶è¾“å‡ºæœ€å°å€¼çš„æ ˆã€‚</p>
<p><strong>æ€è·¯ä¸€ï¼šæ ˆ + ä¼˜å…ˆé˜Ÿåˆ—</strong></p>
<p>/<em>* initialize your data structure here. </em>/</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">    <span class="keyword">long</span> val;</div><div class="line">    <span class="keyword">boolean</span> deleted;</div><div class="line">    Node(<span class="keyword">int</span> val) &#123;</div><div class="line">        <span class="keyword">this</span>.val = val;</div><div class="line">        deleted = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.val - o.val &gt;= <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">LinkedList&lt;Node&gt; links;</div><div class="line">PriorityQueue&lt;Node&gt; priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MinStack</span><span class="params">()</span> </span>&#123;</div><div class="line">    links = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    Node xNode = <span class="keyword">new</span> Node(x);</div><div class="line">    links.addFirst(xNode);</div><div class="line">    priorityQueue.add(xNode);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">    Node removed = links.removeFirst();</div><div class="line">    removed.deleted = <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)links.get(<span class="number">0</span>).val;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">while</span> (priorityQueue.peek().deleted)&#123;</div><div class="line">        priorityQueue.poll();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)priorityQueue.peek().val;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œéªšæ“ä½œ</strong></p>
<p>å¯¹äºå½“å‰å·²ç»å…¥æ ˆçš„å…ƒç´ æ¥è¯´ï¼Œç»´æŠ¤å½“å‰å…¥æ ˆå…ƒç´ çš„æœ€å°å€¼ã€‚ç›¸å½“é¸¡è´¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** initialize your data structure here. */</span></div><div class="line">    </div><div class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</div><div class="line">        Stack&lt;Integer&gt; stack=<span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(x&lt;=min)&#123; <span class="comment">// å¦‚æœxæ¯”å½“å‰æ ˆé‡Œæ‰€æœ‰å…ƒç´ éƒ½å°ï¼Œè¯´æ˜xæ˜¯å½“å‰æ ˆçš„æœ€å°å€¼</span></div><div class="line">            stack.push(min); <span class="comment">// å…ˆæŠŠä¹‹å‰çš„minå…¥æ ˆ</span></div><div class="line">            min=x; <span class="comment">// æ”¹å˜æœ€å°å€¼</span></div><div class="line">        &#125;</div><div class="line">       stack.push(x);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(stack.pop()== min) <span class="comment">//æ­¤æ­¥å·²ç»å°†-3popå‡ºå»</span></div><div class="line">            min=stack.pop(); <span class="comment">//æ­¤æ­¥å°†-3ä¹‹å‰çš„æœ€å°å€¼-2,ä»stackä¸­popå‡ºå»ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™min</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> stack.peek();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> min;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Implement-Queue-using-Stacks">2.3.3. Implement Queue using Stacks</h3><p>ç”¨æ ˆå®ç°é˜Ÿåˆ—ã€‚</p>
<p>è¿™ä¸ªæ–¹å¼ç›¸å½“é¸¡è´¼ã€‚æˆ‘æ²¡æœ‰æƒ³åˆ°ã€‚æˆ‘è‡ªå·±çš„æ–¹æ³•å¤ªæš´åŠ›äº†ã€‚</p>
<p>é˜Ÿåˆ—å’Œæ ˆéƒ½æ˜¯é¡ºåºæ’å…¥çš„ï¼ŒåŒºåˆ«åœ¨äºé˜Ÿåˆ—çš„å‡ºå£æ–¹å‘å’Œæ ˆçš„å‡ºå£æ–¹å‘æ˜¯ç›¸åçš„ï¼Œåˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œå¦‚æœæˆ‘ä»¬å°†å…ƒç´ æŒ‰ç…§é¡ºåºæ’å…¥æ ˆåï¼Œå†ä¸€ä¸ªä¸ªå¼¹å‡ºå¹¶åå‘æ’å…¥å¦ä¸€ä¸ªæ ˆï¼Œé‚£ä¹ˆè¿™ç¬¬äºŒä¸ªæ ˆçš„å‡ºå£é¡ºåºå°±å’Œé˜Ÿåˆ—æ˜¯ä¸€æ ·çš„äº†ã€‚æ‰€ä»¥æˆ‘ä»¬æ„é€ ä¸¤ä¸ªæ ˆï¼Œæ‰€æœ‰æ–°åŠ çš„å…ƒç´ éƒ½åŠ å…¥è¾“å…¥æ ˆï¼Œä¸€æ—¦è¦å‡ºé˜Ÿåˆ—æ—¶ï¼Œæˆ‘ä»¬ä¾¿å°†è¾“å…¥æ ˆçš„å…ƒç´ éƒ½åå‘åŠ å…¥è¾“å‡ºæ ˆï¼Œå†è¾“å‡ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¾“å‡ºæ ˆä¸ä¸ºç©ºæ—¶ï¼Œè¯´æ˜å½“å‰è¦è¾“å‡ºçš„å…ƒç´ è¿˜åœ¨è¾“å‡ºæ ˆä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æš‚æ—¶ä¸ç”¨å°†è¾“å…¥æ ˆçš„å…ƒç´ åŠ å…¥è¾“å‡ºæ ˆï¼ˆè€Œä¸”åŠ å…¥åä¹Ÿä¼šå¯¼è‡´é¡ºåºé”™è¯¯ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">Stack&lt;Integer&gt; input;</div><div class="line">Stack&lt;Integer&gt; ouput;</div><div class="line"><span class="comment">/** Initialize your data structure here. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MyQueue</span><span class="params">()</span> </span>&#123;</div><div class="line">    input = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    ouput = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Push element x to the back of queue. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    input.push(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Removes the element from in front of queue and returns that element. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(ouput.empty())&#123;</div><div class="line">        <span class="comment">// å°†inputä¸­çš„æ‰€æœ‰å…ƒç´ å…¨éƒ¨æ”¾å…¥output</span></div><div class="line">        <span class="keyword">while</span> (!input.empty())&#123;ouput.push(input.pop());&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// è¾“å‡ºæœ€åæ”¾å…¥çš„å…ƒç´ </span></div><div class="line">    <span class="keyword">return</span> ouput.pop();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Get the front element. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">peek</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(ouput.empty())&#123;</div><div class="line">        <span class="comment">// å°†inputä¸­çš„æ‰€æœ‰å…ƒç´ å…¨éƒ¨æ”¾å…¥output</span></div><div class="line">        <span class="keyword">while</span> (!input.empty())&#123;ouput.push(input.pop());&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// è¾“å‡ºæœ€åæ”¾å…¥çš„å…ƒç´ </span></div><div class="line">    <span class="keyword">return</span> ouput.peek();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** Returns whether the queue is empty. */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> input.empty() &amp;&amp; ouput.empty();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å›æº¯æ³•]]></title>
      <url>/2017/12/21/%E7%AE%97%E6%B3%95-%E5%9B%9E%E6%BA%AF%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>  å›æº¯ç®—æ³•å®é™…ä¸Šä¸€ä¸ªç±»ä¼¼æšä¸¾çš„æœç´¢å°è¯•è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯åœ¨æœç´¢å°è¯•è¿‡ç¨‹ä¸­å¯»æ‰¾é—®é¢˜çš„è§£ï¼Œå½“å‘ç°å·²ä¸æ»¡è¶³æ±‚è§£æ¡ä»¶æ—¶ï¼Œå°±â€œå›æº¯â€è¿”å›ï¼Œå°è¯•åˆ«çš„è·¯å¾„ã€‚</p>
<p>   å›æº¯æ³•æ˜¯ä¸€ç§é€‰ä¼˜æœç´¢æ³•ï¼ŒæŒ‰é€‰ä¼˜æ¡ä»¶å‘å‰æœç´¢ï¼Œä»¥è¾¾åˆ°ç›®æ ‡ã€‚ä½†å½“æ¢ç´¢åˆ°æŸä¸€æ­¥æ—¶ï¼Œå‘ç°åŸå…ˆé€‰æ‹©å¹¶ä¸ä¼˜æˆ–è¾¾ä¸åˆ°ç›®æ ‡ï¼Œå°±é€€å›ä¸€æ­¥é‡æ–°é€‰æ‹©ï¼Œè¿™ç§èµ°ä¸é€šå°±é€€å›å†èµ°çš„æŠ€æœ¯ä¸ºå›æº¯æ³•ï¼Œè€Œæ»¡è¶³å›æº¯æ¡ä»¶çš„æŸä¸ªçŠ¶æ€çš„ç‚¹ç§°ä¸ºâ€œå›æº¯ç‚¹â€ã€‚</p>
<a id="more"></a>
<h1 id="å…«çš‡åé—®é¢˜">1. å…«çš‡åé—®é¢˜</h1><p>åœ¨æ£‹ç›˜ä¸Šæ”¾ç½®8ä¸ªçš‡åï¼Œä½¿å¾—å®ƒä»¬äº’ä¸æ”»å‡»ï¼Œæ­¤æ—¶æ¯ä¸ªçš‡åçš„æ”»å‡»èŒƒå›´ä¸ºåŒè¡ŒåŒåˆ—å’ŒåŒ<br>å¯¹è§’çº¿ï¼Œè¦æ±‚æ‰¾å‡ºæ‰€æœ‰è§£ï¼Œå¦‚å›¾7-4æ‰€ç¤ºã€‚ </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-21-22-15-31.png" alt=""> </p>
<p>æš´åŠ›æ€è·¯ï¼š</p>
<p>64é€‰8ï¼Œæœ‰$C_{64}^8$ç§æ–¹æ¡ˆã€‚</p>
<p>ä¼˜åŒ–ï¼š</p>
<p>å› ä¸ºæ°å¥½æ¯è¡Œæ¯åˆ—å„æ”¾ç½®ä¸€ä¸ªçš‡åï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå…¨æ’åˆ—é—®é¢˜ã€‚è€Œ0~7çš„æ’åˆ—ä¸€å…±åªæœ‰$8! = 40320$ä¸ªã€‚å¦‚æœæšä¸¾çš„è¯ï¼Œä¹Ÿæ²¡å¤šå°‘ä¸ªã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿åˆ†æï¼Œæˆ‘ä»¬å…ˆæŠŠé—®é¢˜ç®€åŒ–ä¸º4çš‡åé—®é¢˜ã€‚</p>
<p>å‡å¦‚çš‡åç°åœ¨çš„ä½ç½®æ˜¯<code>ï¼ˆ0,2.*,*)</code></p>
<p>å³ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> * * *</div><div class="line">* * <span class="number">1</span> *</div><div class="line">* * * *</div><div class="line">* * * *</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶åé¢ä¸¤ä¸ªçš‡åæ— è®ºæ”¾å“ªé‡Œï¼Œéƒ½ä¼šå’Œå‰ä¸¤è¡Œçš„çš‡åå†²çªã€‚æ­¤æ—¶ï¼Œé€’å½’å‡½æ•°å°†ä¸å†é€’å½’è°ƒç”¨å®ƒè‡ªèº«ï¼Œè€Œæ˜¯è¿”å›ä¸Šä¸€å±‚ã€‚è¿™ä¸ªå°±å«å›æº¯ã€‚</p>
<p>æˆ‘ä»¬ç”»å‡ºå››çš‡åçš„è§£ç­”æ ‘ï¼ˆæ¯ä¸ªå…ƒç´ ä»£è¡¨ç¬¬iä¸ªçš‡åæ”¾åœ¨ç¬¬jåˆ—ï¼‰ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-22-18-16-28.png" alt=""> </p>
<p>å› æ­¤ï¼Œå…«çš‡åé—®é¢˜å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span>[] C = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">8</span>]; <span class="comment">// C[i]è¡¨ç¤ºç¬¬iè¡Œçš„çš‡åæ”¾åœ¨äº†C[i]åˆ—</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> cur)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(cur == n)&#123; <span class="comment">// nä¸ªçš‡åéƒ½ä¸å†²çª</span></div><div class="line">    ++counter;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">    <span class="keyword">int</span> ok = <span class="number">1</span>;</div><div class="line">    <span class="comment">// å°è¯•æŠŠç¬¬curè¡Œçš„çš‡åæ”¾åœ¨ç¬¬iåˆ—</span></div><div class="line">    C[cur] = i;</div><div class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦å’Œå‰é¢çš‡åå†²çª</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cur; ++j)&#123;</div><div class="line">      <span class="keyword">if</span>(C[cur] == C[j]||</div><div class="line">        cur - C[cur] == j - C[j]||</div><div class="line">         CUR + C[cur] == j + C[j])&#123;</div><div class="line">        ok = <span class="number">0</span>;</div><div class="line">        <span class="keyword">break</span>; <span class="comment">// å¦‚æœå†²çªï¼Œå°±ä¸å†ç»§ç»­æœç´¢</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(ok) search(cur + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š</p>
<p>éªšæ“ä½œï¼šç”¨äºŒç»´æ•°ç»„<code>vis[3][]</code>åˆ¤æ–­å½“å‰å°è¯•çš„çš‡åæ˜¯å¦ä¸å…¶ä»–çš‡åå†²çªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">å…ˆçœ‹çœ‹è¿™ä¸ªï¼š</div><div class="line"></div><div class="line">  <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="number">0</span> <span class="number">1</span> * * *</div><div class="line"><span class="number">1</span> * <span class="number">1</span> * *</div><div class="line"><span class="number">2</span> * * <span class="number">1</span> *</div><div class="line"><span class="number">3</span> * * * <span class="number">1</span></div><div class="line"></div><div class="line">æˆ‘ä»¬çœ‹çœ‹æ ‡<span class="number">1</span>çš„å¯¹è§’çº¿ä¸Šçš„iå’Œjæœ‰ä»€ä¹ˆå…³ç³»ï¼š</div><div class="line"></div><div class="line">è¿™ä¸ªå¯¹è§’çº¿i == j</div><div class="line"></div><div class="line">æˆ‘ä»¬çœ‹ä¸‹ä¸€ä¸ªå¯¹è§’çº¿ï¼š</div><div class="line"></div><div class="line"></div><div class="line">  <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="number">0</span> * <span class="number">1</span> * *</div><div class="line"><span class="number">1</span> * * <span class="number">1</span> *</div><div class="line"><span class="number">2</span> * * * <span class="number">1</span></div><div class="line"><span class="number">3</span> * * * *</div><div class="line"></div><div class="line">è¿™ä¸ªå¯¹è§’çº¿ i == j + <span class="number">1</span></div><div class="line">  </div><div class="line">å…¶å®ï¼Œè¿™ä¸ªæ–¹å‘çš„å¯¹è§’çº¿ï¼Œåªè¦åœ¨ä¸€ä¸ªå¯¹è§’çº¿ä¸Šï¼Œé‚£ä¹ˆ i - j å°±æ˜¯ä¸€ä¸ªå®šå€¼</div><div class="line"></div><div class="line">é‚£ä¹ˆï¼š</div><div class="line"></div><div class="line">vis[<span class="number">0</span>][i] :ç¬¬iåˆ—æ˜¯å¦å·²æœ‰çš‡åï¼›</div><div class="line">vis[<span class="number">1</span>][j + i] : ç¬¬jè¡Œiåˆ—å¯¹åº”çš„å¯¹è§’çº¿æ˜¯å¦å·²ç»æœ‰çš‡åï¼ˆå› ä¸ºåŒä¸€ä¸ªå¯¹è§’çº¿ä¸Šçš„i + jéƒ½æ˜¯ç›¸ç­‰çš„ï¼‰</div><div class="line">vis[<span class="number">2</span>][j - i + n] ï¼š ç¬¬jè¡Œiåˆ—å¯¹è§’çº¿æ˜¯å¦å·²ç»æœ‰çš‡å (åŒä¸€å¯¹è§’çº¿ä¸Š j - i æ˜¯ä¸€ä¸ªå®šå€¼ ï¼Œ ä½†å¯èƒ½å‡ºç°è´Ÿæ•°ï¼Œå› æ­¤åŠ ä¸€ä¸ªn)</div><div class="line">  </div><div class="line"><span class="keyword">boolean</span>[][] vis ;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> cur)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(cur == n)&#123; <span class="comment">// nä¸ªçš‡åéƒ½ä¸å†²çª</span></div><div class="line">    ++counter;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">    <span class="comment">// å°è¯•æŠŠç¬¬curè¡Œçš„çš‡åæ”¾åœ¨ç¬¬iåˆ—</span></div><div class="line">    C[cur] = i;</div><div class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦å’Œå‰é¢çš‡åå†²çª</span></div><div class="line">    <span class="keyword">if</span>(!vis[<span class="number">0</span>][i] &amp;&amp; !vis[<span class="number">1</span>][cur + i] &amp;&amp; !vis[<span class="number">2</span>][cur - i + n])&#123;</div><div class="line">      C[cur] = i;</div><div class="line">      vis[<span class="number">0</span>][i] = vis[<span class="number">1</span>][cur + i] = vis[<span class="number">2</span>][cur - i + n] = <span class="keyword">true</span>;</div><div class="line">      search(cur + <span class="number">1</span>);</div><div class="line">      vis[<span class="number">0</span>][i] = vis[<span class="number">1</span>][cur + i] = vis[<span class="number">2</span>][cur - i + n] = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="N-Queens">1.1. N-Queens</h2><p>Nçš‡åé—®é¢˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;String&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">boolean</span>[][] vis ;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * vis[0][i] : ç¬¬iåˆ—æœ‰æ²¡æœ‰çš‡å</div><div class="line">     * vis[1][i + j] : ç¬¬ i+j å¯¹è§’çº¿æœ‰æ— çš‡å</div><div class="line">     * vis[2][i - j + n] : ç¬¬ i-j å¯¹è§’çº¿æœ‰æ— çš‡å**/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> row, List&lt;String&gt; pos, <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(row == n)&#123;</div><div class="line">            List&lt;String&gt; one = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">            one.addAll(pos);</div><div class="line">            result.add(one);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å°è¯•å°†ç¬¬rowè¡Œçš„çš‡åæ”¾å…¥ç¬¬colåˆ—</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; n; ++ col)&#123;</div><div class="line">            <span class="keyword">if</span>(!vis[<span class="number">0</span>][col] &amp;&amp; !vis[<span class="number">1</span>][col + row] &amp;&amp; !vis[<span class="number">2</span>][col - row + n])&#123;</div><div class="line">                <span class="comment">// æ„å»ºç¬¬rowè¡Œçš„çš‡åé˜µåˆ—</span></div><div class="line">                StringBuilder strBu = <span class="keyword">new</span> StringBuilder();</div><div class="line">                <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> (i &lt; n)&#123;</div><div class="line">                    <span class="keyword">if</span>(i == col) &#123;</div><div class="line">                        strBu.append(<span class="string">"Q"</span>);</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        strBu.append(<span class="string">"."</span>);</div><div class="line">                    &#125;</div><div class="line">                    ++i;</div><div class="line">                &#125;</div><div class="line">                pos.add(strBu.toString());</div><div class="line">                vis[<span class="number">0</span>][col] = <span class="keyword">true</span>;</div><div class="line">                vis[<span class="number">1</span>][col + row] = <span class="keyword">true</span>;</div><div class="line">                vis[<span class="number">2</span>][col - row + n] = <span class="keyword">true</span>;</div><div class="line">                helper(row + <span class="number">1</span>, pos, n);</div><div class="line">                pos.remove(pos.size() - <span class="number">1</span>);</div><div class="line">                vis[<span class="number">0</span>][col] = <span class="keyword">false</span>;</div><div class="line">                vis[<span class="number">1</span>][col + row] = <span class="keyword">false</span>;</div><div class="line">                vis[<span class="number">2</span>][col - row + n] = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; solveNQueens(<span class="keyword">int</span> n) &#123;</div><div class="line">        vis = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">3</span>][<span class="number">2</span>*n];</div><div class="line">        helper(<span class="number">0</span>,<span class="keyword">new</span> LinkedList&lt;&gt;(), n);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="N-Queens-II">1.2. N-Queens II</h2><p>æ±‚Nçš‡åçš„æ‰€æœ‰çš„å¯èƒ½æ’åˆ—æ•°ç›®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span>[][] vis ;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * vis[0][i] : ç¬¬iåˆ—æœ‰æ²¡æœ‰çš‡å</div><div class="line">     * vis[1][i + j] : ç¬¬ i+j å¯¹è§’çº¿æœ‰æ— çš‡å</div><div class="line">     * vis[2][i - j + n] : ç¬¬ i-j å¯¹è§’çº¿æœ‰æ— çš‡å**/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(row == n)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="comment">// å°è¯•å°†ç¬¬rowè¡Œçš„çš‡åæ”¾å…¥ç¬¬colåˆ—</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; n; ++ col)&#123;</div><div class="line">            <span class="keyword">if</span>(!vis[<span class="number">0</span>][col] &amp;&amp; !vis[<span class="number">1</span>][col + row] &amp;&amp; !vis[<span class="number">2</span>][col - row + n])&#123;</div><div class="line">                vis[<span class="number">0</span>][col] = <span class="keyword">true</span>;</div><div class="line">                vis[<span class="number">1</span>][col + row] = <span class="keyword">true</span>;</div><div class="line">                vis[<span class="number">2</span>][col - row + n] = <span class="keyword">true</span>;</div><div class="line">                counter += helper(row + <span class="number">1</span>, n);</div><div class="line">                vis[<span class="number">0</span>][col] = <span class="keyword">false</span>;</div><div class="line">                vis[<span class="number">1</span>][col + row] = <span class="keyword">false</span>;</div><div class="line">                vis[<span class="number">2</span>][col - row + n] = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">totalNQueens</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        vis = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">3</span>][<span class="number">2</span>*n];</div><div class="line">        <span class="keyword">return</span> helper(<span class="number">0</span>, n);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å…¨æ’åˆ—é—®é¢˜">2. å…¨æ’åˆ—é—®é¢˜</h1><p>å…¨æ’åˆ—é—®é¢˜ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>æš´åŠ›æšä¸¾ã€å›æº¯</li>
<li>Heapâ€™s Algorithm</li>
<li>å›ºå®š-äº¤æ¢æ³•</li>
<li>å­—å…¸æ³•</li>
<li>æ±‚ç¬¬kä¸ªæ’åˆ—ï¼Œè®¡ç®—æ³•</li>
</ul>
<h2 id="Permutations">2.1. Permutations</h2><p>ç»™ä¸€ä¸ªæ— é‡æ•°ç»„ï¼Œç”Ÿæˆè¿™ä¸ªæ•°ç»„æ•°å­—çš„å…¨æ’åˆ—ã€‚</p>
<p><strong>æš´åŠ›å¾ªç¯æ³•</strong></p>
<p>ä¸€èˆ¬æœ€å…ˆæƒ³åˆ°çš„æ–¹æ³•æ˜¯æš´åŠ›å¾ªç¯æ³•ï¼Œå³å¯¹äºæ¯ä¸€ä½ï¼Œéå†é›†åˆä¸­å¯èƒ½çš„å…ƒç´ ï¼Œå¦‚æœåœ¨è¿™ä¸€ä½ä¹‹å‰å‡ºç°è¿‡äº†è¯¥å…ƒç´ ï¼Œè·³è¿‡è¯¥å…ƒç´ ã€‚ä¾‹å¦‚å¯¹äº<code>123</code>ï¼Œç¬¬ä¸€ä½å¯ä»¥æ˜¯ 1 æˆ– 2 æˆ– 3 ã€‚å½“ç¬¬ä¸€ä½ä¸º 1æ—¶ï¼Œç¬¬äºŒä½å†éå†é›†åˆï¼Œå‘ç° 1 ä¸è¡Œï¼Œå› ä¸ºå‰é¢å·²ç»å‡ºç° 1 äº†ï¼Œè€Œ 2 å’Œ 3 å¯ä»¥ã€‚å½“ç¬¬äºŒä½ä¸º 2 æ—¶ ï¼Œ å†éå†é›†åˆï¼Œå‘ç° 1 å’Œ 2éƒ½ä¸è¡Œï¼Œ3 å¯ä»¥ã€‚å¯ä»¥ç”¨é€’å½’æˆ–å¾ªç¯æ¥å®ç°ï¼Œä½†æ˜¯å¤æ‚åº¦ä¸º $O(n^n)$ ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// å…¸å‹çš„å›æº¯æ–¹æ³•</span></div><div class="line"></div><div class="line">List&lt;List&lt;Integer&gt;&gt; result;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">boolean</span>[] used, List&lt;Integer&gt; preArr)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(preArr.size() == nums.length)&#123;</div><div class="line">            List&lt;Integer&gt; one = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">            one.addAll(preArr);</div><div class="line">            result.add(one);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">           <span class="comment">// å¦‚æœnums[i]è¢«ç”¨è¿‡äº†ï¼Œå°±è·³è¿‡</span></div><div class="line">            <span class="keyword">if</span>(used[i]) <span class="keyword">continue</span>;</div><div class="line">            <span class="comment">// å¦åˆ™ï¼ŒåŠ å…¥åˆ°å½“å‰åºåˆ—é‡Œ</span></div><div class="line">            preArr.add(nums[i]);</div><div class="line">            used[i] = <span class="keyword">true</span>;</div><div class="line">            helper(nums,used,preArr);</div><div class="line">            preArr.remove(preArr.size() - <span class="number">1</span>);</div><div class="line">            used[i] = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permute(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        <span class="keyword">boolean</span>[] used = <span class="keyword">new</span> <span class="keyword">boolean</span>[nums.length];</div><div class="line">        result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        helper(nums,used,<span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æœ‰æ²¡æœ‰æ›´ä¼˜é›…çš„è§£æ³•å‘¢ã€‚</p>
<p>å½“ç„¶æ˜¯æœ‰éªšæ“ä½œçš„ã€‚</p>
<p><strong>Heapâ€™s Algorithm</strong></p>
<p><code>Heap&#39;s Algorithm</code> æ˜¯B. R. Heapåœ¨1963æå‡ºçš„ä¸€ç§å…¨æ’åˆ—çš„ç®—æ³•ã€‚æ ¸å¿ƒæ€æƒ³å°±æ˜¯æ¯æ¬¡ä¿æŒ<code>n - 2</code>ä¸ªå…ƒç´ ä¸åŠ¨ï¼Œå¯¹å‰©ä½™çš„ä¸¤ä¸ªå…ƒç´ è¿›è¡Œäº¤æ¢ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬ä»¥<code>[a,b,c,d]</code>è¿™å››ä¸ªå…ƒç´ çš„å…¨æ’åˆ—ä¸ºä¾‹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å°†å…ƒç´ <code>d</code>ä½œä¸ºå›ºå®šå…ƒç´ æ‹¿å‡ºæ¥ï¼Œå¯¹<code>[a,b,c]</code>è¿›è¡Œå…¨æ’åˆ—ï¼Œè€Œå¯¹<code>[a,b,c]</code>è¿›è¡Œå…¨æ’åˆ—çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆå°†<code>c</code>ä½œä¸ºå›ºå®šå…ƒç´ æ‹¿å‡ºæ¥ï¼Œå¯¹å…ƒç´ <code>a</code>ã€<code>b</code>è¿›è¡Œäº¤æ¢ï¼Œè¿™æ ·å°±å¾—åˆ°å…¨æ’åˆ—çš„ä¸¤ç§å¯èƒ½ã€‚åŒç†ï¼Œä¸‹ä¸€æ­¥æ˜¯æˆ‘ä»¬å°†<code>b</code>ä½œä¸ºå›ºå®šå…ƒç´ æ‹¿å‡ºæ¥ï¼Œå¯¹<code>a</code>ã€<code>c</code>è¿›è¡Œäº¤æ¢ã€‚ä¾æ¬¡ç±»æ¨ã€‚è¿™å¼ å›¾è¯¦ç»†åœ°å±•ç¤ºäº†è¿™ä¸€ç§ç®—æ³•æ€æƒ³ï¼Œ<a href="https://upload.wikimedia.org/wikipedia/commons/1/19/Heap_algorithm_with_4_elements.svg" target="_blank" rel="external">è¯·å‚è€ƒ</a>ã€‚</p>
<p>å¯èƒ½æœ‰ç‚¹ä¸å¥½ç†è§£ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä¼ªä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¿æŒç¬¬nä¸ªå…ƒç´ ä¸åŠ¨ï¼Œå¯¹å‰n-1ä¸ªå…ƒç´ è¿›è¡Œå…¨æ’åˆ—</span></div><div class="line">generate(<span class="keyword">int</span> n, <span class="keyword">int</span>[] A)&#123;</div><div class="line">  <span class="keyword">if</span> n == <span class="number">1</span> <span class="function">then</span></div><div class="line">    <span class="title">output</span><span class="params">(A)</span></div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="title">for</span><span class="params">(i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</span>&#123;</div><div class="line">      generate(n-<span class="number">1</span>, A)</div><div class="line">        <span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">0</span>)&#123; <span class="comment">// å¦‚æœnæ˜¯å¶æ•°ï¼Œäº¤æ¢ç¬¬iä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ </span></div><div class="line">          swap(A[i], A[n-<span class="number">1</span>])</div><div class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">// å¦‚æœnæ˜¯å¥‡æ•°ï¼Œäº¤æ¢ç¬¬1ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ ï¼›</span></div><div class="line">          swap(A[<span class="number">0</span>], A[n-<span class="number">1</span>])</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    generate(n-<span class="number">1</span>, A)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œå¹¶ä¸èƒ½çœ‹æ‡‚åœ¨å¹²å•¥ã€‚</p>
<p><strong>å›ºå®š-äº¤æ¢æ³•</strong></p>
<p>è¿˜æœ‰ä¸€ç§æ€è·¯ï¼Œè¿™ä¸ªæ›´å¥½ç†è§£ä¸€ä¸¢ä¸¢ï¼š</p>
<p>nä¸ªæ•°çš„å…¨æ’åˆ—ï¼Œä¸€å…±æœ‰$n!$ç§æƒ…å†µ. ï¼ˆnä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªä½ç½®æœ‰nç§ï¼Œå½“ç¬¬ä¸€ä¸ªä½ç½®å›ºå®šä¸‹æ¥ä¹‹åï¼Œç¬¬äºŒä¸ªä½ç½®æœ‰n-1ç§æƒ…å†µâ€¦ï¼‰</p>
<p>å…¨æ’åˆ—çš„è¿‡ç¨‹ï¼š</p>
<ul>
<li>é€‰æ‹©ç¬¬ä¸€ä¸ªå­—ç¬¦</li>
<li>è·å¾—ç¬¬ä¸€ä¸ªå­—ç¬¦å›ºå®šä¸‹æ¥ä¹‹åçš„æ‰€æœ‰çš„å…¨æ’åˆ—<ul>
<li>é€‰æ‹©ç¬¬äºŒä¸ªå­—ç¬¦</li>
<li>è·å¾—ç¬¬ä¸€+ äºŒä¸ªå­—ç¬¦å›ºå®šä¸‹æ¥ä¹‹åçš„æ‰€æœ‰çš„å…¨æ’åˆ—</li>
</ul>
</li>
</ul>
<p>ä»è¿™ä¸ªè¿‡ç¨‹å¯è§ï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ã€‚</p>
<p>æ‰€ä»¥è¿™ç§æ–¹å¼ä¹Ÿæ˜¯é€šè¿‡å›ºå®šä¸€ä¸ªå…ƒç´ ï¼Œè¿›è¡Œå‰©ä½™å…ƒç´ çš„äº¤æ¢ã€‚ç¼ºç‚¹æ˜¯ï¼Œæ¯æ¬¡äº¤æ¢è¿‡åéœ€è¦å†æ¬¡äº¤æ¢ä»¥å›åˆ°ä¸Šä¸€å±‚æ•°ç»„ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-23-21-01-06.png" alt=""> </p>
<p>ä»£ç è¾ƒä¸ºç®€å•äº›ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums,<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> temp = nums[i];</div><div class="line">        nums[i] = nums[j];</div><div class="line">        nums[j] = temp;</div><div class="line">    &#125;</div><div class="line">    List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> fixed)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(fixed == nums.length)&#123;</div><div class="line">            List&lt;Integer&gt; one = <span class="keyword">new</span> ArrayList&lt;&gt;(nums.length);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> e : nums)&#123;one.add(e);&#125;</div><div class="line">            result.add(one);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å°†fixedä¾æ¬¡ä¸åé¢çš„å…ƒç´ äº¤æ¢</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = fixed; i &lt; nums.length; ++i)&#123;</div><div class="line">            swap(nums, i, fixed);</div><div class="line">            helper(nums, fixed + <span class="number">1</span>);</div><div class="line">            swap(nums, i, fixed);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permute(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        helper(nums,<span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Permutations-II">2.2. Permutations II</h2><p> follow up â€“ å¦‚æœè¾“å…¥æ•°ç»„æœ‰é‡å¤å…ƒç´ ï¼Œè¾“å‡ºå…¨æ’åˆ—</p>
<p><strong>æš´åŠ›æ±‚è§£</strong></p>
<p>ç”±äºè¿™é“é¢˜æœ‰é‡å¤å…ƒç´ ï¼Œå› æ­¤éœ€è¦æ³¨æ„é‡å¤å…ƒç´ ã€‚</p>
<p>æœ€æš´åŠ›çš„æ–¹å¼å°±æ˜¯å…ˆæ’åºï¼Œç„¶åå½“è¿™ä¸ªå…ƒç´ ä¸ä¸Šä¸€æ¬¡å¾ªç¯çš„å…ƒç´ ä¸€æ ·æ—¶ï¼Œè·³è¿‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">boolean</span>[] used;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums,List&lt;Integer&gt; one, <span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(i == nums.length)&#123;</div><div class="line">            List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;(nums.length);</div><div class="line">            res.addAll(one);</div><div class="line">            result.add(res);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> last = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; nums.length; ++j)&#123;</div><div class="line">            <span class="keyword">if</span>(used[j] || (j &gt; <span class="number">0</span> &amp;&amp; nums[j] == last)) <span class="keyword">continue</span>; <span class="comment">// æ³¨æ„è¿™é‡Œä¸å¯ä»¥ç”¨nums[j] == nums[j - 1] ï¼ï¼ï¼</span></div><div class="line">            one.add(nums[j]);</div><div class="line">            used[j] = <span class="keyword">true</span>;</div><div class="line">            helper(nums,one,i + <span class="number">1</span>);</div><div class="line">            used[j] = <span class="keyword">false</span>;</div><div class="line">            one.remove(one.size() - <span class="number">1</span>);</div><div class="line">            last = nums[j];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permuteUnique(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        used = <span class="keyword">new</span> <span class="keyword">boolean</span>[nums.length];</div><div class="line">        Arrays.sort(nums);</div><div class="line">        helper(nums,<span class="keyword">new</span> ArrayList&lt;Integer&gt;(nums.length), <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>å›ºå®š-äº¤æ¢æ³•</strong></p>
<p>å½“ç„¶ï¼Œè¿™é“é¢˜ä¹Ÿå¯ä»¥å€Ÿç”¨ä¸Šä¸€é¢˜â€œäº¤æ¢â€çš„æƒ³æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums,<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> temp = nums[i];</div><div class="line">        nums[i] = nums[j];</div><div class="line">        nums[j] = temp;</div><div class="line">    &#125;</div><div class="line">    List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(i == nums.length)&#123;</div><div class="line">            List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;(nums.length);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> e : nums)&#123;res.add(e);&#125;</div><div class="line">            result.add(res);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i ; j &lt; nums.length; ++j)&#123;</div><div class="line">            <span class="comment">// ä¸€æ—¦i~jä¹‹é—´æœ‰ä¸€ä¸ªå…ƒç´ nums[k]ä¸nums[j]ç›¸åŒï¼Œé‚£å°±ä¸ç”¨å†äº¤æ¢äº†ï¼ˆå› ä¸ºnums[k] == nums[j],æ²¡æœ‰å¿…è¦å†æ¬¡äº¤æ¢äº†</span></div><div class="line">            <span class="keyword">boolean</span> stop = <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j - <span class="number">1</span>; k &gt;= i; --k)&#123;</div><div class="line">                <span class="keyword">if</span>(nums[k] == nums[j])&#123;</div><div class="line">                    stop = <span class="keyword">true</span>;<span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(stop)<span class="keyword">continue</span>;</div><div class="line">            <span class="comment">// å°†nums[i] ä¾æ¬¡ä¸nums[j]äº¤æ¢ï¼Œç„¶åå›ºå®šnums[i]</span></div><div class="line">            swap(nums, i, j);</div><div class="line">            helper(nums, i + <span class="number">1</span>);</div><div class="line">            swap(nums, i, j);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permuteUnique(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        helper(nums, <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="follow-up-å­—å…¸é¡ºåºè¾“å‡ºå…¨æ’åˆ—">2.3. follow up - å­—å…¸é¡ºåºè¾“å‡ºå…¨æ’åˆ—</h2><p>å¦‚æœæˆ‘ä»¬è¦æ±‚æŒ‰ç…§å­—å…¸é¡ºåºè¾“å‡ºå…¨æ’åˆ—å‘¢ï¼Ÿ</p>
<p><strong>å›ºå®š-äº¤æ¢æ³•</strong></p>
<p>å‡å¦‚æŒ‰ç…§ä¸Šé¢å›ºå®šäº¤æ¢æ³•å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å…ˆçœ‹çœ‹å›ºå®š-äº¤æ¢æ³•çš„æ‰§è¡Œç»“æœï¼š</p>
<p>è¾“å…¥123ï¼Œè¾“å‡ºä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="number">0</span>	[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="number">1</span>	[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>]</div><div class="line"><span class="number">2</span>	[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</div><div class="line"><span class="number">3</span>	[<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>]</div><div class="line"><span class="number">4</span>	[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]  -- x</div><div class="line"><span class="number">5</span>	[<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>]  -- x</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‘ç°æœ€åä¸¤ä¸ªè¾“å‡ºçš„é¡ºåºä¸æ˜¯å­—å…¸é¡ºåºã€‚è¿™æ˜¯å› ä¸ºåœ¨ä¹‹å‰çš„äº¤æ¢ä¸­ï¼Œå½“æˆ‘ä»¬æŠŠ3å›ºå®šåœ¨é¦–ä½æ—¶ï¼Œæ­¤åˆ»3ä¹‹åçš„æ•°å­—ä¸æ˜¯é¡ºåºäº†ã€‚æ‰€ä»¥ç”Ÿæˆæœ‰è¯¯ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åšå‡ºä¸€ç‚¹æ”¹åŠ¨ï¼Œå³åœ¨äº¤æ¢æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§shiftæ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div><div class="line">   â†“ shift</div><div class="line"><span class="number">4</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div></pre></td></tr></table></figure>
<p>å³ä¿æŒåŸæ•°ç»„ä¸å˜ï¼ŒåªæŠŠåé¢çš„æåˆ°å‰é¢æ¥</p>
<p>å½“ç„¶åœ¨é€’å½’ç»“æŸï¼Œè¿˜è¦è¿™æ ·shift_backå›å»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums,<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> temp = nums[i];</div><div class="line">        nums[i] = nums[j];</div><div class="line">        nums[j] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shift</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="comment">// å°†nums[j]æŒªåˆ°nums[i] , ç„¶åå°†å…¶ä½™çš„åç§»</span></div><div class="line">        <span class="keyword">int</span> temp = nums[j];</div><div class="line">        <span class="keyword">while</span> (j &gt; i)&#123;</div><div class="line">            nums[j] = nums[j-<span class="number">1</span>];</div><div class="line">            --j;</div><div class="line">        &#125;</div><div class="line">        nums[i] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shiftBack</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="comment">// å°†nums[i]æŒªåˆ°nums[j] , ç„¶åå°†å…¶ä½™çš„å·¦ç§»</span></div><div class="line">        <span class="keyword">int</span> temp = nums[i];</div><div class="line">        <span class="keyword">while</span> (i &lt; j)&#123;</div><div class="line">            nums[i] = nums[i + <span class="number">1</span>];</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        nums[j] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">    String result;</div><div class="line">    <span class="keyword">int</span> k;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(counter &gt; k)&#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(i == nums.length)&#123;</div><div class="line">            ++counter;</div><div class="line">            <span class="comment">//System.out.println(counter + "\t" + Arrays.toString(nums));</span></div><div class="line">            StringBuilder strBu = <span class="keyword">new</span> StringBuilder();</div><div class="line">            <span class="keyword">if</span>(counter == k)&#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> e : nums)strBu.append(e);</div><div class="line">                result = strBu.toString();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; nums.length; ++j)&#123;</div><div class="line">            shift(nums, i, j);</div><div class="line">            helper(nums, i + <span class="number">1</span>);</div><div class="line">            shiftBack(nums, i ,j);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPermutation</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[] nums = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">            nums[i] = i + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.k = k;</div><div class="line">        helper(nums,<span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ç„¶åå°±ä¸‡äº‹å¤§å‰äº†ï¼</p>
<p>ç„¶è€Œï¼Œè¿™ç§æ–¹å¼éå¸¸çš„æ…¢ã€‚</p>
<p>æˆ‘ä»¬è¿˜æœ‰ä¸€ç§ä¼˜åŒ–ï¼Œæ¥ç€çœ‹ä¸‹ä¸€é¢˜ã€‚</p>
<h2 id="Next-Permutation">2.4. Next Permutation</h2><p>è¾“å‡ºæŒ‡å®šæ•°ç»„çš„ä¸‹ä¸€ä¸ªæ’åˆ—</p>
<p>éªšæ“ä½œï¼Œ<strong>å­—å…¸æ³•</strong></p>
<p>è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼Œå¯¹äºæ¯ä¸€ç§å¯èƒ½æ’åˆ—çš„æƒ…å†µï¼Œæˆ‘ä»¬éƒ½æƒ³åŠæ³•ä½¿å…¶ä¸æŸç§é¡ºåºå»ºç«‹å¯¹åº”å…³ç³»ï¼Œè¿™ç§å…³ç³»å¼ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½é€šè¿‡éå†å¾—åˆ°çš„æŸç§é¡ºåºæ¥ç”Ÿæˆå…¨æ’åˆ—ï¼Œè¿™æ ·å°±èƒ½é¿å…é€’å½’è¿‡ç¨‹äº†ã€‚è¿™ç§æŒ‰ç…§æŸç§é¡ºåºæ¥ç”Ÿæˆå…¨æ’åˆ—çš„æ–¹æ³•å°±è¢«ç§°ä¸ºæ˜¯å­—å…¸åºã€‚</p>
<p>å¾ˆæ˜¾ç„¶ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚ä½•æ‰èƒ½æ‰¾åˆ°è¿™æ ·ä¸€ç§ä¸€ä¸€å¯¹åº”çš„é¡ºåºå…³ç³»ï¼Œæ­¤å¤„ç»§ç»­ç”¨$a={0,1,2,3}$æ¥è¯´æ˜å­—å…¸åºç®—æ³•çš„è¿‡ç¨‹ã€‚</p>
<p>è¦æ‰¾åˆ°ä¸€ç§é¡ºåºå…³ç³»ï¼Œæˆ‘ä»¬å°±é¦–å…ˆè¦å®šä¹‰å¤§å°å…³ç³»ï¼Œå¯¹äºä¸¤ä¸ªåºåˆ—${0,2,1,3}$å’Œ${0,2,3,1}$æ¥è¯´ï¼Œåºåˆ—${0,2,3,1}$è¦æ¯”${0,2,1,3}$å¤§ï¼Œæ¯”è¾ƒçš„æ–¹æ³•æ˜¯ä»å‰åˆ°åä¾æ¬¡æ¯”è¾ƒç›¸åŒä½ç½®ä¸Šçš„å…ƒç´ ï¼Œå¦‚æœç›¸åŒåˆ™ç»§ç»­æ¯”è¾ƒä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªä¸åŒçš„å…ƒç´ ï¼Œå…ƒç´ å€¼å¤§çš„åºåˆ—å°±å¤§äºå…ƒç´ å€¼å°çš„åºåˆ—ã€‚æŒ‰ç…§è¿™æ ·çš„å¤§å°å…³ç³»å½¢æˆçš„åºåˆ—çš„é¡ºåºï¼Œå°±æ˜¯å­—å…¸åºã€‚å¯ä»¥çœ‹åˆ°ï¼Œæœ€å°çš„åºåˆ—ä¸€å®šæ˜¯${0,1,2,3}$ï¼Œæœ€å¤§çš„åºåˆ—æ˜¯${3,2,1,0}$ã€‚è€Œå­—å…¸åºç®—æ³•å°±æ˜¯ä»å­—å…¸åºä¸­æœ€å°çš„åºåˆ—å¼€å§‹ï¼Œä¸€ç›´ä¸åœå¯»æ‰¾ä¸‹ä¸€ä¸ªä»…æ¯”ä¸Šä¸€ä¸ªåºåˆ—å¤§çš„åºåˆ—ï¼Œç›´åˆ°åˆ°è¾¾æœ€å¤§çš„åºåˆ—ã€‚<a href="http://zhouyichu.com/algorithm/Permutation-Generation-1/#fn2" target="_blank" rel="external">[2]</a></p>
<p>ç°åœ¨é—®é¢˜å˜æˆäº†ï¼Œå¦‚ä½•ä»å½“å‰çŠ¶æ€ç”Ÿæˆä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Ÿ</p>
<p>å‡è®¾å½“å‰æ’åˆ—æ˜¯$a[1â€¦..n]$</p>
<ol>
<li>ä»$a$ä¸­æ‰¾åˆ°æ»¡è¶³$a[k] &lt; a[k + 1]$ï¼ˆå‡åºï¼‰çš„æœ€åä¸€ä¸ªkã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™$a$å·²ç»æ˜¯å­—å…¸åºæœ€å¤§åºåˆ—äº†ã€‚</li>
<li>åœ¨$a[k + 1,â€¦.,n]$ ä¸­å¯»æ‰¾æ¯”$a[k]$ å¤§çš„æœ€å°å€¼$a[j]$ã€‚ï¼ˆåœ¨$a[k+1,â€¦,n]$ ä¸­ï¼Œ$a[k]$ ä»…æ¬¡äº$a[j]$ çš„æ•°å­—ã€‚å°†å®ƒä»¬äº¤æ¢åï¼Œèƒ½ä¿è¯æ•´ä¸ªåºåˆ—æ˜¯æœ€å°å¢é•¿çš„ï¼‰</li>
<li>äº¤æ¢$a[k]ä¸a[j]$ ï¼Œå¹¶å°†$a[k,â€¦,n]$ å…¨éƒ¨æ’åº</li>
</ol>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums,<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> temp = nums[i];</div><div class="line">        nums[i] = nums[j];</div><div class="line">        nums[j] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">nextPermutation</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        <span class="comment">// å¯»æ‰¾numsçš„ä¸‹ä¸€ä¸ªæ’åˆ—</span></div><div class="line">        <span class="comment">// å¯»æ‰¾æœ€åä¸€ä¸ªå‡åºnums[q]</span></div><div class="line">        <span class="keyword">int</span> q = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i - <span class="number">1</span>] &lt; nums[i])&#123;</div><div class="line">                q = i - <span class="number">1</span> ;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(q == -<span class="number">1</span>)&#123; <span class="comment">// æ­¤åˆ»numsæ˜¯æœ€åä¸€ä¸ªæ’åˆ—</span></div><div class="line">            <span class="keyword">int</span> start = <span class="number">0</span>, end = n-<span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (start + <span class="number">1</span> &lt; end)&#123;</div><div class="line">                swap(nums,start,end);</div><div class="line">                ++start; --end;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(start + <span class="number">1</span> == end)&#123;swap(nums,start,end);&#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// å¯»æ‰¾æ¯”nums[q]å¤§çš„æœ€å°å€¼nums[m]</span></div><div class="line">            <span class="keyword">int</span> m = q, min = Integer.MAX_VALUE;</div><div class="line">            <span class="keyword">int</span> i = q;</div><div class="line">            <span class="keyword">while</span> (i &lt; n) &#123;</div><div class="line">                <span class="keyword">if</span> (nums[i] &gt; nums[q] &amp;&amp; nums[i] &lt; min) &#123;</div><div class="line">                    min = nums[i];</div><div class="line">                    m = i;</div><div class="line">                &#125;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// å°†nums[q]ä¸nums[m]äº¤æ¢</span></div><div class="line">            swap(nums, q, m);</div><div class="line">            <span class="comment">// å°†[q + 1 ~ n]å€’æ’</span></div><div class="line">            Arrays.sort(nums, q + <span class="number">1</span>, n);</div><div class="line">            <span class="comment">// è¾“å‡ºnums</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶æœ‰ä¸€ç§ä¼˜åŒ–æ€è·¯æ˜¯ï¼Œä¼˜åŒ–ç¬¬1æ­¥ä¸­ï¼šå°†â€ä»å‰åˆ°åå¯»æ‰¾æœ€åä¸€ä¸ªå‡åºâ€œè½¬åŒ–ä¸ºâ€ä»ååˆ°å‰å¯»æ‰¾ç¬¬ä¸€ä¸ªé™åºâ€œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">nextPermutation</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        <span class="comment">// å¯»æ‰¾numsçš„ä¸‹ä¸€ä¸ªæ’åˆ—</span></div><div class="line">        <span class="comment">// å¯»æ‰¾æœ€åä¸€ä¸ªå‡åºnums[q]</span></div><div class="line">        <span class="keyword">int</span> q = nums.length;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">0</span>; --i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i - <span class="number">1</span>] &lt; nums[i])&#123;</div><div class="line">                q = i - <span class="number">1</span> ;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(q == nums.length)&#123; <span class="comment">// æ­¤åˆ»numsæ˜¯æœ€åä¸€ä¸ªæ’åˆ—</span></div><div class="line">            <span class="keyword">int</span> start = <span class="number">0</span>, end = n-<span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (start + <span class="number">1</span> &lt; end)&#123;</div><div class="line">                swap(nums,start,end);</div><div class="line">                ++start; --end;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(start + <span class="number">1</span> == end)&#123;swap(nums,start,end);&#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// å¯»æ‰¾æ¯”nums[q]å¤§çš„æœ€å°å€¼nums[m]</span></div><div class="line">            <span class="keyword">int</span> m = q, min = Integer.MAX_VALUE;</div><div class="line">            <span class="keyword">int</span> i = q;</div><div class="line">            <span class="keyword">while</span> (i &lt; n) &#123;</div><div class="line">                <span class="keyword">if</span> (nums[i] &gt; nums[q] &amp;&amp; nums[i] &lt; min) &#123;</div><div class="line">                    min = nums[i];</div><div class="line">                    m = i;</div><div class="line">                &#125;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// å°†nums[q]ä¸nums[m]äº¤æ¢</span></div><div class="line">            swap(nums, q, m);</div><div class="line">            <span class="comment">// å°†[q + 1 ~ n]å€’æ’</span></div><div class="line">            Arrays.sort(nums, q + <span class="number">1</span>, n);</div><div class="line">            <span class="comment">// è¾“å‡ºnums</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Permutation-Sequence">2.5. Permutation Sequence</h2><p>è¾“å‡º1-næ•°å­—ç»„æˆçš„æ•°å­—ä¸­çš„å­—å…¸åºç¬¬kä¸ªæ’åˆ—</p>
<p>æ€è·¯ä¸€ï¼šå¦‚æœç”¨follow up çš„ä»£ç ï¼Œæ˜¯å®Œå…¨å¯ä»¥çš„ã€‚åªæ˜¯æ—¶é—´éå¸¸é«˜ã€‚</p>
<p>æ€è·¯äºŒï¼šå­—å…¸æ³•ï¼Œä¾æ¬¡è¾“å‡ºï¼Œæ—¶é—´ä»£ä»·è¿˜æ˜¯å¾ˆæ˜‚è´µï¼Œè¿˜æœ‰å¯èƒ½è¶…æ—¶</p>
<p>æ€è·¯ä¸‰ï¼šéªšæ“ä½œ</p>
<p>nä¸ªæ•°çš„å…¨æ’åˆ—ä¸€å…±æœ‰$n!$ ä¸ªã€‚åŸºäºè¿™ä¸ªæ€§è´¨æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæŸä¸€ä½å¯¹åº”çš„æ•°å­—æ˜¯å‡ ï¼éªšæ“ä½œå•Šï¼</p>
<p>æˆ‘ä»¬ç”¨123æ¥ä¸¾ä¾‹ã€‚å®ƒçš„å…¨æ’åˆ—ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">            ç¬¬ä¸€ä½           ç¬¬äºŒä½</div><div class="line"><span class="number">0</span>  <span class="number">123</span>     <span class="number">1</span> = nums[<span class="number">0</span>/<span class="number">2</span>]      <span class="number">2</span></div><div class="line"><span class="number">1</span>  <span class="number">132</span>     <span class="number">1</span> = nums[<span class="number">1</span>/<span class="number">2</span>]      <span class="number">3</span></div><div class="line"><span class="number">2</span>  <span class="number">213</span>     <span class="number">2</span> = nums[<span class="number">2</span>/<span class="number">2</span>]      <span class="number">1</span></div><div class="line"><span class="number">3</span>  <span class="number">231</span>     <span class="number">2</span> = nums[<span class="number">3</span>/<span class="number">2</span>]      <span class="number">3</span></div><div class="line"><span class="number">4</span>  <span class="number">312</span>     <span class="number">3</span> = nums[<span class="number">4</span>/<span class="number">2</span>]      <span class="number">1</span>    </div><div class="line"><span class="number">5</span>  <span class="number">321</span>     <span class="number">3</span> = nums[<span class="number">5</span>/<span class="number">2</span>]      <span class="number">2</span>    &lt;-- k = <span class="number">5</span></div></pre></td></tr></table></figure>
<p>å› ä¸ºå½“ç¬¬ä¸€ä½ç¡®å®šæ—¶ï¼Œå…¨æ’åˆ—ä¸ªæ•°ä¸º$(n-1)! = 2$ ä¸ªã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€ä½çš„é‡å¤å‘¨æœŸæ˜¯$(n-1)!$ ã€‚é‚£ä¹ˆç¬¬kä¸ªå°±æ˜¯$\frac{k}{(n-1)!}$ ã€‚</p>
<p>å‡å¦‚ç¬¬ä¸€ä½æ˜¯a1 = 3ï¼Œé‚£ä¹ˆç¬¬ä¸€ä½æ˜¯1å’Œ2çš„å…¨æ’åˆ—éƒ½å¯ä»¥å»é™¤äº†ï¼é‚£å°±æ˜¯ä»3å¼€å¤´çš„å…¨æ’åˆ—ä¸­å¯»æ‰¾ç¬¬$kâ€™ = k - (a1-1) * (n-1)! = k \text{ % } (n-1)! = 5 -  4 = 1$ ä¸ªï¼</p>
<p>è€Œä¸”ï¼Œå½“ç¬¬ä¸€ä½ç¡®å®šæ—¶ï¼Œç¬¬äºŒä½åªå‰©ä¸‹$n - 1$ ä¸ªæ•°å­—å¯ä»¥é€‰æ‹©ã€‚å› æ­¤ä»¥3å¼€å¤´çš„åªæœ‰$(n-2)!$ ç§ã€‚æ‰€ä»¥ç¬¬äºŒä½çš„æ•°å­—ä¸º$\frac{k`}{(n-2)!}$</p>
<p>ç„¶åæˆ‘ä»¬å°±æ‰¾åˆ°äº†è§„å¾‹ï¼</p>
<p>a1 = k / (n - 1)!<br>k1 = k</p>
<p>a2 = k1 / (n - 2)!<br>k2 = k1 % (n - 2)!<br>â€¦</p>
<p>an-1 = kn-2 / 1!<br>kn-1 = kn-2 / 1!</p>
<p>an = kn-1 / 0!<br>kn = kn-1 % 0!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPermutation</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        ArrayList&lt;Integer&gt; candidates = <span class="keyword">new</span> ArrayList&lt;&gt;(n);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)&#123;</div><div class="line">            candidates.add(i);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å…ˆå­˜ä¸‹æ¥n!</span></div><div class="line">        <span class="keyword">int</span>[] factorial = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</div><div class="line">        factorial[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        factorial[<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">// factorial[i] = i!</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)&#123;</div><div class="line">            factorial[i] = factorial[i-<span class="number">1</span>] * i;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// è®¡ç®—ç¬¬kä½</span></div><div class="line">        k = k - <span class="number">1</span>;</div><div class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">            <span class="keyword">int</span> idx = k / factorial[n-<span class="number">1</span>-i] ;</div><div class="line">            stringBuilder.append(candidates.get(idx));</div><div class="line">            candidates.remove(idx); <span class="comment">// æ³¨æ„ç»´æŠ¤å‰©ä½™é›†åˆ</span></div><div class="line">            k = k % factorial[n-<span class="number">1</span>-i];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> stringBuilder.toString();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Binary-Watch">2.6. Binary Watch</h2><p>æœ‰ä¸€ç§äºŒè¿›åˆ¶çš„è¡¨ã€‚å…¶ä¸­ç”¨4ä¸ªä½æ•°è¡¨ç¤ºå°æ—¶ï¼ˆ0-11ï¼‰ï¼Œç”¨6ä¸ªä½æ•°è¡¨ç¤ºåˆ†é’Ÿï¼ˆ0-59ï¼‰ã€‚</p>
<p>ç»™ä¸€ä¸ªnï¼Œè¡¨ç¤ºå½“å‰äº®ç¯çš„ä¸ªæ•°ã€‚æ±‚å¯èƒ½å‡ºç°çš„æ—¶åˆ»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">permutations</span><span class="params">(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> idx, <span class="keyword">int</span> num, <span class="keyword">int</span> sum, List&lt;Integer&gt; result, <span class="keyword">int</span> limit)</span></span>&#123;</div><div class="line">    <span class="comment">//ä»å€™é€‰é›†é‡Œé€‰numä¸ªï¼Œæ±‚ç›¸åŠ æœ‰å¤šå°‘ç§ç»“æœ</span></div><div class="line">    <span class="keyword">if</span>(sum &gt;= limit)<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(num == <span class="number">0</span>)&#123;result.add(sum);<span class="keyword">return</span>;&#125;</div><div class="line">    <span class="keyword">if</span>(idx &gt;= candidates.length || candidates.length - idx &lt; num)<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = idx; i &lt; candidates.length; ++i)&#123;</div><div class="line">        permutations(candidates, i + <span class="number">1</span>, num - <span class="number">1</span>, sum + candidates[i], result, limit);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> List&lt;String&gt; <span class="title">helper</span><span class="params">(<span class="keyword">int</span> h_num, <span class="keyword">int</span> m_num, <span class="keyword">int</span>[] h, <span class="keyword">int</span>[] m)</span></span>&#123;</div><div class="line">    <span class="comment">// h_numä¸ªå°æ—¶ç¯ï¼Œm_numä¸ªåˆ†é’Ÿç¯</span></div><div class="line">    List&lt;Integer&gt; hours = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    permutations(h, <span class="number">0</span>, h_num, <span class="number">0</span>, hours, <span class="number">12</span>);</div><div class="line">    List&lt;Integer&gt; minites = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    permutations(m, <span class="number">0</span>, m_num, <span class="number">0</span>, minites, <span class="number">60</span>);</div><div class="line">    <span class="comment">//ä¸¤ä¸¤ç»„åˆ</span></div><div class="line">    List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(Integer hour : hours)&#123;</div><div class="line">        String hour_str = Integer.toString(hour);</div><div class="line">        <span class="keyword">for</span>(Integer minite : minites)&#123;</div><div class="line">            String min_str = minite &lt; <span class="number">10</span> ? <span class="string">"0"</span>+Integer.toString(minite) : Integer.toString(minite);</div><div class="line">            result.add(hour_str + <span class="string">":"</span> + min_str);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">readBinaryWatch</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[] h = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">8</span>&#125;;</div><div class="line">    <span class="keyword">int</span>[] m = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">32</span>&#125;;</div><div class="line">    List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> h_num = <span class="number">0</span>; h_num &lt; <span class="number">4</span>; ++h_num)&#123;</div><div class="line">        <span class="keyword">int</span> m_num = num - h_num;</div><div class="line">        <span class="keyword">if</span>(m_num &gt; <span class="number">6</span>)<span class="keyword">continue</span>;</div><div class="line">        result.addAll(helper(h_num, m_num, h, m));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å…ƒç´ å’Œã€ç»„åˆé—®é¢˜">3. å…ƒç´ å’Œã€ç»„åˆé—®é¢˜</h1><h2 id="Combinations">3.1. Combinations</h2><p>ç”¨1-nçš„æ•°å­—ï¼Œæ¯æ¬¡æ‹¿kä¸ªã€‚è¾“å‡ºæ‰€æœ‰çš„ç»„åˆæ–¹å¼ã€‚</p>
<p>ç›¸å½“ç»å…¸çš„å›æº¯é—®é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> start, List&lt;Integer&gt; candidates)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">0</span>)&#123;</div><div class="line">            result.add(<span class="keyword">new</span> ArrayList&lt;&gt;(candidates));</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = start; i &lt;= n; ++i)&#123;</div><div class="line">            candidates.add(i);</div><div class="line">            helper(n, k - <span class="number">1</span>, i + <span class="number">1</span>, candidates);</div><div class="line">            candidates.remove(candidates.size() - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combine(<span class="keyword">int</span> n, <span class="keyword">int</span> k) &#123;</div><div class="line">        helper(n, k, <span class="number">1</span>, <span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åœ¨leetcodeä¸Šçœ‹åˆ°è¿˜æœ‰ä¸€ç§æ€è·¯ï¼Œå¾ˆå¿«ã€‚ä½†æ€»ä½“å¤æ‚åº¦å…¶å®å·®ä¸å¤šã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combine(<span class="keyword">int</span> n, <span class="keyword">int</span> k) &#123;</div><div class="line">    List&lt;Integer&gt; current = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    dfs(result, current, <span class="number">1</span>, n, k);</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; result, List&lt;Integer&gt; current, <span class="keyword">int</span> c, <span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (c + k &gt; n + <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;</div><div class="line">        List&lt;Integer&gt; tmpList = <span class="keyword">new</span> ArrayList&lt;&gt;(current);</div><div class="line">        result.add(tmpList);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">   <span class="comment">// ä½¿ç”¨cè¿™ä¸ªæ•°å­—</span></div><div class="line">    current.add(c);</div><div class="line">    dfs(result, current, c + <span class="number">1</span>, n, k - <span class="number">1</span>);</div><div class="line">    current.remove(current.size() - <span class="number">1</span>);</div><div class="line">    <span class="comment">// ä¸ä½¿ç”¨cè¿™ä¸ªæ•°å­—</span></div><div class="line">    dfs(result, current, c + <span class="number">1</span>, n, k);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Combination-Sum">3.2. Combination Sum</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtarget.æ±‚æ•°ç»„ä¸­çš„å…ƒç´ å’Œç­‰äºtargetçš„æ‰€æœ‰å¯èƒ½ã€‚å…ƒç´ å¯ä»¥å¤šæ¬¡å–ã€‚</p>
<p>æ€è·¯ï¼šå…¸å‹çš„å›æº¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target, <span class="keyword">int</span> start, ArrayList&lt;Integer&gt; added)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(target &lt; <span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(target == <span class="number">0</span>)&#123;</div><div class="line">            List&lt;Integer&gt; aRes = <span class="keyword">new</span> ArrayList&lt;&gt;(added.size());</div><div class="line">            aRes.addAll(added);</div><div class="line">            result.add(aRes);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">       <span class="comment">// ä»startå¼€å§‹å–ï¼ˆstartå°±æ˜¯ä¸Šä¸€æ¬¡ä½¿ç”¨çš„å…ƒç´ ï¼‰</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = start; i &lt; candidates.length; ++i)&#123;</div><div class="line">            added.add(candidates[i]);</div><div class="line">            helper(candidates, target - candidates[i], i,added);</div><div class="line">            added.remove(added.size() - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target) &#123;</div><div class="line">        Arrays.sort(candidates);</div><div class="line">        helper(candidates,target, <span class="number">0</span>,<span class="keyword">new</span> ArrayList&lt;&gt;(candidates.length));</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è™½ç„¶è¯´è¿™é“é¢˜å¯ä»¥ç”¨dpæ¥ç®€åŒ–ã€‚ä½†æ˜¯ç”±äºé‡å¤çš„è¾¹ç•Œæ¡ä»¶å®åœ¨æ˜¯éš¾ä»¥å¤„ç†ï¼Œæ‰€ä»¥è¿˜æ˜¯å¼ƒç”¨äº†ã€‚</p>
<h2 id="Combination-Sum-II">3.3. Combination Sum II</h2><p>ç»™ä¸€ä¸ªæœ‰é‡æ•°ç»„å’Œä¸€ä¸ªtarget.æ±‚æ•°ç»„ä¸­çš„å…ƒç´ å’Œç­‰äºtargetçš„æ‰€æœ‰å¯èƒ½ã€‚å…ƒç´ ä¸å¯ä»¥å¤šæ¬¡å–ã€‚</p>
<p>è¿™é“é¢˜ä¸ä¸Šä¸€é¢˜çš„æœ€å¤§åŒºåˆ«å°±æ˜¯ä¸èƒ½å¤šæ¬¡å–ï¼éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯é€’å½’è¿›å…¥æ—¶çš„iéœ€è¦åŠ ä¸€ï¼ˆè·³è¿‡æœ¬å…ƒç´ ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target, <span class="keyword">int</span> start, List&lt;Integer&gt; selected)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(target &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(target == <span class="number">0</span>)&#123;</div><div class="line">            List&lt;Integer&gt; one = <span class="keyword">new</span> ArrayList&lt;&gt;(selected);</div><div class="line">            result.add(one);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = start; i &lt; candidates.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(i &gt; start  &amp;&amp; candidates[i] == candidates[i - <span class="number">1</span>])<span class="keyword">continue</span>; <span class="comment">// å»é‡</span></div><div class="line">            <span class="keyword">if</span>(target - candidates[i] &lt; <span class="number">0</span>)<span class="keyword">break</span>;<span class="comment">// å‰ªæ</span></div><div class="line">            <span class="comment">// å›æº¯</span></div><div class="line">            selected.add(candidates[i]);</div><div class="line">            helper(candidates, target - candidates[i], i + <span class="number">1</span>,selected); <span class="comment">// ä»i + 1å¤„ç»§ç»­</span></div><div class="line">            selected.remove(selected.size() - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target) &#123;</div><div class="line">        Arrays.sort(candidates);</div><div class="line">        helper(candidates,target, <span class="number">0</span>, <span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Combination-Sum-III">3.4. Combination Sum III</h2><p>æ±‚kä¸ªæ•°ï¼ˆ0-9çš„æ•°ï¼‰çš„å’Œä¸ºnçš„æ‰€æœ‰ç»„åˆã€‚</p>
<p>è¿˜æ˜¯å›æº¯é—®é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> start, <span class="keyword">int</span> target, List&lt;Integer&gt; candidates)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(target &lt; <span class="number">0</span> || k &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(target == <span class="number">0</span> &amp;&amp; k == <span class="number">0</span>)&#123;</div><div class="line">            result.add(<span class="keyword">new</span> ArrayList&lt;&gt;(candidates));</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = start; i &lt;= <span class="number">9</span>; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(target - i &lt; <span class="number">0</span>) <span class="keyword">break</span>; <span class="comment">// å‰ªæ</span></div><div class="line">            candidates.add(i);</div><div class="line">            helper(k - <span class="number">1</span>,i + <span class="number">1</span>, target - i, candidates);</div><div class="line">            candidates.remove(candidates.size() - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum3(<span class="keyword">int</span> k, <span class="keyword">int</span> n) &#123;</div><div class="line">        helper(k,<span class="number">1</span>, n, <span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶è¿˜å¯ä»¥ç”¨å¦ä¸€ç§æ€è·¯ï¼Œå°±æ˜¯é€‰æˆ–è€…ä¸é€‰çš„é—®é¢˜ã€‚è¿™ç§æ€è·¯ç±»ä¼¼Combinationsçš„ç¬¬äºŒç§è§£æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> i, <span class="keyword">int</span> target, List&lt;Integer&gt; candidates)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(target == <span class="number">0</span> &amp;&amp; k == <span class="number">0</span>)&#123;</div><div class="line">            result.add(<span class="keyword">new</span> ArrayList&lt;&gt;(candidates));</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">0</span> &amp;&amp; target != <span class="number">0</span>)&#123;<span class="keyword">return</span>;&#125;</div><div class="line">        <span class="keyword">if</span>(i &gt; <span class="number">9</span> || target &lt; <span class="number">0</span> || k &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="comment">// é€‰i</span></div><div class="line">        candidates.add(i);</div><div class="line">        helper(k - <span class="number">1</span>,i + <span class="number">1</span>, target - i, candidates);</div><div class="line">        candidates.remove(candidates.size() - <span class="number">1</span>);</div><div class="line">        <span class="comment">// ä¸é€‰i</span></div><div class="line">        helper(k,i + <span class="number">1</span>, target, candidates);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum3(<span class="keyword">int</span> k, <span class="keyword">int</span> n) &#123;</div><div class="line">        helper(k,<span class="number">1</span>, n, <span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Increasing-Subsequences">3.5. Increasing Subsequences</h2><p>ç»™ä¸€ä¸ªæœ‰é‡æ•°ç»„ï¼Œè¾“å‡ºæ‰€æœ‰çš„é€’å¢å­åºåˆ—</p>
<p>æ€è·¯ï¼šå›æº¯æ³•</p>
<p>æ³¨æ„ç‚¹ï¼šç”±äºæ•°ç»„æœ‰é‡ï¼Œåˆ™ä¸€å®šè¦åˆ¤æ–­é‡å¤ï¼ä¾‹å¦‚æ•°ç»„<code>[1,3,2,3]</code> ï¼Œå¦‚æœä¸åˆ¤æ–­é‡å¤ï¼Œå°±ä¼šå‡ºç°ä¸¤ä¸ª[1,3]ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> idx,List&lt;Integer&gt; added, <span class="keyword">int</span> lastAdd, HashSet&lt;Integer&gt; hash)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(idx &gt;= nums.length)&#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = idx; i &lt; nums.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(hash.contains(nums[i]))<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(nums[i] &gt;= lastAdd) &#123;</div><div class="line">            hash.add(nums[i]);</div><div class="line">            added.add(nums[i]);</div><div class="line">            <span class="keyword">if</span>(added.size() &gt;= <span class="number">2</span>) &#123;</div><div class="line">                result.add(<span class="keyword">new</span> ArrayList&lt;&gt;(added));</div><div class="line">            &#125;</div><div class="line">            helper(nums, i + <span class="number">1</span>, added, nums[i], <span class="keyword">new</span> HashSet&lt;&gt;());</div><div class="line">            added.remove(added.size() - <span class="number">1</span>);</div><div class="line">        &#125;<span class="keyword">else</span></div><div class="line">            helper(nums, i + <span class="number">1</span>, added, lastAdd, hash);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; findSubsequences(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">    helper(nums, <span class="number">0</span>, <span class="keyword">new</span> LinkedList&lt;&gt;(), Integer.MIN_VALUE, <span class="keyword">new</span> HashSet&lt;&gt;());</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å…¶å®ƒé—®é¢˜">4. å…¶å®ƒé—®é¢˜</h1><h2 id="Count-Numbers-with-Unique-Digits">4.1. Count Numbers with Unique Digits</h2><p>ç»™ä¸€ä¸ªnã€‚æ±‚xçš„ä¸ªæ•°ï¼Œå…¶ä¸­$0&lt;= x &lt;= 10^n$ ï¼Œä¸”xçš„æ¯ä¸€ä½çš„æ•°å­—éƒ½ä¸ç›¸åŒã€‚</p>
<p>æ€è·¯ï¼šxæ˜¯nä½æ•°ï¼Œä¸”æ¯ä½éƒ½ä¸ç›¸ç­‰ã€‚</p>
<p>å¦‚æœnå¤§äº10ï¼Œé‚£$x &gt; 10^{10}$ çš„éƒ½ä¸ç”¨è€ƒè™‘äº†</p>
<p>å¦‚æœnå°äºç­‰äº10ï¼Œé‚£å°±è€ƒè™‘0-9èƒ½ç»„æˆå¤šå°‘ä¸ªnä½çš„æ•°å­—äº†ï¼</p>
<p>è¿™é“é¢˜å®Œå…¨å¯ä»¥ç”¨å…¬å¼å®Œæˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">nä½æ•°çš„å¯èƒ½æœ‰å¦‚ä¸‹ï¼š</div><div class="line"></div><div class="line"><span class="number">0</span>      ï¼ˆå°±æ˜¯<span class="number">0</span>ï¼‰</div><div class="line"><span class="number">1</span> ä½æ•° -&gt; C(<span class="number">9</span>,<span class="number">1</span>)  (ä»<span class="number">1</span>-<span class="number">9</span>é‡ŒéšæœºæŒ‘é€‰ä¸€ä¸ª)</div><div class="line"><span class="number">2</span> ä½æ•° -&gt; C(<span class="number">9</span>,<span class="number">1</span>) * C(<span class="number">9</span>,<span class="number">1</span>)  (ç¬¬ä¸€ä½ä»<span class="number">1</span>-<span class="number">9</span>æŒ‘ï¼Œç¬¬äºŒä½ä¸ç¬¬ä¸€ä½ä¸åŒå³å¯ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯<span class="number">9</span>ç§)</div><div class="line"><span class="number">3</span> ä½æ•° -&gt; C(<span class="number">9</span>,<span class="number">1</span>) * C(<span class="number">9</span>,<span class="number">1</span>) * C(<span class="number">8</span>,<span class="number">1</span>) (ç¬¬ä¸€ä½ä»<span class="number">1</span>-<span class="number">9</span>æŒ‘ï¼Œç¬¬äºŒä½ä¸ç¬¬ä¸€ä½ä¸åŒï¼Œç¬¬ä¸‰ä½ä¸å‰ä¸¤ä½ä¸åŒ)</div><div class="line">...</div><div class="line">n ä½æ•°</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line">    <span class="comment">//  * C(9,1) * C(8,1) *....</span></div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">0</span> || n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> k * helper(n - <span class="number">1</span>, k - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countNumbersWithUniqueDigits</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)&#123;</div><div class="line">            sum += <span class="number">9</span> * helper(i - <span class="number">1</span>, <span class="number">9</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Letter-Combinations-of-a-Phone-Number">4.2. Letter Combinations of a Phone Number</h2><p>æ±‚æ‰‹æœºâ€œä¹å®«æ ¼â€è¾“å…¥æ•°å­—åç»„æˆçš„å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Character, String[]&gt; table = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildTable</span><span class="params">()</span></span>&#123;</div><div class="line">        table.put(<span class="string">'1'</span>,<span class="keyword">new</span> String[<span class="number">0</span>]);</div><div class="line">        table.put(<span class="string">'2'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>&#125;);</div><div class="line">        table.put(<span class="string">'3'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"d"</span>,<span class="string">"e"</span>,<span class="string">"f"</span>&#125;);</div><div class="line">        table.put(<span class="string">'4'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"g"</span>,<span class="string">"h"</span>,<span class="string">"i"</span>&#125;);</div><div class="line">        table.put(<span class="string">'5'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"j"</span>,<span class="string">"k"</span>,<span class="string">"l"</span>&#125;);</div><div class="line">        table.put(<span class="string">'6'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"m"</span>,<span class="string">"n"</span>,<span class="string">"o"</span>&#125;);</div><div class="line">        table.put(<span class="string">'7'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"p"</span>,<span class="string">"q"</span>,<span class="string">"r"</span>,<span class="string">"s"</span>&#125;);</div><div class="line">        table.put(<span class="string">'8'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"t"</span>,<span class="string">"u"</span>,<span class="string">"v"</span>&#125;);</div><div class="line">        table.put(<span class="string">'9'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"w"</span>,<span class="string">"x"</span>,<span class="string">"y"</span>,<span class="string">"z"</span>&#125;);</div><div class="line">        table.put(<span class="string">'0'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">" "</span>&#125;);</div><div class="line">        table.put(<span class="string">'#'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"#"</span>&#125;);</div><div class="line">        table.put(<span class="string">'*'</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"*"</span>&#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">letterCombinations</span><span class="params">(String digits)</span> </span>&#123;</div><div class="line">        List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(digits.length() == <span class="number">0</span>) <span class="keyword">return</span> result;</div><div class="line">        buildTable();</div><div class="line">        <span class="keyword">char</span>[] digits_c = digits.toCharArray();</div><div class="line">        <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">        String[] candicates = table.get(digits_c[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">for</span>(String c : candicates)&#123;</div><div class="line">            String aRes = <span class="keyword">new</span> String(c);</div><div class="line">            result.add(aRes);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æ’å…¥</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; digits_c.length; ++i)&#123;</div><div class="line">            candicates = table.get(digits_c[i]);</div><div class="line">            <span class="comment">// ä¾æ¬¡å°†candicatesä¸builderçš„æ¯ä¸ªå…ƒç´ ç»„åˆ</span></div><div class="line">            List&lt;String&gt; result_curr = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">            <span class="keyword">for</span>(String aRes : result)&#123;</div><div class="line">                <span class="keyword">for</span>(String c : candicates)&#123;</div><div class="line">                    String aRes_curr = aRes + c;</div><div class="line">                    result_curr.add(aRes_curr);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            result = result_curr;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Generate-Parentheses">4.3. Generate Parentheses</h2><p>æœ‰nå¯¹æ‹¬å·ã€‚æ±‚æ‰€æœ‰æ‹¬å·å¯èƒ½çš„æ‘†æ”¾æ¬¡åºï¼ˆæ‹¬å·å¿…é¡»æˆå¯¹å…ˆåå‡ºç°ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> remain_left, <span class="keyword">int</span> remain_right, StringBuilder builder)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(remain_left == <span class="number">0</span> &amp;&amp; remain_right == <span class="number">0</span>)&#123;</div><div class="line">            result.add(builder.toString());</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(remain_left == <span class="number">0</span>)&#123;</div><div class="line">            builder.append(<span class="string">')'</span>);</div><div class="line">            helper(remain_left, remain_right - <span class="number">1</span>, builder);</div><div class="line">            builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(remain_left &gt;= remain_right || remain_right == <span class="number">0</span>)&#123;</div><div class="line">            builder.append(<span class="string">'('</span>);</div><div class="line">            helper(remain_left - <span class="number">1</span>, remain_right, builder);</div><div class="line">            builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// è¦ä¹ˆæ”¾ä¸€ä¸ªå·¦æ‹¬å·</span></div><div class="line">        builder.append(<span class="string">'('</span>);</div><div class="line">        helper(remain_left - <span class="number">1</span>, remain_right, builder);</div><div class="line">        builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line">        <span class="comment">// è¦ä¹ˆæ”¾ä¸€ä¸ªå³æ‹¬å·</span></div><div class="line">        builder.append(<span class="string">')'</span>);</div><div class="line">        helper(remain_left, remain_right - <span class="number">1</span>, builder);</div><div class="line">        builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">generateParenthesis</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        helper(n,n,<span class="keyword">new</span> StringBuilder());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä¼˜åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> remain_left, <span class="keyword">int</span> remain_right, StringBuilder builder)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(remain_left == <span class="number">0</span> &amp;&amp; remain_right == <span class="number">0</span>)&#123;</div><div class="line">            result.add(builder.toString());</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(remain_left &gt; <span class="number">0</span>)&#123; <span class="comment">// åªè¦å·¦æ‹¬å·æœ‰å¯Œè£•ï¼Œå°±å¯ä»¥æ”¾</span></div><div class="line">            builder.append(<span class="string">'('</span>);</div><div class="line">            helper(remain_left - <span class="number">1</span>, remain_right, builder);</div><div class="line">            builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(remain_left &lt; remain_right) &#123; <span class="comment">// å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤šæ—¶ï¼Œæ‰å¯ä»¥æ”¾å³æ‹¬å·</span></div><div class="line">            builder.append(<span class="string">')'</span>);</div><div class="line">            helper(remain_left, remain_right - <span class="number">1</span>, builder);</div><div class="line">            builder.delete(builder.length() - <span class="number">1</span>, builder.length());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">generateParenthesis</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        helper(n,n,<span class="keyword">new</span> StringBuilder());</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Valid-Sudoku">4.4. Valid Sudoku</h2><p>åˆ¤æ–­å½“å‰ç»™å‡ºçš„æ•°ç‹¬æ ¼å­æ˜¯å¦ç¬¦åˆæ•°ç‹¬è¦æ±‚ï¼ˆåªè¦åˆ¤æ–­å½“å‰å·²ç»å¡«å…¥çš„ç©ºæ ¼æ˜¯å¦ç¬¦åˆè¦æ±‚å³å¯ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span>[][] eachRow = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">10</span>][<span class="number">10</span>];</div><div class="line"><span class="keyword">boolean</span>[][] eachCol = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">10</span>][<span class="number">10</span>];</div><div class="line"><span class="keyword">boolean</span>[][] eachSquare = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">10</span>][<span class="number">10</span>];</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValidSudoku</span><span class="params">(<span class="keyword">char</span>[][] board)</span> </span>&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length; ++i)&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; ++j)&#123;</div><div class="line">      <span class="keyword">if</span>(board[i][j] == <span class="string">'.'</span>) <span class="keyword">continue</span>;</div><div class="line">      <span class="keyword">if</span>(eachCol[j][board[i][j] - <span class="string">'0'</span>] ||</div><div class="line">         eachRow[i][board[i][j] - <span class="string">'0'</span>] ||</div><div class="line">         eachSquare[i/<span class="number">3</span> + <span class="number">3</span>*(j/<span class="number">3</span>)][board[i][j] - <span class="string">'0'</span>]) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">      eachCol[j][board[i][j] - <span class="string">'0'</span>] = <span class="keyword">true</span>;</div><div class="line">      eachRow[i][board[i][j] - <span class="string">'0'</span>] = <span class="keyword">true</span>;</div><div class="line">      eachSquare[i/<span class="number">3</span> + <span class="number">3</span>*(j/<span class="number">3</span>)][board[i][j] - <span class="string">'0'</span>] = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Sudoku-Solver">4.5. Sudoku Solver</h2><p>$9 \times 9$ çš„æ•°ç‹¬ï¼Œå¡«å…¥æ•°å­—1-9ï¼Œè¦æ±‚è¡Œåˆ—ä¸é‡å¤ï¼Œä¸”æ¯ä¸ªå®«å†…ä¸é‡å¤ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-25-17-59-30.png" alt=""> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span>[][][] used;</div><div class="line">    <span class="comment">/**used[0][i][q] : ç¬¬iåˆ—,æ•°å­—qæ˜¯å¦è¢«ä½¿ç”¨</span></div><div class="line">     * used[1][i][q] : ç¬¬iè¡Œï¼Œæ•°å­—qæ˜¯å¦è¢«ä½¿ç”¨</div><div class="line">     * used[2][i][q] : ç¬¬iä¸ªå®«ä¸­æ•°å­—qæ˜¯å¦è¢«ä½¿ç”¨</div><div class="line">     * **/</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">int</span> filled)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(filled == board.length * board.length)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; board.length; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(board[i][j] != <span class="string">'.'</span>) <span class="keyword">continue</span>;</div><div class="line">                <span class="comment">//å°è¯•ç»™board[i][j]å¡«å…¥æ•°å­—q</span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">1</span>; q &lt;= <span class="number">9</span>; ++q)&#123;</div><div class="line">                    <span class="keyword">if</span>(used[<span class="number">0</span>][i][q] || used[<span class="number">1</span>][j][q] || used[<span class="number">2</span>][j/<span class="number">3</span> + <span class="number">3</span> * (i/<span class="number">3</span>)][q]) <span class="keyword">continue</span>;</div><div class="line">                    board[i][j] = (<span class="keyword">char</span>)(q + <span class="number">48</span>);</div><div class="line">                    used[<span class="number">0</span>][i][q] = <span class="keyword">true</span>;</div><div class="line">                    used[<span class="number">1</span>][j][q] = <span class="keyword">true</span>;</div><div class="line">                    used[<span class="number">2</span>][j/<span class="number">3</span> + <span class="number">3</span> * (i/<span class="number">3</span>)][q] = <span class="keyword">true</span>;</div><div class="line">                    <span class="keyword">if</span>(helper(board, filled + <span class="number">1</span>))<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                    board[i][j] = <span class="string">'.'</span>;</div><div class="line">                    used[<span class="number">0</span>][i][q] = <span class="keyword">false</span>;</div><div class="line">                    used[<span class="number">1</span>][j][q] = <span class="keyword">false</span>;</div><div class="line">                    used[<span class="number">2</span>][j/<span class="number">3</span> + <span class="number">3</span> * (i/<span class="number">3</span>)][q] = <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//è¿™ä¸ªå‰ªæå¾ˆé‡è¦</span></div><div class="line">                <span class="comment">//board[i][j]å¡«ä»»ä½•æ•°å­—éƒ½ä¸è¡Œ</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">solveSudoku</span><span class="params">(<span class="keyword">char</span>[][] board)</span> </span>&#123;</div><div class="line">        used = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">3</span>][board.length][<span class="number">10</span>];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">int</span> filled = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; board.length; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(board[i][j] == <span class="string">'.'</span>)<span class="keyword">continue</span>;</div><div class="line">                used[<span class="number">0</span>][i][board[i][j]-<span class="number">48</span>] = <span class="keyword">true</span>;</div><div class="line">                used[<span class="number">1</span>][j][board[i][j]-<span class="number">48</span>] = <span class="keyword">true</span>;</div><div class="line">                used[<span class="number">2</span>][j/<span class="number">3</span> + <span class="number">3</span> * (i/<span class="number">3</span>)][board[i][j]-<span class="number">48</span>] = <span class="keyword">true</span>;</div><div class="line">                ++filled;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        helper(board,filled);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Beautiful-Arrangement">4.6. Beautiful Arrangement</h2><p>ç»™1-Nçš„æ•°å­—ï¼Œå¡«å…¥é•¿åº¦ä¸ºNçš„æ•°ç»„ã€‚ä»¤æ•°ç»„çš„idxä»1å¼€å§‹ã€‚è¦æ±‚ï¼šidxèƒ½æ•´é™¤nums[idx]æˆ–nums[idx]èƒ½æ•´é™¤idxã€‚æ±‚æ‰€æœ‰çš„å¯èƒ½æ•°ã€‚</p>
<p>æ€è·¯ï¼šä¸€å¼€å§‹æƒ³å¤šäº†ã€‚å…¶å®ç”¨æš´åŠ›éå†å°±è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> idx, <span class="keyword">boolean</span>[] used, <span class="keyword">int</span> N)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(idx == used.length)&#123;</div><div class="line">            ++counter;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(used[i])<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span>(idx % i == <span class="number">0</span> || i % idx == <span class="number">0</span>)&#123;</div><div class="line">                used[i] = <span class="keyword">true</span>;</div><div class="line">                helper(idx + <span class="number">1</span>, used, N);</div><div class="line">                used[i] = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countArrangement</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">        <span class="keyword">boolean</span>[] used = <span class="keyword">new</span> <span class="keyword">boolean</span>[N + <span class="number">1</span>];</div><div class="line">        helper(<span class="number">1</span>, used, N);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Wildcard-Matching">4.7. Wildcard Matching</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­ä¸€ä¸ªå«æœ‰<code>*æˆ–?</code>ã€‚<code>*</code>ä»£è¡¨å¯åŒ¹é…ä»»æ„å¤šä¸ªå­—ç¬¦ã€‚<code>?</code>ä»£è¡¨å¯åŒ¹é…ä»»æ„å…ƒç´ ã€‚æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦èƒ½å®Œå…¨åŒ¹é…</p>
<p>æ€è·¯ï¼šå›æº¯ï¼Œç¢°åˆ°ä¸è¡Œçš„å°±å›é€€</p>
<p>æœ€åå‡ ä¸ªæ ·ä¾‹ä¼šè¶…æ—¶ï¼Œæ‰€ä»¥æˆ‘åˆç”¨äº†dp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(String s, String p, <span class="keyword">int</span> s_idx, <span class="keyword">int</span> p_idx)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(s_idx &gt;= s.length() &amp;&amp; p_idx &gt;= p.length()) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(p_idx &gt;= p.length()) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(s_idx &gt;= s.length())&#123;</div><div class="line">        <span class="keyword">while</span> (p_idx &lt; p.length()) &#123;</div><div class="line">            <span class="keyword">if</span> (p.charAt(p_idx) == <span class="string">'*'</span>)</div><div class="line">                ++p_idx;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(dp[s_idx][p_idx] != <span class="number">0</span>) <span class="keyword">return</span> dp[s_idx][p_idx];</div><div class="line"></div><div class="line">    <span class="keyword">char</span> s_element = s.charAt(s_idx);</div><div class="line">    <span class="keyword">char</span> p_element = p.charAt(p_idx);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(p_element == <span class="string">'?'</span>)&#123;</div><div class="line">        dp[s_idx][p_idx] = helper(s, p, s_idx + <span class="number">1</span>, p_idx + <span class="number">1</span>);</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(p_element == <span class="string">'*'</span>)&#123;</div><div class="line">      <span class="comment">// è·³è¿‡è¿ç»­çš„******</span></div><div class="line">        <span class="keyword">while</span> (p_idx &lt; p.length() - <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(p.charAt(p_idx + <span class="number">1</span>) == <span class="string">'*'</span>) ++p_idx;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        dp[s_idx][p_idx] = helper(s, p, s_idx, p_idx + <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(dp[s_idx][p_idx] == -<span class="number">1</span>)</div><div class="line">            dp[s_idx][p_idx] = helper(s, p, s_idx + <span class="number">1</span>, p_idx);</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(p_element == s_element)&#123;</div><div class="line">        dp[s_idx][p_idx] = helper(s, p, s_idx + <span class="number">1</span>, p_idx + <span class="number">1</span>);</div><div class="line">    &#125;<span class="keyword">else</span></div><div class="line">        dp[s_idx][p_idx] = -<span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> dp[s_idx][p_idx];</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span>[][] dp;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">    dp = <span class="keyword">new</span> <span class="keyword">int</span>[s.length()][p.length()];</div><div class="line">    <span class="keyword">return</span> helper(s, p, <span class="number">0</span>, <span class="number">0</span>) == <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>äºŒåˆ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(String s, String p, <span class="keyword">int</span> s_idx, <span class="keyword">int</span> p_idx)</span></span>&#123;</div><div class="line">     <span class="keyword">if</span>(memo[s_idx][p_idx] != <span class="number">0</span>) <span class="keyword">return</span> memo[s_idx][p_idx];</div><div class="line">     <span class="keyword">if</span>(s_idx == s.length() &amp;&amp; p_idx == p.length())&#123;</div><div class="line">         memo[s_idx][p_idx] = <span class="number">1</span>;</div><div class="line">         <span class="keyword">return</span>  memo[s_idx][p_idx];</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">if</span>(p_idx == p.length()) &#123;</div><div class="line">         memo[s_idx][p_idx] = -<span class="number">1</span>;</div><div class="line">         <span class="keyword">return</span> memo[s_idx][p_idx];</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">if</span>(s_idx == s.length())&#123;</div><div class="line">         <span class="keyword">while</span> (p_idx &lt; p.length() &amp;&amp; p.charAt(p_idx) == <span class="string">'*'</span>) &#123;++p_idx;&#125;</div><div class="line">         memo[s_idx][p_idx] = p_idx == p.length() ? <span class="number">1</span> : -<span class="number">1</span>;</div><div class="line">         <span class="keyword">return</span>  memo[s_idx][p_idx];</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     <span class="keyword">if</span>(p.charAt(p_idx) == <span class="string">'?'</span> || s.charAt(s_idx) == p.charAt(p_idx))&#123;</div><div class="line">         memo[s_idx][p_idx] =  helper(s,p, s_idx + <span class="number">1</span>, p_idx + <span class="number">1</span>);</div><div class="line"></div><div class="line">     &#125;<span class="keyword">else</span> <span class="keyword">if</span>(p.charAt(p_idx) == <span class="string">'*'</span>)&#123;</div><div class="line">         memo[s_idx][p_idx] = helper(s, p, s_idx + <span class="number">1</span>, p_idx);</div><div class="line">         <span class="keyword">if</span>(memo[s_idx][p_idx] &lt; <span class="number">0</span>)</div><div class="line">             memo[s_idx][p_idx] = helper(s, p, s_idx, p_idx + <span class="number">1</span>);</div><div class="line">     &#125;<span class="keyword">else</span>&#123;</div><div class="line">         memo[s_idx][p_idx] = -<span class="number">1</span>;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> memo[s_idx][p_idx];</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">int</span>[][] memo;</div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">     memo = <span class="keyword">new</span> <span class="keyword">int</span>[s.length() + <span class="number">1</span>][p.length() + <span class="number">1</span>];</div><div class="line">     helper(s, p ,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">     <span class="keyword">return</span> memo[s.length()][p.length()] == <span class="number">1</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="Regular-Expression-Matching">4.8. Regular Expression Matching</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­ä¸€ä¸ªå«æœ‰<code>*æˆ–.</code>ã€‚<code>*</code>ä»£è¡¨å¯åŒ¹é…å‰ä¸€ä¸ªå…ƒç´ 0ä¸ªæˆ–å¤šä¸ªã€‚<code>.</code>ä»£è¡¨å¯åŒ¹é…ä»»æ„å…ƒç´ ã€‚æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦èƒ½å®Œå…¨åŒ¹é…</p>
<p>æ€è·¯ï¼šå›æº¯ï¼Œç¢°åˆ°ä¸è¡Œçš„å°±å›é€€</p>
<p>æ³¨æ„è¾¹ç•Œæ¡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(String s, String p, <span class="keyword">int</span> s_idx, <span class="keyword">int</span> p_idx)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(s_idx &lt; <span class="number">0</span> &amp;&amp; p_idx &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>(p_idx &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span>(s_idx &lt; <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(p.charAt(p_idx) == <span class="string">'*'</span>)</div><div class="line">                <span class="keyword">return</span> helper(s, p, s_idx, p_idx - <span class="number">2</span>); <span class="comment">// åŒ¹é…0ä¸ª</span></div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">char</span> p_element = p.charAt(p_idx);</div><div class="line">        <span class="keyword">char</span> s_element = s.charAt(s_idx);</div><div class="line">        <span class="keyword">if</span>(p_element == <span class="string">'.'</span>)&#123;</div><div class="line">            <span class="keyword">return</span> helper(s, p, s_idx - <span class="number">1</span>, p_idx - <span class="number">1</span>);</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(p_element == <span class="string">'*'</span>)&#123;</div><div class="line">            <span class="comment">// æ¯”è¾ƒs[s_idx]ä¸p[p_idx - 1]</span></div><div class="line">            <span class="keyword">if</span>(p_idx == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">if</span>((s_element == p.charAt(p_idx - <span class="number">1</span>)) || (p.charAt(p_idx - <span class="number">1</span>) == <span class="string">'.'</span>))&#123;</div><div class="line">                <span class="keyword">return</span> helper(s, p, s_idx - <span class="number">1</span>,p_idx) || <span class="comment">// åŒ¹é…1ä¸ª</span></div><div class="line">                        helper(s, p, s_idx, p_idx - <span class="number">2</span>); <span class="comment">// åŒ¹é…0ä¸ª</span></div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> helper(s, p, s_idx, p_idx - <span class="number">2</span>); <span class="comment">// åŒ¹é…0ä¸ª</span></div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">if</span>(p_element == s_element)&#123;</div><div class="line">                <span class="keyword">return</span> helper(s, p, s_idx - <span class="number">1</span>, p_idx - <span class="number">1</span>);</div><div class="line">            &#125;<span class="keyword">else</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(s, p, s.length() - <span class="number">1</span>,p.length() - <span class="number">1</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Reconstruct-Itinerary">4.9. Reconstruct Itinerary</h2><p>è¡Œç¨‹å®‰æ’é—®é¢˜ã€‚ä¸€ä¸ªäººä»JFKå‡ºå‘ï¼Œæ±‚ä¸€ç§èƒ½èµ°å¾—é€šçš„è¡Œç¨‹</p>
<p>è¿™é“é¢˜å†™äº†å¾ˆä¹…ï¼Œä¸€å¼€å§‹é™·å…¥äº†æ‹“æ‰‘æ’åºçš„æ€ªåœˆã€‚ä»¥åè¦æ³¨æ„è‡ªå·±çš„æ€ç»´ï¼Œä¸è¦è¢«ä¹‹å‰çš„é¢˜é™åˆ¶ï¼</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>å»ºç«‹æ¯ä¸ªç‚¹çš„é‚»æ¥åˆ—è¡¨</li>
<li>ä¾æ¬¡å¾€ä¸‹æ¢æµ‹ï¼Œé‡åˆ°ä¸åˆé€‚çš„å°±è¿”å›</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">    String departure;</div><div class="line">    ArrayList&lt;Node&gt; neighbors = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="keyword">boolean</span>[] visited;</div><div class="line">    Node(String departure)&#123;</div><div class="line">        <span class="keyword">this</span>.departure = departure;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.departure.compareTo(o.departure);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> HashMap&lt;String, Node&gt; <span class="title">countDegree</span><span class="params">(String[][] tickets)</span></span>&#123;</div><div class="line">    HashMap&lt;String, Node&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(String[] edge : tickets)&#123;</div><div class="line">        hashMap.put(edge[<span class="number">0</span>], <span class="keyword">new</span> Node(edge[<span class="number">0</span>]));</div><div class="line">        hashMap.put(edge[<span class="number">1</span>], <span class="keyword">new</span> Node(edge[<span class="number">1</span>]));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(String[] edge : tickets)&#123;</div><div class="line">        Node neibor = hashMap.get(edge[<span class="number">1</span>]);</div><div class="line">        hashMap.get(edge[<span class="number">0</span>]).neighbors.add(neibor);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å¯¹æ¯ä¸ªdeparturesçš„é‚»å±…æ’åº</span></div><div class="line">    <span class="keyword">for</span>(Node e : hashMap.values())&#123;</div><div class="line">        Collections.sort(e.neighbors);</div><div class="line">        e.visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[e.neighbors.size()];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hashMap;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(Node departure, List&lt;String&gt; result, <span class="keyword">int</span> length)</span></span>&#123;</div><div class="line">    <span class="comment">//System.out.println(result);</span></div><div class="line">    <span class="keyword">if</span>(result.size() == length) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(result.size() &gt; length) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; departure.visited.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(departure.visited[i])<span class="keyword">continue</span>;</div><div class="line">        departure.visited[i] = <span class="keyword">true</span>;</div><div class="line">        result.add(departure.neighbors.get(i).departure);</div><div class="line">        <span class="keyword">if</span>(dfs(departure.neighbors.get(i), result, length)) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        result.remove(result.size() - <span class="number">1</span>);</div><div class="line">        departure.visited[i] = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findItinerary</span><span class="params">(String[][] tickets)</span> </span>&#123;</div><div class="line">    <span class="comment">//ç»Ÿè®¡æ¯ä¸ªç«™é‚»å±…ï¼Œå¹¶åšæ’åº</span></div><div class="line">    HashMap&lt;String, Node&gt; departures = countDegree(tickets);</div><div class="line">    <span class="comment">// å¼€å§‹åšdfs</span></div><div class="line">    List&lt;String&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">2</span> + tickets.length - <span class="number">1</span>);</div><div class="line">    result.add(<span class="string">"JFK"</span>);</div><div class="line">    dfs(departures.get(<span class="string">"JFK"</span>), result, <span class="number">2</span> + tickets.length - <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ç”¨ä¼˜å…ˆé˜Ÿåˆ—</strong></p>
<p>ä¸‹é¢è¿™ä¸ªæ–¹æ³•çœŸæ˜¯å¤ªé¸¡è´¼äº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findItinerary</span><span class="params">(String[][] tickets)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (String[] ticket : tickets)</div><div class="line">        targets.computeIfAbsent(ticket[<span class="number">0</span>], k -&gt; <span class="keyword">new</span> PriorityQueue()).add(ticket[<span class="number">1</span>]);</div><div class="line">    visit(<span class="string">"JFK"</span>);</div><div class="line">    <span class="keyword">return</span> route;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Map&lt;String, PriorityQueue&lt;String&gt;&gt; targets = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">List&lt;String&gt; route = <span class="keyword">new</span> LinkedList();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(String airport)</span> </span>&#123;</div><div class="line">    <span class="keyword">while</span>(targets.containsKey(airport) &amp;&amp; !targets.get(airport).isEmpty())</div><div class="line">        visit(targets.get(airport).poll());</div><div class="line">    route.add(<span class="number">0</span>, airport); <span class="comment">// è¿™é‡Œå¾ˆå·§å¦™</span></div><div class="line">  <span class="comment">// 1. å‡è®¾è¿™æ¡è·¯ä¸‹å»æ˜¯ä¸ªç¯è·¯ï¼Œèµ°å›æ¥äº†ï¼Œé‚£å°±æš‚æ—¶å…ˆä¸åŠ ï¼Œç»§ç»­ä»ç¯è·¯é€’å½’</span></div><div class="line">  <span class="comment">// 2. åŠ å…¥è¿™æ¡è·¯ä¸æ˜¯ä¸ªç¯è·¯ï¼Œé‚£å°±åŠ è¿›å»ï¼Œç„¶åè·³å‡ºå¾ªç¯ï¼Œå›åˆ°ç¯è·¯ï¼Œå†æŠŠç¯è·¯çš„ç»“æœä¾æ¬¡ç›¸åŠ </span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§éé€’å½’ï¼Œç”¨æ ˆçš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findItinerary</span><span class="params">(String[][] tickets)</span> </span>&#123;</div><div class="line">    Map&lt;String, PriorityQueue&lt;String&gt;&gt; targets = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">for</span> (String[] ticket : tickets)</div><div class="line">        targets.computeIfAbsent(ticket[<span class="number">0</span>], k -&gt; <span class="keyword">new</span> PriorityQueue()).add(ticket[<span class="number">1</span>]);</div><div class="line">    List&lt;String&gt; route = <span class="keyword">new</span> LinkedList();</div><div class="line">    Stack&lt;String&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    stack.push(<span class="string">"JFK"</span>);</div><div class="line">    <span class="keyword">while</span> (!stack.empty()) &#123;</div><div class="line">        <span class="keyword">while</span> (targets.containsKey(stack.peek()) &amp;&amp; !targets.get(stack.peek()).isEmpty())</div><div class="line">            stack.push(targets.get(stack.peek()).poll());</div><div class="line">        route.add(<span class="number">0</span>, stack.pop());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> route;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Matchsticks-to-Square">4.10. Matchsticks to Square</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œå€¼è¡¨ç¤ºç«æŸ´é•¿åº¦ã€‚æ±‚è¿™äº›ç«æŸ´èƒ½ä¸èƒ½ç»„æˆæ­£æ–¹å½¢ã€‚</p>
<p>æœ‰æ„æ€çš„é¢˜ç›®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">boolean</span>[] visited, <span class="keyword">int</span> idx, <span class="keyword">int</span> sum, <span class="keyword">int</span> width, <span class="keyword">int</span> counter)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(sum &gt; width)<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">if</span>(counter &gt;= <span class="number">4</span>)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">if</span>(sum == width)&#123;</div><div class="line">        ++counter;</div><div class="line">        <span class="keyword">if</span>(counter == <span class="number">4</span>)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        idx = <span class="number">0</span>; <span class="comment">//è¿™é‡Œæ¯”è¾ƒæœ‰æ„æ€</span></div><div class="line">        sum = <span class="number">0</span>; <span class="comment">// æœ‰æ„æ€å“‡</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(idx &gt;= nums.length || nums[idx] &gt; width) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = idx; i &lt; nums.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(visited[i])<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(nums[i] &gt; width)<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        visited[i] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>(dfs(nums, visited, i + <span class="number">1</span>, sum + nums[i], width,counter))<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        visited[i] = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">makesquare</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> num : nums) sum += num;</div><div class="line">    <span class="keyword">if</span>(sum % <span class="number">4</span> != <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span> width = sum/<span class="number">4</span>;</div><div class="line">    <span class="keyword">return</span> dfs(nums, <span class="keyword">new</span> <span class="keyword">boolean</span>[nums.length], <span class="number">0</span>, <span class="number">0</span>, width, <span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Maximum-Length-of-Pair-Chain">4.11. Maximum Length of Pair Chain</h2><p>å‡è®¾æœ‰æ•´æ•°å¯¹<code>[a,b]</code>å’Œ<code>[c,d]</code> ã€‚å¦‚æœ<code>b &lt; c</code> ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ•´æ•°å¯¹å¯ä»¥æ„æˆä¸€ä¸ªé“¾ã€‚ç»™ä¸€äº›æ•´æ•°å¯¹ï¼Œæ±‚è¿™äº›æ•´æ•°å¯¹èƒ½æ„æˆçš„æœ€é•¿é“¾ã€‚</p>
<p>æ€è·¯ï¼šæ’åº+è®°å¿†åŒ–æœç´¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">   <span class="keyword">int</span>[] memo;</div><div class="line"><span class="comment">// memo[i]è¡¨ç¤º[i,n]çš„æ•´æ•°å¯¹èƒ½æ„æˆçš„æœ€é•¿é“¾</span></div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[][] pair, <span class="keyword">int</span> idx, <span class="keyword">int</span>[] lastPair)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(idx &gt;= pair.length) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       <span class="keyword">if</span>(memo[idx] &gt;= <span class="number">0</span>) <span class="keyword">return</span> memo[idx];</div><div class="line">       <span class="comment">// [lastPair[0], lastPair[1]]  , [pairidx[0], pairidx[1]]</span></div><div class="line">       <span class="comment">// å¦‚æœè¿™ä¸¤ä¸ªæ•´æ•°å¯¹å¯ä»¥æ„æˆé“¾ï¼Œåˆ™å°è¯•æ„æˆ</span></div><div class="line">       <span class="keyword">if</span>(lastPair[<span class="number">1</span>] &lt; pair[idx][<span class="number">0</span>])&#123;</div><div class="line">           memo[idx] = helper(pair, idx + <span class="number">1</span>, pair[idx]) + <span class="number">1</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="comment">// è·³è¿‡è¿™ä¸ªæ•´æ•°å¯¹</span></div><div class="line">       memo[idx] = Math.max(memo[idx], helper(pair, idx + <span class="number">1</span>, lastPair));</div><div class="line">       <span class="keyword">return</span> memo[idx];</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLongestChain</span><span class="params">(<span class="keyword">int</span>[][] pairs)</span> </span>&#123;</div><div class="line">       <span class="comment">// å…ˆæŒ‰ç…§ç¬¬2ä¸ªå…ƒç´ æ’åº</span></div><div class="line">       Arrays.sort(pairs, <span class="keyword">new</span> Comparator&lt;<span class="keyword">int</span>[]&gt;() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">int</span>[] o1, <span class="keyword">int</span>[] o2)</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> o1[<span class="number">1</span>] - o2[<span class="number">1</span>];</div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line">       memo = <span class="keyword">new</span> <span class="keyword">int</span>[pairs.length];</div><div class="line">       Arrays.fill(memo, -<span class="number">1</span>);</div><div class="line">       <span class="keyword">return</span> helper(pairs, <span class="number">0</span>, <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;Integer.MIN_VALUE, Integer.MIN_VALUE&#125;);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://xiaokedada.com/2017/05/05/heap-algorithms/" target="_blank" rel="external">å…¨æ’åˆ—çš„ç»å…¸ç®—æ³•-heapâ€™s algorithms</a></li>
<li><a href="http://zhouyichu.com/algorithm/Permutation-Generation-1/" target="_blank" rel="external">å…¨æ’åˆ—ç®—æ³•part1</a></li>
<li><a href="https://segmentfault.com/a/1190000003766760" target="_blank" rel="external">[Leetcode] Permutation Sequence å…¨æ’åˆ—åºåˆ—</a></li>
<li><a href="http://www.cnblogs.com/aprilcheny/p/4961412.html" target="_blank" rel="external">[LeetCode]76. Permutation Sequenceå…¨æ’åˆ—åºåˆ—</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-æ•°ç»„ä¸æ•°]]></title>
      <url>/2017/12/11/%E7%AE%97%E6%B3%95-%E6%95%B0%E7%BB%84%E4%B8%8E%E6%95%B0/</url>
      <content type="html"><![CDATA[<h1 id="å¤§çº²">1. å¤§çº²</h1><ul>
<li>æœ‰åºæ•°ç»„<ul>
<li>Mergeä¸¤ä¸ªæœ‰åºæ•°ç»„<ul>
<li>å°†å°æ•°ç»„å½’å¹¶åˆ°å¤§æ•°ç»„é‡Œ</li>
<li>ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</li>
<li>æ•°ç»„ç‚¹ä¹˜</li>
</ul>
</li>
</ul>
</li>
<li>å­æ•°ç»„<ul>
<li>å‰ç¼€å’Œ</li>
</ul>
</li>
<li>Two Sum<ul>
<li>Hash Map vs Two pointers</li>
</ul>
</li>
<li>Two Pointers</li>
</ul>
<a id="more"></a>
<h1 id="æœ‰åºæ•°ç»„">2. æœ‰åºæ•°ç»„</h1><h2 id="ä¾‹é¢˜1ï¼ŒMerge-Two-Sorted-Array">2.1. ä¾‹é¢˜1ï¼ŒMerge Two Sorted Array</h2><p>å°†ä¸¤ä¸ªæœ‰åºæ•°ç»„åˆå¹¶ï¼Œ<code>A = [1,2,3,empty,empty],B = [4,5]</code>ã€‚å°†Båˆå¹¶åˆ°Aé‡Œ</p>
<p>æ€è·¯ï¼šä»æœ€å¤§çš„å¼€å§‹æ”¾</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span> m, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> pos = m + n - <span class="number">1</span>;</div><div class="line">        --m;--n;</div><div class="line">        <span class="keyword">while</span> (m &gt;= <span class="number">0</span> &amp;&amp; n &gt;= <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(nums1[m] &gt; nums2[n])&#123;</div><div class="line">                nums1[pos] = nums1[m];</div><div class="line">                --m;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                nums1[pos] = nums2[n];</div><div class="line">                --n;</div><div class="line">            &#125;</div><div class="line">            --pos;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span>(n &gt;= <span class="number">0</span>)&#123;</div><div class="line">            nums1[pos] = nums2[n];</div><div class="line">            --n;</div><div class="line">            --pos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜2ï¼ŒIntersection-of-Two-Arrays">2.2. ä¾‹é¢˜2ï¼ŒIntersection of Two Arrays</h2><p>æ±‚ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</p>
<p>æ€è·¯ï¼šå…ˆæ’åº</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">ä»£ç </div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] intersection(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</div><div class="line">        Arrays.sort(nums1);</div><div class="line">        Arrays.sort(nums2);</div><div class="line">        <span class="keyword">int</span> head1 = <span class="number">0</span>,head2 = <span class="number">0</span>;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (head1 &lt; nums1.length &amp;&amp; head2 &lt; nums2.length)&#123;</div><div class="line">            <span class="keyword">if</span>(nums1[head1] == nums2[head2])&#123;</div><div class="line">                result.add(nums1[head1]);</div><div class="line">                ++counter;</div><div class="line">                <span class="keyword">int</span> temp = nums1[head1];</div><div class="line">                <span class="keyword">while</span> (head1 &lt; nums1.length &amp;&amp; nums1[head1] == temp)&#123;</div><div class="line">                    ++head1;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">while</span> (head2 &lt; nums2.length &amp;&amp; nums2[head2] == temp)&#123;</div><div class="line">                    ++head2;</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums1[head1] &lt; nums2[head2])&#123;</div><div class="line">                ++head1;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                ++head2;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] resArr = <span class="keyword">new</span> <span class="keyword">int</span>[counter];</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(Integer ele : result)&#123;</div><div class="line">            resArr[i] = ele;</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> resArr;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Intersection-of-Two-Arrays-II">2.3. Intersection of Two Arrays II</h2><p>æ±‚ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ï¼Œäº¤é›†ä¸ç”¨å»é‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] intersect(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</div><div class="line">        Arrays.sort(nums1);</div><div class="line">        Arrays.sort(nums2);</div><div class="line">        <span class="keyword">int</span> head1 = <span class="number">0</span>,head2 = <span class="number">0</span>;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (head1 &lt; nums1.length &amp;&amp; head2 &lt; nums2.length)&#123;</div><div class="line">            <span class="keyword">if</span>(nums1[head1] == nums2[head2])&#123;</div><div class="line">                result.add(nums1[head1]);</div><div class="line">                ++counter;</div><div class="line">                ++head1;</div><div class="line">                ++head2;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums1[head1] &lt; nums2[head2])&#123;</div><div class="line">                ++head1;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                ++head2;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] resArr = <span class="keyword">new</span> <span class="keyword">int</span>[counter];</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(Integer ele : result)&#123;</div><div class="line">            resArr[i] = ele;</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> resArr;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å‡ ä¸ªfollow up:</p>
<ul>
<li>å¦‚æœæ•°ç»„æœ‰åºâ€”â€”é‚£ç®€ç›´å¤ªå®Œç¾äº†</li>
<li>å¦‚æœnums1å¾ˆçŸ­ï¼Œæ€æ ·ä¼˜åŒ–ä¼šå¥½äº›ï¼Ÿ<ul>
<li>å¯ä»¥å°†nums1æ”¾åœ¨hashè¡¨é‡Œ</li>
</ul>
</li>
<li>å¦‚æœnums2å­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œå†…å­˜é™åˆ¶ä¸èƒ½ä¸€æ¬¡æ€§è¯»å–å…¨éƒ¨ï¼Œæ€ä¹ˆåŠï¼Ÿ<ul>
<li>å¦‚æœåªæœ‰nums2å¤ªå¤§ï¼Œé‚£å°±æŠŠnums1æ”¾åœ¨ä¸€ä¸ªhashè¡¨é‡Œï¼Œç„¶åä¸€å—å—è¯»å–nums2ï¼Œä¾æ¬¡åŒ¹é…äº¤é›†</li>
<li>å¦‚æœä¸¤ä¸ªæ•°ç»„éƒ½å¾ˆå¤§ï¼Œé‚£å°±åªèƒ½å…ˆæ’åºï¼Œç„¶åå†ä¾æ¬¡è¯»å–äº†</li>
</ul>
</li>
</ul>
<h2 id="ä¾‹é¢˜3ï¼Œç‚¹ä¹˜">2.4. ä¾‹é¢˜3ï¼Œç‚¹ä¹˜</h2><p>æ•°ç»„å†…ç§¯ï¼ˆç‚¹ä¹˜ï¼‰FOLLOW UP: ä¸¤ä¸ªæ•°ç»„éƒ½éå¸¸å¤§ï¼Œä½†æ˜¯å…¶ä¸­éƒ½åŒ…å«å¾ˆå¤š0</p>
<p>é¦–å…ˆæ”¹å˜å­˜å‚¨ï¼Œå› ä¸º0ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥åªå­˜å‚¨é0å…ƒç´ çš„ä¸‹æ ‡å’Œæ•°å€¼ã€‚<br>è®¡ç®—å†…ç§¯çš„æ—¶å€™ï¼Œåªæœ‰ä¸‹æ ‡éƒ½å‡ºç°çš„æ•°å€¼ç›¸ä¹˜æ‰æœ‰å€¼ï¼Œæ‰€ä»¥è¦è®¡ç®—ä¸¤ä¸ªæ•°ç»„çš„ä¸‹æ ‡çš„äº¤é›†ï¼Œæœ€åæŠŠå€¼ç®—å‡ºæ¥ã€‚<br>æ‰€ä»¥æœ¬é—®é¢˜å°±è½¬å˜æˆäº†æ±‚ä¸¤ä¸ªæ•°ç»„äº¤çš„é—®é¢˜äº†ã€‚</p>
<h2 id="Sparse-Matrix-Multiplication">2.5. Sparse Matrix Multiplication</h2><p>æ±‚ç¨€ç–çŸ©é˜µçš„ä¹˜æ³•</p>
<p>ç„¶è€Œè¿™ç§æ–¹å¼ä¾ç„¶å¾ˆæ…¢ã€‚å…¶å®ç›´æ¥éå†å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬çŸ¥é“ä¸€ä¸ª i x k çš„çŸ©é˜µAä¹˜ä»¥ä¸€ä¸ª k x j çš„çŸ©é˜µBä¼šå¾—åˆ°ä¸€ä¸ª i x j å¤§å°çš„çŸ©é˜µCï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ç»“æœçŸ©é˜µä¸­çš„æŸä¸ªå…ƒç´ <code>C[i][j]</code>æ˜¯æ€ä¹ˆæ¥çš„ï¼Œèµ·å§‹æ˜¯<code>A[i][0]*B[0][j] + A[i][1]*B[1][j] + ... + A[i][k]*B[k][j]</code>ï¼Œç›´è§‚åœ°å†™æˆä»£ç å°±æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; row ; ++i)&#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; ++j) &#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; A[<span class="number">0</span>].length ; ++k) &#123;</div><div class="line">                    result[i][j] += A[i][k]*B[k][j];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œå¦‚æœæœ‰å¾ˆå¤š0çš„è¯ï¼Œå¿…ç„¶ä¼šå¯¼è‡´å¤§é‡çš„0çš„ä¹˜æ³•ã€‚è¿™æ˜¯ä¼šè¶…æ—¶çš„ã€‚</p>
<p>å°±ç®—æˆ‘ä»¬è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; row ; ++i)&#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; ++j) &#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; A[<span class="number">0</span>].length ; ++k) &#123;</div><div class="line">                    <span class="keyword">if</span>(A[i][k] != <span class="number">0</span> &amp;&amp; B[k][j] !=<span class="number">0</span>) &#123;</div><div class="line">                        result[i][j] += A[i][k] * B[k][j];</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>è¿™è™½ç„¶èƒ½è¿‡ï¼Œä½†beats 1.75%ï¼Œéå¸¸çš„æ…¢ã€‚</p>
<p>é‚£ä¹ˆä¸ºäº†ä¸é‡å¤è®¡ç®—0ä¹˜0ï¼Œæˆ‘ä»¬å°†éå†é¡ºåºå˜ä¸€ä¸‹ã€‚é¦–å…ˆéå†Aæ•°ç»„ï¼Œè¦ç¡®ä¿<code>A[i][k]</code>ä¸ä¸º0ï¼Œæ‰ç»§ç»­è®¡ç®—ï¼Œç„¶åæˆ‘ä»¬éå†BçŸ©é˜µçš„ç¬¬kè¡Œï¼Œå¦‚æœ<code>B[K][J]</code>ä¸ä¸º0ï¼Œæˆ‘ä»¬ç´¯åŠ ç»“æœçŸ©é˜µ<code>res[i][j] += A[i][k] * B[k][j]</code>; è¿™æ ·æˆ‘ä»¬å°±èƒ½é«˜æ•ˆçš„ç®—å‡ºç¨€ç–çŸ©é˜µçš„ä¹˜æ³•ï¼Œå‚è§ä»£ç å¦‚ä¸‹ï¼š</p>
<p>å“‡å¿«äº†æœ‰åå€ï¼å¯ä»¥è¯´æ˜¯ç›¸å½“çš„æœºåˆ¶äº†ã€‚</p>
<p>ï¼ˆä»”ç»†å¤šæƒ³æƒ³ï¼Œç©¶ç«Ÿçœå»äº†ä»€ä¹ˆï¼Œæ‰å˜å¾—è¿™ä¹ˆå¿«ï¼Ÿï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] multiply(<span class="keyword">int</span>[][] A, <span class="keyword">int</span>[][] B) &#123;</div><div class="line">        <span class="keyword">if</span>(A.length == <span class="number">0</span> || A[<span class="number">0</span>].length == <span class="number">0</span> || B.length == <span class="number">0</span> || B[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> row = A.length , col = B[<span class="number">0</span>].length ;</div><div class="line">        <span class="keyword">int</span>[][] result = <span class="keyword">new</span> <span class="keyword">int</span>[row][col];</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; row ; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; A[<span class="number">0</span>].length ; ++k) &#123; <span class="comment">// å…ˆéå†k</span></div><div class="line">                <span class="keyword">if</span>(A[i][k] == <span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; ++j) &#123;</div><div class="line">                    <span class="keyword">if</span>(B[k][j] ==<span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">                    result[i][j] += A[i][k] * B[k][j];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>å¦ä¸€ç§æ€è·¯</strong>ï¼šå€Ÿç”¨ä¸Šä¸€é¢˜çš„æ€è·¯ï¼Œå»ºç«‹Açš„æ¯è¡Œçš„éé›¶å…ƒç´ å’ŒBçš„æ¯åˆ—çš„éé›¶å…ƒç´ çš„ç´¢å¼•ã€‚ç„¶åå†ä¹˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        ListNode next;</div><div class="line">        ListNode(<span class="keyword">int</span> val)&#123;</div><div class="line">            <span class="keyword">this</span>.val = val;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[][] multiply(<span class="keyword">int</span>[][] A, <span class="keyword">int</span>[][] B) &#123;</div><div class="line">        <span class="keyword">if</span>(A.length == <span class="number">0</span> || A[<span class="number">0</span>].length == <span class="number">0</span> || B.length == <span class="number">0</span> || B[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="comment">// A - æŸè¡Œä¸ä¸º0çš„index</span></div><div class="line">        ListNode[] index_A = <span class="keyword">new</span> ListNode[A.length];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; A.length ; ++i)&#123;</div><div class="line">            ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">            ListNode curr = dummy;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; A[i].length ; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(A[i][j] != <span class="number">0</span>) &#123;</div><div class="line">                    ListNode next = <span class="keyword">new</span> ListNode(j);</div><div class="line">                    curr.next = next;</div><div class="line">                    curr = next;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            index_A[i] = dummy.next;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// B - æŸåˆ—ä¸ä¸º0çš„index</span></div><div class="line">        ListNode[] index_B = <span class="keyword">new</span> ListNode[B[<span class="number">0</span>].length];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; B[<span class="number">0</span>].length ; ++j)&#123;</div><div class="line">            ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">            ListNode curr = dummy;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; B.length ; ++i)&#123;</div><div class="line">                <span class="keyword">if</span>(B[i][j] != <span class="number">0</span>)&#123;</div><div class="line">                    ListNode next = <span class="keyword">new</span> ListNode(i);</div><div class="line">                    curr.next = next;</div><div class="line">                    curr = next;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            index_B[j] = dummy.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> row = A.length , col = B[<span class="number">0</span>].length ;</div><div class="line">        <span class="keyword">int</span>[][] result = <span class="keyword">new</span> <span class="keyword">int</span>[row][col];</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; row ; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; col ; ++j)&#123;</div><div class="line">                <span class="comment">// æ±‚Açš„ç¬¬iè¡Œ ä¸ Bçš„ç¬¬jåˆ— éé›¶å…ƒç´ çš„å’Œ</span></div><div class="line">                result[i][j] = getSum(i,j,A,B,index_A,index_B);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getSum</span><span class="params">(<span class="keyword">int</span> row,<span class="keyword">int</span> col, <span class="keyword">int</span>[][] A,<span class="keyword">int</span> [][] B, ListNode[] index_A, ListNode[] index_B)</span></span>&#123;</div><div class="line">        ListNode curr_A = index_A[row];</div><div class="line">        ListNode curr_B = index_B[col];</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != curr_A &amp;&amp; <span class="keyword">null</span> != curr_B)&#123;</div><div class="line">            <span class="keyword">if</span>(curr_A.val == curr_B.val)&#123;</div><div class="line">                sum += A[row][curr_A.val]*B[curr_A.val][col];</div><div class="line">                curr_A = curr_A.next;</div><div class="line">                curr_B = curr_B.next;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(curr_A.val &lt; curr_B.val)&#123;</div><div class="line">                curr_A = curr_A.next;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                curr_B = curr_B.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜5ï¼ŒKth-Largest-Element">2.6. ä¾‹é¢˜5ï¼ŒKth Largest Element</h2><p>ä¸€ä¸ªæ•°ç»„çš„ç¬¬kå¤§æ•°</p>
<p>ä¹‹å‰æœ‰ä¸€ä¸ªå®ç°æ–¹æ³•ï¼Œç”¨å †ã€‚å¤æ‚åº¦æ˜¯$O(nlogk)$</p>
<p>è¿™æ¬¡ä½¿ç”¨å¿«é€Ÿé€‰æ‹©ï¼Œå¤æ‚åº¦æ˜¯$O(n)$</p>
<p>æ€è·¯ï¼š</p>
<p><strong>å¿«é€Ÿé€‰æ‹©</strong></p>
<ul>
<li><code>Quick select</code>ç®—æ³•å› å…¶é«˜æ•ˆå’Œè‰¯å¥½çš„average caseæ—¶é—´å¤æ‚åº¦è€Œè¢«å¹¿ä¸ºåº”ç”¨ã€‚<code>Quick select</code>çš„average caseæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œç„¶è€Œå…¶worst caseæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€‚</li>
<li>æ€»ä½“è€Œè¨€ï¼Œ<code>Quick select</code>é‡‡ç”¨å’Œ<code>Quick sort</code>ç±»ä¼¼çš„æ­¥éª¤ã€‚é¦–å…ˆé€‰å®šä¸€ä¸ª<code>pivot</code>ï¼Œç„¶åæ ¹æ®æ¯ä¸ªæ•°å­—ä¸è¯¥<code>pivot</code>çš„å¤§å°å…³ç³»å°†æ•´ä¸ªæ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚é‚£ä¹ˆä¸<code>Quick sort</code>ä¸åŒçš„æ˜¯ï¼Œ<code>Quick select</code>åªè€ƒè™‘æ‰€å¯»æ‰¾çš„ç›®æ ‡æ‰€åœ¨çš„é‚£ä¸€éƒ¨åˆ†å­æ•°ç»„ï¼Œè€Œéåƒ<code>Quick sort</code>ä¸€æ ·åˆ†åˆ«å†å¯¹ä¸¤è¾¹è¿›è¡Œåˆ†å‰²ã€‚æ­£æ˜¯å› ä¸ºå¦‚æ­¤ï¼Œ<code>Quick select</code>å°†å¹³å‡æ—¶é—´å¤æ‚åº¦ä»<code>O(nlogn)</code>é™åˆ°äº†<code>O(n)</code>ã€‚</li>
</ul>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºâ€åŸºå‡†â€ï¼ˆpivotï¼‰ã€‚</li>
<li>é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚</li>
<li>åˆ¤æ–­ç¬¬kä¸ªæœ€å°å…ƒç´ ä½äºå·¦ä¾§è¿˜æ˜¯å³ä¾§ï¼Œç„¶åå¯¹è¯¥ä¾§è¿›è¡Œé€’å½’ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div></pre></td><td class="code"><pre><div class="line">è¿‡ç¨‹</div><div class="line">å‡è®¾å¯»æ‰¾ç¬¬k=<span class="number">3</span>å¤§çš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æ‰¾ç¬¬<span class="number">6</span>- <span class="number">3</span> + <span class="number">1</span>= <span class="number">4</span>å°çš„å…ƒç´  , ä¹Ÿå°±æ˜¯<span class="number">7</span></div><div class="line"></div><div class="line">ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬ä¸‹é¢çš„indexéƒ½æ˜¯ä»<span class="number">1</span>å¼€å§‹</div><div class="line"></div><div class="line">i              j</div><div class="line">â†“              â†“</div><div class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span></div><div class="line">      </div><div class="line">    pivot = <span class="number">7</span></div><div class="line">  </div><div class="line">++i ä¸¤æ¬¡</div><div class="line">   </div><div class="line">      i        j</div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span></div><div class="line">  </div><div class="line">äº¤æ¢i,jï¼Œå¹¶++i,--j</div><div class="line"></div><div class="line">         i  j</div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span></div><div class="line"></div><div class="line">--j</div><div class="line">  </div><div class="line">      j  i</div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>  </div><div class="line">  </div><div class="line">æ€»ä¹‹ï¼Œé€šè¿‡åŠ åŠ å‡å‡äº¤æ¢ï¼Œä»¥ä¸Šæ•°ç»„å˜ä¸º</div><div class="line">      j  i</div><div class="line">      â†“  â†“</div><div class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span></div><div class="line">      </div><div class="line">    pivot = <span class="number">7</span></div><div class="line"> </div><div class="line"> æ­¤æ—¶j&lt;iï¼Œè·³å‡º<span class="keyword">while</span>å¾ªç¯</div><div class="line">æ­¤æ—¶:</div><div class="line">- [<span class="number">1</span>,j]çš„å…ƒç´ éƒ½å°äºpivot</div><div class="line">- [i,n]çš„å…ƒç´ éƒ½å¤§äºpivot</div><div class="line"> </div><div class="line"> ç„¶åçœ‹ç¬¬kå°çš„å…ƒç´ æ˜¯åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼š</div><div class="line"> - å¦‚æœåœ¨å·¦è¾¹ï¼Œé‚£k &lt;= j</div><div class="line"> - å¦‚æœåœ¨å³è¾¹ï¼Œé‚£k &gt;= i</div><div class="line"> æˆ‘ä»¬å‘ç° k &gt;= i (<span class="number">4</span> &gt;= <span class="number">4</span>)ï¼Œé‚£å°±å†åœ¨å³è¾¹æ‰¾ï¼š</div><div class="line">=====================================</div><div class="line">         i     j</div><div class="line">         â†“     â†“</div><div class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span></div><div class="line">            </div><div class="line">          pivot = <span class="number">9</span></div><div class="line"> </div><div class="line"> é€šè¿‡åŠ åŠ å‡å‡äº¤æ¢ï¼Œä»¥ä¸Šæ•°ç»„å˜ä¸º</div><div class="line">            j  i</div><div class="line">            â†“  â†“</div><div class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">9</span></div><div class="line">            </div><div class="line">          pivot = <span class="number">9</span></div><div class="line"> </div><div class="line"> æ­¤æ—¶j&lt;iï¼Œè·³å‡º<span class="keyword">while</span>å¾ªç¯</div><div class="line"> </div><div class="line"> ç„¶åçœ‹ç¬¬kå°çš„å…ƒç´ æ˜¯åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼š</div><div class="line"> - å¦‚æœåœ¨å·¦è¾¹ï¼Œé‚£k &lt;= j</div><div class="line"> - å¦‚æœåœ¨å³è¾¹ï¼Œé‚£k &gt;= i</div><div class="line"> æˆ‘ä»¬å‘ç° k &lt;= j (<span class="number">4</span> &lt;= <span class="number">5</span>)ï¼Œé‚£å°±ç»§ç»­å‘å³è¾¹å¯»æ‰¾</div><div class="line">=====================================</div><div class="line">           j,i</div><div class="line">            â†“ </div><div class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></div><div class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">9</span></div><div class="line">  </div><div class="line">æ­¤æ—¶j == i ,ç›´æ¥è¾“å‡º<span class="number">7</span></div><div class="line"></div><div class="line"></div><div class="line">è€Œåœ¨ä»£ç ä¸­ï¼Œidxä»<span class="number">0</span>å¼€å§‹ï¼Œå› æ­¤ç›´æ¥ç»™k-<span class="number">1</span>å³å¯</div><div class="line"></div><div class="line">  </div><div class="line">  </div><div class="line">å‚è€ƒä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthLargestElement</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span>[] nums)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> quickSelece(nums,<span class="number">0</span>,nums.length - <span class="number">1</span>, nums.length - k + <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">quickSelect</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(start == end)&#123;</div><div class="line">      <span class="keyword">return</span> nums[start];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> mid = start + (end - start)/<span class="number">2</span>;</div><div class="line">  <span class="comment">// 1. ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºâ€åŸºå‡†â€ï¼ˆpivotï¼‰</span></div><div class="line">  <span class="keyword">int</span> pivot = nums[mid];</div><div class="line">  </div><div class="line">  <span class="comment">// 2. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®</span></div><div class="line">  <span class="keyword">int</span> i = start, j = end;</div><div class="line">  <span class="keyword">while</span>(i &lt;= j)&#123;</div><div class="line">    <span class="comment">// nums[i]ä¹‹å‰  &lt; pivot</span></div><div class="line">    <span class="keyword">while</span>(i &lt;= j &amp;&amp; nums[i] &lt; pivot)&#123;</div><div class="line">      i++;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// nums[j]ä¹‹å &gt; pivot</span></div><div class="line">    <span class="keyword">while</span>(i &lt;= j &amp;&amp; nums[j] &gt; pivot)&#123;</div><div class="line">      j--;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æ­¤æ—¶nums[i] &gt; pivot ï¼Œ nums[j] &lt; pivotï¼Œä¸ç¬¦åˆâ€œå·¦è¾¹æ¯”pivotå°ï¼Œå³è¾¹æ¯”pivotå¤§â€çš„åŸåˆ™ï¼Œé‚£ä¹ˆäº¤æ¢iï¼Œj    </span></div><div class="line">    <span class="keyword">if</span>(i &lt;= j)&#123;</div><div class="line">       <span class="comment">// äº¤æ¢i,j</span></div><div class="line">       <span class="keyword">int</span> temp = nums[i];</div><div class="line">       nums[i] = nums[j];</div><div class="line">       nums[j] = temp;</div><div class="line">       i++;</div><div class="line">       j--;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// 3. åˆ¤æ–­ç¬¬kä¸ªæœ€å°å…ƒç´ ä½äºå·¦ä¾§è¿˜æ˜¯å³ä¾§ï¼Œç„¶åå¯¹è¯¥ä¾§è¿›è¡Œé€’å½’</span></div><div class="line">  </div><div class="line">  <span class="comment">// å¾—åˆ°ä¸€ä¸ªåˆ†å‰²ç‚¹-[j+1,i-1]</span></div><div class="line">  <span class="comment">//[start,j],[j+1,i-1],[i,end]</span></div><div class="line">  </div><div class="line">  <span class="comment">// start ~ jä¹‹å‰å¤Ÿkä¸ªæ•°ï¼Œç›´æ¥åœ¨start~jä¹‹é—´æ‰¾</span></div><div class="line">  <span class="keyword">if</span>(start + k - <span class="number">1</span> &lt;= j)&#123;</div><div class="line">  	<span class="keyword">return</span> quickSelect(nums, start, i, k);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// i ~ endä¹‹å‰ä¸å¤Ÿkä¸ªæ•°ï¼Œåœ¨iä¹‹åæ‰¾</span></div><div class="line">  <span class="keyword">if</span>(start + k - <span class="number">1</span> &gt;= i)&#123;</div><div class="line">  	<span class="keyword">return</span> quickSelect(nums, i, end, k - (i - start));</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// j + 1 ~ i - 1 è¦ä¹ˆåªæœ‰ä¸€ä¸ªæ•°pivot,è¦ä¹ˆæ²¡æœ‰</span></div><div class="line">  <span class="comment">// æ­£å¥½åœ¨ä¸­é—´</span></div><div class="line">  <span class="keyword">return</span> nums[j + <span class="number">1</span>];</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findKthLargest</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> quickSelect(<span class="number">0</span>,nums.length - <span class="number">1</span>,nums,nums.length - k);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">quickSelect</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(start == end)&#123; <span class="keyword">return</span> nums[start]; &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> mid = start + (end - start) / <span class="number">2</span>;</div><div class="line">        <span class="comment">// ä¸»å…ƒ</span></div><div class="line">        <span class="keyword">int</span> pivot = nums[mid];</div><div class="line">        <span class="keyword">int</span> i = start,j = end;</div><div class="line">        <span class="keyword">while</span> (i &lt;= j)&#123;</div><div class="line">            <span class="keyword">while</span> (i &lt;= j &amp;&amp; nums[i] &lt; pivot)&#123;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (i &lt;= j &amp;&amp; nums[j] &gt; pivot)&#123;</div><div class="line">                --j;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i &lt;= j)&#123;</div><div class="line">                <span class="comment">// swap i,j</span></div><div class="line">                <span class="keyword">int</span> temp = nums[i];</div><div class="line">                nums[i] = nums[j];</div><div class="line">                nums[j] = temp;</div><div class="line">                ++i;</div><div class="line">                --j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// iä¹‹å‰çš„éƒ½æ¯”pivotå°ï¼Œjä¹‹åçš„éƒ½æ¯”pivotå¤§</span></div><div class="line">        <span class="comment">//[start,j],[j+1,i-1],[i,end]</span></div><div class="line"></div><div class="line">        <span class="comment">//[start,j] éƒ½æ¯”pivotå° | [i,end]éƒ½æ¯”pivot å¤§</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span>(k &lt;= j)&#123;</div><div class="line">            <span class="comment">// ç¬¬kå°çš„æ•°è¿˜åœ¨å³è¾¹</span></div><div class="line">            <span class="keyword">return</span> quickSelect(start,j,nums,k);</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(k &gt;= i)&#123;</div><div class="line">            <span class="comment">// ç¬¬kå°çš„æ•°åœ¨å·¦è¾¹</span></div><div class="line">            <span class="keyword">return</span> quickSelect(i,end,nums,k);</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> pivot; <span class="comment">// ä¹Ÿæ˜¯nums[j + 1]</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜6ï¼ŒMedian-of-two-Sorted-Arrays">2.7. ä¾‹é¢˜6ï¼ŒMedian of two Sorted Arrays</h2><p>ä¸¤ä¸ªæ’åºæ•°ç»„çš„ä¸­ä½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line">æ€è·¯ï¼Œå…ˆæ‰¾Kth å°ï¼Œä¸ä¹‹å‰é“¾è¡¨çš„é¢˜æ€è·¯å·®ä¸å¤š</div><div class="line"></div><div class="line">A[k/<span class="number">2</span>] &lt;B[k/<span class="number">2</span>]  -&gt; å…ˆä¸¢æ‰å‰A[k/<span class="number">2</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findKth</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> A_start, <span class="keyword">int</span>[] B, <span class="keyword">int</span> B_start, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">	<span class="comment">//è¾¹ç•Œ</span></div><div class="line">    <span class="keyword">if</span>(A_start &gt;= A.length)&#123;</div><div class="line">    	<span class="keyword">return</span> B[B_start + k - <span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(B_start &gt;= B.length)&#123;</div><div class="line">    	<span class="keyword">return</span> A[A_start + k - <span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// é€’å½’å‡ºå£</span></div><div class="line">    <span class="keyword">if</span>( k == <span class="number">1</span>)&#123;</div><div class="line">    	<span class="keyword">return</span> Math.min(A[A,start], B_[B_start]);</div><div class="line">    &#125;</div><div class="line">	</div><div class="line">	<span class="comment">// æ‹¿åˆ°Aå’ŒBçš„ç¬¬k/2å¤§çš„æ•°</span></div><div class="line">	<span class="comment">// éªšæ“ä½œï¼šå¦‚æœæº¢å‡ºäº†ï¼Œå°±ç»™ä¸€ä¸ªMAX_VALUE,æŠŠæœºä¼šè‡ªåŠ¨è®©ç»™å¦å¤–ä¸€ä¸ª</span></div><div class="line">	<span class="keyword">int</span> A_key = A_start + k/<span class="number">2</span> &lt;= A.length ? A[A_start + k/<span class="number">2</span> - <span class="number">1</span>] : Interger.MAX_VALUE;</div><div class="line">	<span class="keyword">int</span> B_key = B_start + k/<span class="number">2</span> &lt;= B.length ? B[B_start + k/<span class="number">2</span> - <span class="number">1</span>] : Interger.MAX_VALUE;</div><div class="line">	</div><div class="line">    <span class="keyword">if</span>(A_key &lt; B_key)&#123;</div><div class="line">    	<span class="keyword">return</span> findKth(A, start + k/<span class="number">2</span>, B, B_start, k - k/<span class="number">2</span>);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> findKth(A, start, B, B_start + k/<span class="number">2</span>, k - k/<span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">è¿™é“é¢˜åœ¨äºŒåˆ†æ³•é‡Œé¢è®²è¿‡äº†</div><div class="line"></div><div class="line">äºŒåˆ·ï¼</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findKth</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> A_start, <span class="keyword">int</span>[] B, <span class="keyword">int</span> B_start, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(A_start &gt;= A.length)&#123;</div><div class="line">            <span class="keyword">return</span> B[B_start + k];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(B_start &gt;= B.length)&#123;</div><div class="line">            <span class="keyword">return</span> A[A_start + k];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">0</span>) <span class="keyword">return</span> Math.min(A[A_start],B[B_start]);</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(A[A_start] &gt; B[B_start])&#123;</div><div class="line">                <span class="keyword">return</span> findKth(A,A_start,B,B_start+<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> findKth(A,A_start+<span class="number">1</span>,B,B_start,<span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(A_start + k/<span class="number">2</span> &gt;= A.length)&#123;</div><div class="line">            <span class="keyword">if</span>(A[A.length - <span class="number">1</span>] &gt; B[B_start + k/<span class="number">2</span>])&#123;</div><div class="line">                <span class="keyword">return</span> findKth(A,A_start,B,B_start + k/<span class="number">2</span>, k - k/<span class="number">2</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                k -= A.length - A_start;</div><div class="line">                <span class="keyword">return</span> findKth(A,A.length,B,B_start,k);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(B_start + k/<span class="number">2</span> &gt;= B.length)&#123;</div><div class="line">            <span class="keyword">if</span>(B[B.length - <span class="number">1</span>] &gt; A[A_start + k/<span class="number">2</span>])&#123;</div><div class="line">                <span class="keyword">return</span> findKth(A,A_start + k/<span class="number">2</span>,B,B_start, k - k/<span class="number">2</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                k -= B.length - B_start;</div><div class="line">                <span class="keyword">return</span> findKth(A,A_start,B,B.length,k);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(A[A_start + k/<span class="number">2</span>] &gt; B[B_start + k/<span class="number">2</span>])&#123;</div><div class="line">            <span class="keyword">return</span> findKth(A,A_start,B,B_start + k/<span class="number">2</span>, k - k/<span class="number">2</span>);</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> findKth(A,A_start + k/<span class="number">2</span>,B,B_start, k - k/<span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums1.length == <span class="number">0</span> &amp;&amp; nums2.length == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> total = nums1.length + nums2.length;</div><div class="line">        <span class="keyword">if</span>(total%<span class="number">2</span> == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">double</span> a = findKth(nums1,<span class="number">0</span>,nums2,<span class="number">0</span>,total/<span class="number">2</span> - <span class="number">1</span>);</div><div class="line">            <span class="keyword">double</span> b = findKth(nums1,<span class="number">0</span>,nums2,<span class="number">0</span>,total/<span class="number">2</span> );</div><div class="line">            <span class="keyword">return</span> (a + b)/<span class="number">2</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> findKth(nums1,<span class="number">0</span>,nums2,<span class="number">0</span>,total/<span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Find-the-Duplicate-Number">2.8. Find the Duplicate Number</h2><p>ç»™n+1ä¸ªæ•°ï¼Œæ•°çš„å€¼ä¸º1~nã€‚æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ•°æœ‰é‡å¤ã€‚è¿”å›è¿™ä¸ªé‡å¤çš„æ•°ã€‚</p>
<p>æ€è·¯ï¼šåˆ©ç”¨ä¸‹æ ‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt;= <span class="number">0</span>)<span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> idx;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            idx = Math.abs(nums[i]);</div><div class="line">            <span class="keyword">if</span>(nums[idx] &lt; <span class="number">0</span>)<span class="keyword">return</span> idx;</div><div class="line">            nums[idx] = -nums[idx];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Remove-Duplicates-from-Sorted-Array-II">2.9. Remove Duplicates from Sorted Array II</h2><p>ä»æ•°ç»„ä¸­å»é™¤é‡å¤æ¬¡æ•°å¤§äº2çš„æ•°å­—ï¼Œå¹¶è¿”å›å»é‡åçš„é•¿åº¦</p>
<p>è¾¹ç•Œæ¡ä»¶å•Šï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(nums.length &lt;= <span class="number">2</span>) <span class="keyword">return</span> nums.length;</div><div class="line">    <span class="keyword">int</span> last = nums[<span class="number">0</span>];</div><div class="line">    <span class="keyword">int</span> lastCounter = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> length = nums.length;</div><div class="line">    <span class="keyword">int</span> step = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(nums[i] == last)&#123;</div><div class="line">            ++lastCounter;</div><div class="line">            <span class="keyword">if</span>(lastCounter &gt; <span class="number">2</span>)&#123;</div><div class="line">                ++step;</div><div class="line">                --length;</div><div class="line">                --i;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            last = nums[i];</div><div class="line">            lastCounter = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(i + <span class="number">1</span> + step &gt;= nums.length) <span class="keyword">break</span>;</div><div class="line">        nums[i + <span class="number">1</span>] = nums[i + <span class="number">1</span> + step];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> length;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å¿«æ…¢æŒ‡é’ˆï¼éªšæ“ä½œ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> fast -- ç¬¬ä¸€ä¸ªæ–°çš„æ•°å­—</div><div class="line"> slow -- ä¹‹å‰éƒ½æ˜¯å»é‡äº†çš„</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length &lt;= <span class="number">2</span>) &#123;</div><div class="line">            <span class="keyword">return</span> nums.length;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> slow = <span class="number">2</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> fast = <span class="number">2</span>; fast &lt; nums.length; fast++) &#123;</div><div class="line">            <span class="keyword">if</span>(nums[fast] != nums[slow-<span class="number">2</span>]) &#123;</div><div class="line">                nums[slow++] = nums[fast];</div><div class="line">            &#125;<span class="comment">// å½“nums[fast]é‡å¤æ—¶ï¼Œå°±è·³è¿‡nums[fast]</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> slow;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å­æ•°ç»„é—®é¢˜">3. å­æ•°ç»„é—®é¢˜</h1><h2 id="ä¾‹é¢˜7ï¼ŒMaximum-Subarray">3.1. ä¾‹é¢˜7ï¼ŒMaximum Subarray</h2><p>æ±‚ä¸€ä¸ªæ•°ç»„çš„æœ€å¤§çš„è¿ç»­å­æ•°ç»„å’Œã€‚</p>
<p>è½¬åŒ–ï¼šå‰ç¼€å’Œã€‚æœ€å¤§å­æ•°ç»„å°±æ˜¯è‚¡ç¥¨é—®é¢˜ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">sum[i] = sum(nums[<span class="number">0</span> ~ i])</div><div class="line">  </div><div class="line">sum[i~j] = sum[j] - sum[i]</div><div class="line"></div><div class="line">å‚è€ƒç¨‹åºï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] A)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(A == <span class="keyword">null</span> || A.length == <span class="number">0</span>)&#123;</div><div class="line">  	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> max = Integer.MIN_VALUE, sum = <span class="number">0</span>, minSum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.length; i++)&#123;</div><div class="line">  	sum += A[i]; <span class="comment">// sumå°±æ˜¯å‰ç¼€å’Œ</span></div><div class="line">  	max = Math.max(max, sum - minSum);</div><div class="line">  	minSum = Math.min(minSum, sum); <span class="comment">// minSumå°±æ˜¯å½“å‰iä¹‹å‰æœ€å°çš„å‰ç¼€å’Œ</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> max;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">è‡ªå·±çš„å¦ä¸€ç§æ€è·¯ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> maxLast = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; nums.length ; ++i)&#123;</div><div class="line">            maxLast = Math.max(maxLast + nums[i],nums[i]);</div><div class="line">            max = Math.max(maxLast,max);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜8ï¼ŒäºŒç»´æ•°ç»„çš„Maximum-Subarray">3.2. ä¾‹é¢˜8ï¼ŒäºŒç»´æ•°ç»„çš„Maximum Subarray</h2><p>å‰ç¼€å’Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">  i-<span class="number">1</span>  i           x</div><div class="line">   *---*---*---*---*</div><div class="line">   |   |   |   |   |</div><div class="line">j-<span class="number">1</span>*---*---*---*---*</div><div class="line">   |   |   |   |   |</div><div class="line"> j *-[i,j]-*---*---*</div><div class="line">   |   |   |   |   |</div><div class="line">   *---*---*---*---*</div><div class="line">   |   |   |   |   |</div><div class="line">y  *---*---*---*-[x,y]</div><div class="line"></div><div class="line"></div><div class="line">sum[i,j - x,y] = sum[x,y] - sum[x,j-<span class="number">1</span>] - sum[i-<span class="number">1</span>,y] + sum[i-<span class="number">1</span>,j-<span class="number">1</span>]</div></pre></td></tr></table></figure>
<h2 id="Range-Sum-Query-2D-Immutable">3.3. Range Sum Query 2D - Immutable</h2><p>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå®šä¹‰(row1,col1)åˆ°(row2,col2)çš„çŸ©é˜µçš„å’Œæ—¶sumRegion(row1,col1,row2,col2);æ±‚ä»»æ„çš„ä¸¤ç‚¹ä¹‹é—´çš„å’Œã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-16-59-04.png" alt=""> </p>
<p>æ ·ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Given matrix = [</div><div class="line">  [3, 0, 1, 4, 2],</div><div class="line">  [5, 6, 3, 2, 1],</div><div class="line">  [1, 2, 0, 1, 5],</div><div class="line">  [4, 1, 0, 1, 7],</div><div class="line">  [1, 0, 3, 0, 5]</div><div class="line">]</div><div class="line"></div><div class="line">sumRegion(2, 1, 4, 3) -&gt; 8</div><div class="line">sumRegion(1, 1, 2, 2) -&gt; 11</div><div class="line">sumRegion(1, 2, 2, 4) -&gt; 12</div></pre></td></tr></table></figure>
<p>ä¸æ ·é¢˜æ€è·¯å·®ä¸å¤šã€‚å…ˆå°†sumå­˜ä¸‹æ¥ï¼Œç„¶åå†è®¡ç®—sumRegion</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumMatrix</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[][] matrix;</div><div class="line">    <span class="keyword">int</span>[][] sum;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">int</span> m;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NumMatrix</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">this</span>.matrix = matrix;</div><div class="line">        n = matrix.length;</div><div class="line">        m = matrix[<span class="number">0</span>].length;</div><div class="line">        sum = <span class="keyword">new</span> <span class="keyword">int</span>[n][m];</div><div class="line">        <span class="comment">// è¾¹ç•Œ</span></div><div class="line">        sum[<span class="number">0</span>][<span class="number">0</span>] = matrix[<span class="number">0</span>][<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            sum[i][<span class="number">0</span>] = sum[i-<span class="number">1</span>][<span class="number">0</span>] + matrix[i][<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; m; ++j)&#123;</div><div class="line">            sum[<span class="number">0</span>][j] = sum[<span class="number">0</span>][j-<span class="number">1</span>] + matrix[<span class="number">0</span>][j];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// è®¡ç®—</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; m; ++j)&#123;</div><div class="line">                sum[i][j] = sum[i-<span class="number">1</span>][j] + sum[i][j-<span class="number">1</span>] - sum[i-<span class="number">1</span>][j-<span class="number">1</span>] + matrix[i][j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sumRegion</span><span class="params">(<span class="keyword">int</span> row1, <span class="keyword">int</span> col1, <span class="keyword">int</span> row2, <span class="keyword">int</span> col2)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(row1 == <span class="number">0</span> &amp;&amp; col1 == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> sum[row2][col2] ;</div><div class="line">        <span class="keyword">if</span>(row1 == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> sum[row2][col2]  - sum[row2][col1 - <span class="number">1</span>] ;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(col1 == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> sum[row2][col2]  - sum[row1 - <span class="number">1</span>][col2] ;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum[row2][col2] - sum[row1 - <span class="number">1</span>][col2] - sum[row2][col1 - <span class="number">1</span>] + sum[row1-<span class="number">1</span>][col1-<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Range-Sum-Query-2D-Mutable">3.4. Range Sum Query 2D - Mutable</h2><p>å°†ä¸Šä¸€é¢˜åŠ ä¸€ä¸ªæ¡ä»¶ï¼Œéšæ—¶éƒ½æœ‰å¯èƒ½æ”¹å˜matrixä¸­çš„æŸä¸ªå€¼ã€‚</p>
<p>æˆ‘ä»¬åªéœ€è¦åŠ ä¸€ä¸ª<code>public void update(int row, int col, int val)</code>å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> col, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> cha = val - matrix[row][col] ;</div><div class="line">        <span class="keyword">if</span>(cha == <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        matrix[row][col] = val;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = row ; i &lt; n; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = col; j &lt; m; ++j)&#123;</div><div class="line">                sum[i][j] += cha;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜10ï¼ŒMinimum-Subarray">3.5. ä¾‹é¢˜10ï¼ŒMinimum Subarray</h2><p>æœ€å°å­æ•°ç»„</p>
<p>è½¬åŒ–ï¼šå°†æ‰€æœ‰æ•°å­—å–ç›¸åæ•°ï¼Œå–æœ€å¤§å³å¯</p>
<h2 id="Minimum-Size-Subarray-Sum">3.6. Minimum Size Subarray Sum</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªsï¼Œæ±‚è¿ç»­å­æ•°ç»„å’Œå¤§äºç­‰äºçš„æœ€å°é•¿åº¦</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">æˆ‘çš„æ€è·¯ï¼š</div><div class="line"></div><div class="line"><span class="number">0</span>,<span class="number">1</span>,....,i,...,j</div><div class="line"></div><div class="line">å¯¹äºæ¯ä¸ªjï¼Œä»jåˆ°<span class="number">0</span>éå†iï¼Œå½“i-jçš„å’Œå¤§äºç­‰äºsæ—¶ï¼Œå½“å‰é•¿åº¦ä¸ºj-iï¼Œä¸å…¨å±€æœ€å°é•¿åº¦ä½œæ¯”è¾ƒï¼Œå–æœ€å°å€¼ã€‚</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            nums[i] = nums[i-<span class="number">1</span>] + nums[i];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// nums[i]è¡¨ç¤º[0,i-1]çš„å’Œ  </span></div><div class="line">        <span class="keyword">int</span> minLen = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i]  &gt;= s)&#123;</div><div class="line">                minLen = Math.min(i + <span class="number">1</span>, minLen);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i - <span class="number">1</span>; j&gt;= <span class="number">0</span>; --j)&#123;</div><div class="line">                <span class="keyword">if</span>(nums[i] - nums[j] &gt;= s)&#123;</div><div class="line">                    minLen = Math.min(minLen, i - j);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="number">0</span> : minLen;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œè¿™ç§æ–¹å¼å¾ˆæ…¢ï¼Œå¤æ‚åº¦å¤§çº¦ä¸º$O(n^2)$</p>
<p>ä¸Šé¢è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªäºŒåˆ†æ³•çš„ä¼˜åŒ–ï¼Œå¤æ‚åº¦ä¸º$O(nlogn)$</p>
<p>ä»¥ä¸Šä»£ç ä¸­ï¼Œ<code>nums[i]</code>è¡¨ç¤º<code>[0,i-1]</code>çš„å’Œã€‚è€ŒåŸnumséƒ½æ˜¯æ­£æ•°ï¼Œå› æ­¤numsæ˜¯é€’å¢çš„ã€‚å¯¹äºæ¯ä¸€ä¸ªiï¼Œç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æ‰¾åˆ°å­æ•°ç»„çš„å³è¾¹ç•Œjçš„ä½ç½®ï¼Œä½¿å­æ•°ç»„<code>[i,j]</code>ä¹‹å’Œå¤§äº sï¼Œç„¶åæˆ‘ä»¬æ›´æ–°æœ€çŸ­é•¿åº¦çš„è·ç¦»å³å¯</p>
<p>ç„¶è€Œï¼Œé‡ç‚¹åœ¨äº<code>sum[i,j] = nums[j]-nums[i-1]</code>ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å·§å¦™çš„æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nums[j] - nums[i - <span class="number">1</span>] &gt;= s</div><div class="line">          â†“ å˜ä¸º</div><div class="line">nums[j] &gt;= s + nums[i-<span class="number">1</span>]</div></pre></td></tr></table></figure>
<p>å³ï¼Œåªéœ€è¦æ‰¾ä¸€ä¸ª<code>nums[j]</code>ï¼Œä½¿å¾—å®ƒå¤§äºç­‰äº<code>s+nums[i-1]</code>å³å¯ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] nums;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            nums[i] = nums[i-<span class="number">1</span>] + nums[i];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// nums[i]è¡¨ç¤º[0,i-1]çš„å’Œ</span></div><div class="line">        <span class="keyword">this</span>.nums = nums;</div><div class="line">        <span class="comment">// sum[x,y] = nums[y] - nums[x-1]</span></div><div class="line"></div><div class="line">        <span class="keyword">int</span> minLen = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="comment">// æ‰¾ä¸€ä¸ªnums[j]ï¼Œä½¿å¾—å®ƒå¤§äºç­‰äºs+nums[i-1]</span></div><div class="line">            <span class="keyword">int</span> j = bitSearch(nums,i,nums.length - <span class="number">1</span>, s + getNums(i-<span class="number">1</span>));</div><div class="line">            minLen = Math.min(minLen, j - i + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="number">0</span> : minLen;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getNums</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(i == -<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> nums[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">bitSearch</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">        <span class="comment">// å¯»æ‰¾nums[i]ï¼Œä½¿å®ƒå¤§äºtarget</span></div><div class="line">        <span class="keyword">while</span> (start + <span class="number">1</span> &lt; end)&#123;</div><div class="line">            <span class="keyword">int</span> mid = start + (end - start)/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>(getNums(mid) &gt;= target)&#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(getNums(start) &gt;= target) <span class="keyword">return</span> start;</div><div class="line">        <span class="keyword">if</span>(getNums(end) &gt;= target) <span class="keyword">return</span> end;</div><div class="line">        <span class="keyword">return</span> Integer.MAX_VALUE;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å±…ç„¶è¿˜æœ‰æ›´éªšçš„æ“ä½œï¼šæ»‘åŠ¨çª—å£è§£æ³•ï¼Œå¤æ‚åº¦ä¸º$O(n)$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> minLen = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> windowSum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (j &lt; nums.length)&#123;</div><div class="line">            <span class="keyword">while</span>(j &lt; nums.length &amp;&amp; windowSum &lt; s)&#123;</div><div class="line">                windowSum += nums[j];</div><div class="line">                ++j;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (i &lt; j &amp;&amp; s &gt;= windowSum)&#123;</div><div class="line">                minLen = Math.min(minLen, j - i + <span class="number">1</span>);</div><div class="line">                windowSum -= nums[i];</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> minLen == nums.length + <span class="number">1</span> ? <span class="number">0</span> : minLen;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜11ï¼ŒMaximum-Subarray-II">3.7. ä¾‹é¢˜11ï¼ŒMaximum Subarray II</h2><p>æ±‚ä¸¤ä¸ªä¸é‡å å­æ•°ç»„ï¼Œä½¿ä»–ä»¬å’Œæœ€å¤§</p>
<p>æ€è·¯ï¼šä¸€æ¡åˆ†å‰²çº¿ï¼Œæ±‚å·¦å³çš„æœ€å¤§maxSubï¼Œç„¶åç›¸åŠ ã€‚ç„¶åæ±‚å…¨å±€çš„æœ€å¤§ã€‚</p>
<p>ä¼˜åŒ–ï¼šç§»åŠ¨çš„æ—¶å€™ï¼Œå·¦è¾¹çš„maxArrayå¹¶ä¸éœ€è¦é‡æ–°è®¡ç®—ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxTwoSubArrays</span><span class="params">(List&lt;Integer&gt; nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == nums)<span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> n = nums.size();</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> nums.get(<span class="number">0</span>);</div><div class="line">        <span class="keyword">int</span>[] maxBefore = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        maxBefore[<span class="number">0</span>] = nums.get(<span class="number">0</span>);</div><div class="line">        <span class="keyword">int</span> lastMax = maxBefore[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            <span class="comment">// è®¡ç®—[0,i]çš„æœ€å¤§å’Œ</span></div><div class="line">            lastMax = Math.max(lastMax + nums.get(i), nums.get(i));</div><div class="line">            maxBefore[i] = Math.max(maxBefore[i-<span class="number">1</span>],lastMax);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] maxAfter = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        maxAfter[n-<span class="number">1</span>] = nums.get(n-<span class="number">1</span>);</div><div class="line">        lastMax = maxAfter[n-<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span> ; --i)&#123;</div><div class="line">            <span class="comment">// è®¡ç®—[i,n]çš„æœ€å¤§å’Œ</span></div><div class="line">            lastMax = Math.max(lastMax + nums.get(i), nums.get(i));</div><div class="line">            maxAfter[i] = Math.max(maxAfter[i+<span class="number">1</span>],lastMax);</div><div class="line">        &#125;</div><div class="line">  		<span class="comment">// æ±‚å…¨å±€æœ€å¤§</span></div><div class="line">        <span class="keyword">int</span> max = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)&#123;</div><div class="line">            max = Math.max(max, maxBefore[i] + maxAfter[i+<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜12ï¼ŒMax-Subarray-Difference">3.8. ä¾‹é¢˜12ï¼ŒMax Subarray Difference</h2><p>æ±‚ä¸¤ä¸ªä¸é‡å å­æ•°ç»„ï¼Œä½¿ä»–ä»¬ç»å¯¹å€¼æœ€å¤§</p>
<p>ä¸ä¸Šä¸€é¢˜æ€è·¯ç›¸ä¼¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxDiffSubArrays</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        <span class="keyword">int</span>[] maxBefore = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        <span class="keyword">int</span>[] minBefore = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        maxBefore[<span class="number">0</span>] = nums[<span class="number">0</span>];</div><div class="line">        minBefore[<span class="number">0</span>] = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span> lastMax = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span> lastMin = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n ; ++i)&#123;</div><div class="line">            <span class="comment">// [0,i]çš„æœ€å¤§å’Œã€æœ€å°å’Œ</span></div><div class="line">            lastMax = Math.max(lastMax + nums[i], nums[i]);</div><div class="line">            lastMin = Math.min(lastMin + nums[i], nums[i]);</div><div class="line">            maxBefore[i] = Math.max(maxBefore[i-<span class="number">1</span>] , lastMax);</div><div class="line">            minBefore[i] = Math.min(minBefore[i-<span class="number">1</span>] , lastMin);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span>[] maxAfter = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        <span class="keyword">int</span>[] minAfter = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        maxAfter[n-<span class="number">1</span>] = nums[n-<span class="number">1</span>];</div><div class="line">        minAfter[n-<span class="number">1</span>] = nums[n-<span class="number">1</span>];</div><div class="line">        lastMax = nums[n-<span class="number">1</span>];</div><div class="line">        lastMin = nums[n-<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i)&#123;</div><div class="line">            <span class="comment">// [i,n]çš„æœ€å¤§å’Œã€æœ€å°å’Œ</span></div><div class="line">            lastMax = Math.max(lastMax + nums[i], nums[i]);</div><div class="line">            lastMin = Math.min(lastMin + nums[i], nums[i]);</div><div class="line">            maxAfter[i] = Math.max(maxAfter[i+<span class="number">1</span>] , lastMax);</div><div class="line">            minAfter[i] = Math.min(minAfter[i+<span class="number">1</span>] , lastMin);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// å…¨å±€æœ€å¤§å·®</span></div><div class="line">        <span class="keyword">int</span> max = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)&#123;</div><div class="line">            max = Math.max(max,</div><div class="line">                    Math.abs(maxBefore[i] - minAfter[i+<span class="number">1</span>]));</div><div class="line">            max = Math.max(max,</div><div class="line">                    Math.abs(minBefore[i] - maxAfter[i+<span class="number">1</span>]));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜13ï¼ŒSubarray-Sum">3.9. ä¾‹é¢˜13ï¼ŒSubarray Sum</h2><p>æ±‚ä¸€ä¸ªå­æ•°ç»„çš„å’Œä¸º0çš„å­æ•°ç»„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">ä¸€å¼€å§‹æ€è·¯å¾ˆæš´åŠ›ï¼Œå°±ç›´æ¥ç”¨å‰ç¼€æ•°ç»„æ¥æ±‚æ¯ä¸ªsum[i,j]ï¼Œç„¶åä¸<span class="number">0</span>æ¯”è¾ƒã€‚ç„¶è€Œï¼Œè¶…æ—¶äº†</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">subarraySum</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> result;</div><div class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>] == <span class="number">0</span>) &#123;</div><div class="line">            result.add(<span class="number">0</span>);result.add(<span class="number">0</span>);</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            nums[i] += nums[i-<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n-<span class="number">1</span>; i &gt;=<span class="number">0</span> ; --i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                result.add(<span class="number">0</span>);result.add(i);</div><div class="line">                <span class="keyword">return</span> result;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; n; ++j)&#123;</div><div class="line">                <span class="comment">// sum[i,j]</span></div><div class="line">                <span class="keyword">if</span>(nums[j] - nums[i-<span class="number">1</span>] == <span class="number">0</span>)&#123;</div><div class="line">                    result.add(i);</div><div class="line">                    result.add(j);</div><div class="line">                    <span class="keyword">return</span> result;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ”¹è¿›ï¼šå“ˆå¸Œè¡¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">æ ¹æ®ç»™çš„ä¾‹å­ï¼š[-<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, -<span class="number">3</span>, <span class="number">4</span>]ï¼Œå…¶ç´¯åŠ å’Œ:</div><div class="line"></div><div class="line">nums [-<span class="number">3</span>, <span class="number">1</span>,  <span class="number">2</span>, -<span class="number">3</span>,  <span class="number">4</span>]</div><div class="line">      <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span></div><div class="line">sum [-<span class="number">3</span>ï¼Œ-<span class="number">2</span>ï¼Œ <span class="number">0</span>ï¼Œ -<span class="number">3</span>ï¼Œ <span class="number">1</span>]</div><div class="line">      i           j</div><div class="line"><span class="number">1</span>. i=<span class="number">2</span>å‡ºç°äº†ä¸€ä¸ªæ•°<span class="number">0</span> -&gt; sum[<span class="number">0</span>,i] = <span class="number">0</span>  ,æ˜¯ä¸€ä¸ªç­”æ¡ˆ</div><div class="line"></div><div class="line"><span class="number">2</span>. åŒæ—¶åœ¨i,jå‘ç°ä¸¤ä¸ª-<span class="number">3</span>   -&gt; sum[i+<span class="number">1</span>,j] = <span class="number">0</span> ,æ˜¯ä¸€ä¸ªç­”æ¡ˆ</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">subarraySum</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> result;</div><div class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>] == <span class="number">0</span>) &#123;</div><div class="line">            result.add(<span class="number">0</span>);result.add(<span class="number">0</span>);</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">        HashMap&lt;Integer,Integer&gt; set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        set.put(nums[<span class="number">0</span>],<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                result.add(i);result.add(i);</div><div class="line">                <span class="keyword">return</span> result;</div><div class="line">            &#125;</div><div class="line">            nums[i] += nums[i-<span class="number">1</span>];</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                result.add(<span class="number">0</span>);result.add(i);</div><div class="line">                <span class="keyword">return</span> result;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(set.containsKey(nums[i]))&#123;</div><div class="line">                result.add(set.get(nums[i]) + <span class="number">1</span>);</div><div class="line">                result.add(i);</div><div class="line">                <span class="keyword">return</span> result;</div><div class="line">            &#125;</div><div class="line">            set.put(nums[i],i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>##ä¾‹é¢˜14ï¼Œ Subarray Sum Closest</p>
<p>æ±‚ä¸€ä¸ªæ•°ç»„çš„å­æ•°ç»„æœ€æ¥è¿‘0çš„å­æ•°ç»„</p>
<p>ä¸€å¼€å§‹æƒ³æ³•ä¾ç„¶å¾ˆæš´åŠ›ï¼Œä½†è¶…æ—¶äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] subarraySumClosest(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        <span class="keyword">int</span>[] ans = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">        <span class="keyword">int</span> min = Math.abs(nums[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> ans;</div><div class="line">        <span class="comment">// è®¡ç®—å‰ç¼€å’Œ</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            nums[i] += nums[i-<span class="number">1</span>];</div><div class="line">            <span class="comment">// [0,i]æ—¶</span></div><div class="line">            <span class="keyword">if</span>(Math.abs(nums[i]) &lt; min)&#123;</div><div class="line">                min = Math.abs(nums[i]);</div><div class="line">                ans[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">                ans[<span class="number">1</span>] = i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// è®¡ç®—</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</div><div class="line">            <span class="comment">// [i,j]æ—¶</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; n; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(Math.abs(nums[j] - nums[i-<span class="number">1</span>]) &lt; min)&#123;</div><div class="line">                    min = Math.abs(nums[j] - nums[i-<span class="number">1</span>]);</div><div class="line">                    ans[<span class="number">0</span>] = i;</div><div class="line">                    ans[<span class="number">1</span>] = j;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šå¯¹å‰ç¼€å’Œæ’åºï¼Œç„¶åfor</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PreSum</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">PreSum</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">int</span> sum;</div><div class="line">        <span class="keyword">int</span> idx;</div><div class="line">        PreSum(<span class="keyword">int</span> sum, <span class="keyword">int</span> idx)&#123;</div><div class="line">            <span class="keyword">this</span>.sum = sum;</div><div class="line">            <span class="keyword">this</span>.idx = idx;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(PreSum o)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.sum - o.sum;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] subarraySumClosest(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        <span class="keyword">int</span> n = nums.length;</div><div class="line">        <span class="keyword">int</span>[] ans = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">        PreSum[] preSum = <span class="keyword">new</span> PreSum[n]; <span class="comment">// å­˜æ”¾å‰ç¼€å’Œ</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> ans;</div><div class="line">        <span class="comment">// è®¡ç®—å‰ç¼€å’Œ</span></div><div class="line">        <span class="keyword">int</span> sum = nums[<span class="number">0</span>];</div><div class="line">        preSum[<span class="number">0</span>] = <span class="keyword">new</span> PreSum(sum,<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</div><div class="line">            sum += nums[i];</div><div class="line">            preSum[i] = <span class="keyword">new</span> PreSum(sum,i);</div><div class="line">        &#125;</div><div class="line">        Arrays.sort(preSum);</div><div class="line">        <span class="keyword">int</span> min = Math.abs(nums[<span class="number">0</span>]);</div><div class="line">        <span class="comment">//ans[0] = 0;ans[1] = 0;</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(min &gt; preSum[i].sum - preSum[i-<span class="number">1</span>].sum)&#123;</div><div class="line">                min = preSum[i].sum - preSum[i-<span class="number">1</span>].sum;</div><div class="line">                ans[<span class="number">0</span>] = preSum[i-<span class="number">1</span>].idx;</div><div class="line">                ans[<span class="number">1</span>] = preSum[i].idx;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å°†idxå¤§çš„æ”¾åé¢ï¼Œå°çš„æ”¾å‰é¢</span></div><div class="line">        <span class="keyword">if</span>(ans[<span class="number">0</span>] &gt; ans[<span class="number">1</span>])&#123;</div><div class="line">            <span class="keyword">int</span> temp = ans[<span class="number">0</span>];</div><div class="line">            ans[<span class="number">0</span>] = ans[<span class="number">1</span>];</div><div class="line">            ans[<span class="number">1</span>] = temp;</div><div class="line">        &#125;</div><div class="line">        ans[<span class="number">0</span>] += <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Contiguous-Array">3.10. Contiguous Array</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ æ˜¯1æˆ–0ã€‚æ±‚å­æ•°ç»„çš„æœ€å¤§é•¿åº¦ã€‚è¦æ±‚å­æ•°ç»„çš„1å’Œ0ä¸ªæ•°ç›¸ç­‰ã€‚</p>
<p>æ€è·¯ä¸€ï¼šï¼ˆä¼šè¶…memory)</p>
<p>å¦‚æœ[i,j]çš„1å’Œ0ä¸ªæ•°ç›¸ç­‰ï¼Œåˆ™sum(i,j) *2 = j - i +1</p>
<p> ç”¨<code>dp[i][j]</code>å­˜å‚¨å­æ•°ç»„<code>[i,j]</code>æ˜¯å¦æ˜¯1å’Œ0ä¸ªæ•°ç›¸ç­‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[][] dp;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] nums,<span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(end == start) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(dp[start][end] != <span class="number">0</span>) <span class="keyword">return</span> dp[start][end];</div><div class="line">        <span class="keyword">int</span> sum; <span class="comment">// sum[start,end]</span></div><div class="line">        <span class="keyword">if</span>(start == <span class="number">0</span>)&#123;</div><div class="line">            sum = nums[end];</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            sum = nums[end] - nums[start - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> n = end - start + <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">0</span> &amp;&amp; sum*<span class="number">2</span> == n)&#123;</div><div class="line">            dp[start][end] = n;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            dp[start][end] = Math.max(find(nums,start+<span class="number">1</span>,end),</div><div class="line">                    find(nums,start,end-<span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[start][end];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMaxLength</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length][nums.length];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            nums[i] += nums[i-<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> find(nums,<span class="number">0</span>,nums.length - <span class="number">1</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯äºŒï¼Œéªšæ“ä½œï¼š</p>
<p>å°†0æ›¿æ¢ä¸º-1.é‚£è¿™é“é¢˜å°±è½¬åŒ–ä¸ºäº†æ±‚æœ€é•¿å­æ•°ç»„ï¼Œå­æ•°ç»„å’Œä¸º0ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMaxLength</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)nums[i] = -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        HashMap&lt;Integer,Integer&gt; hash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> maxLenth = <span class="number">0</span>;</div><div class="line">        hash.put(<span class="number">0</span>,-<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            sum += nums[i];</div><div class="line">            <span class="keyword">if</span>(hash.containsKey(sum))&#123;</div><div class="line">                maxLenth = Math.max(maxLenth,</div><div class="line">                        Math.abs(i - hash.get(sum)));</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">              <span class="comment">// æ³¨æ„è¿™é‡Œï¼Œåªæœ‰ä¸å­˜åœ¨æ—¶æ‰æ·»åŠ ï¼ˆå› ä¸ºè¦ä¿ç•™ç¬¬ä¸€ä¸ªidxï¼‰</span></div><div class="line">                hash.put(sum, i);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> maxLenth;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Longest-Continuous-Increasing-Subsequence">3.11. Longest Continuous Increasing Subsequence</h2><p>æ±‚æ•°ç»„çš„æœ€é•¿è¿ç»­é€’å¢å­æ•°ç»„</p>
<p>æ€è·¯ï¼šç°å¸¸ç®€å•ï¼Œç›´æ¥éå†å°±å¥½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLengthOfLCIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == nums || nums.length == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> curr = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] &gt; nums[i-<span class="number">1</span>])&#123;</div><div class="line">                ++curr;</div><div class="line">                max = Math.max(max,curr);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                curr = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Degree-of-an-Array">3.12. Degree of an Array</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚æœ€å¤šå‡ºç°çš„é‚£ä¸ªå…ƒç´ çš„æœ€çŸ­è¿ç»­å­æ•°ç»„ã€‚</p>
<p>æ€è·¯ï¼šå»ºç«‹ä¸€ä¸ªNodeï¼Œå…¶ä¸­å­˜æ¯ä¸ªå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€å‡ºç°æ¬¡æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> idx0;<span class="comment">// ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span></div><div class="line">        <span class="keyword">int</span> idxn; <span class="comment">// æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</span></div><div class="line">        <span class="keyword">int</span> counter; <span class="comment">// å‡ºç°æ¬¡æ•°</span></div><div class="line">        Node(<span class="keyword">int</span> idx0)&#123;</div><div class="line">            <span class="keyword">this</span>.idx0 = idx0;</div><div class="line">            counter = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findShortestSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> nums.length;</div><div class="line">        HashMap&lt;Integer,Node&gt; hash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> maxCounter = <span class="number">1</span>; <span class="comment">// æœ€å¤šå‡ºç°çš„å…ƒç´ çš„å‡ºç°æ¬¡æ•°</span></div><div class="line">        <span class="keyword">int</span> minLength = Integer.MAX_VALUE; <span class="comment">// è¿”å›å€¼</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(hash.containsKey(nums[i]))&#123;</div><div class="line">                Node curr = hash.get(nums[i]);</div><div class="line">                curr.counter ++;</div><div class="line">                curr.idxn = i;</div><div class="line">                <span class="keyword">if</span>(curr.counter &gt; maxCounter)&#123;</div><div class="line">                    minLength = i - curr.idx0 + <span class="number">1</span>;</div><div class="line">                    maxCounter = curr.counter;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(curr.counter == maxCounter)&#123;</div><div class="line">                    minLength = Math.min(minLength,</div><div class="line">                            i - curr.idx0 + <span class="number">1</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                Node curr = <span class="keyword">new</span> Node(i);</div><div class="line">                hash.put(nums[i],curr);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> minLength == Integer.MAX_VALUE ? <span class="number">1</span> : minLength;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Maximum-Product-Subarray">3.13. Maximum Product Subarray</h2><p>æ±‚æ•°ç»„çš„æœ€å¤§å­æ•°ç»„ç§¯</p>
<p>æ€è·¯ä¸€ï¼šï¼ˆ<strong>æœ€åä¸€ä¸ªæ ·ä¾‹è¶…memoryäº†</strong>ï¼‰</p>
<p>æŒ‰ç…§è€æ–¹æ³•ï¼Œç”³è¯·ä¸€ä¸ªæ•°ç»„<code>prod[]</code>ï¼Œå…¶ä¸­<code>prod[i]</code>è¡¨ç¤º<code>[0,i]</code>çš„ä¹˜ç§¯ã€‚ä½†æ˜¯<code>[0,i]</code>ä¸­å¯èƒ½å­˜åœ¨0ï¼Œå› æ­¤ä¸å¤ªå¯è¡Œã€‚å˜åŒ–ä¸€ä¸‹æ–¹å¼ï¼Œå¦‚æœ<code>nums[k]==0</code>ï¼Œé‚£ä¹ˆ<code>prod[i] = [k+1,i]çš„ä¹˜ç§¯</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProduct</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">1</span>)<span class="keyword">return</span> nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span>[] prod = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">        prod[<span class="number">0</span>] = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                prod[i] = <span class="number">0</span>;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span>(prod[i-<span class="number">1</span>] == <span class="number">0</span> )&#123;</div><div class="line">                    prod[i]  = <span class="number">1</span> * nums[i];</div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    prod[i]  = prod[i-<span class="number">1</span>] * nums[i];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> max = prod[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                max = Math.max(<span class="number">0</span>,max);</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            max = Math.max(prod[i],max);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; nums.length; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(nums[j] ==<span class="number">0</span>)&#123;</div><div class="line">                    max = Math.max(<span class="number">0</span>,max);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(nums[i-<span class="number">1</span>] == <span class="number">0</span>)&#123;</div><div class="line">                    max = Math.max(prod[j],max);</div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    max = Math.max(prod[j]/prod[i-<span class="number">1</span>], max);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’ï¼Œå¯ä»¥è¯´æ˜¯ç›¸å½“æœºæ™ºäº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line">- ç”¨æ•°ç»„positive_max[i]ç»´æŠ¤åŸå§‹æ•°ç»„å‰iä¸ªæ•°çš„å­æ•°ç»„ä¹˜ç§¯ä¸­æ­£æ•°çš„æœ€å¤§å€¼</div><div class="line">- ç”¨æ•°ç»„negative_min[i]ç»´æŠ¤åŸå§‹æ•°ç»„å‰iä¸ªæ•°çš„å­æ•°ç»„ä¹˜ç§¯ä¸­è´Ÿæ•°çš„æœ€å°å€¼</div><div class="line"></div><div class="line">çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</div><div class="line"></div><div class="line"><span class="keyword">if</span> A[x] &gt; <span class="number">0</span>:</div><div class="line">	<span class="comment">// å¦‚æœpos_max[x-1] == 0,é‚£pos_max[x] = A[x]</span></div><div class="line">    <span class="comment">// å¦åˆ™ï¼Œpos_max[x] = positive_max[x - 1] * A[x]</span></div><div class="line">	positive_max[x] = max(positive_max[x - <span class="number">1</span>] * A[x], A[x])</div><div class="line">    <span class="comment">// å¦‚æœneg_min[x-1] == 0ï¼Œé‚£neg_min[x] = 0</span></div><div class="line">    <span class="comment">// å¦åˆ™ï¼Œneg_min = negative_min[x - 1] * A[x]</span></div><div class="line">	negative_min[x] = negative_min[x - <span class="number">1</span>] * A[x]</div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> A[x] &lt; <span class="number">0</span>:</div><div class="line">	positive_max[x] = negative_min[x - <span class="number">1</span>] * A[x]</div><div class="line">	negative_min[x] = min(positive_max[x - <span class="number">1</span>] * A[x], A[x])</div><div class="line">      </div><div class="line">      </div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProduct</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">1</span>)<span class="keyword">return</span> nums[<span class="number">0</span>];</div><div class="line"></div><div class="line">        <span class="keyword">int</span>[] pos_max = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">        <span class="keyword">int</span>[] neg_min = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>] &gt; <span class="number">0</span>)&#123;</div><div class="line">            pos_max[<span class="number">0</span>] = nums[<span class="number">0</span>];</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            neg_min[<span class="number">0</span>] = nums[<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> max = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] &gt; <span class="number">0</span>)&#123;</div><div class="line">                pos_max[i] = Math.max(pos_max[i-<span class="number">1</span>]*nums[i], nums[i]);</div><div class="line">                neg_min[i] = neg_min[i-<span class="number">1</span>] * nums[i];</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] &lt; <span class="number">0</span>)&#123;</div><div class="line">                pos_max[i] = neg_min[i-<span class="number">1</span>] * nums[i];</div><div class="line">                neg_min[i] = Math.min(pos_max[i-<span class="number">1</span>]*nums[i],nums[i]);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                pos_max[i] = <span class="number">0</span>;</div><div class="line">                neg_min[i] = <span class="number">0</span>;</div><div class="line">                max = Math.max(max, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(pos_max[i] &gt; <span class="number">0</span>)&#123;</div><div class="line">                max = Math.max(max, pos_max[i]);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line"></div><div class="line">å…¶å®æˆ‘ä»¬å¯ä»¥ç”¨æ›´ç®€ä¾¿çš„æ–¹å¼ï¼Œå°†Pos_max ä¸ neg_min å‹ç¼©ï¼š</div><div class="line"></div><div class="line">æˆ‘ä»¬åªéœ€è¦åœ¨ç»´æŠ¤ä¸€ä¸ªå±€éƒ¨æœ€å¤§çš„åŒæ—¶ï¼Œåœ¨ç»´æŠ¤ä¸€ä¸ªå±€éƒ¨æœ€å°ï¼Œè¿™æ ·å¦‚æœä¸‹ä¸€ä¸ªå…ƒç´ é‡åˆ°è´Ÿæ•°æ—¶ï¼Œå°±æœ‰å¯èƒ½ä¸è¿™ä¸ªæœ€å°ç›¸ä¹˜å¾—åˆ°å½“å‰æœ€å¤§çš„ä¹˜ç§¯å’Œï¼Œè¿™ä¹Ÿæ˜¯åˆ©ç”¨ä¹˜æ³•çš„æ€§è´¨å¾—åˆ°çš„ã€‚</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProduct</span><span class="params">(<span class="keyword">int</span>[] A)</span> </span>&#123;  </div><div class="line">    <span class="keyword">if</span>(A==<span class="keyword">null</span> || A.length==<span class="number">0</span>)  </div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">    <span class="keyword">if</span>(A.length == <span class="number">1</span>)  </div><div class="line">        <span class="keyword">return</span> A[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">int</span> max_local = A[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">int</span> min_local = A[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">int</span> global = A[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.length;i++)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">int</span> max_copy = max_local;  </div><div class="line">        max_local = Math.max(Math.max(A[i]*max_local, A[i]), A[i]*min_local);  </div><div class="line">        min_local = Math.min(Math.min(A[i]*max_copy, A[i]), A[i]*min_local);  </div><div class="line">        global = Math.max(global, max_local);  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> global;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Product-of-Array-Except-Self">3.14. Product of Array Except Self</h2><p>ç»™ä¸€ä¸ªæ•°ã€‚ä»¤æ¯ä¸ªå…ƒç´ ç­‰äºé™¤äº†æœ¬å…ƒç´ çš„æ‰€æœ‰çš„ä¹˜ç§¯ã€‚æ±‚è¾“å‡ºã€‚</p>
<p>ä¸»è¦æ³¨æ„ï¼šä¸€æ—¦æœ¬ä½ä¸º0ï¼Œå°±ä¼šå½±å“åˆ°åé¢ï¼</p>
<p>æ€è·¯ä¸€ï¼šåŒæ—¶è€ƒè™‘ä¸€ä¸‹æœ‰å‡ ä¸ª0.</p>
<p>å¦‚æœåªæœ‰1ä¸ª0ï¼Œé‚£ä¹ˆåªæœ‰0ä½çš„å€¼ä¸ºå…¶å®ƒå…ƒç´ çš„ä¹˜ç§¯ã€‚å…¶å®ƒä½éƒ½ä¸º0.</p>
<p>å¦‚æœæœ‰å¤§äºç­‰äºä¸¤ä¸ª0ï¼Œé‚£æ¯ä¸€ä½éƒ½æ˜¯0.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] productExceptSelf(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        <span class="keyword">long</span> allProdcut = <span class="number">1L</span>;</div><div class="line">        <span class="keyword">int</span> zero = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                ++zero;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            allProdcut *= nums[i];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == <span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(zero == <span class="number">1</span>) nums[i] = (<span class="keyword">int</span>)allProdcut;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span> (zero &gt; <span class="number">0</span>) nums[i] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">else</span> nums[i] = (<span class="keyword">int</span>) allProdcut / nums[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> nums;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯äºŒï¼šéªšæ“ä½œ</p>
<p>æ•°ç»„çš„ä¹˜ç§¯ç”±å·¦è¾¹éƒ¨åˆ†çš„ä¹˜ç§¯å’Œå³è¾¹éƒ¨åˆ†çš„ä¹˜ç§¯ ä¹˜èµ·æ¥å¾—åˆ°ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n = nums.length;</div><div class="line"><span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line"><span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> res;</div><div class="line"></div><div class="line">res[<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">// è®°å½•æ¯ä¸ªå…ƒç´ å·¦è¾¹çš„ä¹˜ç§¯</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n; ++i)&#123;</div><div class="line">  res[i] = res[i - <span class="number">1</span>] * nums[i - <span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> r = <span class="number">1</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = n - <span class="number">2</span>; j &gt;= <span class="number">0</span>; --j)&#123;</div><div class="line">  r *= nums[j + <span class="number">1</span>]; <span class="comment">// jå³è¾¹çš„ä¹˜ç§¯</span></div><div class="line">  res[j] *= r; <span class="comment">// å·¦è¾¹ä¹˜ä»¥å³è¾¹</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> res;</div></pre></td></tr></table></figure>
<h2 id="Container-With-Most-Water">3.15. Container With Most Water</h2><p>ç»™ä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ï¼Œå…¶ä¸­å…ƒç´ ä»£è¡¨æŒ¡æ¿çš„é«˜åº¦ã€‚æ±‚æŸä¸¤ä¸ªæŒ¡æ¿ï¼Œä½¿æŒ¡æ¿ä¹‹é—´èƒ½å¤Ÿä¹˜çš„æ°´æœ€å¤šã€‚</p>
<p>æ€è·¯ï¼šè¿™é“é¢˜å…¶å®ç”¨äº†ä¸€ç‚¹è´ªå¿ƒçš„æ€è·¯ã€‚</p>
<p>æ€è€ƒå…¬å¼$min(a_i,a_j)\times(j-i)$ ã€‚è‹¥ a[l] &lt; a[r]ï¼Œåªèƒ½é€šè¿‡å¢åŠ äºŒè€…ä¸­è¾ƒå°çš„a[l]æ¥å¢åŠ é¢ç§¯ï¼Œå› ä¸ºj â€“ iå·²ç»æ˜¯ç›®å‰èƒ½è¾¾åˆ°çš„æœ€å¤§å€¼äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = height.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">            <span class="keyword">if</span>(height[low] &lt; height[high])&#123;</div><div class="line">                max = Math.max(max, height[low]*(high - low));</div><div class="line">                ++low;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                max = Math.max(max, height[high] * (high - low));</div><div class="line">                --high;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Array-Nesting">3.16. Array Nesting</h2><p>ç»™nä¸ªç‚¹ï¼Œæ•°ç»„çš„$A[i]$ è¡¨ç¤ºè¾¹$(i,A[i])$ã€‚ é—®æ­¤å›¾æœ€é•¿çš„ç¯æœ‰å¤šé•¿ã€‚</p>
<p>æ€è·¯ï¼šä¸€å¼€å§‹æ²¡æœ‰ç†æ¸…é¢˜æ„ã€‚å…¶å®è¿™é“é¢˜å¾ˆç®€å•å“‡ã€‚å“ã€‚</p>
<p>ç”¨$O(n)$çš„æ—¶é—´ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">arrayNesting</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> nums.length;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">int</span> idx = i;</div><div class="line">            <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (nums[idx] &gt;= <span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">int</span> idx_next = nums[idx];</div><div class="line">                nums[idx] = -<span class="number">1</span>; <span class="comment">// æ ‡è®°ä¸ºå·²è®¿é—®</span></div><div class="line">                idx = idx_next;</div><div class="line">                ++len;</div><div class="line">            &#125;</div><div class="line">            max = Math.max(max, len);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Find-Pivot-Index">3.17. Find Pivot Index</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ã€‚å¯»æ‰¾ä¸€ä¸ªidxï¼Œä½¿å¾—å®ƒå·¦è¾¹çš„å’Œç­‰äºå®ƒå³è¾¹çš„å’Œã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›-1ã€‚</p>
<p>æ€è·¯ï¼šä¸€ä¸ªä¸ªéå†æ±‚leftSumå’ŒrightSumå°±å¥½ã€‚</p>
<p>æ³¨æ„è¾¹ç•Œæ¡ä»¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pivotIndex</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(nums.length &lt;= <span class="number">3</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> rightSum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i) rightSum += nums[i];</div><div class="line">    <span class="keyword">if</span>(rightSum == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> leftSum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">1</span>; ++i)&#123;</div><div class="line">        leftSum += nums[i];</div><div class="line">        rightSum -= nums[i+<span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span>(leftSum == rightSum)&#123;</div><div class="line">            <span class="keyword">return</span> i+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="è‚¡ç¥¨é—®é¢˜">4. è‚¡ç¥¨é—®é¢˜</h1><h2 id="ä¾‹é¢˜9ï¼ŒBest-Time-to-Buy-and-Sell-Time">4.1. ä¾‹é¢˜9ï¼ŒBest Time to Buy and Sell Time</h2><p><strong>æ–¹æ¡ˆä¸€ï¼ŒåŠ¨æ€è§„åˆ’æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">åŠ¨æ€è§„åˆ’æ³•ã€‚ä»å‰å‘åéå†æ•°ç»„ï¼Œè®°å½•å½“å‰å‡ºç°è¿‡çš„æœ€ä½ä»·æ ¼ï¼Œä½œä¸ºä¹°å…¥ä»·æ ¼ï¼Œå¹¶è®¡ç®—ä»¥å½“å¤©ä»·æ ¼å‡ºå”®çš„æ”¶ç›Šï¼Œä½œä¸ºå¯èƒ½çš„æœ€å¤§æ”¶ç›Šï¼Œæ•´ä¸ªéå†è¿‡ç¨‹ä¸­ï¼Œå‡ºç°è¿‡çš„æœ€å¤§æ”¶ç›Šå°±æ˜¯æ‰€æ±‚</div><div class="line"></div><div class="line">sell[i]  ç¬¬iå¤©å–å‡ºèµšçš„æœ€å¤šçš„é’± = price[i] - min</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            min = Math.min(min, prices[i]);</div><div class="line">            max = Math.max(max, prices[i] - min);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è‚¡ç¥¨é—®é¢˜æ˜¯ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚æˆ‘å®åœ¨æ˜¯å¤ªç¬¨äº†ã€‚ç°åœ¨ç¿»è¯‘ä¸€ä¸‹å¤§ç¥çš„è§£ç­”å¥½äº†ã€‚</p>
<p><strong>æ–¹æ¡ˆäºŒï¼Œé€šç”¨è§£æ³•</strong></p>
<p>å®šä¹‰å¦‚ä¸‹ç¬¦å·ï¼š</p>
<ul>
<li><code>prices</code> é•¿åº¦ä¸º<code>n</code></li>
<li><code>k</code> ä»£è¡¨æœ€å¤§å…è®¸çš„ä¹°å…¥æ¬¡æ•°</li>
<li><code>T[i][k]</code> ï¼š åœ¨ç¬¬iå¤©ç»“æŸæ—¶ï¼Œé€šè¿‡è‡³å¤škæ¬¡äº¤æ˜“åï¼Œçš„æœ€å¤§åˆ©æ¶¦ã€‚</li>
</ul>
<p>å¾ˆå®¹æ˜“å¾—å‡ºåˆå§‹åŒ–<code>T[-1][k]=T[i][0]=0</code>ï¼ˆæ²¡æœ‰è‚¡ç¥¨æˆ–æ²¡æœ‰äº¤æ˜“æ—¶çš„åˆ©æ¶¦ï¼‰</p>
<p>åŒæ—¶ï¼Œç¬¬iå¤©éƒ½å¯ä»¥â€”â€”ä¹°å…¥ã€å–å‡ºã€ä¼‘æ¯ã€‚è€Œä¸”é¢˜ç›®è¦æ±‚ä¹°å…¥å’Œå–å‡ºä¸å¯ä»¥åœ¨åŒä¸€å¤©è¿›è¡Œï¼Œä¸”ä¸€å¤©æœ€å¤šåªå¯ä»¥æŒæœ‰ä¸€æ”¯è‚¡ç¥¨ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬åœ¨ç¬¬iå¤©ä¹°å…¥ï¼Œé‚£ä¹ˆè¿™ä¸€å¤©ä¹‹å‰åªèƒ½æœ‰0åªè‚¡ç¥¨ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç¬¬iå¤©å–å‡ºï¼Œé‚£è¿™ä¸€å¤©åªèƒ½æœ‰1åªè‚¡ç¥¨ã€‚å› æ­¤æˆ‘ä»¬å®šä¹‰ï¼š</p>
<ul>
<li><code>T[i][k][0]</code> ä¸ºç¬¬iå¤©é€šè¿‡è‡³å¤škæ¬¡äº¤æ˜“åï¼Œå½“å¤©æ²¡æœ‰è‚¡ç¥¨ï¼ˆä¿æŒåŸæ ·æˆ–å–å‡ºï¼‰çš„æœ€å¤§åˆ©æ¶¦</li>
<li><code>T[i][k][1]</code> ä¸ºç¬¬iå¤©é€šè¿‡è‡³å¤škæ¬¡äº¤æ˜“åï¼Œå½“å¤©æœ‰è‚¡ç¥¨ï¼ˆä¿æŒåŸæ ·æˆ–ä¹°å…¥ï¼‰çš„æœ€å¤§åˆ©æ¶¦</li>
</ul>
<p>å› æ­¤æˆ‘ä»¬å¾—åˆ°äº†åˆå§‹åŒ–æ–¹æ¡ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">T[-<span class="number">1</span>][k][<span class="number">0</span>] = T[i][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// ç¬¬-1å¤©æŒè‚¡0ï¼Œåˆ©æ¶¦ä¸º0 ; ç¬¬iå¤©0äº¤æ˜“0æŒè‚¡ï¼Œåˆ©æ¶¦ä¸º0</span></div><div class="line">T[-<span class="number">1</span>][k][<span class="number">1</span>] = T[i][<span class="number">0</span>][<span class="number">1</span>] = -Infinity <span class="comment">// ç¬¬-1å¤©æŒè‚¡1ï¼Œä¸å¯èƒ½ï¼Œåˆ©æ¶¦ä¸ºè´Ÿæ— ç©·ï¼›ç¬¬iå¤©äº¤æ˜“0æŒè‚¡1ï¼Œä¸å¯èƒ½ï¼Œåˆ©æ¶¦ä¸ºè´Ÿæ— ç©·</span></div></pre></td></tr></table></figure>
<p>é€’æ¨å…¬å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i]);</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prices.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span>[][][] maxProfits = <span class="keyword">new</span> <span class="keyword">int</span>[prices.length][<span class="number">2</span>][<span class="number">2</span>];</div><div class="line">        <span class="comment">// maxProfits[i][k][0] ï¼š åœ¨ç¬¬iå¤©,äº¤æ˜“kæ¬¡ï¼Œæ²¡æœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</span></div><div class="line">        <span class="comment">// maxProfits[i][k][1] :  åœ¨ç¬¬iå¤©äº¤æ˜“kæ¬¡ï¼Œæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</span></div><div class="line">        maxProfits[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        maxProfits[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = Integer.MIN_VALUE;</div><div class="line">        maxProfits[<span class="number">0</span>][<span class="number">1</span>][<span class="number">1</span>] = -prices[<span class="number">0</span>];</div><div class="line">        maxProfits[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>] = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            maxProfits[i][<span class="number">1</span>][<span class="number">0</span>] = Math.max(maxProfits[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], maxProfits[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] + prices[i]);</div><div class="line">            maxProfits[i][<span class="number">1</span>][<span class="number">1</span>] = Math.max(maxProfits[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], maxProfits[i-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] - prices[i]);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Math.max(maxProfits[prices.length - <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>],<span class="number">0</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œé€’æ¨å…¬å¼çš„ç¬¬äºŒä¸ªï¼š<code>maxProfits[i][1][1] = Math.max(maxProfits[i-1][1][1], maxProfits[i-1][0][0] - prices[i]);</code>ä¸­çš„<code>maxProfits[i-1][0][0]</code>æ’ä¸º0ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ä»£ç ç®€åŒ–ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> T_i10 = <span class="number">0</span>, T_i11 = Integer.MIN_VALUE;</div><div class="line">        </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</div><div class="line">        T_i10 = Math.max(T_i10, T_i11 + price);</div><div class="line">        T_i11 = Math.max(T_i11, -price);</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> T_i10;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Best-Time-to-Buy-and-Sell-Stock-II">4.2. Best Time to Buy and Sell Stock II</h2><p>å¦‚æœå¯ä»¥å…è®¸å¤šæ¬¡ä¹°å…¥å–å‡ºï¼Œä½†ä¸å¯ä»¥åŒä¸€å¤©ä¹°å–ã€‚æ±‚æœ€å¤§åˆ©æ¶¦ã€‚</p>
<p><strong>æ–¹æ¡ˆä¸€ï¼Œè´ªå©ªæ³•</strong></p>
<p>è¿™é“é¢˜æ²¡æœ‰äº¤æ˜“è´¹çš„é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ— è„‘è´ªå©ªå°±å¯ä»¥äº†ï¼Œè§åˆ°åˆ©æ¶¦å°±å¾€ä¸ŠåŠ </p>
<p>å“ï¼Œæ˜æ˜å¾ˆç®€å•çš„é¢˜ã€‚æ„Ÿè§‰è‡ªå·±å®›å¦‚æ™ºéšœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> total = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(prices[i] &gt; prices[i-<span class="number">1</span>])&#123;total += (prices[i] - prices[i-<span class="number">1</span>]);&#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> total;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ¡ˆäºŒï¼Œé€šç”¨æ³•</strong></p>
<p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ€è·¯ï¼Œæ­¤æ—¶kéšæ„äº†,ä¸”é€’æ¨å…¬å¼å˜æˆäº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i])</div><div class="line">           = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k][<span class="number">0</span>] - prices[i])</div><div class="line"></div><div class="line">å› ä¸ºT[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] == T[i-<span class="number">1</span>][k][<span class="number">0</span>] ï¼Œ å³ç¬¬i-<span class="number">1</span>å¤©æ—¶å¦‚æœä¸æŒè‚¡ï¼Œé‚£ä¹ˆk-<span class="number">1</span>æ¬¡äº¤æ˜“ä¸kæ¬¡äº¤æ˜“çš„æœ€å¤§åˆ©æ¶¦åº”è¯¥æ˜¯ä¸€æ ·çš„</div><div class="line"></div><div class="line">åæœŸæ’å…¥ï¼šæˆ‘çš„ç†è§£æ˜¯ï¼Œå¦‚æœè¿™ä¸€å¤©å…è®¸æ“ä½œk-<span class="number">1</span>æ¬¡æˆ–è€…kæ¬¡ï¼Œå…¶å®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å¤šå‡ºæ¥çš„ä¸€æ¬¡æ²¡ä»€ä¹ˆç”¨ï¼Œä¸è¶³ä»¥åœ¨ä¸€å¤©ä¹‹å†…å®Œæˆã€‚</div><div class="line"></div><div class="line">ä½†è¿™é‡Œæˆ‘ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆï¼ŒåŸä½œè€…æŒ‡å‡ºï¼š</div><div class="line"></div><div class="line"> Sorry <span class="keyword">for</span> the confusion. So there are two interpretations here. First from a mathematical point of view, limit(k) <span class="function">is the same as <span class="title">limit</span><span class="params">(k<span class="number">-1</span>)</span> when k approaches +infinity. Second, more relevant to <span class="keyword">this</span> problem, as I said <span class="keyword">for</span> the <span class="keyword">case</span> of arbitrary k, when k is sufficiently large, the maximum profits will on longer depend on k but be bound by the number of available stocks. This means <span class="keyword">if</span> k goes to +infinity, the profits won't change <span class="keyword">if</span> you increase or decrease the value of k, that is, T[i][k][0] will be the same as T[i][k-1][0] and T[i][k][1] the same as T[i][k-1][1]. Hope <span class="keyword">this</span> clarifies things a little bit.</span></div><div class="line"></div><div class="line">åç­‰å¼ æ€é¥çœ‹çœ‹å§</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(prices.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> T_ik0 = <span class="number">0</span>, T_ik1 = Integer.MIN_VALUE;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">        <span class="keyword">int</span> T_ik0_old = T_ik0;</div><div class="line">        T_ik0 = Math.max(T_ik0, T_ik1 + prices[i]);</div><div class="line">        T_ik1 = Math.max(T_ik1, T_ik0_old - prices[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> T_ik0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Best-Time-to-Buy-and-Sell-Stock-with-Transaction-Fee">4.3. Best Time to Buy and Sell Stock with Transaction Fee</h2><p>æ¥ä¸Šé¢˜ï¼Œå¦‚æœä¹°å‡ºæ—¶æœ‰ä¸€ä¸ªæ‰‹ç»­è´¹ã€‚æ±‚æœ€å¤§åˆ©æ¶¦ã€‚</p>
<p>è¿™é“é¢˜æ‹¿åˆ°ä¹‹åæ²¡æœ‰æ€è·¯ï¼Œå°±æ‡µäº†ã€‚çœ‹äº†è§£ç­”æ‰æ¨¡æ¨¡ç³Šç³ŠçŸ¥é“äº†ã€‚å…ˆæŠŠç­”æ¡ˆè®°ä¸‹æ¥å§ã€‚å“ã€‚éš¾å—ã€‚</p>
<p>è¿™é“é¢˜æœ‰äº†äº¤æ˜“è´¹ï¼Œæ‰€ä»¥å½“å–å‡ºçš„åˆ©æ¶¦å°äºäº¤æ˜“è´¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¸åº”è¯¥å–äº†ï¼Œä¸ç„¶äºäº†ã€‚</p>
<p><strong>é€šç”¨è§£æ³•</strong></p>
<p>é€’æ¨æ­¤æ—¶æœ‰ä¸¤ç§å†™æ³•ï¼Œè¦ä¹ˆäº¤æ˜“è´¹åœ¨ä¹°å…¥çš„æ—¶å€™æ”¶å–ï¼Œè¦ä¹ˆåœ¨å–å‡ºçš„æ—¶å€™æ”¶å–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">å–å‡ºçš„æ—¶å€™æ”¶å–</div><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i] - fee);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i]);</div><div class="line">  </div><div class="line">ä¹°å…¥çš„æ—¶å€™æ”¶å–</div><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i] - fee);</div><div class="line"></div><div class="line"></div><div class="line">è€Œ T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] == T[i-<span class="number">1</span>][k][<span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices, <span class="keyword">int</span> fee)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prices.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> T_ik0 = <span class="number">0</span>, T_ik1 = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            <span class="keyword">int</span> T_ik0_old = T_ik0;</div><div class="line">            T_ik0 = Math.max(T_ik0, T_ik1 + prices[i]);</div><div class="line">            T_ik1 = Math.max(T_ik1, T_ik0_old - prices[i] - fee);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> T_ik0;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>å¸¦ä¸€ç‚¹è´ªå¿ƒçš„æ€è·¯</strong></p>
<ul>
<li>è¯¥å¤©ç»“æŸåæ‰‹é‡Œæ²¡æœ‰è‚¡ç¥¨ã€‚å¯èƒ½æ˜¯ä¿æŒå‰ä¸€å¤©çš„çŠ¶æ€ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä»Šå¤©å–å‡ºäº†ã€‚ä»¤æ­¤æ—¶æ”¶ç›Šä¸ºcache</li>
<li>è¯¥å¤©ç»“æŸåæ‰‹é‡Œæœ‰è‚¡ç¥¨ã€‚å¯èƒ½æ˜¯ä¿æŒå‰ä¸€å¤©çš„çŠ¶æ€ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä»Šå¤©ä¹°å…¥äº†ã€‚ç”¨holdè¡¨ç¤º</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices, <span class="keyword">int</span> fee)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> sold = <span class="number">0</span>, hold = -prices[<span class="number">0</span>];</div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</div><div class="line">           <span class="keyword">int</span> t = sold;</div><div class="line">           sold = max(sold, hold + price - fee);</div><div class="line">           hold = max(hold, t - price);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> sold;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Best-Time-to-Buy-and-Sell-Stock-with-Cooldown">4.4. Best Time to Buy and Sell Stock with Cooldown</h2><p>å‡è®¾å¯ä»¥å¤šæ¬¡ä¹°å…¥å–å‡ºï¼Œä½†å–å‡ºä¹‹åå¿…é¡»ä¼‘æ¯ä¸€å¤©æ‰å¯ä»¥ç»§ç»­ä¹°å…¥</p>
<p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ€è·¯ï¼Œæ­¤æ—¶çš„è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">2</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i])</div><div class="line">           = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">2</span>][k][<span class="number">0</span>] - prices[i]);</div><div class="line"></div><div class="line">åŒæ—¶ T[i-<span class="number">2</span>][k-<span class="number">1</span>][<span class="number">0</span>] == T[i-<span class="number">2</span>][k][<span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prices.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">// i == 1æ—¶çš„åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">int</span> Tlastik_0 = <span class="number">0</span>, <span class="comment">// i == 0</span></div><div class="line">            Tlastik_1 = -prices[<span class="number">0</span>],<span class="comment">// i == 0</span></div><div class="line">            Tik_0 = <span class="number">0</span>, <span class="comment">// i == 1</span></div><div class="line">            Tik_1 = Math.max(Tlastik_1,-prices[<span class="number">1</span>]);<span class="comment">// i == 1</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            <span class="keyword">int</span> Tik_0_old = Tik_0,</div><div class="line">            Tik_1_old = Tik_1;</div><div class="line">            Tik_0 = Math.max(Tik_0, Tik_1 + prices[i]);</div><div class="line">            Tik_1 = Math.max(Tik_1, Tlastik_0 - prices[i]);</div><div class="line">            Tlastik_0 =Tik_0_old;</div><div class="line">            Tlastik_1 = Tik_1;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Math.max(Tik_0, Tik_1);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Best-Time-to-Buy-and-Sell-Stock-III">4.5. Best Time to Buy and Sell Stock III</h2><p>å¦‚æœå…è®¸æœ€å¤šäº¤æ˜“ä¸¤æ¬¡ã€‚é‚£ä¹ˆæ±‚æœ€å¤§åˆ©æ¶¦ã€‚</p>
<p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ€è·¯ï¼Œæ­¤æ—¶k &lt;= 2ï¼Œé‚£ä¹ˆé€’æ¨å…¬å¼ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">T[i][k][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">0</span>], T[i-<span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][k][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][k][<span class="number">1</span>], T[i-<span class="number">1</span>][k-<span class="number">1</span>][<span class="number">0</span>] - prices[i]);</div><div class="line"></div><div class="line">ç”±äº k &lt;= <span class="number">2</span>ï¼Œå› æ­¤</div><div class="line"></div><div class="line"><span class="keyword">if</span> k == <span class="number">0</span></div><div class="line">T[i][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span></div><div class="line">T[i][<span class="number">0</span>][<span class="number">1</span>] = -Inifity</div><div class="line"></div><div class="line"><span class="keyword">if</span> k == <span class="number">1</span></div><div class="line">T[i][<span class="number">1</span>][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], T[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][<span class="number">1</span>][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], T[i-<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] - prices[i]);</div><div class="line">           = max(T[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], <span class="number">0</span> - prices[i]);</div><div class="line"><span class="keyword">if</span> k == <span class="number">2</span></div><div class="line">T[i][<span class="number">2</span>][<span class="number">0</span>] = max(T[i-<span class="number">1</span>][<span class="number">2</span>][<span class="number">0</span>], T[i-<span class="number">1</span>][<span class="number">2</span>][<span class="number">1</span>] + prices[i]);</div><div class="line">T[i][<span class="number">2</span>][<span class="number">1</span>] = max(T[i-<span class="number">1</span>][<span class="number">2</span>][<span class="number">1</span>], T[i-<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] - prices[i]);</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prices.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">// i == -1æ—¶çš„åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">int</span> Ti_k0_0 = <span class="number">0</span>, <span class="comment">// k==0,ä¸æŒè‚¡</span></div><div class="line">        Ti_k0_1 = Integer.MIN_VALUE, <span class="comment">// k == 0,æŒè‚¡</span></div><div class="line"> </div><div class="line">        Ti_k1_0 = <span class="number">0</span>, <span class="comment">// k == 1,ä¸æŒè‚¡</span></div><div class="line">        Ti_k1_1 = Integer.MIN_VALUE, <span class="comment">// k == 1,æŒè‚¡</span></div><div class="line">        Ti_k2_0 = <span class="number">0</span>, <span class="comment">// k == 2,ä¸æŒè‚¡</span></div><div class="line">        Ti_k2_1 = Integer.MIN_VALUE; <span class="comment">// k == 2ï¼ŒæŒè‚¡</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            <span class="comment">// k == 0 ï¼Œå¯ä»¥çœç•¥ä¸å†™</span></div><div class="line">            <span class="comment">// Ti_k0_0 = 0;</span></div><div class="line">            <span class="comment">// Ti_k0_1 = Integer.MIN_VALUE;</span></div><div class="line">            <span class="comment">// k == 2</span></div><div class="line">            Ti_k2_0 = Math.max(Ti_k2_0, Ti_k2_1 + prices[i]);</div><div class="line">            Ti_k2_1 = Math.max(Ti_k2_1, Ti_k1_0 - prices[i]);</div><div class="line">            <span class="comment">// k == 1</span></div><div class="line">            Ti_k1_0 = Math.max(Ti_k1_0, Ti_k1_1 + prices[i]);</div><div class="line">            Ti_k1_1 = Math.max(Ti_k1_1, -prices[i]);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Math.max(Ti_k2_0, Math.max(Ti_k1_0, Ti_k0_0));</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶ä¹Ÿæœ‰å¦ä¸€ç§ç›¸ä¼¼çš„åˆå§‹åŒ–æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prices.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">// i == 0æ—¶çš„åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">int</span> Ti_k0_0 = <span class="number">0</span>, <span class="comment">// k==0,ä¸æŒè‚¡</span></div><div class="line">        Ti_k0_1 = Integer.MIN_VALUE, <span class="comment">// k == 0,æŒè‚¡</span></div><div class="line"></div><div class="line">        Ti_k1_0 = <span class="number">0</span>, <span class="comment">// k == 1,ä¸æŒè‚¡</span></div><div class="line">        Ti_k1_1 = -prices[<span class="number">0</span>], <span class="comment">// k == 1,æŒè‚¡</span></div><div class="line"></div><div class="line">        Ti_k2_0 = <span class="number">0</span>, <span class="comment">// k == 2,ä¸æŒè‚¡</span></div><div class="line">        Ti_k2_1 = -prices[<span class="number">0</span>]; <span class="comment">// k == 2ï¼ŒæŒè‚¡</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; ++i)&#123;</div><div class="line">            <span class="comment">// k == 0 ï¼Œå¯ä»¥çœç•¥ä¸å†™</span></div><div class="line">            <span class="comment">// Ti_k0_0 = 0;</span></div><div class="line">            <span class="comment">// Ti_k0_1 = Integer.MIN_VALUE;</span></div><div class="line">            <span class="comment">// k == 2</span></div><div class="line">            Ti_k2_0 = Math.max(Ti_k2_0, Ti_k2_1 + prices[i]);</div><div class="line">            Ti_k2_1 = Math.max(Ti_k2_1, Ti_k1_0 - prices[i]);</div><div class="line">            <span class="comment">// k == 1</span></div><div class="line">            Ti_k1_0 = Math.max(Ti_k1_0, Ti_k1_1 + prices[i]);</div><div class="line">            Ti_k1_1 = Math.max(Ti_k1_1, -prices[i]);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Math.max(Ti_k2_0, Math.max(Ti_k1_0, Ti_k0_0));</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="Two-Sumé—®é¢˜">5. Two Sumé—®é¢˜</h1><h2 id="ä¾‹é¢˜15ï¼ŒTwo-Sum">5.1. ä¾‹é¢˜15ï¼ŒTwo Sum</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚ä¸¤æ•°ä¹‹å’Œç­‰äºtargetçš„idxã€‚</p>
<p>æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p>
<p>ç©ºé—´$O(n)$</p>
<p>å¦‚æœä¸è¦æ±‚è¿”å›idxï¼Œåªè¿”å›æ•°å­—å‘¢ï¼Ÿ</p>
<p>ç©ºé—´$O(1)$ï¼Œæ—¶é—´$O(nlogn + n)$</p>
<ol>
<li>å…ˆæ’åº</li>
<li>ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€å¤´ä¸€å°¾</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">i = <span class="number">0</span>,j = n-<span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="keyword">while</span>(i &lt; j)&#123;</div><div class="line">  <span class="keyword">if</span>(nums[i] + nums[j] &gt; target)&#123; <span class="comment">// nums[j] åŠ ä¸Šæœ€å°çš„éƒ½æ›´å¤§ï¼Œå› æ­¤ä¸ç”¨è€ƒè™‘äº†</span></div><div class="line">    --j;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(nums[i] + nums[j] &lt; target)&#123; <span class="comment">//nums[i]åŠ ä¸Šæœ€å¤§çš„éƒ½æ›´å°ï¼Œå› æ­¤ä¸ç”¨è€ƒè™‘äº†</span></div><div class="line">    ++i;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">return</span> [nums[i],nums[j]]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Two-Sum-II">5.2. Two Sum II</h2><p>ç»™ä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œæ±‚ä¸¤æ•°ä¹‹å’Œç­‰äºtargetçš„idxã€‚</p>
<p>æ–¹æ³•ä¸€ï¼šhashè¡¨</p>
<p>æ–¹æ³•äºŒï¼šTwo Pointeræ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = nums.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; j)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] + nums[j] == target)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i + <span class="number">1</span>,j + <span class="number">1</span>&#125;;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] + nums[j] &gt; target)&#123;</div><div class="line">                --j;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜16ï¼ŒTwo-Sum-Closest">5.3. ä¾‹é¢˜16ï¼ŒTwo Sum Closest</h2><p>æ±‚ä¸¤æ•°ä¹‹å’Œæœ€æ¥è¿‘targetï¼Œè¿”å›ä¸¤æ•°å’Œä¸targetçš„å·®</p>
<p>ç›¸ä¼¼å¥—è·¯</p>
<h2 id="Valid-Triangle-Number">5.4. Valid Triangle Number</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ã€‚æ±‚æ•°ç»„ä¸­èƒ½ç»„æˆä¸‰è§’å½¢çš„ä¸ªæ•°ã€‚</p>
<p>æ˜æ˜å°±æ˜¯two pointerçš„å˜ç§ã€‚æ€ä¹ˆæƒ³éƒ½æƒ³ä¸å‡ºæ¥ã€‚å“ã€‚æˆ‘çš„æ™ºå•†çœŸçš„æœ‰é—®é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">triangleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>, n = nums.length;</div><div class="line">        <span class="comment">// éå†æœ€é«˜ä½</span></div><div class="line">        <span class="comment">/**å…¶å®å°±æ˜¯å›ºå®štargetä¹‹åï¼Œå¯»æ‰¾a + b &gt; targetçš„ç»„åˆ**/</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> high = n - <span class="number">1</span>; high &gt;= <span class="number">2</span>; --high)&#123;</div><div class="line">            <span class="keyword">int</span> low = <span class="number">0</span>, mid = high - <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (low &lt; mid)&#123;</div><div class="line">                <span class="keyword">if</span>(nums[low] + nums[mid] &gt; nums[high])&#123;</div><div class="line">                    <span class="comment">//any + nums[mid] &gt; nums[high]</span></div><div class="line">                    <span class="comment">// anyæœ‰mid-lowä¸ª</span></div><div class="line">                    counter += mid - low;</div><div class="line">                    --mid;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    ++low;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜17ï¼ŒThree-Sum">5.5. ä¾‹é¢˜17ï¼ŒThree Sum</h2><p>æ–¹æ³•ä¸€ï¼šhash + éå† , ç©ºé—´$O(n)$ + æ—¶é—´$O(n^2)$</p>
<p>æ–¹æ³•äºŒï¼šæ’åºåtwo pointerï¼Œç©ºé—´$O(1)$ + æ—¶é—´$O(n^2)$</p>
<ol>
<li>æ’åº</li>
<li>æ±‚a+b+c = target<br>å›ºå®ša ï¼Œ ç„¶åå¯¹b + cåˆ©ç”¨Two Sumæ–¹æ³•</li>
</ol>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums)&#123;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; nums.length; ++a)&#123;</div><div class="line">           	<span class="comment">// è·³è¿‡é‡å¤çš„</span></div><div class="line">            <span class="keyword">if</span>(a &gt; <span class="number">0</span> &amp;&amp; nums[a] == nums[a - <span class="number">1</span>]) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">int</span> i = a + <span class="number">1</span>, j = nums.length - <span class="number">1</span>;</div><div class="line">            <span class="keyword">int</span> target = -nums[a];</div><div class="line">            <span class="keyword">int</span> sum;</div><div class="line">            <span class="keyword">while</span> (i &lt; j)&#123;</div><div class="line">                sum = nums[i] + nums[j];</div><div class="line">                <span class="keyword">if</span>(sum == target)&#123;</div><div class="line">                    List&lt;Integer&gt; one = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(<span class="number">3</span>);</div><div class="line">                    one.add(nums[a]);</div><div class="line">                    one.add(nums[i]);</div><div class="line">                    one.add(nums[j]);</div><div class="line">                    ans.add(one);</div><div class="line">                    ++i;--j;</div><div class="line">                    <span class="comment">// è·³è¿‡é‡å¤çš„ , ä¸€å®šè¦æ³¨æ„è¿™é‡Œï¼Œæˆ‘è‡ªå·±æ²¡åšä¸Š</span></div><div class="line">                    <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[i] == nums[i-<span class="number">1</span>])&#123;</div><div class="line">                        ++i;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[j] == nums[j + <span class="number">1</span>])&#123;</div><div class="line">                        --j;</div><div class="line">                    &#125;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sum &gt; target)&#123;</div><div class="line">                    --j;</div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    ++i;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Three-Sum-Closest">5.6. Three Sum Closest</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetã€‚æ±‚ä¸‰ä¸ªæ•°ä¹‹å’Œæœ€æ¥è¿‘targetçš„å’Œã€‚</p>
<p>æ€è·¯ï¼šä¸ä¹‹å‰çš„ç›¸ä¼¼ã€‚</p>
<ol>
<li>æ’åº</li>
<li>æ±‚a+b+c = target<br>å›ºå®ša ï¼Œ ç„¶åå¯¹b + cåˆ©ç”¨Two Sumæ–¹æ³•</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">threeSumClosest</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">    Arrays.sort(nums);</div><div class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> minDiff = Integer.MAX_VALUE;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; nums.length; ++a)&#123;</div><div class="line">        <span class="keyword">int</span> t = target - nums[a];</div><div class="line">        <span class="comment">// find b + c = t</span></div><div class="line">        <span class="keyword">int</span> i = a + <span class="number">1</span>, j = nums.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> sum2,currDiff;</div><div class="line">        <span class="keyword">while</span> ( i &lt; j )&#123;</div><div class="line">            sum2 = nums[i] + nums[j];</div><div class="line">            currDiff = Math.abs(sum2 - t);</div><div class="line">            <span class="keyword">if</span>(currDiff &lt; minDiff)&#123;</div><div class="line">                sum = sum2 + nums[a];</div><div class="line">                minDiff = currDiff;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(sum2 &gt; t)&#123; <span class="comment">// nums[j]å¤ªå¤§</span></div><div class="line">                --j;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sum2 &lt; t)&#123; <span class="comment">// nuums[i]å¤ªå°</span></div><div class="line">                ++i;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> target;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Three-Sum-Smaller">5.7. Three Sum Smaller</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetï¼Œæ±‚ä¸‰ä¸ªæ•°ç›¸åŠ å°äºtargetçš„ä¸ªæ•°ã€‚</p>
<p>ç›¸ä¼¼å¥—è·¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">threeSumSmaller</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">       Arrays.sort(nums);</div><div class="line">       <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">       <span class="keyword">int</span> target_curr;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; nums.length; ++a)&#123;</div><div class="line">           target_curr = target - nums[a];</div><div class="line">           <span class="keyword">int</span> i = a + <span class="number">1</span>, j = nums.length - <span class="number">1</span>;</div><div class="line">           <span class="keyword">while</span> (i &lt; j)&#123;</div><div class="line">               <span class="keyword">if</span>(nums[i] + nums[j] &lt; target_curr)&#123;</div><div class="line">                   <span class="comment">// nums[i]æ˜¯å½“å‰æœ€å°çš„,å®ƒåŠ ä¸Šä»»æ„ä¸€ä¸ªéƒ½æ˜¯å°äºtarget_curr</span></div><div class="line">                   counter += (j - i);</div><div class="line">                   ++i;</div><div class="line">               &#125;<span class="keyword">else</span>&#123;</div><div class="line">                   <span class="comment">// nums[j]å¤ªå¤§äº†</span></div><div class="line">                   --j;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> counter;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Four-Sum">5.8. Four Sum</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetã€‚æ±‚å››ä¸ªæ•°ç›¸åŠ ç­‰äºtargetçš„æ‰€æœ‰å¯èƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; nums.length; ++a)&#123;</div><div class="line">            <span class="comment">// target = -nums[a]</span></div><div class="line">            <span class="keyword">if</span>(a &gt; <span class="number">0</span> &amp;&amp; nums[a] == nums[a - <span class="number">1</span>])<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> b = a + <span class="number">1</span>; b &lt; nums.length; ++b)&#123;</div><div class="line">                <span class="comment">// target = -nums[a] - nums[b]</span></div><div class="line">                <span class="keyword">if</span>(b &gt; a + <span class="number">1</span> &amp;&amp; nums[b] == nums[b-<span class="number">1</span>])<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">int</span> i = b + <span class="number">1</span>, j = nums.length - <span class="number">1</span>;</div><div class="line">                <span class="keyword">while</span> (i &lt; j)&#123;</div><div class="line">                    <span class="keyword">if</span>(nums[a] + nums[b] + nums[i] + nums[j] &gt; target)&#123;</div><div class="line">                        --j;</div><div class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[a] + nums[b] + nums[i] + nums[j] &lt; target)&#123;</div><div class="line">                        ++i;</div><div class="line">                    &#125;<span class="keyword">else</span> &#123;</div><div class="line">                        List&lt;Integer&gt; oneAns = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">                        oneAns.add(nums[a]);oneAns.add(nums[b]);</div><div class="line">                        oneAns.add(nums[i]);oneAns.add(nums[j]);</div><div class="line">                        ans.add(oneAns);</div><div class="line">                        ++i;</div><div class="line">                        --j;</div><div class="line">                        <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[i] == nums[i - <span class="number">1</span>])&#123;</div><div class="line">                            ++i;</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[j] == nums[j + <span class="number">1</span>])&#123;</div><div class="line">                            --j;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="Two-Pointeré—®é¢˜">6. Two Pointeré—®é¢˜</h1><h2 id="Subarray-Product-Less-Than-K">6.1. Subarray Product Less Than K</h2><p>ç»™ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„å’Œä¸€ä¸ªkã€‚æ±‚å­æ•°ç»„å°äºkçš„ä¸ªæ•°ã€‚</p>
<p>æ€æƒ³ï¼šç»´æŠ¤ä¸€ä¸ªå§‹ç»ˆå°äºkçš„çª—å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numSubarrayProductLessThanK</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">1</span>) <span class="keyword">return</span> nums[<span class="number">0</span>] &gt; k ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = <span class="number">0</span>;</div><div class="line">        <span class="keyword">long</span> product = <span class="number">1L</span>;</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (low &lt;= high &amp;&amp; high &lt; nums.length)&#123;</div><div class="line">            product *= nums[high];</div><div class="line">            <span class="keyword">while</span> (low &lt;= high &amp;&amp; product &gt;= k)&#123;</div><div class="line">                product/= nums[low];</div><div class="line">                ++low;</div><div class="line">            &#125;</div><div class="line">            counter += (high - low + <span class="number">1</span>);</div><div class="line">            ++high;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Longest-Substring-Without-Repeating-Characters">6.2. Longest Substring Without Repeating Characters</h2><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æ±‚å­—ç¬¦ä¸²çš„æœ€é•¿æ— é‡å­æ•°ç»„ã€‚</p>
<p>æ€è·¯ï¼šä¸¤ä¸ªæŒ‡é’ˆï¼Œå¦‚æœä¸¤ä¸ªæŒ‡é’ˆå†…æ²¡æœ‰é‡å¤çš„å…ƒç´ ï¼Œå°±æŠŠåé¢çš„ç»§ç»­åç§»ã€‚å¦‚æœæœ‰é‡å¤çš„ï¼Œå°±æŠŠå‰é¢çš„ç§»åˆ°é‡å¤çš„ä¸‹ä¸€ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == s || s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">// å¯»æ‰¾æœ€é•¿çš„æ— é‡å­æ•°ç»„</span></div><div class="line">        <span class="keyword">char</span>[] c = s.toCharArray();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        HashMap&lt;Character,Integer&gt; set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (j &lt; c.length)&#123;</div><div class="line">            <span class="keyword">if</span>(!set.containsKey(c[j]))&#123;</div><div class="line">                set.put(c[j], j);</div><div class="line">                max = Math.max(j - i + <span class="number">1</span>, max);</div><div class="line">                ++j;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">int</span> repeatIdx = set.get(c[j]);</div><div class="line">                <span class="comment">// å»é™¤ä»iåˆ°repeatIdxçš„å…ƒç´ </span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt;= repeatIdx; ++k)&#123;</div><div class="line">                    set.remove(c[k]);</div><div class="line">                &#125;</div><div class="line">                set.put(c[j],j);</div><div class="line">                i = repeatIdx + <span class="number">1</span>;</div><div class="line">                max = Math.max(j - i, max);</div><div class="line">                ++j;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œä¸Šé¢çš„è¿™ä¸ªè¡¨ç°å¾ˆå·®ã€‚æ‰beatsäº†ç™¾åˆ†ä¹‹å‡ ã€‚</p>
<p>å…¶å®ï¼Œè¿™ä¸ªé¢˜é‡Œé¢çš„hashMapçš„å…ƒç´ ä¸ä¸€å®šå¿…é¡»å»é™¤ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == s || s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">// å¯»æ‰¾æœ€é•¿çš„æ— é‡å­æ•°ç»„</span></div><div class="line">        <span class="keyword">char</span>[] c = s.toCharArray();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        HashMap&lt;Character,Integer&gt; set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (j &lt; c.length)&#123;</div><div class="line">            <span class="keyword">if</span>(!set.containsKey(c[j]))&#123;</div><div class="line">                set.put(c[j], j);</div><div class="line">                max = Math.max(j - i + <span class="number">1</span>, max);</div><div class="line">                ++j;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">int</span> repeatIdx = set.get(c[j]);</div><div class="line">                <span class="keyword">if</span>(repeatIdx &gt;= i)&#123; <span class="comment">// å“‡ï¼Œéªšæ“ä½œ</span></div><div class="line">                    i = repeatIdx + <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                set.put(c[j],j);</div><div class="line">                max = Math.max(j - i + <span class="number">1</span>, max);</div><div class="line">                ++j;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥æ”¹æˆä¸€ä¸ªé•¿åº¦ä¸º256çš„æ•°ç»„ã€‚éªšæ“ä½œå•Šéªšæ“ä½œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongtestSubString</span><span class="params">(String s)</span></span>&#123;</div><div class="line">  <span class="keyword">char</span>[] str = s.toCharArray();</div><div class="line">  <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>, max = <span class="number">0</span>;</div><div class="line">  <span class="keyword">int</span>[] memo = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">  Arrays.fill(memo, -<span class="number">1</span>);</div><div class="line">  <span class="keyword">while</span>(r &lt; str.length)&#123;</div><div class="line">    <span class="keyword">int</span> index = memo[str[r]];</div><div class="line">    <span class="keyword">if</span>(index &gt;= l)&#123;</div><div class="line">      l = index + <span class="number">1</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      max = Math.max(r-l+<span class="number">1</span>, max);</div><div class="line">    &#125;</div><div class="line">    memo[str[r]] = r;</div><div class="line">    ++r;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> max;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implement-strStr">6.3. Implement strStr()</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²aå’Œbã€‚å¦‚æœbåœ¨aä¸­ï¼Œè¿”å›bçš„å¼€å§‹idxã€‚</p>
<p><strong>æš´åŠ›æ€è·¯ï¼š</strong></p>
<p>ä¸€ä¸ªä¸ªæ¯”è¾ƒã€‚å½“ç„¶è¿™ä¸ªæ€è·¯éå¸¸çš„æ…¢ï¼Œæƒ³å“­ã€‚åªbeatsäº†4%ã€‚çœŸçš„ä¼¤å¿ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(<span class="keyword">char</span>[] haystack, <span class="keyword">char</span>[] needle, <span class="keyword">int</span> h_idx)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : needle)&#123;</div><div class="line">        <span class="keyword">if</span>(h_idx &lt; haystack.length &amp;&amp; c == haystack[h_idx])&#123;</div><div class="line">            ++h_idx;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] needle_chars = needle.toCharArray();</div><div class="line">    <span class="keyword">char</span>[] hays_chars = haystack.toCharArray();</div><div class="line">    <span class="keyword">if</span>(needle_chars.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(hays_chars.length == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> haystackStart = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hays_chars.length; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(helper(hays_chars, needle_chars, i)) <span class="keyword">return</span> i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–</strong></p>
<p>å…¶å®ã€‚ã€‚ã€‚ã€‚åªéœ€è¦ã€‚ã€‚ã€‚ã€‚åœ¨å¤§å¾ªç¯çš„æ—¶å€™ï¼Œé™åˆ¶içš„ç»ˆæ­¢æ¡ä»¶å°±å¥½ã€‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(<span class="keyword">char</span>[] haystack, <span class="keyword">char</span>[] needle, <span class="keyword">int</span> h_idx)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : needle)&#123;</div><div class="line">        <span class="keyword">if</span>(h_idx &lt; haystack.length &amp;&amp; c == haystack[h_idx])&#123;</div><div class="line">            ++h_idx;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] needle_chars = needle.toCharArray();</div><div class="line">    <span class="keyword">char</span>[] hays_chars = haystack.toCharArray();</div><div class="line">    <span class="keyword">if</span>(needle_chars.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(hays_chars.length == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> haystackStart = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= hays_chars.length - needle_chars.length; ++i)&#123; <span class="comment">// içš„ç»ˆæ­¢æ¡ä»¶</span></div><div class="line">        <span class="keyword">if</span>(helper(hays_chars, needle_chars, i)) <span class="keyword">return</span> i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å­—ç¬¦ä¸²æ“ä½œ</strong></p>
<p>è¿™æ˜¯æœ€å¿«çš„æ“ä½œã€‚çœŸçš„ä¼¤å¿ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> haystack.indexOf(needle);</div></pre></td></tr></table></figure>
<h2 id="Reverse-String">6.4. Reverse String</h2><p>åè½¬å­—ç¬¦ä¸²</p>
<p>ç®€å•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">reverseString</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] chars = s.toCharArray();</div><div class="line">    <span class="keyword">int</span> low = <span class="number">0</span>, high = chars.length - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">        <span class="keyword">char</span> temp = chars[low];</div><div class="line">        chars[low] = chars[high];</div><div class="line">        chars[high] = temp;</div><div class="line">        ++low; --high;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> String.valueOf(chars);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reverse-Vowels-of-a-String">6.5. Reverse Vowels of a String</h2><p>åè½¬å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­—èŠ‚</p>
<p>ç®€å•çš„é¢˜</p>
<p>å…ƒéŸ³å°±æ˜¯<code>&#39;a&#39;,&#39;e&#39;,&#39;i&#39;,&#39;o&#39;,&#39;u&#39;,&#39;A&#39;,&#39;E&#39;,&#39;I&#39;,&#39;O&#39;,&#39;U&#39;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">reverseVowels</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    HashSet&lt;Character&gt; vowels = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">    <span class="keyword">char</span>[] v = &#123;<span class="string">'a'</span>,<span class="string">'e'</span>,<span class="string">'i'</span>,<span class="string">'o'</span>,<span class="string">'u'</span>,<span class="string">'A'</span>,<span class="string">'E'</span>,<span class="string">'I'</span>,<span class="string">'O'</span>,<span class="string">'U'</span>&#125;;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : v) vowels.add(c);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> low = <span class="number">0</span>, high = s.length() - <span class="number">1</span>;</div><div class="line">    <span class="keyword">char</span>[] s_chars = s.toCharArray();</div><div class="line">    <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; !vowels.contains(s_chars[low])) ++low;</div><div class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; !vowels.contains(s_chars[high]))--high;</div><div class="line">        <span class="keyword">if</span>(low &lt; high)&#123;</div><div class="line">            <span class="keyword">char</span> temp = s_chars[low];</div><div class="line">            s_chars[low] = s_chars[high];</div><div class="line">            s_chars[high] = temp;</div><div class="line">            ++low;</div><div class="line">            --high;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> String.valueOf(s_chars);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æ»‘åŠ¨çª—å£">7. æ»‘åŠ¨çª—å£</h1><h2 id="Valid-Anagram">7.1. Valid Anagram</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚åˆ¤æ–­ä¸€ä¸ªæ˜¯å¦æ˜¯å¦ä¸€ä¸ªçš„å…¨æ’åˆ—ï¼ˆå­—è°œï¼‰</p>
<p>æ€è·¯ï¼šç”¨ä¸¤ä¸ª256çš„hashè¡¨ï¼ï¼ˆå…¶å®ç”¨ä¸€ä¸ªå°±è¡Œï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAnagram</span><span class="params">(String s, String t)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() != t.length()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">int</span>[] hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            ++hash[s.charAt(i)];</div><div class="line">            --hash[t.charAt(i)];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(hash[i] != <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Group-Anagrams">7.2. Group Anagrams</h2><p>è¿™ä¸€é¢˜ï¼Œçœ‹äº†ç­”æ¡ˆï¼Œå·®ç‚¹è¢«æ°”æ­»ï¼Œæ€ä¹ˆä¼šæœ‰å¦‚æ­¤æ— ç†å–é—¹çš„ç®—æ³•</p>
<h2 id="Find-All-Anagrams-in-a-String">7.3. Find All Anagrams in a String</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²<code>s</code>å’Œ<code>p</code>ã€‚æ±‚<code>p</code>çš„å…¨æ’åˆ—å‡ºç°åœ¨â€™sâ€™ä¸­çš„æ‰€æœ‰èµ·å§‹åæ ‡</p>
<p>æ€è·¯ï¼šæŒ‰ç…§ä¸Šä¸€é¢˜çš„æ»‘åŠ¨çª—å£çš„æ“ä½œï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findAnagrams</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(s.length() &lt; p.length() || p.length() == <span class="number">0</span>) <span class="keyword">return</span> result;</div><div class="line">        <span class="keyword">int</span>[] s_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        <span class="keyword">int</span>[] p_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        <span class="comment">// ä¸pé•¿åº¦ç›¸ç­‰çš„çª—å£</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; p.length(); ++i)&#123;</div><div class="line">            ++s_hash[s.charAt(i)];</div><div class="line">            ++p_hash[p.charAt(i)];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æ£€éªŒé•¿åº¦ä¸ºp.lengthçš„çª—å£å†…ç›¸ç­‰å…ƒç´ çš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(s_hash[i] == p_hash[i]) ++counter;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å°†çª—å£ä¾æ¬¡å‘å³æŒªåŠ¨</span></div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = p.length() - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(counter == <span class="number">256</span>)&#123;result.add(low);&#125;</div><div class="line">            <span class="keyword">char</span> low_c = s.charAt(low);</div><div class="line">            <span class="keyword">if</span>(s_hash[low_c] == p_hash[low_c])--counter;</div><div class="line">            --s_hash[low_c];</div><div class="line">            <span class="keyword">if</span>(s_hash[low_c] == p_hash[low_c])++counter; <span class="comment">// æ³¨æ„ï¼</span></div><div class="line">            ++low;</div><div class="line">            ++high;</div><div class="line">            <span class="keyword">if</span>(high &gt;= s.length()) <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">char</span> high_c = s.charAt(high);</div><div class="line">            <span class="keyword">if</span>(s_hash[high_c] == p_hash[high_c])--counter;</div><div class="line">            ++s_hash[high_c];</div><div class="line">            <span class="keyword">if</span>(s_hash[high_c] == p_hash[high_c]) ++counter; <span class="comment">// æ³¨æ„ï¼</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(counter == <span class="number">256</span>)&#123;result.add(low);&#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Permutation-in-String">7.4. Permutation in String</h2><p>åˆ¤æ–­å­—ç¬¦ä¸²s2æ˜¯å¦åŒ…å«s1çš„ä»»æ„æ’åˆ—çš„å­ä¸²</p>
<p>è¿™é“é¢˜æ˜¯è¿™ä¸€ç±»å‹çš„æˆ‘åšçš„ç¬¬ä¸€é“ã€‚åˆšå¼€å§‹çš„æ—¶å€™æƒ³ä¸åˆ°æ»‘åŠ¨çª—å£ï¼Œå¾ˆè‰°è¾›ã€‚èŠ±äº†ä¸€æ•´å¤©æ—¶é—´æ‰æ¶ˆåŒ–äº†ã€‚ä¸è¿‡ä¹‹åé‡åˆ°å…¶å®ƒé—®é¢˜çš„æ—¶å€™è¿˜æŒºé¡ºåˆ©çš„ã€‚ä»¥åé‡åˆ°ä¸ä¼šçš„é¢˜è¦ä½¿åŠ²æ€»ç»“ï¼åŠ æ²¹å•Šç”²ä¹™å°æœ‹å‹ï¼</p>
<p>æ€è·¯ï¼šç°å¸¸æš´åŠ›</p>
<p>ç»™s2ä¸€ä¸ªlowå’Œä¸€ä¸ªhighï¼š</p>
<ol>
<li>åˆå§‹æ—¶ï¼Œlow = 0, high = low</li>
<li>å½“<code>s2[high]</code> å‡ºç°åœ¨s1ä¸­æ—¶ï¼Œå°†s1è¿™ä¸ªä½ç½®æ ‡è®°ä¸ºä½¿ç”¨è¿‡ï¼Œå°†highæŒªåˆ°ä¸‹ä¸€æ ¼</li>
<li>å¦‚æœé¡ºåˆ©çš„è¯ï¼Œs1ä¸­æ¯ä¸ªä½ç½®éƒ½è¢«æ ‡è®°ä¸ºä½¿ç”¨è¿‡ï¼Œé‚£ä¹ˆ<code>low --- high</code>ä¹‹é—´çš„å­—ç¬¦å°±æ˜¯s1çš„ä¸€ä¸ªæ’åˆ—ã€‚</li>
</ol>
<p>å®ç°çš„æ—¶å€™è¿‡äºæš´åŠ›ã€‚å€Ÿç”¨äº†hashã€‚å½“ç„¶ç»“æœä¹Ÿæ˜¯éå¸¸çš„æ…¢ï¼Œå¤§æ¦‚åªbeatsäº†2%ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> counter;</div><div class="line">    <span class="keyword">int</span> used;</div><div class="line">    Node(<span class="keyword">int</span> counter, <span class="keyword">int</span> used)&#123;</div><div class="line">        <span class="keyword">this</span>.counter = counter;</div><div class="line">        <span class="keyword">this</span>.used = used;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">(HashMap&lt;Character, Node&gt; hash)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(Map.Entry&lt;Character,Node&gt; entry : hash.entrySet())&#123;</div><div class="line">        entry.getValue().used = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">    HashMap&lt;Character, Node&gt; hash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : s1.toCharArray())&#123;</div><div class="line">        <span class="keyword">if</span>(hash.containsKey(c))&#123;hash.get(c).counter += <span class="number">1</span>;&#125;</div><div class="line">        <span class="keyword">else</span>&#123;hash.put(c,<span class="keyword">new</span> Node(<span class="number">1</span>,<span class="number">0</span>));&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> low = <span class="number">0</span>, high = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span>[] s2_chars = s2.toCharArray();</div><div class="line">    <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (high &lt; s2_chars.length)&#123;</div><div class="line">        <span class="keyword">if</span>(hash.containsKey(s2_chars[high]))&#123;</div><div class="line">            Node temp = hash.get(s2_chars[high]);</div><div class="line">            <span class="keyword">if</span>(temp.used &gt;= temp.counter)&#123;</div><div class="line">                <span class="comment">// æ¸…ç©ºæ‰€æœ‰used</span></div><div class="line">                clear(hash);</div><div class="line">                low += <span class="number">1</span>;</div><div class="line">                high = low;</div><div class="line">                counter = <span class="number">0</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                counter += <span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>(counter == s1.length()) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                temp.used += <span class="number">1</span>;</div><div class="line">                ++high;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span>(counter &gt; <span class="number">0</span>)&#123;clear(hash);counter = <span class="number">0</span>;&#125;</div><div class="line">            ++low;</div><div class="line">            high = low;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–1ï¼Œæ»‘åŠ¨çª—å£</strong></p>
<p>ä¸€å…±å°±26ä¸ªå­—æ¯ï¼Œé‚£å°±ä¸ºs1å’Œs2å„ç”³è¯·ä¸€ä¸ªé•¿åº¦ä¸º26çš„æ•°ç»„ã€‚å½“ä¸¤ä¸ªæ•°ç»„å®Œå…¨ç›¸ç­‰æ—¶ï¼Œå³åŒ¹é…ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (s1.length() &gt; s2.length())</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span>[] s1map = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">    <span class="keyword">int</span>[] s2map = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">    <span class="comment">// çª—å£å¤§å°ä¸ºs1çš„é•¿åº¦</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s1.length(); i++) &#123;</div><div class="line">        s1map[s1.charAt(i) - <span class="string">'a'</span>]++;</div><div class="line">        s2map[s2.charAt(i) - <span class="string">'a'</span>]++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s2.length() - s1.length(); i++) &#123;</div><div class="line">        <span class="keyword">if</span> (matches(s1map, s2map)) <span class="comment">// çª—å£å†…éƒ¨å…ƒç´ å®Œå…¨ä¸€è‡´</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="comment">// çª—å£å³ç§»</span></div><div class="line">        s2map[s2.charAt(i + s1.length()) - <span class="string">'a'</span>]++;</div><div class="line">        s2map[s2.charAt(i) - <span class="string">'a'</span>]--;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> matches(s1map, s2map);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(<span class="keyword">int</span>[] s1map, <span class="keyword">int</span>[] s2map)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (s1map[i] != s2map[i])</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œmatchæ“ä½œä¹Ÿæœ‰ä¼˜åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (s1.length() &gt; s2.length())</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span>[] s1map = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">    <span class="keyword">int</span>[] s2map = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s1.length(); i++) &#123;</div><div class="line">        s1map[s1.charAt(i) - <span class="string">'a'</span>]++;</div><div class="line">        s2map[s2.charAt(i) - <span class="string">'a'</span>]++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</div><div class="line">        <span class="keyword">if</span> (s1map[i] == s2map[i])</div><div class="line">            count++;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s2.length() - s1.length(); i++) &#123;</div><div class="line">        <span class="keyword">int</span> r = s2.charAt(i + s1.length()) - <span class="string">'a'</span>, l = s2.charAt(i) - <span class="string">'a'</span>;</div><div class="line">        <span class="keyword">if</span> (count == <span class="number">26</span>)</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        s2map[r]++;</div><div class="line">        <span class="keyword">if</span> (s2map[r] == s1map[r])</div><div class="line">            count++;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s2map[r] == s1map[r] + <span class="number">1</span>)</div><div class="line">            count--;</div><div class="line">        s2map[l]--;</div><div class="line">        <span class="keyword">if</span> (s2map[l] == s1map[l])</div><div class="line">            count++;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s2map[l] == s1map[l] - <span class="number">1</span>)</div><div class="line">            count--;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> count == <span class="number">26</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–2ï¼Œéªšæ“ä½œ</strong></p>
<p>å“ã€‚æ˜æ˜çŸ¥é“æœ‰ä¼˜åŒ–ï¼Œå°±æ˜¯è‡ªå·±æƒ³ä¸å‡ºæ¥ã€‚</p>
<p>å…¶å®ä¸éœ€è¦æ‰¾åˆ°s1çš„å…¨æ’åˆ—ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦è€ƒè™‘s2ä¸­æ˜¯å¦åŒ…å«s1ä¸­åŒæ ·ä¸ªæ•°çš„å­—ç¬¦ï¼Œå¹¶ä¸”è¿™äº›å­—ç¬¦æ˜¯è¿åœ¨ä¸€èµ·çš„å°±è¡Œäº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œåœ¨s2ä¸Šæ»‘åŠ¨ã€‚åœ¨ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆä¿è¯çª—å£å†…éƒ¨åŒ…å«äº†æ‰€æœ‰çš„s1çš„æ¯ä¸ªå­—ç¬¦ã€‚å¦‚æœå½“å‰çª—å£é•¿åº¦å¤§äºs1çš„é•¿åº¦ï¼Œé‚£å°±æŠŠçª—å£å·¦è¾¹å‘å³ç§»ã€‚</p>
<p>å½“highå¾€åç§»åŠ¨æ—¶ï¼Œå³ä»£è¡¨å°†<code>s2[high]</code>åŠ å…¥åˆ°çª—å£ä¸­</p>
<ol>
<li>å¦‚æœs1ä¸­åŒ…å«<code>s2[high]</code>ï¼Œé‚£ä¹ˆ<code>count[s2[high]] &gt; 0</code>ï¼Œå°±å°†è®¡æ•°å™¨<code>cnt--</code></li>
<li>å¦‚æœs1ä¸­ä¸åŒ…å«<code>s2[high]</code>,é‚£ä¹ˆå°±å°†<code>count[s2[high]]--</code></li>
</ol>
<p>ç›´åˆ°çª—å£å†…éƒ¨çš„å…ƒç´ æ°å¥½å…¨éƒ¨åŒ…å«äº†s1æ—¶ï¼š</p>
<ol>
<li>å¦‚æœçª—å£å¤§å°æ°å¥½ç­‰äºs1ï¼Œé‚£ä¹ˆå°±è¿”å›true</li>
<li>å¦åˆ™çš„è¯ï¼Œçª—å£å¤§å°ä¸€å®šæ˜¯å¤§äºs1çš„ã€‚é‚£æˆ‘ä»¬å°±è¦å°è¯•å°†çª—å£å˜å°ï¼Œä¹Ÿå°±æ˜¯å°†å‰é¢çš„<code>low</code>å¾€åç§»åŠ¨<ol>
<li>é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œå¦‚æœä¸€ä¸ª<code>count[s2[low]]==0</code>ï¼Œé‚£å°±è¯´æ˜<code>s2[low]</code>ä¸€å®šæ˜¯å‡ºç°åœ¨s1ä¸­çš„ï¼Œåªæ˜¯è¢«å‡å»äº†ï¼Œè€Œä¸”çª—å£å†…éƒ¨çš„<code>s2[low]</code>ä¸ªæ•°æ°å¥½ç­‰äºs1ä¸­çš„ä¸ªæ•°ã€‚ä¸ºäº†å°†lowå¾€åç§»åŠ¨ï¼Œé‚£ä¹ˆå°±è¦å°†cnt+1,æ¥å¼¥è¡¥è¿™ä¸ªé”™è¯¯</li>
<li>åŒæ—¶ï¼Œæ— è®º<code>count[s2[low]]</code> ç­‰äºå‡ ï¼Œä¸ºäº†å°†lowå‘åç§»åŠ¨ï¼Œå®ƒéƒ½è¦åŠ ä¸€</li>
</ol>
</li>
</ol>
<p>ä¸€å®šè¦æ³¨æ„ç”¨ä¸€ä¸ª<code>int[256]</code>æ¥å¯¹å­—ç¬¦è¿›è¡Œhash çš„æ“ä½œï¼ï¼ï¼ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span></span>&#123;</div><div class="line">  <span class="comment">/**if end - start == len, return true</span></div><div class="line">     if arr[i] == 0, positive count, recover count++</div><div class="line">     recover i++ count[arr[i]]++**/</div><div class="line">  <span class="keyword">if</span>(s1.length() &gt; s2.length()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  <span class="keyword">int</span>[] count = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>]; <span class="comment">// åˆæ˜¯è¿™ä¸ªæ“ä½œ</span></div><div class="line">  <span class="comment">// count[i] ä»£è¡¨å­—ç¬¦içš„ä¸ªæ•°</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">char</span> c : s1.toCharArray())&#123;</div><div class="line">    count[c]++;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> len = s1.length();</div><div class="line">  <span class="keyword">int</span> cnt = len;</div><div class="line">  <span class="keyword">char</span> arr[] = s2.toCharArray();</div><div class="line">  <span class="keyword">int</span> high = <span class="number">0</span>, low = <span class="number">0</span>;</div><div class="line">  <span class="keyword">while</span>(high &lt; arr.length)&#123;</div><div class="line">    <span class="comment">//å°è¯•å°†highå¾€åæ»‘åŠ¨</span></div><div class="line">    <span class="keyword">if</span>(count[arr[high]] &gt; <span class="number">0</span>)&#123;</div><div class="line">      cnt--;</div><div class="line">    &#125;</div><div class="line">    count[arr[high]]--;</div><div class="line">    ++high;</div><div class="line">    <span class="keyword">while</span>(cnt == <span class="number">0</span>)&#123;</div><div class="line">      <span class="keyword">if</span>(high - low == len)&#123;<span class="keyword">return</span> <span class="keyword">true</span>;&#125;</div><div class="line">      <span class="comment">// å°è¯•å°†lowå¾€åæ»‘åŠ¨</span></div><div class="line">      <span class="keyword">if</span>(count[arr[low]] == <span class="number">0</span>)&#123; <span class="comment">// ä¸­é—´è‚¯å®šå¤šå‡ºç°äº†ä¸€æ¬¡arr[low]</span></div><div class="line">        cnt++;</div><div class="line">      &#125; </div><div class="line">      count[arr[low]]++;</div><div class="line">      low++;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–3ï¼Œéªšæ“ä½œ</strong></p>
<p>å…ˆçœ‹è¿™ç§è§£æ³•ï¼š</p>
<p>å¯¹äºæ¯ä¸ªéå†åˆ°çš„å­—ç¬¦ï¼Œæˆ‘ä»¬åœ¨hashè¡¨ä¸­å¯¹äºè¯¥å­—ç¬¦æ¬¡æ•°å‡1ã€‚ä¸€æ—¦è¯¥å­—ç¬¦æ¬¡æ•°å°äº0ï¼Œé‚£ä¹ˆè¯¥å­—ç¬¦è¦ä¹ˆåœ¨s1ä¸­ä¸æ›¾å‡ºç°ï¼Œæˆ–è€…å‡ºç°çš„æ¬¡æ•°è¶…è¿‡äº†s1ä¸­çš„è¯¥å­—ç¬¦å‡ºç°æ¬¡æ•°ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±ç§»åŠ¨çª—å£çš„lowè¾¹ç•Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯æ¬¡ç§»åŠ¨å³è¾¹ç•Œæ—¶ï¼Œhashè¡¨å¯¹åº”çš„å­—ç¬¦æ¬¡æ•°éƒ½è¦+1ã€‚å¦‚æœæ­¤æ—¶æ¬¡æ•°ä¸ç­‰äº0ï¼Œé‚£ä¹ˆè¯´æ˜è¯¥å­—ç¬¦ä¸åœ¨s1ä¸­ï¼Œç»§ç»­å‘å³ç§»ã€‚ç›´åˆ°æ›´æ–°åçš„æ¬¡æ•°ä¸º0ä¸ºæ­¢ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkInclusion</span><span class="params">(String s1, String s2)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(s1.length() &gt; s2.length()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span>[] count = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>]; <span class="comment">// åˆæ˜¯è¿™ä¸ªæ“ä½œ</span></div><div class="line">    <span class="comment">// count[i] ä»£è¡¨å­—ç¬¦içš„ä¸ªæ•°</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : s1.toCharArray())&#123;</div><div class="line">        count[c]++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> len = s1.length();</div><div class="line">    <span class="keyword">char</span> arr[] = s2.toCharArray();</div><div class="line">    <span class="keyword">int</span> high = <span class="number">0</span>, low = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(high &lt; arr.length)&#123;</div><div class="line">        --count[arr[high]];</div><div class="line">        ++high;</div><div class="line">        <span class="comment">// å½“count[arr[high]]å°äº0æ—¶ï¼Œè¯´æ˜è¯¥å­—ç¬¦åœ¨s1ä¸­ä¸æ›¾å‡ºç°ï¼Œ</span></div><div class="line">        <span class="comment">// æˆ–è€…å‡ºç°çš„æ¬¡æ•°è¶…è¿‡äº†s1ä¸­çš„è¯¥å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ï¼Œé‚£å°±ç§»åŠ¨çª—å£å·¦è¾¹ç•Œ</span></div><div class="line">        <span class="keyword">if</span>(count[arr[high]] &lt; <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">while</span> (count[arr[low]] != <span class="number">0</span>)&#123;</div><div class="line">                ++low;</div><div class="line">                ++count[arr[low]];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// æ­¤æ—¶çª—å£å†…éƒ¨çš„å­—ç¬¦arr[low]ä¸ªæ•°æ°å¥½ç­‰äºs1ä¸­è¯¥å­—ç¬¦çš„å‡ºç°æ¬¡æ•°</span></div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(high - low + <span class="number">1</span> == len) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> s1.length() == <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Minimum-Window-Substring">7.5. Minimum Window Substring</h2><p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°ä¸€ä¸ªåŒ…å«å¦ä¸€ä¸ªæ‰€æœ‰å…ƒç´ çš„æœ€å°å­ä¸²</p>
<p>æ€è·¯ï¼šhash + åŒæŒ‡é’ˆï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">goHigh</span><span class="params">(<span class="keyword">int</span>[] hash_s, <span class="keyword">int</span>[] hash_t, String s, String t, <span class="keyword">int</span> high, <span class="keyword">int</span> same)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(high == s.length() - <span class="number">1</span>) <span class="keyword">return</span> same;</div><div class="line">        ++high;</div><div class="line">        <span class="keyword">char</span> s_element = s.charAt(high);</div><div class="line">        <span class="comment">// tä¸­è¿˜æœ‰å¤šä½™çš„è¿™ä¸ªå…ƒç´ æ²¡æœ‰åŒ¹é…åˆ°</span></div><div class="line">        <span class="keyword">if</span>(hash_t[s_element] &gt; hash_s[s_element])</div><div class="line">            same += <span class="number">1</span>;</div><div class="line">        hash_s[s_element]++;</div><div class="line">        <span class="keyword">return</span> same;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">goLow</span><span class="params">(<span class="keyword">int</span>[] hash_s, <span class="keyword">int</span>[] hash_t, String s, String t, <span class="keyword">int</span> low, <span class="keyword">int</span> same)</span></span>&#123;</div><div class="line">        <span class="keyword">char</span> s_element = s.charAt(low);</div><div class="line">        <span class="comment">// tä¸­è¿™ä¸ªå…ƒç´ è¿˜æ²¡åŒ¹é…å®Œ</span></div><div class="line">        <span class="keyword">if</span>(hash_t[s_element] &gt; <span class="number">0</span> &amp;&amp; hash_s[s_element] &lt;= hash_t[s_element])&#123;</div><div class="line">            same -= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        hash_s[s_element]--;</div><div class="line">        ++low;</div><div class="line">        <span class="keyword">return</span> same;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">minWindow</span><span class="params">(String s, String t)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() &lt; t.length() || t.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">        <span class="keyword">int</span>[] hash_s = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        <span class="keyword">int</span>[] hash_t = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t.length(); ++i)&#123;</div><div class="line">            hash_s[s.charAt(i)]++;</div><div class="line">            hash_t[t.charAt(i)]++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> same = <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(hash_t[i] &gt; <span class="number">0</span> &amp;&amp; hash_s[i] &gt; <span class="number">0</span>)&#123;</div><div class="line">                same += Math.min(hash_s[i], hash_t[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> window = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">int</span> start = -<span class="number">1</span>, end = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = t.length() - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (low&lt;= s.length() - t.length() &amp;&amp; high &lt; s.length())&#123;</div><div class="line">            <span class="keyword">if</span>(same == t.length())&#123;</div><div class="line">                <span class="keyword">if</span>(high - low + <span class="number">1</span> &lt; window)&#123;</div><div class="line">                    start = low;</div><div class="line">                    end = high;</div><div class="line">                    window = high - low + <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                same = goLow(hash_s, hash_t, s, t, low, same);</div><div class="line">                ++low;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(same &lt; t.length())&#123;</div><div class="line">                same = goHigh(hash_s, hash_t, s, t, high, same);</div><div class="line">                ++high;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                same = goLow(hash_s, hash_t, s, t, high, same);</div><div class="line">                ++low;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//System.out.println();</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(start == -<span class="number">1</span>) <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">        <span class="keyword">return</span> s.substring(start, end + <span class="number">1</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Gas-Station">7.6. Gas Station</h2><p>æœ‰nä¸ªåŠ æ²¹ç«™ï¼Œæ¯ä¸ªåŠ æ²¹ç«™å¯ä»¥åŠ <code>gas[i]</code> çš„æ²¹é‡ã€‚ä»<code>i</code> åˆ°<code>i+1</code> éœ€è¦èŠ±è´¹<code>cost[i]</code> çš„æ²¹é‡ã€‚åŠ æ²¹ç«™æ˜¯ç¯å½¢ã€‚æ±‚ä¸€ä¸ªå‡ºå‘ç‚¹ï¼Œèƒ½ä½¿å¾—å®ƒå¯ä»¥èµ°ä¸€ä¸ªç¯ã€‚</p>
<p>ä¸€å¼€å§‹å°±æš´è§£ï¼Œç»“æœæœ€åä¸€ä¸ªæ ·ä¾‹æ²¡æœ‰é€šè¿‡ã€‚</p>
<p>æ»‘åŠ¨çª—å£å•Šï¼</p>
<ol>
<li>å¦‚æœlowåˆ°highä¹‹é—´çš„æ²¹é‡ä¸å¤Ÿäº†ï¼Œé‚£å‡ºå‘ç‚¹ä¸€å®šä¸æ˜¯lowã€‚åˆ™lowâ€“</li>
<li>å¦‚æœlowåˆ°highä¹‹é—´æ²¹é‡å¤§äºç­‰äº0ï¼Œé‚£å‡ºå‘ç‚¹æœ‰å¯èƒ½æ˜¯lowã€‚åˆ™high++</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">canCompleteCircuit</span><span class="params">(<span class="keyword">int</span>[] gas, <span class="keyword">int</span>[] cost)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = gas.length;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> low =<span class="number">0</span>, high = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> remain = gas[<span class="number">0</span>] - cost[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span> counter = n - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (counter &gt; <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(remain &lt; <span class="number">0</span>)&#123;</div><div class="line">                --low;low = (low + n)%n;</div><div class="line">                remain += gas[low] - cost[low];</div><div class="line">            &#125; <span class="keyword">else</span>&#123;</div><div class="line">                ++high;high %= n;</div><div class="line">                remain += gas[high] - cost[high];</div><div class="line">            &#125;</div><div class="line">            --counter;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> remain &gt;= <span class="number">0</span> ? low : -<span class="number">1</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Contains-Duplicate-III">7.7. Contains Duplicate III</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ã€‚æ±‚æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä½ç½®ï¼Œä½¿å¾—<code>|nums[i] - nums[j]| &lt;= t, |i - j| &lt;=k</code></p>
<p><strong>æ€è·¯ä¸€ï¼Œæ’åº+æ»‘çª—</strong></p>
<p>å—¯ã€‚å»ºè®®è¯»è€…ä¸è¦é‡‡çº³è¿™ä¸ªæ–¹æ³•ã€‚å› ä¸ºå®ƒæœ‰ç‚¹éš¾ç†è§£ã€‚</p>
<p>ç”±äºé¢˜ç›®è¯´è¦<code>|nums[i] - nums[j]| &lt;= t, |i - j| &lt;=k</code> ï¼Œå› æ­¤æˆ‘ç¬¬ä¸€ååº”å°±æ˜¯æ»‘çª—æ³•ã€‚</p>
<p>æ»‘çª—æœ‰ä¸¤ç§çª—ï¼šç´¢å¼•çª—æˆ–è€…å€¼çª—ã€‚</p>
<p>å¦‚æœç”¨ç´¢å¼•çª—ï¼Œå³çª—å£å†…<code>|i - j| &lt;= k</code> ,é‚£ä¹ˆæ˜¯ä¸å¥½åˆ¤æ–­çª—å£å†…æ˜¯å¦å­˜åœ¨<code>nums[i] - nums[j] &lt;= t</code> çš„ã€‚å› æ­¤æˆ‘ä»¬æ¢ä¸€ç§æ€è·¯ï¼Œç”¨å€¼çª—ï¼ŒæŒ‰ç…§å€¼å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œç„¶åç»´æŒçª—å£å†…<code>nums[i] - nums[j] &lt;= t</code></p>
<p>æŒ‰å€¼æ’åºçš„è¯ï¼Œå°±è¦ä¿å­˜æ¯ä¸ªå€¼çš„ç´¢å¼•ï¼Œå› æ­¤æˆ‘å»ºç«‹äº†ä¸€ä¸ªç»“ç‚¹æ¥ä¿å­˜å€¼å’Œç´¢å¼•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> val;</div><div class="line">  <span class="keyword">int</span> idx;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Node[] helper = ... <span class="comment">// ä¿å­˜æ¯ä¸ªnums[i]ä¸i</span></div></pre></td></tr></table></figure>
<p>ä¿æŒçª—å£å†…<code>nums[low] - nums[high] &lt;= t</code> ã€‚å¦‚æœçª—å£æˆç«‹ï¼Œåˆ™<code>++high</code>ã€‚ å¦åˆ™<code>++low</code></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªä½ç½®çš„å€¼ç›¸ç­‰å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬å…ˆå¾—åˆ°ç´¢å¼•æ¯”è¾ƒå¤§çš„å€¼ï¼Œå³<code>high</code> å…ˆè§¦ç¢°åˆ°ç´¢å¼•è¾ƒå¤§çš„å€¼ã€‚é‚£ä¹ˆï¼š</p>
<ol>
<li>å¦‚æœ<code>helper[low].idx &gt; helper[high].idx</code> ,é‚£ä¹ˆå…ˆè¾“å‡ºç´¢å¼•è¾ƒå¤§çš„å€¼æ˜¯æ¯”è¾ƒå¥½çš„</li>
<li>å¦‚æœ<code>helper[low].idx &lt; helper[high].idx</code> ,é‚£ä¹ˆå…ˆè¾“å‡ºç´¢å¼•æ¯”è¾ƒå¤§çš„å€¼çš„è¯ï¼Œå°±ä¼šè¿›è¡Œ++highæ“ä½œï¼Œç„¶åå°±ä¼šå¾—åˆ°ç´¢å¼•åå°çš„å€¼ï¼</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">long</span> val;</div><div class="line">        <span class="keyword">int</span> idx;</div><div class="line">        Node(<span class="keyword">long</span> val, <span class="keyword">int</span> idx)&#123;</div><div class="line">            <span class="keyword">this</span>.val = val;</div><div class="line">            <span class="keyword">this</span>.idx = idx;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.val == o.val)&#123;</div><div class="line">                <span class="keyword">return</span> o.idx - <span class="keyword">this</span>.idx;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.val - o.val &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">        <span class="comment">/**|num[i] - num[j]| &lt;= t</span></div><div class="line">         * i - j &lt;= k**/</div><div class="line">        Node[] helper = <span class="keyword">new</span> Node[nums.length];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            helper[i] = <span class="keyword">new</span> Node(nums[i], i);</div><div class="line">        &#125;</div><div class="line">        Arrays.sort(helper);</div><div class="line">        <span class="comment">// æ»‘çª—æ³•,ä¿æŒçª—å£å†…çš„nums[high] - nums[low] &lt;= t</span></div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (high &lt; nums.length)&#123;</div><div class="line">            <span class="keyword">if</span>(high == low) ++high;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(helper[high].val - helper[low].val &lt;= t)&#123;</div><div class="line">                <span class="keyword">if</span>(Math.abs(helper[high].idx - helper[low].idx) &lt;= k) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                ++high;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                ++low;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œ</strong></p>
<p>ç»´æŒä¸€ä¸ªé•¿åº¦ä¸ºkçš„window, æ¯æ¬¡æ£€æŸ¥æ–°çš„å€¼æ˜¯å¦ä¸åŸæ¥çª—å£ä¸­çš„æ‰€æœ‰å€¼çš„å·®å€¼æœ‰å°äºç­‰äºtçš„. å¦‚æœç”¨ä¸¤ä¸ªforå¾ªç¯ä¼šè¶…æ—¶O(nk). ä½¿ç”¨treeset( backed by binary search tree) çš„subSetå‡½æ•°,å¯ä»¥å¿«é€Ÿæœç´¢. å¤æ‚åº¦ä¸º O(n logk)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;  </div><div class="line">       <span class="comment">//input check  </span></div><div class="line">       <span class="keyword">if</span>(k&lt;<span class="number">1</span> || t&lt;<span class="number">0</span> || nums==<span class="keyword">null</span> || nums.length&lt;<span class="number">2</span>) <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">         </div><div class="line">       SortedSet&lt;Long&gt; set = <span class="keyword">new</span> TreeSet&lt;Long&gt;();  </div><div class="line">         </div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;nums.length; j++) &#123;  </div><div class="line">           SortedSet&lt;Long&gt; subSet =  set.subSet((<span class="keyword">long</span>)nums[j]-t, (<span class="keyword">long</span>)nums[j]+t+<span class="number">1</span>);  </div><div class="line">           <span class="keyword">if</span>(!subSet.isEmpty()) <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">             </div><div class="line">           <span class="keyword">if</span>(j&gt;=k) &#123;  </div><div class="line">               set.remove((<span class="keyword">long</span>)nums[j-k]);  </div><div class="line">           &#125;  </div><div class="line">           set.add((<span class="keyword">long</span>)nums[j]);  </div><div class="line">       &#125;  </div><div class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h1 id="æ•°ç»„åˆ’åˆ†é—®é¢˜">8. æ•°ç»„åˆ’åˆ†é—®é¢˜</h1><h2 id="ä¾‹é¢˜18ï¼ŒPartition-Array">8.1. ä¾‹é¢˜18ï¼ŒPartition Array</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªkã€‚ç§»åŠ¨æ•°ç»„ä½¿å¾—å°äºkçš„åœ¨å·¦è¾¹ï¼Œå¤§äºkçš„åœ¨å³è¾¹ã€‚</p>
<p>æ€è·¯ï¼›Two  Pointeræ–¹æ³•</p>
<ol>
<li>ä»å·¦å¾€å³æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºkçš„</li>
<li>ä»å³å¾€å·¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºkçš„</li>
<li>äº¤æ¢ä»–ä¿©</li>
</ol>
<h2 id="ä¾‹é¢˜19ï¼ŒSort-letters-by-case">8.2. ä¾‹é¢˜19ï¼ŒSort letters by case</h2><p>å­—ç¬¦å¤§å°å†™æ’åº</p>
<h2 id="ä¾‹é¢˜20ï¼ŒSort-Colors">8.3. ä¾‹é¢˜20ï¼ŒSort Colors</h2><p>æ–¹æ³•1ï¼š</p>
<ol>
<li>å…ˆåˆ†æˆ0ä¸€ç»„ï¼Œ12ä¸€ç»„</li>
<li>ç„¶åå†å°†12åˆ†å¼€</li>
</ol>
<p>æ–¹æ³•2ï¼š</p>
<p>å‚è€ƒç¨‹åºï¼Œä¸‰åˆ†æ–¹æ³•</p>
<p>å˜å½¢ï¼šåˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>x&lt;= low</li>
<li>low&lt; x &lt;= high</li>
<li>x &gt; high</li>
</ol>
<h2 id="Sort-Color-II">8.4. Sort Color II</h2><h2 id="Interleaving-Positive-and-Negative-Numbers">8.5. Interleaving Positive and Negative Numbers</h2><h1 id="èºæ—‹æ•°ç»„é—®é¢˜">9. èºæ—‹æ•°ç»„é—®é¢˜</h1><h2 id="Spiral-Matrix">9.1. Spiral Matrix</h2><p>èºæ—‹è¾“å‡ºäºŒç»´æ•°ç»„</p>
<p>è¦æ³¨æ„è¾¹ç•Œæ¡ä»¶ç­‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">spiralOrder</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">0</span>);</div><div class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;(matrix.length * matrix[<span class="number">0</span>].length);</div><div class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = matrix[<span class="number">0</span>].length - <span class="number">1</span>, top = <span class="number">0</span>, bottom = matrix.length - <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>,j = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (bottom &gt;= top &amp;&amp; left &lt;= right) &#123;</div><div class="line">        j = left;</div><div class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; j &lt;= right) &#123;</div><div class="line">            res.add(matrix[top][j]);</div><div class="line">            ++j;</div><div class="line">        &#125;</div><div class="line">        top++;</div><div class="line">        i = top;</div><div class="line">        <span class="keyword">while</span> (bottom &gt;= top &amp;&amp; i &lt;= bottom) &#123;</div><div class="line">            res.add(matrix[i][right]);</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        right--;</div><div class="line">        j = right;</div><div class="line">        <span class="keyword">while</span> (bottom &gt;= top &amp;&amp; j &gt;= left) &#123;</div><div class="line">            res.add(matrix[bottom][j]);</div><div class="line">            --j;</div><div class="line">        &#125;</div><div class="line">        bottom--;</div><div class="line">        i = bottom;</div><div class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; i &gt;= top) &#123;</div><div class="line">            res.add(matrix[i][left]);</div><div class="line">            --i;</div><div class="line">        &#125;</div><div class="line">        left++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Spiral-Matrix-II">9.2. Spiral Matrix II</h2><p>è¾“å‡º$n\times n$ çš„èºæ—‹æ•°ç»„ï¼ˆå…ƒç´ ä»1å¼€å§‹ä¾æ¬¡é€’å¢ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] generateMatrix(<span class="keyword">int</span> n) &#123;</div><div class="line">    <span class="keyword">int</span>[][] matrix = <span class="keyword">new</span> <span class="keyword">int</span>[n][n];</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>,j = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> val = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = n - <span class="number">1</span>, top = <span class="number">0</span>, bottom = n - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (left &lt;= right &amp;&amp; top &lt;= bottom)&#123;</div><div class="line">        j = left;</div><div class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; j &lt;= right)&#123;</div><div class="line">            matrix[top][j++] = val++;</div><div class="line">        &#125;</div><div class="line">        i = ++top;</div><div class="line">        <span class="keyword">while</span> (top &lt;= bottom &amp;&amp; i &lt;= bottom)&#123;</div><div class="line">            matrix[i++][right] = val++;</div><div class="line">        &#125;</div><div class="line">        j = --right;</div><div class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; j &gt;= left)&#123;</div><div class="line">            matrix[bottom][j--] = val++;</div><div class="line">        &#125;</div><div class="line">        i = --bottom;</div><div class="line">        <span class="keyword">while</span> (top &lt;= bottom &amp;&amp; i &gt;= top)&#123;</div><div class="line">            matrix[i--][left] = val++;</div><div class="line">        &#125;</div><div class="line">        ++left;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> matrix;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="åŒºé—´é—®é¢˜">10. åŒºé—´é—®é¢˜</h1><h2 id="Merge-Intervals">10.1. Merge Intervals</h2><p>ç»™ä¸€äº›åŒºé—´ã€‚è¾“å‡ºåŒºé—´çš„åˆå¹¶ç»“æœã€‚</p>
<p>è¦ç‚¹ï¼š</p>
<ol>
<li>List çš„<code>Collections.sort()</code>æ’åº</li>
<li><code>Comparator</code>çš„ç”¨æ³•</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompareInterval</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">Interval</span>&gt;</span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Interval o1, Interval o2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> o1.start - o2.start;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Interval&gt; <span class="title">merge</span><span class="params">(List&lt;Interval&gt; intervals)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(intervals.size() == <span class="number">0</span>) <span class="keyword">return</span> intervals;</div><div class="line">    <span class="comment">// å…ˆæŒ‰ç…§startæ’åº</span></div><div class="line">    Collections.sort(intervals, <span class="keyword">new</span> CompareInterval()); <span class="comment">// æ³¨æ„è¿™ä¸ªæ’åºçš„ç”¨æ³•</span></div><div class="line">    <span class="keyword">int</span> start = intervals.get(<span class="number">0</span>).start, end = intervals.get(<span class="number">0</span>).end;</div><div class="line">    List&lt;Interval&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(Interval interval : intervals)&#123;</div><div class="line">        <span class="keyword">if</span>(interval.start &lt;= end)&#123;</div><div class="line">            end = Math.max(end,interval.end);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            result.add(<span class="keyword">new</span> Interval(start,end));</div><div class="line">            start = interval.start;</div><div class="line">            end = interval.end;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(intervals.size() &gt; <span class="number">0</span>)&#123;result.add(<span class="keyword">new</span> Interval(start,end));&#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Insert-Interval">10.2. Insert Interval</h2><p>ç»™ä¸€äº›åŒºé—´ã€‚å°†å¦ä¸€ä¸ªåŒºé—´ä¸è¿™äº›åŒºé—´åˆå¹¶ã€‚</p>
<p>è¦ç‚¹ï¼šç»†å¿ƒï¼è¾¹ç•Œæ¡ä»¶ï¼ï¼ï¼ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Interval&gt; <span class="title">insert</span><span class="params">(List&lt;Interval&gt; intervals, Interval newInterval)</span> </span>&#123;</div><div class="line">        List&lt;Interval&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">boolean</span> begin = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        Interval last = newInterval;</div><div class="line">        <span class="keyword">for</span>(Interval interval : intervals)&#123;</div><div class="line">            <span class="keyword">if</span>(!begin) &#123;</div><div class="line">                <span class="keyword">if</span> (interval.end &gt;= newInterval.start &amp;&amp; interval.start &lt;= newInterval.end) &#123;</div><div class="line">                    interval.end = Math.max(interval.end, newInterval.end);</div><div class="line">                    interval.start = Math.min(interval.start, newInterval.start);</div><div class="line">                    last = interval;</div><div class="line">                    begin = <span class="keyword">true</span>;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(interval.start &gt; newInterval.end)&#123;</div><div class="line">                    result.add(newInterval);</div><div class="line">                    begin = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                result.add(interval);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">if</span>(interval.start &lt;= last.end)&#123;</div><div class="line">                    last.end = Math.max(interval.end, last.end);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    result.add(interval);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(!begin)&#123;</div><div class="line">            result.add(newInterval);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Summary-Ranges">10.3. Summary Ranges</h2><p>ç»™ä¸€ä¸ªæ— é‡æ•°ç»„ï¼Œå¦‚æœç›¸é‚»ä¸¤ä¸ªæ•°å­—å·®ä¸º1ï¼Œåˆ™è¿™ä¸¤ä¸ªæ•°åœ¨ä¸€ä¸ªåŒºé—´ã€‚è¾“å‡ºæ•°ç»„çš„æ‰€æœ‰åŒºé—´ã€‚</p>
<p>è¿™é“é¢˜è¿˜å¥½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">summaryRanges</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>)<span class="keyword">return</span> result;</div><div class="line">        <span class="keyword">int</span> start = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span> end = nums[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(nums[i] == nums[i - <span class="number">1</span>] + <span class="number">1</span>)&#123;</div><div class="line">                end = nums[i];</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">if</span>(start == end)&#123;</div><div class="line">                    result.add(String.valueOf(start));</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    result.add(String.valueOf(start)+<span class="string">"-&gt;"</span>+String.valueOf(end));</div><div class="line">                &#125;</div><div class="line">                start = nums[i];</div><div class="line">                end = nums[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(start == end)&#123;</div><div class="line">            result.add(String.valueOf(start));</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            result.add(String.valueOf(start)+<span class="string">"-&gt;"</span>+String.valueOf(end));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="My-Calendar-I">10.4. My Calendar I</h2><p>è®¾è®¡ä¸€ä¸ªCalendarç±»ï¼Œæ¯æ¬¡è¿›è¡Œ<code>book(start, end)</code>æ“ä½œã€‚å¦‚æœè¿™æ¬¡æ—¶é—´ä¸ä¹‹å‰çš„è¡Œç¨‹å†²çªï¼Œé‚£ä¹ˆè¿”å›falseã€‚å¦åˆ™ä¿å­˜æ–°çš„è¡Œç¨‹ï¼Œå¹¶è¿”å›trueã€‚</p>
<p>æ€è·¯ï¼šæƒ³ç€ç”¨æ ‘æ¥è¡¨ç¤ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">èŠ‚ç‚¹ï¼š åŒºé—´ï¼Œç”±startå’Œendè¡¨ç¤º</div><div class="line">å·¦å­©å­ï¼šæ‰€æœ‰åœ¨startä¹‹å‰çš„è¡Œç¨‹</div><div class="line">å³å­©å­ï¼šæ‰€æœ‰åœ¨endä¹‹åçš„è¡Œç¨‹</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCalendar</span> </span>&#123;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> start;</div><div class="line">        <span class="keyword">int</span> end;</div><div class="line">        Node left;</div><div class="line">        Node right;</div><div class="line">        Node(<span class="keyword">int</span> start, <span class="keyword">int</span> end)&#123;</div><div class="line">            <span class="keyword">this</span>.start = start;</div><div class="line">            <span class="keyword">this</span>.end = end;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    Node root;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyCalendar</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">book</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == root)&#123;</div><div class="line">            root = <span class="keyword">new</span> Node(start,end);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            Node curr = root;</div><div class="line">            Node parent = root;</div><div class="line">            <span class="keyword">int</span> ifLeft = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != curr)&#123;</div><div class="line">                parent = curr;</div><div class="line">                <span class="keyword">if</span>(end &lt;= curr.start)&#123;</div><div class="line">                    curr = curr.left;</div><div class="line">                    ifLeft = <span class="number">1</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(start &gt;= curr.end)&#123;</div><div class="line">                    curr = curr.right;</div><div class="line">                    ifLeft = -<span class="number">1</span>;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(ifLeft == <span class="number">1</span>)&#123;</div><div class="line">                parent.left = <span class="keyword">new</span> Node(start,end);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(ifLeft == -<span class="number">1</span>)&#123;</div><div class="line">                parent.right = <span class="keyword">new</span> Node(start,end);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>  <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å…¶å®ƒæ•°ç»„æ“ä½œ">11. å…¶å®ƒæ•°ç»„æ“ä½œ</h1><h2 id="Game-of-Life">11.1. Game of Life</h2><p>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œ1ä»£è¡¨æœ¬è½®æ´»ç€ï¼Œ0ä»£è¡¨æœ¬è½®æ­»äº†ã€‚å¦‚æœï¼š</p>
<ul>
<li><p>å¦‚æœæŸç‚¹çš„æ´»ç€çš„é‚»å±…å°‘äºä¸¤ä¸ªï¼Œåˆ™å®ƒæ­»äº¡</p>
<ul>
<li>å¦‚æœæŸç‚¹æœ‰2/3ä¸ªæ´»ç€çš„é‚»å±…ï¼Œåˆ™å®ƒå¯ä»¥è¿›å…¥ä¸‹ä¸€ä»£</li>
<li>å¦‚æœæŸç‚¹æœ‰3ä¸ªä»¥ä¸Šæ´»ç€çš„é‚»å±…ï¼Œåˆ™å®ƒæ­»äº¡</li>
<li>å¦‚æœæŸæ­»ç‚¹å‘¨å›´åªæœ‰ä¸‰ä¸ªæ´»ç€çš„é‚»å±…ï¼Œåˆ™å®ƒå¤æ´»</li>
</ul>
</li>
</ul>
<p>æ€è·¯ï¼šä¸ºäº†åœ¨åŸåœ°è¿›è¡Œæ›¿æ¢ï¼Œæˆ‘ä»¬å®šä¹‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ä»¤ä¸‹ä¸€æ—¶åˆ»ï¼š</div><div class="line">* 1 = ä¸‹ä¸€è½®æ´»ï¼ˆæœ¬è½®æ´»ï¼‰</div><div class="line">* 2 = ä¸‹ä¸€è½®æ­»ï¼ˆæœ¬è½®æ˜¯æ´»çš„ï¼‰</div><div class="line">*</div><div class="line">* -1 = å¤æ´»ï¼ˆæœ¬è½®æ˜¯æ­»çš„ï¼‰</div><div class="line">* -2 = ä¸‹ä¸€è½®æ­»ï¼ˆæœ¬è½®æ­»ï¼‰</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getBoardVal</span><span class="params">(<span class="keyword">int</span>[][] board, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(i &lt; <span class="number">0</span> || i &gt;= board.length || j &lt; <span class="number">0</span> || j &gt;= board[<span class="number">0</span>].length )&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(board[i][j] &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLiveNeighbors</span><span class="params">(<span class="keyword">int</span>[][] board, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> live = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> q = -<span class="number">1</span>; q &lt; <span class="number">2</span>; ++q) &#123;</div><div class="line">        live += getBoardVal(board, i - <span class="number">1</span>, j + q);</div><div class="line">        live += getBoardVal(board, i + <span class="number">1</span>, j + q);</div><div class="line">    &#125;</div><div class="line">    live += getBoardVal(board, i, j + <span class="number">1</span>);</div><div class="line">    live += getBoardVal(board, i, j - <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> live;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">gameOfLife</span><span class="params">(<span class="keyword">int</span>[][] board)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(board.length == <span class="number">0</span> || board[<span class="number">0</span>].length == <span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     *  ä»¤ä¸‹ä¸€æ—¶åˆ»ï¼š</div><div class="line">     * 1 = ä¸‹ä¸€è½®æ´»ï¼ˆæœ¬è½®æ´»ï¼‰</div><div class="line">     * 2 = ä¸‹ä¸€è½®æ­»ï¼ˆæœ¬è½®æ˜¯æ´»çš„ï¼‰</div><div class="line">     *</div><div class="line">     * -1 = å¤æ´»ï¼ˆæœ¬è½®æ˜¯æ­»çš„ï¼‰</div><div class="line">     * 0 = ä¸‹ä¸€è½®æ­»ï¼ˆæœ¬è½®æ­»ï¼‰**/</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; ++j)&#123;</div><div class="line">            <span class="keyword">if</span>(board[i][j] &lt;= <span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(getLiveNeighbors(board,i,j) == <span class="number">3</span>)&#123;</div><div class="line">                    board[i][j] = -<span class="number">1</span>; <span class="comment">// ä¸‹ä¸€è½®å¤æ´»</span></div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">int</span> liveNeibor = getLiveNeighbors(board,i,j);</div><div class="line">                <span class="keyword">if</span>(liveNeibor &lt; <span class="number">2</span> || liveNeibor &gt; <span class="number">3</span>)&#123;<span class="comment">//ä¸‹ä¸€è½®æ­»</span></div><div class="line">                    board[i][j] = <span class="number">2</span>;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;<span class="comment">// ä¸‹ä¸€è½®æ´»</span></div><div class="line">                    <span class="comment">//board[i][j] = 1;</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; ++j)&#123;</div><div class="line">            <span class="keyword">if</span>(board[i][j] == <span class="number">1</span> || board[i][j] == -<span class="number">1</span>)&#123;</div><div class="line">                board[i][j] = <span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                board[i][j] = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Beautiful-Arrangement-II">11.2. Beautiful Arrangement II</h2><p>ç»™ä¸€ä¸ªnå’Œä¸€ä¸ªkã€‚æ±‚ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œè¦æ±‚æ•°ç»„çš„$a_{i+1}-a_i$ è‡³å°‘æœ‰kä¸ªä¸åŒçš„æ•°ã€‚</p>
<p>æ€è·¯ï¼šæ‰¾åˆ°è§„å¾‹ï¼Œç›´æ¥ç”Ÿæˆå³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] constructArray(<span class="keyword">int</span> n, <span class="keyword">int</span> k) &#123;</div><div class="line">        <span class="keyword">int</span>[] nums = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        <span class="keyword">int</span> max = k + <span class="number">1</span>, min = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> filled = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (filled &lt; n )&#123;</div><div class="line">            <span class="keyword">if</span>(max &gt; min)&#123;</div><div class="line">                nums[filled] = min;</div><div class="line">                ++filled;</div><div class="line">                nums[filled] = max;</div><div class="line">                ++filled;</div><div class="line">                --max; ++min;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(max == min)&#123;</div><div class="line">                nums[filled] = max;</div><div class="line">                ++filled;</div><div class="line">                --max;++min;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                nums[filled] = filled + <span class="number">1</span>;</div><div class="line">                ++filled;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> nums;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="1-bit-and-2-bit-Characters">11.3. 1-bit and 2-bit Characters</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ç”±1æˆ–0.å…¶ä¸­<code>0</code>ä»£è¡¨ä¸€ä¸ªä¸œè¥¿ï¼Œ<code>10 or 11</code> ä»£è¡¨å¦ä¸€ä¸ªä¸œè¥¿ã€‚æ±‚è¿™ä¸ªæ•°ç»„æ˜¯å¦å¯ä»¥ä»¥<code>0</code>ç»“å°¾ã€‚</p>
<p>æ€è·¯ï¼šç¢°åˆ°1å°±è·³ä¸¤æ ¼ï¼Œç¢°åˆ°0å°±åªèƒ½è·³ä¸€æ ¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] bits, <span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(idx &gt;= bits.length) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">if</span>(idx == bits.length - <span class="number">1</span>) <span class="keyword">return</span> bits[idx] == <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(bits[idx] == <span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">return</span> helper(bits, idx + <span class="number">2</span>);</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> helper(bits, idx + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOneBitCharacter</span><span class="params">(<span class="keyword">int</span>[] bits)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> helper(bits,<span class="number">0</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Multiply-Strings">11.4. Multiply Strings</h2><p>è®¡ç®—å­—ç¬¦ä¸²çš„å¤§æ•°ä¹˜æ³•</p>
<p>æˆ‘çš„æ€è·¯ï¼šæŒ‰ç…§ç«–å¼è®¡ç®—ä¹˜æ³•çš„æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">multiply</span><span class="params">(String num1, String num2)</span> </span>&#123;</div><div class="line">      <span class="keyword">if</span>((num1.length() == <span class="number">0</span> || num2.length() == <span class="number">0</span>)||</div><div class="line">          (num1.length() == <span class="number">1</span> &amp;&amp; num1.equals(<span class="string">"0"</span>))||</div><div class="line">          (num2.length() == <span class="number">1</span> &amp;&amp; num2.equals(<span class="string">"0"</span>))) <span class="keyword">return</span> <span class="string">"0"</span>;</div><div class="line">      <span class="keyword">if</span>(num1.length() &gt; num2.length())&#123;</div><div class="line">          String temp = num1;</div><div class="line">          num1 = num2;</div><div class="line">          num2 = temp;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">int</span>[] nums1 = <span class="keyword">new</span> <span class="keyword">int</span>[num1.length()], nums2 = <span class="keyword">new</span> <span class="keyword">int</span>[num2.length()];</div><div class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num1.length(); ++i) nums1[i] = num1.charAt(i) - <span class="string">'0'</span>;</div><div class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num2.length(); ++i) nums2[i] = num2.charAt(i) - <span class="string">'0'</span>;</div><div class="line">      <span class="comment">// num1 æ˜¯çŸ­çš„ï¼Œnum2æ˜¯é•¿çš„</span></div><div class="line">      <span class="keyword">int</span> n1 = num1.length(), n2 = num2.length();</div><div class="line">      <span class="keyword">int</span>[][] temp = <span class="keyword">new</span> <span class="keyword">int</span>[n1][n2];</div><div class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = n1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)&#123;</div><div class="line">          <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n2; ++j)&#123;</div><div class="line">              temp[i][j] = nums1[n1 - i - <span class="number">1</span>] * nums2[n2 - j - <span class="number">1</span>];</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line">      StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">      <span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">      <span class="keyword">int</span> last = <span class="number">0</span>;</div><div class="line">      <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</div><div class="line">          <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">          <span class="keyword">boolean</span> finsh = <span class="keyword">true</span>;</div><div class="line">          <span class="keyword">for</span>(<span class="keyword">int</span> line = <span class="number">0</span>; line &lt; n1; ++line)&#123;</div><div class="line">              <span class="keyword">if</span>(j - line &gt;= <span class="number">0</span> &amp;&amp; j - line &lt; n2)&#123;</div><div class="line">                  sum += temp[line][j - line];</div><div class="line">                  finsh = <span class="keyword">false</span>;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">if</span>(j - line &lt; <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">if</span>(finsh) <span class="keyword">break</span>;</div><div class="line">          sum += last;</div><div class="line">          last = sum / <span class="number">10</span>;</div><div class="line">          sum = sum % <span class="number">10</span>;</div><div class="line">          sb.append(sum);</div><div class="line">          ++j;</div><div class="line"></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(last &gt; <span class="number">0</span>)sb.append(last);</div><div class="line">      <span class="keyword">return</span> sb.reverse().toString();</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>è‡ªå·±å­å“§å­å“§å†™åŠå¤©ï¼Œè¿˜æ˜¯äººå®¶å†™çš„å¥½ã€‚ã€‚ã€‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">multiply</span><span class="params">(String nums1, String nums2)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> m = num1.length(), n = num2.length();</div><div class="line">  <span class="keyword">int</span>[] pos = <span class="keyword">new</span> <span class="keyword">int</span>[m + n];</div><div class="line">  </div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = n - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)&#123;</div><div class="line">      <span class="keyword">int</span> mul = (num1.charAt(i) - <span class="string">'0'</span>) * (num2.charAt(j) - <span class="string">'0'</span>);</div><div class="line">      <span class="keyword">int</span> p1 = i + j, p2 = p1 + <span class="number">1</span>; <span class="comment">// è¿™ä¸ªæˆ‘è‡ªå·±æ€ä¹ˆå°±æƒ³ä¸åˆ°å‘¢ï¼Œå“ï¼Œå…¶å®å°±æ˜¯çŸ©é˜µçš„å¯¹è§’çº¿å•Šï¼</span></div><div class="line">      mol += pos(p2);</div><div class="line">      pos[p1] += sum/<span class="number">10</span>;</div><div class="line">      pos[p2] = sum%<span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> p : pos)<span class="keyword">if</span>(!(sb.length() == <span class="number">0</span> &amp;&amp; p = <span class="number">0</span>)) sb.append(p);</div><div class="line">  <span class="keyword">return</span> sb.length() == <span class="number">0</span> ? <span class="string">"0"</span> : sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="H-Index">11.5. H-Index</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œä»£è¡¨ä¸€ä¸ªä½œè€…çš„å„è®ºæ–‡å¼•ç”¨æ¬¡æ•°ã€‚æ±‚hã€‚å…¶ä¸­hä»£è¡¨è¿™ä¸ªä½œè€…æœ‰hç¯‡æ–‡ç« çš„å¼•ç”¨æ¬¡æ•°è‡³å°‘ä¸ºhã€‚</p>
<p><strong>æ€è·¯1ï¼Œ æ’åºï¼Œ$O(nlogn)$</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hIndex</span><span class="params">(<span class="keyword">int</span>[] citations)</span> </span>&#123;</div><div class="line">        <span class="comment">// æœ‰hç¯‡çš„å¼•ç”¨é«˜äºhï¼Œå‰©ä¸‹çš„éƒ½ä¸é«˜äºh</span></div><div class="line">        <span class="keyword">if</span>(citations.length == <span class="number">0</span>) <span class="keyword">return</span> citations.length;</div><div class="line">        <span class="keyword">if</span>(citations.length == <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(citations[<span class="number">0</span>] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        Arrays.sort(citations);</div><div class="line">        <span class="keyword">if</span>(citations[citations.length - <span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// å¼•ç”¨æ¬¡æ•°å…¨ä¸º0çš„æƒ…å†µ</span></div><div class="line">        <span class="keyword">int</span> h = citations.length;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = citations.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; --i)&#123;</div><div class="line">            <span class="comment">// citations[i,n] &gt; citations[i-1]ï¼Œä¸”[i,n]ä¸ªæ•°ä¸ºcitations.length - iä¸ª</span></div><div class="line">            <span class="keyword">if</span>(citations[i-<span class="number">1</span>] &lt;= citations.length - i)&#123;</div><div class="line">                h = citations.length - i;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> h;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œæ¡¶æ’åº</strong></p>
<p>å› ä¸ºhç»å¯¹ä¸ä¼šå¤§äºnï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰å¤§äºnçš„å¼•ç”¨å…¨éƒ¨è®¤ä¸ºæ˜¯nã€‚è¿™æ ·å°±å¯ä»¥ç»Ÿè®¡å¼•ç”¨æ¬¡æ•°ä¸º0-nçš„è®ºæ–‡çš„ä¸ªæ•°ã€‚</p>
<p><img src="http://i67.tinypic.com/2yvpfv5.jpg" alt="Buckets"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hIndex</span><span class="params">(<span class="keyword">int</span>[] citations)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = citations.length;</div><div class="line">    <span class="keyword">int</span>[] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>];</div><div class="line">     <span class="comment">// ç»Ÿè®¡å¼•ç”¨æ¬¡æ•°ä¸º0-nçš„è®ºæ–‡çš„ä¸ªæ•°</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> c : citations) &#123;</div><div class="line">        <span class="keyword">if</span>(c &gt;= n) &#123;</div><div class="line">            buckets[n]++;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            buckets[c]++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">        <span class="comment">// count = å¼•ç”¨æ¬¡æ•°å¤§äºç­‰äºiçš„è®ºæ–‡ä¸ªæ•°</span></div><div class="line">        count += buckets[i];</div><div class="line">        <span class="keyword">if</span>(count &gt;= i) &#123;</div><div class="line">            <span class="keyword">return</span> i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="H-Index-II">11.6. H-Index II</h2><p>å¦‚æœè¾“å…¥æ•°ç»„å·²æ’åºå‘¢ï¼Ÿ</p>
<p><strong>æ€è·¯1ï¼šä¸Šé¢˜æ€è·¯1</strong></p>
<p><strong>æ€è·¯2ï¼ŒäºŒåˆ†æ³•</strong></p>
<p>éªšæ“ä½œå•Šéªšæ“ä½œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hIndex</span><span class="params">(<span class="keyword">int</span>[] citations)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(citations == <span class="keyword">null</span> || citations.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = citations.length;</div><div class="line">    <span class="keyword">int</span> n = citations.length;</div><div class="line">    <span class="keyword">while</span>(l &lt; r)&#123;</div><div class="line">        <span class="keyword">int</span> mid = l + (r - l) / <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>(citations[mid] == n - mid) <span class="keyword">return</span> n - mid;</div><div class="line">        <span class="keyword">if</span>(citations[mid] &lt; citations.length - mid) l = mid + <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> r = mid;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> n - l;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="åŠ å‡ä¹˜é™¤é—®é¢˜">12. åŠ å‡ä¹˜é™¤é—®é¢˜</h1><h2 id="Pow-x-n">12.1. Pow(x, n)</h2><p>å®ç°$x^n$ æ“ä½œ</p>
<p>äºŒåˆ†æ³•ï¼š$2^{10}={2^2}^{5}  $</p>
<p>ç¬¬ä¸€æ¬¡å†™å‡ºæ¥çš„é€’å½’ï¼Œç»“æœçˆ†æ ˆäº†ï¼Œç°åœ¨æ”¹æˆéé€’å½’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">helper</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = x;</div><div class="line">    <span class="keyword">double</span> another = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</div><div class="line">        <span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">1</span>) another = another*result;</div><div class="line">        result = result * result;</div><div class="line">        n = n / <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>)<span class="keyword">break</span>;</div><div class="line">         <span class="keyword">if</span>(result == Double.POSITIVE_INFINITY)&#123;</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result*another;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">myPow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">if</span>(n == -<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>/x;</div><div class="line">    <span class="keyword">if</span>(x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(x == -<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>/helper(x,-n);</div><div class="line">    <span class="keyword">return</span> helper(x,n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Largest-Number">12.2. Largest Number</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œç”¨å…ƒç´ ç»„æˆä¸€ä¸ªæœ€å¤§çš„æ•´æ•°</p>
<p>å“ã€‚è°ƒäº†å¥½ä¹…ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">intDigit</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">        <span class="comment">// ç»Ÿè®¡æ•´æ•°æœ‰å¤šå°‘ä½æ•°å­—</span></div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (val &gt; <span class="number">0</span>)&#123;</div><div class="line">            ++counter;</div><div class="line">            val /= <span class="number">10</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line">    &#125;</div><div class="line">    Comparator&lt;Integer&gt; cmp = <span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(o1 == <span class="number">0</span> || o2 == <span class="number">0</span>) <span class="keyword">return</span> o2.compareTo(o1);</div><div class="line">            <span class="keyword">if</span>(o1.equals(o2)) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            <span class="keyword">int</span> o1Digit = intDigit(o1);</div><div class="line">            <span class="keyword">int</span> o2Digit = intDigit(o2);</div><div class="line">            <span class="keyword">double</span> candidate1 = o1 * (<span class="keyword">double</span>)Math.pow(<span class="number">10</span>, o2Digit) + o2;</div><div class="line">            <span class="keyword">double</span> candidate2 = o2 * (<span class="keyword">double</span>)Math.pow(<span class="number">10</span>, o1Digit) + o1;</div><div class="line">            <span class="keyword">if</span>(candidate1 &gt; candidate2)&#123; <span class="comment">// o1åº”è¯¥æ”¾å‰é¢</span></div><div class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">largestNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"0"</span>;</div><div class="line">        Integer[] numsCopy = <span class="keyword">new</span> Integer[nums.length];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)&#123;numsCopy[i] = nums[i];&#125;</div><div class="line">        Arrays.sort(numsCopy,cmp);</div><div class="line">        <span class="keyword">if</span>(numsCopy[<span class="number">0</span>] == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"0"</span>;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span>(Integer e : numsCopy)&#123;</div><div class="line">            sb.append(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒèµ„æ–™">13. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="https://discuss.leetcode.com/topic/107998/most-consistent-ways-of-dealing-with-the-series-of-stock-problems" target="_blank" rel="external">Most consistent ways of dealing with the series of stock problems</a></li>
<li><a href="https://www.jianshu.com/p/9fa0faff99da" target="_blank" rel="external">ã€åˆ·é¢˜æ€»ç»“ã€‘ä¹°å–è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦é—®é¢˜</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ å®è·µ-1-4-2-ç”¨ç¥ç»ç½‘ç»œè¯†åˆ«çŒ«]]></title>
      <url>/2017/12/10/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-1-4-2-%E7%94%A8%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AF%86%E5%88%AB%E7%8C%AB/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª<a href="http://blog.csdn.net/koala_tree/article/details/78092337" target="_blank" rel="external">å´æ©è¾¾Courseraæ·±åº¦å­¦ä¹ è¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šï¼ˆ1-4ï¼‰</a></p>
<p>å´æ©è¾¾Courseraè¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šç³»åˆ—ï¼Œæœ¬æ–‡ä¸ºã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹éƒ¨åˆ†çš„ç¬¬å››å‘¨â€œæ·±å±‚ç¥ç»ç½‘ç»œâ€çš„è¯¾ç¨‹ä½œä¸šã€‚</p>
<p>æœ¬èŠ‚çš„ä¸»è¦å†…å®¹æ˜¯ï¼šåˆ©ç”¨ä¹‹å‰å®ç°çš„ç¥ç»ç½‘ç»œï¼Œæ¥è¯†åˆ«å›¾ç‰‡ä¸­çš„çŒ«</p>
<a id="more"></a>
<h1 id="import">1. import</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">"ignore"</span>) </div><div class="line"></div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> h5py</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> scipy</div><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</div><div class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> ndimage</div><div class="line"><span class="keyword">from</span> dnn_app_utils_v2 <span class="keyword">import</span> *</div><div class="line"></div><div class="line">%matplotlib inline</div><div class="line">plt.rcParams[<span class="string">'figure.figsize'</span>] = (<span class="number">5.0</span>, <span class="number">4.0</span>) <span class="comment"># set default size of plots</span></div><div class="line">plt.rcParams[<span class="string">'image.interpolation'</span>] = <span class="string">'nearest'</span></div><div class="line">plt.rcParams[<span class="string">'image.cmap'</span>] = <span class="string">'gray'</span></div><div class="line"></div><div class="line">%load_ext autoreload</div><div class="line">%autoreload <span class="number">2</span></div><div class="line"></div><div class="line">np.random.seed(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</code></pre><h1 id="æ•°æ®é›†">2. æ•°æ®é›†</h1><p>ç”¨åˆ°â€œçŒ«-éçŒ«â€æ•°æ®é›† <code>data.h5</code> :</p>
<ul>
<li>training set : m_train</li>
<li>test set : m_test</li>
<li>æ¯ä¸ªå›¾ç‰‡çš„å¤§å°æ˜¯ (num_px, num_px, 3) </li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å›¾ç‰‡åŠ è½½å‡ºæ¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">()</span>:</span></div><div class="line">    train_dataset = h5py.File(<span class="string">'datasets/train_catvnoncat.h5'</span>, <span class="string">"r"</span>)</div><div class="line">    train_set_x_orig = np.array(train_dataset[<span class="string">"train_set_x"</span>][:]) <span class="comment"># your train set features</span></div><div class="line">    train_set_y_orig = np.array(train_dataset[<span class="string">"train_set_y"</span>][:]) <span class="comment"># your train set labels</span></div><div class="line"></div><div class="line">    test_dataset = h5py.File(<span class="string">'datasets/test_catvnoncat.h5'</span>, <span class="string">"r"</span>)</div><div class="line">    test_set_x_orig = np.array(test_dataset[<span class="string">"test_set_x"</span>][:]) <span class="comment"># your test set features</span></div><div class="line">    test_set_y_orig = np.array(test_dataset[<span class="string">"test_set_y"</span>][:]) <span class="comment"># your test set labels</span></div><div class="line"></div><div class="line">    classes = np.array(test_dataset[<span class="string">"list_classes"</span>][:]) <span class="comment"># the list of classes</span></div><div class="line">    </div><div class="line">    train_set_y_orig = train_set_y_orig.reshape((<span class="number">1</span>, train_set_y_orig.shape[<span class="number">0</span>]))</div><div class="line">    test_set_y_orig = test_set_y_orig.reshape((<span class="number">1</span>, test_set_y_orig.shape[<span class="number">0</span>]))</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes</div><div class="line"></div><div class="line">train_x_orig, train_y, test_x_orig, test_y, classes = load_data()</div><div class="line"></div><div class="line"><span class="comment"># æ•°æ®é›†æ ·ä¾‹</span></div><div class="line">index = <span class="number">10</span></div><div class="line">plt.imshow(train_x_orig[index])</div><div class="line"><span class="keyword">print</span> (<span class="string">"y = "</span> + str(train_y[<span class="number">0</span>,index]) + <span class="string">". It's a "</span> + classes[train_y[<span class="number">0</span>,index]].decode(<span class="string">"utf-8"</span>) +  <span class="string">" picture."</span>)</div></pre></td></tr></table></figure>
<pre><code>y = 0. It&apos;s a non-cat picture.
</code></pre><p>â€‹    </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-18-09-04.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å†æ¢æ•°æ®é›†</span></div><div class="line"></div><div class="line">m_train = train_x_orig.shape[<span class="number">0</span>]</div><div class="line">num_px = train_x_orig.shape[<span class="number">1</span>]</div><div class="line">m_test = test_x_orig.shape[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="keyword">print</span> (<span class="string">"è®­ç»ƒé›†æ ·æœ¬æ•°: "</span> + str(m_train))</div><div class="line"><span class="keyword">print</span> (<span class="string">"æµ‹è¯•é›†æ ·æœ¬æ•°: "</span> + str(m_test))</div><div class="line"><span class="keyword">print</span> (<span class="string">"å•å¼ å›¾ç‰‡shape: ("</span> + str(num_px) + <span class="string">", "</span> + str(num_px) + <span class="string">", 3)"</span>)</div><div class="line"><span class="keyword">print</span> (<span class="string">"train_x_orig shape: "</span> + str(train_x_orig.shape))</div><div class="line"><span class="keyword">print</span> (<span class="string">"train_y shape: "</span> + str(train_y.shape))</div><div class="line"><span class="keyword">print</span> (<span class="string">"test_x_orig shape: "</span> + str(test_x_orig.shape))</div><div class="line"><span class="keyword">print</span> (<span class="string">"test_y shape: "</span> + str(test_y.shape))</div></pre></td></tr></table></figure>
<pre><code>è®­ç»ƒé›†æ ·æœ¬æ•°: 209
æµ‹è¯•é›†æ ·æœ¬æ•°: 50
å•å¼ å›¾ç‰‡shape: (64, 64, 3)
train_x_orig shape: (209L, 64L, 64L, 3L)
train_y shape: (1L, 209L)
test_x_orig shape: (50L, 64L, 64L, 3L)
test_y shape: (1L, 50L)
</code></pre><p>ä¸ºäº†æ–¹ä¾¿è¿ç®—ï¼Œæˆ‘ä»¬éœ€è¦å°†å›¾ç‰‡reshapeä¸ºæ ‡å‡†æ ¼å¼ï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-15-57-08.png" alt=""><br>è€Œreshapeçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Reshape the training and test examples </span></div><div class="line">train_x_flatten = train_x_orig.reshape(train_x_orig.shape[<span class="number">0</span>], <span class="number">-1</span>).T   <span class="comment"># The "-1" makes reshape flatten the remaining dimensions</span></div><div class="line">test_x_flatten = test_x_orig.reshape(test_x_orig.shape[<span class="number">0</span>], <span class="number">-1</span>).T</div><div class="line"></div><div class="line"><span class="comment"># Standardize data to have feature values between 0 and 1.</span></div><div class="line">train_x = train_x_flatten/<span class="number">255.</span></div><div class="line">test_x = test_x_flatten/<span class="number">255.</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> (<span class="string">"train_x's shape: "</span> + str(train_x.shape))</div><div class="line"><span class="keyword">print</span> (<span class="string">"test_x's shape: "</span> + str(test_x.shape))</div><div class="line"></div><div class="line"><span class="comment"># 12,288  =  64Ã—64Ã—3</span></div></pre></td></tr></table></figure>
<pre><code>train_x&apos;s shape: (12288L, 209L)
test_x&apos;s shape: (12288L, 50L)
</code></pre><p>æ¥ä¸‹æ¥æ¥æ—¶å»ºç«‹åŸºäºæ·±åº¦ç¥ç»ç½‘ç»œçš„å›¾ç‰‡åˆ†ç±»æ¨¡å‹</p>
<p>å»ºç«‹ä¸¤ä¸ªæ¨¡å‹ï¼š</p>
<ul>
<li>ä¸¤å±‚çš„ç¥ç»ç½‘ç»œ</li>
<li>Lå±‚çš„æ·±åº¦ç¥ç»ç½‘ç»œ</li>
</ul>
<h1 id="ä¸¤å±‚ç¥ç»ç½‘ç»œ">3. ä¸¤å±‚ç¥ç»ç½‘ç»œ</h1><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-15-59-23.png" alt=""> </p>
<p>ä¸Šå›¾çš„æ¨¡å‹å¯ä»¥æ€»ç»“ä¸ºï¼šINPUT -&gt; LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID -&gt; OUTPUT.</p>
<p>è¯¦ç»†åœ°è¯´ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<ul>
<li>è¾“å…¥æ˜¯å°†(64,64,3)çš„å›¾ç‰‡reshapeä¸º(12288,1)çš„æ•°æ®ï¼Œä½œä¸º $[x_0,x_1,â€¦,x_{12287}]^T$ - å°†ä¸Šé¢çš„Xä¹˜ä¸Šæƒé‡å‘é‡ï¼š$W^{[1]}$ ï¼Œè€ŒWçš„å¤§å°æ˜¯ $(n^{[1]}, 12288)$</li>
<li>ç„¶ååŠ ä¸Šåç½®å‘é‡ï¼Œå†å¡«å…¥reluå‡½æ•°ä¸­ï¼Œå¾—åˆ°äº†ç»“æœ$[a_0^{[1]}, a_1^{[1]},â€¦, a_{n^{[1]}-1}^{[1]}]^T$</li>
<li>é‡å¤ä¸Šé¢çš„æ­¥éª¤</li>
<li>å°†æœ€ç»ˆçš„ç»“æœé€šè¿‡sigmoidå‡½æ•°ï¼Œå¤§äº0.5çš„ç½®ä¸ºtrueï¼Œå¦åˆ™ç½®ä¸ºfalse</li>
</ul>
<p>å°†ä»¥ä¸Šæµç¨‹åŒ…è£…ä¸ºå‡½æ•°ï¼Œå³ä»¥ä¸‹å‡ ä¸ªï¼š(å·²ç»åœ¨ä¸Šä¸€èŠ‚ä¸­å†™è¿‡äº†ï¼Œæ­¤å¤„ç›´æ¥è°ƒç”¨ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">(n_x, n_h, n_y)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> parameters </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_forward</span><span class="params">(A_prev, W, b, activation)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(AL, Y)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> cost</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_backward</span><span class="params">(dA, cache, activation)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> dA_prev, dW, db</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters, grads, learning_rate)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> parameters</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°ä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">two_layer_model</span><span class="params">(X, Y, layer_dims, learning_rate = <span class="number">0.0075</span>, num_iterations = <span class="number">3000</span>, print_cost = False)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å®ç°ä¸¤å±‚ç¥ç»ç½‘ç»œï¼šLINEAR-&gt;RELU-&gt;LINEAR-&gt;SIGMOID</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    X -- è®­ç»ƒç‰¹å¾ ,n_x ä¸ª</div><div class="line">    Y -- çœŸå®labelå‘é‡</div><div class="line">    layer_dims --  (n_x, n_h, n_y)</div><div class="line">    num_iterations -- è¿­ä»£æ¬¡æ•°</div><div class="line">    learning_rate -- å­¦ä¹ ç‡</div><div class="line">    print_cost -- å¦‚æœä¸ºçœŸï¼Œå°±ä¼šæ¯ä¸€ç™¾æ¬¡è¿­ä»£è¾“å‡ºä¸€æ¬¡cost</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dict, åŒ…å«W1, W2, b1, b2</div><div class="line">    """</div><div class="line">    </div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    grads = &#123;&#125;</div><div class="line">    costs = []</div><div class="line">    m = X.shape[<span class="number">1</span>]</div><div class="line">    (n_x, n_h, n_y) = layer_dims</div><div class="line">    </div><div class="line">    <span class="comment"># åˆå§‹åŒ–</span></div><div class="line">    </div><div class="line">    parameters = initialize_parameters(n_x, n_h, n_y)</div><div class="line">    W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">    b1 = parameters[<span class="string">"b1"</span>]</div><div class="line">    W2 = parameters[<span class="string">"W2"</span>]</div><div class="line">    b2 = parameters[<span class="string">"b2"</span>]</div><div class="line"></div><div class="line">    <span class="comment"># è¿­ä»£</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, num_iterations):</div><div class="line">        <span class="comment"># å‰å‘ä¼ æ’­ï¼š LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID</span></div><div class="line">        <span class="comment"># è¾“å…¥ ï¼š X, W1, b1</span></div><div class="line">        <span class="comment"># è¾“å‡º ï¼š A1, cache1, A2, cache2</span></div><div class="line">        A1, cache1 = linear_activation_forward(X, W1, b1, activation = <span class="string">"relu"</span>)</div><div class="line">        A2, cache2 = linear_activation_forward(A1,W2, b2, activation = <span class="string">"sigmoid"</span>)</div><div class="line">        </div><div class="line">        <span class="comment"># è®¡ç®—cost</span></div><div class="line">        cost = compute_cost(A2, Y)</div><div class="line">        </div><div class="line">        <span class="comment"># åˆå§‹åŒ–åå‘ä¼ æ’­</span></div><div class="line">        dA2 = - (np.divide(Y, A2) - np.divide(<span class="number">1</span> - Y, <span class="number">1</span> - A2))</div><div class="line">        </div><div class="line">        <span class="comment"># åå‘ä¼ æ’­</span></div><div class="line">        <span class="comment"># è¾“å…¥ ï¼š dA2, cache2, cache1</span></div><div class="line">        <span class="comment"># è¾“å‡º ï¼š dA1, dW2, db2; also dA0 (not used), dW1, db1</span></div><div class="line">        </div><div class="line">        dA1, dW2, db2 = linear_activation_backward(dA2, cache2, activation = <span class="string">"sigmoid"</span>)</div><div class="line">        dA0, dW1, db1 = linear_activation_backward(dA1, cache1, activation = <span class="string">"relu"</span>)</div><div class="line">        </div><div class="line">        grads[<span class="string">'dW1'</span>] = dW1</div><div class="line">        grads[<span class="string">'db1'</span>] = db1</div><div class="line">        grads[<span class="string">'dW2'</span>] = dW2</div><div class="line">        grads[<span class="string">'db2'</span>] = db2</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="comment"># æ›´æ–°å‚æ•°</span></div><div class="line">        parameters = update_parameters(parameters, grads, learning_rate)</div><div class="line">        </div><div class="line">        W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">        b1 = parameters[<span class="string">"b1"</span>]</div><div class="line">        W2 = parameters[<span class="string">"W2"</span>]</div><div class="line">        b2 = parameters[<span class="string">"b2"</span>]</div><div class="line">        </div><div class="line">        <span class="comment"># æ‰“å°</span></div><div class="line">        <span class="keyword">if</span> print_cost <span class="keyword">and</span> i % <span class="number">100</span> == <span class="number">0</span>:</div><div class="line">            print(<span class="string">"Cost after iteration &#123;&#125;: &#123;&#125;"</span>.format(i, np.squeeze(cost)))</div><div class="line">        <span class="keyword">if</span> print_cost <span class="keyword">and</span> i % <span class="number">100</span> == <span class="number">0</span>:</div><div class="line">            costs.append(cost)</div><div class="line">    </div><div class="line">        </div><div class="line">    <span class="comment"># plot the cost</span></div><div class="line"></div><div class="line">    plt.plot(np.squeeze(costs))</div><div class="line">    plt.ylabel(<span class="string">'cost'</span>)</div><div class="line">    plt.xlabel(<span class="string">'iterations (per tens)'</span>)</div><div class="line">    plt.title(<span class="string">"Learning rate ="</span> + str(learning_rate))</div><div class="line">    plt.show()</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line">n_x = <span class="number">12288</span>     <span class="comment"># num_px * num_px * 3</span></div><div class="line">n_h = <span class="number">7</span></div><div class="line">n_y = <span class="number">1</span></div><div class="line">layers_dims = (n_x, n_h, n_y)</div><div class="line">parameters = two_layer_model(train_x, train_y, layers_dims, num_iterations = <span class="number">2500</span>, print_cost=<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<pre><code>Cost after iteration 0: 0.69304973566
Cost after iteration 100: 0.646432095343
Cost after iteration 200: 0.632514064791
Cost after iteration 300: 0.601502492035
Cost after iteration 400: 0.560196631161
Cost after iteration 500: 0.515830477276
Cost after iteration 600: 0.475490131394
Cost after iteration 700: 0.433916315123
Cost after iteration 800: 0.40079775362
Cost after iteration 900: 0.358070501132
Cost after iteration 1000: 0.339428153837
Cost after iteration 1100: 0.30527536362
Cost after iteration 1200: 0.274913772821
Cost after iteration 1300: 0.246817682106
Cost after iteration 1400: 0.198507350375
Cost after iteration 1500: 0.174483181126
Cost after iteration 1600: 0.170807629781
Cost after iteration 1700: 0.113065245622
Cost after iteration 1800: 0.0962942684594
Cost after iteration 1900: 0.0834261795973
Cost after iteration 2000: 0.0743907870432
Cost after iteration 2100: 0.0663074813227
Cost after iteration 2200: 0.0591932950104
Cost after iteration 2300: 0.0533614034856
Cost after iteration 2400: 0.0485547856288
</code></pre><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-18-09-35.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># æ¥ä¸‹æ¥é¢„æµ‹</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(X, y, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    This function is used to predict the results of a  L-layer neural network.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    X -- data set of examples you would like to label</div><div class="line">    parameters -- parameters of the trained model</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    p -- predictions for the given dataset X</div><div class="line">    """</div><div class="line"></div><div class="line">    m = X.shape[<span class="number">1</span>]</div><div class="line">    n = len(parameters) / <span class="number">2</span> <span class="comment"># number of layers in the neural network</span></div><div class="line">    p = np.zeros((<span class="number">1</span>,m))</div><div class="line"></div><div class="line">    <span class="comment"># Forward propagation</span></div><div class="line">    probas, caches = L_model_forward(X, parameters)</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># convert probas to 0/1 predictions</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, probas.shape[<span class="number">1</span>]):</div><div class="line">        <span class="keyword">if</span> probas[<span class="number">0</span>,i] &gt; <span class="number">0.1</span>:</div><div class="line">            p[<span class="number">0</span>,i] = <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            p[<span class="number">0</span>,i] = <span class="number">0</span></div><div class="line"></div><div class="line">    print(<span class="string">"Accuracy: "</span>  + str(float(np.sum(p == y)/float(m))))</div><div class="line">    <span class="keyword">return</span> p</div><div class="line"></div><div class="line">predictions_train = predict(train_x, train_y, parameters)</div><div class="line"></div><div class="line">predictions_test = predict(test_x, test_y, parameters)</div></pre></td></tr></table></figure>
<pre><code>Accuracy: 0.961722488038
Accuracy: 0.74
</code></pre><h1 id="Lå±‚æ·±åº¦ç¥ç»ç½‘ç»œ">4. Lå±‚æ·±åº¦ç¥ç»ç½‘ç»œ</h1><p>è™½ç„¶è¯´Lå±‚æ·±åº¦ç¥ç»ç½‘ç»œå¾ˆç¹çï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥ç®€åŒ–å®ƒï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-16-09-01.png" alt=""> </p>
<p>ä¸Šå›¾çš„æ¨¡å‹å¯ä»¥æ€»ç»“ä¸ºï¼š[LINEAR -&gt; RELU] Ã— (L-1) -&gt; LINEAR -&gt; SIGMOID</p>
<p>è¯¦ç»†åœ°è¯´ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<ul>
<li>è¾“å…¥æ˜¯å°†(64,64,3)çš„å›¾ç‰‡reshapeä¸º(12288,1)çš„æ•°æ®ï¼Œä½œä¸º $[x_0,x_1,â€¦,x_{12287}]^T$ - å°†ä¸Šé¢çš„Xä¹˜ä¸Šæƒé‡å‘é‡ï¼š$W^{[1]}$ ï¼Œå†åŠ ä¸Šåç½®$b^{[1]}$ï¼Œä½œä¸ºlinearå•å…ƒ</li>
<li>ç„¶åå°†linearå•å…ƒçš„è¾“å‡ºå¡«å…¥relu-linearå•å…ƒã€‚è¿™ä¸ªè¿‡ç¨‹é‡å¤L-1æ¬¡</li>
<li>å°†æœ€ç»ˆçš„ç»“æœé€šè¿‡sigmoidå‡½æ•°ï¼Œå¤§äº0.5çš„ç½®ä¸ºtrueï¼Œå¦åˆ™ç½®ä¸ºfalse</li>
</ul>
<p>æ„å»ºæ–¹æ³•çš„æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>åˆå§‹åŒ–å‚æ•°</li>
<li>å¾ªç¯ï¼š<ul>
<li>å‰å‘ä¼ æ’­</li>
<li>è®¡ç®—cost</li>
<li>åå‘ä¼ æ’­</li>
<li>æ›´æ–°å‚æ•°</li>
</ul>
</li>
<li>ç”¨è®­ç»ƒå‚æ•°å»é¢„æµ‹label</li>
</ul>
<p>æ‰€éœ€çš„å‡½æ•°ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_deep</span><span class="params">(layer_dims)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> parameters </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_forward</span><span class="params">(X, parameters)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> AL, caches</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(AL, Y)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> cost</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_backward</span><span class="params">(AL, Y, caches)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> grads</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters, grads, learning_rate)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> parameters</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_layer_model</span><span class="params">(X, Y, layers_dims, learning_rate = <span class="number">0.0075</span>, num_iterations = <span class="number">3000</span>, print_cost = False)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Lå±‚ç¥ç»ç½‘ç»œçš„å®ç°ï¼š[LINEAR-&gt;RELU]*(L-1)-&gt;LINEAR-&gt;SIGMOID</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    X -- è®­ç»ƒé›†ï¼Œshape = (num_px * num_px * 3)</div><div class="line">    Y -- labelå‘é‡</div><div class="line">    layers_dims -- list, åŒ…å«æ¯å±‚è¾“å…¥æ•°æ®çš„å¤§å°</div><div class="line">    learning_rate -- å­¦ä¹ ç‡</div><div class="line">    num_iterations -- è¿­ä»£æ¬¡æ•°</div><div class="line">    print_cost -- å¦‚æœä¸ºTrueï¼Œå°±æ¯ä¸€ç™¾è½®æ‰“å°ä¸€æ¬¡cost</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- å­¦ä¹ åˆ°çš„å‚æ•°</div><div class="line">    """</div><div class="line">    </div><div class="line">    <span class="comment"># åˆå§‹åŒ–</span></div><div class="line">    costs = []</div><div class="line">    parameters = initialize_parameters_deep(layers_dims)</div><div class="line">    </div><div class="line">    <span class="comment"># å¾ªç¯</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, num_iterations):</div><div class="line">        <span class="comment"># å‰å‘ä¼ æ’­ : [LINEAR -&gt; RELU]*(L-1) -&gt; LINEAR -&gt; SIGMOID</span></div><div class="line">        AL, caches = L_model_forward(X, parameters)</div><div class="line">        </div><div class="line">        <span class="comment"># è®¡ç®—cost</span></div><div class="line">        cost = compute_cost(AL, Y)</div><div class="line">        </div><div class="line">        <span class="comment"># åå‘ä¼ æ’­ï¼š</span></div><div class="line">        grads = L_model_backward(AL, Y, caches)</div><div class="line">        </div><div class="line">        <span class="comment"># æ›´æ–°å‚æ•°</span></div><div class="line">        parameters = update_parameters(parameters, grads, learning_rate)</div><div class="line">        </div><div class="line">        <span class="comment"># Print the cost every 100 training example</span></div><div class="line">        <span class="keyword">if</span> print_cost <span class="keyword">and</span> i % <span class="number">100</span> == <span class="number">0</span>:</div><div class="line">            <span class="keyword">print</span> (<span class="string">"Cost after iteration %i: %f"</span> %(i, cost))</div><div class="line">        <span class="keyword">if</span> print_cost <span class="keyword">and</span> i % <span class="number">100</span> == <span class="number">0</span>:</div><div class="line">            costs.append(cost)</div><div class="line"></div><div class="line">    <span class="comment"># plot the cost</span></div><div class="line">    plt.plot(np.squeeze(costs))</div><div class="line">    plt.ylabel(<span class="string">'cost'</span>)</div><div class="line">    plt.xlabel(<span class="string">'iterations (per tens)'</span>)</div><div class="line">    plt.title(<span class="string">"Learning rate ="</span> + str(learning_rate))</div><div class="line">    plt.show()</div><div class="line"></div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line">       </div><div class="line">    </div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line">parameters = L_layer_model(train_x, train_y, layers_dims, num_iterations = <span class="number">2500</span>, print_cost = <span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<pre><code>Cost after iteration 0: 0.695046
Cost after iteration 100: 0.589260
Cost after iteration 200: 0.523261
Cost after iteration 300: 0.449769
Cost after iteration 400: 0.420900
Cost after iteration 500: 0.372464
Cost after iteration 600: 0.347421
Cost after iteration 700: 0.317192
Cost after iteration 800: 0.266438
Cost after iteration 900: 0.219914
Cost after iteration 1000: 0.143579
Cost after iteration 1100: 0.453092
Cost after iteration 1200: 0.094994
Cost after iteration 1300: 0.080141
Cost after iteration 1400: 0.069402
Cost after iteration 1500: 0.060217
Cost after iteration 1600: 0.053274
Cost after iteration 1700: 0.047629
Cost after iteration 1800: 0.042976
Cost after iteration 1900: 0.039036
Cost after iteration 2000: 0.035683
Cost after iteration 2100: 0.032915
Cost after iteration 2200: 0.030472
Cost after iteration 2300: 0.028388
Cost after iteration 2400: 0.026615
</code></pre><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-18-09-49.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># é¢„æµ‹</span></div><div class="line"></div><div class="line">pred_train = predict(train_x, train_y, parameters)</div><div class="line"></div><div class="line">pred_test = predict(test_x, test_y, parameters)</div></pre></td></tr></table></figure>
<pre><code>Accuracy: 0.980861244019
Accuracy: 0.78
</code></pre><h1 id="ç»“æœåˆ†æ">5. ç»“æœåˆ†æ</h1><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æœ‰å“ªäº›å›¾ç‰‡è¢«æˆ‘ä»¬çš„æ¨¡å‹åˆ†é”™äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print_mislabeled_images(classes, test_x, test_y, pred_test)</div></pre></td></tr></table></figure>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-10-18-10-04.png" alt=""> </p>
<p>æˆ‘ä»¬å‘ç°ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š</p>
<ul>
<li>çŒ«çš„èº«å­æ˜¯æ­ªçš„</li>
<li>çŒ«å‡ºç°åœ¨æŸç§ä¸å®ƒé¢œè‰²ç›¸è¿‘çš„åœ°æ–¹</li>
<li>éæ­£å¸¸é¢œè‰²æˆ–å½¢çŠ¶çš„çŒ«</li>
<li>æ‘„åƒè§’åº¦</li>
<li>æš—ç…§ç‰‡</li>
<li>éå¸¸å¤§æˆ–éå¸¸å°çš„çŒ«</li>
</ul>
<h1 id="dnn-app-utils-v2-py">6. dnn_app_utils_v2.py</h1><p>åœ¨æ­¤é™„ä¸Šé™„å½•çš„ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> h5py</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(Z)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implements the sigmoid activation in numpy</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    Z -- numpy array of any shape</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    A -- output of sigmoid(z), same shape as Z</div><div class="line">    cache -- returns Z as well, useful during backpropagation</div><div class="line">    """</div><div class="line">    </div><div class="line">    A = <span class="number">1</span>/(<span class="number">1</span>+np.exp(-Z))</div><div class="line">    cache = Z</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu</span><span class="params">(Z)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the RELU function.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    Z -- Output of the linear layer, of any shape</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    A -- Post-activation parameter, of the same shape as Z</div><div class="line">    cache -- a python dictionary containing "A" ; stored for computing the backward pass efficiently</div><div class="line">    """</div><div class="line">    </div><div class="line">    A = np.maximum(<span class="number">0</span>,Z)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span>(A.shape == Z.shape)</div><div class="line">    </div><div class="line">    cache = Z </div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu_backward</span><span class="params">(dA, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for a single RELU unit.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    dA -- post-activation gradient, of any shape</div><div class="line">    cache -- 'Z' where we store for computing backward propagation efficiently</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    dZ -- Gradient of the cost with respect to Z</div><div class="line">    """</div><div class="line">    </div><div class="line">    Z = cache</div><div class="line">    dZ = np.array(dA, copy=<span class="keyword">True</span>) <span class="comment"># just converting dz to a correct object.</span></div><div class="line">    </div><div class="line">    <span class="comment"># When z &lt;= 0, you should set dz to 0 as well. </span></div><div class="line">    dZ[Z &lt;= <span class="number">0</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (dZ.shape == Z.shape)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dZ</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid_backward</span><span class="params">(dA, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for a single SIGMOID unit.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    dA -- post-activation gradient, of any shape</div><div class="line">    cache -- 'Z' where we store for computing backward propagation efficiently</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    dZ -- Gradient of the cost with respect to Z</div><div class="line">    """</div><div class="line">    </div><div class="line">    Z = cache</div><div class="line">    </div><div class="line">    s = <span class="number">1</span>/(<span class="number">1</span>+np.exp(-Z))</div><div class="line">    dZ = dA * s * (<span class="number">1</span>-s)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (dZ.shape == Z.shape)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dZ</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">()</span>:</span></div><div class="line">    train_dataset = h5py.File(<span class="string">'datasets/train_catvnoncat.h5'</span>, <span class="string">"r"</span>)</div><div class="line">    train_set_x_orig = np.array(train_dataset[<span class="string">"train_set_x"</span>][:]) <span class="comment"># your train set features</span></div><div class="line">    train_set_y_orig = np.array(train_dataset[<span class="string">"train_set_y"</span>][:]) <span class="comment"># your train set labels</span></div><div class="line"></div><div class="line">    test_dataset = h5py.File(<span class="string">'datasets/test_catvnoncat.h5'</span>, <span class="string">"r"</span>)</div><div class="line">    test_set_x_orig = np.array(test_dataset[<span class="string">"test_set_x"</span>][:]) <span class="comment"># your test set features</span></div><div class="line">    test_set_y_orig = np.array(test_dataset[<span class="string">"test_set_y"</span>][:]) <span class="comment"># your test set labels</span></div><div class="line"></div><div class="line">    classes = np.array(test_dataset[<span class="string">"list_classes"</span>][:]) <span class="comment"># the list of classes</span></div><div class="line">    </div><div class="line">    train_set_y_orig = train_set_y_orig.reshape((<span class="number">1</span>, train_set_y_orig.shape[<span class="number">0</span>]))</div><div class="line">    test_set_y_orig = test_set_y_orig.reshape((<span class="number">1</span>, test_set_y_orig.shape[<span class="number">0</span>]))</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">(n_x, n_h, n_y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Argument:</div><div class="line">    n_x -- size of the input layer</div><div class="line">    n_h -- size of the hidden layer</div><div class="line">    n_y -- size of the output layer</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dictionary containing your parameters:</div><div class="line">                    W1 -- weight matrix of shape (n_h, n_x)</div><div class="line">                    b1 -- bias vector of shape (n_h, 1)</div><div class="line">                    W2 -- weight matrix of shape (n_y, n_h)</div><div class="line">                    b2 -- bias vector of shape (n_y, 1)</div><div class="line">    """</div><div class="line">    </div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    </div><div class="line">    W1 = np.random.randn(n_h, n_x)*<span class="number">0.01</span></div><div class="line">    b1 = np.zeros((n_h, <span class="number">1</span>))</div><div class="line">    W2 = np.random.randn(n_y, n_h)*<span class="number">0.01</span></div><div class="line">    b2 = np.zeros((n_y, <span class="number">1</span>))</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span>(W1.shape == (n_h, n_x))</div><div class="line">    <span class="keyword">assert</span>(b1.shape == (n_h, <span class="number">1</span>))</div><div class="line">    <span class="keyword">assert</span>(W2.shape == (n_y, n_h))</div><div class="line">    <span class="keyword">assert</span>(b2.shape == (n_y, <span class="number">1</span>))</div><div class="line">    </div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> parameters     </div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_deep</span><span class="params">(layer_dims)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Arguments:</div><div class="line">    layer_dims -- python array (list) containing the dimensions of each layer in our network</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dictionary containing your parameters "W1", "b1", ..., "WL", "bL":</div><div class="line">                    Wl -- weight matrix of shape (layer_dims[l], layer_dims[l-1])</div><div class="line">                    bl -- bias vector of shape (layer_dims[l], 1)</div><div class="line">    """</div><div class="line">    </div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    parameters = &#123;&#125;</div><div class="line">    L = len(layer_dims)            <span class="comment"># number of layers in the network</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">1</span>, L):</div><div class="line">        parameters[<span class="string">'W'</span> + str(l)] = np.random.randn(layer_dims[l], layer_dims[l<span class="number">-1</span>]) / np.sqrt(layer_dims[l<span class="number">-1</span>]) <span class="comment">#*0.01</span></div><div class="line">        parameters[<span class="string">'b'</span> + str(l)] = np.zeros((layer_dims[l], <span class="number">1</span>))</div><div class="line">        </div><div class="line">        <span class="keyword">assert</span>(parameters[<span class="string">'W'</span> + str(l)].shape == (layer_dims[l], layer_dims[l<span class="number">-1</span>]))</div><div class="line">        <span class="keyword">assert</span>(parameters[<span class="string">'b'</span> + str(l)].shape == (layer_dims[l], <span class="number">1</span>))</div><div class="line"></div><div class="line">        </div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_forward</span><span class="params">(A, W, b)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the linear part of a layer's forward propagation.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    A -- activations from previous layer (or input data): (size of previous layer, number of examples)</div><div class="line">    W -- weights matrix: numpy array of shape (size of current layer, size of previous layer)</div><div class="line">    b -- bias vector, numpy array of shape (size of the current layer, 1)</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    Z -- the input of the activation function, also called pre-activation parameter </div><div class="line">    cache -- a python dictionary containing "A", "W" and "b" ; stored for computing the backward pass efficiently</div><div class="line">    """</div><div class="line">    </div><div class="line">    Z = W.dot(A) + b</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span>(Z.shape == (W.shape[<span class="number">0</span>], A.shape[<span class="number">1</span>]))</div><div class="line">    cache = (A, W, b)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> Z, cache</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_forward</span><span class="params">(A_prev, W, b, activation)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the forward propagation for the LINEAR-&gt;ACTIVATION layer</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    A_prev -- activations from previous layer (or input data): (size of previous layer, number of examples)</div><div class="line">    W -- weights matrix: numpy array of shape (size of current layer, size of previous layer)</div><div class="line">    b -- bias vector, numpy array of shape (size of the current layer, 1)</div><div class="line">    activation -- the activation to be used in this layer, stored as a text string: "sigmoid" or "relu"</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    A -- the output of the activation function, also called the post-activation value </div><div class="line">    cache -- a python dictionary containing "linear_cache" and "activation_cache";</div><div class="line">             stored for computing the backward pass efficiently</div><div class="line">    """</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> activation == <span class="string">"sigmoid"</span>:</div><div class="line">        <span class="comment"># Inputs: "A_prev, W, b". Outputs: "A, activation_cache".</span></div><div class="line">        Z, linear_cache = linear_forward(A_prev, W, b)</div><div class="line">        A, activation_cache = sigmoid(Z)</div><div class="line">    </div><div class="line">    <span class="keyword">elif</span> activation == <span class="string">"relu"</span>:</div><div class="line">        <span class="comment"># Inputs: "A_prev, W, b". Outputs: "A, activation_cache".</span></div><div class="line">        Z, linear_cache = linear_forward(A_prev, W, b)</div><div class="line">        A, activation_cache = relu(Z)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (A.shape == (W.shape[<span class="number">0</span>], A_prev.shape[<span class="number">1</span>]))</div><div class="line">    cache = (linear_cache, activation_cache)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_forward</span><span class="params">(X, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement forward propagation for the [LINEAR-&gt;RELU]*(L-1)-&gt;LINEAR-&gt;SIGMOID computation</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    X -- data, numpy array of shape (input size, number of examples)</div><div class="line">    parameters -- output of initialize_parameters_deep()</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    AL -- last post-activation value</div><div class="line">    caches -- list of caches containing:</div><div class="line">                every cache of linear_relu_forward() (there are L-1 of them, indexed from 0 to L-2)</div><div class="line">                the cache of linear_sigmoid_forward() (there is one, indexed L-1)</div><div class="line">    """</div><div class="line"></div><div class="line">    caches = []</div><div class="line">    A = X</div><div class="line">    L = len(parameters) // <span class="number">2</span>                  <span class="comment"># number of layers in the neural network</span></div><div class="line">    </div><div class="line">    <span class="comment"># Implement [LINEAR -&gt; RELU]*(L-1). Add "cache" to the "caches" list.</span></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">1</span>, L):</div><div class="line">        A_prev = A </div><div class="line">        A, cache = linear_activation_forward(A_prev, parameters[<span class="string">'W'</span> + str(l)], parameters[<span class="string">'b'</span> + str(l)], activation = <span class="string">"relu"</span>)</div><div class="line">        caches.append(cache)</div><div class="line">    </div><div class="line">    <span class="comment"># Implement LINEAR -&gt; SIGMOID. Add "cache" to the "caches" list.</span></div><div class="line">    AL, cache = linear_activation_forward(A, parameters[<span class="string">'W'</span> + str(L)], parameters[<span class="string">'b'</span> + str(L)], activation = <span class="string">"sigmoid"</span>)</div><div class="line">    caches.append(cache)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span>(AL.shape == (<span class="number">1</span>,X.shape[<span class="number">1</span>]))</div><div class="line">            </div><div class="line">    <span class="keyword">return</span> AL, caches</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(AL, Y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the cost function defined by equation (7).</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    AL -- probability vector corresponding to your label predictions, shape (1, number of examples)</div><div class="line">    Y -- true "label" vector (for example: containing 0 if non-cat, 1 if cat), shape (1, number of examples)</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    cost -- cross-entropy cost</div><div class="line">    """</div><div class="line">    </div><div class="line">    m = Y.shape[<span class="number">1</span>]</div><div class="line"></div><div class="line">    <span class="comment"># Compute loss from aL and y.</span></div><div class="line">    cost = (<span class="number">1.</span>/m) * (-np.dot(Y,np.log(AL).T) - np.dot(<span class="number">1</span>-Y, np.log(<span class="number">1</span>-AL).T))</div><div class="line">    </div><div class="line">    cost = np.squeeze(cost)      <span class="comment"># To make sure your cost's shape is what we expect (e.g. this turns [[17]] into 17).</span></div><div class="line">    <span class="keyword">assert</span>(cost.shape == ())</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> cost</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_backward</span><span class="params">(dZ, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the linear portion of backward propagation for a single layer (layer l)</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    dZ -- Gradient of the cost with respect to the linear output (of current layer l)</div><div class="line">    cache -- tuple of values (A_prev, W, b) coming from the forward propagation in the current layer</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    dA_prev -- Gradient of the cost with respect to the activation (of the previous layer l-1), same shape as A_prev</div><div class="line">    dW -- Gradient of the cost with respect to W (current layer l), same shape as W</div><div class="line">    db -- Gradient of the cost with respect to b (current layer l), same shape as b</div><div class="line">    """</div><div class="line">    A_prev, W, b = cache</div><div class="line">    m = A_prev.shape[<span class="number">1</span>]</div><div class="line"></div><div class="line">    dW = <span class="number">1.</span>/m * np.dot(dZ,A_prev.T)</div><div class="line">    db = <span class="number">1.</span>/m * np.sum(dZ, axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>)</div><div class="line">    dA_prev = np.dot(W.T,dZ)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (dA_prev.shape == A_prev.shape)</div><div class="line">    <span class="keyword">assert</span> (dW.shape == W.shape)</div><div class="line">    <span class="keyword">assert</span> (db.shape == b.shape)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dA_prev, dW, db</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_backward</span><span class="params">(dA, cache, activation)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for the LINEAR-&gt;ACTIVATION layer.</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    dA -- post-activation gradient for current layer l </div><div class="line">    cache -- tuple of values (linear_cache, activation_cache) we store for computing backward propagation efficiently</div><div class="line">    activation -- the activation to be used in this layer, stored as a text string: "sigmoid" or "relu"</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    dA_prev -- Gradient of the cost with respect to the activation (of the previous layer l-1), same shape as A_prev</div><div class="line">    dW -- Gradient of the cost with respect to W (current layer l), same shape as W</div><div class="line">    db -- Gradient of the cost with respect to b (current layer l), same shape as b</div><div class="line">    """</div><div class="line">    linear_cache, activation_cache = cache</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> activation == <span class="string">"relu"</span>:</div><div class="line">        dZ = relu_backward(dA, activation_cache)</div><div class="line">        dA_prev, dW, db = linear_backward(dZ, linear_cache)</div><div class="line">        </div><div class="line">    <span class="keyword">elif</span> activation == <span class="string">"sigmoid"</span>:</div><div class="line">        dZ = sigmoid_backward(dA, activation_cache)</div><div class="line">        dA_prev, dW, db = linear_backward(dZ, linear_cache)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dA_prev, dW, db</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_backward</span><span class="params">(AL, Y, caches)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for the [LINEAR-&gt;RELU] * (L-1) -&gt; LINEAR -&gt; SIGMOID group</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    AL -- probability vector, output of the forward propagation (L_model_forward())</div><div class="line">    Y -- true "label" vector (containing 0 if non-cat, 1 if cat)</div><div class="line">    caches -- list of caches containing:</div><div class="line">                every cache of linear_activation_forward() with "relu" (there are (L-1) or them, indexes from 0 to L-2)</div><div class="line">                the cache of linear_activation_forward() with "sigmoid" (there is one, index L-1)</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    grads -- A dictionary with the gradients</div><div class="line">             grads["dA" + str(l)] = ... </div><div class="line">             grads["dW" + str(l)] = ...</div><div class="line">             grads["db" + str(l)] = ... </div><div class="line">    """</div><div class="line">    grads = &#123;&#125;</div><div class="line">    L = len(caches) <span class="comment"># the number of layers</span></div><div class="line">    m = AL.shape[<span class="number">1</span>]</div><div class="line">    Y = Y.reshape(AL.shape) <span class="comment"># after this line, Y is the same shape as AL</span></div><div class="line">    </div><div class="line">    <span class="comment"># Initializing the backpropagation</span></div><div class="line">    dAL = - (np.divide(Y, AL) - np.divide(<span class="number">1</span> - Y, <span class="number">1</span> - AL))</div><div class="line">    </div><div class="line">    <span class="comment"># Lth layer (SIGMOID -&gt; LINEAR) gradients. Inputs: "AL, Y, caches". Outputs: "grads["dAL"], grads["dWL"], grads["dbL"]</span></div><div class="line">    current_cache = caches[L<span class="number">-1</span>]</div><div class="line">    grads[<span class="string">"dA"</span> + str(L)], grads[<span class="string">"dW"</span> + str(L)], grads[<span class="string">"db"</span> + str(L)] = linear_activation_backward(dAL, current_cache, activation = <span class="string">"sigmoid"</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> reversed(range(L<span class="number">-1</span>)):</div><div class="line">        <span class="comment"># lth layer: (RELU -&gt; LINEAR) gradients.</span></div><div class="line">        current_cache = caches[l]</div><div class="line">        dA_prev_temp, dW_temp, db_temp = linear_activation_backward(grads[<span class="string">"dA"</span> + str(l + <span class="number">2</span>)], current_cache, activation = <span class="string">"relu"</span>)</div><div class="line">        grads[<span class="string">"dA"</span> + str(l + <span class="number">1</span>)] = dA_prev_temp</div><div class="line">        grads[<span class="string">"dW"</span> + str(l + <span class="number">1</span>)] = dW_temp</div><div class="line">        grads[<span class="string">"db"</span> + str(l + <span class="number">1</span>)] = db_temp</div><div class="line"></div><div class="line">    <span class="keyword">return</span> grads</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters, grads, learning_rate)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Update parameters using gradient descent</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    parameters -- python dictionary containing your parameters </div><div class="line">    grads -- python dictionary containing your gradients, output of L_model_backward</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dictionary containing your updated parameters </div><div class="line">                  parameters["W" + str(l)] = ... </div><div class="line">                  parameters["b" + str(l)] = ...</div><div class="line">    """</div><div class="line">    </div><div class="line">    L = len(parameters) // <span class="number">2</span> <span class="comment"># number of layers in the neural network</span></div><div class="line"></div><div class="line">    <span class="comment"># Update rule for each parameter. Use a for loop.</span></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(L):</div><div class="line">        parameters[<span class="string">"W"</span> + str(l+<span class="number">1</span>)] = parameters[<span class="string">"W"</span> + str(l+<span class="number">1</span>)] - learning_rate * grads[<span class="string">"dW"</span> + str(l+<span class="number">1</span>)]</div><div class="line">        parameters[<span class="string">"b"</span> + str(l+<span class="number">1</span>)] = parameters[<span class="string">"b"</span> + str(l+<span class="number">1</span>)] - learning_rate * grads[<span class="string">"db"</span> + str(l+<span class="number">1</span>)]</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(X, y, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    This function is used to predict the results of a  L-layer neural network.</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    X -- data set of examples you would like to label</div><div class="line">    parameters -- parameters of the trained model</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    p -- predictions for the given dataset X</div><div class="line">    """</div><div class="line">    </div><div class="line">    m = X.shape[<span class="number">1</span>]</div><div class="line">    n = len(parameters) // <span class="number">2</span> <span class="comment"># number of layers in the neural network</span></div><div class="line">    p = np.zeros((<span class="number">1</span>,m))</div><div class="line">    </div><div class="line">    <span class="comment"># Forward propagation</span></div><div class="line">    probas, caches = L_model_forward(X, parameters)</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># convert probas to 0/1 predictions</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, probas.shape[<span class="number">1</span>]):</div><div class="line">        <span class="keyword">if</span> probas[<span class="number">0</span>,i] &gt; <span class="number">0.5</span>:</div><div class="line">            p[<span class="number">0</span>,i] = <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            p[<span class="number">0</span>,i] = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="comment">#print results</span></div><div class="line">    <span class="comment">#print ("predictions: " + str(p))</span></div><div class="line">    <span class="comment">#print ("true labels: " + str(y))</span></div><div class="line">    print(<span class="string">"Accuracy: "</span>  + str(np.sum((p == y)/m)))</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> p</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_mislabeled_images</span><span class="params">(classes, X, y, p)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Plots images where predictions and truth were different.</div><div class="line">    X -- dataset</div><div class="line">    y -- true labels</div><div class="line">    p -- predictions</div><div class="line">    """</div><div class="line">    a = p + y</div><div class="line">    mislabeled_indices = np.asarray(np.where(a == <span class="number">1</span>))</div><div class="line">    plt.rcParams[<span class="string">'figure.figsize'</span>] = (<span class="number">40.0</span>, <span class="number">40.0</span>) <span class="comment"># set default size of plots</span></div><div class="line">    num_images = len(mislabeled_indices[<span class="number">0</span>])</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num_images):</div><div class="line">        index = mislabeled_indices[<span class="number">1</span>][i]</div><div class="line">        </div><div class="line">        plt.subplot(<span class="number">2</span>, num_images, i + <span class="number">1</span>)</div><div class="line">        plt.imshow(X[:,index].reshape(<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>), interpolation=<span class="string">'nearest'</span>)</div><div class="line">        plt.axis(<span class="string">'off'</span>)</div><div class="line">        plt.title(<span class="string">"Prediction: "</span> + classes[int(p[<span class="number">0</span>,index])].decode(<span class="string">"utf-8"</span>) + <span class="string">" \n Class: "</span> + classes[y[<span class="number">0</span>,index]].decode(<span class="string">"utf-8"</span>))</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> ç¥ç»ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ å®è·µ-1-4-1-æ„å»ºæ·±å±‚ç¥ç»ç½‘ç»œ]]></title>
      <url>/2017/12/10/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-1-4-1-%E6%9E%84%E5%BB%BA%E6%B7%B1%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª<a href="http://blog.csdn.net/koala_tree/article/details/78092337" target="_blank" rel="external">å´æ©è¾¾Courseraæ·±åº¦å­¦ä¹ è¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šï¼ˆ1-4ï¼‰</a></p>
<p>å´æ©è¾¾Courseraè¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šç³»åˆ—ï¼Œæœ¬æ–‡ä¸ºã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹éƒ¨åˆ†çš„ç¬¬å››å‘¨â€œæ·±å±‚ç¥ç»ç½‘ç»œâ€çš„è¯¾ç¨‹ä½œä¸šã€‚</p>
<p>æœ¬èŠ‚çš„ä¸»è¦å†…å®¹æ˜¯ï¼šå®ç°Lå±‚çš„ç¥ç»ç½‘ç»œ</p>
<h1 id="å¤§çº²">1. å¤§çº²</h1><p>é¦–å…ˆå®Œæˆä¸€äº›helper functionã€‚ç„¶åå†å»ºç«‹ä¸¤å±‚ã€å¤šå±‚ç¥ç»ç½‘ç»œï¼š</p>
<ul>
<li>ä¸¤å±‚å’Œå¤šå±‚ç¥ç»ç½‘ç»œçš„åˆå§‹åŒ–</li>
<li>å®ç°å‰å‘ä¼ æ’­æ¨¡å‹<ul>
<li>å®ç°æŸä¸€å±‚çš„å‰å‘ä¼ æ’­ - è¾“å‡º$Z^{[l]}$</li>
<li>æ¿€æ´»å±‚å·²ç»™å‡º</li>
<li>å°†å‰ä¸¤æ­¥ç»“åˆ</li>
<li>å°†å‰å‘ä¼ æ’­è¿­ä»£L-1æ¬¡ï¼Œç„¶åå°†æ¿€æ´»å±‚åŠ åˆ°æœ€åï¼Œå°±å®Œæˆäº†Lå±‚çš„å‰å‘ä¼ æ’­</li>
</ul>
</li>
<li>è®¡ç®—è¯¯å·®</li>
<li>å®ç°åå‘ä¼ æ’­æ¨¡å‹<ul>
<li>å®ç°æŸä¸€å±‚çš„åå‘ä¼ æ’­</li>
<li>æ¿€æ´»å±‚çš„åå‘ä¼ æ’­å·²ç»™å‡º</li>
<li>å°†å‰ä¸¤æ­¥ç»“åˆ</li>
<li>å°†åå‘ä¼ æ’­è¿­ä»£L-1æ¬¡ï¼Œç„¶åå°†æ¿€æ´»å±‚åŠ åˆ°æœ€åï¼Œå®Œæˆäº†Lå±‚çš„åå‘ä¼ æ’­</li>
</ul>
</li>
<li>æ›´æ–°å‚æ•°</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-08-15-15-25.png" alt=""> </p>
<a id="more"></a>
<h1 id="import">2. import</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">"ignore"</span>) </div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> h5py</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"></div><div class="line">%matplotlib inline</div><div class="line">plt.rcParams[<span class="string">'figure.figsize'</span>] = (<span class="number">5.0</span>, <span class="number">4.0</span>) <span class="comment"># set default size of plots</span></div><div class="line">plt.rcParams[<span class="string">'image.interpolation'</span>] = <span class="string">'nearest'</span></div><div class="line">plt.rcParams[<span class="string">'image.cmap'</span>] = <span class="string">'gray'</span></div><div class="line"></div><div class="line">%load_ext autoreload</div><div class="line">%autoreload <span class="number">2</span></div><div class="line"></div><div class="line">np.random.seed(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<h1 id="åˆå§‹åŒ–">3. åˆå§‹åŒ–</h1><ul>
<li>å®Œæˆä¸¤å±‚æ¨¡å‹çš„åˆå§‹åŒ–</li>
<li>å®Œæˆå¤šå±‚æ¨¡å‹çš„åˆå§‹åŒ–</li>
</ul>
<h2 id="ä¸¤å±‚æ¨¡å‹çš„åˆå§‹åŒ–">3.1. ä¸¤å±‚æ¨¡å‹çš„åˆå§‹åŒ–</h2><ul>
<li>æ¨¡å‹ç»“æ„æ˜¯ï¼š LINEAR - RELU - LINEAR - SIGMOID</li>
<li>ç”¨éšæœºæ•°åˆå§‹åŒ–w</li>
<li>ç”¨0åˆå§‹åŒ–b</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å‚æ•°åˆå§‹åŒ–</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">(n_x, n_h, n_y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å‚æ•°ï¼š</div><div class="line">    n_x -- è¾“å…¥å±‚çš„å¤§å°</div><div class="line">    n_h -- éšè—å±‚çš„å¤§å°</div><div class="line">    n_y -- è¾“å‡ºå±‚çš„å¤§å°</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dict ï¼š</div><div class="line">                    W1 -- weight matrix of shape (n_h, n_x)</div><div class="line">                    b1 -- bias vector of shape (n_h, 1)</div><div class="line">                    W2 -- weight matrix of shape (n_y, n_h)</div><div class="line">                    b2 -- bias vector of shape (n_y, 1)</div><div class="line">    """</div><div class="line">    <span class="comment"># åˆå§‹åŒ–</span></div><div class="line">    W1 = np.random.randn(n_h, n_x)*<span class="number">0.01</span></div><div class="line">    b1 = np.zeros((n_h, <span class="number">1</span>))</div><div class="line">    W2 = np.random.randn(n_y, n_h)*<span class="number">0.01</span></div><div class="line">    b2 = np.zeros((n_y, <span class="number">1</span>))</div><div class="line">    </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span>(W1.shape == (n_h, n_x))</div><div class="line">    <span class="keyword">assert</span>(b1.shape == (n_h, <span class="number">1</span>))</div><div class="line">    <span class="keyword">assert</span>(W2.shape == (n_y, n_h))</div><div class="line">    <span class="keyword">assert</span>(b2.shape == (n_y, <span class="number">1</span>))</div><div class="line"></div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> parameters    </div><div class="line"></div><div class="line">parameters = initialize_parameters(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>)</div><div class="line">print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>]))</div><div class="line">print(<span class="string">"b1 = "</span> + str(parameters[<span class="string">"b1"</span>]))</div><div class="line">print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>]))</div><div class="line">print(<span class="string">"b2 = "</span> + str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>W1 = [[ 0.01624345 -0.00611756 -0.00528172]
 [-0.01072969  0.00865408 -0.02301539]]
b1 = [[ 0.]
 [ 0.]]
W2 = [[ 0.01744812 -0.00761207]]
b2 = [[ 0.]]
</code></pre><h2 id="Lå±‚æ¨¡å‹çš„åˆå§‹åŒ–">3.2. Lå±‚æ¨¡å‹çš„åˆå§‹åŒ–</h2><p>è¿™ä¸ªæ¯”è¾ƒå¤æ‚ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªX.shape = (12288,209)çš„ä¾‹å­:</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>W.shape</strong></th>
<th><strong>b.shape</strong></th>
<th style="text-align:center"><strong>A</strong></th>
<th><strong>A.shape</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Layer 1</strong></td>
<td>(n[1],12288)</td>
<td>(n[1],1)</td>
<td style="text-align:center">Z[1]=W[1]X+b[1]</td>
<td>(n[1],209)</td>
</tr>
<tr>
<td><strong>Layer 2</strong></td>
<td>(n[2],n[1])</td>
<td>(n[2],1)</td>
<td style="text-align:center">Z[2]=W[2]A[1]+b[2]</td>
<td>(n[2],209)</td>
</tr>
<tr>
<td>â‹®</td>
<td>â‹®</td>
<td>â‹®</td>
<td style="text-align:center">â‹®</td>
<td>â‹®</td>
</tr>
<tr>
<td><strong>Layer L-1</strong></td>
<td>(n[Lâˆ’1],n[Lâˆ’2])</td>
<td>(n[Lâˆ’1],1)</td>
<td style="text-align:center">Z[Lâˆ’1]=W[Lâˆ’1]A[Lâˆ’2]+b[Lâˆ’1]</td>
<td>(n[Lâˆ’1],209)</td>
</tr>
<tr>
<td><strong>Layer L</strong></td>
<td>(n[L],n[Lâˆ’1])</td>
<td>(n[L],1)</td>
<td style="text-align:center">Z[L]=W[L]A[Lâˆ’1]+b[L]</td>
<td>(n[L],209)</td>
</tr>
</tbody>
</table>
<p>å®ç°ï¼š</p>
<ul>
<li>æ¨¡å‹ç»“æ„æ˜¯ [LINEAR -&gt; RELU]  Ã—  (L-1) -&gt; LINEAR -&gt; SIGMOID . ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰L-1å±‚çš„ReLUæ¿€æ´»å‡½æ•°ï¼Œè¿˜æœ‰ä¸€å±‚sigmoidè¾“å‡º</li>
<li>wç”¨éšæœºåˆå§‹åŒ–</li>
<li>bç”¨0åˆå§‹åŒ–</li>
<li>å°†$n^{[l]}$å­˜å…¥æ•°ç»„å˜é‡layer_dimsä¸­ï¼Œä»£è¡¨ç¬¬lå±‚çš„n</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_deep</span><span class="params">(layer_dims)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    layer_dims: æ•°ç»„å˜é‡ï¼Œä»£è¡¨æ¯ä¸€å±‚çš„ç»´åº¦</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dict , åŒ…å« "W1", "b1", ..., "WL", "bL":</div><div class="line">            Wl -- æƒé‡çŸ©é˜µï¼ŒW1.shape =  (layer_dims[l], layer_dims[l-1])</div><div class="line">            bl -- åç½®å‘é‡ï¼Œb1.shape =  (layer_dims[l], 1)</div><div class="line"></div><div class="line">    """</div><div class="line">    </div><div class="line">    parameters = &#123;&#125;</div><div class="line">    L = len(layer_dims) <span class="comment"># ç½‘ç»œçš„å±‚æ•°</span></div><div class="line">    </div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">1</span>, L):</div><div class="line">        <span class="comment"># åˆå§‹åŒ–ç¬¬lå±‚å‚æ•°</span></div><div class="line">        parameters[<span class="string">'W'</span> + str(l)] = np.random.randn(layer_dims[l], layer_dims[l<span class="number">-1</span>]) * <span class="number">0.01</span></div><div class="line">        parameters[<span class="string">'b'</span> + str(l)] = np.zeros((layer_dims[l], <span class="number">1</span>))</div><div class="line">        </div><div class="line">        <span class="comment"># éªŒè¯</span></div><div class="line">        <span class="keyword">assert</span>(parameters[<span class="string">'W'</span> + str(l)].shape == (layer_dims[l], layer_dims[l<span class="number">-1</span>]))</div><div class="line">        <span class="keyword">assert</span>(parameters[<span class="string">'b'</span> + str(l)].shape == (layer_dims[l], <span class="number">1</span>))</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line">parameters = initialize_parameters_deep([<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>])</div><div class="line">print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>]))</div><div class="line">print(<span class="string">"b1 = "</span> + str(parameters[<span class="string">"b1"</span>]))</div><div class="line">print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>]))</div><div class="line">print(<span class="string">"b2 = "</span> + str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>W1 = [[ 0.00319039 -0.0024937   0.01462108 -0.02060141 -0.00322417]
 [-0.00384054  0.01133769 -0.01099891 -0.00172428 -0.00877858]
 [ 0.00042214  0.00582815 -0.01100619  0.01144724  0.00901591]
 [ 0.00502494  0.00900856 -0.00683728 -0.0012289  -0.00935769]]
b1 = [[ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]
W2 = [[-0.00267888  0.00530355 -0.00691661 -0.00396754]
 [-0.00687173 -0.00845206 -0.00671246 -0.00012665]
 [-0.0111731   0.00234416  0.01659802  0.00742044]]
b2 = [[ 0.]
 [ 0.]
 [ 0.]]
</code></pre><h1 id="å‰å‘ä¼ æ’­">4. å‰å‘ä¼ æ’­</h1><p>æŒ‰ç…§å¦‚ä¸‹é¡ºåºå®ç°ï¼š</p>
<ul>
<li>LINEAR</li>
<li>LINEAR -&gt; ACTIVATION where ACTIVATION will be either ReLU or Sigmoid.</li>
<li>[LINEAR -&gt; RELU] Ã— (L-1) -&gt; LINEAR -&gt; SIGMOID (whole model)</li>
</ul>
<h2 id="LINEAR">4.1. LINEAR</h2><p>çº¿æ€§æ¨¡å‹å¦‚ä¸‹ï¼š</p>
<p>$$Z^{[l]} = W^{[l]}A^{[l-1]} +b^{[l]}\tag{4}$$</p>
<p>where $A^{[0]} = X$. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_forward</span><span class="params">(A,W,b)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å®ç°å‰å‘ä¼ æ’­çš„çº¿æ€§éƒ¨åˆ†</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    </div><div class="line">    A -- ä¸Šä¸€å±‚çš„è¾“å‡ºï¼Œä¹Ÿæ˜¯æœ¬å±‚çš„è¾“å…¥</div><div class="line">    W -- æƒé‡çŸ©é˜µ ï¼Œ W.shape = (n_(l-1), n_l)</div><div class="line">    b -- åç½®å‘é‡ ï¼Œ b.shape = (n_l , 1)</div><div class="line">    </div><div class="line">    Returns : </div><div class="line">    Z -- æ¿€æ´»å‡½æ•°çš„è¾“å…¥ï¼Œä¹Ÿå«"pre-activation parameter"</div><div class="line">    cache - dictï¼ŒåŒ…å«A,W,b</div><div class="line">    """</div><div class="line">    </div><div class="line">    <span class="comment"># çº¿æ€§éƒ¨åˆ†</span></div><div class="line">    Z = np.dot(W,A) + b</div><div class="line">    </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span>(Z.shape == (W.shape[<span class="number">0</span>], A.shape[<span class="number">1</span>]))</div><div class="line">    </div><div class="line">    <span class="comment"># æš‚å­˜</span></div><div class="line">    cache = (A, W, b)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> Z, cache</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># æµ‹è¯•å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_forward_test_case</span><span class="params">()</span>:</span></div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    <span class="string">"""</span></div><div class="line">    X = np.array([[-1.02387576, 1.12397796],</div><div class="line"> [-1.62328545, 0.64667545],</div><div class="line"> [-1.74314104, -0.59664964]])</div><div class="line">    W = np.array([[ 0.74505627, 1.97611078, -1.24412333]])</div><div class="line">    b = np.array([[1]])</div><div class="line">    """</div><div class="line">    A = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    W = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> A, W, b</div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line">A, W, b = linear_forward_test_case()</div><div class="line"></div><div class="line">Z, linear_cache = linear_forward(A, W, b)</div><div class="line">print(<span class="string">"Z = "</span> + str(Z))</div></pre></td></tr></table></figure>
<pre><code>Z = [[ 3.26295337 -1.23429987]]
</code></pre><p>â€‹    </p>
<h2 id="LINEAR-gt-ACTIVATION">4.2. LINEAR -&gt; ACTIVATION</h2><p>æœ¬å±‚çš„å…¬å¼æ˜¯ï¼š</p>
<p> $A^{[l]} = g(Z^{[l]}) = g(W^{[l]}A^{[l-1]} +b^{[l]})$</p>
<p>å…¶ä¸­,g()æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p>
<p><strong>sigmod</strong> ï¼š </p>
<p>$\sigma(Z) = \sigma(W A + b) = \frac{1}{ 1 + e^{-(W A + b)}}$</p>
<p>sigmodçš„å®ç°å¦‚ä¸‹æ‰€ç¤º</p>
<p>è¾“å‡º:</p>
<ul>
<li>A</li>
<li>cache = z</li>
</ul>
<p><strong>ReLU</strong> :</p>
<p>$A = RELU(Z) = max(0, Z)$</p>
<p>ReLUçš„å®ç°å¦‚ä¸‹æ‰€ç¤º<br>è¾“å‡ºï¼š</p>
<ul>
<li>A</li>
<li>cache = Z</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(Z)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implements the sigmoid activation in numpy</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    Z -- numpy array of any shape</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    A -- output of sigmoid(z), same shape as Z</div><div class="line">    cache -- returns Z as well, useful during backpropagation</div><div class="line">    """</div><div class="line"></div><div class="line">    A = <span class="number">1</span>/(<span class="number">1</span>+np.exp(-Z))</div><div class="line">    cache = Z</div><div class="line"></div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu</span><span class="params">(Z)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the RELU function.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    Z -- Output of the linear layer, of any shape</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    A -- Post-activation parameter, of the same shape as Z</div><div class="line">    cache -- a python dictionary containing "A" ; stored for computing the backward pass efficiently</div><div class="line">    """</div><div class="line"></div><div class="line">    A = np.maximum(<span class="number">0</span>,Z)</div><div class="line"></div><div class="line">    <span class="keyword">assert</span>(A.shape == Z.shape)</div><div class="line"></div><div class="line">    cache = Z </div><div class="line">    <span class="keyword">return</span> A, cache</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å®ç°LINEAR-&gt;ACTIVATIONå±‚</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_forward</span><span class="params">(A_prev, W, b, activation)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    LINEAR-&gt;ACTIVATIONçš„å®ç°</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    A_prev -- ä¸Šä¸€å±‚çš„è¾“å‡º</div><div class="line">    W -- æƒé‡çŸ©é˜µ ï¼Œ W.shape = (n_l, n_(l-1))</div><div class="line">    b -- åç½®å‘é‡ ï¼Œ b.shape = (n_l , 1)</div><div class="line">    activation -- æ¿€æ´»çš„åç§°ï¼Œ"sigmoid"æˆ–"relu"</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    A -- æ¿€æ´»å±‚è¾“å‡ºï¼Œä¹Ÿå«post-activation value</div><div class="line">    cache  -- python dict, åŒ…å« "linear_cache" å’Œ "activation_cache"</div><div class="line">    """</div><div class="line">    </div><div class="line">    <span class="comment"># çº¿æ€§è¾“å‡º</span></div><div class="line">    Z, linear_cache = linear_forward(A_prev, W, b)</div><div class="line">    </div><div class="line">    <span class="comment"># æ¿€æ´»</span></div><div class="line">    <span class="keyword">if</span> activation == <span class="string">"sigmoid"</span>:</div><div class="line">        A, activation_cache = sigmoid(Z)</div><div class="line">        </div><div class="line">    <span class="keyword">elif</span> activation == <span class="string">"relu"</span>:</div><div class="line">        A, activation_cache = relu(Z)</div><div class="line">        </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span> (A.shape == (W.shape[<span class="number">0</span>], A_prev.shape[<span class="number">1</span>]))</div><div class="line">    cache = (linear_cache, activation_cache)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> A, cache</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_forward_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    X = np.array([[-1.02387576, 1.12397796],</div><div class="line"> [-1.62328545, 0.64667545],</div><div class="line"> [-1.74314104, -0.59664964]])</div><div class="line">    W = np.array([[ 0.74505627, 1.97611078, -1.24412333]])</div><div class="line">    b = 5</div><div class="line">    """</div><div class="line">    np.random.seed(<span class="number">2</span>)</div><div class="line">    A_prev = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    W = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span> A_prev, W, b</div><div class="line"></div><div class="line">A_prev, W, b = linear_activation_forward_test_case()</div><div class="line"></div><div class="line">A, linear_activation_cache = linear_activation_forward(A_prev, W, b, activation = <span class="string">"sigmoid"</span>)</div><div class="line">print(<span class="string">"With sigmoid: A = "</span> + str(A))</div><div class="line"></div><div class="line">A, linear_activation_cache = linear_activation_forward(A_prev, W, b, activation = <span class="string">"relu"</span>)</div><div class="line">print(<span class="string">"With ReLU: A = "</span> + str(A))</div></pre></td></tr></table></figure>
<pre><code>With sigmoid: A = [[ 0.96890023  0.11013289]]
With ReLU: A = [[ 3.43896131  0.        ]]
</code></pre><h2 id="L-Model-Forward">4.3. L-Model Forward</h2><ul>
<li>ç”¨RELUï¼Œé‡å¤ä¹‹å‰çš„linear_activation_forwardï¼ŒL-1æ¬¡</li>
<li>æœ€åè¾“å…¥SIGMOID çš„linear_activation_forward</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-08-16-51-52.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_forward</span><span class="params">(X, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å®ç°åå‘ä¼ æ’­çš„[LINEAR-&gt;RELU]*(L-1)-&gt;LINEAR-&gt;SIGMOIDæ­¥éª¤</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    </div><div class="line">    X -- æ•°æ®é›†</div><div class="line">    parameters -- initialize_parameters_deep()çš„è¾“å‡ºï¼Œæ˜¯å¤šå±‚ç½‘ç»œåˆå§‹åŒ–åçš„å‚æ•°</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    </div><div class="line">    AL -- æœ€ç»ˆè¾“å‡º</div><div class="line">    caches -- æ¯å±‚çš„cachesï¼š</div><div class="line">            1 ~ L - 1å±‚ çš„ linear_relu_forward()</div><div class="line">            L å±‚ çš„ linear_sigmoid_forward()</div><div class="line">    """</div><div class="line">    </div><div class="line">    caches = []</div><div class="line">    L = len(parameters) / <span class="number">2</span></div><div class="line">    A = X</div><div class="line">    </div><div class="line">    <span class="comment"># 1~ L-1 å±‚ï¼Œè¿­ä»£</span></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">1</span>,L):</div><div class="line">        A_prev = A</div><div class="line">        A, cache = linear_activation_forward(A_prev, parameters[<span class="string">'W'</span> + str(l)], parameters[<span class="string">'b'</span> + str(l)], <span class="string">"relu"</span>)</div><div class="line">        caches.append(cache)</div><div class="line">        </div><div class="line">    <span class="comment"># L å±‚     </span></div><div class="line">    AL, cache = linear_activation_forward(A, parameters[<span class="string">'W'</span> + str(L)], parameters[<span class="string">'b'</span> + str(L)], <span class="string">"sigmoid"</span>)</div><div class="line">    caches.append(cache)</div><div class="line">        </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span>(AL.shape == (<span class="number">1</span>,X.shape[<span class="number">1</span>]))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> AL, caches</div><div class="line"></div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_forward_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    X = np.array([[-1.02387576, 1.12397796],</div><div class="line"> [-1.62328545, 0.64667545],</div><div class="line"> [-1.74314104, -0.59664964]])</div><div class="line">    parameters = &#123;'W1': np.array([[ 1.62434536, -0.61175641, -0.52817175],</div><div class="line">        [-1.07296862,  0.86540763, -2.3015387 ]]),</div><div class="line"> 'W2': np.array([[ 1.74481176, -0.7612069 ]]),</div><div class="line"> 'b1': np.array([[ 0.],</div><div class="line">        [ 0.]]),</div><div class="line"> 'b2': np.array([[ 0.]])&#125;</div><div class="line">    """</div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    X = np.random.randn(<span class="number">4</span>,<span class="number">2</span>)</div><div class="line">    W1 = np.random.randn(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">    b1 = np.random.randn(<span class="number">3</span>,<span class="number">1</span>)</div><div class="line">    W2 = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b2 = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> X, parameters</div><div class="line"></div><div class="line"><span class="comment"># è·å–Xå’Œåˆå§‹åŒ–å‚æ•°</span></div><div class="line">X, parameters = L_model_forward_test_case()</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"X.shape = "</span> + str(X.shape) , <span class="string">"ï¼Œå³"</span>,X.shape[<span class="number">0</span>],<span class="string">"è¡Œ"</span>,X.shape[<span class="number">1</span>],<span class="string">"åˆ—"</span></div><div class="line"></div><div class="line"><span class="comment"># å‰å‘ä¼ æ’­</span></div><div class="line">AL, caches = L_model_forward(X, parameters)</div><div class="line">print(<span class="string">"AL = "</span> + str(AL))</div><div class="line">print(<span class="string">"Length of caches list = "</span> + str(len(caches)))</div></pre></td></tr></table></figure>
<pre><code>X.shape = (4L, 2L) ï¼Œå³ 4 è¡Œ 2 åˆ—
AL = [[ 0.17007265  0.2524272 ]]
Length of caches list = 2
</code></pre><h1 id="è®¡ç®—è¯¯å·®">5. è®¡ç®—è¯¯å·®</h1><p>è¯¯å·®å…¬å¼å¦‚ä¸‹ï¼š</p>
<p> $$-\frac{1}{m} \sum\limits_{i = 1}^{m} (y^{(i)}\log\left(a^{[L] (i)}\right) + (1-y^{(i)})\log\left(1- a^{<a href="i">L</a>}\right)) \tag{7}$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(AL, Y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å®ç°å…¬å¼7çš„è¯¯å·®è®¡ç®—</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    AL -- ä¸Šä¸€æ­¥è®¡ç®—å‡ºçš„ç»“æœ</div><div class="line">    Y -- å®é™…çš„label</div><div class="line">    </div><div class="line">    Returns : </div><div class="line">    cost -- äº¤å‰ç†µè¯¯å·®</div><div class="line">    """</div><div class="line">    </div><div class="line">    m = Y.shape[<span class="number">1</span>]</div><div class="line">    </div><div class="line">    <span class="comment"># è®¡ç®—</span></div><div class="line">    cost = -np.sum(np.multiply(np.log(AL),Y) + np.multiply(np.log(<span class="number">1</span> - AL), <span class="number">1</span> - Y)) / m</div><div class="line">    cost = np.squeeze(cost)</div><div class="line">    </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span>(cost.shape == ())</div><div class="line"></div><div class="line">    <span class="keyword">return</span> cost</div><div class="line">    </div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost_test_case</span><span class="params">()</span>:</span></div><div class="line">    Y = np.asarray([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]])</div><div class="line">    aL = np.array([[<span class="number">.8</span>,<span class="number">.9</span>,<span class="number">0.4</span>]])</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> Y, aL</div><div class="line"></div><div class="line">Y, AL = compute_cost_test_case()</div><div class="line"></div><div class="line">print(<span class="string">"cost = "</span> + str(compute_cost(AL, Y)))</div></pre></td></tr></table></figure>
<pre><code>cost = 0.414931599615
</code></pre><p>â€‹    </p>
<h1 id="åå‘ä¼ æ’­">6. åå‘ä¼ æ’­</h1><p>åå‘ä¼ æ’­æ˜¯ç”¨æ¥è®¡ç®—æ¢¯åº¦çš„</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-08-17-11-51.png" alt=""> </p>
<p>ç´«è‰²æ–¹å—ä»£è¡¨å‰å‘ä¼ æ’­<br>çº¢è‰²æ–¹å—ä»£è¡¨åå‘ä¼ æ’­</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¡ç®—å‡º$dw^{[l]}å’Œdb^{[l]}, l = 1,2,â€¦L$ï¼Œä»¥ä¾¿ä¹‹åæ›´æ–°wå’Œbã€‚</p>
<p>ä¸ºäº†è®¡ç®—$dw^{[1]}å’Œdb^{[1]}$ï¼Œè¦ä½¿ç”¨å¦‚ä¸‹é“¾å¼æ³•åˆ™ï¼š</p>
<p>$dw^{[1]}=\frac{dL}{dw^{[1]}}=\frac{dL}{dz^{[1]}} \times \frac{dz}{dw^{[1]}}=dz^{[1]}\times \frac{dz}{dw^{[1]}}$</p>
<p>$db^{[1]}=\frac{dL}{db^{[1]}} = \frac{dL}{dz^{[1]}} \times \frac{dz^{[1]}}{db^{[1]}} = dz^{[1]} \times \frac{dz^{[1]}}{db^{[1]}}$</p>
<p>å› æ­¤æˆ‘ä»¬é¦–å…ˆè¦ç®—å‡º$dz^{[1]}$ : </p>
<p>$$\frac{dL(a^{[2]},y)}{dz^{[1]}}=\frac{dL(a^{[2]},y)}{da^{[2]}}\frac{da^{[2]}}{dz^{[2]}}\frac{dz^{[2]}}{da^{[1]}}\frac{da^{[1]}}{dz^{[1]}}$$</p>
<p>è€Œè¦ç®—å‡º$dz^{[1]}$ï¼Œç”±ä¸Šå…¬ç¤ºå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¿…é¡»å…ˆè®¡ç®—$dz^{[2]}$ç­‰</p>
<p>å› æ­¤æ­¤è¿‡ç¨‹å«åš<strong>åå‘ä¼ æ’­</strong></p>
<p>æ€»ä¹‹ï¼Œåå‘ä¼ æ’­éœ€è¦å®Œæˆï¼š</p>
<ul>
<li>LINEAR</li>
<li>LINEAR -&gt; ACTIVATION </li>
<li>[LINEAR -&gt; RELU] Ã— (L-1) -&gt; LINEAR -&gt; SIGMOID backward (whole model)</li>
</ul>
<h2 id="LINEAR-1">6.1. LINEAR</h2><p>å¯¹äºç¬¬lå±‚æ¥è¯´ï¼Œè¿™ä¸€å±‚çš„Linearéƒ¨åˆ†æ˜¯ï¼š$Z^{[l]} = W^{[l]} A^{[l-1]} + b^{[l]}$</p>
<p>å‡è®¾æ­¤æ—¶ä½ å·²ç»è®¡ç®—å¥½äº† $dZ^{[l]} = \frac{\partial \mathcal{L} }{\partial Z^{[l]}}$</p>
<p>ä½ æ¥ä¸‹æ¥æƒ³è¦å¾—åˆ°$(dW^{[l]}, db^{[l]} dA^{[l-1]})$</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-08-20-17-43.png" alt=""> </p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å…¬å¼ï¼Œé€šè¿‡$dZ^{[l]}$æ¥è®¡ç®—å‡ºè¿™ä¸‰ä¸ªä¸œè¥¿$(dW^{[l]}, db^{[l]}, dA^{[l-1]})$:</p>
<p>$$ dW^{[l]} = \frac{\partial \mathcal{L} }{\partial W^{[l]}} = \frac{1}{m} dZ^{[l]} A^{[l-1] T} \tag{8}$$<br>$$ db^{[l]} = \frac{\partial \mathcal{L} }{\partial b^{[l]}} = \frac{1}{m} \sum_{i = 1}^{m} dZ^{<a href="i">l</a>}\tag{9}$$<br>$$ dA^{[l-1]} = \frac{\partial \mathcal{L} }{\partial A^{[l-1]}} = W^{[l] T} dZ^{[l]} \tag{10}$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_backward</span><span class="params">(dZ, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    å®ç°åå‘ä¼ æ’­çš„linearéƒ¨åˆ†</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    dZ -- dL/dz</div><div class="line">    cache -- ä¸‰å…ƒç»„(A_prev, W, b) , æ¥è‡ªäºå½“å‰å±‚çš„å‰å‘ä¼ æ’­</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    dA_prev -- ä¸Šä¸€å±‚Açš„æ¢¯åº¦</div><div class="line">    dW -- wçš„æ¢¯åº¦</div><div class="line">    db -- bçš„æ¢¯åº¦</div><div class="line">    """</div><div class="line">    </div><div class="line">    A_prev, W, b = cache</div><div class="line">    m = A_prev.shape[<span class="number">1</span>]</div><div class="line">    </div><div class="line">    <span class="comment"># è®¡ç®—dwï¼Œdbï¼ŒdA_prev</span></div><div class="line">    dW = np.dot(dZ, A_prev.T) / m</div><div class="line">    db = np.sum(dZ, axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>) / m </div><div class="line">    dA_prev = np.dot(W.T, dZ) </div><div class="line">    </div><div class="line">    <span class="comment"># éªŒè¯</span></div><div class="line">    <span class="keyword">assert</span> (dA_prev.shape == A_prev.shape)</div><div class="line">    <span class="keyword">assert</span> (dW.shape == W.shape)</div><div class="line">    <span class="keyword">assert</span> (db.shape == b.shape)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> dA_prev, dW, db</div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_backward_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    z, linear_cache = (np.array([[-0.8019545 ,  3.85763489]]), (np.array([[-1.02387576,  1.12397796],</div><div class="line">       [-1.62328545,  0.64667545],</div><div class="line">       [-1.74314104, -0.59664964]]), np.array([[ 0.74505627,  1.97611078, -1.24412333]]), np.array([[1]]))</div><div class="line">    """</div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    dZ = np.random.randn(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">    A = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    W = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    linear_cache = (A, W, b)</div><div class="line">    <span class="keyword">return</span> dZ, linear_cache </div><div class="line"></div><div class="line">dZ, linear_cache = linear_backward_test_case()</div><div class="line"></div><div class="line">dA_prev, dW, db = linear_backward(dZ, linear_cache)</div><div class="line"><span class="keyword">print</span> (<span class="string">"dA_prev = "</span>+ str(dA_prev))</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW = "</span> + str(dW))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db = "</span> + str(db))</div></pre></td></tr></table></figure>
<pre><code>dA_prev = [[ 0.51822968 -0.19517421]
 [-0.40506361  0.15255393]
 [ 2.37496825 -0.89445391]]
dW = [[-0.10076895  1.40685096  1.64992505]]
db = [[ 0.50629448]]
</code></pre><h2 id="LINEAR-gt-ACTIVATION-1">6.2. LINEAR -&gt; ACTIVATION</h2><p>æœ¬èŠ‚è¦åŠ å…¥åå‘ä¼ æ’­ä¸­çš„activationéƒ¨åˆ†ï¼š</p>
<p>å‡è®¾$g(.)$æ˜¯æ¿€æ´»å‡½æ•°ï¼Œ</p>
<p>è€Œä¸‹é¢ç»™å‡ºçš„ä¸¤ä¸ªå‡½æ•°ï¼š<code>sigmoid_backward</code> å’Œ <code>relu_backward</code> è®¡ç®—äº†$dL/dz$ :<br>$$dZ^{[l]} = dA^{[l]} * gâ€™(Z^{[l]}) \tag{11}$$. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu_backward</span><span class="params">(dA, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for a single RELU unit.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    dA -- post-activation gradient, of any shape</div><div class="line">    cache -- 'Z' where we store for computing backward propagation efficiently</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    dZ -- Gradient of the cost with respect to Z</div><div class="line">    """</div><div class="line">    </div><div class="line">    Z = cache</div><div class="line">    dZ = np.array(dA, copy=<span class="keyword">True</span>) <span class="comment"># just converting dz to a correct object.</span></div><div class="line">    </div><div class="line">    <span class="comment"># When z &lt;= 0, you should set dz to 0 as well. </span></div><div class="line">    dZ[Z &lt;= <span class="number">0</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (dZ.shape == Z.shape)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dZ</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid_backward</span><span class="params">(dA, cache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation for a single SIGMOID unit.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    dA -- post-activation gradient, of any shape</div><div class="line">    cache -- 'Z' where we store for computing backward propagation efficiently</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    dZ -- Gradient of the cost with respect to Z</div><div class="line">    """</div><div class="line">    </div><div class="line">    Z = cache</div><div class="line">    </div><div class="line">    s = <span class="number">1</span>/(<span class="number">1</span>+np.exp(-Z))</div><div class="line">    dZ = dA * s * (<span class="number">1</span>-s)</div><div class="line">    </div><div class="line">    <span class="keyword">assert</span> (dZ.shape == Z.shape)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dZ</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_backward</span><span class="params">(dA, cache, activation)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    åå‘ä¼ æ’­çš„LINEAR-&gt;ACTIVATIONå®ç°</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    dA -- å½“å‰å±‚çš„è¾“å‡ºAçš„å¯¼æ•°</div><div class="line">    cache -- äºŒå…ƒç»„(linear_cache, activation_cache)ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰å‰å‘ä¼ æ’­è®¡ç®—æ—¶çš„cache</div><div class="line">    activation -- æœ¬å±‚çš„æ¿€æ´»å‡½æ•°ï¼Œæ˜¯"sigmoid"æˆ–"relu"</div><div class="line">    </div><div class="line">    Returns :</div><div class="line">    dA_prev -- ä¸Šä¸€å±‚è¾“å‡ºçš„å¯¼æ•°</div><div class="line">    dW -- æœ¬å±‚Wçš„å¯¼æ•°</div><div class="line">    db -- æœ¬å±‚bçš„å¯¼æ•°</div><div class="line">    """</div><div class="line">    </div><div class="line">    linear_cache, activation_cache = cache</div><div class="line">    <span class="comment"># è®¡ç®—dZ</span></div><div class="line">    <span class="keyword">if</span> activation == <span class="string">"relu"</span>:</div><div class="line">        dZ = relu_backward(dA, activation_cache)</div><div class="line">    <span class="keyword">elif</span> activation == <span class="string">"sigmoid"</span>:</div><div class="line">        dZ = sigmoid_backward(dA,activation_cache)</div><div class="line">    <span class="comment"># å·²çŸ¥dZ, è®¡ç®—dA_prev, dW, db</span></div><div class="line">    dA_prev, dW, db = linear_backward(dZ, linear_cache)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dA_prev, dW, db</div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_backward_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    aL, linear_activation_cache = (np.array([[ 3.1980455 ,  7.85763489]]), ((np.array([[-1.02387576,  1.12397796], [-1.62328545,  0.64667545], [-1.74314104, -0.59664964]]), np.array([[ 0.74505627,  1.97611078, -1.24412333]]), 5), np.array([[ 3.1980455 ,  7.85763489]])))</div><div class="line">    """</div><div class="line">    np.random.seed(<span class="number">2</span>)</div><div class="line">    dA = np.random.randn(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">    A = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    W = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    Z = np.random.randn(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">    linear_cache = (A, W, b)</div><div class="line">    activation_cache = Z</div><div class="line">    linear_activation_cache = (linear_cache, activation_cache)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dA, linear_activation_cache</div><div class="line"></div><div class="line">AL, linear_activation_cache = linear_activation_backward_test_case()</div><div class="line"></div><div class="line">dA_prev, dW, db = linear_activation_backward(AL, linear_activation_cache, activation = <span class="string">"sigmoid"</span>)</div><div class="line"><span class="keyword">print</span> (<span class="string">"sigmoid:"</span>)</div><div class="line"><span class="keyword">print</span> (<span class="string">"dA_prev = "</span>+ str(dA_prev))</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW = "</span> + str(dW))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db = "</span> + str(db) + <span class="string">"\n"</span>)</div><div class="line"></div><div class="line">dA_prev, dW, db = linear_activation_backward(AL, linear_activation_cache, activation = <span class="string">"relu"</span>)</div><div class="line"><span class="keyword">print</span> (<span class="string">"relu:"</span>)</div><div class="line"><span class="keyword">print</span> (<span class="string">"dA_prev = "</span>+ str(dA_prev))</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW = "</span> + str(dW))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db = "</span> + str(db))</div></pre></td></tr></table></figure>
<pre><code>sigmoid:
dA_prev = [[ 0.11017994  0.01105339]
 [ 0.09466817  0.00949723]
 [-0.05743092 -0.00576154]]
dW = [[ 0.10266786  0.09778551 -0.01968084]]
db = [[-0.05729622]]

(1L, 2L)
(1L, 2L)
relu:
dA_prev = [[ 0.44090989 -0.        ]
 [ 0.37883606 -0.        ]
 [-0.2298228   0.        ]]
dW = [[ 0.44513824  0.37371418 -0.10478989]]
db = [[-0.20837892]]
</code></pre><h2 id="L-Model-Backward">6.3. L-Model Backward</h2><p>æ¥ä¸‹æ¥å°±è¯¥å°†åå‘ä¼ æ’­åº”ç”¨åœ¨æ•´ä¸ªç½‘ç»œäº†ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å‰å‘ä¼ æ’­ - <code>L_model_forward()</code>,åœ¨æ¯ä¸€å±‚éƒ½å­˜ä¸‹äº†(X,W,b,z)</li>
<li>åå‘ä¼ æ’­ - <code>L_model_backward()</code>ï¼Œåˆ©ç”¨ä¹‹å‰å­˜çš„å€¼ï¼Œä¸€å±‚å±‚å‘å‰è®¡ç®—å¯¼æ•°</li>
</ol>
<p>åå‘ä¼ æ’­è®¡ç®—å¯¼æ•°çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-09-13-40-28.png" alt=""> </p>
<p><strong>åˆå§‹åŒ–éƒ¨åˆ†</strong></p>
<p>å¯¹äºè´¯ç©¿ç½‘ç»œçš„åå‘ä¼ æ’­æ¥è¯´ï¼Œæˆ‘ä»¬çŸ¥é“è¾“å‡ºæ˜¯$A^{[L]} = \sigma(Z^{[L]})$.<br>æˆ‘ä»¬éœ€è¦è®¡ç®—å‡º ï¼š  <code>dAL</code> $= \frac{\partial \mathcal{L}}{\partial A^{[L]}}$.</p>
<p>ä¸ºäº†å®Œæˆè¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬ç”¨å¦‚ä¸‹å…¬å¼å®ç°ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dAL = - (np.divide(Y, AL) - np.divide(<span class="number">1</span> - Y, <span class="number">1</span> - AL)) <span class="comment"># ç›¸å¯¹äºALçš„æˆæœ¬è¡ç”Ÿç‰©</span></div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªå…¬å¼è®¡ç®—äº†LINEAR-&gt;SIGMOIDåå‘ä¼ æ’­éƒ¨åˆ†</p>
<p>æ¥ä¸‹æ¥å°±è¯¥è®¡ç®—LINEAR-&gt;RELUåå‘ä¼ æ’­éƒ¨åˆ†äº†ï¼Œè¿™ä¸€éƒ¨åˆ†éœ€è¦å­˜å‚¨æ¯ä¸€æ­¥çš„dA, dW, dbï¼Œç”¨å¦‚ä¸‹å…¬å¼å®ç°ï¼š<br>$$grads[â€œdWâ€ + str(l)] = dW^{[l]}\tag{15} $$<br>ä¾‹å¦‚ï¼Œl=3ï¼Œå°±å°†dw3 å­˜å‚¨åœ¨<code>grads[&quot;dw3&quot;]</code>ä¸­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_backward</span><span class="params">(AL, Y, chache)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    [LINEAR-&gt;RELU] * (L-1) -&gt; LINEAR -&gt; SIGMOID çš„åå‘ä¼ æ’­çš„å®ç°</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    AL -- æ¦‚ç‡å‘é‡ï¼Œæ˜¯å‰å‘ä¼ æ’­L_model_forward()çš„è¾“å‡º</div><div class="line">    Y  -- æ ‡ç­¾å‘é‡</div><div class="line">    caches -- cachesåˆ—è¡¨ï¼š</div><div class="line">                     1 ~ L - 1 : reluçš„linear_activation_forward()çš„caches</div><div class="line">                     L         : sigmoid çš„ linear_activation_forward()çš„caches</div><div class="line">                     </div><div class="line">    Returns:</div><div class="line">    </div><div class="line">    grads -- æ¢¯åº¦dict :</div><div class="line">        grads["dA" + str(l)] = ...</div><div class="line">        grads["dW" + str(l)] = ...</div><div class="line">        grads["db" + str(l)] = ...</div><div class="line">    """</div><div class="line">    </div><div class="line">    grads = &#123;&#125;</div><div class="line">    L = len(caches)</div><div class="line">    m = AL.shape[<span class="number">1</span>]</div><div class="line">    Y = Y.reshape(AL.shape)</div><div class="line">    </div><div class="line">    <span class="comment">#åå‘ä¼ æ’­çš„åˆå§‹åŒ–</span></div><div class="line">    dAL = -(np.divide(Y, AL) - np.divide(<span class="number">1</span> - Y, <span class="number">1</span> - AL)) </div><div class="line">    </div><div class="line">    <span class="comment"># è®¡ç®—dAL,dWL,dbL</span></div><div class="line">    <span class="comment"># ç¬¬Lå±‚ - (SIGMOID -&gt; LINEAR)  - çš„æ¢¯åº¦</span></div><div class="line">    <span class="comment"># è¾“å…¥ ï¼šAL, Y, caches</span></div><div class="line">    <span class="comment"># è¾“å‡º ï¼šgrads["dAL"], grads["dWL"]</span></div><div class="line">    current_cache = caches[L - <span class="number">1</span>]</div><div class="line">    grads[<span class="string">"dA"</span> + str(L)], grads[<span class="string">"dW"</span> + str(L)], grads[<span class="string">"db"</span> + str(L)] = linear_activation_backward(dAL,current_cache, <span class="string">"sigmoid"</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># è®¡ç®—dAl,dWl,dbl , l = 1~L-1</span></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> reversed(range(L<span class="number">-1</span>)):</div><div class="line">        <span class="comment"># ç¬¬lå±‚ï¼š(RELU -&gt; LINEAR) çš„æ¢¯åº¦</span></div><div class="line">        <span class="comment"># è¾“å…¥ ï¼š "grads["dA" + str(l + 2)], caches". </span></div><div class="line">        <span class="comment"># è¾“å‡º: "grads["dA" + str(l + 1)] , grads["dW" + str(l + 1)] , grads["db" + str(l + 1)] </span></div><div class="line">        current_cache = caches[l]</div><div class="line">        dA_prev_temp, dW_temp, db_temp = linear_activation_backward(grads[<span class="string">"dA"</span> + str(l + <span class="number">2</span>)], current_cache, <span class="string">"relu"</span>)</div><div class="line">        grads[<span class="string">"dA"</span> + str(l + <span class="number">1</span>)] = dA_prev_temp</div><div class="line">        grads[<span class="string">"dW"</span> + str(l + <span class="number">1</span>)] = dW_temp</div><div class="line">        grads[<span class="string">"db"</span> + str(l + <span class="number">1</span>)] = db_temp</div><div class="line">    <span class="keyword">return</span> grads</div><div class="line"></div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_backward_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    X = np.random.rand(3,2)</div><div class="line">    Y = np.array([[1, 1]])</div><div class="line">    parameters = &#123;'W1': np.array([[ 1.78862847,  0.43650985,  0.09649747]]), 'b1': np.array([[ 0.]])&#125;</div><div class="line"></div><div class="line">    aL, caches = (np.array([[ 0.60298372,  0.87182628]]), [((np.array([[ 0.20445225,  0.87811744],</div><div class="line">           [ 0.02738759,  0.67046751],</div><div class="line">           [ 0.4173048 ,  0.55868983]]),</div><div class="line">    np.array([[ 1.78862847,  0.43650985,  0.09649747]]),</div><div class="line">    np.array([[ 0.]])),</div><div class="line">   np.array([[ 0.41791293,  1.91720367]]))])</div><div class="line">   """</div><div class="line">    np.random.seed(<span class="number">3</span>)</div><div class="line">    AL = np.random.randn(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line">    Y = np.array([[<span class="number">1</span>, <span class="number">0</span>]])</div><div class="line"></div><div class="line">    A1 = np.random.randn(<span class="number">4</span>,<span class="number">2</span>)</div><div class="line">    W1 = np.random.randn(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">    b1 = np.random.randn(<span class="number">3</span>,<span class="number">1</span>)</div><div class="line">    Z1 = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    linear_cache_activation_1 = ((A1, W1, b1), Z1)</div><div class="line"></div><div class="line">    A2 = np.random.randn(<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">    W2 = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b2 = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    Z2 = np.random.randn(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">    linear_cache_activation_2 = ( (A2, W2, b2), Z2)</div><div class="line"></div><div class="line">    caches = (linear_cache_activation_1, linear_cache_activation_2)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> AL, Y, caches</div><div class="line"></div><div class="line">AL, Y_assess, caches = L_model_backward_test_case()</div><div class="line">grads = L_model_backward(AL, Y_assess, caches)</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW1 = "</span>+ str(grads[<span class="string">"dW1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db1 = "</span>+ str(grads[<span class="string">"db1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"dA1 = "</span>+ str(grads[<span class="string">"dA1"</span>]))</div></pre></td></tr></table></figure>
<pre><code>(3L, 2L)
(3L, 2L)
dW1 = [[ 0.41010002  0.07807203  0.13798444  0.10502167]
 [ 0.          0.          0.          0.        ]
 [ 0.05283652  0.01005865  0.01777766  0.0135308 ]]
db1 = [[-0.22007063]
 [ 0.        ]
 [-0.02835349]]
dA1 = [[ 0.          0.52257901]
 [ 0.         -0.3269206 ]
 [ 0.         -0.32070404]
 [ 0.         -0.74079187]]
</code></pre><h1 id="æ›´æ–°å‚æ•°">7. æ›´æ–°å‚æ•°</h1><p>åœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ç”¨ä»¥ä¸Šæ¨¡å‹æ›´æ–°å‚æ•°ï¼š</p>
<p>$$ W^{[l]} = W^{[l]} - \alpha \text{ } dW^{[l]} \tag{16}$$<br>$$ b^{[l]} = b^{[l]} - \alpha \text{ } db^{[l]} \tag{17}$$</p>
<p>å…¶ä¸­ï¼Œ$\alpha$æ˜¯å­¦ä¹ ç‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters, grads, learning_rate)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    ç”¨æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°</div><div class="line">    </div><div class="line">    è¾“å…¥ï¼š</div><div class="line">    parameters -- python dictï¼Œé‡Œé¢åŒ…å«ä¸€äº›å‚æ•°</div><div class="line">    grads -- python dict, åŒ…å«æ¢¯åº¦</div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dict, åŒ…å«æ›´æ–°åçš„å‚æ•°ï¼š</div><div class="line">                  parameters["W" + str(l)] = ... </div><div class="line">                  parameters["b" + str(l)] = ...</div><div class="line">    """</div><div class="line">    </div><div class="line">    L = len(parameters) / <span class="number">2</span></div><div class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> range(L):</div><div class="line">        parameters[<span class="string">"W"</span> + str(l+<span class="number">1</span>)] = parameters[<span class="string">"W"</span> + str(l+<span class="number">1</span>)] - learning_rate * grads[<span class="string">"dW"</span> + str(l+<span class="number">1</span>)]</div><div class="line">        parameters[<span class="string">"b"</span> + str(l+<span class="number">1</span>)] = parameters[<span class="string">"b"</span> + str(l+<span class="number">1</span>)] - learning_rate * grads[<span class="string">"db"</span> + str(l+<span class="number">1</span>)]</div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line"><span class="comment"># æµ‹è¯•</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters_test_case</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    parameters = &#123;'W1': np.array([[ 1.78862847,  0.43650985,  0.09649747],</div><div class="line">        [-1.8634927 , -0.2773882 , -0.35475898],</div><div class="line">        [-0.08274148, -0.62700068, -0.04381817],</div><div class="line">        [-0.47721803, -1.31386475,  0.88462238]]),</div><div class="line"> 'W2': np.array([[ 0.88131804,  1.70957306,  0.05003364, -0.40467741],</div><div class="line">        [-0.54535995, -1.54647732,  0.98236743, -1.10106763],</div><div class="line">        [-1.18504653, -0.2056499 ,  1.48614836,  0.23671627]]),</div><div class="line"> 'W3': np.array([[-1.02378514, -0.7129932 ,  0.62524497],</div><div class="line">        [-0.16051336, -0.76883635, -0.23003072]]),</div><div class="line"> 'b1': np.array([[ 0.],</div><div class="line">        [ 0.],</div><div class="line">        [ 0.],</div><div class="line">        [ 0.]]),</div><div class="line"> 'b2': np.array([[ 0.],</div><div class="line">        [ 0.],</div><div class="line">        [ 0.]]),</div><div class="line"> 'b3': np.array([[ 0.],</div><div class="line">        [ 0.]])&#125;</div><div class="line">    grads = &#123;'dW1': np.array([[ 0.63070583,  0.66482653,  0.18308507],</div><div class="line">        [ 0.        ,  0.        ,  0.        ],</div><div class="line">        [ 0.        ,  0.        ,  0.        ],</div><div class="line">        [ 0.        ,  0.        ,  0.        ]]),</div><div class="line"> 'dW2': np.array([[ 1.62934255,  0.        ,  0.        ,  0.        ],</div><div class="line">        [ 0.        ,  0.        ,  0.        ,  0.        ],</div><div class="line">        [ 0.        ,  0.        ,  0.        ,  0.        ]]),</div><div class="line"> 'dW3': np.array([[-1.40260776,  0.        ,  0.        ]]),</div><div class="line"> 'da1': np.array([[ 0.70760786,  0.65063504],</div><div class="line">        [ 0.17268975,  0.15878569],</div><div class="line">        [ 0.03817582,  0.03510211]]),</div><div class="line"> 'da2': np.array([[ 0.39561478,  0.36376198],</div><div class="line">        [ 0.7674101 ,  0.70562233],</div><div class="line">        [ 0.0224596 ,  0.02065127],</div><div class="line">        [-0.18165561, -0.16702967]]),</div><div class="line"> 'da3': np.array([[ 0.44888991,  0.41274769],</div><div class="line">        [ 0.31261975,  0.28744927],</div><div class="line">        [-0.27414557, -0.25207283]]),</div><div class="line"> 'db1': 0.75937676204411464,</div><div class="line"> 'db2': 0.86163759922811056,</div><div class="line"> 'db3': -0.84161956022334572&#125;</div><div class="line">    """</div><div class="line">    np.random.seed(<span class="number">2</span>)</div><div class="line">    W1 = np.random.randn(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">    b1 = np.random.randn(<span class="number">3</span>,<span class="number">1</span>)</div><div class="line">    W2 = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    b2 = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line">    np.random.seed(<span class="number">3</span>)</div><div class="line">    dW1 = np.random.randn(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">    db1 = np.random.randn(<span class="number">3</span>,<span class="number">1</span>)</div><div class="line">    dW2 = np.random.randn(<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">    db2 = np.random.randn(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">    grads = &#123;<span class="string">"dW1"</span>: dW1,</div><div class="line">             <span class="string">"db1"</span>: db1,</div><div class="line">             <span class="string">"dW2"</span>: dW2,</div><div class="line">             <span class="string">"db2"</span>: db2&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> parameters, grads</div><div class="line"></div><div class="line">parameters, grads = update_parameters_test_case()</div><div class="line">parameters = update_parameters(parameters, grads, <span class="number">0.1</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> (<span class="string">"W1 = "</span>+ str(parameters[<span class="string">"W1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"b1 = "</span>+ str(parameters[<span class="string">"b1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"W2 = "</span>+ str(parameters[<span class="string">"W2"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"b2 = "</span>+ str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>W1 = [[-0.59562069 -0.09991781 -2.14584584  1.82662008]
 [-1.76569676 -0.80627147  0.51115557 -1.18258802]
 [-1.0535704  -0.86128581  0.68284052  2.20374577]]
b1 = [[-0.04659241]
 [-1.28888275]
 [ 0.53405496]]
W2 = [[-0.55569196  0.0354055   1.32964895]]
b2 = [[-0.84610769]]
</code></pre>]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> ç¥ç»ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ ç®—æ³•-å‡ ç§å¸¸è§çš„å·ç§¯ç½‘ç»œ]]></title>
      <url>/2017/12/08/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C/</url>
      <content type="html"><![CDATA[<p>æˆ‘ä»¬å…ˆå›é¡¾ä¸€äº›ç»å…¸çš„å·ç§¯ç½‘ç»œï¼Œç„¶åçœ‹çœ‹å½“ä¸‹æ¯”è¾ƒæµè¡Œçš„å‡ ç§ç½‘ç»œ</p>
<h1 id="ç»å…¸çš„å·ç§¯ç½‘ç»œ">1. ç»å…¸çš„å·ç§¯ç½‘ç»œ</h1><p>ä»‹ç»å‡ ç§ç»å…¸çš„å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ï¼Œåˆ†åˆ«æ˜¯LeNetã€AlexNetã€VGGNet</p>
<a id="more"></a>
<h2 id="LeNet-5">1.1. LeNet-5</h2><p>LeNet-5ä¸»è¦æ˜¯é’ˆå¯¹ç°åº¦è®¾è®¡çš„ï¼Œæ‰€ä»¥è¾“å…¥è¾ƒå°ï¼Œä¸º$32\times 32 \times 1$ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-08-10-44-59.png" alt=""> </p>
<p>åœ¨LetNetä¸­ï¼Œå­˜åœ¨çš„ç»å…¸æ¨¡å¼ï¼š</p>
<ul>
<li>éšç€ç½‘ç»œçš„æ·±åº¦å¢åŠ ï¼Œå›¾åƒçš„å¤§å°åœ¨ç¼©å°ï¼Œä¸æ­¤åŒæ—¶ï¼Œé€šé“çš„æ•°é‡å´åœ¨å¢åŠ ï¼›</li>
<li>æ¯ä¸ªå·ç§¯å±‚åé¢æ¥ä¸€ä¸ªæ± åŒ–å±‚ã€‚</li>
</ul>
<p>LeNet-5æ˜¯1998å¹´å†™çš„ï¼Œå¤§çº¦æœ‰6ä¸‡ä¸ªå‚æ•°ï¼ŒåŸºæœ¬çš„ç½‘ç»œç»“æ„è·Ÿä»Šå¤©å·®ä¸å¤šï¼Œåªæ˜¯æœ‰å‡ ç‚¹ä¸åŒï¼š</p>
<p>æ¿€æ´»å‡½æ•°ç”¨sigmoidæˆ–tanhï¼Œæ²¡æœ‰ç”¨reluï¼›å½“æ—¶æ¯”è¾ƒæµè¡Œä½¿ç”¨å¹³å‡æ± åŒ–ï¼›æ± åŒ–åä½¿ç”¨äº†sigmoidæ¿€æ´»å‡½æ•°ï¼›æ²¡æœ‰ä½¿ç”¨pddingï¼›</p>
<p>å½“æ—¶çš„æ¯ä¸ªå·ç§¯æ ¸æ˜¯è·ŸåŸå›¾åƒçš„é€šé“æ•°æ˜¯ä¸€æ ·çš„ï¼Œæ˜¯å› ä¸ºå½“æ—¶è®¡ç®—èƒ½åŠ›å¼±ï¼Œä¸ºäº†å‡å°‘è®¡ç®—é‡ç”¨äº†å¾ˆå¤æ‚çš„è¿ç®—è¿›è¡Œï¼Œç°åœ¨ä¸€èˆ¬éƒ½ä¸è¿™ä¹ˆç”¨äº†ï¼›</p>
<h2 id="AlexNext">1.2. AlexNext</h2><p>AlextNetå’ŒLeNetç±»ä¼¼ï¼Œä½†æ˜¯ç½‘ç»œå¤§äº†å¾ˆå¤šï¼Œå‚æ•°å¤§çº¦æœ‰6000ä¸‡ä¸ªï¼›ç›¸æ¯”äºLeNet-5å®ƒä½¿ç”¨äº†reluæ¿€æ´»å‡½æ•°ï¼›å½“æ—¶çš„GPUè¿è¡Œè¿˜æ¯”è¾ƒæ…¢ï¼Œç”¨äº†å¤šGPUçš„æ–¹å¼è®­ç»ƒã€‚</p>
<p>ä»è¿™ç¯‡è®ºæ–‡å¼€å§‹ï¼Œè®¡ç®—æœºè§†è§‰ç ”ç©¶è€…å¼€å§‹å…³æ³¨æ·±åº¦å­¦ä¹ ï¼Œå¹¶ç›¸ä¿¡æ·±åº¦å­¦ä¹ å¯ä»¥åº”ç”¨äºè®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œæ­¤åï¼Œæ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰åŠå…¶å®ƒé¢†åŸŸçš„å½±å“åŠ›ä¸æ—¥ä¿±å¢ã€‚</p>
<p>AlexNetç›´æ¥å¯¹å½©è‰²çš„å¤§å›¾ç‰‡è¿›è¡Œå¤„ç†ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-05-21.png" alt=""> </p>
<h2 id="VGG-16">1.3. VGG-16</h2><p>VGG-16æ€»å…±åŒ…å«çº¦1.38äº¿ä¸ªå‚æ•°ï¼Œä½†æ˜¯å®ƒçš„ç»“æ„å¹¶ä¸å¤æ‚ï¼Œå¾ˆæ•´é½ï¼Œå·ç§¯æ ¸å¤§å°å’Œæ± åŒ–å‚æ•°æ’å®šï¼Œå‡ ä¸ªå·ç§¯åé¢è·Ÿç€ä¸€ä¸ªæ± åŒ–ï¼Œå·ç§¯æ ¸çš„æ•°é‡ä»¥åŠ å€çš„æ–¹å¼å˜åŒ–ï¼Œæ¯æ¬¡æ± åŒ–åå›¾ç‰‡é«˜åº¦å®½åº¦å‡åŠï¼Œè¿™ç§ç›¸å¯¹ä¸€è‡´çš„ç½‘ç»œç»“æ„å¯¹ç ”ç©¶è€…å¾ˆæœ‰å¸å¼•åŠ›ã€‚è€Œä¸»è¦ç¼ºç‚¹åœ¨äºéœ€è¦è®­ç»ƒçš„å‚æ•°ç‰¹ç‚¹å¤šã€‚VGG-19æ¯”VGG-16æ›´å¤§ï¼Œåªæ˜¯å®ƒä»¬çš„æ•ˆæœå·®ä¸å¤šï¼Œæ‰€ä»¥å¾ˆå¤šäººè¿˜æ˜¯ç”¨VGG-16ã€‚</p>
<p>å¦‚æœæƒ³ç ”è¯»è®ºæ–‡çš„è¯ï¼Œngçš„å»ºè®®é¡ºåºæ˜¯AlexNetï¼ˆæ¯”è¾ƒå¥½æ‡‚ï¼‰ï¼ŒVGGï¼ŒLeNet-5ï¼ˆæ¯”è¾ƒæ™¦æ¶©ï¼‰ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-06-16.png" alt=""> </p>
<h1 id="æ®‹å·®ç½‘ç»œ-ResNets">2. æ®‹å·®ç½‘ç»œ (ResNets)</h1><p>Residual Networks</p>
<p>å› ä¸ºå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼Œæ·±åº¦å¾ˆæ·±çš„ç½‘ç»œæ˜¯å¾ˆéš¾è®­ç»ƒçš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è·³è¿‡è¿æ¥( skip connections ) ï¼Œæ¥æ„å»ºèƒ½è®­ç»ƒæ·±åº¦ç½‘ç»œçš„ResNetsã€‚</p>
<p>å…ˆå›é¡¾ä¸€ä¸‹æ­£å¸¸ç½‘ç»œçš„å‰å‘ä¼ æ’­è®¡ç®—æ­¥éª¤ï¼š</p>
<ul>
<li>Linearï¼š$z^{[l+1]} = W^{[l+1]}a^{[l]} + b^{[l+1]}$</li>
<li>Reluï¼š$a^{[l+1]} = g(z^{[l+1]})$</li>
<li>Linearï¼š$z^{[l+2]} = W^{[l+2]}a^{[l+1]} + b^{[l+2]}$</li>
<li>Reluï¼š$a^{[l+2]} = g(z^{[l+2]})$</li>
</ul>
<p>æ®‹å·®ç½‘ç»œæ˜¯ç”±æ®‹å·®å—æ„æˆçš„ã€‚æ­£å¸¸çš„ç½‘ç»œæŒ‰ç…§ä¸€ä¸ªä¸»è·¯å¾„ä¼ é€’ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æŸå±‚çš„è¾“å‡ºåè·³è¿‡äº†ä¸€å±‚ï¼ˆæˆ–è€…å¥½å‡ å±‚ï¼‰ï¼Œç›´æ¥è¾¾åˆ°åå±‚çš„æ¿€æ´»å‡½æ•°ä¹‹å‰ï¼ˆä¾‹å¦‚ä¸‹å›¾çš„ä»$a^{[l]}åˆ°z^{[l+2]}$ çš„è¿æ¥ï¼‰ï¼Œè¿™æ¡è·¯å°±æ˜¯æ·å¾„ï¼ˆç§°ä¹‹ä¸ºshort cut æˆ– skip connectionï¼‰ï¼Œå«æœ‰æ·å¾„çš„è¿™ä¸€å—ï¼ˆåŒ…å«ä¸»è·¯å¾„ï¼‰å°±å«æ®‹å·®å—ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-08-33.png" alt=""> </p>
<p>ä¹Ÿå°±æ˜¯å‰å‘ä¼ æ’­å…¬å¼çš„æœ€åä¸€ä¸ªæ­¥éª¤å˜ä¸ºï¼š$a^{[l+2]} = g(z^{[l+2]}+a^{[l]})$</p>
<p>é‚£ä¹ˆæ®‹å·®å—çš„ç½‘ç»œç»“æ„å°±æ˜¯ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-13-16.png" alt=""> </p>
<p>æ‰€è°“æ„å»ºæ®‹å·®ç½‘ç»œï¼ˆResNetsï¼‰å°±æ˜¯é€šè¿‡å¾ˆå¤šè¿™æ ·çš„æ®‹å·®å—å †ç§¯åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œã€‚å…¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-14-05.png" alt=""> </p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨æ™®é€šç½‘ç»œï¼ˆplain networkï¼‰ä¸­ï¼Œç†è®ºä¸Šéšç€æ·±åº¦çš„åŠ æ·±ï¼Œé”™è¯¯ç‡ä¸æ–­ä¸‹é™ã€‚ç„¶è€Œå®é™…ä¸Šå› ä¸ºå¤ªæ·±çš„åŸå› éš¾ä»¥è®­ç»ƒï¼Œåˆ°äº†åé¢è®­ç»ƒé”™è¯¯ç‡ä¼šä¸Šå‡ã€‚</p>
<p>åœ¨æ®‹å·®ç½‘ç»œä¸­ï¼Œéšç€æ·±åº¦çš„ä¸æ–­å¢åŠ ï¼Œé”™è¯¯ç‡ä¸æ–­ä¸‹é™ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-14-35.png" alt=""> </p>
<p>ResNetå¯¹äºä¸­é—´çš„æ¿€æ´»å‡½æ•°æ¥è¯´ï¼Œæœ‰åŠ©äºèƒ½å¤Ÿè¾¾åˆ°æ›´æ·±çš„ç½‘ç»œï¼Œè§£å†³æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ®‹å·®ä¼šæœ‰ç”¨å‘¢ï¼Ÿçœ‹ä¸ªä¾‹å­ã€‚å‡è®¾æœ‰ä¸ªæ¯”è¾ƒå¤§çš„ç¥ç»ç½‘ç»œï¼Œè¾“å…¥ä¸º$x$ï¼Œè¾“å‡ºä¸º$a^{[l]}$ã€‚å¦‚æœæˆ‘ä»¬æƒ³å¢åŠ ç½‘ç»œçš„æ·±åº¦ï¼Œè¿™é‡Œå†ç»™ç½‘ç»œå¢åŠ ä¸€ä¸ªæ®‹å·®å—ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-17-55.png" alt=""> </p>
<p>å‡å®šä½¿ç”¨reluæ¿€æ´»å‡½æ•°ï¼Œç°åœ¨$a^{[l]}$è·³è¿‡äº†$a^{[l+1]}$å±‚ï¼Œé‚£ä¹ˆæœ‰</p>
<p>$$a^{[l+2]} = g(z^{[l+2]}+a^{[l]})=g(W^{[l+2]}a^{[l+1]}+b^{[l+2]}+a^{[l]})$$</p>
<p>å¦‚æœæˆ‘ä»¬åšäº†2æ­£åˆ™åŒ–æˆ–è€…æƒé‡è¡°å‡ï¼Œä¼šå‹ç¼©Wå’Œbçš„å€¼ï¼Œé‚£ä¹ˆå‡è®¾$W^{[l+2]}=0$ ä¸”$b^{[l+2]}=0$ï¼Œé‚£ä¹ˆä¸Šå¼å­å°±å˜ä¸ºï¼š</p>
<p>$$a^{[l+2]} = g(z^{[l+2]}+a^{[l]})=g(a^{[l]})=relu(a^{[l]})= a^{[l]}$$</p>
<p>å› ä¸ºä½¿ç”¨çš„æ˜¯reluï¼Œè€Œä¸”a[l]æ˜¯å·²ç»è¢«æ¿€æ´»è¿‡çš„ï¼Œç»“æœè¡¨æ˜æ®‹å·®å—å­¦ä¹ è¿™ä¸ªæ’ç­‰å¼å‡½æ•°å¹¶ä¸éš¾ï¼Œå³ä½¿ä¸­é—´éš”ç€ä¸¤å±‚æˆ‘ä»¬è¿˜æ˜¯èƒ½å¾—åˆ°a[l+2] = a[l]ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œ$a^{[l+2]} =g(z^{[l+2]}+a^{[l]})$ ï¼Œ æƒ³ç›¸åŠ é‚£å°±å¿…é¡»ç»´åº¦ä¸€è‡´ã€‚æ‰€ä»¥æ®‹å·®ç½‘ç»œä¸­ä½¿ç”¨äº†å¾ˆå¤šç›¸åŒçš„å·ç§¯æ¥ä¿ç•™ç»´åº¦ã€‚å¦‚æœç»´åº¦ä¸ä¸€è‡´çš„è¯ï¼Œz[i+2] + a[l]çš„æ—¶å€™ï¼Œåœ¨a[l]å‰é¢ä¹˜ä¸Šä¸€ä¸ªæƒé‡ï¼Œæ¥ä¿æŒç»´åº¦ä¸€è‡´ï¼Œè¿™ä¸ªç»´åº¦æ˜¯ç½‘ç»œè‡ªå·±å­¦ä¹ å¾—åˆ°çš„å‚æ•°ï¼Œå®ƒç”¨0å¡«å……a[l]æˆ–è€…å…¶å®ƒæ‰‹æ®µä½¿å¾—ç»´åº¦ä¸€è‡´ã€‚</p>
<h1 id="Inception-Net">3. Inception Net</h1><h2 id="1-times-1-å·ç§¯">3.1. $1 \times 1$ å·ç§¯</h2><p>åœ¨äºŒç»´ä¸Šï¼Œ$1\times 1$ å·ç§¯å°±ç›¸å½“äºæ¯ä¸ªå…ƒç´ ä¸ä¸€ä¸ªæ•°å­—ç›¸ä¹˜ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-27-35.png" alt=""> </p>
<p>ä½†å‡å¦‚æ˜¯å¤šé€šé“çš„ä¸‰ç»´ä¸Šï¼Œå¦‚æœä¸€ä¸ªä¸‰ç»´çš„ä¸œè¥¿ä¸ä¸€ä¸ª$1\times1\times n_C$ çš„ä¸œè¥¿ç›¸ä¹˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°±ç›¸å½“äºä¸‰ç»´å›¾å½¢ä¸Šçš„$1\times1\times n_C$ åˆ‡ç‰‡ï¼Œä¹Ÿå°±æ˜¯$n_c$ ä¸ªç‚¹ä¹˜ä»¥æƒé‡ï¼Œé€šè¿‡Reluå‡½æ•°åï¼Œè¾“å‡ºå¯¹åº”çš„ç»“æœã€‚è€Œä¸åŒçš„å·ç§¯æ ¸åˆ™ç›¸å½“äºä¸åŒçš„éšå±‚ç¥ç»å…ƒç»“ç‚¹ä¸åˆ‡ç‰‡ä¸Šçš„ç‚¹è¿›è¡Œä¸€ä¸€è¿æ¥ã€‚</p>
<p>æœ€ç»ˆä¸‰ç»´çš„å›¾å½¢åº”ç”¨1Ã—1çš„å·ç§¯æ ¸å¾—åˆ°ä¸€ä¸ªç›¸åŒé•¿å®½ä½†ç¬¬ä¸‰ç»´åº¦å˜ä¸ºå·ç§¯æ ¸ä¸ªæ•°çš„å›¾ç‰‡ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-28-07.png" alt=""> </p>
<p>æ‰€ä»¥æ ¹æœ¬ä¸Š1Ã—1å·ç§¯æ ¸ç›¸å½“äºå¯¹ä¸€ä¸ªåˆ‡ç‰‡ä¸Šçš„$n_c$ä¸ªå•å…ƒéƒ½åº”ç”¨äº†ä¸€ä¸ªå…¨è¿æ¥çš„ç¥ç»ç½‘ç»œã€‚</p>
<p><strong>1x1å·ç§¯åº”ç”¨ï¼š</strong></p>
<ul>
<li>ç»´åº¦å‹ç¼©ï¼šä½¿ç”¨ç›®æ ‡ç»´åº¦çš„1Ã—1çš„å·ç§¯æ ¸ä¸ªæ•°ã€‚</li>
<li>å¢åŠ éçº¿æ€§ï¼šä¿æŒä¸åŸç»´åº¦ç›¸åŒçš„1Ã—1çš„å·ç§¯æ ¸ä¸ªæ•°ã€‚</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-30-39.png" alt=""> </p>
<h2 id="Inception-Network">3.2. Inception Network</h2><p>Inception Network çš„ä½œç”¨å°±æ˜¯ä½¿æˆ‘ä»¬æ— éœ€å»è€ƒè™‘åœ¨æ„å»ºæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæ—¶ï¼Œä½¿ç”¨å¤šå¤§çš„å·ç§¯æ ¸ä»¥åŠæ˜¯å¦æ·»åŠ æ± åŒ–å±‚ç­‰é—®é¢˜ã€‚</p>
<p>ç”¨æœºå™¨ä»£æ›¿äººå·¥æ¥ç¡®å®šå·ç§¯å±‚ä¸­çš„å·ç§¯æ ¸ç±»å‹ï¼Œæˆ–è€…ç¡®å®šæ˜¯å¦éœ€è¦åˆ›å»ºå·ç§¯å±‚æˆ–æ± åŒ–å±‚ã€‚</p>
<p>å¯¹äºä¸€ä¸ªè¾“å…¥çš„å›¾åƒï¼Œæ˜¯ç”¨1<em>1ï¼Œè¿˜æ˜¯3</em>3ï¼Œè¿˜æ˜¯5*5çš„å·ç§¯ï¼Œè¿˜æ˜¯åšä¸€ç§ç‰¹æ®Šçš„æ± åŒ–ï¼ŒInceptionä¼šæŠŠä»–ä»¬éƒ½è®¡ç®—å‡ºæ¥å åœ¨ä¸€èµ·ï¼Œç”±ç½‘ç»œè‡ªå·±å­¦ä¹ åº”è¯¥é‡‡ç”¨ä»€ä¹ˆè¿ç®—ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-42-14.png" alt=""> </p>
<p>åœ¨ä¸Šé¢çš„Inceptionç»“æ„ä¸­ï¼Œåº”ç”¨äº†ä¸åŒçš„å·ç§¯æ ¸ï¼Œä»¥åŠå¸¦paddingçš„æ± åŒ–å±‚ã€‚åœ¨ä¿æŒè¾“å…¥å›¾ç‰‡å¤§å°ä¸å˜çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸åŒè¿ç®—ç»“æœçš„å åŠ ï¼Œå¢åŠ äº†é€šé“çš„æ•°é‡ã€‚</p>
<p><strong>è®¡ç®—æˆæœ¬é—®é¢˜</strong></p>
<p>å¯¹äºä¸Šé¢çš„5Ã—5å¤§å°å·ç§¯æ ¸çš„è®¡ç®—æˆæœ¬ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-52-38.png" alt=""> </p>
<ul>
<li>1 filtersï¼š5Ã—5Ã—192ï¼›</li>
<li>32 ä¸ª filtersï¼›</li>
<li>æ€»çš„è®¡ç®—æˆæœ¬ï¼š28Ã—28Ã—32Ã—5Ã—5Ã—192=120M</li>
</ul>
<p>ç°åœ¨è€ƒè™‘å…ˆç”¨1<em>1çš„å·ç§¯ï¼Œæ„é€ ä¸€ä¸ªç“¶é¢ˆå±‚ï¼Œ</em>ç”¨ä½œè¿‡æ¸¡çš„è®¡ç®—æˆæœ¬ï¼Œä¹Ÿå°†ä¸‹é¢çš„ä¸­é—´çš„å±‚å«åšâ€œbottleneck layerâ€ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-53-50.png" alt=""> </p>
<ul>
<li>1Ã—1å·ç§¯å±‚è®¡ç®—æˆæœ¬ï¼š28Ã—28Ã—16Ã—1Ã—1Ã—192=2.4M</li>
<li>5Ã—5å·ç§¯å±‚è®¡ç®—æˆæœ¬ï¼š28Ã—28Ã—32Ã—5Ã—5Ã—16=10.0M</li>
<li>æ€»çš„è®¡ç®—æˆæœ¬ï¼š2.4M+10.0M=12.4M</li>
</ul>
<p>è¿™æ ·éœ€è¦è®¡ç®—çš„ä¹˜æ³•è¿ç®—æ¬¡æ•°çº¦ç­‰äº1200åƒä¸‡æ¬¡ï¼Œæ¯”ä¹‹å‰ç¼©å°äº†10å€ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p>
<p>äº‹å®è¯æ˜ï¼Œåªè¦åˆç†åœ°è®¾ç½®â€œbottleneck layerâ€ï¼Œæ—¢å¯ä»¥æ˜¾è‘—å‡å°ä¸Šå±‚çš„è§„æ¨¡ï¼ŒåŒæ—¶åˆèƒ½é™ä½è®¡ç®—æˆæœ¬ï¼Œä»è€Œä¸ä¼šå½±å“ç½‘ç»œçš„æ€§èƒ½ã€‚</p>
<p><strong>ç»“åˆ</strong></p>
<p>åˆ©ç”¨1*1å·ç§¯å¯ä»¥å‡å°è®¡ç®—é‡ï¼ŒæŠŠè¿™ä¸ªå’Œä¸Šé¢è¯´çš„Inceptionç»“åˆèµ·æ¥ï¼Œå¯ä»¥å¾—åˆ°ä¸‹å›¾æ‰€ç¤ºæ¨¡å—ã€‚</p>
<p><img src="https://images2018.cnblogs.com/blog/1160281/201711/1160281-20171124151010078-1933005968.png" alt="img"></p>
<p>è¿™äº›ä¸€ä¸ªä¸ªInceptionæ¨¡å—å †å èµ·æ¥ï¼Œå°±æ˜¯ä¸€ä¸ªå¤§çš„Inceptionç½‘ç»œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯ä»¥æ³¨æ„åˆ°é™¤äº†æœ€åçš„è¾“å‡ºå¤–ï¼Œè¿˜æœ‰å‡ ä¸ªåˆ†æ”¯è¾“å‡ºï¼Œè¿™äº›åˆ†æ”¯è¾“å‡ºæ˜¯æ ¹æ®ä¸­é—´éšè—å±‚è¿›è¡Œé¢„æµ‹çš„è¾“å‡ºï¼Œå®ƒç¡®ä¿äº†ä¸­é—´éšè—å±‚ä¹Ÿå‚ä¸äº†ç‰¹å¾è®¡ç®—ï¼Œå®ƒä»¬ä¹Ÿèƒ½é¢„æµ‹å›¾ç‰‡çš„åˆ†ç±»ï¼Œå®ƒèµ·åˆ°ä¸€ç§è°ƒæ•´çš„ä½œç”¨ï¼Œå¹¶ä¸”èƒ½é˜²æ­¢ç½‘ç»œè¿‡æ‹Ÿåˆã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-56-19.png" alt=""> </p>
<h1 id="è¿ç§»å­¦ä¹ ">4. è¿ç§»å­¦ä¹ </h1><p><strong>å°æ•°æ®é›†ï¼š</strong></p>
<p>å¦‚ä»Šåœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œè®¸å¤šç ”ç©¶è€…éƒ½ä¼šå°†ä»–ä»¬çš„å·¥ä½œå…±äº«åˆ°ç½‘ç»œä¸Šã€‚åœ¨æˆ‘ä»¬å®æ–½è‡ªå·±çš„å·¥ä½œçš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´åšæŸç§ç‰©ä½“çš„è¯†åˆ«åˆ†ç±»ï¼Œä½†æ˜¯åªæœ‰å°‘é‡çš„æ•°æ®é›†ï¼Œå¯¹äºä»å¤´å¼€å§‹è®­ç»ƒä¸€ä¸ªæ·±åº¦ç½‘ç»œç»“æ„æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åº”ç”¨è¿ç§»å­¦ä¹ ï¼Œåº”ç”¨å…¶ä»–ç ”ç©¶è€…å»ºç«‹çš„æ¨¡å‹å’Œå‚æ•°ï¼Œç”¨å°‘é‡çš„æ•°æ®ä»…è®­ç»ƒæœ€åè‡ªå®šä¹‰çš„softmaxç½‘ç»œã€‚ä»è€Œèƒ½å¤Ÿåœ¨å°æ•°æ®é›†ä¸Šè¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-58-22.png" alt=""> </p>
<p><strong>å¤§æ•°æ®é›†ï¼š</strong></p>
<p>å¦‚æœæˆ‘ä»¬åœ¨è‡ªå·±çš„é—®é¢˜ä¸Šä¹Ÿæ‹¥æœ‰å¤§é‡çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯ä»¥å¤šè®­ç»ƒåé¢çš„å‡ å±‚ã€‚æ€»ä¹‹éšç€æ•°æ®é›†çš„å¢åŠ ï¼Œæˆ‘ä»¬éœ€è¦â€œ freezeâ€çš„å±‚æ•°è¶Šæ¥è¶Šå°‘ã€‚æœ€åå¦‚æœæˆ‘ä»¬æœ‰ååˆ†åºå¤§çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®­ç»ƒç½‘ç»œæ¨¡å‹çš„æ‰€æœ‰å‚æ•°ï¼Œå°†å…¶ä»–ç ”ç©¶è€…è®­ç»ƒçš„æ¨¡å‹å‚æ•°ä½œä¸ºå‚æ•°çš„åˆå§‹åŒ–æ¥æ›¿ä»£éšæœºåˆå§‹åŒ–ï¼Œæ¥åŠ é€Ÿæˆ‘ä»¬æ¨¡å‹çš„è®­ç»ƒã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-58-39.png" alt=""> </p>
<h1 id="æ•°æ®æ‰©å……">5. æ•°æ®æ‰©å……</h1><p>ä¸å…¶ä»–æœºå™¨å­¦ä¹ é—®é¢˜ç›¸æ¯”ï¼Œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå½“ä¸‹æœ€ä¸»è¦çš„é—®é¢˜æ˜¯æ²¡æœ‰åŠæ³•å¾—åˆ°å……è¶³çš„æ•°æ®ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬è®­ç»ƒè®¡ç®—æœºæ•°æ®æ¨¡å‹çš„æ—¶å€™ï¼Œæ•°æ®çš„æ‰©å……å°±æ˜¯ä¼šéå¸¸æœ‰ç”¨ã€‚</p>
<p><strong>æ•°æ®æ‰©å……çš„æ–¹æ³•ï¼š</strong></p>
<ul>
<li>é•œåƒç¿»è½¬ï¼ˆMirroringï¼‰ï¼›</li>
<li>éšæœºå‰ªè£ï¼ˆRandom Croppingï¼‰ï¼›</li>
<li>è‰²å½©è½¬æ¢ï¼ˆColor shiftingï¼‰ï¼š<br>ä¸ºå›¾ç‰‡çš„RGBä¸‰ä¸ªè‰²å½©é€šé“è¿›è¡Œå¢å‡å€¼ï¼Œå¦‚ï¼ˆRï¼š+20ï¼ŒGï¼š-20ï¼ŒBï¼š+20ï¼‰ï¼›PCAé¢œè‰²å¢å¼ºï¼šå¯¹å›¾ç‰‡çš„ä¸»è‰²çš„å˜åŒ–è¾ƒå¤§ï¼Œå›¾ç‰‡çš„æ¬¡è‰²å˜åŒ–è¾ƒå°ï¼Œä½¿æ€»ä½“çš„é¢œè‰²ä¿æŒä¸€è‡´ã€‚</li>
</ul>
<p><strong>è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®æ‰©å……ï¼š</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-59-09.png" alt=""> </p>
<p>ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæ•°æ®æ‰©å……çš„è¿‡ç¨‹å’Œè®­ç»ƒè¿‡ç¨‹å¯ä»¥å¤šCPUå¤šçº¿ç¨‹æ¥å¹¶è¡Œçš„å®ç°ã€‚</p>
<h1 id="è®¡ç®—æœºè§†è§‰ç°çŠ¶">6. è®¡ç®—æœºè§†è§‰ç°çŠ¶</h1><p><strong>æ•°æ®å’Œæ‰‹å·¥å·¥ç¨‹ï¼š</strong></p>
<p>ä¸åŒé—®é¢˜å½“å‰çš„æ•°æ®é›†å¤§å°ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-02-22-59-38.png" alt=""> </p>
<p>åœ¨æœ‰å¤§é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨ç®€å•çš„ç®—æ³•å’Œæ›´å°‘çš„æ‰‹å·¥å·¥ç¨‹ã€‚å› ä¸ºæ­¤æ—¶æœ‰å¤§é‡çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºè¿™ä¸ªé—®é¢˜æ¥ç²¾å¿ƒè®¾è®¡ç‰¹å¾ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¤§çš„ç½‘ç»œç»“æœæˆ–è€…æ›´ç®€å•çš„æ¨¡å‹å°±èƒ½å¤Ÿè§£å†³ã€‚</p>
<p>ç›¸åï¼Œåœ¨æœ‰å°‘é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»äº‹æ›´å¤šçš„æ˜¯æ‰‹å·¥å·¥ç¨‹ã€‚å› ä¸ºæ•°æ®é‡å¤ªå°‘ï¼Œè¾ƒå¤§çš„ç½‘ç»œç»“æ„æˆ–è€…æ¨¡å‹å¾ˆéš¾ä»è¿™äº›å°‘é‡çš„æ•°æ®ä¸­è·å–è¶³å¤Ÿçš„ç‰¹å¾ï¼Œè€Œæ‰‹å·¥å·¥ç¨‹å®é™…ä¸Šæ˜¯è·å¾—è‰¯å¥½è¡¨ç°çš„æœ€ä½³æ–¹å¼ã€‚</p>
<p>å¯¹äºæœºå™¨å­¦ä¹ åº”ç”¨ï¼š</p>
<ul>
<li>æ ‡è®°æ•°æ®ï¼Œï¼ˆx,yï¼‰ï¼›</li>
<li>æ‰‹å·¥ç‰¹å¾å·¥ç¨‹/ç½‘ç»œç»“æ„/å…¶ä»–æ„å»ºã€‚</li>
</ul>
<p><strong>Tips for doing wellï¼š</strong></p>
<p>åœ¨åŸºå‡†ç ”ç©¶å’Œæ¯”èµ›ä¸­ï¼Œä¸‹é¢çš„tipså¯èƒ½ä¼šæœ‰è¾ƒå¥½çš„è¡¨ç°ï¼š</p>
<ul>
<li>Ensemblingï¼šç‹¬ç«‹åœ°è®­ç»ƒå¤šä¸ªç½‘ç»œæ¨¡å‹ï¼Œè¾“å‡ºå¹³å‡ç»“æœæˆ–åŠ æƒå¹³å‡ç»“æœï¼›</li>
<li>æµ‹è¯•æ—¶çš„ Multi-cropï¼šåœ¨æµ‹è¯•å›¾ç‰‡çš„å¤šç§ç‰ˆæœ¬ä¸Šè¿è¡Œåˆ†ç±»å™¨ï¼Œè¾“å‡ºå¹³å‡ç»“æœã€‚</li>
</ul>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> å·ç§¯ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ å®è·µ-1-3-æ„å»ºæµ…å±‚ç¥ç»ç½‘ç»œ]]></title>
      <url>/2017/12/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-1-3-%E6%9E%84%E5%BB%BA%E6%B5%85%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</url>
      <content type="html"><![CDATA[<h1 id="åºè¨€">1. åºè¨€</h1><p>æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª<a href="http://blog.csdn.net/koala_tree/article/details/78067464" target="_blank" rel="external">å´æ©è¾¾Courseraæ·±åº¦å­¦ä¹ è¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šï¼ˆ1-3ï¼‰</a></p>
<p>å´æ©è¾¾Courseraè¯¾ç¨‹ DeepLearning.ai ç¼–ç¨‹ä½œä¸šç³»åˆ—ï¼Œæœ¬æ–‡ä¸ºã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹éƒ¨åˆ†çš„ç¬¬ä¸‰å‘¨â€œæµ…å±‚ç¥ç»ç½‘ç»œâ€çš„è¯¾ç¨‹ä½œä¸šã€‚</p>
<p>æœ¬èŠ‚çš„ä¸»è¦å†…å®¹æ˜¯ï¼šåˆ©ç”¨æµ…å±‚ç¥ç»ç½‘ç»œå®ç°å¹³é¢æ•°æ®åˆ†ç±»</p>
<a id="more"></a>
<h1 id="1-importçš„åŒ…">2. 1 - importçš„åŒ…</h1><ul>
<li>numpy</li>
<li>sklearn</li>
<li>matplotlib</li>
<li>testCase - æä¾›äº†æµ‹è¯•æ ·ä¾‹</li>
<li>pannar_utils - ä¸€äº›æœ‰ç”¨çš„å·¥å…·</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">"ignore"</span>) </div><div class="line"></div><div class="line"><span class="comment"># Package imports</span></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> testCases <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sklearn</div><div class="line"><span class="keyword">import</span> sklearn.datasets</div><div class="line"><span class="keyword">import</span> sklearn.linear_model</div><div class="line"><span class="keyword">from</span> planar_utils <span class="keyword">import</span> plot_decision_boundary, sigmoid, load_planar_dataset, load_extra_datasets</div><div class="line"></div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line">np.random.seed(<span class="number">1</span>) <span class="comment"># ç»™np.randomè®¾å®šä¸€ä¸ªç§å­ï¼Œè¿™æ ·éšæœºæ•°å°±å›ºå®šäº†</span></div></pre></td></tr></table></figure>
<h1 id="2-æ•°æ®é›†">3. 2 - æ•°æ®é›†</h1><p>ä¸‹é¢çš„ä»£ç ç”Ÿæˆäº†â€œèŠ±â€çš„äºŒç±»æ•°æ®é›†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># è¿™ä¸ªå‡½æ•°åŸæœ¬åœ¨panar_utils.pyé‡Œ</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_planar_dataset</span><span class="params">()</span>:</span></div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    m = <span class="number">400</span> <span class="comment"># æ ·æœ¬æ•°é‡</span></div><div class="line">    N = int(m/<span class="number">2</span>) <span class="comment"># æ¯ä¸ªç±»åˆ«çš„æ•°é‡</span></div><div class="line">    D = <span class="number">2</span> <span class="comment"># ç»´åº¦</span></div><div class="line">    <span class="comment"># åˆå§‹åŒ–X,Y</span></div><div class="line">    X = np.zeros((m,D))</div><div class="line">    Y = np.zeros((m,<span class="number">1</span>),dtype=<span class="string">'uint8'</span>)</div><div class="line">    a = <span class="number">4</span> <span class="comment"># èŠ±å„¿æœ€å¤§é•¿åº¦</span></div><div class="line">    </div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>):</div><div class="line">        ix = range(N*j,N*(j+<span class="number">1</span>))</div><div class="line">        t = np.linspace(j*<span class="number">3.12</span>,(j+<span class="number">1</span>)*<span class="number">3.12</span>,N) + np.random.randn(N)*<span class="number">0.2</span> <span class="comment"># theta</span></div><div class="line">        r = a*np.sin(<span class="number">4</span>*t) + np.random.randn(N)*<span class="number">0.2</span> <span class="comment"># radius</span></div><div class="line">        X[ix] = np.c_[r*np.sin(t), r*np.cos(t)]</div><div class="line">        Y[ix] = j</div><div class="line">        </div><div class="line">    X = X.T</div><div class="line">    Y = Y.T</div><div class="line"></div><div class="line">    <span class="keyword">return</span> X, Y</div><div class="line"></div><div class="line">X,Y = load_planar_dataset()</div><div class="line"><span class="keyword">print</span> X.shape,Y.shape</div></pre></td></tr></table></figure>
<pre><code>(2L, 400L) (1L, 400L)
</code></pre><p>â€‹    </p>
<p>æ­¤æ—¶ä½ å¾—åˆ°äº†ï¼š</p>
<ul>
<li>ä¸€ä¸ªnumpy-array(matrix) X,åŒ…æ‹¬ç‰¹å¾ï¼ˆX1ï¼ŒX2ï¼‰</li>
<li>ä¸€ä¸ªnumpy-arrya(vector) Y,åŒ…å«ä¸€åˆ—æ ‡ç­¾ï¼ˆ0æˆ–1ï¼‰</li>
</ul>
<p>æ¥ä¸‹æ¥ç”¨matplotlibå°†è¿™ä¸ªâ€œèŠ±å„¿â€æ•°æ®é›†å¯è§†åŒ–ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li>y = 0 -&gt; çº¢è‰²</li>
<li>y = 1 -&gt; è“è‰²</li>
</ul>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œèƒ½å°†çº¢è‰²å’Œè“è‰²åˆ†å¼€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># æ•°æ®å¯è§†åŒ–</span></div><div class="line">plt.scatter(X[<span class="number">0</span>, :], X[<span class="number">1</span>, :], c=Y, s=<span class="number">40</span>, cmap=plt.cm.Spectral)</div></pre></td></tr></table></figure>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-05-21-55-52.png" alt=""> </p>
<h1 id="ç®€å•çš„é€»è¾‘å›å½’">4. ç®€å•çš„é€»è¾‘å›å½’</h1><p>é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹LRåœ¨è¿™ä¸ªé—®é¢˜ä¸Šè¡¨ç°å¦‚ä½•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Train the logistic regression classifier</span></div><div class="line">clf = sklearn.linear_model.LogisticRegressionCV();</div><div class="line">clf.fit(X.T, Y.T);</div><div class="line"></div><div class="line"><span class="comment"># ç”»å‡ºLRçš„å†³ç­–è¾¹ç•Œ</span></div><div class="line">plot_decision_boundary(<span class="keyword">lambda</span> x: clf.predict(x), X, Y)</div><div class="line">plt.title(<span class="string">"Logistic Regression"</span>)</div><div class="line"></div><div class="line"><span class="comment"># æ‰“å°å‡†ç¡®ç‡</span></div><div class="line">LR_predictions = clf.predict(X.T)</div><div class="line"><span class="keyword">print</span> (<span class="string">'LRçš„å‡†ç¡®ç‡æ˜¯: %d '</span> % float((np.dot(Y,LR_predictions) + np.dot(<span class="number">1</span>-Y,<span class="number">1</span>-LR_predictions))/float(Y.size)*<span class="number">100</span>) +</div><div class="line">       <span class="string">'% '</span>)</div></pre></td></tr></table></figure>
<pre><code>LRçš„å‡†ç¡®ç‡æ˜¯: 47 % 
</code></pre><p>â€‹    </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-05-21-56-33.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ä»¥ä¸Šçš„plot_decision_boundary()å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_decision_boundary</span><span class="params">(model, X, y)</span>:</span></div><div class="line">    <span class="comment"># Set min and max values and give it some padding</span></div><div class="line">    x_min, x_max = X[<span class="number">0</span>, :].min() - <span class="number">1</span>, X[<span class="number">0</span>, :].max() + <span class="number">1</span></div><div class="line">    y_min, y_max = X[<span class="number">1</span>, :].min() - <span class="number">1</span>, X[<span class="number">1</span>, :].max() + <span class="number">1</span></div><div class="line">    h = <span class="number">0.01</span></div><div class="line">    <span class="comment"># Generate a grid of points with distance h between them</span></div><div class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</div><div class="line">    <span class="comment"># Predict the function value for the whole grid</span></div><div class="line">    Z = model(np.c_[xx.ravel(), yy.ravel()])</div><div class="line">    Z = Z.reshape(xx.shape)</div><div class="line">    <span class="comment"># Plot the contour and training examples</span></div><div class="line">    plt.contourf(xx, yy, Z, cmap=plt.cm.Spectral)</div><div class="line">    plt.ylabel(<span class="string">'x2'</span>)</div><div class="line">    plt.xlabel(<span class="string">'x1'</span>)</div><div class="line">    plt.scatter(X[<span class="number">0</span>, :], X[<span class="number">1</span>, :], c=y, cmap=plt.cm.Spectral)</div></pre></td></tr></table></figure>
<h1 id="ç¥ç»ç½‘ç»œæ¨¡å‹">5. ç¥ç»ç½‘ç»œæ¨¡å‹</h1><p>æˆ‘ä»¬æœ¬æ¬¡<strong>æ¨¡å‹</strong>ä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-05-20-50-56.png" alt=""> </p>
<p><strong>æ•°å­¦æ¨¡å‹</strong><br>å¯¹äºä¸€æ¡æ ·æœ¬$x^{i}$</p>
<p>$$z^{[1] (i)} =  W^{[1]} x^{(i)} + b^{[1] (i)}\tag{1}$$<br>$$a^{[1] (i)} = \tanh(z^{[1] (i)})\tag{2}$$<br>$$z^{[2] (i)} = W^{[2]} a^{[1] (i)} + b^{[2] (i)}\tag{3}$$<br>$$\hat{y}^{(i)} = a^{[2] (i)} = \sigma(z^{ [2] (i)})\tag{4}$$<br>$$y^{(i)}_{prediction} = \begin{cases} 1 &amp; \mbox{if } a^{<a href="i">2</a>} &gt; 0.5 \ 0 &amp; \mbox{otherwise } \end{cases}\tag{5}$$</p>
<p>é€šè¿‡ä¸Šå¼è®¡ç®—å‡ºæ‰€æœ‰æ ·æœ¬çš„é¢„æµ‹è¯¯å·®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å‡ºè¯¯å·®å‡½æ•°ï¼š<br>$$J = - \frac{1}{m} \sum\limits_{i = 0}^{m} \large\left(\small y^{(i)}\log\left(a^{[2] (i)}\right) + (1-y^{(i)})\log\left(1- a^{[2] (i)}\right)  \large  \right) \small \tag{6}$$</p>
<p>å›å¿†ä¸€ä¸‹ï¼Œè®¡ç®—ç¥ç»ç½‘ç»œçš„æ­¥éª¤ä¸ºï¼š</p>
<ol>
<li>å®šä¹‰ç½‘ç»œç»“æ„</li>
<li>åˆå§‹åŒ–æ¨¡å‹å‚æ•°</li>
<li>è¿­ä»£<ul>
<li>å‰å‘ä¼ æ’­è®¡ç®—é¢„æµ‹å€¼</li>
<li>è®¡ç®—è¯¯å·®</li>
<li>åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</li>
<li>æ ¹æ®æ¢¯åº¦æ›´æ–°å‚æ•°</li>
</ul>
</li>
</ol>
<h1 id="å®šä¹‰ç½‘ç»œç»“æ„">6. å®šä¹‰ç½‘ç»œç»“æ„</h1><p>çº¦å®šï¼š</p>
<ul>
<li>n_x : è¾“å…¥å±‚çš„æ•°æ®ä¸ªæ•°</li>
<li>n_h : éšè—å±‚æ•° ï¼ˆæ­¤å¤„è®¾ç½®ä¸º4ï¼‰</li>
<li>n_y : è¾“å‡ºå±‚çš„æ•°æ®ä¸ªæ•°ï¼ˆç±»åˆ«ä¸ªæ•°ï¼‰</li>
</ul>
<p>å¯å®šä¹‰å¦‚ä¸‹å‡½æ•°æ¥è·å–ä»¥ä¸Šä¸‰ä¸ªæ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: layer_sizes</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">layer_sizes</span><span class="params">(X, Y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Arguments:</div><div class="line">    X -- input dataset of shape (input size, number of examples)</div><div class="line">    Y -- labels of shape (output size, number of examples)</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    n_x -- the size of the input layer</div><div class="line">    n_h -- the size of the hidden layer</div><div class="line">    n_y -- the size of the output layer</div><div class="line">    """</div><div class="line">    <span class="comment">### START CODE HERE ### (â‰ˆ 3 lines of code)</span></div><div class="line">    n_x = X.shape[<span class="number">0</span>] <span class="comment"># size of input layer</span></div><div class="line">    n_h = <span class="number">4</span></div><div class="line">    n_y = Y.shape[<span class="number">0</span>]<span class="comment"># size of output layer</span></div><div class="line">    <span class="comment">### END CODE HERE ###</span></div><div class="line">    <span class="keyword">return</span> (n_x, n_h, n_y)</div><div class="line">n_x, n_h, n_y = layer_sizes(X,Y)</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"n_x = "</span>,n_x</div><div class="line"><span class="keyword">print</span> <span class="string">"n_h = "</span>,n_h</div><div class="line"><span class="keyword">print</span> <span class="string">"n_y = "</span>,n_y</div></pre></td></tr></table></figure>
<pre><code>n_x =  2
n_h =  4
n_y =  1
</code></pre><h2 id="åˆå§‹åŒ–å‚æ•°">6.1. åˆå§‹åŒ–å‚æ•°</h2><p>éœ€è¦åˆå§‹åŒ–çš„å‚æ•°ä¸»è¦æ˜¯Wå’Œb</p>
<p>Exercise: Implement the function initialize_parameters().</p>
<p>Instructions: </p>
<ul>
<li>Make sure your parametersâ€™ sizes are right. Refer to the neural network figure above if needed. </li>
<li>You will initialize the weights matrices with random values. </li>
<li>Use: np.random.randn(a,b) * 0.01 to randomly initialize a matrix of shape (a,b). </li>
<li>You will initialize the bias vectors as zeros. </li>
<li>Use: np.zeros((a,b)) to initialize a matrix of shape (a,b) with zeros.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: initialize_parameters</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">(n_x, n_h, n_y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Argument:</div><div class="line">    n_x -- size of the input layer</div><div class="line">    n_h -- size of the hidden layer</div><div class="line">    n_y -- size of the output layer</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    params -- python dictionary containing your parameters:</div><div class="line">                    W1 -- weight matrix of shape (n_h, n_x)</div><div class="line">                    b1 -- bias vector of shape (n_h, 1)</div><div class="line">                    W2 -- weight matrix of shape (n_y, n_h)</div><div class="line">                    b2 -- bias vector of shape (n_y, 1)</div><div class="line">    """</div><div class="line"></div><div class="line">    np.random.seed(<span class="number">2</span>) <span class="comment"># we set up a seed so that your output matches ours although the initialization is random.</span></div><div class="line"></div><div class="line">    <span class="comment">### START CODE HERE ### (â‰ˆ 4 lines of code)</span></div><div class="line">    W1 = np.random.randn(n_h, n_x)</div><div class="line">    b1 = np.zeros((n_h, <span class="number">1</span>))</div><div class="line">    W2 = np.random.randn(n_y, n_h)</div><div class="line">    b2 = np.zeros((n_y, <span class="number">1</span>))</div><div class="line">    <span class="comment">### END CODE HERE ###</span></div><div class="line"></div><div class="line">    <span class="keyword">assert</span> (W1.shape == (n_h, n_x))</div><div class="line">    <span class="keyword">assert</span> (b1.shape == (n_h, <span class="number">1</span>))</div><div class="line">    <span class="keyword">assert</span> (W2.shape == (n_y, n_h))</div><div class="line">    <span class="keyword">assert</span> (b2.shape == (n_y, <span class="number">1</span>))</div><div class="line"></div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line">parameters = initialize_parameters(n_x, n_h, n_y)</div><div class="line">print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>]))</div><div class="line">print(<span class="string">"b1 = "</span> + str(parameters[<span class="string">"b1"</span>]))</div><div class="line">print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>]))</div><div class="line">print(<span class="string">"b2 = "</span> + str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>W1 = [[-0.41675785 -0.05626683]
 [-2.1361961   1.64027081]
 [-1.79343559 -0.84174737]
 [ 0.50288142 -1.24528809]]
b1 = [[ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]
W2 = [[-1.05795222 -0.90900761  0.55145404  2.29220801]]
b2 = [[ 0.]]
</code></pre><h2 id="è¿­ä»£">6.2. è¿­ä»£</h2><h3 id="å‰å‘ä¼ æ’­">6.2.1. å‰å‘ä¼ æ’­</h3><p><strong>é—®é¢˜</strong>: å®ç° <code>forward_propagation()</code>.</p>
<p><strong>Instructions</strong>:</p>
<ul>
<li>Look above at the mathematical representation of your classifier.</li>
<li>You can use the function <code>sigmoid()</code>. It is built-in (imported) in the notebook.</li>
<li>You can use the function <code>np.tanh()</code>. It is part of the numpy library.</li>
<li>The steps you have to implement are:<ol>
<li>Retrieve each parameter from the dictionary â€œparametersâ€ (which is the output of <code>initialize_parameters()</code>) by using <code>parameters[&quot;..&quot;]</code>.</li>
<li>Implement Forward Propagation. Compute $Z^{[1]}, A^{[1]}, Z^{[2]}$ and $A^{[2]}$ (the vector of all your predictions on all the examples in the training set).</li>
</ol>
</li>
<li>Values needed in the backpropagation are stored in â€œ<code>cache</code>â€œ. The <code>cache</code> will be given as an input to the backpropagation function.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å‰å‘ä¼ æ’­</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_propagation</span><span class="params">(X, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Argument:</div><div class="line">    X -- input data of size (n_x, m)</div><div class="line">    parameters -- python dictionary containing your parameters (output of initialization function)</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    A2 -- The sigmoid output of the second activation</div><div class="line">    cache -- a dictionary containing "Z1", "A1", "Z2" and "A2"</div><div class="line">    """</div><div class="line">    <span class="comment"># Retrieve each parameter from the dictionary "parameters"</span></div><div class="line">    <span class="comment">### START CODE HERE ### (â‰ˆ 4 lines of code)</span></div><div class="line">    <span class="comment"># å‚æ•°è·å–</span></div><div class="line">    W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">    b1 = parameters[<span class="string">"b1"</span>]</div><div class="line">    W2 = parameters[<span class="string">"W2"</span>]</div><div class="line">    b2 = parameters[<span class="string">"b2"</span>]</div><div class="line">    <span class="comment">### END CODE HERE ###</span></div><div class="line"></div><div class="line">    <span class="comment"># Implement Forward Propagation to calculate A2 (probabilities)</span></div><div class="line">    <span class="comment">### START CODE HERE ### (â‰ˆ 4 lines of code)</span></div><div class="line">    <span class="comment"># è®¡ç®—é¢„æµ‹å€¼</span></div><div class="line">    Z1 = np.dot(W1, X) + b1</div><div class="line">    A1 = np.tanh(Z1)</div><div class="line">    Z2 = np.dot(W2, A1) + b2 </div><div class="line">    A2 = sigmoid(Z2)</div><div class="line">    <span class="comment">### END CODE HERE ###</span></div><div class="line"></div><div class="line">    <span class="keyword">assert</span>(A2.shape == (<span class="number">1</span>, X.shape[<span class="number">1</span>]))</div><div class="line"></div><div class="line">    cache = &#123;<span class="string">"Z1"</span>: Z1,</div><div class="line">             <span class="string">"A1"</span>: A1,</div><div class="line">             <span class="string">"Z2"</span>: Z2,</div><div class="line">             <span class="string">"A2"</span>: A2&#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> A2, cache</div><div class="line"></div><div class="line">X_assess, parameters = forward_propagation_test_case()</div><div class="line">A2, cache = forward_propagation(X_assess, parameters)</div><div class="line"></div><div class="line"><span class="comment"># Note: we use the mean here just to make sure that your output matches ours. </span></div><div class="line">print(np.mean(cache[<span class="string">'Z1'</span>]) ,np.mean(cache[<span class="string">'A1'</span>]),np.mean(cache[<span class="string">'Z2'</span>]),np.mean(cache[<span class="string">'A2'</span>]))</div></pre></td></tr></table></figure>
<pre><code>(-0.00049975577774199022, -0.00049696335323177901, 0.00043818745095914658, 0.50010954685243103)
</code></pre><p>â€‹    </p>
<h3 id="è®¡ç®—è¯¯å·®">6.2.2. è®¡ç®—è¯¯å·®</h3><p>ç°åœ¨æˆ‘ä»¬å·²ç»è®¡ç®—é™¤äº†é¢„æµ‹å€¼A2ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è®¡ç®—æœ¬è½®è¯¯å·®ï¼š</p>
<p>$$J = - \frac{1}{m} \sum\limits_{i = 0}^{m} \large{(} \small y^{(i)}\log\left(a^{[2] (i)}\right) + (1-y^{(i)})\log\left(1- a^{[2] (i)}\right) \large{)} \small\tag{13}$$</p>
<p><strong>Exercise</strong>: Implement <code>compute_cost()</code> to compute the value of the cost $J$.</p>
<p><strong>Instructions</strong>:</p>
<ul>
<li>There are many ways to implement the cross-entropy loss. To help you, we give you how we would have implemented<br>$- \sum\limits_{i=0}^{m}  y^{(i)}\log(a^{<a href="i">2</a>})$:<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">logprobs = np.multiply(np.log(A2),Y)</div><div class="line">cost = - np.sum(logprobs)                <span class="comment"># no need to use a for loop!</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>(you can use either <code>np.multiply()</code> and then <code>np.sum()</code> or directly <code>np.dot()</code>).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: compute_cost</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(A2, Y, parameters)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Computes the cross-entropy cost given in equation (13)</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    A2 -- The sigmoid output of the second activation, of shape (1, number of examples)</div><div class="line">    Y -- "true" labels vector of shape (1, number of examples)</div><div class="line">    parameters -- python dictionary containing your parameters W1, b1, W2 and b2</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    cost -- cross-entropy cost given equation (13)</div><div class="line">    """</div><div class="line"></div><div class="line">    m = Y.shape[<span class="number">1</span>] <span class="comment"># number of example</span></div><div class="line"></div><div class="line">    <span class="comment"># Compute the cross-entropy cost</span></div><div class="line">    <span class="comment">### START CODE HERE ### (â‰ˆ 2 lines of code)</span></div><div class="line">    <span class="comment"># è¯¯å·®è®¡ç®—</span></div><div class="line">    logprobs = np.multiply(np.log(A2), Y) + np.multiply(np.log(<span class="number">1</span>-A2), (<span class="number">1</span>-Y))</div><div class="line">    cost = -(<span class="number">1.0</span>/m)*np.sum(logprobs)</div><div class="line">    <span class="comment">### END CODE HERE ###</span></div><div class="line"></div><div class="line">    cost = np.squeeze(cost)     <span class="comment"># makes sure cost is the dimension we expect. </span></div><div class="line">                                <span class="comment"># E.g., turns [[17]] into 17 </span></div><div class="line">    <span class="keyword">assert</span>(isinstance(cost, float))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> cost</div><div class="line">A2, Y_assess, parameters = compute_cost_test_case()</div><div class="line"></div><div class="line">print(<span class="string">"cost = "</span> + str(compute_cost(A2, Y_assess, parameters)))</div></pre></td></tr></table></figure>
<pre><code>cost = 0.692919893776
</code></pre><p>â€‹    </p>
<h3 id="åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦">6.2.3. åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</h3><p>Using the cache computed during forward propagation, you can now implement backward propagation.</p>
<p><strong>Question</strong>: Implement the function <code>backward_propagation()</code>.</p>
<p><strong>Instructions</strong>:<br>Backpropagation is usually the hardest (most mathematical) part in deep learning. To help you, here again is the slide from the lecture on backpropagation. Youâ€™ll want to use the six equations on the right of this slide, since you are building a vectorized implementation.  </p>
<p>$\frac{\partial \mathcal{J} }{ \partial z_{2}^{(i)} } = \frac{1}{m} (a^{<a href="i">2</a>} - y^{(i)})$</p>
<p>$\frac{\partial \mathcal{J} }{ \partial W_2 } = \frac{\partial \mathcal{J} }{ \partial z_{2}^{(i)} } a^{[1] (i) T} $</p>
<p>$\frac{\partial \mathcal{J} }{ \partial b_2 } = \sum_i{\frac{\partial \mathcal{J} }{ \partial z_{2}^{(i)}}}$</p>
<p>$\frac{\partial \mathcal{J} }{ \partial z_{1}^{(i)} } =  W_2^T \frac{\partial \mathcal{J} }{ \partial z_{2}^{(i)} } * ( 1 - a^{[1] (i) 2}) $</p>
<p>$\frac{\partial \mathcal{J} }{ \partial W_1 } = \frac{\partial \mathcal{J} }{ \partial z_{1}^{(i)} }  X^T $</p>
<p>$\frac{\partial \mathcal{J} _i }{ \partial b_1 } = \sum_i{\frac{\partial \mathcal{J} }{ \partial z_{1}^{(i)}}}$</p>
<ul>
<li>Note that $*$ denotes elementwise multiplication.</li>
<li>The notation you will use is common in deep learning coding:<ul>
<li>dW1 = $\frac{\partial \mathcal{J} }{ \partial W_1 }$</li>
<li>db1 = $\frac{\partial \mathcal{J} }{ \partial b_1 }$</li>
<li>dW2 = $\frac{\partial \mathcal{J} }{ \partial W_2 }$</li>
<li>db2 = $\frac{\partial \mathcal{J} }{ \partial b_2 }$</li>
</ul>
</li>
</ul>
<ul>
<li>Tips:<ul>
<li>To compute dZ1 youâ€™ll need to compute $g^{[1]â€™}(Z^{[1]})$. Since $g^{[1]}(.)$ is the tanh activation function, if $a = g^{[1]}(z)$ then $g^{[1]â€™}(z) = 1-a^2$. So you can compute<br>$g^{[1]â€™}(Z^{[1]})$ using <code>(1 - np.power(A1, 2))</code>.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: backward_propagation</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">backward_propagation</span><span class="params">(parameters, cache, X, Y)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Implement the backward propagation using the instructions above.</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    parameters -- python dictionary containing our parameters </div><div class="line">    cache -- a dictionary containing "Z1", "A1", "Z2" and "A2".</div><div class="line">    X -- input data of shape (2, number of examples)</div><div class="line">    Y -- "true" labels vector of shape (1, number of examples)</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    grads -- python dictionary containing your gradients with respect to different parameters</div><div class="line">    """</div><div class="line">    m = X.shape[<span class="number">1</span>]</div><div class="line"></div><div class="line">    <span class="comment"># First, retrieve W1 and W2 from the dictionary "parameters".</span></div><div class="line">    <span class="comment"># è·å–å‚æ•°</span></div><div class="line">    W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">    W2 = parameters[<span class="string">"W2"</span>]</div><div class="line"></div><div class="line">    A1 = cache[<span class="string">"A1"</span>]</div><div class="line">    A2 = cache[<span class="string">"A2"</span>]</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># Backward propagation: calculate dW1, db1, dW2, db2. </span></div><div class="line">    <span class="comment"># åå‘ä¼ æ’­</span></div><div class="line">    dZ2 = A2 - Y</div><div class="line">    dW2 = <span class="number">1.0</span>/m*np.dot(dZ2, A1.T)</div><div class="line">    db2 = <span class="number">1.0</span>/m*np.sum(dZ2, axis=<span class="number">1</span>, keepdims=<span class="keyword">True</span>)</div><div class="line">    dZ1 = np.dot(W2.T, dZ2)*(<span class="number">1</span>-np.power(A1, <span class="number">2</span>))</div><div class="line">    dW1 = <span class="number">1.0</span>/m*np.dot(dZ1, X.T)</div><div class="line">    db1 = <span class="number">1.0</span>/m*np.sum(dZ1, axis=<span class="number">1</span>, keepdims=<span class="keyword">True</span>)</div><div class="line"></div><div class="line"></div><div class="line">    grads = &#123;<span class="string">"dW1"</span>: dW1,</div><div class="line">             <span class="string">"db1"</span>: db1,</div><div class="line">             <span class="string">"dW2"</span>: dW2,</div><div class="line">             <span class="string">"db2"</span>: db2&#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> grads</div><div class="line"></div><div class="line">parameters, cache, X_assess, Y_assess = backward_propagation_test_case()</div><div class="line"></div><div class="line">grads = backward_propagation(parameters, cache, X_assess, Y_assess)</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW1 = "</span>+ str(grads[<span class="string">"dW1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db1 = "</span>+ str(grads[<span class="string">"db1"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"dW2 = "</span>+ str(grads[<span class="string">"dW2"</span>]))</div><div class="line"><span class="keyword">print</span> (<span class="string">"db2 = "</span>+ str(grads[<span class="string">"db2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>dW1 = [[ 0.01018708 -0.00708701]
 [ 0.00873447 -0.0060768 ]
 [-0.00530847  0.00369379]
 [-0.02206365  0.01535126]]
db1 = [[-0.00069728]
 [-0.00060606]
 [ 0.000364  ]
 [ 0.00151207]]
dW2 = [[ 0.00363613  0.03153604  0.01162914 -0.01318316]]
db2 = [[ 0.06589489]]
</code></pre><h3 id="æ›´æ–°å‚æ•°">6.2.4. æ›´æ–°å‚æ•°</h3><p><strong>Question</strong>: Implement the update rule. Use gradient descent. You have to use (dW1, db1, dW2, db2) in order to update (W1, b1, W2, b2).</p>
<p><strong>General gradient descent rule</strong>: $ \theta = \theta - \alpha \frac{\partial J }{ \partial \theta }$ where $\alpha$ is the learning rate and $\theta$ represents a parameter.</p>
<p><strong>Illustration</strong>: The gradient descent algorithm with a good learning rate (converging) and a bad learning rate (diverging). Images courtesy of Adam Harley.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: update_parameters</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters, grads, learning_rate = <span class="number">1.2</span>)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Updates parameters using the gradient descent update rule given above</div><div class="line">    </div><div class="line">    Arguments:</div><div class="line">    parameters -- python dictionary containing your parameters </div><div class="line">    grads -- python dictionary containing your gradients </div><div class="line">    </div><div class="line">    Returns:</div><div class="line">    parameters -- python dictionary containing your updated parameters </div><div class="line">    """</div><div class="line">    <span class="comment"># Retrieve each parameter from the dictionary "parameters"</span></div><div class="line">    <span class="comment"># è·å–å‚æ•°</span></div><div class="line">    W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">    b1 = parameters[<span class="string">"b1"</span>]</div><div class="line">    W2 = parameters[<span class="string">"W2"</span>]</div><div class="line">    b2 = parameters[<span class="string">"b2"</span>]</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># Retrieve each gradient from the dictionary "grads"</span></div><div class="line">    <span class="comment"># è·å–æ¢¯åº¦</span></div><div class="line">    dW1 = grads[<span class="string">"dW1"</span>]</div><div class="line">    db1 = grads[<span class="string">"db1"</span>]</div><div class="line">    dW2 = grads[<span class="string">"dW2"</span>]</div><div class="line">    db2 = grads[<span class="string">"db2"</span>]</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># Update rule for each parameter</span></div><div class="line">    <span class="comment"># æ ¹æ®æ¢¯åº¦æ›´æ–°å‚æ•°</span></div><div class="line">    W1 = W1 - learning_rate * dW1</div><div class="line">    b1 = b1 - learning_rate * db1</div><div class="line">    W2 = W2 - learning_rate * dW2</div><div class="line">    b2 = b2 - learning_rate * db2</div><div class="line">    </div><div class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</div><div class="line">                  <span class="string">"b1"</span>: b1,</div><div class="line">                  <span class="string">"W2"</span>: W2,</div><div class="line">                  <span class="string">"b2"</span>: b2&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line">parameters, grads = update_parameters_test_case()</div><div class="line">parameters = update_parameters(parameters, grads)</div><div class="line"></div><div class="line">print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>]))</div><div class="line">print(<span class="string">"b1 = "</span> + str(parameters[<span class="string">"b1"</span>]))</div><div class="line">print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>]))</div><div class="line">print(<span class="string">"b2 = "</span> + str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>W1 = [[-0.00643025  0.01936718]
 [-0.02410458  0.03978052]
 [-0.01653973 -0.02096177]
 [ 0.01046864 -0.05990141]]
b1 = [[ -1.02420756e-06]
 [  1.27373948e-05]
 [  8.32996807e-07]
 [ -3.20136836e-06]]
W2 = [[-0.01041081 -0.04463285  0.01758031  0.04747113]]
b2 = [[ 0.00010457]]
</code></pre><h3 id="å°†å‰é¢ä¸‰æ­¥åˆåœ¨ä¸€èµ·">6.2.5. å°†å‰é¢ä¸‰æ­¥åˆåœ¨ä¸€èµ·</h3><p><strong>Question</strong>: Build your neural network model in <code>nn_model()</code>.</p>
<p><strong>Instructions</strong>: The neural network model has to use the previous functions in the right order.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># GRADED FUNCTION: nn_model</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nn_model</span><span class="params">(X, Y, n_h, num_iterations = <span class="number">10000</span>, print_cost=False)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Arguments:</div><div class="line">    X -- dataset of shape (2, number of examples)</div><div class="line">    Y -- labels of shape (1, number of examples)</div><div class="line">    n_h -- size of the hidden layer</div><div class="line">    num_iterations -- Number of iterations in gradient descent loop</div><div class="line">    print_cost -- if True, print the cost every 1000 iterations</div><div class="line"></div><div class="line">    Returns:</div><div class="line">    parameters -- parameters learnt by the model. They can then be used to predict.</div><div class="line">    """</div><div class="line"></div><div class="line">    np.random.seed(<span class="number">3</span>)</div><div class="line">    n_x = layer_sizes(X, Y)[<span class="number">0</span>]</div><div class="line">    n_y = layer_sizes(X, Y)[<span class="number">2</span>]</div><div class="line"></div><div class="line">    <span class="comment"># Initialize parameters, then retrieve W1, b1, W2, b2. Inputs: "n_x, n_h, n_y". Outputs = "W1, b1, W2, b2, parameters".</span></div><div class="line">    <span class="comment"># è·å–åˆå§‹åŒ–å‚æ•°</span></div><div class="line">    parameters = initialize_parameters(n_x, n_h, n_y)</div><div class="line">    W1 = parameters[<span class="string">"W1"</span>]</div><div class="line">    b1 = parameters[<span class="string">"b1"</span>]</div><div class="line">    W2 = parameters[<span class="string">"W2"</span>]</div><div class="line">    b2 = parameters[<span class="string">"b2"</span>]</div><div class="line"></div><div class="line">    <span class="comment"># Loop (gradient descent)</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, num_iterations):</div><div class="line"></div><div class="line">        <span class="comment"># Forward propagation. Inputs: "X, parameters". Outputs: "A2, cache".</span></div><div class="line">        <span class="comment"># å‰å‘ä¼ æ’­è®¡ç®—é¢„æµ‹å€¼</span></div><div class="line">        A2, cache = forward_propagation(X, parameters)</div><div class="line"></div><div class="line">        <span class="comment"># Cost function. Inputs: "A2, Y, parameters". Outputs: "cost".</span></div><div class="line">        <span class="comment"># è®¡ç®—è¯¯å·®</span></div><div class="line">        cost = compute_cost(A2, Y, parameters)</div><div class="line"></div><div class="line">        <span class="comment"># Backpropagation. Inputs: "parameters, cache, X, Y". Outputs: "grads".</span></div><div class="line">        <span class="comment"># åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</span></div><div class="line">        grads = backward_propagation(parameters, cache, X, Y)</div><div class="line"></div><div class="line">        <span class="comment"># Gradient descent parameter update. Inputs: "parameters, grads". Outputs: "parameters".</span></div><div class="line">        <span class="comment"># æ ¹æ®æ¢¯åº¦æ›´æ–°å‚æ•°</span></div><div class="line">        parameters = update_parameters(parameters, grads)</div><div class="line"></div><div class="line">        <span class="comment"># Print the cost every 1000 iterations</span></div><div class="line">        <span class="keyword">if</span> print_cost <span class="keyword">and</span> i % <span class="number">1000</span> == <span class="number">0</span>:</div><div class="line">            <span class="keyword">print</span> (<span class="string">"Cost after iteration %i: %f"</span> %(i, cost))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> parameters</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nn_model_test_case</span><span class="params">()</span>:</span></div><div class="line">    np.random.seed(<span class="number">1</span>)</div><div class="line">    X_assess = np.random.randn(<span class="number">2</span>, <span class="number">3</span>)</div><div class="line">    Y_assess = np.random.randn(<span class="number">1</span>, <span class="number">3</span>)</div><div class="line">    <span class="keyword">return</span> X_assess, Y_assess</div><div class="line"></div><div class="line">X_assess, Y_assess = nn_model_test_case()</div><div class="line"><span class="keyword">print</span> X_assess</div><div class="line"><span class="keyword">print</span> Y_assess</div><div class="line">parameters = nn_model(X_assess, Y_assess, <span class="number">4</span>, num_iterations=<span class="number">10000</span>, print_cost=<span class="keyword">True</span>)</div><div class="line">print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>]))</div><div class="line">print(<span class="string">"b1 = "</span> + str(parameters[<span class="string">"b1"</span>]))</div><div class="line">print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>]))</div><div class="line">print(<span class="string">"b2 = "</span> + str(parameters[<span class="string">"b2"</span>]))</div></pre></td></tr></table></figure>
<pre><code>[[ 1.62434536 -0.61175641 -0.52817175]
 [-1.07296862  0.86540763 -2.3015387 ]]
[[ 1.74481176 -0.7612069   0.3190391 ]]
Cost after iteration 0: -0.734104
Cost after iteration 1000: -inf
Cost after iteration 2000: -inf
Cost after iteration 3000: -inf
Cost after iteration 4000: -inf
Cost after iteration 5000: -inf
Cost after iteration 6000: -inf
Cost after iteration 7000: -inf
Cost after iteration 8000: -inf
Cost after iteration 9000: -inf
W1 = [[-7.53845806  1.20775367]
 [-4.25271792  5.29708473]
 [-7.53823957  1.20769882]
 [ 4.1479613  -5.35960029]]
b1 = [[ 3.81060333]
 [ 2.31388695]
 [ 3.81043858]
 [-2.32850837]]
W2 = [[-6012.41560745 -6036.77027646 -6010.58554698  6038.039225  ]]
b2 = [[-53.79862878]]
</code></pre><h3 id="é¢„æµ‹">6.2.6. é¢„æµ‹</h3><p><strong>Question</strong>: Use your model to predict by building predict().<br>Use forward propagation to predict results.</p>
<p><strong>Reminder</strong>: predictions = $y_{prediction} = \mathbb 1 (\text{ if activation &gt; 0.5}) $  </p>
<p>As an example, if you would like to set the entries of a matrix X to 0 and 1 based on a threshold you would do: <figure class="highlight plain"><figcaption><span>= (X > threshold)```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">```python</div><div class="line"># GRADED FUNCTION: predict</div><div class="line"></div><div class="line">def predict(parameters, X):</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    Using the learned parameters, predicts a class for each example in X</div><div class="line"></div><div class="line">    Arguments:</div><div class="line">    parameters -- python dictionary containing your parameters </div><div class="line">    X -- input data of size (n_x, m)</div><div class="line"></div><div class="line">    Returns</div><div class="line">    predictions -- vector of predictions of our model (red: 0 / blue: 1)</div><div class="line">    &quot;&quot;&quot;</div><div class="line"></div><div class="line">    # Computes probabilities using forward propagation, and classifies to 0/1 using 0.5 as the threshold.</div><div class="line">    ### START CODE HERE ### (â‰ˆ 2 lines of code)</div><div class="line">    A2, cache = forward_propagation(X, parameters)</div><div class="line">    predictions = (A2 &gt; 0.5)</div><div class="line">    ### END CODE HERE ###</div><div class="line"></div><div class="line">    return predictions</div><div class="line"></div><div class="line"></div><div class="line">parameters, X_assess = predict_test_case()</div><div class="line"></div><div class="line">predictions = predict(parameters, X_assess)</div><div class="line">print(&quot;predictions mean = &quot; + str(np.mean(predictions)))</div></pre></td></tr></table></figure></p>
<pre><code>predictions mean = 0.666666666667
</code></pre><p>â€‹    </p>
<h1 id="åº”ç”¨æ¨¡å‹">7. åº”ç”¨æ¨¡å‹</h1><p>å°†ä¸Šé¢è¿™ä¸ªæ¨¡å‹ç”¨åœ¨æ•°æ®é›†ä¸Šï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Build a model with a n_h-dimensional hidden layer</span></div><div class="line">parameters = nn_model(X, Y, n_h = <span class="number">4</span>, num_iterations = <span class="number">10000</span>, print_cost=<span class="keyword">True</span>)</div><div class="line"></div><div class="line"><span class="comment"># Plot the decision boundary</span></div><div class="line">plot_decision_boundary(<span class="keyword">lambda</span> x: predict(parameters, x.T), X, Y)</div><div class="line">plt.title(<span class="string">"Decision Boundary for hidden layer size "</span> + str(<span class="number">4</span>))</div><div class="line"></div><div class="line"><span class="comment"># Print accuracy</span></div><div class="line">predictions = predict(parameters, X)</div><div class="line"><span class="keyword">print</span> (<span class="string">'Accuracy: %d'</span> % float((np.dot(Y,predictions.T) + np.dot(<span class="number">1</span>-Y,<span class="number">1</span>-predictions.T))/float(Y.size)*<span class="number">100</span>) + <span class="string">'%'</span>)</div></pre></td></tr></table></figure>
<pre><code>Cost after iteration 0: 1.127380
Cost after iteration 1000: 0.288553
Cost after iteration 2000: 0.276386
Cost after iteration 3000: 0.268077
Cost after iteration 4000: 0.263069
Cost after iteration 5000: 0.259617
Cost after iteration 6000: 0.257070
Cost after iteration 7000: 0.255105
Cost after iteration 8000: 0.253534
Cost after iteration 9000: 0.252245
Accuracy: 91%
</code></pre><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-05-21-57-06.png" alt=""> </p>
<h1 id="è§‚æµ‹ä¸åŒçš„éšè—å±‚æ•°å¯¹äºæ¨¡å‹çš„å½±å“">8. è§‚æµ‹ä¸åŒçš„éšè—å±‚æ•°å¯¹äºæ¨¡å‹çš„å½±å“</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># This may take about 2 minutes to run</span></div><div class="line"></div><div class="line">plt.figure(figsize=(<span class="number">16</span>, <span class="number">32</span>))</div><div class="line">hidden_layer_sizes = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">20</span>, <span class="number">50</span>]</div><div class="line"><span class="keyword">for</span> i, n_h <span class="keyword">in</span> enumerate(hidden_layer_sizes):</div><div class="line">    plt.subplot(<span class="number">5</span>, <span class="number">2</span>, i+<span class="number">1</span>)</div><div class="line">    plt.title(<span class="string">'Hidden Layer of size %d'</span> % n_h)</div><div class="line">    parameters = nn_model(X, Y, n_h, num_iterations = <span class="number">5000</span>)</div><div class="line">    plot_decision_boundary(<span class="keyword">lambda</span> x: predict(parameters, x.T), X, Y)</div><div class="line">    predictions = predict(parameters, X)</div><div class="line">    accuracy = float((np.dot(Y,predictions.T) + np.dot(<span class="number">1</span>-Y,<span class="number">1</span>-predictions.T))/float(Y.size)*<span class="number">100</span>)</div><div class="line">    <span class="keyword">print</span> (<span class="string">"Accuracy for &#123;&#125; hidden units: &#123;&#125; %"</span>.format(n_h, accuracy))</div></pre></td></tr></table></figure>
<pre><code>Accuracy for 1 hidden units: 61.5 %
Accuracy for 2 hidden units: 70.5 %
Accuracy for 3 hidden units: 66.25 %
Accuracy for 4 hidden units: 90.75 %
Accuracy for 5 hidden units: 90.5 %
Accuracy for 20 hidden units: 92.0 %
Accuracy for 50 hidden units: 90.75 %
</code></pre><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-05-21-57-24.png" alt=""> </p>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> ç¥ç»ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-é“¾è¡¨]]></title>
      <url>/2017/12/04/%E7%AE%97%E6%B3%95-%E9%93%BE%E8%A1%A8/</url>
      <content type="html"><![CDATA[<h1 id="é“¾è¡¨">1. é“¾è¡¨</h1><p><strong>é“¾è¡¨è€ƒç‚¹</strong></p>
<ul>
<li>ä¼šä¸ä¼šå†™ç¨‹åº - ç±»ã€æŒ‡é’ˆã€å¼•ç”¨ç­‰</li>
</ul>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<ul>
<li>é“¾è¡¨ä¸­çš„Dummy Node</li>
<li>åŸºæœ¬é“¾è¡¨æŠ€èƒ½</li>
<li>é“¾è¡¨çš„Two Pointers(Fast-slow pointers)</li>
</ul>
<p><strong>å…¥é—¨é¢˜</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">  <span class="keyword">for</span>(ListNode node = head; node != <span class="keyword">null</span>; node = node.next)&#123;</div><div class="line">    System.out.print(node.val);</div><div class="line">    System.out.print(<span class="string">"-&gt;"</span>);</div><div class="line">  &#125;</div><div class="line">  System.out.println(<span class="string">"null"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">  ListNode node1 = <span class="keyword">new</span> ListNode(<span class="number">1</span>);</div><div class="line">  ListNode node2 = <span class="keyword">new</span> ListNode(<span class="number">2</span>);</div><div class="line">  ListNode node3 = <span class="keyword">new</span> ListNode(<span class="number">3</span>);</div><div class="line">  </div><div class="line">  ListNode head = node1;</div><div class="line">  </div><div class="line">  node1.next = node2;</div><div class="line">  node2.next = node3;</div><div class="line">  </div><div class="line">  print(head); <span class="comment">// è¾“å‡ºå•¥ï¼Ÿ</span></div><div class="line">  </div><div class="line">  node1 = node2;</div><div class="line">  </div><div class="line">  print(head); <span class="comment">// è¾“å‡ºå•¥ï¼Ÿ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç­”æ¡ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">3</span>-&gt;<span class="keyword">null</span></div><div class="line"></div><div class="line"><span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">3</span>-&gt;<span class="keyword">null</span></div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">åˆå§‹ï¼š</div><div class="line"></div><div class="line">  n1      n2        n3</div><div class="line">[<span class="number">1</span>,-]--&gt; [<span class="number">2</span>,-]--&gt; [<span class="number">3</span>,<span class="keyword">null</span>]</div><div class="line">===================================</div><div class="line">head = n1 : </div><div class="line"></div><div class="line"> head</div><div class="line">  n1      n2        n3</div><div class="line">[<span class="number">1</span>,-]--&gt; [<span class="number">2</span>,-]--&gt; [<span class="number">3</span>,<span class="keyword">null</span>]</div><div class="line"></div><div class="line">sizeof(head) = <span class="number">4</span> </div><div class="line">===================================</div><div class="line">n1 = n2 : </div><div class="line"></div><div class="line"> head     n1</div><div class="line">          n2        n3</div><div class="line">[<span class="number">1</span>,-]--&gt; [<span class="number">2</span>,-]--&gt; [<span class="number">3</span>,<span class="keyword">null</span>]</div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="ä¾‹é¢˜">2. ä¾‹é¢˜</h1><h2 id="ä¾‹é¢˜1ï¼ŒRemove-Duplicates-from-Sorted-List">2.1. ä¾‹é¢˜1ï¼ŒRemove Duplicates from Sorted List</h2><p>å°†æœ‰åºé“¾è¡¨å»é‡</p>
<h2 id="ä¾‹é¢˜2ï¼ŒRemove-Duplicates-from-Sorted-List-II">2.2. ä¾‹é¢˜2ï¼ŒRemove Duplicates from Sorted List II</h2><p>å°†æœ‰åºé“¾è¡¨ä¸­çš„å…¨éƒ¨é‡å¤å…ƒç´ åˆ é™¤</p>
<p>æ€è·¯ï¼šä½¿ç”¨dummy node</p>
<p>å½“é“¾è¡¨ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½¿ç”¨dummy node</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">å¥—è·¯ï¼šä¼ªèŠ‚ç‚¹</div><div class="line"></div><div class="line"><span class="comment">// ä¼ªèŠ‚ç‚¹</span></div><div class="line">          head</div><div class="line"> dummy     n1       n2         n3</div><div class="line"> [,-]--&gt; [<span class="number">1</span>,-]--&gt; [<span class="number">2</span>,-]--&gt; [<span class="number">3</span>,<span class="keyword">null</span>]</div><div class="line"></div><div class="line">ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">dummy.next = head;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">return</span> dummy.next;</div></pre></td></tr></table></figure>
<p>åˆ é™¤èŠ‚ç‚¹pæ–¹å¼ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-04-20-24-02.png" alt=""> </p>
<p>å¼€å§‹å†™äº†ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">dummy.next = head;</div><div class="line"></div><div class="line"><span class="comment">// å‰ç»§èŠ‚ç‚¹å’Œå½“å‰èŠ‚ç‚¹</span></div><div class="line">ListNode prev = dummy;</div><div class="line">ListNode curt = head;</div><div class="line"></div><div class="line"><span class="keyword">while</span>(<span class="keyword">null</span> != curt)&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> != curt.next &amp;&amp; curt.val == curt.next.val)&#123;<span class="comment">// å¦‚æœé‡å¤äº†</span></div><div class="line">    <span class="keyword">int</span> val = curt.val;</div><div class="line">    <span class="keyword">while</span>(curt != <span class="keyword">null</span> &amp;&amp; curt.val == val)&#123;</div><div class="line">      curt = curt.next;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// curt == null or curt.val != val</span></div><div class="line">    prev.next = curt;</div><div class="line">  &#125;<span class="keyword">else</span>&#123; <span class="comment">// å¦‚æœä¸é‡å¤</span></div><div class="line">    prev = curt;</div><div class="line">    curt = curt.next;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> dummy.next; <span class="comment">// è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹</span></div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">deleteDuplicates</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == head)<span class="keyword">return</span> head;</div><div class="line">  ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">  dummy.next = head;</div><div class="line"></div><div class="line">  ListNode prev = dummy;</div><div class="line">  ListNode curt = head;</div><div class="line">  <span class="keyword">while</span> (<span class="keyword">null</span> != curt)&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> != curt.next &amp;&amp; curt.val == curt.next.val)&#123;</div><div class="line">      <span class="keyword">int</span> temp = curt.val;</div><div class="line">      curt = curt.next;</div><div class="line">      <span class="keyword">while</span> (<span class="keyword">null</span> != curt &amp;&amp; curt.val == temp)&#123;</div><div class="line">        curt = curt.next;</div><div class="line">      &#125;</div><div class="line">      prev.next = curt;</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">      prev = curt;</div><div class="line">      curt = curt.next;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> dummy.next;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜ï¼ŒRemove-Linked-List-Elements">2.3. ä¾‹é¢˜ï¼ŒRemove Linked List Elements</h2><p>åˆ é™¤é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">removeElements</span><span class="params">(ListNode head, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head)<span class="keyword">return</span> head;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = head;</div><div class="line"></div><div class="line">        ListNode prev = dummy;</div><div class="line">        ListNode curt = head;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != curt)&#123;</div><div class="line">            <span class="keyword">if</span>(curt.val == val)&#123;</div><div class="line">                curt = curt.next;</div><div class="line">                prev.next = curt;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                prev = curt;</div><div class="line">                curt = curt.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜3ï¼ŒReverse-Linked-List">2.4. ä¾‹é¢˜3ï¼ŒReverse Linked List</h2><p>å°†é“¾è¡¨åè½¬</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ListNode prev = <span class="keyword">null</span>;</div><div class="line">ListNode curt = head;</div><div class="line"></div><div class="line"><span class="keyword">while</span>( <span class="keyword">null</span> != curt)&#123;</div><div class="line">  ListNode temp = curt.next;</div><div class="line">  curt.next = prev;</div><div class="line">  prev = curt;</div><div class="line">  curt = temp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> prev;</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == head)&#123;<span class="keyword">return</span> head;&#125;</div><div class="line">  ListNode curt = head;</div><div class="line">  ListNode prev = <span class="keyword">null</span>;</div><div class="line">  ListNode temp;</div><div class="line">  <span class="keyword">while</span> (<span class="keyword">null</span> != curt)&#123;</div><div class="line">    temp = curt.next;</div><div class="line">    curt.next = prev;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> != temp) &#123;</div><div class="line">      prev = curt;</div><div class="line">      curt = temp;</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> curt; <span class="comment">// å¦‚æœè¿™é‡Œè¿”å›prevçš„è¯å°±ä¸ç”¨ä¸­é—´çš„åˆ¤æ–­tempæ˜¯å¦ä¸ºç©ºäº†</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜4ï¼ŒReverse-Linked-List-II">2.5. ä¾‹é¢˜4ï¼ŒReverse Linked List II</h2><p>å°†ä¸€ä¸ªé“¾è¡¨çš„måˆ°nåè½¬</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">æ‹†è§£é—®é¢˜</div><div class="line"></div><div class="line"><span class="number">1</span>. å¯»æ‰¾ç¬¬mä¸ªç‚¹</div><div class="line"><span class="number">2</span>. å°†m-nåè½¬</div><div class="line"><span class="number">3</span>. æŠŠæ•´ä¸ªé“¾è¡¨è¿æˆä¸€ä¸ªé“¾è¡¨ï¼(å¦‚ä¸‹å›¾æ‰€ç¤º)</div></pre></td></tr></table></figure>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-04-22-53-44.png" alt=""> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(m &gt;= n || head == <span class="keyword">null</span>)&#123;</div><div class="line">  <span class="keyword">return</span> head;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">dummy.next = head;</div><div class="line"></div><div class="line">ListNode prev = dummy;</div><div class="line"></div><div class="line"><span class="comment">//find m-th</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; m ; ++i)&#123;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">null</span> == head)&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">	head = head.next;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">ListNode premNode = head;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">null</span> == head)&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line">ListNode mNode = head.next;</div><div class="line"></div><div class="line"><span class="comment">// reverse m - n</span></div><div class="line">ListNode nNode = mNode, postnNode = mNode.next;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &lt; n; i++)&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == postnNode)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">  ListNode temp = postnNode.next;</div><div class="line">  postnNODE.next = nNode;</div><div class="line">  nNode = postnNode;</div><div class="line">  postnNode = temp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// connect m-1 -&gt; n, m - &gt; n+1</span></div><div class="line">mNode.next = postnNode;</div><div class="line">premNode.next = nNode;</div><div class="line"></div><div class="line"><span class="keyword">return</span> dummy.next;</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseBetween</span><span class="params">(ListNode head, <span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">  ListNode curt = head;</div><div class="line">  ListNode prev = <span class="keyword">null</span>;</div><div class="line">  <span class="comment">// find m</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; m ; ++i)&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == curt.next) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    prev = curt;</div><div class="line">    curt = curt.next;</div><div class="line">  &#125;</div><div class="line">  ListNode mNodePrev = prev;</div><div class="line">  ListNode mNode = curt;</div><div class="line">  <span class="comment">// reverse m - n</span></div><div class="line">  ListNode next = curt.next;</div><div class="line">  n = n - m + <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (<span class="keyword">null</span> != curt &amp;&amp; n &gt; <span class="number">0</span>)&#123;</div><div class="line">    next = curt.next;</div><div class="line">    curt.next = prev;</div><div class="line">    prev = curt;</div><div class="line">    curt = next;</div><div class="line">    --n;</div><div class="line">  &#125;</div><div class="line">  ListNode nNode = prev;</div><div class="line">  mNode.next = next;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == mNodePrev)&#123;</div><div class="line">    <span class="keyword">return</span> nNode;</div><div class="line">  &#125;</div><div class="line">  mNodePrev.next = nNode;</div><div class="line">  <span class="keyword">return</span> head;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜5ï¼ŒReverse-Nodes-in-k-Group">2.6. ä¾‹é¢˜5ï¼ŒReverse Nodes in k-Group</h2><p>å°†é“¾è¡¨æŒ‰ç…§kå¤§å°çš„ç»„ï¼Œåè½¬ã€‚å¦‚æœæœ€åä¸å¤Ÿkä¸ªï¼Œåˆ™ä¿æŒåŸæ ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseKGroup</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = head;</div><div class="line"></div><div class="line">        ListNode prev = dummy;</div><div class="line">        ListNode curt = head;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> c;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != curt) &#123;</div><div class="line">            c = k;</div><div class="line">            ListNode firstNodePrev = prev;</div><div class="line">            ListNode firstNode = curt;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> == curt) <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != curt &amp;&amp; c &gt; <span class="number">0</span>) &#123;</div><div class="line">                ListNode next = curt.next;</div><div class="line">                curt.next = prev;</div><div class="line">                prev = curt;</div><div class="line">                curt = next;</div><div class="line">                --c;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(c &gt; <span class="number">0</span>)&#123; <span class="comment">// æœ«å°¾ä¿æŒåŸæ ·</span></div><div class="line">                c = k - c;</div><div class="line">                <span class="keyword">while</span> (c &gt; <span class="number">0</span>)&#123;</div><div class="line">                    ListNode last = prev.next;</div><div class="line">                    prev.next = curt;</div><div class="line">                    curt = prev;</div><div class="line">                    prev = last;</div><div class="line">                    --c;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> dummy.next;</div><div class="line">            &#125;</div><div class="line">            firstNodePrev.next = prev;</div><div class="line">            firstNode.next = curt;</div><div class="line"></div><div class="line">            prev = firstNode;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜6ï¼ŒPartition-List">2.7. ä¾‹é¢˜6ï¼ŒPartition List</h2><p>è¦æ±‚æŠŠå°äºxçš„å…ƒç´ æ”¾åˆ°é“¾è¡¨å‰é¢</p>
<p>æ€è·¯ï¼šæ’ä¸¤ä¸ªé˜Ÿï¼Œå°çš„ä¸€é˜Ÿï¼Œå¤§çš„ä¸€é˜Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="keyword">null</span> == head)&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ListNode leftDummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">ListNode rightDummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">ListNode left = leftDummy, right = rightDummy; <span class="comment">// å·¦å³é˜Ÿä¼çš„å°¾å·´</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(<span class="keyword">null</span> != head)&#123;</div><div class="line">  <span class="keyword">if</span>(head.val &lt; x)&#123;</div><div class="line">    left.next = head;</div><div class="line">    left = head;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    right.next = head;</div><div class="line">    right = head;</div><div class="line">  &#125;</div><div class="line">  head = head.next;</div><div class="line">&#125;</div><div class="line"></div><div class="line">right.next = <span class="keyword">null</span>;</div><div class="line">left.next = rightDummy.next;</div><div class="line"><span class="keyword">return</span> leftDummy.next;</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">partition</span><span class="params">(ListNode head, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        ListNode leftTail = <span class="keyword">new</span> ListNode(<span class="number">0</span>),</div><div class="line">                rightTail = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line"></div><div class="line">        ListNode leftHead = leftTail, rightHead = rightTail;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != head)&#123;</div><div class="line">            <span class="keyword">if</span>(head.val &lt; x)&#123;</div><div class="line">                leftTail.next = head;</div><div class="line">                leftTail = leftTail.next;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                rightTail.next = head;</div><div class="line">                rightTail = rightTail.next;</div><div class="line">            &#125;</div><div class="line">            head = head.next;</div><div class="line">        &#125;</div><div class="line">        rightTail.next = <span class="keyword">null</span>;</div><div class="line">        <span class="comment">// åˆå¹¶</span></div><div class="line">        leftTail.next = rightHead.next;</div><div class="line">        <span class="keyword">return</span> leftHead.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="Basic-Skills-in-Linked-List">3. Basic Skills in Linked List</h1><p>å¢ã€åˆ ã€åè½¬ã€åˆå¹¶ã€ä¸­ç‚¹</p>
<h1 id="Fast-slow-Pointersé—®é¢˜">4. Fast-slow Pointersé—®é¢˜</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">é“¾è¡¨ä¸­ç‚¹çš„éªšæ“ä½œ</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">getMiddle</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">        ListNode slow = head;</div><div class="line">        ListNode fast = head.next;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">            fast = fast.next.next;</div><div class="line">            slow = slow.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> slow;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ol>
<li>é“¾è¡¨ä¸­ç‚¹</li>
<li>ç§»é™¤å€’æ•°ç¬¬Nä¸ªå…ƒç´ </li>
<li>Linked List Cycle Iï¼ŒII</li>
<li>Rotate List</li>
</ol>
<h2 id="ä¾‹é¢˜7ï¼ŒSort-List">4.1. ä¾‹é¢˜7ï¼ŒSort List</h2><p>ç”¨O(nlogn)çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦æ’åºé“¾è¡¨</p>
<p>æ€è·¯ï¼šn log nçš„æ’åº - å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åº</p>
<table>
<thead>
<tr>
<th>æ’åº</th>
<th>å¿«é€Ÿæ’åº</th>
<th>å½’å¹¶æ’åº</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ€è·¯</td>
<td>å…ˆæ•´ä½“æœ‰åºï¼Œåå±€éƒ¨ï¼ˆå·¦å³æœ‰åºï¼‰æœ‰åº</td>
<td>å…ˆå±€éƒ¨ï¼ˆå·¦å³æœ‰åºï¼‰æœ‰åºï¼Œåæ•´ä½“æœ‰åº</td>
</tr>
<tr>
<td></td>
<td>ä¸ç¨³å®šæ’åºï¼ˆåŸæ¥åœ¨å‰é¢çš„ä¸ä¸€å®šè¿˜åœ¨å‰é¢ï¼‰</td>
<td>ç¨³å®šæ’åº-åŒæ ·çš„keyä¿æŒåŸæ¥çš„é¡ºåº</td>
</tr>
<tr>
<td>æ—¶é—´</td>
<td>$O(nlogn â€” O(n^2))$</td>
<td>$O(nlogn)$</td>
</tr>
<tr>
<td>ç©ºé—´</td>
<td>O(1)</td>
<td>æ•°ç»„ä¸ŠO(n)ï¼Œé“¾è¡¨ä¸Š$O(1)$</td>
</tr>
</tbody>
</table>
<p>è¿™é“é¢˜å¯ä»¥ç”¨å¿«æ’ï¼Œä½†å…¶å®å½’å¹¶æ’åºæ›´å¥½å†™</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">å…³é”®ç‚¹ï¼šæ€ä¹ˆå–ä¸­ç‚¹ï¼Ÿ</div><div class="line"></div><div class="line">å–ä¸­ç‚¹éªšæ“ä½œï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">findMiddle</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">	ListNode slow = head, fast = head.next;</div><div class="line">	<span class="comment">// å½“fastèµ°å®Œçš„æ—¶å€™ï¼Œslowå°±æ˜¯ä¸­ç‚¹</span></div><div class="line">    <span class="keyword">while</span>(<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">    	fast = fast.next.next;</div><div class="line">    	slow = slow.next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> slow;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">åˆå¹¶ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">merge</span><span class="params">(ListNode head1, ListNode head2)</span></span>&#123;</div><div class="line">	ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">	ListNode tail = dummy;</div><div class="line">    <span class="keyword">while</span>(<span class="keyword">null</span> != head1 &amp;&amp; <span class="keyword">null</span> != head2)&#123;</div><div class="line">    	<span class="keyword">if</span>(head1.val &lt; head2.val)&#123;</div><div class="line">          tail.next = head1;</div><div class="line">          head1 = head1.next;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">          tail.next = head2;</div><div class="line">          head2 = head2.next;</div><div class="line">        &#125;</div><div class="line">        tail = tail.next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> != head1)&#123;</div><div class="line">      tail.next = head1;</div><div class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> != head2)&#123;</div><div class="line">      tail.next = head2;</div><div class="line">      &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> dummy.next;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">ä¸»å‡½æ•°</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">sortList</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> != head || <span class="keyword">null</span> != head.next)&#123;</div><div class="line">    <span class="keyword">return</span> head;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// æ‰¾ä¸­ç‚¹</span></div><div class="line">  ListNode mid = findMiddle(head);</div><div class="line"></div><div class="line">  <span class="comment">// åˆ†è§£é—®é¢˜</span></div><div class="line">  ListNode right = sortList(mid.next);</div><div class="line">  mid.next = <span class="keyword">null</span>;</div><div class="line">  ListNode left = sortList(head);</div><div class="line"></div><div class="line">  <span class="comment">// åˆå¹¶é—®é¢˜</span></div><div class="line">  <span class="keyword">return</span> merge(left,right);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">getMiddle</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">        ListNode slow = head;</div><div class="line">        ListNode fast = head.next;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">            slow = slow.next;</div><div class="line">            fast = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> slow;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">merge</span><span class="params">(ListNode right, ListNode left)</span></span>&#123;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        ListNode head = dummy;</div><div class="line">        dummy.next = head;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != right &amp;&amp; <span class="keyword">null</span> != left)&#123;</div><div class="line">            <span class="keyword">if</span>(right.val &lt; left.val)&#123;</div><div class="line">                head.next = right;</div><div class="line">                right = right.next;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                head.next = left;</div><div class="line">                left = left.next;</div><div class="line">            &#125;</div><div class="line">            head = head.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != right)&#123;</div><div class="line">            head.next = right;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> != left)&#123;</div><div class="line">            head.next = left;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">sortList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="comment">//å½’å¹¶æ’åº</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head.next) <span class="keyword">return</span> head;</div><div class="line">        <span class="comment">// è·å–ä¸­å€¼</span></div><div class="line">        ListNode mid = getMiddle(head);</div><div class="line">        <span class="comment">// åˆ†è§£é—®é¢˜</span></div><div class="line">        ListNode right = sortList(mid.next);</div><div class="line">        mid.next = <span class="keyword">null</span>;</div><div class="line">        ListNode left = sortList(head);</div><div class="line">        <span class="comment">// åˆå¹¶</span></div><div class="line">        <span class="keyword">return</span> merge(left,right);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜8ï¼ŒReorder-List">4.2. ä¾‹é¢˜8ï¼ŒReorder List</h2><p>å°†é“¾è¡¨ <em>L</em>0â†’<em>L</em>1â†’â€¦â†’<em>L</em>n-1â†’<em>L</em>n,  é‡æ’åºä¸º<em>L</em>0â†’<em>L**n</em>â†’<em>L</em>1â†’<em>L**n</em>-1â†’<em>L</em>2â†’<em>L**n</em>-2â†’â€¦</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>æ‰¾ä¸­ç‚¹</li>
<li>ä¸­ç‚¹å³åŠéƒ¨åˆ†reverse</li>
<li>åˆå¹¶</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">getMiddle</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">        ListNode slow = head;</div><div class="line">        ListNode fast = head.next;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">            fast = fast.next.next;</div><div class="line">            slow = slow.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> slow;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">reverse</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">        ListNode last = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != head)&#123;</div><div class="line">            ListNode temp = head.next;</div><div class="line">            head.next = last;</div><div class="line">            last = head;</div><div class="line">            head = temp;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> last;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reorderList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span>;</div><div class="line">        <span class="comment">// æ‰¾ä¸­ç‚¹</span></div><div class="line">        ListNode mid = getMiddle(head);</div><div class="line">        <span class="comment">// åè½¬ mid - end</span></div><div class="line">        ListNode right = reverse(mid.next);</div><div class="line">        mid.next = <span class="keyword">null</span>;</div><div class="line">        <span class="comment">// åˆå¹¶</span></div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = head;</div><div class="line">        <span class="keyword">boolean</span> fromRight = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != head &amp;&amp; <span class="keyword">null</span> != right) &#123;</div><div class="line">            ListNode temp = head.next;</div><div class="line">            head.next = right;</div><div class="line">            right = right.next;</div><div class="line">            head.next.next = temp;</div><div class="line">            head = head.next.next;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜9ï¼ŒLinked-List-Cycle">4.3. ä¾‹é¢˜9ï¼ŒLinked List Cycle</h2><p>åˆ¤æ–­é“¾è¡¨é‡Œæœ‰æ²¡æœ‰ç¯å½¢</p>
<p>æš´åŠ›æ–¹æ³•ï¼šç”¨hashè¡¨</p>
<p>éªšæ“ä½œï¼šå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆå¦‚æœç›¸é‡äº†ï¼Œå°±æœ‰ç¯</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasCycle</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        ListNode fast = head.next;</div><div class="line">        ListNode slow = head;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">            <span class="keyword">if</span>(fast == slow)&#123;<span class="keyword">return</span> <span class="keyword">true</span>;&#125;</div><div class="line">            fast = fast.next.next;</div><div class="line">            slow = slow.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜10ï¼ŒLinked-List-Cycle-II">4.4. ä¾‹é¢˜10ï¼ŒLinked List Cycle II</h2><p>å¦‚æœæœ‰ç¯ï¼Œæ‰¾åˆ°ç¯çš„å…¥å£</p>
<p>éªšæ“ä½œï¼šå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆå¦‚æœç›¸é‡äº†ï¼Œå°±æœ‰ç¯ã€‚ç›¸é‡ä¹‹åï¼Œå†è®©headå’Œslowåˆ†åˆ«å¼€å§‹ï¼Œæ¯æ¬¡èµ°ä¸€æ­¥ã€‚ç›¸é‡åä¸€å®šæ˜¯ç¯å…¥å£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">detectCycle</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        ListNode fast = head.next;</div><div class="line">        ListNode slow = head;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">            <span class="keyword">if</span>(fast == slow)&#123;</div><div class="line">                slow = slow.next;</div><div class="line">                <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</div><div class="line">                    <span class="keyword">if</span>(slow == head)</div><div class="line">                        <span class="keyword">return</span> slow;</div><div class="line">                    slow = slow.next;</div><div class="line">                    head = head.next;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            fast = fast.next.next;</div><div class="line">            slow = slow.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜11ï¼ŒRotate-List">4.5. ä¾‹é¢˜11ï¼ŒRotate List</h2><ol>
<li>å¾ªç¯ç§»åŠ¨</li>
<li>æ‰¾åˆ°å€’æ•°ç¬¬kä¸ª</li>
<li>æ–­å¼€è¿ä¸Šå°±å¥½</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">rotateRight</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> head;</div><div class="line">    <span class="keyword">int</span> n = getLength(head);</div><div class="line">    <span class="comment">// å¯»æ‰¾å€’æ•°ç¬¬kä¸ª</span></div><div class="line">    k = k % n;</div><div class="line">    <span class="keyword">if</span>(k == <span class="number">0</span>) <span class="keyword">return</span> head;</div><div class="line">    ListNode fast = head;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; k ; ++i)&#123;</div><div class="line">        fast = fast.next;</div><div class="line">    &#125;</div><div class="line">    ListNode slow = head;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">        slow = slow.next;</div><div class="line">        fast = fast.next;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æ³¨æ„è¿™é‡Œçš„æŠ€å·§ï¼Œæ­¤æ—¶fast = tail</span></div><div class="line">    ListNode right = slow.next;</div><div class="line">    slow.next = <span class="keyword">null</span>;</div><div class="line">    fast.next = head;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> right;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜12ï¼ŒMerge-k-Sorted-Lists">4.6. ä¾‹é¢˜12ï¼ŒMerge k Sorted Lists</h2><p>ä¸‰ç§æ–¹æ³•ï¼š</p>
<ol>
<li><p>å †ï¼Œç»´æŠ¤å½“å‰æ¯ä¸ªlistçš„headã€‚å¤æ‚åº¦$Nlogk$</p>
</li>
<li><p>åˆ†æ²»æ³•ã€‚å¤æ‚åº¦$Nlogk$â€“æ¯ä¸ªæ•°éƒ½ç»è¿‡$logk$ æ¬¡åˆå¹¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">         *</div><div class="line">        / \</div><div class="line">      /     *</div><div class="line">    /      / \</div><div class="line">  *       /   *</div><div class="line"> / \     /   / \ </div><div class="line"><span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span></div><div class="line"></div><div class="line">å°†ä¸¤ä¸ª k/<span class="number">2</span> çš„é“¾è¡¨ç»„ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªé“¾è¡¨ </div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(ListNode[] lists)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(lists.length == <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> mergeHelper(lists, <span class="number">0</span>, lists.length - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">mergeHelper</span><span class="params">(ListNode[] lists, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(end == start) <span class="keyword">return</span> lists[start];</div><div class="line">        <span class="keyword">int</span> mid = start + (end - start) / <span class="number">2</span>;</div><div class="line">        ListNode left = mergeHelper(lists, start, mid);</div><div class="line">        ListNode right = mergeHelper(lists,mid + <span class="number">1</span>, end);</div><div class="line">        <span class="keyword">return</span> mergeTwoLists(left,right);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">mergeTwoLists</span><span class="params">(ListNode list1, ListNode list2)</span></span>&#123;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        ListNode tail = dummy;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != list1 &amp;&amp; <span class="keyword">null</span> != list2)&#123;</div><div class="line">            <span class="keyword">if</span>(list1.val &lt; list2.val)&#123;</div><div class="line">                tail.next = list1;</div><div class="line">                list1 = list1.next;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                tail.next = list2;</div><div class="line">                list2 = list2.next;</div><div class="line">            &#125;</div><div class="line">            tail = tail.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != list1)&#123;</div><div class="line">            tail.next = list1;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> != list2)&#123;</div><div class="line">            tail.next = list2;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä¸¤ä¸¤åˆå¹¶ï¼Œå¤æ‚åº¦$Nlogk$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">         <span class="number">9</span></div><div class="line">       /  \</div><div class="line">      <span class="number">8</span>    \</div><div class="line">    /   \   \</div><div class="line">  <span class="number">6</span>       <span class="number">7</span>  \</div><div class="line"> / \     / \   \ </div><div class="line"><span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span></div><div class="line">           </div><div class="line">           </div><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(List&lt;ListNode&gt; lists)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(lists.size() == <span class="number">0</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">while</span>(lists.size() &gt; <span class="number">1</span>)&#123;</div><div class="line">    List&lt;ListNode&gt; new_lists = <span class="keyword">new</span> ArrayList&lt;ListNode&gt;();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + <span class="number">1</span> &lt; lists.size(); i += <span class="number">2</span>) &#123;</div><div class="line">                ListNode merged_list = merge(lists.get(i), lists.get(i+<span class="number">1</span>));</div><div class="line">                new_lists.add(merged_list);</div><div class="line">     &#125;</div><div class="line">    <span class="keyword">if</span> (lists.size() % <span class="number">2</span> == <span class="number">1</span>) &#123;</div><div class="line">      new_lists.add(lists.get(lists.size() - <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">    lists = new_lists;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> lists.get(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">merge</span><span class="params">(ListNode list1, ListNode list2)</span></span>&#123;</div><div class="line">  ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">  ListNode tail = dummy;</div><div class="line">  <span class="keyword">while</span>(list1 != <span class="keyword">null</span> &amp;&amp; list2 != <span class="keyword">null</span>)&#123;</div><div class="line">    <span class="keyword">if</span>(list1.val &lt; list2.val)&#123;</div><div class="line">      tail.next = list1;</div><div class="line">      tail = list1;</div><div class="line">      list1 = list1.next;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      tail.next = list2;</div><div class="line">      tail = list2;</div><div class="line">      list2 = list2.next;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (list1 != <span class="keyword">null</span>) &#123;</div><div class="line">            tail.next = list1;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    tail.next = list2;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> dummy.next;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜13ï¼ŒCopy-List-with-Random-Pointer">4.7. ä¾‹é¢˜13ï¼ŒCopy List with Random Pointer</h2><p>â€‹</p>
<p><code>1 -&gt; 2 -&gt; 3 -&gt; 4...</code></p>
<p>ç„¶åæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªrandomæŒ‡é’ˆï¼ŒéšæœºæŒ‡</p>
<p>è¦æ±‚å°†è¿™ä¸ªrandom list æ·±æ‹·è´ä¸€æ¬¡</p>
<p>æ–¹æ³•ä¸€ï¼Œä¾æ¬¡æ‹·è´node.next,ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨å­˜å‚¨æ¯ä¸ª[oldNode,newNode]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>æ–¹æ³•äºŒï¼Œéªšæ“ä½œï¼Œä¼˜åŒ–ï¼Œç”¨O(1)çš„ç©ºé—´å¤æ‚åº¦</p>
<p>åˆšæ‰æˆ‘ä»¬å­˜å‚¨çš„æ˜¯æ˜ å°„å…³ç³»ï¼Œè€èŠ‚ç‚¹-&gt;æ–°èŠ‚ç‚¹ï¼Œç”¨å·§å¦™çš„æ–¹å¼å­˜å‚¨è¿™ä¸ªå…³ç³»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> -&gt; <span class="number">2</span> -&gt; <span class="number">3</span> -&gt; <span class="number">4</span> -&gt; <span class="keyword">null</span></div><div class="line"></div><div class="line">å˜æˆ</div><div class="line">  </div><div class="line"><span class="number">1</span> -&gt; <span class="number">1</span>` -&gt; <span class="number">2</span> -&gt; <span class="number">2</span>` -&gt; <span class="number">3</span> -&gt; <span class="number">3</span>` -&gt; <span class="number">4</span> -&gt; <span class="number">4</span>` -&gt; <span class="keyword">null</span></div><div class="line">  </div><div class="line">a.next.next --&gt;ä¿ç•™äº†åŸæ¥é“¾è¡¨çš„å…³ç³»</div><div class="line">a.next      --&gt;æ–°çš„é“¾è¡¨</div><div class="line"></div><div class="line">é‚£ä¹ˆå¦‚æœé“¾è¡¨ä¸­æœ‰randomæŒ‡é’ˆï¼Œå¦‚ä¸‹</div><div class="line"></div><div class="line">__            __________</div><div class="line">â†‘â†“           â†‘          â†“</div><div class="line"><span class="number">1</span>  -&gt;  <span class="number">1</span>` -&gt; <span class="number">2</span> -&gt; <span class="number">2</span>` -&gt; <span class="number">3</span> -&gt; <span class="number">3</span>` -&gt; <span class="number">4</span> -&gt; <span class="number">4</span>` -&gt; <span class="keyword">null</span></div><div class="line">  </div><div class="line">é‚£ä¹ˆå¤åˆ¶è¿™ä¸ªrandomå…³ç³»å³å¯ï¼ï¼</div><div class="line"></div><div class="line">ç„¶åå†æŠŠè¿™ä¸ªé“¾è¡¨æ‹†å¼€å³å¯ï¼</div><div class="line"></div><div class="line">æ€»ç»“ï¼š</div><div class="line"><span class="number">1</span>. copy next</div><div class="line"><span class="number">2</span>. copy random</div><div class="line"><span class="number">3</span>. split</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> RandomListNode <span class="title">copyRandomList</span><span class="params">(RandomListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="comment">// copy next</span></div><div class="line">        RandomListNode curr = head;</div><div class="line"></div><div class="line">        <span class="keyword">while</span>(<span class="keyword">null</span> != curr)&#123;</div><div class="line">            RandomListNode copy = <span class="keyword">new</span> RandomListNode(curr.label);</div><div class="line">            copy.next = curr.next;</div><div class="line">            curr.next = copy;</div><div class="line">            curr = curr.next.next;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// copy random</span></div><div class="line">        curr = head;</div><div class="line">        <span class="keyword">while</span>(<span class="keyword">null</span> != curr)&#123;</div><div class="line">            <span class="keyword">if</span>(curr.random != <span class="keyword">null</span>)&#123;</div><div class="line">                curr.next.random = curr.random.next;</div><div class="line">            &#125;</div><div class="line">            curr = curr.next.next;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// split</span></div><div class="line">        RandomListNode dummy = head.next;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != head)&#123;</div><div class="line">            RandomListNode temp = head.next;</div><div class="line">            head.next = temp.next;</div><div class="line">            head = head.next;</div><div class="line">            <span class="keyword">if</span> (temp.next != <span class="keyword">null</span>) &#123;</div><div class="line">                temp.next = temp.next.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Swap-Nodes-in-Pairs">4.8. Swap Nodes in Pairs</h2><p>å°†é“¾è¡¨ä¸¤ä¸¤åè½¬</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(ListNode obj,ListNode prev)</span></span>&#123;</div><div class="line">        prev.next = obj.next;</div><div class="line">        obj.next = prev.next.next;</div><div class="line">        prev.next.next = obj;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">swapPairs</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> head;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode prev = dummy;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != head &amp;&amp; <span class="keyword">null</span> != head.next)&#123;</div><div class="line">            swap(head,prev);</div><div class="line">            head = head.next;</div><div class="line">            prev = prev.next.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Delete-Node-in-a-Linked-List">4.9. Delete Node in a Linked List</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">(ListNode node)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(node != <span class="keyword">null</span> &amp;&amp; node.next != <span class="keyword">null</span>) &#123;</div><div class="line">            node.val = node.next.val;</div><div class="line">            node.next = node.next.next;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Palindrome-Linked-List">4.10. Palindrome Linked List</h2><p>åˆ¤æ–­ä¸€ä¸ªlistæ˜¯ä¸æ˜¯å›æ–‡ä¸²</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">getMiddle</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">    ListNode fast = head.next;</div><div class="line">    ListNode slow = head;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != fast &amp;&amp; <span class="keyword">null</span> != fast.next)&#123;</div><div class="line">        fast = fast.next.next;</div><div class="line">        slow = slow.next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> slow;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">reverse</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">    ListNode last = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != head)&#123;</div><div class="line">        ListNode temp = head.next;</div><div class="line">        head.next = last;</div><div class="line">        last = head;</div><div class="line">        head = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> last;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="comment">// æ‰¾ä¸­ç‚¹</span></div><div class="line">    ListNode middle = getMiddle(head);</div><div class="line">    ListNode right = middle.next;</div><div class="line">    middle.next = <span class="keyword">null</span>;</div><div class="line">    <span class="comment">// å°†rightåè½¬</span></div><div class="line">    right = reverse(right);</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != right &amp;&amp; <span class="keyword">null</span> != head &amp;&amp; right.val == head.val)&#123;</div><div class="line">        right = right.next;</div><div class="line">        head = head.next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>((<span class="keyword">null</span> == head &amp;&amp; <span class="keyword">null</span> == right)||</div><div class="line">            (<span class="keyword">null</span> == head.next &amp;&amp; <span class="keyword">null</span> == right)||</div><div class="line">            (<span class="keyword">null</span> == right.next &amp;&amp; <span class="keyword">null</span> == head))&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Odd-Even-Linked-List">4.11. Odd Even Linked List</h2><p>å°†é“¾è¡¨çš„å¥‡æ•°ä½æ”¾å‰é¢ï¼Œå¶æ•°ä½æ”¾åé¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">oddEvenList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> head;</div><div class="line">    ListNode oddDummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">    ListNode evenDummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">    oddDummy.next = head;</div><div class="line">    evenDummy.next = head.next;</div><div class="line">    ListNode odd = head;</div><div class="line">    ListNode even = head.next;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != even &amp;&amp; <span class="keyword">null</span> != even.next)&#123;</div><div class="line">        odd.next = even.next;</div><div class="line">        even.next = odd.next.next;</div><div class="line">        odd = odd.next;</div><div class="line">        even = even.next;</div><div class="line">    &#125;</div><div class="line">    odd.next = evenDummy.next;</div><div class="line">    <span class="keyword">return</span> oddDummy.next;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Split-Linked-List-in-Parts">4.12. Split Linked List in Parts</h2><p>å¾ˆæ— èŠçš„é¢˜ã€‚</p>
<p>å°†ä¸€ä¸ªé“¾è¡¨åˆ†ä¸ºkä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†çš„é•¿åº¦å·®ä¸å¾—è¶…è¿‡1ï¼Œä¸”å‰é¢çš„é•¿åº¦ä¸å¾—å°äºåé¢çš„é•¿åº¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLength</span><span class="params">(ListNode root)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> length = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">        root = root.next;</div><div class="line">        ++length;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> length;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> ListNode[] splitListToParts(ListNode root, <span class="keyword">int</span> k) &#123;</div><div class="line">    <span class="keyword">int</span> length = getLength(root);</div><div class="line">    <span class="keyword">int</span> n = length/k;</div><div class="line">    <span class="keyword">int</span> m = length % k;</div><div class="line">    ListNode[] results = <span class="keyword">new</span> ListNode[k];</div><div class="line">    <span class="keyword">int</span> pos = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">        <span class="keyword">int</span> i = m &gt; <span class="number">0</span> ? n : n - <span class="number">1</span>;</div><div class="line">        m-=<span class="number">1</span>;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = root;</div><div class="line">        <span class="keyword">while</span> (i &gt; <span class="number">0</span>)&#123;</div><div class="line">            root = root.next;</div><div class="line">            --i;</div><div class="line">        &#125;</div><div class="line">        ListNode temp = root.next;</div><div class="line">        root.next = <span class="keyword">null</span>;</div><div class="line">        root = temp;</div><div class="line">        results[pos] = dummy.next;</div><div class="line">        ++pos;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (pos &lt; k)&#123;</div><div class="line">        results[pos] = <span class="keyword">null</span>;</div><div class="line">        ++pos;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Insertion-Sort-List">4.13. Insertion Sort List</h2><p>å®ç°é“¾è¡¨çš„æ’å…¥æ’åº </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">insertionSortList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == head || <span class="keyword">null</span> == head.next) <span class="keyword">return</span> head;</div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode curt = head;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != curt &amp;&amp; <span class="keyword">null</span> != curt.next)&#123;</div><div class="line">            <span class="keyword">if</span>(curt.next.val &gt;= curt.val)&#123;</div><div class="line">                curt = curt.next;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// å°†curt.nextæ’å…¥åˆ°å‰é¢</span></div><div class="line">                ListNode prev = dummy.next;</div><div class="line">                ListNode insert = curt.next;</div><div class="line">                <span class="keyword">if</span>(dummy.next.val &gt;= insert.val)</div><div class="line">                    prev = dummy;</div><div class="line">                <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">while</span> (prev.next.val &lt; insert.val) &#123;</div><div class="line">                        prev = prev.next;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// å°†curt.nextæ’åˆ°prevåé¢</span></div><div class="line">                curt.next = curt.next.next;</div><div class="line">                ListNode prevNext = prev.next;</div><div class="line">                prev.next = insert;</div><div class="line">                insert.next = prevNext;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="æ€»ç»“">5. æ€»ç»“</h1><ul>
<li>å‡¡æ˜¯é“¾è¡¨ç»“æ„å‘ç”Ÿå˜åŒ–çš„ï¼Œéƒ½éœ€è¦Dummy Node</li>
<li>é“¾è¡¨å¸¸ç”¨åŸºæœ¬åŠŸï¼š<ul>
<li>åè½¬ reverse</li>
<li>å½’å¹¶ merge</li>
<li>æ‰¾ä¸­ç‚¹ median</li>
<li>å¢åˆ æŸ¥æ”¹</li>
</ul>
</li>
<li>Linked List Cycle , çŸ¥é“æ€ä¹ˆåšï¼Œç†è§£</li>
<li>Linked List Cycle IIï¼ŒçŸ¥é“æ€ä¹ˆåšï¼Œè¯¾ååˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆï¼ŒèƒŒä¸‹ç¨‹åº</li>
<li>Copy List with Random Pointers<ul>
<li>èƒ½å†™å‡ºhash mapæ–¹æ³•</li>
<li>ä¼˜åŒ–æ–¹æ³•è¦èƒ½æ­£ç¡®å®ç°</li>
</ul>
</li>
<li>Merge k Sorted Arrays<ul>
<li>kè·¯å½’å¹¶ä¸€å®šè¦æŒæ¡</li>
<li>ä¸‰ç§æ–¹å¼åˆ†åˆ«å®ç°ï¼Œå¹¶ç†Ÿç»ƒç†è§£å’ŒæŒæ¡</li>
<li>é¡ºä¾¿åšä¸€ä¸‹merge k sorted arrays</li>
</ul>
</li>
</ul>
<h1 id="å…¶ä»–é¢˜">6. å…¶ä»–é¢˜</h1><h2 id="Intersection-of-Two-Linked-Lists">6.1. Intersection of Two Linked Lists</h2><p>å¯»æ‰¾ä¸¤ä¸ªé“¾è¡¨çš„äº¤å‰ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿”å›èŠ‚ç‚¹c1ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›Null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">A:          a1 â†’ a2</div><div class="line">                   â†˜</div><div class="line">                     c1 â†’ c2 â†’ c3</div><div class="line">                   â†—            </div><div class="line">B:     b1 â†’ b2 â†’ b3</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLen</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> length = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (head != <span class="keyword">null</span>)&#123;</div><div class="line">            ++length;</div><div class="line">            head = head.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> length;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> remainA = getLen(headA);</div><div class="line">        <span class="keyword">int</span> remainB = getLen(headB);</div><div class="line">        <span class="keyword">while</span> (remainA &gt; remainB)&#123;</div><div class="line">            headA = headA.next;</div><div class="line">            --remainA;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (remainA &lt; remainB)&#123;</div><div class="line">            headB = headB.next;</div><div class="line">            --remainB;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æ­¤æ—¶remainA == remainB</span></div><div class="line">        <span class="keyword">while</span> (headA != <span class="keyword">null</span> &amp;&amp; headB != <span class="keyword">null</span> &amp;&amp; headA != headB)&#123;</div><div class="line">            headA = headA.next;</div><div class="line">            headB = headB.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(headA == headB) <span class="keyword">return</span> headA;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»]]></title>
      <url>/2017/11/28/%E7%AE%97%E6%B3%95-%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%8E%E5%88%86%E6%B2%BB/</url>
      <content type="html"><![CDATA[<p> ä¸€äº›é¢˜ç›® implement of â€¦.</p>
<h1 id="æ—¶é—´å¤æ‚åº¦è®­ç»ƒ">1. æ—¶é—´å¤æ‚åº¦è®­ç»ƒ</h1><p>å¤ä¹ ï¼š</p>
<p>$$T(n) = T(\frac{n}{2}) + O(1) â†’ O(logn)$$</p>
<p>$$T(n) = T(\frac{n}{2}) + O(n) â†’ O(n)$$</p>
<p><strong> é—®é¢˜1</strong></p>
<p>é€šè¿‡O(1)çš„æ—¶é—´,æŠŠnçš„é—®é¢˜,å˜ä¸ºäº†ä¸¤ä¸ªn/2çš„é—®é¢˜,å¤æ‚åº¦æ˜¯å¤šå°‘?</p>
<p>$$T(n) = 2T(\frac{n}{2}) + O(1) â†’ O(n)$$</p>
<p>è§£å†³ï¼šæ ‘å‹åˆ†ææ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">           n</div><div class="line">       /      \      --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(<span class="number">1</span>)çš„æ—¶é—´</div><div class="line">     n/<span class="number">2</span>       n/<span class="number">2</span></div><div class="line">    / \        / \   --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(<span class="number">2</span>)çš„æ—¶é—´</div><div class="line">n/<span class="number">4</span>   n/<span class="number">4</span>   n/<span class="number">4</span>   n/<span class="number">4</span></div><div class="line">.....................</div><div class="line">         ç¬¬k+<span class="number">1</span>å±‚       --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(<span class="number">2</span>^k)çš„æ—¶é—´</div><div class="line">.....................  --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(n/<span class="number">2</span>)çš„æ—¶é—´</div></pre></td></tr></table></figure>
<p>æ€»å¤æ‚åº¦ï¼š</p>
<p>$$O(1+2+4+â€¦.+2^k+â€¦+\frac{n}{2})\tag{1}$$</p>
<p>è®¾$2^m = \frac{n}{2}$ï¼Œåˆ™$m=log(\frac{n}{2})=logn-log2=logn$</p>
<p>åˆ™å…¬å¼ï¼ˆ1ï¼‰ç­‰äºï¼š</p>
<p>$$O(2^0+2^1+2^2+â€¦.+2^{logn})$$</p>
<p>$$=O(\frac{a_1(1-q^n)}{1-q})=O(\frac{1-2^{logn}}{2-1})=O(n)\tag{ç»“æœ}$$</p>
<a id="more"></a>
<p><strong>é—®é¢˜2</strong></p>
<p>$$T(n) = 2T(\frac{n}{2}) + O(n) =?$$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">           n</div><div class="line">       /      \      --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(n)çš„æ—¶é—´</div><div class="line">     n/<span class="number">2</span>       n/<span class="number">2</span></div><div class="line">    / \        / \   --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(n)çš„æ—¶é—´</div><div class="line">n/<span class="number">4</span>   n/<span class="number">4</span>   n/<span class="number">4</span>   n/<span class="number">4</span></div><div class="line">.....................</div><div class="line">         ç¬¬k+<span class="number">1</span>å±‚       --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(n)çš„æ—¶é—´</div><div class="line">.....................  --&gt;  æœ¬æ¬¡æ‹†åˆ†è€—è´¹äº†O(n)çš„æ—¶é—´</div></pre></td></tr></table></figure>
<p>æ€»å¤æ‚åº¦ï¼š</p>
<p>$$O(n+n+â€¦+n)â€”-lognæ¬¡ = O(nlog(n))\tag{ç»“æœ}$$</p>
<p>æ ·ä¾‹é—®é¢˜ï¼šmergeSortï¼Œå°±æ˜¯è¿™ä¸ªå¤æ‚åº¦ï¼</p>
<h1 id="äºŒå‰æ ‘çš„éå†">2. äºŒå‰æ ‘çš„éå†</h1><ul>
<li><strong>å‰åºéå†</strong> - å…ˆroot</li>
<li><strong>ä¸­åºéå†</strong>-ä¸­é—´æ˜¯root</li>
<li><strong>åç»­éå†</strong>-æœ€åroot</li>
</ul>
<p>äºŒå‰æ ‘çš„ä¸‰ç§éå†ï¼Œå‡ç”±æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¸”è·¯çº¿æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡èŠ‚ç‚¹è®¿é—®çš„é¡ºåºä¸ä¸€æ · .è¿™æ¡è·¯çº¿ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç€å·¦å­æ ‘æ·±å…¥ä¸‹å»ï¼Œå½“æ·±å…¥åˆ°æœ€å·¦ç«¯ï¼Œæ— æ³•å†æ·±å…¥ä¸‹å»è¿”å› </p>
<p>åˆšæ‰æ·±å…¥æ—¶é‡åˆ°çš„èŠ‚ç‚¹ï¼Œå†é€ä¸€è¿›å…¥å…¶å³å­æ ‘ï¼Œè¿›è¡Œå¦‚æ­¤çš„æ·±å…¥å’Œè¿”å›ï¼Œç›´åˆ°æœ€åä»æ ¹ çš„å³å­æ ‘çš„è¿”å›æ ¹èŠ‚ç‚¹ä¸ºæ­¢ </p>
<p>åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œè¿”å›èŠ‚ç‚¹çš„é¡ºåºå’Œè¿›å…¥èŠ‚ç‚¹çš„é¡ºåºç›¸åï¼Œå› æ­¤å³å…ˆè¿›å…¥åè¿”å›ï¼Œè¿™ä¸€ç‰¹ æ€§æ­£å¥½ç¬¦åˆæ ˆåè¿›å…ˆå‡ºçš„ç‰¹ç‚¹ï¼Œå› æ­¤ä¸‰ç§éå†çš„éé€’å½’å®ç°å¯ä»¥å€ŸåŠ©æ ˆæ¥å®ç°ï¼š åœ¨æ²¿ç€å·¦å­æ ‘æ·±å…¥æ—¶ï¼Œè¿›å…¥ä¸€ä¸ªèŠ‚ç‚¹å°±å°†å…¶å‹æ ˆã€‚</p>
<p>è‹¥æ˜¯å…ˆåºéå†ï¼Œåˆ™åœ¨è¿›æ ˆä¹‹å‰è®¿é—®ä¹‹ï¼Œ å½“æ²¿å·¦åˆ†æ”¯æ·±å…¥ä¸ä¸‹å»æ—¶ï¼Œåˆ™è¿”å›ï¼Œå³ä»æ ˆä¸­å¼¹å‡ºå‰é¢å‹å…¥çš„èŠ‚ç‚¹ã€‚</p>
<p>è‹¥ä¸ºä¸­åºéå†ï¼Œåˆ™ æ­¤æ—¶è®¿é—®è¯¥èŠ‚ç‚¹ï¼Œç„¶åä»è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ç»§ç»­æ·±å…¥ï¼›è‹¥ä¸ºååºéå†ï¼Œåˆ™å°†æ­¤èŠ‚ç‚¹äºŒæ¬¡å…¥ æ ˆï¼Œç„¶åä»è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ç»§ç»­æ·±å…¥ï¼Œä¸å‰é¢ç±»ä¼¼ï¼Œä»ä¸ºè¿›å…¥ä¸€ä¸ªèŠ‚ç‚¹å…¥æ ˆä¸€ä¸ªèŠ‚ç‚¹ï¼Œ æ·±å…¥ä¸ä¸‹å»æ—¶è¿”å›ï¼Œç›´åˆ°ç¬¬äºŒæ¬¡ä»æ ˆé‡Œå¼¹å‡ºè¯¥èŠ‚ç‚¹ï¼Œæ‰è®¿é—®ä¹‹ </p>
<h1 id="éé€’å½’å®ç°">3. éé€’å½’å®ç°</h1><h2 id="æ•´ä½“æ€è·¯">3.1. æ•´ä½“æ€è·¯</h2><p>å› ä¸ºè¦åœ¨éå†å®ŒèŠ‚ç‚¹çš„å·¦å­æ ‘åæ¥ç€éå†èŠ‚ç‚¹çš„å³å­æ ‘ï¼Œä¸ºäº†èƒ½æ‰¾åˆ°è¯¥èŠ‚ç‚¹ï¼Œéœ€è¦ä½¿ç”¨<strong>æ ˆ</strong>æ¥è¿›è¡Œæš‚å­˜ã€‚ä¸­åºå’Œååºä¹Ÿéƒ½æ¶‰åŠåˆ°å›æº¯ï¼Œæ‰€ä»¥éƒ½éœ€è¦ç”¨åˆ°<strong>æ ˆ</strong>ã€‚</p>
<p>ä¸‰é“é¢˜çš„è§£å†³æ€è·¯å¯ç»Ÿä¸€ï¼Œæ¨¡æ¿ä¹Ÿæå…¶ç›¸ä¼¼ï¼š</p>
<ol>
<li>å°†äºŒå‰æ ‘åˆ†ä¸ºâ€œå·¦â€ï¼ˆåŒ…æ‹¬ä¸€è·¯å‘å·¦ï¼Œç»è¿‡çš„æ‰€æœ‰å®é™…å·¦+æ ¹ï¼‰ã€â€œå³â€ï¼ˆåŒ…æ‹¬å®é™…çš„å³ï¼‰ä¸¤ç§èŠ‚ç‚¹</li>
<li>ä½¿ç”¨åŒæ ·çš„é¡ºåºå°†â€œå·¦â€èŠ‚ç‚¹å…¥æ ˆ</li>
<li>ä»ä¸‹åˆ°ä¸Šï¼Œä»¥æ­¤è®¿é—®å…¶çš„å³å­æ ‘ï¼ŒåŒæ—¶æŠŠå³å­æ ‘çœ‹æˆä¸€é¢—å®Œæ•´çš„æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</li>
</ol>
<p>æ¯”å¦‚{1,2,3}ï¼Œå½“curä½äºèŠ‚ç‚¹1æ—¶ï¼Œ1ã€2å±äºâ€œå·¦â€èŠ‚ç‚¹ï¼Œ3å±äºâ€œå³â€èŠ‚ç‚¹ã€‚DFSçš„éé€’å½’å®ç°æœ¬è´¨ä¸Šæ˜¯åœ¨åè°ƒå…¥æ ˆã€å‡ºæ ˆå’Œè®¿é—®ï¼Œä¸‰ç§æ“ä½œçš„é¡ºåºã€‚ä¸Šè¿°ç»Ÿä¸€ä½¿å¾—æˆ‘ä»¬ä¸å†éœ€è¦å…³æ³¨å…¥æ ˆé¡ºåºï¼Œä»…éœ€è¦å…³æ³¨å‡ºæ ˆå’Œè®¿é—®ï¼ˆç¬¬3ç‚¹ï¼‰ï¼Œéšç€æ›´è¯¦ç»†çš„åˆ†æï¼Œä½ å°†æ›´åŠ ä½“ä¼šåˆ°è¿™ç§ç®€åŒ–å¸¦æ¥çš„å¥½å¤„ã€‚</p>
<p>é’ˆå¯¹ä¸Šè¿°é€»è¾‘æˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªéå†è§„åˆ™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-29-20-24-21.png" alt=""> </p>
<p>å³ä¸Šé¢è¯´åˆ°çš„ä¸‰ä¸ªæ­¥éª¤ï¼</p>
<ol>
<li>å°†äºŒå‰æ ‘åˆ†ä¸ºâ€œå·¦â€ï¼ˆåŒ…æ‹¬ä¸€è·¯å‘å·¦ï¼Œç»è¿‡çš„æ‰€æœ‰å®é™…å·¦+æ ¹ï¼‰ã€â€œå³â€ï¼ˆåŒ…æ‹¬å®é™…çš„å³ï¼‰ä¸¤ç§èŠ‚ç‚¹</li>
<li>ä½¿ç”¨åŒæ ·çš„é¡ºåºå°†â€œå·¦â€èŠ‚ç‚¹å…¥æ ˆ</li>
<li>ä»ä¸‹åˆ°ä¸Šï¼Œä»¥æ­¤è®¿é—®å…¶çš„å³å­æ ‘ï¼ŒåŒæ—¶æŠŠå³å­æ ‘çœ‹æˆä¸€é¢—å®Œæ•´çš„æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</li>
</ol>
<h2 id="å‰åº">3.2. å‰åº</h2><p>å…ˆåºå’Œä¸­åºçš„æƒ…å†µæ˜¯æå…¶ç›¸ä¼¼çš„ã€‚</p>
<ul>
<li>å…ˆåºçš„å®é™…é¡ºåºï¼šã€æ ¹å·¦ã€‘ã€å³ã€‘</li>
<li>ä¸­åºçš„å®é™…é¡ºåºï¼šã€å·¦æ ¹ã€‘ã€å³ã€‘</li>
</ul>
<p>ä½¿ç”¨ä¸Šè¿°æ€è·¯ï¼Œå…ˆåºå’Œä¸­åºçš„éå†é¡ºåºå¯ç»Ÿä¸€ä¸ºï¼šã€â€œå·¦â€â€œå³â€ã€‘ã€‚</p>
<p>ç»™æˆ‘ä»¬çš„ç›´è§‚æ„Ÿè§‰æ˜¯ä»£ç ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚å®é™…æƒ…å†µæ­£æ˜¯å¦‚æ­¤ï¼Œå…ˆåºä¸ä¸­åºçš„åŒºåˆ«åªåœ¨äºå¯¹â€œå·¦â€èŠ‚ç‚¹çš„è®¿é—®ä¸Šã€‚</p>
<p><strong>å‰åºï¼š</strong></p>
<p>ä¸éœ€è¦å…¥æ ˆï¼Œæ¯æ¬¡éå†åˆ°â€œå·¦â€èŠ‚ç‚¹ï¼Œç«‹å³è¾“å‡ºå³å¯ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéå†åˆ°æœ€å·¦ä¸‹çš„èŠ‚ç‚¹æ—¶ï¼Œå®é™…ä¸Šè¾“å‡ºçš„å·²ç»ä¸å†æ˜¯å®é™…çš„æ ¹èŠ‚ç‚¹ï¼Œè€Œæ˜¯å®é™…çš„å·¦èŠ‚ç‚¹ã€‚è¿™ç¬¦åˆå…ˆåºçš„å®šä¹‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</div><div class="line">    results.add(cur.val);</div><div class="line">    stack.push(cur);</div><div class="line">    cur = cur.left;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è€Œåï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»è®¿é—®è¿‡æ‰€æœ‰â€œå·¦â€èŠ‚ç‚¹ï¼Œç°åœ¨åªéœ€è¦å°†è¿™äº›æ²¡ç”¨çš„èŠ‚ç‚¹å‡ºæ ˆï¼Œç„¶åè½¬å‘åˆ°â€œå³â€èŠ‚ç‚¹ã€‚äºæ˜¯â€œå³â€èŠ‚ç‚¹ä¹Ÿå˜æˆäº†â€œå·¦â€èŠ‚ç‚¹ï¼Œåç»­å¤„ç†åŒä¸Šã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (!stack.empty()) &#123;</div><div class="line">    cur = stack.pop();</div><div class="line">    <span class="comment">// æŠŠå³å­æ ‘ä½œä¸ºä¸€é¢—æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</span></div><div class="line">    cur = cur.right;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> List&lt;Integer&gt; <span class="title">dfsPreOrder</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    List&lt;Integer&gt; results = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line"></div><div class="line">    TreeNode cur = root;</div><div class="line">    <span class="keyword">while</span> (cur != <span class="keyword">null</span> || !stack.empty()) &#123;</div><div class="line">        <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</div><div class="line">            results.add(cur.val);</div><div class="line">            stack.push(cur);</div><div class="line">            cur = cur.left;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!stack.empty()) &#123;</div><div class="line">            cur = stack.pop();</div><div class="line">            <span class="comment">// æŠŠå³å­æ ‘ä½œä¸ºä¸€é¢—æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</span></div><div class="line">            cur = cur.right;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¸­åº">3.3. ä¸­åº</h2><p>åŸºäºå¯¹å…ˆåºçš„åˆ†æï¼Œ<strong>å…ˆåºä¸ä¸­åºçš„åŒºåˆ«åªåœ¨äºå¯¹â€œå·¦â€èŠ‚ç‚¹çš„å¤„ç†ä¸Š</strong>ï¼Œæˆ‘ä»¬è°ƒæ•´ä¸€è¡Œä»£ç å³å¯å®Œæˆä¸­åºéå†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</div><div class="line">    stack.push(cur);</div><div class="line">    cur = cur.left;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (!stack.empty()) &#123;</div><div class="line">    cur = stack.pop();</div><div class="line">    results.add(cur.val); <span class="comment">// ä»…è°ƒæ•´è¯¥è¡Œä»£ç </span></div><div class="line">    <span class="comment">// æŠŠå³å­æ ‘ä½œä¸ºä¸€é¢—æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</span></div><div class="line">    cur = cur.right;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨å‡ºæ ˆä¹‹åæ‰è®¿é—®è¿™ä¸ªèŠ‚ç‚¹ã€‚å› ä¸ºå…ˆåºå…ˆè®¿é—®å®é™…æ ¹ï¼Œåè®¿é—®å®é™…å·¦ï¼Œè€Œä¸­åºæ°å¥½ç›¸åã€‚ç›¸åŒçš„æ˜¯ï¼Œè®¿é—®å®Œæ ¹+å·¦å­æ ‘ï¼ˆå…ˆåºï¼‰æˆ–å·¦å­æ ‘+æ ¹ï¼ˆä¸­åºï¼‰åï¼Œéƒ½éœ€è¦è½¬å‘åˆ°â€œå³â€èŠ‚ç‚¹ï¼Œä½¿â€œå³â€èŠ‚ç‚¹ç§°ä¸ºæ–°çš„â€œå·¦â€èŠ‚ç‚¹ã€‚</p>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> List&lt;Integer&gt; <span class="title">dfsInOrder</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">     List&lt;Integer&gt; results = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">     Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;TreeNode&gt;();</div><div class="line"></div><div class="line">     TreeNode cur = root;</div><div class="line">     <span class="keyword">while</span> (cur != <span class="keyword">null</span> || !stack.empty()) &#123;</div><div class="line">         <span class="keyword">while</span> (cur != <span class="keyword">null</span>) &#123;</div><div class="line">             stack.push(cur);</div><div class="line">             cur = cur.left;</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span> (!stack.empty()) &#123;</div><div class="line">             cur = stack.pop();</div><div class="line">             results.add(cur.val);</div><div class="line">             <span class="comment">// æŠŠå³å­æ ‘ä½œä¸ºä¸€é¢—æ ‘ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</span></div><div class="line">             cur = cur.right;</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> results;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="ååº">3.4. ååº</h2><p>ååºçš„æƒ…å†µç•¥æœ‰ä¸åŒï¼Œä½†ä»ç„¶ååˆ†ç®€æ´ã€‚</p>
<ul>
<li>ååºçš„å®é™…é¡ºåºï¼šå·¦å³æ ¹</li>
</ul>
<p>å…¥æ ˆé¡ºåºä¸å˜ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç¬¬3ç‚¹çš„å˜åŒ–ã€‚å‡ºæ ˆçš„å¯¹è±¡ä¸€å®šéƒ½æ˜¯â€œå·¦â€èŠ‚ç‚¹ï¼ˆâ€œå³â€èŠ‚ç‚¹ä¼šåœ¨è½¬å‘åç§°ä¸ºâ€œå·¦â€èŠ‚ç‚¹ï¼Œç„¶åå…¥æ ˆï¼‰ï¼Œä¹Ÿå°±æ˜¯å®é™…çš„å·¦æˆ–æ ¹ï¼›å®é™…çš„å·¦å¯ä»¥å½“åšå·¦å³å­æ ‘éƒ½ä¸ºnullçš„æ ¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ†æå®é™…çš„æ ¹ã€‚</p>
<p>å¯¹äºå®é™…çš„æ ¹ï¼Œéœ€è¦ä¿è¯å…ˆåè®¿é—®äº†å·¦å­æ ‘ã€å³å­æ ‘ä¹‹åï¼Œæ‰èƒ½è®¿é—®æ ¹ã€‚å®é™…çš„å³èŠ‚ç‚¹ã€å·¦èŠ‚ç‚¹ã€æ ¹èŠ‚ç‚¹éƒ½ä¼šæˆä¸ºâ€œå·¦â€èŠ‚ç‚¹å…¥æ ˆï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦<strong>åœ¨å‡ºæ ˆä¹‹å‰ï¼Œå°†è¯¥èŠ‚ç‚¹è§†ä½œå®é™…çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶æ£€æŸ¥å…¶å³å­æ ‘æ˜¯å¦å·²è¢«è®¿é—®</strong>å³å¯ã€‚å¦‚æœä¸å­˜åœ¨å³å­æ ‘ï¼Œæˆ–å³å­æ ‘å·²è¢«è®¿é—®äº†ï¼Œé‚£ä¹ˆå¯ä»¥è®¿é—®æ ¹èŠ‚ç‚¹ï¼Œå‡ºæ ˆï¼Œå¹¶ä¸éœ€è¦è½¬å‘ï¼›å¦‚æœè¿˜æ²¡æœ‰è®¿é—®ï¼Œå°±è½¬å‘ï¼Œä½¿å…¶â€œå³â€èŠ‚ç‚¹æˆä¸ºâ€œå·¦â€èŠ‚ç‚¹ï¼Œç­‰ç€å®ƒå…ˆè¢«è®¿é—®ä¹‹åï¼Œå†æ¥è®¿é—®æ ¹èŠ‚ç‚¹ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ ‡å¿—ï¼Œè®°å½•å³å­æ ‘çš„è®¿é—®æƒ…å†µã€‚ç”±äºè®¿é—®æ ¹èŠ‚ç‚¹å‰ï¼Œä¸€å®šå…ˆç´§æŒ¨ç€è®¿é—®äº†å…¶å³å­æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ ‡å¿—ä½ã€‚</p>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">postorderTraversal</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>( <span class="keyword">null</span> == root ) <span class="keyword">return</span> result;</div><div class="line">        Stack&lt;TreeNode&gt; helper = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        HashSet&lt;TreeNode&gt; flag = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (!helper.empty() || <span class="keyword">null</span> != root)&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != root &amp;&amp; !flag.contains(root))&#123;</div><div class="line">                helper.push(root);</div><div class="line">                root = root.left;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                root = helper.peek();</div><div class="line">                <span class="keyword">if</span>(flag.contains(root))&#123;</div><div class="line">                    helper.pop();</div><div class="line">                    result.add(root.val);</div><div class="line">                    root = <span class="keyword">null</span>; <span class="comment">// è¡¨ç¤ºä¸éœ€è¦è½¬å‘ï¼Œç»§ç»­å¼¹æ ˆ</span></div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    flag.add(root);</div><div class="line">                    <span class="keyword">if</span>(<span class="keyword">null</span> != root.right)&#123;</div><div class="line">                        root = root.right;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å‰åºé€’å½’å®ç°">4. å‰åºé€’å½’å®ç°</h1><h2 id="å®ç°1ï¼Œé€’å½’">4.1. å®ç°1ï¼Œé€’å½’</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è°ƒç”¨ä¸»å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;Integer&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  ArrayList&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">  traverse(root,result);</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="comment">//é€’å½’å®šä¹‰ï¼šæŠŠrootä¸ºæ ¹çš„preorderåŠ å…¥åˆ°resulté‡Œ</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">traverse</span><span class="params">(TreeNode root, ArrayList&lt;Integer&gt; result)</span></span>&#123;</div><div class="line">  <span class="comment">//åœæ­¢æ¡ä»¶</span></div><div class="line">  <span class="keyword">if</span>( root == <span class="keyword">null</span> )&#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//æ‹†åˆ†é—®é¢˜</span></div><div class="line">  result.add(root.val);</div><div class="line">  traverse(root.left,result);</div><div class="line">  traverse(root.right,result);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">é€’å½’</div><div class="line"></div><div class="line">å®šä¹‰ï¼š æŠŠrootä¸ºæ ¹çš„preorderåŠ å…¥åˆ°resulté‡Œ</div><div class="line"></div><div class="line">æ‹†åˆ†é—®é¢˜ï¼š æ”¾root,æ”¾left,æ”¾right</div><div class="line"></div><div class="line">åœæ­¢æ¡ä»¶ï¼š root == <span class="keyword">null</span></div></pre></td></tr></table></figure>
<h2 id="å®ç°2ï¼Œåˆ†æ²»">4.2. å®ç°2ï¼Œåˆ†æ²»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;Integer&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  ArrayList&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">  <span class="comment">// null or leaf</span></div><div class="line">  <span class="keyword">if</span>( <span class="keyword">null</span> == root )&#123;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//åˆ†è§£é—®é¢˜</span></div><div class="line">  ArrayList&lt;Integer&gt; left = preorderTraversal(root.left);</div><div class="line">  ArrayList&lt;Integer&gt; right = preorderTraversal(root.right);</div><div class="line">  </div><div class="line">  <span class="comment">//åˆå¹¶é—®é¢˜</span></div><div class="line">  result.add(root.val);</div><div class="line">  result.addAll(left);</div><div class="line">  result.addAll(right);</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€’å½’å¯èƒ½çˆ†æ ˆï¼</p>
<h1 id="DFS">5. DFS</h1><p>DFSæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>éé€’å½’</li>
<li>é€’å½’ â€“ æœ‰ä¸¤ç§é€‰æ‹©ï¼š<ul>
<li>åˆ†æ²»</li>
<li>éå†</li>
</ul>
</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-28-16-49-04.png" alt=""> </p>
<p><strong>ç¢°åˆ°äºŒå‰æ ‘é—®é¢˜ï¼Œå°±æƒ³æƒ³æ•´æ£µæ ‘ä¸Šåœ¨è¯¥é—®é¢˜ä¸Šçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œå·¦å³å„¿å­åœ¨è¯¥é—®é¢˜ä¸Šçš„ç»“æœä¹‹é—´çš„è”ç³»æ˜¯ä»€ä¹ˆ</strong></p>
<h2 id="Symmetric-Tree">5.1. Symmetric Tree</h2><p>éªŒè¯ä¸€ä¸ªäºŒå‰æ ‘æ˜¯å¦æ˜¯é•œåƒçš„</p>
<p>æ€è·¯å°±æ˜¯åˆ†æˆä¸¤è·¯æ¢ç´¢ï¼Œä¸€è·¯å·¦è¾¹ï¼Œä¸€è·¯å³è¾¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(TreeNode leftBranch, TreeNode rightBranch)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(leftBranch == <span class="keyword">null</span> &amp;&amp; rightBranch == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">if</span>(leftBranch == <span class="keyword">null</span> || rightBranch == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">return</span> (leftBranch.val == rightBranch.val) &amp;&amp;</div><div class="line">            helper(leftBranch.left, rightBranch.right)&amp;&amp;</div><div class="line">            helper(leftBranch.right, rightBranch.left);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSymmetric</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">return</span> helper(root.left, root.right);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Path-Sum">5.2. Path Sum</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªtargetã€‚æ±‚äºŒå‰æ ‘çš„æŸä¸ªè·¯å¾„å’Œæ˜¯å¦å®Œå…¨ç­‰äºtargetã€‚</p>
<p>åŸºç¡€é¢˜ï¼šBinary Tree Pathsï¼Œå¯ä»¥è€ƒè™‘å…ˆåšè¿™ä¸ªåŸºç¡€é¢˜ï¼Œç„¶ååœ¨åšè¿™äº›</p>
<p>æ€è·¯ï¼šé€’å½’å°±å¥½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(TreeNode node, <span class="keyword">int</span> sum, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(node.left == <span class="keyword">null</span> &amp;&amp; node.right == <span class="keyword">null</span>) <span class="keyword">return</span> sum == target;</div><div class="line">       <span class="keyword">return</span> (node.left != <span class="keyword">null</span> &amp;&amp; helper(node.left, sum + node.left.val, target) ||</div><div class="line">               node.right != <span class="keyword">null</span> &amp;&amp; helper(node.right, sum + node.right.val, target));</div><div class="line"></div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       <span class="keyword">return</span> helper( root, root.val, target);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Path-Sum-II">5.3. Path Sum II</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªtargetã€‚æ±‚äºŒå‰æ ‘çš„è·¯å¾„å’Œå®Œå…¨ç­‰äºtargetçš„æ‰€æœ‰è·¯å¾„</p>
<p>è¿˜æ˜¯é€’å½’å“‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(TreeNode node, <span class="keyword">int</span> sum, List&lt;Integer&gt; list, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">      <span class="keyword">if</span>(node.left == <span class="keyword">null</span> &amp;&amp; node.right == <span class="keyword">null</span>)&#123;</div><div class="line">          <span class="keyword">if</span>(sum == target)&#123;result.add(<span class="keyword">new</span> ArrayList&lt;&gt;(list));&#125;</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(node.left != <span class="keyword">null</span>)&#123;</div><div class="line">          list.add(node.left.val);</div><div class="line">          helper(node.left, sum + node.left.val, list, target);</div><div class="line">          list.remove(list.size() - <span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(node.right != <span class="keyword">null</span>)&#123;</div><div class="line">          list.add(node.right.val);</div><div class="line">          helper(node.right, sum + node.right.val, list, target);</div><div class="line">          list.remove(list.size() - <span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; pathSum(TreeNode root, <span class="keyword">int</span> target) &#123;</div><div class="line">      <span class="keyword">if</span>(root != <span class="keyword">null</span>)&#123;</div><div class="line">          List&lt;Integer&gt; lists = <span class="keyword">new</span> LinkedList&lt;Integer&gt;();</div><div class="line">          lists.add(root.val);</div><div class="line">          helper(root, root.val,lists , target);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> result;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h2 id="Path-Sum-III">5.4. Path Sum III</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªtargetã€‚æ±‚äºŒå‰æ ‘æŸç‚¹åˆ°å…¶çš„æŸä¸ªå­èŠ‚ç‚¹çš„å’Œç­‰äºtargetçš„ä¸ªæ•°ã€‚</p>
<p>æ€è·¯ï¼šå…¶å®è¿™é“é¢˜ç±»ä¼¼äºå•æ¡è·¯å¾„ä¸Šçš„è¿™é“é¢˜ï¼š560. Subarray Sum Equals K</p>
<p>åœ¨dfsæ—¶ï¼Œå­˜å‚¨å½“å‰èŠ‚ç‚¹<code>i</code>è·¯å¾„ä¸‹çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹<code>j</code>åˆ°rootçš„å’Œã€‚é‚£ä¹ˆ<code>sum[i,j] = sum[i] - sum[j]</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(TreeNode node, <span class="keyword">int</span>[] sums, <span class="keyword">int</span> level, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">    <span class="comment">// å…ˆæ£€æŸ¥æœ¬èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨äºä¸Šé¢èŠ‚ç‚¹çš„å’Œ==targetçš„æƒ…å†µ</span></div><div class="line">    <span class="keyword">if</span>(sums[level] == target) ++counter;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; ++i)&#123;</div><div class="line">        <span class="comment">// System.out.println(i + "\t" + (sums[level] - sums[i]));</span></div><div class="line">        <span class="keyword">if</span>(sums[level] - sums[i] == target) ++counter;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// sumå­˜å‚¨ä»æ ¹èŠ‚ç‚¹åˆ°æœ¬èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„åˆ°rootçš„å’Œ</span></div><div class="line">    <span class="keyword">if</span>(node.left != <span class="keyword">null</span>)&#123;</div><div class="line">        sums[level + <span class="number">1</span>] = sums[level] + node.left.val;</div><div class="line">        helper(node.left, sums, level + <span class="number">1</span>, target);</div><div class="line">        sums[level + <span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(node.right != <span class="keyword">null</span>)&#123;</div><div class="line">        sums[level + <span class="number">1</span>] = sums[level] + node.right.val;</div><div class="line">        helper(node.right, sums, level + <span class="number">1</span>, target);</div><div class="line">        sums[level + <span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span>[] sums = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1001</span>];</div><div class="line">    sums[<span class="number">0</span>] = root.val;</div><div class="line">    helper(root, sums, <span class="number">0</span>, target );</div><div class="line">    <span class="keyword">return</span> counter;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¼˜åŒ–ï¼šæ‰€æœ‰å’Œè¿˜å¯ä»¥ç”¨hashè¡¨å­˜å‚¨ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(TreeNode node, HashMap&lt;Integer, Integer&gt; sums, <span class="keyword">int</span> lastSum, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">      <span class="comment">// æ£€æŸ¥ä¸æ ¹èŠ‚ç‚¹</span></div><div class="line">      <span class="keyword">int</span> thisSum = lastSum + node.val;</div><div class="line">      <span class="keyword">if</span>(thisSum == target) ++counter;</div><div class="line">      <span class="comment">//æ£€æŸ¥ä¸å…¶å®ƒèŠ‚ç‚¹</span></div><div class="line">      <span class="keyword">if</span>(sums.containsKey(thisSum - target)) &#123;</div><div class="line">          counter += sums.get(thisSum - target);</div><div class="line">      &#125;</div><div class="line">      <span class="comment">//å°†æœ¬èŠ‚ç‚¹åŠ å…¥</span></div><div class="line">      <span class="keyword">if</span>(sums.containsKey(thisSum))&#123;</div><div class="line">          sums.replace(thisSum, sums.get(thisSum) + <span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span> sums.put(thisSum, <span class="number">1</span>);</div><div class="line">      <span class="keyword">if</span>(node.left != <span class="keyword">null</span>)&#123;</div><div class="line">          helper(node.left, sums,thisSum, target);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(node.right != <span class="keyword">null</span>)&#123;</div><div class="line">          helper(node.right, sums, thisSum, target);</div><div class="line">      &#125;</div><div class="line">      <span class="comment">//å°†æœ¬èŠ‚ç‚¹æŒªå‡º</span></div><div class="line">      <span class="keyword">if</span>(sums.get(thisSum) &gt; <span class="number">1</span>) sums.replace(thisSum, sums.get(thisSum) - <span class="number">1</span>);</div><div class="line">      <span class="keyword">else</span> sums.remove(thisSum);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">      <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">      HashMap&lt;Integer, Integer&gt; sums = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">      helper(root, sums, <span class="number">0</span>, target );</div><div class="line">      <span class="keyword">return</span> counter;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h2 id="Trim-a-Binary-Search-Tree">5.5. Trim a Binary Search Tree</h2><p>ä¿®å‰ªäºŒå‰æ ‘ï¼Œä½¿å¾—å€¼åœ¨<code>[L,R]</code> ä¹‹é—´ã€‚ä¿®å‰ªæ—¶ï¼Œä¼˜å…ˆä¿ç•™å·¦å­æ ‘ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">trimBST</span><span class="params">(TreeNode root, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>)<span class="keyword">return</span> root;</div><div class="line">        <span class="keyword">if</span>(root.val &gt;= L &amp;&amp; root.val &lt;= R)&#123;</div><div class="line">            root.left = trimBST(root.left, L, R);</div><div class="line">            root.right = trimBST(root.right, L, R);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            TreeNode left = trimBST(root.left, L, R);</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != left) root = left;</div><div class="line">            <span class="keyword">else</span> root = trimBST(root.right, L, R);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="BFSç›¸å…³ä¾‹é¢˜">6. BFSç›¸å…³ä¾‹é¢˜</h1><p>BFSæœ€é‡è¦çš„ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼š</p>
<ul>
<li>é˜Ÿåˆ—</li>
<li>å“ˆå¸Œè¡¨</li>
</ul>
<h2 id="å±‚åºéå†">6.1. å±‚åºéå†</h2><h2 id="ä¾‹é¢˜1ï¼ŒBinary-Tree-Level-Order-Traversal">6.2. ä¾‹é¢˜1ï¼ŒBinary Tree Level Order Traversal</h2><p>é˜Ÿåˆ—ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">ArrayList&lt;ArrayList&lt;Integer&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;ArrayList&lt;Integer&gt;&gt;();</div><div class="line"><span class="keyword">if</span>(<span class="keyword">null</span> == root)&#123;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="comment">// interface</span></div><div class="line">Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">queue.offer(root);</div><div class="line"><span class="keyword">while</span>(!queue.isEmpty())&#123;</div><div class="line">  <span class="keyword">int</span> size =queue.size();</div><div class="line">  ArrayList&lt;Integer&gt; currentLevel = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)&#123;</div><div class="line">    TreeNode head = queue.poll();</div><div class="line">    currentLevel.add(head.val);</div><div class="line">    <span class="keyword">if</span>(head.left != <span class="keyword">null</span>)&#123;</div><div class="line">      queue.offer(head.left);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(head.right != <span class="keyword">null</span>)&#123;</div><div class="line">      queue.offer(head.right);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  result.add(currentLevel);</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> result;</div></pre></td></tr></table></figure>
<h2 id="Binary-Tree-Level-Order-Traversal-II">6.3. Binary Tree Level Order Traversal II</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrderBottom(TreeNode root) &#123;</div><div class="line">        LinkedList&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;(); </div><div class="line">        <span class="comment">// LinkedListæ˜¯Listæ¥å£çš„å®ç°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == root) <span class="keyword">return</span> result;</div><div class="line">        Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        queue.offer(root);</div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">            <span class="keyword">int</span> size = queue.size();</div><div class="line">            List&lt;Integer&gt; curResult = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">            <span class="keyword">while</span> (size &gt; <span class="number">0</span>)&#123;</div><div class="line">                TreeNode cur = queue.poll();</div><div class="line">                curResult.add(cur.val);</div><div class="line">                <span class="keyword">if</span>(<span class="keyword">null</span> != cur.left)&#123;</div><div class="line">                    queue.offer(cur.left);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(<span class="keyword">null</span> != cur.right)&#123;</div><div class="line">                    queue.offer(cur.right);</div><div class="line">                &#125;</div><div class="line">                --size;</div><div class="line">            &#125;</div><div class="line">            result.addFirst(curResult); <span class="comment">// æ³¨æ„è¿™ä¸ªç¥å¥‡çš„ä¸œè¥¿</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Binary-Tree-Zigzag-Level-Order-Traversal">6.4. Binary Tree Zigzag Level Order Traversal</h2><p>è¾“å‡ºäºŒå‰æ ‘çš„å±‚åºéå†ï¼Œä¸”éœ€è¦éš”å±‚å€’åºã€‚</p>
<p>æ€è·¯ï¼šç”¨ä¸€ä¸ªlinkedListå°±å¥½å•¦</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; zigzagLevelOrder(TreeNode root) &#123;</div><div class="line">  List&lt;List&lt;Integer&gt;&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == root) <span class="keyword">return</span> result;</div><div class="line">  Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">  queue.offer(root);</div><div class="line">  <span class="keyword">boolean</span> fromHead = <span class="keyword">false</span>;</div><div class="line">  <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">    <span class="keyword">int</span> size =queue.size();</div><div class="line">    LinkedList&lt;Integer&gt; oneResult = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">while</span> (size &gt; <span class="number">0</span>)&#123;</div><div class="line">      TreeNode now = queue.poll();</div><div class="line">      <span class="keyword">if</span>(fromHead)&#123;</div><div class="line">        oneResult.addFirst(now.val);</div><div class="line">      &#125;<span class="keyword">else</span> &#123;</div><div class="line">        oneResult.addLast(now.val);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> != now.left) queue.offer(now.left);</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> != now.right)queue.offer(now.right);</div><div class="line">      --size;</div><div class="line">    &#125;</div><div class="line">    fromHead = !fromHead;</div><div class="line">    result.add(oneResult);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯2ï¼šç”¨ä¸¤ä¸ªæ ˆï¼Œå•æ•°å±‚å…ˆleftårightï¼ŒåŒæ•°å±‚å…ˆrightåleft</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> ArrayList&lt;ArrayList&lt;Integer&gt;&gt; zigzagLevelOrder(TreeNode root) &#123;</div><div class="line">    <span class="comment">// write your code here</span></div><div class="line">    ArrayList&lt;ArrayList&lt;Integer&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;ArrayList&lt;Integer&gt;&gt;();</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// currLevelè¡¨ç¤ºå½“å‰åœ¨å¤„ç†çš„é‚£ä¸€å±‚çš„ç»“ç‚¹</span></div><div class="line">    <span class="comment">// nextLevelè¡¨ç¤ºä¸‹ä¸€å±‚è¦å¤„ç†çš„ç»“ç‚¹</span></div><div class="line">    Stack&lt;TreeNode&gt; currLevel = <span class="keyword">new</span> Stack&lt;TreeNode&gt;();</div><div class="line">    Stack&lt;TreeNode&gt; nextLevel = <span class="keyword">new</span> Stack&lt;TreeNode&gt;();</div><div class="line">    Stack&lt;TreeNode&gt; tmp;</div><div class="line"></div><div class="line">    currLevel.push(root);</div><div class="line">    <span class="keyword">boolean</span> normalOrder = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (!currLevel.isEmpty()) &#123;</div><div class="line">        ArrayList&lt;Integer&gt; currLevelResult = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (!currLevel.isEmpty()) &#123;</div><div class="line">            TreeNode node = currLevel.pop();</div><div class="line">            currLevelResult.add(node.val);</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (normalOrder) &#123;</div><div class="line">                <span class="keyword">if</span> (node.left != <span class="keyword">null</span>) &#123;</div><div class="line">                    nextLevel.push(node.left);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (node.right != <span class="keyword">null</span>) &#123;</div><div class="line">                    nextLevel.push(node.right);</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span> (node.right != <span class="keyword">null</span>) &#123;</div><div class="line">                    nextLevel.push(node.right);</div><div class="line">                &#125; </div><div class="line">                <span class="keyword">if</span> (node.left != <span class="keyword">null</span>) &#123;</div><div class="line">                    nextLevel.push(node.left);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        result.add(currLevelResult);</div><div class="line">        <span class="comment">// äº¤æ¢currLevelå’ŒnextLevelï¼ŒcurrLevelä»£è¡¨å°†è¦å¤„ç†çš„é‚£ä¸€å±‚ç»“ç‚¹</span></div><div class="line">        tmp = currLevel;</div><div class="line">        currLevel = nextLevel;</div><div class="line">        nextLevel = tmp;</div><div class="line"></div><div class="line">        normalOrder = !normalOrder;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Binary-Tree-Right-Side-View">6.5. Binary Tree Right Side View</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘ã€‚ä»æœ€å³è¾¹çœ‹å»ï¼Œèƒ½çœ‹åˆ°çš„æ•°å­—éƒ½æ˜¯å‡ ï¼Ÿ</p>
<p>æ€è·¯ï¼šå±‚åºéå†ï¼Œè¾“å‡ºæ¯å±‚çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">rightSideView</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> result;</div><div class="line">    <span class="comment">// å±‚åºéå†çš„æœ€åä¸€ä¸ª</span></div><div class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    queue.add(root);</div><div class="line">    <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">        <span class="keyword">int</span> size = queue.size();</div><div class="line">        TreeNode temp = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span> (size &gt; <span class="number">0</span>)&#123;</div><div class="line">            temp = queue.poll();</div><div class="line">            <span class="keyword">if</span>(temp.left != <span class="keyword">null</span>) queue.add(temp.left);</div><div class="line">            <span class="keyword">if</span>(temp.right != <span class="keyword">null</span>) queue.add(temp.right);</div><div class="line">            --size;</div><div class="line">        &#125;</div><div class="line">        result.add(temp.val);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Populating-Next-Right-Pointers-in-Each-Node-I-å’ŒII">6.6. Populating Next Right Pointers in Each Node I å’ŒII</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åº”è¯¥æœ‰ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ï¼Œä½†è¾“å…¥å‰å…„å¼ŸèŠ‚ç‚¹è¿˜æ˜¯ç©ºçš„ã€‚å®Œæˆä¸€ä¸ªå‡½æ•°å®ç°å®ƒã€‚</p>
<p><strong>æ€è·¯ä¸€ï¼šå±‚åºéå†</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">(TreeLinkNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">        Queue&lt;TreeLinkNode&gt; level = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        level.add(root);</div><div class="line">        <span class="keyword">while</span> (!level.isEmpty())&#123;</div><div class="line">            <span class="keyword">int</span> size = level.size();</div><div class="line">            TreeLinkNode last = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">while</span> (size-- &gt; <span class="number">0</span>)&#123;</div><div class="line">                TreeLinkNode curr = level.poll();</div><div class="line">                <span class="keyword">if</span>(curr.left != <span class="keyword">null</span>)level.add(curr.left);</div><div class="line">                <span class="keyword">if</span>(curr.right != <span class="keyword">null</span>)level.add(curr.right);</div><div class="line">                <span class="keyword">if</span>(last == <span class="keyword">null</span>)&#123;</div><div class="line">                    last = curr;</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    last.next = curr;</div><div class="line">                    last = curr;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œéªšæ“ä½œ</strong> â€”â€” åªé€‚åˆIï¼Œä¸é€‚åˆII</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> æ»¡äºŒå‰æ ‘ï¼</div><div class="line">   node       next</div><div class="line">   /  \       / \</div><div class="line">left right left right</div><div class="line"></div><div class="line">node.right.next = node.next.left !!!!!</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">(TreeLinkNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">            TreeLinkNode cur = root;</div><div class="line">            <span class="keyword">while</span> (cur != <span class="keyword">null</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(cur.left != <span class="keyword">null</span>)cur.left.next = cur.right;</div><div class="line">                <span class="keyword">if</span>(cur.right != <span class="keyword">null</span> &amp;&amp; cur.next != <span class="keyword">null</span>) cur.right.next = cur.next.left;</div><div class="line">                cur = cur.next;</div><div class="line">            &#125;</div><div class="line">            root = root.left;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Find-Largest-Value-in-Each-Tree-Row">6.7. Find Largest Value in Each Tree Row</h2><p>è¾“å‡ºäºŒå‰æ ‘æ¯è¡Œçš„æœ€å¤§å€¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">largestValues</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    List&lt;Integer&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> result;</div><div class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    queue.add(root);</div><div class="line">    <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">        <span class="keyword">int</span> size = queue.size();</div><div class="line">        <span class="keyword">int</span> max = Integer.MIN_VALUE;</div><div class="line">        <span class="keyword">while</span> (size &gt; <span class="number">0</span>)&#123;</div><div class="line">            root = queue.poll();</div><div class="line">            max = Math.max(max, root.val);</div><div class="line">            <span class="keyword">if</span>(root.left != <span class="keyword">null</span>) queue.add(root.left);</div><div class="line">            <span class="keyword">if</span>(root.right != <span class="keyword">null</span>) queue.add(root.right);</div><div class="line">            --size;</div><div class="line">        &#125;</div><div class="line">        result.add(max);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="01-Matrix">6.8. 01 Matrix</h2><p>ç»™ä¸€ä¸ªçŸ©é˜µã€‚å°†è¿™ä¸ªçŸ©é˜µå˜ä¸ºï¼šæ¯ä¸ªå…ƒç´ çš„å€¼=å®ƒä¸æœ€è¿‘çš„0çš„è·ç¦»</p>
<p>è¿™ä¸ªæ“ä½œè¿˜æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] updateMatrix(<span class="keyword">int</span>[][] matrix) &#123;</div><div class="line">        <span class="keyword">if</span>(matrix.length == <span class="number">0</span>  || matrix[<span class="number">0</span>].length == <span class="number">0</span>)<span class="keyword">return</span> matrix;</div><div class="line">        <span class="keyword">int</span> m = matrix.length;</div><div class="line">        <span class="keyword">int</span> n = matrix[<span class="number">0</span>].length;</div><div class="line">        Queue&lt;<span class="keyword">int</span>[]&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="comment">// é˜Ÿåˆ—ç»´æŠ¤å½“å‰å·²ç¡®å®šçš„æ–¹æ ¼</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(matrix[i][j] == <span class="number">0</span>) queue.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i,j&#125;);</div><div class="line">                <span class="keyword">else</span> matrix[i][j] = Integer.MAX_VALUE;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] dx = &#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] dy = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">            <span class="keyword">int</span>[] pair = queue.poll();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</div><div class="line">                <span class="keyword">if</span>(matrix[pair[<span class="number">0</span>]+dx[k]][pair[<span class="number">1</span>]+dy[k]] &lt; matrix[pair[<span class="number">0</span>]][pair[<span class="number">1</span>]] + <span class="number">1</span>) <span class="keyword">continue</span>;</div><div class="line">                matrix[pair[<span class="number">0</span>]+dx[k]][pair[<span class="number">1</span>]+dy[k]] = matrix[pair[<span class="number">0</span>]][pair[<span class="number">1</span>]] + <span class="number">1</span>;</div><div class="line">                queue.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;pair[<span class="number">0</span>]+dx[k],pair[<span class="number">1</span>]+dy[k] &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> matrix;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Word-Ladder">6.9. Word Ladder</h2><p>è¾“å…¥çš„æ˜¯ï¼šä¸€ä¸ªå•è¯å’Œä¸€ä¸ªå­—å…¸ï¼Œå•è¯æ¯æ¬¡åªå…è®¸æ”¹å˜ä¸€ä¸ªå­—æ¯å˜æˆå­—å…¸ä¸­çš„æŸä¸ªå•è¯ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å˜æˆç›®æ ‡å•è¯ï¼Œå¦‚æœèƒ½çš„è¯è¿”å›å˜æ¢æ¬¡æ•°ï¼Œå¦åˆ™è¿”å›0ã€‚</p>
<ol>
<li>å°†æ¯ä¸ªå•è¯çœ‹æˆå›¾çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>å½“å•è¯s1æ”¹å˜ä¸€ä¸ªå­—ç¬¦å¯ä»¥å˜æˆå­˜åœ¨äºå­—å…¸çš„å•è¯s2æ—¶ï¼Œåˆ™s1ä¸s2ä¹‹é—´æœ‰è¿æ¥ã€‚</li>
<li>ç»™å®šs1å’Œs2ï¼Œé—®é¢˜Iè½¬åŒ–æˆäº†æ±‚åœ¨å›¾ä¸­ä»s1-&gt;s2çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚è€Œé—®é¢˜IIè½¬åŒ–ä¸ºäº†æ±‚æ‰€æœ‰s1-&gt;s2çš„æœ€çŸ­è·¯å¾„ã€‚</li>
</ol>
<p>æ— è®ºæ˜¯æ±‚æœ€çŸ­è·¯å¾„é•¿åº¦è¿˜æ˜¯æ±‚æ‰€æœ‰æœ€çŸ­è·¯å¾„ï¼Œéƒ½æ˜¯ç”¨BFSã€‚åœ¨BFSä¸­æœ‰ä¸‰ä¸ªå…³é”®æ­¥éª¤éœ€è¦å®ç°:</p>
<ol>
<li>å¦‚ä½•æ‰¾åˆ°ä¸å½“å‰èŠ‚ç‚¹ç›¸é‚»çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>è¿™é‡Œå¯ä»¥æœ‰ä¸¤ä¸ªç­–ç•¥ï¼š<br>(1) éå†æ•´ä¸ªå­—å…¸ï¼Œå°†å…¶ä¸­æ¯ä¸ªå•è¯ä¸å½“å‰å•è¯æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦åªå·®ä¸€ä¸ªå­—ç¬¦ã€‚å¤æ‚åº¦ä¸ºï¼šn<em>wï¼Œnä¸ºå­—å…¸ä¸­çš„å•è¯æ•°é‡ï¼Œwä¸ºå•è¯é•¿åº¦ã€‚<br>(2) éå†å½“å‰å•è¯çš„æ¯ä¸ªå­—ç¬¦xï¼Œå°†å…¶æ”¹å˜æˆa~zä¸­é™¤xå¤–çš„ä»»æ„ä¸€ä¸ªï¼Œå½¢æˆä¸€ä¸ªæ–°çš„å•è¯ï¼Œåœ¨å­—å…¸ä¸­åˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚å¤æ‚åº¦ä¸ºï¼š26</em>wï¼Œwä¸ºå•è¯é•¿åº¦ã€‚<br>è¿™é‡Œå¯ä»¥å’Œé¢è¯•å®˜è®¨è®ºä¸¤ç§ç­–ç•¥çš„å–èˆã€‚å¯¹äºé€šå¸¸çš„è‹±è¯­å•è¯æ¥è¯´ï¼Œé•¿åº¦å¤§å¤šå°äº100ï¼Œè€Œå­—å…¸ä¸­çš„å•è¯æ•°åˆ™å¾€å¾€æ˜¯æˆåƒä¸Šä¸‡ï¼Œæ‰€ä»¥ç­–ç•¥2ç›¸å¯¹è¾ƒä¼˜ã€‚</li>
<li>å¦‚ä½•æ ‡è®°ä¸€ä¸ªèŠ‚ç‚¹å·²ç»è¢«è®¿é—®è¿‡ï¼Œä»¥é¿å…é‡å¤è®¿é—®ã€‚<br>å¯ä»¥å°†è®¿é—®è¿‡çš„å•è¯ä»å­—å…¸ä¸­åˆ é™¤ã€‚</li>
<li>ä¸€æ—¦BFSæ‰¾åˆ°ç›®æ ‡å•è¯ï¼Œå¦‚ä½•backtrackingæ‰¾å›è·¯å¾„ï¼Ÿ</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">è¿™é“é¢˜å†™äº†æœ‰äº”å…­ä¸ªå°æ—¶ã€‚æ°”æ­»äº†ã€‚</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hammin</span><span class="params">(String a, String b)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> dist = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(a.charAt(i) == b.charAt(i)) <span class="keyword">continue</span>;</div><div class="line">            ++dist;</div><div class="line">            <span class="keyword">if</span>(dist &gt; <span class="number">2</span>) <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dist;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">ladderLength</span><span class="params">(String beginWord, String endWord, List&lt;String&gt; wordList)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(beginWord.equals(endWord)) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">boolean</span>[] visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[wordList.size()];</div><div class="line">        <span class="comment">// å±‚åºéå†</span></div><div class="line">        Queue&lt;String&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        queue.add(beginWord);</div><div class="line">        <span class="keyword">int</span> level = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">            ++level;</div><div class="line">            <span class="keyword">int</span> size = queue.size();</div><div class="line">            <span class="keyword">while</span> (size-- &gt; <span class="number">0</span>)&#123;</div><div class="line">                String currKey = queue.poll();</div><div class="line">                <span class="comment">// å°†æ‰€æœ‰æ±‰æ˜è·ç¦»ä¸º1çš„å­—ç¬¦åŠ å…¥</span></div><div class="line">                <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span>(String s : wordList)&#123;</div><div class="line">                    <span class="keyword">if</span>(!visited[i] &amp;&amp; hammin(currKey, s) == <span class="number">1</span>)&#123;</div><div class="line">                        visited[i] = <span class="keyword">true</span>;</div><div class="line">                        queue.add(s);</div><div class="line">                        <span class="keyword">if</span>(s.equals(endWord)) <span class="keyword">return</span> level;</div><div class="line">                    &#125;</div><div class="line">                    ++i;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Minimum-Height-Trees">6.10. Minimum Height Trees</h2><p>ç»™ä¸€ä¸ªæ— å‘æ— ç¯å›¾ï¼Œæ±‚ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½¿å¾—å®ƒåˆ°ä»»ä½•ç‚¹çš„è·ç¦»æœ€çŸ­ã€‚</p>
<p>éå¸¸å·§å¦™çš„æ€è·¯ã€‚ä»å¶å­ç»“ç‚¹å¼€å§‹BFSï¼Œæ¯æ¬¡åˆ æ‰ä¸€å±‚çš„å¶å­ç»“ç‚¹ã€‚æœ€åå‰©çš„é‚£ä¸€å±‚å°±æ˜¯ç»“æœï¼</p>
<p>ä¸€å¼€å§‹æˆ‘åªæƒ³åˆ°äº†åŠæˆªï¼Œæ²¡æœ‰æƒ³åˆ°ç”¨é˜Ÿåˆ—ï¼Œè€Œæ˜¯æƒ³åˆ°ç”¨ä¼˜å…ˆé˜Ÿåˆ—ã€‚ä¹Ÿæ²¡æƒ³é€šæœ€åä¸€å±‚å°±æ˜¯ç»“æœã€‚éš¾å—ã€‚æœ€åå‚è€ƒäº†<a href="https://mnmunknown.gitbooks.io/algorithm-notes/undirected_graph,_bfs.html" target="_blank" rel="external">ä»–çš„ä»£ç </a> æ‰æƒ³é€šäº†è¿™äº›ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> idx;</div><div class="line">    List&lt;Integer&gt; neibors;</div><div class="line">    <span class="keyword">int</span> degree = <span class="number">0</span>;</div><div class="line">    Node(<span class="keyword">int</span> idx)&#123;</div><div class="line">        <span class="keyword">this</span>.idx = idx;</div><div class="line">        neibors = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findMinHeightTrees</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span>[][] edges)</span> </span>&#123;</div><div class="line">    <span class="comment">// å¯»æ‰¾æ ¹èŠ‚ç‚¹</span></div><div class="line"></div><div class="line">    Node[] nodes = <span class="keyword">new</span> Node[n];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">        nodes[i] = <span class="keyword">new</span> Node(i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] edge : edges)&#123;</div><div class="line">        nodes[edge[<span class="number">0</span>]].neibors.add(edge[<span class="number">1</span>]);</div><div class="line">        nodes[edge[<span class="number">1</span>]].neibors.add(edge[<span class="number">0</span>]);</div><div class="line">        ++nodes[edge[<span class="number">0</span>]].degree;</div><div class="line">        ++nodes[edge[<span class="number">1</span>]].degree;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æ ¹èŠ‚ç‚¹ï¼š acCounter == 1 çš„èŠ‚ç‚¹</span></div><div class="line">    Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;(); <span class="comment">// å­˜æ”¾æ ¹èŠ‚ç‚¹ï¼Œè¿™ä¸€ç‚¹ä¸€å¼€å§‹æ²¡æœ‰æƒ³åˆ°</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(nodes[i].degree == <span class="number">1</span>) queue.add(i);</div><div class="line">    &#125;</div><div class="line">    List&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">        result = <span class="keyword">new</span> ArrayList&lt;&gt;();<span class="comment">// è¿™ä¸€æ­¥éå¸¸å·§å¦™ï¼Œå› ä¸ºæ¯æ¬¡BFSçš„å¶å­ç»“ç‚¹çš„å¯¹å¤–å±‚æ•°éƒ½ç›¸ç­‰ï¼</span></div><div class="line">        <span class="comment">// BFSåˆ é™¤æ‰€æœ‰çš„æ ¹èŠ‚ç‚¹</span></div><div class="line">        <span class="keyword">int</span> size = queue.size();</div><div class="line">        <span class="keyword">while</span> (size &gt; <span class="number">0</span>) &#123;</div><div class="line">            --size;</div><div class="line">            result.add(queue.peek());</div><div class="line">            Node root = nodes[queue.poll()];</div><div class="line">            <span class="comment">// åˆ é™¤è¿™ä¸ªæ ¹èŠ‚ç‚¹çš„è¾¹</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> neibor : root.neibors) &#123;</div><div class="line">                --nodes[neibor].degree;</div><div class="line">                --root.degree;</div><div class="line">                <span class="keyword">if</span> (nodes[neibor].degree == <span class="number">1</span>) &#123;</div><div class="line">                    queue.add(neibor);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="äºŒå‰æ ‘çš„éå†-1">7. äºŒå‰æ ‘çš„éå†</h1><h2 id="å‰åºéå†">7.1. å‰åºéå†</h2><h2 id="Binary-Tree-Preorder-Traversal">7.2. Binary Tree Preorder Traversal</h2><p>å®ç°äºŒå‰æ ‘çš„å‰åºéå†</p>
<p>è¿™é“é¢˜é™¤äº†ä»¥ä¸Šè¯´çš„é€’å½’å’Œéé€’å½’çš„ä¸¤ç§æ–¹å¼ï¼Œè¿˜æœ‰å¦ä¸€ç§éé€’å½’çš„å®ç°æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">  list&lt;Integer&gt; preorder = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">  <span class="keyword">if</span>( <span class="keyword">null</span> == root )&#123;</div><div class="line">    <span class="keyword">return</span> preorder;</div><div class="line">  &#125;</div><div class="line">  stack.push(root);</div><div class="line">  <span class="keyword">while</span>( !stack.empty() )&#123;</div><div class="line">    TreeNode node = stack.pop();</div><div class="line">    preorder.add( node.val );</div><div class="line">    <span class="keyword">if</span>( node.right != <span class="keyword">null</span> )&#123;</div><div class="line">      stack.push(node.right);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>( node.left != <span class="keyword">null</span> )&#123;</div><div class="line">      stack.push(node.left);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> preorder;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Flatten-Binary-Tree-to-Linked-List">7.3. Flatten Binary Tree to Linked List</h2><p>å°†äºŒå‰æ ‘æŒ‰ç…§å‰åºéå†çš„é¡ºåºå˜ä¸ºä¸€é¢—åªæœ‰å³å­©å­çš„å•é“¾è¡¨</p>
<p><strong>æ–¹æ³•1ï¼Œæ ˆ</strong></p>
<p>æ€è·¯ï¼šæ•´ä½“æ€è·¯å°±æ˜¯æŒ‰ç…§å‰åºéå†çš„æ–¹å¼.</p>
<p>éé€’å½’ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatten</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="comment">// å…¶å®å°±æ˜¯å‰åºéå†</span></div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        TreeNode node = root;</div><div class="line">        <span class="comment">//stack.push(node);</span></div><div class="line">        TreeNode last = node;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty() || node != <span class="keyword">null</span>)&#123;</div><div class="line"></div><div class="line">            <span class="keyword">while</span> (node != <span class="keyword">null</span>)&#123;</div><div class="line">                <span class="comment">//System.out.println(node.val);</span></div><div class="line">                <span class="keyword">if</span>(node.right != <span class="keyword">null</span>) &#123;</div><div class="line">                    stack.push(node.right); <span class="comment">// è¿™é‡Œåªpushè¿›å»node.right(å› ä¸ºåæœŸåªä¼šä½¿ç”¨åˆ°node.right)</span></div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(node.left != <span class="keyword">null</span>) &#123;<span class="comment">// å°†å·¦å­©å­æŒªåˆ°å³å­©å­ä¸Š</span></div><div class="line">                    node.right = node.left;</div><div class="line">                    TreeNode left = node.left;</div><div class="line">                    node.left = <span class="keyword">null</span>;</div><div class="line">                    node = left;</div><div class="line">                &#125;<span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">                last = node;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(stack.empty()) <span class="keyword">return</span>;</div><div class="line">            node = stack.pop();</div><div class="line">            last.right = node; <span class="comment">// å½“å‰èŠ‚ç‚¹çš„å³å­©å­åº”è¯¥æ˜¯ä¸Šä¸€è½®çš„æœ€åä¸€ä¸ªå­©å­</span></div><div class="line">            last = node;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>é€’å½’çš„å¦ä¸€ç§å®ç°</strong></p>
<p>è‡ªå·±å†™çš„å®åœ¨æ˜¯å¤ªç³Ÿç³•äº†ã€‚æˆ‘ä»¬çœ‹çœ‹ä¹ç« çš„å†™æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. åˆ†åˆ«å°†å³å­æ ‘ã€å·¦å­æ ‘å…¥æ ˆ</div><div class="line"><span class="number">2</span>. æœ¬èŠ‚ç‚¹çš„æ–°rightå°±æ˜¯æ ˆé¡¶çš„ä¸œè¥¿å“‡</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatten</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">        </div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        stack.push(root);</div><div class="line">        </div><div class="line">        <span class="keyword">while</span> (!stack.empty())&#123;</div><div class="line">            TreeNode node = stack.pop();</div><div class="line">            <span class="keyword">if</span>(node.right != <span class="keyword">null</span>) stack.push(node.right);</div><div class="line">            <span class="keyword">if</span>(node.left != <span class="keyword">null</span>) stack.push(node.left);</div><div class="line">            </div><div class="line">            <span class="comment">// è¿æ¥</span></div><div class="line">            node.left = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">if</span>(stack.empty()) node.right = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">else</span> node.right = stack.peek();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2ï¼Œåˆ†æ²»</strong></p>
<p>è¿™é“é¢˜çš„é€’å½’æ–¹å¼æˆ‘æ˜¯æ­»æ´»éƒ½æ²¡å†™å‡ºæ¥ã€‚å…¶å®å°±æ˜¯å‘å³æ¢åˆ°åº•é‚£æ²¡æƒ³é€šã€‚å“</p>
<p>å‡è®¾æŸèŠ‚ç‚¹çš„å·¦å³å­æ ‘T(root-&gt;left)å’ŒT(root-&gt;right)å·²ç»flattenæˆlinked listäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  1</div><div class="line">/   \</div><div class="line">2      5</div><div class="line">\       \</div><div class="line"> 3        6 &lt;- rightLast</div><div class="line">   \</div><div class="line">    4  &lt;- leftLast</div></pre></td></tr></table></figure>
<p>å¦‚ä½•å°†rootã€T(root-&gt;left)ã€T(root-&gt;right) flattenæˆä¸€æ•´ä¸ªlinked listï¼Ÿæ˜¾è€Œæ˜“è§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">temp = root.right</div><div class="line">root.right  = root.left</div><div class="line">root.left = NULL</div><div class="line">leftTail.right = temp</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatten</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    helper(root);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// flatten root and return the last node</span></div><div class="line"><span class="function"><span class="keyword">private</span> TreeNode <span class="title">helper</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    TreeNode leftLast = helper(root.left);</div><div class="line">    TreeNode rightLast = helper(root.right);</div><div class="line">    </div><div class="line">    <span class="comment">// connect leftLast to root.right</span></div><div class="line">    <span class="keyword">if</span> (leftLast != <span class="keyword">null</span>) &#123;</div><div class="line">        leftLast.right = root.right;</div><div class="line">        root.right = root.left;</div><div class="line">        root.left = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (rightLast != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> rightLast;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (leftLast != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> leftLast;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‚è€ƒ<a href="http://www.cnblogs.com/grandyang/p/4293853.html" target="_blank" rel="external">Grandyang</a></p>
<h2 id="ä¸­åºéå†">7.4. ä¸­åºéå†</h2><h2 id="Binary-Tree-Inorder-Traversal">7.5. Binary Tree Inorder Traversal</h2><p>å®ç°äºŒå‰æ ‘çš„ä¸­åºéå†</p>
<h2 id="Minimum-Absolute-Difference-in-BST">7.6. Minimum Absolute Difference in BST</h2><p>ç»™ä¸€ä¸ªäºŒå‰æœç´¢æ ‘ã€‚æ±‚ä»»æ„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´ç»å¯¹å€¼çš„æœ€å°å€¼ã€‚</p>
<p>æ€è·¯ï¼šä¸­åºéå†ï¼Œç”¨åé¢çš„å‡å»å‰é¢çš„ï¼Œæ‰¾åˆ°æœ€å°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMinimumDifference</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> last = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty() || <span class="keyword">null</span> != root)&#123;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != root) &#123;</div><div class="line">                stack.push(root);</div><div class="line">                root = root.left;</div><div class="line">            &#125;</div><div class="line">            root = stack.pop();</div><div class="line">            <span class="keyword">if</span>(last == -<span class="number">1</span>)&#123;last = root.val;&#125;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                min = Math.min(min,root.val - last);</div><div class="line">                last = root.val;</div><div class="line">            &#125;</div><div class="line">            root = root.right;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> min;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Kth-Smallest-Element-in-a-BST">7.7. Kth Smallest Element in a BST</h2><p>è¾“å‡ºæœç´¢äºŒå‰æ ‘ç¬¬kå°çš„æ•°</p>
<p>BSTçš„ä¸­åºéå†æ˜¯ä»å°åˆ°å¤§çš„ã€‚å› æ­¤åªéœ€è¦æŒ‰ç…§ä¸­åºéå†è¾“å‡ºç¬¬kä¸ªå³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(TreeNode root, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == root) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty() || <span class="keyword">null</span> != root)&#123;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">                stack.push(root);</div><div class="line">                root = root.left;</div><div class="line">            &#125;</div><div class="line">            root = stack.pop();</div><div class="line">            i++;</div><div class="line">            <span class="keyword">if</span>(i == k)&#123;</div><div class="line">                <span class="keyword">return</span> root.val;</div><div class="line">            &#125;</div><div class="line">            root = root.right;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>é€’å½’å†™æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> count=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> flag=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode node,<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(node==<span class="keyword">null</span>)&#123;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    inorder(node.left,k);</div><div class="line">    count++;</div><div class="line">    ans=node.val;</div><div class="line">    <span class="keyword">if</span>(count==k)&#123;</div><div class="line">        flag=ans;</div><div class="line">    &#125;</div><div class="line">    inorder(node.right,k);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(TreeNode root, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">   inorder(root,k);</div><div class="line">    <span class="keyword">return</span> flag;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ååºéå†">7.8. ååºéå†</h2><h2 id="Binary-Tree-Postorder-Traversal">7.9. Binary Tree Postorder Traversal</h2><p>å®ç°äºŒå‰æ ‘çš„ååºéå†</p>
<p>è¿™é“é¢˜é™¤äº†ä»¥ä¸Šè¯´çš„é€’å½’å’Œéé€’å½’çš„ä¸¤ç§æ–¹å¼ï¼Œè¿˜æœ‰ä¸€ç§æ›´éªšæ°”çš„ï¼Œåˆ©ç”¨åŒæ ˆã€‚</p>
<p>ä½†å®é™…ä¸Šå®ƒåšçš„æ˜¯åå‘çš„å…ˆåºéå†ã€‚äº¦å³éå†çš„é¡ºåºæ˜¯ï¼šèŠ‚ç‚¹ -&gt; å³å­æ ‘ -&gt; å·¦å­æ ‘ã€‚è¿™ç”Ÿæˆçš„æ˜¯åæ ¹éå†çš„é€†åºè¾“å‡ºã€‚ä½¿ç”¨ç¬¬äºŒä¸ªæ ˆï¼Œå†æ‰§è¡Œä¸€æ¬¡åå‘è¾“å‡ºå³å¯å¾—åˆ°æ‰€è¦çš„ç»“æœã€‚</p>
<p>ä¸‹é¢æ˜¯å®ƒçš„å®ç°æ­¥éª¤ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">å°†æ ¹èŠ‚ç‚¹å‹å…¥ç¬¬ä¸€ä¸ªæ ˆ</div><div class="line">ä»ç¬¬ä¸€ä¸ªæ ˆä¸­å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå‹å…¥ç¬¬äºŒä¸ªæ ˆ</div><div class="line">ç„¶ååˆ†åˆ«å°†è¯¥èŠ‚ç‚¹çš„å·¦å³å­©å­å‹å…¥ç¬¬ä¸€ä¸ªæ ˆ</div><div class="line">é‡å¤æ­¥éª¤<span class="number">2</span>å’Œæ­¥éª¤<span class="number">3</span>ç›´åˆ°ç¬¬ä¸€ä¸ªæ ˆä¸ºç©º</div><div class="line">æ‰§è¡Œç»“æŸï¼Œç¬¬äºŒä¸ªæ ˆä¸­å°±ä¿å­˜äº†æ‰€æœ‰èŠ‚ç‚¹çš„ååºéå†è¾“å‡ºç»“æœã€‚ä¾æ¬¡å°†å…ƒç´ ä»ç¬¬äºŒä¸ªæ ˆä¸­å¼¹å‡ºå³å¯ã€‚</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">postorderTraversal</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  List&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  Stack&lt;TreeNode&gt; tmp = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">  Stack&lt;TreeNode&gt; out = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line"></div><div class="line">  tmp.push(root);</div><div class="line"></div><div class="line">  <span class="keyword">while</span> (!tmp.isEmpty()) &#123;</div><div class="line">    TreeNode node = tmp.pop();</div><div class="line">    out.push(node);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (node.left != <span class="keyword">null</span>) &#123;</div><div class="line">      tmp.push(node.left);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (node.right != <span class="keyword">null</span>) &#123;</div><div class="line">      tmp.push(node.right);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">while</span> (!out.isEmpty()) &#123;</div><div class="line">    result.add(out.pop().val);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Subtree-of-Another-Tree">7.10. Subtree of Another Tree</h2><p>ç»™ä¸¤ä¸ªäºŒå‰æ ‘så’Œtã€‚åˆ¤æ–­tæ˜¯å¦æ˜¯sçš„å­æ ‘</p>
<p>æ€è·¯ä¸€ï¼Œéé€’å½’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(TreeNode s_in,TreeNode t_in)</span></span>&#123;</div><div class="line">        TreeNode t = t_in;</div><div class="line">        TreeNode s = s_in;</div><div class="line">        Stack&lt;TreeNode&gt; stack_t = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        Stack&lt;TreeNode&gt; stack_s = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (!stack_t.isEmpty()|| <span class="keyword">null</span> != t)&#123;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != t &amp;&amp; <span class="keyword">null</span> != s)&#123;</div><div class="line">                stack_t.push(t);</div><div class="line">                stack_s.push(s);</div><div class="line">                s = s.left;</div><div class="line">                t = t.left;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(!( (<span class="keyword">null</span> != t &amp;&amp; <span class="keyword">null</span> != s)||</div><div class="line">                    (<span class="keyword">null</span> == t &amp;&amp; <span class="keyword">null</span> == s)) ) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            t = stack_t.pop();</div><div class="line">            s = stack_s.pop();</div><div class="line">            <span class="keyword">if</span>(t.val != s.val)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            s = s.right;</div><div class="line">            t = t.right;</div><div class="line">            <span class="keyword">if</span>(!( (<span class="keyword">null</span> != t &amp;&amp; <span class="keyword">null</span> != s)||</div><div class="line">                    (<span class="keyword">null</span> == t &amp;&amp; <span class="keyword">null</span> == s)) ) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSubtree</span><span class="params">(TreeNode s, TreeNode t)</span> </span>&#123;</div><div class="line">        <span class="comment">// ä»sé‡Œæ‰¾t</span></div><div class="line">        <span class="comment">// éå†s</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == t) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == s) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty() || <span class="keyword">null</span> != s)&#123;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != s)&#123;</div><div class="line">                stack.push(s);</div><div class="line">                s = s.left;</div><div class="line">            &#125;</div><div class="line">            s = stack.pop();</div><div class="line">            <span class="keyword">if</span>(s.val == t.val)&#123;</div><div class="line">                <span class="keyword">if</span>(check(s,t)) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">            s = s.right;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯äºŒï¼Œé€’å½’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(TreeNode s, TreeNode t)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == s &amp;&amp; <span class="keyword">null</span> == t) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == s || <span class="keyword">null</span> == t) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  <span class="keyword">if</span>(s.val == t.val)&#123;</div><div class="line">    <span class="keyword">return</span> check(s.left,t.left) &amp;&amp; check(s.right,t.right);</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSubtree</span><span class="params">(TreeNode s, TreeNode t)</span> </span>&#123;</div><div class="line">  <span class="comment">// ä»sé‡Œæ‰¾t</span></div><div class="line">  <span class="comment">// éå†s</span></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == t || <span class="keyword">null</span> == s) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  <span class="keyword">if</span>(s.val == t.val)&#123;</div><div class="line">    <span class="keyword">if</span>(check(s,t))<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> isSubtree(s.left,t) || isSubtree(s.right,t);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Minimum-Depth-of-Binary-Tree">7.11. Minimum Depth of Binary Tree</h2><p>è¿”å›äºŒå‰æ ‘å¶å­ç»“ç‚¹çš„æœ€å°çš„å±‚æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minDepth</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == root) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">  <span class="keyword">int</span> level = <span class="number">1</span>;</div><div class="line">  queue.offer(root);</div><div class="line">  <span class="keyword">while</span> (!queue.isEmpty())&#123;</div><div class="line">    <span class="keyword">int</span> size = queue.size();</div><div class="line">    <span class="keyword">while</span> (size &gt; <span class="number">0</span>)&#123;</div><div class="line">      TreeNode now = queue.poll();</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> == now.right &amp;&amp; <span class="keyword">null</span> == now.left) <span class="keyword">return</span> level;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> != now.left) &#123;queue.offer(now.left);&#125;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> != now.right) &#123;queue.offer(now.right);&#125;</div><div class="line">      --size;</div><div class="line">    &#125;</div><div class="line">    ++level;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> level;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal">7.12. Construct Binary Tree from Preorder and Inorder Traversal</h2><p>ç”¨å‰åº+ä¸­åºæ¢å¤äºŒå‰æ ‘</p>
<h1 id="åˆ†æ²»ç›¸å…³ä¾‹é¢˜">8. åˆ†æ²»ç›¸å…³ä¾‹é¢˜</h1><h2 id="ä¾‹é¢˜1ï¼ŒMaximum-Depth-of-Binary-Tree">8.1. ä¾‹é¢˜1ï¼ŒMaximum Depth of Binary Tree</h2><p>æ±‚äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</p>
<p><strong>æ–¹æ³•ä¸€ï¼Œéå†</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">//ä»rootå‡ºå‘,rootå½“å‰æ·±åº¦æ˜¯1</span></div><div class="line">helper(root,<span class="number">1</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(TreeNode root, <span class="keyword">int</span> depth)</span></span>&#123;</div><div class="line">  <span class="comment">//èµ°è¿‡å¤´äº†</span></div><div class="line">  <span class="keyword">if</span>( root == <span class="keyword">null</span> )&#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  max = Math.max(max,depth);</div><div class="line">  helper(root.left, depth + <span class="number">1</span> );</div><div class="line">  helper(root.right, depth + <span class="number">1</span> )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2ï¼Œåˆ†æ²»</strong></p>
<p>æ²¡æœ‰å…¨å±€å˜é‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( root == <span class="keyword">null</span> )&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> leftDepth = maxDepth(root.left);</div><div class="line">  <span class="keyword">int</span> rightDepth = maxDepth(root.right);</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> Math.max(leftDepth,rightDepth) + <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜2ï¼ŒBalanced-Binary-Tree">8.2. ä¾‹é¢˜2ï¼ŒBalanced Binary Tree</h2><p>åˆ¤æ–­ä¸€ä¸ªæ ‘æ˜¯ä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å½“ä¸€ä¸ªç»“æœæœ‰å¤šä¸ªå‚æ•°å†³å®šæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªclass</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultType</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">boolean</span> isBalanced;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">int</span> maxDepth;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ResultType</span><span class="params">(<span class="keyword">boolean</span> isBalanced, <span class="keyword">int</span> maxDepth)</span></span>&#123;</div><div class="line">    <span class="keyword">this</span>.isBalanced = isBalanced;</div><div class="line">    <span class="keyword">this</span>.maxDepth = maxDepth;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸»å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isBalanced</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> helper(root).isBalanced;</div><div class="line">&#125;</div><div class="line"><span class="comment">// åˆ†æ²»</span></div><div class="line"><span class="function"><span class="keyword">private</span> ResultType <span class="title">helper</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == root)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResultType(<span class="keyword">true</span>,<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line">  ResultType left = helper(root.left);</div><div class="line">  ResultType right = helper(root.right);</div><div class="line">  </div><div class="line">  <span class="comment">// å­æ ‘ä¸å¹³è¡¡</span></div><div class="line">  <span class="keyword">if</span>(!left.isBalanced || !right.isBalanced)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResultType(<span class="keyword">false</span>,-<span class="number">1</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// rootä¸å¹³è¡¡</span></div><div class="line">  <span class="keyword">if</span>(Math.abs(left.maxDepth - right.maxDepth) &gt; <span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResultType(<span class="keyword">false</span>,-<span class="number">1</span>);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ResultType(<span class="keyword">true</span>,Math.max(left.maxDepth , right.maxDepth) + <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§è§£æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == root) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">int</span> leftDepth = helper(root.left);</div><div class="line">  <span class="keyword">if</span>(leftDepth == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">  <span class="keyword">int</span> rightDepth = helper(root.right);</div><div class="line">  <span class="keyword">if</span>(rightDepth == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">  <span class="keyword">if</span>(Math.abs(leftDepth-rightDepth)&gt;<span class="number">1</span>)<span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">  <span class="keyword">return</span> Math.max(leftDepth,rightDepth) + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isBalanced</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> helper(root)!=-<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜3ï¼ŒLowest-Common-Ancestor">8.3. ä¾‹é¢˜3ï¼ŒLowest Common Ancestor</h2><p>æ±‚ä¸€é¢—äºŒå‰æ ‘ä¸­ä¸¤ä¸ªç‚¹a,bçš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</p>
<p> åœ¨rootä¸ºæ ¹çš„äºŒå‰æ ‘ä¸­ï¼Œä»ä¸Šåˆ°ä¸‹å¯»æ‰¾A,Bçš„LCA:</p>
<ul>
<li>å¦‚æœæ‰¾åˆ°äº†å°±è¿”å›è¿™ä¸ªLCA</li>
<li>å¦‚æœåªç¢°åˆ°Aï¼Œå°±è¿”å›A</li>
<li>å¦‚æœåªç¢°åˆ°Bï¼Œå°±è¿”å›B</li>
<li>å¦‚æœéƒ½æ²¡æœ‰ï¼Œå°±è¿”å›null</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode root, TreeNode nodel1, TreeNode node2)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(root == <span class="keyword">null</span> || root == node1 || root == node2)&#123;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// åˆ†è§£é—®é¢˜</span></div><div class="line">  TreeNode left = lowestCommonAncestor(root.left, node1, node2);</div><div class="line">  TreeNode right = lowestCommonAncestor(root.right, node1, node2);</div><div class="line">  </div><div class="line">  <span class="comment">// åˆå¹¶é—®é¢˜</span></div><div class="line">  <span class="keyword">if</span>(left != <span class="keyword">null</span> &amp;&amp; right != <span class="keyword">null</span>)&#123; <span class="comment">// leftä¸­å«æœ‰n1æˆ–n2,rightä¹Ÿå«æœ‰</span></div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(right != <span class="keyword">null</span>)&#123; <span class="comment">// rightä¸­å«æœ‰n1æˆ–n2,leftä¸å«</span></div><div class="line">    <span class="keyword">return</span> right;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(left != <span class="keyword">null</span>)&#123; <span class="comment">// leftä¸­å«æœ‰n1æˆ–n2,rightä¸å«</span></div><div class="line">    <span class="keyword">return</span> left;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ€è·¯ï¼Œç»Ÿè®¡æœ¬èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸­æœ‰å‡ ä¸ªå‘½ä¸­èŠ‚ç‚¹<br>å¦‚æœç­‰äºä¸¤ä¸ªï¼Œåˆ™æœ¬èŠ‚ç‚¹æ˜¯å…¬å…±ç¥–å…ˆï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">TreeNode result;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(TreeNode root, TreeNode p,TreeNode q)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">  <span class="keyword">if</span>( <span class="keyword">null</span> == root || <span class="keyword">null</span> != result) <span class="keyword">return</span> counter;</div><div class="line">  <span class="keyword">if</span>( root == p ) &#123;</div><div class="line">    counter += <span class="number">1</span>;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( root == q ) &#123;</div><div class="line">    counter += <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>( counter == <span class="number">2</span> )&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == result)result = root;</div><div class="line">    <span class="keyword">return</span> counter;</div><div class="line">  &#125;</div><div class="line">  counter += helper(root.right,p,q);</div><div class="line">  <span class="keyword">if</span>( counter == <span class="number">2</span> )&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == result)result = root;</div><div class="line">    <span class="keyword">return</span> counter;</div><div class="line">  &#125;</div><div class="line">  counter += helper(root.left,p,q);</div><div class="line">  <span class="keyword">if</span>( counter == <span class="number">2</span> )&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == result)result = root;</div><div class="line">    <span class="keyword">return</span> counter;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> counter;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode root, TreeNode p, TreeNode q)</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">int</span> counter = helper(root,p,q);</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜4ï¼ŒLowest-Common-Ancestor-II">8.4. ä¾‹é¢˜4ï¼ŒLowest Common Ancestor II</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">åœ¨rootä¸ºè·Ÿçš„äºŒå‰æ ‘ä¸­æ‰¾n1,n2çš„LCA</div><div class="line">å¦‚æœæ‰¾åˆ°äº†å°±è¿”å›</div><div class="line">å¦‚æœåªç¢°åˆ°äº†n1,å°±è¿”å›n1</div><div class="line">å¦‚æœåªç¢°åˆ°äº†n2,å°±è¿”å›n2</div><div class="line">å¦‚æœéƒ½æ²¡æœ‰ï¼Œå°±è¿”å›Null</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜5ï¼ŒBinary-Tree-Maximum-Path-Sum-II">8.5. ä¾‹é¢˜5ï¼ŒBinary Tree Maximum Path Sum II</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾åˆ°ä»rootçš„æœ€å¤§è·¯å¾„å’Œã€‚è·¯å¾„å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«ç»“æŸæ‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">   <span class="number">1</span></div><div class="line">  / \</div><div class="line"> <span class="number">2</span>   <span class="number">3</span></div><div class="line">      \</div><div class="line">       -<span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">return</span> <span class="number">4</span></div><div class="line"></div><div class="line">æ€è·¯ï¼šæŸä¸ªç‚¹çš„æœ€å¤§é•¿åº¦ = Math.max(<span class="number">0</span>,sum)</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜6ï¼ŒBinary-Tree-Maximum-Path-Sum">8.6. ä¾‹é¢˜6ï¼ŒBinary Tree Maximum Path Sum</h2><p>ç»™ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾åˆ°ä»any node åˆ° any nodeæœ€å¤§è·¯å¾„å’Œã€‚è·¯å¾„å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«ç»“æŸæ‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">  -<span class="number">1</span></div><div class="line">  / \</div><div class="line"> <span class="number">2</span>   <span class="number">3</span></div><div class="line">      \</div><div class="line">       -<span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">return</span> <span class="number">3</span></div><div class="line"></div><div class="line">æ€è·¯ï¼šä¸¤ä¸ªåˆ†æ²»</div><div class="line"></div><div class="line">è¦æ±‚æ•´ä¸ªäºŒå‰æ ‘çš„æœ€é•¿è·¯å¾„ï¼Œå…ˆæ±‚å·¦å­æ ‘çš„æœ€é•¿è·¯å¾„ï¼Œå†æ±‚å³å­æ ‘çš„æœ€é•¿è·¯å¾„ã€‚</div><div class="line"></div><div class="line">æ•´æ£µæ ‘çš„æœ€é•¿è·¯å¾„ï¼ˆä»¥ä¸Šå›¾ä¸ºä¾‹ï¼‰ï¼š</div><div class="line"><span class="number">1</span>. æœ‰å¯èƒ½å…¨åœ¨å·¦è¾¹ï¼ˆåªæœ‰<span class="number">2</span>ï¼‰</div><div class="line"><span class="number">2</span>. æœ‰å¯èƒ½å…¨åœ¨å³è¾¹ï¼ˆåªæœ‰<span class="number">3</span>ï¼‰</div><div class="line"><span class="number">3</span>. å¯èƒ½è·¨è¿‡rootèŠ‚ç‚¹ï¼ˆæœ‰-<span class="number">1</span>ã€<span class="number">2</span>ã€<span class="number">3</span>ï¼‰</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultType</span></span>&#123;</div><div class="line"> <span class="keyword">int</span> root2This, any2This;</div><div class="line"> ResultType(<span class="keyword">int</span> root2This, <span class="keyword">int</span> any2This)&#123;</div><div class="line">   <span class="keyword">this</span>.root2This = root2This; </div><div class="line">   <span class="keyword">this</span>.any2This = any2This;</div><div class="line"> &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ResultType <span class="title">helper</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">  <span class="comment">// illegal</span></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> == root)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResultType(Integer.MIN_VALUE,Integer.MIN_VALUE);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// åˆ†è§£é—®é¢˜</span></div><div class="line">  ResultType left = helper(root.left);</div><div class="line">  ResultType right = helper(root.right);</div><div class="line">  </div><div class="line">  <span class="comment">// åˆå¹¶é—®é¢˜</span></div><div class="line">  <span class="comment">// ä¸ºäº†æ–¹ä¾¿ä¹‹åçš„ç¬¬3æ­¥è®¡ç®—ï¼ˆä¸ºäº†è§£å†³any2thisï¼Œä¸€å®šè¦ç®—å‡ºroot2thisï¼‰</span></div><div class="line">  <span class="keyword">int</span> root2This = Math.max(<span class="number">0</span>,Math.max(left.root2This, right.root2This)) + root.val;</div><div class="line">  </div><div class="line">  <span class="comment">// 1ã€2. rootåˆ°è¿™ä¸ªèŠ‚ç‚¹çš„æœ€å¤§sum</span></div><div class="line">  <span class="comment">// å…¨åœ¨å·¦è¾¹æˆ–è€…å…¨åœ¨å³è¾¹ï¼ˆå¯ä»¥ä¸åŒ…å«rootï¼‰</span></div><div class="line">  <span class="keyword">int</span> any2This = Math.max(left.any2This, right.any2This);</div><div class="line">  <span class="comment">// 3. anyåˆ°è¿™ä¸ªèŠ‚ç‚¹çš„æœ€å¤§sum</span></div><div class="line">  <span class="comment">// è·¨è¿‡äº†rootç‚¹ï¼ˆä¸€å®šæ˜¯rootåˆ°leftæˆ–rightçš„è·¯å¾„ï¼‰</span></div><div class="line">  any2This = Math.max(any2This,</div><div class="line">                     Math.max(<span class="number">0</span>, left.root2This)</div><div class="line">                     + Math.max(<span class="number">0</span>, right.root2This)</div><div class="line">                     + root.val);</div><div class="line">                     </div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Result(root2This, any2This);</div><div class="line">&#125;</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="comment">// int[0] - &gt; any 2 any</span></div><div class="line"><span class="comment">// int[1] --&gt; end 2 this</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] helper(TreeNode node) &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == node) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">9999999</span>,-<span class="number">9999999</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] left = helper(node.left);</div><div class="line">        <span class="keyword">int</span>[] right = helper(node.right);</div><div class="line">        <span class="comment">// ä»æœ¬èŠ‚ç‚¹å‘ä¸‹çš„æŸä¸ªèŠ‚ç‚¹æˆªæ­¢</span></div><div class="line">        <span class="keyword">int</span> down2This = Math.max(</div><div class="line">                Math.max(left[<span class="number">1</span>] + node.val,</div><div class="line">                        right[<span class="number">1</span>] + node.val),</div><div class="line">                node.val</div><div class="line">        );</div><div class="line">        <span class="comment">// è·¨è¶ŠnodeèŠ‚ç‚¹</span></div><div class="line">        <span class="keyword">int</span> twoside = left[<span class="number">1</span>] + node.val + right[<span class="number">1</span>];</div><div class="line">        <span class="comment">// å…¨åœ¨å·¦å­æ ‘æˆ–å…¨åœ¨å³å­æ ‘</span></div><div class="line">        <span class="keyword">int</span> oneside  = Math.max(left[<span class="number">0</span>],right[<span class="number">0</span>]);</div><div class="line">        <span class="comment">// ä¸‰è€…æ±‚æœ€å¤§</span></div><div class="line">        <span class="keyword">int</span> any2This = Math.max(down2This,Math.max(oneside,twoside));</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;any2This,down2This&#125;;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxPathSum</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">     <span class="keyword">return</span> helper(root)[<span class="number">0</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§éªšæ“ä½œï¼Œåªè®°å½•ã€æœ¬èŠ‚ç‚¹ã€‘åˆ°ã€ä¸‹æ–¹èŠ‚ç‚¹ã€‘çš„æœ€å¤§å’Œï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> max = Integer.MIN_VALUE; <span class="comment">// å…¨å±€æœ€å¤§</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxPathSum</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  traverse(root);</div><div class="line">  <span class="keyword">return</span> max;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">traverse</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">int</span> left = traverse(root.left);</div><div class="line">  <span class="keyword">int</span> right = traverse(root.right);</div><div class="line">  max = Math.max(max, Math.max(left, <span class="number">0</span>) + Math.max(right, <span class="number">0</span>) + root.val);</div><div class="line">  <span class="keyword">return</span> Math.max(<span class="number">0</span>, Math.max(left, right)) + root.val;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Invert-Binary-Tree">8.7. Invert Binary Tree</h2><p>å°†äºŒå‰æ ‘é•œåƒåè½¬ï¼ˆå·¦å³æ›¿æ¢ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">invertTree</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">     <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">     TreeNode left = invertTree(root.left);</div><div class="line">     TreeNode right = invertTree(root.right);</div><div class="line">     root.left = right;</div><div class="line">     root.right = left;</div><div class="line">     <span class="keyword">return</span> root;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h1 id="äºŒå‰æœç´¢æ ‘">9. äºŒå‰æœç´¢æ ‘</h1><h2 id="BSTå®šä¹‰">9.1. BSTå®šä¹‰</h2><p><strong>å®šä¹‰</strong></p>
<ul>
<li>å·¦å­æ ‘æ¯”æ ¹èŠ‚ç‚¹å°</li>
<li>å³å­æ ‘æ¯”æ ¹èŠ‚ç‚¹å¤§<ul>
<li>å¦‚æœæœ‰é‡å¤ï¼Œå¯ä»¥å…¨éƒ¨æ”¾åœ¨å·¦/å³</li>
</ul>
</li>
</ul>
<p><strong>æ•ˆæœ</strong></p>
<ul>
<li>ä¸­åºéå†æ˜¯å‡åºåºåˆ—</li>
</ul>
<p><strong>æ€§è´¨</strong></p>
<ul>
<li>å¦‚æœä¸€é¢—äºŒå‰æ ‘ä¸­åºä¸æ˜¯å‡åºï¼Œåˆ™ä¸€å®šä¸æ˜¯BST</li>
<li>å¦‚æœä¸€é¢—äºŒå‰æ ‘ä¸­åºæ˜¯å‡åºï¼Œåˆ™ä¸ä¸€å®šæ˜¯BST</li>
</ul>
<h2 id="åˆ é™¤">9.2. åˆ é™¤</h2><p>æœ¬èŠ‚ä¸»è¦å‚è€ƒè‡ªï¼š<a href="http://blog.csdn.net/cyp331203/article/details/42609387" target="_blank" rel="external">ã€ç®—æ³•å¯¼è®ºã€‘äºŒå‰æœç´¢æ ‘çš„æ’å…¥å’Œåˆ é™¤</a></p>
<p>ä»ä¸€ä¸ªäºŒå‰æœç´¢æ ‘ä¸­åˆ é™¤ä¸€ä¸ªç»“ç‚¹ï¼Œä¼šæœ‰ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><p>å¦‚æœzæ²¡æœ‰å­©å­èŠ‚ç‚¹ï¼Œå°±ç›´æ¥åˆ é™¤ï¼Œå¹¶ä¿®æ”¹å®ƒçš„çˆ¶èŠ‚ç‚¹ï¼Œç”¨nullä½œä¸ºå®ƒçš„å­©å­ï¼›</p>
</li>
<li><p>å¦‚æœzåªæœ‰ä¸€ä¸ªå­©å­ï¼Œå°±å°†è¿™ä¸ªå­©å­æå‡åˆ°æ ‘ä¸­zçš„ä½ç½®ä¸Šï¼Œå¹¶ä¿®æ”¹zçš„çˆ¶èŠ‚ç‚¹ï¼Œç”¨zçš„å­©å­æ¥æ›¿æ¢zï¼›</p>
</li>
<li><p>å¦‚æœzæœ‰ä¸¤ä¸ªå­©å­ï¼Œé‚£ä¹ˆå¯ä»¥å¯»æ‰¾èŠ‚ç‚¹çš„åç»§ï¼ˆä¸­åºéå†æ—¶çš„ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼‰ã€‚åˆ é™¤æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰¾åˆ°è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ä¸­çš„æœ€å·¦å­©å­ï¼ˆä¹Ÿå°±æ˜¯å³å­æ ‘ä¸­åºéå†çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰</li>
<li>æŠŠå®ƒçš„å€¼å’Œè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å€¼è¿›è¡Œäº¤æ¢</li>
<li>ç„¶ååˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼ˆå…¶å®å°±æ˜¯ç”¨è¿™ä¸ªèŠ‚ç‚¹çš„å³å­æ ‘æ›¿æ¢è¿™ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªèŠ‚ç‚¹æ­¤æ—¶å·²ç»è‚¯å®šæ²¡æœ‰å·¦å­æ ‘äº†ï¼‰</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-11-14-07-43.png" alt=""> </p>
</li>
</ul>
<p>ä»£ç è§åé¢çš„é¢˜- Delete Node in a BST</p>
<h2 id="Validate-Binary-Search-Tree">9.3. Validate Binary Search Tree</h2><p>éªŒè¯ä¸€ä¸ªäºŒå‰æ ‘æ˜¯ä¸æ˜¯æœç´¢äºŒå‰æ ‘ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">BSTæœ‰ä¸€ä¸ªæ€§è´¨â€”â€”å¦‚æœä¸€ä¸ªäºŒå‰æ ‘çš„ä¸­åºéå†æ˜¯ä¸¥æ ¼é€’å¢çš„ï¼Œåˆ™è¿™ä¸ªäºŒå‰æ ‘ä¸€å®šæ˜¯BST.</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValidBST</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">  Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">  <span class="keyword">long</span> last = Long.MIN_VALUE;</div><div class="line">  <span class="keyword">while</span> (!stack.isEmpty() || <span class="keyword">null</span> != root)&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">      stack.push(root);</div><div class="line">      root = root.left;</div><div class="line">    &#125;</div><div class="line">    root = stack.pop();</div><div class="line">    <span class="keyword">if</span>(last &lt; root.val)&#123;</div><div class="line">      last = root.val;</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    root = root.right;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Binary-search-Tree-Iterator">9.4. Binary search Tree Iterator</h2><p>ä¸­åºéå†ã€‚è¦ä¸€ä¸ªç»™ä¸€ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Definition for binary tree</div><div class="line"> * public class TreeNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     TreeNode left;</div><div class="line"> *     TreeNode right;</div><div class="line"> *     TreeNode(int x) &#123; val = x; &#125;</div><div class="line"> * &#125;</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BSTIterator</span> </span>&#123;</div><div class="line">    Stack&lt;TreeNode&gt; stack;</div><div class="line">    TreeNode root;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BSTIterator</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.root = root;</div><div class="line">        stack= <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** <span class="doctag">@return</span> whether we have a next smallest number */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span>!stack.isEmpty() || <span class="keyword">null</span> != root;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** <span class="doctag">@return</span> the next smallest number */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">next</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">            stack.push(root);</div><div class="line">            root = root.left;</div><div class="line">        &#125;</div><div class="line">        root = stack.pop();</div><div class="line">        <span class="keyword">int</span> result =root.val ;</div><div class="line">        root = root.right;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Your BSTIterator will be called like this:</div><div class="line"> * BSTIterator i = new BSTIterator(root);</div><div class="line"> * while (i.hasNext()) v[f()] = i.next();</div><div class="line"> */</div></pre></td></tr></table></figure>
<h2 id="Convert-Sorted-Array-to-Binary-Search-Tree">9.5. Convert Sorted Array to Binary Search Tree</h2><p>å°†æœ‰åºæ•°ç»„è½¬åŒ–ä¸ºå¹³è¡¡äºŒå‰æ ‘</p>
<p>æ€è·¯ï¼šå¹³è¡¡äºŒå‰æ ‘çš„rootä¸€å®šæ˜¯æœ‰åºæ•°ç»„çš„ä¸­ç‚¹ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(end &lt; start) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">       <span class="keyword">int</span> mid = start + (end - start)/<span class="number">2</span>;</div><div class="line">       TreeNode root = <span class="keyword">new</span> TreeNode(nums[mid]);</div><div class="line">       root.left = helper(nums,start,mid - <span class="number">1</span>);</div><div class="line">       root.right = helper(nums,mid + <span class="number">1</span> ,end);</div><div class="line">       <span class="keyword">return</span> root;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> TreeNode <span class="title">sortedArrayToBST</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span>(nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">       <span class="keyword">return</span> helper(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Convert-Sorted-List-to-Binary-Search-Tree">9.6. Convert Sorted List to Binary Search Tree</h2><p>å°†æœ‰åºé“¾è¡¨è½¬åŒ–ä¸ºå¹³è¡¡äºŒå‰æ ‘</p>
<p>è¿™é“é¢˜æ€è·¯å®åœ¨æ˜¯å¤ªéªšæ°”äº†</p>
<p>æˆ‘ä»¬æ¢ä¸€ä¸ªæ€è·¯å¯èƒ½å°±ä¼šç®€å•å¾ˆå¤šï¼Œå³å¦‚æœæ˜¯å°†ä¸€ä¸ªæ’åºäºŒå‰æ ‘è½¬æ¢æˆé“¾è¡¨ï¼Œæ— éæ˜¯ä¸€ä¸ªä¸­åºéå†ã€‚</p>
<p>é‚£ä¹ˆï¼Œè¿™é‡Œè®²é“¾è¡¨è½¬æ¢æˆäºŒå‰æ ‘ä¹Ÿæ˜¯ä¸€æ ·çš„æ€è·¯ï¼Œå³ä¸€ä¸ªä¸­åºéå†ï¼Œå…¶å…·ä½“æ€è·¯å¦‚ä¸‹ã€‚</p>
<p>æŒ‰ç…§ä¸­åºéå†çš„æ€è·¯ï¼Œåº”è¯¥å…ˆç”Ÿæˆå·¦å­æ ‘ï¼Œç„¶åæ˜¯æ ¹èŠ‚ç‚¹ï¼Œæœ€åçš„å³å­æ ‘ã€‚ä»¥è¿™æ ·çš„é¡ºåºï¼Œæ¯æ¬¡æ–°åˆ›å»ºçš„èŠ‚ç‚¹éƒ½å¯¹åº”é“¾è¡¨çš„é¡ºåºéå†ä¸­å½“å‰ä½ç½®çš„èŠ‚ç‚¹ã€‚</p>
<p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªé€’å½’çš„ç»“æ„ã€‚é‚£ä¹ˆå‰©ä¸‹çš„é—®é¢˜å°±æ˜¯å¦‚ä½•ç¡®å®šé€’å½’çš„ç»ˆæ­¢æ¡ä»¶ã€‚</p>
<p>å› ä¸ºåœ¨è½¬æ¢çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¡ç®—å„å­é“¾è¡¨çš„é•¿åº¦ï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥ç”±æ­¤æ¥ç»ˆæ­¢é€’å½’ï¼Œå³å½“é•¿åº¦ç­‰äº0æ—¶ç»ˆæ­¢ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLength</span><span class="params">(ListNode head)</span></span>&#123;</div><div class="line">       <span class="keyword">int</span> length = <span class="number">0</span>;</div><div class="line">       <span class="keyword">while</span> (<span class="keyword">null</span> != head)&#123;</div><div class="line">           head = head.next;</div><div class="line">           ++length;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> length;</div><div class="line">   &#125;</div><div class="line">   ListNode curr;</div><div class="line">   <span class="function"><span class="keyword">public</span> TreeNode <span class="title">sortedListToBST</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> size = getLength(head);</div><div class="line">       curr = head;</div><div class="line">       <span class="keyword">return</span> helper(size);</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> TreeNode <span class="title">helper</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(size == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">       TreeNode left = helper(size / <span class="number">2</span>);</div><div class="line">       TreeNode root = <span class="keyword">new</span> TreeNode(curr.val);</div><div class="line">       curr = curr.next;</div><div class="line">       root.left = left;</div><div class="line">       root.right = helper(size - size / <span class="number">2</span> - <span class="number">1</span>);</div><div class="line">       <span class="keyword">return</span>  root;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Delete-Node-in-a-BST">9.7. Delete Node in a BST</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">deleteNode</span><span class="params">(TreeNode root, <span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == root)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        TreeNode dummy = <span class="keyword">new</span> TreeNode(<span class="number">0</span>);</div><div class="line">        <span class="keyword">if</span>(root.val &lt; <span class="number">0</span>)&#123;dummy.left = root;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;dummy.right = root;&#125;</div><div class="line">        TreeNode parent = dummy;</div><div class="line">        TreeNode child = root;</div><div class="line">        <span class="keyword">while</span> (<span class="keyword">null</span> != child)&#123;</div><div class="line">            <span class="keyword">if</span>(child.val == key)&#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(child.val &lt; key)&#123;</div><div class="line">                parent = child;</div><div class="line">                child = child.right;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                parent = child;</div><div class="line">                child = child.left;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == child)&#123;</div><div class="line">            <span class="keyword">return</span> root;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == child.left)&#123;</div><div class="line">            <span class="keyword">if</span>(child.val &lt; parent.val)&#123;</div><div class="line">                parent.left = child.right;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                parent.right = child.right;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> == child.right)&#123;</div><div class="line">            <span class="keyword">if</span>(child.val &lt; parent.val)&#123;</div><div class="line">                parent.left = child.left;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                parent.right = child.left;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123; <span class="comment">// éƒ½ä¸ä¸ºç©º</span></div><div class="line">            <span class="comment">// æ‰¾åˆ°è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ä¸­çš„æœ€å·¦å­©å­</span></div><div class="line">            TreeNode afterParent = child;</div><div class="line">            TreeNode after = child.right;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != after.left)&#123;</div><div class="line">                afterParent = after;</div><div class="line">                after = after.left;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// æŠŠå®ƒçš„å€¼ä¸åˆ é™¤çš„èŠ‚ç‚¹çš„å€¼è¿›è¡Œäº¤æ¢</span></div><div class="line">            <span class="keyword">int</span> temp = after.val;</div><div class="line">            after.val = child.val;</div><div class="line">            child.val = temp;</div><div class="line">            <span class="comment">// åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹</span></div><div class="line">            <span class="keyword">if</span>(temp &lt; afterParent.val)&#123;</div><div class="line">                afterParent.left = after.right;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                afterParent.right = after.right;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> != dummy.left)&#123;</div><div class="line">            <span class="keyword">return</span> dummy.left;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> dummy.right;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§é€’å½’å†™æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> TreeNode <span class="title">deleteNode</span><span class="params">(TreeNode root, <span class="keyword">int</span> key)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">       </div><div class="line">       <span class="keyword">if</span> (root.val &gt; key) &#123;</div><div class="line">           root.left = deleteNode(root.left, key);</div><div class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (root.val &lt; key) &#123;</div><div class="line">           root.right = deleteNode(root.right, key);</div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           <span class="keyword">if</span> (root.left == <span class="keyword">null</span>) <span class="keyword">return</span> root.right;</div><div class="line">           <span class="keyword">if</span> (root.right == <span class="keyword">null</span>) <span class="keyword">return</span> root.left;</div><div class="line">           </div><div class="line">           TreeNode rightSmallest = root.right;</div><div class="line">           <span class="keyword">while</span> (rightSmallest.left != <span class="keyword">null</span>) rightSmallest = rightSmallest.left;</div><div class="line">           rightSmallest.left = root.left;</div><div class="line">           <span class="keyword">return</span> root.right;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> root;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Find-Mode-in-Binary-Search-Tree">9.8. Find Mode in Binary Search Tree</h2><p>ç»™ä¸€ä¸ªæœ‰é‡çš„BSTã€‚å…¶ä¸­å·¦å­æ ‘å°äºç­‰äºæœ¬èº«ï¼Œå³å­æ ‘å¤§äºæœ¬èº«ã€‚ç»Ÿè®¡æœ€å¤šæ¬¡æ•°å‡ºç°çš„æ•°å­—ã€‚</p>
<p>æ€è·¯ï¼šä¸­åºéå†è®¡æ•°å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> maxCount;</div><div class="line">    List&lt;Integer&gt; set;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] findMode(TreeNode root) &#123;</div><div class="line">        maxCount = <span class="number">0</span>;</div><div class="line">        set = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> preVal = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">int</span> preCount = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (!stack.isEmpty() || <span class="keyword">null</span> != root)&#123;</div><div class="line">            <span class="keyword">while</span> (<span class="keyword">null</span> != root)&#123;</div><div class="line">                stack.push(root);</div><div class="line">                root = root.left;</div><div class="line">            &#125;</div><div class="line">            root = stack.pop();</div><div class="line">            <span class="keyword">if</span>(root.val == preVal)&#123;</div><div class="line">                ++preCount;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                preVal = root.val;</div><div class="line">                preCount = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(preCount &gt; maxCount)&#123;</div><div class="line">                set.clear();</div><div class="line">                set.add(preVal);</div><div class="line">                maxCount = preCount;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(preCount == maxCount)&#123;</div><div class="line">                set.add(preVal);</div><div class="line">            &#125;</div><div class="line">            root = root.right;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[set.size()];</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e : set)&#123;</div><div class="line">            res[i] = e;</div><div class="line">            ++i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰å¾ˆå¤šç›¸å…³é¢˜ã€‚</p>
<h1 id="å®Œå…¨äºŒå‰æ ‘">10. å®Œå…¨äºŒå‰æ ‘</h1><h2 id="Count-Complete-Tree-Nodes">10.1. Count Complete Tree Nodes</h2><p>æ±‚å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚</p>
<p>ä¸€å¼€å§‹å°±æš´åŠ›æ•°ï¼Œå½“ç„¶æ˜¯è¶…æ—¶äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ç§å‚è€ƒç½‘ä¸Šçš„å·§å¦™çš„è§£æ³•ã€‚ä¸»è¦æ˜¯äºŒåˆ† + ä½æ“ä½œ $2^n = n &lt;&lt; 1$</p>
<p>å®Œå…¨äºŒå‰æ ‘çš„ä¸€ä¸ªæ€§è´¨æ˜¯ï¼Œå¦‚æœå·¦å­æ ‘æœ€å·¦è¾¹çš„æ·±åº¦ï¼Œç­‰äºå³å­æ ‘æœ€å³è¾¹çš„æ·±åº¦ï¼Œè¯´æ˜è¿™ä¸ªäºŒå‰æ ‘æ˜¯æ»¡çš„ï¼Œå³æœ€åä¸€å±‚ä¹Ÿæ˜¯æ»¡çš„ï¼Œåˆ™ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘å…¶èŠ‚ç‚¹ä¸€å…±æœ‰<code>2^h-1</code>ä¸ªã€‚å¦‚æœä¸ç­‰äºï¼Œåˆ™æ˜¯å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼ŒåŠ ä¸Šå³å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼ŒåŠ ä¸Šè‡ªèº«è¿™ä¸€ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">LeftLevel</span><span class="params">(TreeNode node)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> + LeftLevel(node.left);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">rightLevel</span><span class="params">(TreeNode node)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> + rightLevel(node.right);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(TreeNode node)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> leftLevel = LeftLevel(node.left) + <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> rightLevel = rightLevel(node.right) + <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(leftLevel == rightLevel)&#123; <span class="comment">// æ»¡äºŒå‰æ ‘èŠ‚ç‚¹ä¸ªæ•° = 2^n - 1</span></div><div class="line">            <span class="comment">//System.out.println(node.val + "\t" + leftLevel + "\t" + ((leftLevel &lt;&lt; 1) - 1));</span></div><div class="line">            <span class="keyword">return</span>  (<span class="number">1</span> &lt;&lt; leftLevel) - <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> nodeNums = helper(node.left) + helper(node.right) + <span class="number">1</span>;</div><div class="line">        <span class="comment">//System.out.println(node.val + "\t" + leftLevel + "\t" + nodeNums);</span></div><div class="line">        <span class="keyword">return</span> nodeNums;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(root);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™å…¶ä¸­æ˜¯å­˜åœ¨é‡å¤è®¡ç®—çš„ã€‚åŒä¸€ä¸ªèŠ‚ç‚¹çš„æ•°é«˜åº¦å¯èƒ½è¢«è®¡ç®—å¤šæ¬¡ã€‚ä¸‹é¢è¿™ç§è§£æ³•å·§å¦™åœ°é¿å¼€äº†é‡å¤è®¡ç®—ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> countNodes(root, -<span class="number">1</span>, -<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode root, <span class="keyword">int</span> lheight, <span class="keyword">int</span> rheight)</span></span>&#123;</div><div class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰ä¸Šè½®è®¡ç®—å¥½çš„å·¦å­æ ‘æ·±åº¦ï¼Œè®¡ç®—å…¶æ·±åº¦</span></div><div class="line">        <span class="keyword">if</span>(lheight == -<span class="number">1</span>)&#123;</div><div class="line">            lheight = <span class="number">0</span>;</div><div class="line">            TreeNode curr = root;</div><div class="line">            <span class="keyword">while</span>(curr != <span class="keyword">null</span>)&#123;</div><div class="line">                lheight++;</div><div class="line">                curr = curr.left;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰ä¸Šè½®è®¡ç®—å¥½çš„å³å­æ ‘æ·±åº¦ï¼Œè®¡ç®—å…¶æ·±åº¦</span></div><div class="line">        <span class="keyword">if</span>(rheight == -<span class="number">1</span>)&#123;</div><div class="line">            rheight = <span class="number">0</span>;</div><div class="line">            TreeNode curr = root;</div><div class="line">            <span class="keyword">while</span>(curr != <span class="keyword">null</span>)&#123;</div><div class="line">                rheight++;</div><div class="line">                curr = curr.right;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¦‚æœä¸¤ä¸ªæ·±åº¦ä¸€æ ·ï¼Œè¿”å›2^h-1</span></div><div class="line">        <span class="keyword">if</span>(lheight == rheight) <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; lheight) - <span class="number">1</span>;</div><div class="line">        <span class="comment">// å¦åˆ™è¿”å›å·¦å­æ ‘å³å­æ ‘èŠ‚ç‚¹å’ŒåŠ 1</span></div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> + countNodes(root.left, lheight - <span class="number">1</span>, -<span class="number">1</span>) + countNodes(root.right, -<span class="number">1</span>, rheight - <span class="number">1</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>éªšæ“ä½œ</strong></p>
<p>è¿˜æœ‰ä¸€ç§æ“ä½œï¼š</p>
<p>ç”¨è¿­ä»£æ³•çš„æ€è·¯ç¨å¾®æœ‰ç‚¹ä¸åŒï¼Œå› ä¸ºä¸å†æ˜¯é€’å½’ä¸­é‚£æ ·çš„åˆ†æ²»æ³•ï¼Œæˆ‘ä»¬è¿­ä»£åªæœ‰ä¸€æ¡æ­£ç¡®çš„å‰è¿›æ–¹å‘ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ¤æ–­çš„æ—¶å·¦èŠ‚ç‚¹çš„æœ€ã€å·¦ã€‘è¾¹çš„æ·±åº¦ï¼Œå’Œå³èŠ‚ç‚¹çš„æœ€ã€å·¦ã€‘è¾¹æ·±åº¦ã€‚å› ä¸ºæœ€åä¸€å±‚ç»“æŸçš„åœ°æ–¹è‚¯å®šåœ¨é å·¦çš„é‚£ä¾§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾çš„å°±æ˜¯è¿™ä¸ªç»“æŸç‚¹ã€‚å¦‚æœä¸¤ä¸ªæ·±åº¦ç›¸åŒï¼Œè¯´æ˜å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯æ»¡ï¼Œç»“æŸç‚¹åœ¨å³ä¾§ï¼Œå¦‚æœå³å­æ ‘ç®—å‡ºçš„æœ€å·¦æ·±åº¦è¦å°ä¸€ç‚¹ï¼Œè¯´æ˜ç»“æŸç‚¹åœ¨å·¦è¾¹ï¼Œå³è¾¹å·²ç»æ˜¯æ®‹ç¼ºçš„äº†ã€‚æ ¹æ®è¿™ä¸ªå¤§å°å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæ¯ä¸€å±‚çš„èµ°å‘ï¼Œæœ€åæ‰¾åˆ°ç»“æŸç‚¹ã€‚å¦å¤–ï¼Œè¿˜è¦ç´¯åŠ æ¯ä¸€å±‚çš„èŠ‚ç‚¹æ•°ï¼Œæœ€åå¦‚æœæ‰¾åˆ°ç»“æŸç‚¹ï¼Œå¦‚æœç»“æŸç‚¹æ˜¯å·¦èŠ‚ç‚¹ï¼Œå°±å¤šåŠ 1ä¸ªï¼Œå¦‚æœç»“æŸç‚¹æ˜¯å³èŠ‚ç‚¹ï¼Œå°±å¤šåŠ 2ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> h = minHeight(root);</div><div class="line">        <span class="keyword">while</span> (root != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">int</span> leftH = h - <span class="number">1</span>;</div><div class="line">            <span class="keyword">int</span> rightH = minHeight(root.right);</div><div class="line">            <span class="keyword">if</span> (rightH == leftH) &#123; <span class="comment">// æ˜¯æ»¡äºŒå‰æ ‘</span></div><div class="line">                count += <span class="number">1</span> + getCount(leftH);</div><div class="line">                root = root.right;</div><div class="line">                h = rightH;</div><div class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//è‚¯å®šæ˜¯å·¦è¾¹æ®‹ç¼º</span></div><div class="line">                count += <span class="number">1</span> + getCount(rightH);</div><div class="line">                root = root.left;</div><div class="line">                h = leftH;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> count;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">minHeight</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> h = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (root != <span class="keyword">null</span>) &#123;</div><div class="line">            root = root.left;</div><div class="line">            h++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> h;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">(<span class="keyword">int</span> h)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; h) - <span class="number">1</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">11. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://juejin.im/post/59e3fde451882578c20858a5" target="_blank" rel="external">åˆ·é¢˜ã€‘äºŒå‰æ ‘éé€’å½’éå†</a></li>
<li><a href="http://blog.csdn.net/u014787113/article/details/49717831" target="_blank" rel="external">äºŒå‰æ ‘å‰åºï¼Œä¸­åºï¼Œååºéå†è¿­ä»£å®ç°è¯¦è§£</a></li>
<li><a href="http://blog.csdn.net/cyp331203/article/details/42609387" target="_blank" rel="external">ã€ç®—æ³•å¯¼è®ºã€‘äºŒå‰æœç´¢æ ‘çš„æ’å…¥å’Œåˆ é™¤</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾]]></title>
      <url>/2017/11/24/%E7%AE%97%E6%B3%95-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/</url>
      <content type="html"><![CDATA[<h1 id="äºŒåˆ†æŸ¥æ‰¾">1. äºŒåˆ†æŸ¥æ‰¾</h1><p>ç»™ä¸€ä¸ªå·²æ’åºçš„æ•°ç»„ï¼Œæ‰¾åˆ°targetçš„ä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå‡ºç°çš„ã€æœ€åä¸€ä¸ªå‡ºç°çš„ã€ä»»æ„çš„ï¼‰ä½ç½®ã€‚å¦‚æœæ²¡æœ‰targetï¼Œè¿”å›-1</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">target = <span class="number">5</span></div><div class="line"></div><div class="line">    start                    end</div><div class="line">      â†“                       â†“</div><div class="line">index <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span></div><div class="line">nums  <span class="number">2</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> <span class="number">55</span> <span class="number">89</span></div><div class="line">      </div><div class="line">======================================</div><div class="line"></div><div class="line">mid = [start + end ] / <span class="number">2</span> = <span class="number">8</span>/<span class="number">2</span> = <span class="number">4</span></div><div class="line">  </div><div class="line">    start        mid         end</div><div class="line">      â†“           â†“           â†“</div><div class="line">index <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span></div><div class="line">nums  <span class="number">2</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> <span class="number">55</span> <span class="number">89</span></div><div class="line">  </div><div class="line">nums[mid] &gt; target  -&gt; targetä¸€å®šåœ¨å·¦è¾¹ --&gt; end = mid</div><div class="line"></div><div class="line">======================================</div><div class="line"></div><div class="line">mid = [start + end ] / <span class="number">2</span> = <span class="number">4</span>/<span class="number">2</span> = <span class="number">2</span></div><div class="line">  </div><div class="line">    start  mid   end</div><div class="line">      â†“     â†“     â†“</div><div class="line">index <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span></div><div class="line">nums  <span class="number">2</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> <span class="number">55</span> <span class="number">89</span></div><div class="line">  </div><div class="line">nums[mid] == target  -&gt;  got it ! </div><div class="line">  </div><div class="line">å¤æ‚åº¦åˆ†æ</div><div class="line"></div><div class="line">T(n) = T(n/<span class="number">2</span>) + O(<span class="number">1</span>)</div><div class="line"></div><div class="line">è§£å¾— T(n) = O(logn)</div></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong>ç”¨é€’å½’è¿˜æ˜¯ç”¨whileï¼Ÿ</strong></p>
<p>é€’å½’ï¼šå¥½ç†è§£ï¼Œè€—è´¹æ ˆç©ºé—´</p>
<p>whileï¼šä¸å¥½å†™ï¼Œä½†çœæ ˆç©ºé—´ï¼Œå°½é‡å†™while</p>
<h1 id="ä¾‹é¢˜">2. ä¾‹é¢˜</h1><h2 id="ä¾‹é¢˜1ï¼ŒBinary-Search">2.1. ä¾‹é¢˜1ï¼ŒBinary Search</h2><p>ç»™ä¸€ä¸ªint[] nums,æ‰¾åˆ°targetç¬¬ä¸€æ¬¡å‡ºç°çš„indexã€‚æ²¡æ‰¾åˆ°å°±è¿”å›-1.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] nums = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">10</span>&#125;;</div><div class="line">target = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="keyword">return</span> <span class="number">2</span>;</div><div class="line"></div><div class="line">æ¨¡æ¿ï¼š</div><div class="line"></div><div class="line"><span class="keyword">int</span> start = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> end = nums.length - <span class="number">1</span>;</div><div class="line"><span class="keyword">int</span> mid;</div><div class="line"><span class="comment">// æ³¨æ„whileç»“æŸçš„åˆ¤æ–­</span></div><div class="line"><span class="comment">// start - end å°äºä¸¤ä¸ªæ•°æ—¶</span></div><div class="line"><span class="keyword">while</span>( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">  mid = start + ( end - start )/<span class="number">2</span>; <span class="comment">// è¿™æ ·é˜²æ­¢Integeræº¢å‡º</span></div><div class="line">  <span class="keyword">if</span>( nums[mid] == target )&#123;</div><div class="line">    end = mid;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">    start = mid;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &gt; target )&#123;</div><div class="line">    end = mid;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">  <span class="keyword">return</span> start;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>( nums[end] == target )&#123;</div><div class="line">  <span class="keyword">return</span> end;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> -<span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>å˜ä½“ï¼šè¾“å‡ºæœ€åä¸€æ¬¡index</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">mid = [start + end ] / <span class="number">2</span> = <span class="number">8</span>/<span class="number">2</span> = <span class="number">4</span></div><div class="line">  </div><div class="line">    start        mid         end</div><div class="line">      â†“           â†“           â†“</div><div class="line">index <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span></div><div class="line">nums  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span></div><div class="line"></div><div class="line">ç”±äºéœ€è¦lastï¼Œæ‰€ä»¥æŠŠstart ç½®ä¸º <span class="function">mid</span></div><div class="line"></div><div class="line"><span class="title">while</span><span class="params">( start + <span class="number">1</span> &lt; end )</span>&#123;</div><div class="line">  mid = start + ( end - start )/<span class="number">2</span>; </div><div class="line">  <span class="keyword">if</span>( nums[mid] == target )&#123;</div><div class="line">    start = mid; <span class="comment">// å˜</span></div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">    start = mid;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &gt; target )&#123;</div><div class="line">    end = mid;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>( nums[end] == target )&#123; <span class="comment">//å…ˆ</span></div><div class="line">  <span class="keyword">return</span> end;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">  <span class="keyword">return</span> start;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> -<span class="number">1</span>;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜2ï¼ŒSearch-for-a-range">2.2. ä¾‹é¢˜2ï¼ŒSearch for a range</h2><p>ç»™ä¸€ä¸ªint[] nums = {5,7,7,8,8,10],æ‰¾åˆ°target=8å‡ºç°çš„èŒƒå›´[3,4]ã€‚æ²¡æ‰¾åˆ°å°±è¿”å›[-1,-1].</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line">æ€è·¯ä¸€ï¼Œå†™ä¸¤ä¸ªäºŒåˆ†ï¼Œæœä¸¤æ¬¡ã€‚å…ˆæœstartï¼Œå†æœend</div><div class="line">æ—¶é—´å¤æ‚åº¦:<span class="number">2l</span>og(n)</div><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] searchRange(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">int</span>[] range = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">        range[<span class="number">0</span>] = -<span class="number">1</span> ; range[<span class="number">1</span>] = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> range;</div><div class="line">        <span class="comment">//æ‰¾first</span></div><div class="line">        <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span> ,mid = -<span class="number">1</span>,foundIdx = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start )/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">            foundIdx = start;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[end] == target )&#123;</div><div class="line">            foundIdx = end;</div><div class="line">        &#125;</div><div class="line">        range[<span class="number">0</span>] = foundIdx;</div><div class="line">        <span class="comment">//æ‰¾last</span></div><div class="line">        start = <span class="number">0</span>;end = nums.length - <span class="number">1</span>;mid = -<span class="number">1</span>;foundIdx = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start )/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>( nums[mid] &lt;= target )&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( nums[end] == target )&#123;</div><div class="line">            foundIdx = end;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">            foundIdx = start;</div><div class="line">        &#125;</div><div class="line">        range[<span class="number">1</span>] = foundIdx;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> range;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">æ€è·¯äºŒï¼Œæ‰¾åˆ°å++--</div><div class="line">å¤æ‚åº¦O(logn) + O(L) </div><div class="line">æœ€åæƒ…å†µä¸‹O(logn) + O(n)</div><div class="line">  <span class="keyword">public</span> <span class="keyword">int</span>[] searchRange(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">int</span>[] range = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">        range[<span class="number">0</span>] = -<span class="number">1</span> ; range[<span class="number">1</span>] = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> range;</div><div class="line">        <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span> ,mid = <span class="number">0</span>;</div><div class="line">        <span class="keyword">boolean</span> found = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start )/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>( nums[mid] == target )&#123;</div><div class="line">                found = <span class="keyword">true</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">            found = <span class="keyword">true</span>;</div><div class="line">            mid = start;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( nums[end] == target )&#123;</div><div class="line">            found = <span class="keyword">true</span>;</div><div class="line">            mid = end;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(found == <span class="keyword">true</span>) &#123; <span class="comment">//å¦‚æœæ‰¾åˆ°äº†</span></div><div class="line">            start = mid - <span class="number">1</span>;</div><div class="line">            end = mid + <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (start &gt;= <span class="number">0</span> &amp;&amp; nums[start] == target) &#123;</div><div class="line">                --start;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (end &lt; nums.length &amp;&amp; nums[end] == target) &#123;</div><div class="line">                ++end;</div><div class="line">            &#125;</div><div class="line">            range[<span class="number">0</span>] = ++start;</div><div class="line">            range[<span class="number">1</span>] = --end;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> range;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜3ï¼ŒSearch-Insert-Position">2.3. ä¾‹é¢˜3ï¼ŒSearch Insert Position</h2><p>ç»™ä¸€ä¸ªæœ‰åºæ— é‡æ•°ç»„nums = [1,3,5,6],æŠŠtarget=5æ’å…¥ï¼Œé—®æ’å…¥çš„ä½ç½®=2ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">æ’å…¥ä½ç½® = ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºçš„ä½ç½® ï¼ˆè¾ƒæ–¹ä¾¿ï¼‰</div><div class="line">	    = æœ€åä¸€ä¸ªæ¯”å®ƒå°çš„ä½ç½®</div><div class="line">	    </div><div class="line">æ–¹æ³•ä¸€ï¼š</div><div class="line"><span class="keyword">while</span>( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">  mid = start + ( end - start )/<span class="number">2</span>; <span class="comment">// è¿™æ ·é˜²æ­¢Integeræº¢å‡º</span></div><div class="line">  <span class="keyword">if</span>( nums[mid] == target )&#123;</div><div class="line">    <span class="keyword">return</span> mid;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">    start = mid;</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[mid] &gt; target )&#123;</div><div class="line">    end = mid;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>( nums[start] &gt;= target )&#123;</div><div class="line">  <span class="keyword">return</span> start;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>( nums[end] &gt;= target )&#123;</div><div class="line">  <span class="keyword">return</span> end;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> end + <span class="number">1</span>; <span class="comment">// æ²¡æœ‰è§£ ï¼Œæ­¤æ—¶end = length</span></div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="comment">//æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºtargetçš„æ•°</span></div><div class="line">        <span class="keyword">int</span> start = <span class="number">0</span> , end = nums.length - <span class="number">1</span>,mid;</div><div class="line">        <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start )/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>( nums[mid] &lt; target )&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>( target &lt;= nums[start] )&#123;<span class="comment">//[1,3] -&gt; 0 / 1</span></div><div class="line">            <span class="keyword">return</span> start;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>( target &lt;= nums[end] )&#123;<span class="comment">//[1,3] -&gt; 2 / 3</span></div><div class="line">            <span class="keyword">return</span> end;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;<span class="comment">//[1,3] -&gt; 4...</span></div><div class="line">            <span class="keyword">return</span> end+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜4ï¼ŒSearch-a-2D-Matrix">2.4. ä¾‹é¢˜4ï¼ŒSearch a 2D Matrix</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">ä¸¥æ ¼é€’å¢çš„Matrix</div><div class="line">[</div><div class="line">  [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>],</div><div class="line">  [<span class="number">10</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">20</span>],</div><div class="line">  [<span class="number">23</span>,<span class="number">30</span>,<span class="number">34</span>,<span class="number">50</span>]</div><div class="line">]</div><div class="line">give target = <span class="number">3</span> , <span class="keyword">return</span> <span class="keyword">true</span></div><div class="line">  </div><div class="line">æ€è·¯ä¸€ï¼šå…ˆè¡Œååˆ—</div><div class="line"></div><div class="line">æ€è·¯äºŒï¼šçœ‹æˆä¸€ç»´çš„</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">searchMatrix</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span> )&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> n = matrix.length;</div><div class="line">        <span class="keyword">int</span> m = matrix[<span class="number">0</span>].length;</div><div class="line">        <span class="keyword">int</span> start = <span class="number">0</span>,end = m * n -<span class="number">1</span>,mid,r,c;</div><div class="line">        <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start )/<span class="number">2</span>;</div><div class="line">            c = mid % m ;</div><div class="line">            r = mid / m ;</div><div class="line">            <span class="keyword">if</span>( matrix[r][c] == target )&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>( matrix[r][c] &gt; target )&#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( matrix[start/m][start%m] == target )&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( matrix[end/m][end%m] == target )&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜5ï¼ŒSearch-a-2D-Matrix-II">2.5. ä¾‹é¢˜5ï¼ŒSearch a 2D Matrix II</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">éä¸¥æ ¼é€’å¢</div><div class="line">[</div><div class="line">  [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>],</div><div class="line">  [<span class="number">2</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>],</div><div class="line">  [<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">10</span>]</div><div class="line">]</div><div class="line">target = <span class="number">3</span></div><div class="line"><span class="keyword">return</span> targetå‡ºç°çš„æ¬¡æ•° = <span class="number">2</span></div></pre></td></tr></table></figure>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-24-15-24-37.png" alt=""> </p>
<ul>
<li>å¦‚æœè¿™ä¸ªæ•°æ¯”120å°ï¼Œå°±å‘å³èµ°</li>
<li>å¦‚æœè¿™ä¸ªæ•°æ¯”120å¤§ï¼Œå°±å‘ä¸Šèµ°</li>
</ul>
<p><strong>æ€è·¯1ï¼Œæ¯è¡ŒäºŒåˆ†</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">seachRow</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">int</span> target)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> mid;</div><div class="line">        <span class="keyword">while</span> (low + <span class="number">1</span> &lt; high)&#123;</div><div class="line">            mid = low + (high - low)/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>(arr[mid] == target) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">if</span>(arr[mid] &lt; target)&#123;</div><div class="line">                low = mid;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                high = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(arr[low] == target || arr[high] == target) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">searchMatrix</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; matrix.length; ++row)&#123;</div><div class="line">            <span class="keyword">if</span>(target &gt; matrix[row][matrix[<span class="number">0</span>].length - <span class="number">1</span>]) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span>(seachRow(matrix[row], <span class="number">0</span>, matrix[<span class="number">0</span>].length - <span class="number">1</span>, target)) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œä»å·¦ä¸‹å¼€å§‹å¯»æ‰¾</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">searchMatrix</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> m = matrix.length, n = matrix[<span class="number">0</span>].length;</div><div class="line">        <span class="keyword">int</span> row = <span class="number">0</span>, col = n - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (row &gt;= <span class="number">0</span> &amp;&amp; row &lt; m &amp;&amp; col &gt;= <span class="number">0</span> &amp;&amp; col &lt; n)&#123;</div><div class="line">            <span class="keyword">if</span>(target == matrix[row][col]) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">if</span>(target &gt; matrix[row][col]) &#123;++row;&#125;</div><div class="line">            <span class="keyword">else</span>&#123;--col;&#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜6ï¼ŒFirst-Bad-Version">2.6. ä¾‹é¢˜6ï¼ŒFirst Bad Version</h2><p>ä»£ç åº“çš„ç‰ˆæœ¬å·æ˜¯ä» 1 åˆ° <em>n</em> çš„æ•´æ•°ã€‚æŸä¸€å¤©ï¼Œæœ‰äººæäº¤äº†é”™è¯¯ç‰ˆæœ¬çš„ä»£ç ï¼Œå› æ­¤é€ æˆè‡ªèº«åŠä¹‹åç‰ˆæœ¬çš„ä»£ç åœ¨å•å…ƒæµ‹è¯•ä¸­å‡å‡ºé”™ã€‚è¯·æ‰¾å‡ºç¬¬ä¸€ä¸ªé”™è¯¯çš„ç‰ˆæœ¬å·ã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡ <code>isBadVersion</code> çš„æ¥å£æ¥åˆ¤æ–­ç‰ˆæœ¬å· version æ˜¯å¦åœ¨å•å…ƒæµ‹è¯•ä¸­å‡ºé”™ï¼Œå…·ä½“æ¥å£è¯¦æƒ…å’Œè°ƒç”¨æ–¹æ³•è¯·è§ä»£ç çš„æ³¨é‡Šéƒ¨åˆ†ã€‚</p>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<p>è¯·é˜…è¯»ä¸Šè¿°ä»£ç ï¼Œå¯¹äºä¸åŒçš„è¯­è¨€è·å–æ­£ç¡®çš„è°ƒç”¨ <em>isBadVersion</em> çš„æ–¹æ³•ï¼Œæ¯”å¦‚javaçš„è°ƒç”¨æ–¹å¼æ˜¯<code>SVNRepo.isBadVersion(v)</code></p>
<p><strong>æ ·ä¾‹</strong></p>
<p>ç»™å‡º <code>n=5</code></p>
<p>è°ƒç”¨<code>isBadVersion(3)</code>ï¼Œå¾—åˆ°<code>false</code></p>
<p>è°ƒç”¨<code>isBadVersion(5)</code>ï¼Œå¾—åˆ°<code>true</code></p>
<p>è°ƒç”¨<code>isBadVersion(4)</code>ï¼Œå¾—åˆ°<code>true</code></p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ–­å®š<code>4</code>æ˜¯ç¬¬ä¸€ä¸ªé”™è¯¯çš„ç‰ˆæœ¬å·</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> start = <span class="number">1</span>, end = n;</div><div class="line"><span class="keyword">while</span>( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">  <span class="keyword">int</span> mid = ( start + end ) / <span class="number">2</span>;</div><div class="line">  <span class="keyword">if</span>( VersionControl.isBadVersion(mid) )&#123;</div><div class="line">    end = mid;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    start = mid + <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>( VersionControl.isBadVersion( start ) )&#123;</div><div class="line">  <span class="keyword">return</span> start;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> end;</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">firstBadVersion</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> start = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> end = n;</div><div class="line">        <span class="keyword">int</span> mid;</div><div class="line">        <span class="keyword">while</span>( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">            mid = start + ( end - start ) / <span class="number">2</span> ;</div><div class="line">            <span class="keyword">if</span>( isBadVersion(mid) )&#123;</div><div class="line">                end = mid;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                start = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( isBadVersion(start) )&#123;</div><div class="line">            <span class="keyword">return</span> start;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( isBadVersion(end) )&#123;</div><div class="line">            <span class="keyword">return</span> end;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜7ï¼ŒFind-Peak-Element">2.7. ä¾‹é¢˜7ï¼ŒFind Peak Element</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ã€‚æ‰¾å³°å€¼ã€‚ç›¸é‚»ä¸¤ä¸ªæ•°éƒ½ä¸ä¸€æ ·ã€‚å¦‚æœæœ‰å¤šä¸ªå³°å€¼ï¼Œå°±éšä¾¿è¾“å‡ºä¸€ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">6</span>] -&gt; <span class="keyword">return</span> index <span class="number">1</span> or <span class="number">6</span></div><div class="line"> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span></div><div class="line">  </div><div class="line">äºŒåˆ†ï¼Œç¡®å®šä¸€ä¸ªmidï¼Œæ‰¾åˆ°ç­–ç•¥â€”â€”æ€æ ·å‘å·¦èµ°ï¼Œæ€æ ·å‘å³èµ°</div><div class="line"></div><div class="line">start - left - mid - right - end</div><div class="line"></div><div class="line"><span class="keyword">if</span> left &lt; mid &gt; right -&gt; mid æ˜¯å³°å€¼</div><div class="line"></div><div class="line"><span class="keyword">else</span> left &lt; mid &lt; right -&gt; å³°å€¼åœ¨å³è¾¹ , start = mid</div><div class="line"></div><div class="line"><span class="keyword">else</span> left &gt; mid &gt; right -&gt; å³°å€¼åœ¨å·¦è¾¹ , end = mid</div><div class="line"></div><div class="line"><span class="keyword">else</span> left &gt; mid &lt; right -&gt; ä¸¤è¾¹éƒ½æœ‰å¯èƒ½ , éšæ„äº†</div><div class="line"></div><div class="line">ä»£ç :</div><div class="line"><span class="keyword">int</span>[] nums;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getNums</span><span class="params">(<span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( idx &lt; <span class="number">0</span> ) <span class="keyword">return</span> -Integer.MAX_VALUE;</div><div class="line">  <span class="keyword">if</span>( idx == nums.length ) <span class="keyword">return</span> -Integer.MAX_VALUE;</div><div class="line">  <span class="keyword">return</span> nums[idx];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findPeakElement</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">  <span class="keyword">this</span>.nums = nums;</div><div class="line">  <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span>,mid;</div><div class="line">  <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">    mid = start + ( end - start ) / <span class="number">2</span>;</div><div class="line">    <span class="comment">//æŸ¥çœ‹midçš„å¯¼æ•°</span></div><div class="line">    <span class="keyword">if</span>( getNums(mid) &gt; getNums(mid-<span class="number">1</span>))&#123;</div><div class="line">      <span class="keyword">if</span>( getNums(mid) &gt; getNums(mid+<span class="number">1</span>))&#123;</div><div class="line">        <span class="keyword">return</span> mid;</div><div class="line">      &#125;<span class="keyword">else</span> &#123;</div><div class="line">        start = mid;</div><div class="line">      &#125;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      end = mid;</div><div class="line">      <span class="comment">//åˆå¹¶ä¸‹é¢ä¸¤æ­¥</span></div><div class="line">      <span class="comment">// if(getNums(mid) &lt; getNums(mid+1))&#123;</span></div><div class="line">      <span class="comment">//    end = mid;</span></div><div class="line">      <span class="comment">//  &#125;else &#123;</span></div><div class="line">      <span class="comment">//    end = mid;</span></div><div class="line">      <span class="comment">//  &#125;</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>( getNums(start) &gt; getNums(end) )&#123;</div><div class="line">    <span class="keyword">return</span> start;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> end;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ€è€ƒï¼šå¦‚æœæœ‰ç›¸é‚»ä¸¤ä¸ªæ•°ä¸€æ ·ï¼Ÿ å°±åªèƒ½$O(n)$</p>
<h2 id="ä¾‹é¢˜8ï¼ŒFind-Minimum-in-rotated-sorted-array">2.8. ä¾‹é¢˜8ï¼ŒFind Minimum in rotated sorted array</h2><p>æ‰¾æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­çš„æœ€å°å€¼ã€‚æ•°ç»„ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚</p>
<p>å°±æ˜¯åœ¨ä¸¤æ®µä¸Šå‡åŒºé—´, æ‰¾åˆ°ç¬¬ä¸€ä¸ªxã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-27-15-50-02.png" alt=""> </p>
<p>å‡è®¾midåœ¨å·¦è¾¹çš„æŸåœ°æ–¹ï¼ˆä¾‹å¦‚5ï¼‰ï¼Œé‚£ä¹ˆé—®é¢˜è½¬æ¢ä¸ºè¾ƒå°åŒºé—´çš„åŸé—®é¢˜â€“&gt; start = mid</p>
<p>å‡è®¾midåœ¨å³è¾¹çš„æŸåœ°æ–¹ï¼ˆä¾‹å¦‚1ï¼‰ï¼Œé‚£ä¹ˆé—®é¢˜è½¬æ¢ä¸ºè¾ƒå°åŒºé—´çš„åŸé—®é¢˜â€“&gt; end = mid</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line">          </div><div class="line">        |-<span class="number">5</span>-|</div><div class="line">    |-<span class="number">4</span>-|   |      </div><div class="line">|-<span class="number">3</span>-|   |   |       |-<span class="number">2</span>-|</div><div class="line">|   |   |   |   |-<span class="number">1</span>-|   |</div><div class="line">|   |   |   |-<span class="number">0</span>-|   |   |</div><div class="line">              â†‘ </div><div class="line">             è¦å®ƒ</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMin</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">  <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span>,mid;</div><div class="line">  <span class="comment">//é¡ºåºæƒ…å†µ</span></div><div class="line">  <span class="keyword">if</span>( nums[start] &lt; nums[end] )<span class="keyword">return</span> nums[start];</div><div class="line">  <span class="comment">//æ—‹è½¬æƒ…å†µ</span></div><div class="line">  <span class="keyword">while</span> ( start + <span class="number">1</span> &lt; end )&#123;</div><div class="line">      mid = start + ( end - start ) / <span class="number">2</span>;</div><div class="line">      <span class="keyword">if</span>( nums[mid] &gt; nums[start] )&#123;</div><div class="line">          start = mid;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">          end = mid;</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>( nums[start] &lt; nums[end] )&#123;</div><div class="line">      <span class="keyword">return</span> nums[start];</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> nums[end];</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜9ï¼ŒFind-Minimum-in-rotated-sorted-array-II">2.9. ä¾‹é¢˜9ï¼ŒFind Minimum in rotated sorted array II</h2><p>æ‰¾æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­çš„æœ€å°å€¼ã€‚æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line"></div><div class="line">ä¸å¯ä»¥ç”¨äºŒåˆ†</div><div class="line"></div><div class="line">å› ä¸ºå¹¶ä¸ç¡®å®šæ˜¯å‘å·¦è¿˜æ˜¯å‘å³èµ°</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMin</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="comment">// 1,1,2,3,4,0,0</span></div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">0</span> )&#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//é¡ºåºæƒ…å†µ</span></div><div class="line">        <span class="keyword">if</span>( nums[<span class="number">0</span>] &lt; nums[nums.length-<span class="number">1</span>] )&#123;</div><div class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//æ—‹è½¬æƒ…å†µ</span></div><div class="line">        <span class="keyword">int</span> i = nums.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i-<span class="number">1</span>] &lt;= nums[i] )&#123;</div><div class="line">            --i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> nums[i];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">å…¶å®ä¹Ÿå¯ä»¥ç”¨äºŒåˆ†ï¼</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜10ï¼ŒSearch-in-Rotated-Sorted-Array">2.10. ä¾‹é¢˜10ï¼ŒSearch in Rotated Sorted Array</h2><p>ä»æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­æ‰¾targetã€‚æ•°ç»„ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"><span class="number">1</span>. midåœ¨ç¬¬ä¸€æ®µä¸Šå‡åŒºé—´</div><div class="line">  <span class="keyword">if</span> S &lt; T &lt; mid -&gt; end = mid</div><div class="line">  <span class="keyword">if</span> T &gt; M       -&gt; start = end ä»»ç„¶æ˜¯ä¸€ä¸ªrotated sorted array</div><div class="line">  ...</div><div class="line"><span class="number">2</span>. ....</div><div class="line">    </div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span>,mid;</div><div class="line">    <span class="keyword">while</span> (start + <span class="number">1</span> &lt; end)&#123;</div><div class="line">      mid = start + ( end - start ) / <span class="number">2</span>;</div><div class="line">      <span class="keyword">if</span>( nums[mid] == target ) <span class="keyword">return</span> mid;</div><div class="line">      <span class="keyword">if</span>( target &gt;= nums[<span class="number">0</span>] ) &#123; <span class="comment">// targetåœ¨å‰åŠæ®µ</span></div><div class="line">        <span class="keyword">if</span>( nums[mid] &gt; nums[<span class="number">0</span>] )&#123;<span class="comment">//midåœ¨å‰åŠæ®µ</span></div><div class="line">          <span class="keyword">if</span>( nums[mid] &gt; target )&#123;</div><div class="line">            end = mid;</div><div class="line">          &#125;<span class="keyword">else</span> &#123;</div><div class="line">            start = mid;</div><div class="line">          &#125;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">          end = mid;</div><div class="line">        &#125;</div><div class="line">      &#125;<span class="keyword">else</span> &#123; <span class="comment">//targetåœ¨ååŠæ®µ</span></div><div class="line">        <span class="keyword">if</span>( nums[mid] &lt; nums[<span class="number">0</span>] )&#123; <span class="comment">// midåœ¨ååŠæ®µ</span></div><div class="line">          <span class="keyword">if</span>(nums[mid] &gt; target)&#123;</div><div class="line">            end = mid;</div><div class="line">          &#125;<span class="keyword">else</span> &#123;</div><div class="line">            start = mid;</div><div class="line">          &#125;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">          start = mid;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>( nums[start] == target )&#123;</div><div class="line">      <span class="keyword">return</span> start;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>( nums[end] == target )&#123;</div><div class="line">      <span class="keyword">return</span> end;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜11ï¼ŒSearch-in-Rotated-Sorted-Array-II">2.11. ä¾‹é¢˜11ï¼ŒSearch in Rotated Sorted Array II</h2><p>ä»æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­æ‰¾targetã€‚æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ ã€‚</p>
<p>åªèƒ½forå¾ªç¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">è¿™é¢˜æœ€ç®€å•çš„å°±æ˜¯æš´åŠ›<span class="keyword">for</span>å¾ªç¯</div><div class="line">è¿˜æœ‰ä¸€ç§å·§å¦™çš„äºŒåˆ†æ³•ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span> start = <span class="number">0</span>, end = nums.length - <span class="number">1</span>,mid;</div><div class="line">    <span class="keyword">while</span> (start + <span class="number">1</span> &lt; end)&#123;</div><div class="line">    	mid = start + ( end - start ) / <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>( nums[mid] == target || target == nums[start])</div><div class="line">        	<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>( nums[mid] == nums[start] )&#123;</div><div class="line">        	++start ;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// targetåœ¨å‰åŠæ®µã€midä¹Ÿåœ¨å‰åŠæ®µ</span></div><div class="line">        <span class="keyword">if</span>( target &gt; nums[<span class="number">0</span>] &amp;&amp; nums[mid] &gt; nums[<span class="number">0</span>] ||</div><div class="line">        <span class="comment">//targetåœ¨ååŠæ®µï¼Œmidä¹Ÿåœ¨ååŠæ®µ</span></div><div class="line">            target &lt; nums[<span class="number">0</span>]  &amp;&amp; nums[mid] &lt; nums[<span class="number">0</span>]) &#123;</div><div class="line">            	<span class="keyword">if</span>( nums[mid] &gt; target )&#123;</div><div class="line">                	end = mid;</div><div class="line">                 &#125;<span class="keyword">else</span> &#123;</div><div class="line">                 	start = mid;</div><div class="line">                 &#125;</div><div class="line">         &#125;</div><div class="line">         <span class="comment">//targetåœ¨å‰åŠæ®µï¼Œä½†midåœ¨ååŠæ®µ</span></div><div class="line">         <span class="keyword">else</span> <span class="keyword">if</span>( target &gt; nums[<span class="number">0</span>] &amp;&amp; nums[mid] &lt; nums[<span class="number">0</span>])&#123;</div><div class="line">         	end = mid;</div><div class="line">         &#125;</div><div class="line">         <span class="comment">//targetåœ¨ååŠæ®µï¼Œä½†midåœ¨å‰åŠæ®µ</span></div><div class="line">         <span class="keyword">else</span> <span class="keyword">if</span>(target &lt; nums[<span class="number">0</span>] &amp;&amp; nums[mid] &gt; nums[<span class="number">0</span>])&#123;</div><div class="line">             start = mid;</div><div class="line">         &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">if</span>( nums[start] == target || nums[end] == target)&#123;</div><div class="line">   	<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜12ï¼ŒMerge-Sorted-Array">2.12. ä¾‹é¢˜12ï¼ŒMerge Sorted Array</h2><p>ç»™ä¸¤ä¸ªæ’åºæ•°ç»„ï¼Œå°†å®ƒä¸¤åˆå¹¶ä¸ºä¸€ä¸ªæ’åºæ•°ç»„ã€‚</p>
<h2 id="ä¾‹é¢˜13ï¼ŒMerge-Sorted-Array-II">2.13. ä¾‹é¢˜13ï¼ŒMerge Sorted Array II</h2><p>ç»™ä¸¤ä¸ªæ’åºæ•°ç»„ï¼ŒA,Bï¼Œå°†Båˆå¹¶è¿›Aã€‚</p>
<p>æ€è·¯ï¼šä»å¤§çš„å…¥æ‰‹ã€‚</p>
<h2 id="ä¾‹é¢˜14ï¼ŒMedian-of-two-Sorted-Arrays">2.14. ä¾‹é¢˜14ï¼ŒMedian of two Sorted Arrays</h2><p>æ‰¾åˆ°ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">A = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] , B = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]  -&gt; median = <span class="number">3.5</span></div><div class="line"></div><div class="line">A = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] , B = [<span class="number">4</span>,<span class="number">5</span>]  -&gt; median = <span class="number">3</span></div></pre></td></tr></table></figure>
<p>ç±»ä¼¼é¢˜ï¼šfind Kth of two Sorted Arrays - å…ˆè§£å†³è¿™ä¸ª</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line">A = <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></div><div class="line">B = <span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span></div><div class="line">  </div><div class="line">æœ€æš´åŠ›ï¼šä¾æ¬¡å¯»æ‰¾ï¼Œåˆ°K -&gt; O(K)</div><div class="line"></div><div class="line">ä¼˜åŒ–ï¼š</div><div class="line"></div><div class="line">å…ˆæ‰¾Açš„[k/<span class="number">2</span>]çš„æ•°</div><div class="line">    Bçš„[k/<span class="number">2</span>]çš„æ•°</div><div class="line">    </div><div class="line"><span class="keyword">if</span> A[k/<span class="number">2</span>] &lt;= B[k/<span class="number">2</span>]</div><div class="line">	Açš„å‰k/<span class="number">2</span>ä¸ªæ•°éƒ½å°äºã€åˆå¹¶åçš„å‰Kä¸ªæ•°ã€‘</div><div class="line">	æ—¢ç„¶å¦‚æ­¤ï¼Œå°±ä»A[k/<span class="number">2</span> + <span class="number">1</span>] &amp; B[<span class="number">0</span>]å¼€å§‹æ‰¾ ï¼Œä»å‰©ä¸‹çš„é‡Œæ‰¾Top[k - k/<span class="number">2</span>]</div><div class="line">	</div><div class="line">O(logk) ! éœ‡æƒŠï¼</div><div class="line"></div><div class="line">ä»£ç éå¸¸å¤æ‚ã€‚ã€‚ã€‚</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findKthSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2,<span class="keyword">int</span> k,<span class="keyword">int</span> s_n1,<span class="keyword">int</span> s_n2)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span>( s_n1 &gt;= nums1.length )&#123;</div><div class="line">           <span class="keyword">return</span> nums2[s_n2 + k];</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span>( s_n2 &gt;= nums2.length )&#123;</div><div class="line">           <span class="keyword">return</span> nums1[s_n1 + k];</div><div class="line">       &#125;</div><div class="line">        <span class="keyword">if</span>( k == <span class="number">0</span> )&#123;</div><div class="line">           <span class="keyword">if</span>( nums1[s_n1] &gt; nums2[s_n2] )&#123;</div><div class="line">               <span class="keyword">return</span> nums2[s_n2];</div><div class="line">           &#125;<span class="keyword">else</span> &#123;</div><div class="line">               <span class="keyword">return</span> nums1[s_n1];</div><div class="line">           &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( k == <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>( nums1[s_n1] &lt; nums2[s_n2] )&#123;</div><div class="line">                <span class="keyword">return</span> findKthSortedArrays(nums1,nums2,<span class="number">0</span>,s_n1+<span class="number">1</span>,s_n2);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> findKthSortedArrays(nums1,nums2,<span class="number">0</span>,s_n1,s_n2+<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">         <span class="comment">// å…¨éƒ¨æº¢å‡º</span></div><div class="line">        <span class="keyword">if</span>( s_n1 + k/<span class="number">2</span> &gt;= nums1.length &amp;&amp; s_n2 + k/<span class="number">2</span> &gt;= nums2.length )&#123;</div><div class="line">            <span class="keyword">if</span>(nums1[nums1.length-<span class="number">1</span>] &lt; nums2[nums2.length - <span class="number">1</span>])&#123;</div><div class="line">                k -= nums1.length - s_n1;</div><div class="line">                s_n1 = nums1.length;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                k -= nums2.length - s_n2;</div><div class="line">                s_n2 = nums2.length;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">          <span class="comment">// éƒ¨åˆ†æº¢å‡º</span></div><div class="line">            <span class="keyword">if</span> (s_n1 + k / <span class="number">2</span> &gt;= nums1.length) &#123;</div><div class="line">                <span class="keyword">if</span> (nums1[nums1.length - <span class="number">1</span>] &lt; nums2[s_n2 + k / <span class="number">2</span>]) &#123;</div><div class="line">                    k -= nums1.length - s_n1;</div><div class="line">                    s_n1 = nums1.length;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    s_n2 += k / <span class="number">2</span>;</div><div class="line">                    k -= k/<span class="number">2</span>;</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s_n2 + k / <span class="number">2</span> &gt;= nums2.length) &#123;</div><div class="line">                <span class="keyword">if</span> (nums2[nums2.length - <span class="number">1</span>] &lt; nums1[s_n1 + k / <span class="number">2</span>]) &#123;</div><div class="line">                    k -= nums2.length - s_n2;</div><div class="line">                    s_n2 = nums2.length;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    s_n1 += k / <span class="number">2</span>;</div><div class="line">                    k -= k/<span class="number">2</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// æ­£å¸¸æƒ…å†µ</span></div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span> (nums1[s_n1 + k / <span class="number">2</span>] &gt; nums2[s_n2 + k / <span class="number">2</span>]) &#123;</div><div class="line">                    s_n2 += k / <span class="number">2</span>;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    s_n1 += k / <span class="number">2</span>;</div><div class="line">                &#125;</div><div class="line">                k -= k / <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> findKthSortedArrays(nums1,nums2,k,s_n1,s_n2);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> s_n1 = <span class="number">0</span>,s_n2 = <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> k = (nums1.length + nums2.length);</div><div class="line">        <span class="keyword">if</span>( k % <span class="number">2</span> == <span class="number">0</span> )&#123;</div><div class="line">            <span class="keyword">double</span> a = findKthSortedArrays(nums1,nums2,k/<span class="number">2</span>,s_n1,s_n2);</div><div class="line">            <span class="keyword">double</span> b = findKthSortedArrays(nums1,nums2,k/<span class="number">2</span>-<span class="number">1</span>,s_n1,s_n2);</div><div class="line">            <span class="keyword">return</span> (a+b)/<span class="number">2</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> findKthSortedArrays(nums1,nums2,k/<span class="number">2</span>,s_n1,s_n2);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-DFS]]></title>
      <url>/2017/11/21/%E7%AE%97%E6%B3%95-DFS/</url>
      <content type="html"><![CDATA[<p> è®°äº†ç‚¹è‡ªå·±æœ‰é—®é¢˜çš„é¢˜ç›®</p>
<a id="more"></a>
<h1 id="LeetCodeé¢˜">1. LeetCodeé¢˜</h1><h2 id="Word-Break-II">1.1. Word Break II</h2><p>ç»™ä¸€ä¸ªstr så’Œä¸€ä¸ªstr[] dict,è¾“å‡ºæ‰€æœ‰så¯èƒ½è¢«dictæ‹¼æ¥çš„ç»„åˆã€‚ä¾‹å¦‚</p>
<p><em>s</em> = <code>&quot;catsanddog&quot;</code>,<br><em>dict</em> = <code>[&quot;cat&quot;, &quot;cats&quot;, &quot;and&quot;, &quot;sand&quot;, &quot;dog&quot;]</code>.</p>
<p>A solution is <code>[&quot;cats and dog&quot;, &quot;cat sand dog&quot;]</code>.</p>
<p>ä¸€å¼€å§‹æˆ‘çš„æƒ³æ³•æ˜¯ç”¨DFSç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œå†ç”¨Trieä¼˜åŒ–å­—ç¬¦ä¸²æ£€ç´¢ã€‚å¯æƒœè¿™ç§æ–¹å¼ä¼šè¶…æ—¶ã€‚çœ‹äº†åˆ«äººçš„ä»£ç ï¼Œå°±æ„Ÿè§‰è‡ªå·±å®›å¦‚ä¸€ä¸ªæ™ºéšœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">ç”¨åˆ€åœ¨å­—ç¬¦ä¸²ä¸­åˆ‡ä¸€åˆ€ã€‚å·¦è¾¹æ˜¯iä¸ªå­—ç¬¦ï¼Œå³è¾¹æ˜¯len-iä¸ªå­—ç¬¦ã€‚</div><div class="line"></div><div class="line">|=======å‰iä¸ªä½ç½®=======|</div><div class="line">  </div><div class="line">|----------|----------|</div><div class="line">|<span class="number">1</span>,<span class="number">2</span>,....,i|i+<span class="number">1</span>,..,len|</div><div class="line">|----------|----------|</div><div class="line"></div><div class="line">å¦‚æœï¼šå·¦è¾¹æ˜¯å­—å…¸é‡Œçš„è¯ï¼Œå³è¾¹æ˜¯å¯ä»¥wordbreakçš„ï¼Œé‚£ä¹ˆæŠŠå·¦è¾¹çš„å­—ç¬¦ä¸²åŠ åˆ°å³è¾¹ç®—å‡ºæ¥çš„Listä¸­ï¼Œç”Ÿæˆæ–°çš„listè¿”å›ã€‚</div><div class="line"></div><div class="line">è¾¹ç•Œæ¡ä»¶ï¼š</div><div class="line"><span class="number">1</span>. å½“è¾“å…¥å­—ç¬¦ä¸²ä¸ºç©ºçš„æ—¶å€™ï¼Œåº”è¯¥ç»™å‡ºä¸€ä¸ªç©ºè§£ã€‚è¿™ä¸ªå¾ˆé‡è¦ï¼Œå¦åˆ™è¿™ä¸ªé€’å½’æ˜¯ä¸èƒ½è¿è¡Œçš„ã€‚</div><div class="line"><span class="number">2</span>. é€’å½’æ—¶iåº”è¯¥ä»<span class="number">1</span>å¼€å§‹é€’å½’ï¼Œå› ä¸ºæˆ‘ä»¬è¦æŠŠè¿™ä¸ªé—®é¢˜åˆ†è§£ä¸º<span class="number">2</span>ä¸ªéƒ¨åˆ†ï¼Œå¦‚æœä½ å·¦è¾¹ç»™<span class="number">0</span>ï¼Œé‚£å°±æ˜¯æ­»å¾ªç¯ã€‚</div><div class="line"></div><div class="line">è®°å¿†ï¼š</div><div class="line">ä¸ºäº†åŠ å¿«DFSçš„é€Ÿåº¦ï¼Œæˆ‘ä»¬åº”è¯¥æ·»åŠ è®°å¿†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç®—è¿‡çš„å­—ç¬¦ä¸²ä¸è¦å†é‡å¤è®¡ç®—ã€‚ä¸¾ä¾‹å­ï¼š</div><div class="line">apple n feng</div><div class="line">app len feng</div><div class="line">å¦‚æœå­˜åœ¨ä»¥ä¸Š<span class="number">2</span>ç§åˆ’åˆ†ï¼Œé‚£ä¹ˆfengè¿™ä¸ªå­—ç¬¦ä¸²ä¼šè¢«åå¤è®¡ç®—ï¼Œåœ¨è¿™é‡Œè‡³å°‘è®¡ç®—äº†<span class="number">2</span>æ¬¡ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªHashmapæŠŠå¯¹åº”å­—ç¬¦ä¸²çš„è§£è®°ä¸‹æ¥ï¼Œè¿™æ ·å°±èƒ½é¿å…é‡å¤çš„è®¡ç®—ã€‚ å¦åˆ™è¿™ä¸€é“é¢˜ç›®ä¼šè¶…æ—¶ã€‚</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">wordBreak</span><span class="params">(String s, Set&lt;String&gt; wordDict)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> DFS(s, wordDict, <span class="keyword">new</span> HashMap&lt;String, LinkedList&lt;String&gt;&gt;());</div><div class="line">&#125;       </div><div class="line"></div><div class="line"><span class="comment">// DFS function returns an array including all substrings derived from s.</span></div><div class="line"><span class="function">List&lt;String&gt; <span class="title">DFS</span><span class="params">(String s, Set&lt;String&gt; wordDict, HashMap&lt;String, LinkedList&lt;String&gt;&gt;map)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (map.containsKey(s)) </div><div class="line">        <span class="keyword">return</span> map.get(s);</div><div class="line">        </div><div class="line">    LinkedList&lt;String&gt;res = <span class="keyword">new</span> LinkedList&lt;String&gt;();     </div><div class="line">    <span class="keyword">if</span> (s.length() == <span class="number">0</span>) &#123; <span class="comment">// ç»™å‡ºä¸€ä¸ªç©ºè§£</span></div><div class="line">        res.add(<span class="string">""</span>);</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;               </div><div class="line">    <span class="keyword">for</span> (String word : wordDict) &#123;</div><div class="line">        <span class="keyword">if</span> (s.startsWith(word)) &#123;<span class="comment">//å¦‚æœå·¦è¾¹æ˜¯å­—å…¸é‡Œçš„è¯</span></div><div class="line">            List&lt;String&gt;sublist = DFS(s.substring(word.length()), wordDict, map);<span class="comment">//å¦‚æœæœ‰è¿”å›å€¼ï¼Œå°±ä¼šåŠ å…¥resé‡Œ</span></div><div class="line">            <span class="keyword">for</span> (String sub : sublist) </div><div class="line">                res.add(word + (sub.isEmpty() ? <span class="string">""</span> : <span class="string">" "</span>) + sub);               </div><div class="line">        &#125;</div><div class="line">    &#125;       </div><div class="line">    map.put(s, res);</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Palindrome-Partitioning">1.2. Palindrome Partitioning</h2><p>ç»™ä¸€ä¸ªstrï¼Œè¾“å‡ºå®ƒæ‰€æœ‰çš„å¯èƒ½çš„å›æ–‡å­ä¸²ã€‚</p>
<p>For example, given <em>s</em> = <code>&quot;aab&quot;</code>,Return</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  [&quot;aa&quot;,&quot;b&quot;],</div><div class="line">  [&quot;a&quot;,&quot;a&quot;,&quot;b&quot;]</div><div class="line">]</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜æˆ‘å€Ÿé‰´äº†ä¸Šä¸€é¢˜çš„è§£æ³•ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">ç”¨åˆ€åœ¨å­—ç¬¦ä¸²ä¸­åˆ‡ä¸€åˆ€ã€‚å·¦è¾¹æ˜¯iä¸ªå­—ç¬¦ï¼Œå³è¾¹æ˜¯len-iä¸ªå­—ç¬¦ã€‚</div><div class="line"></div><div class="line">|=======å‰iä¸ªä½ç½®=======|</div><div class="line">  </div><div class="line">|----------|----------|</div><div class="line">|<span class="number">1</span>,<span class="number">2</span>,....,i|i+<span class="number">1</span>,..,len|</div><div class="line">|----------|----------|</div><div class="line"></div><div class="line">å¦‚æœï¼šå·¦è¾¹æ˜¯å›æ–‡åºåˆ—ï¼Œé‚£å°±å…ˆæŠŠå·¦è¾¹çš„æ”¾ç€ã€‚å…ˆç®—å³è¾¹ã€‚æœ€åæŠŠå·¦è¾¹çš„stråŠ åˆ°å³è¾¹listä¸­çš„æ¯ä¸ªç»“æœå‰ï¼Œå†è¿”å›å³å¯ã€‚</div><div class="line"></div><div class="line">è®°å¿†ï¼š</div><div class="line">åŒæ—¶ä¹Ÿä¿å­˜äº†ä¸€ä¸ªhashè¡¨ï¼Œå­˜å‚¨ç¬¬iä½ç½®ä¹‹åçš„æ‰€æœ‰å›æ–‡ç»„åˆæ–¹å¼ã€‚</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    HashMap&lt;Integer,List&lt;List&lt;String&gt;&gt;&gt; map;</div><div class="line">    <span class="keyword">boolean</span>[][] ifPalindrome; <span class="comment">//å­˜å‚¨ä»iåˆ°jæ˜¯å¦æ˜¯å›æ–‡åºåˆ—</span></div><div class="line">    <span class="comment">//è®¡ç®—ä»iåˆ°jæ˜¯å¦æ˜¯å›æ–‡åºåˆ—</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[][] palindrome(<span class="keyword">char</span>[] c)&#123;</div><div class="line">        <span class="keyword">int</span> n = c.length;</div><div class="line">        <span class="keyword">boolean</span>[][] ifPalindrome = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][n];</div><div class="line">        <span class="comment">// i ä»nå¼€å§‹ä¸‹é™</span></div><div class="line">        <span class="comment">// j ä»iå¼€å§‹åˆ°n</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span> ; --i )&#123;</div><div class="line">            ifPalindrome[i][i] = <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> j = i+<span class="number">1</span> ; j &lt; n ; ++j )&#123;</div><div class="line">                <span class="keyword">if</span>( c[i] == c[j] )&#123;</div><div class="line">                    ifPalindrome[i][j] = j == i + <span class="number">1</span> || j == i + <span class="number">2</span> || ifPalindrome[i+<span class="number">1</span>][j-<span class="number">1</span>];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ifPalindrome[n-<span class="number">1</span>][n-<span class="number">1</span>] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">return</span> ifPalindrome;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//æ·±åº¦ä¼˜å…ˆéå†</span></div><div class="line">    <span class="keyword">private</span> List&lt;List&lt;String&gt;&gt; dfs(<span class="keyword">char</span>[] c,<span class="keyword">int</span> start,<span class="keyword">int</span> n)&#123;</div><div class="line">        List&lt;List&lt;String&gt;&gt; thisResult = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>( start == n ) <span class="keyword">return</span> thisResult;</div><div class="line">        <span class="keyword">if</span>( map.containsKey(start) )</div><div class="line">            <span class="keyword">return</span> map.get(start);</div><div class="line"></div><div class="line">        StringBuilder strBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> j = start  ; j &lt; n ; ++j )&#123;</div><div class="line">            strBuilder.append(c[j]);</div><div class="line">            <span class="comment">// start ,....,j,.....,end</span></div><div class="line">            <span class="comment">//å¦‚æœä»startåˆ°jæ˜¯å›æ–‡åºåˆ—</span></div><div class="line">            <span class="keyword">if</span>( ifPalindrome[start][j] )&#123;</div><div class="line">                String preString = strBuilder.toString();<span class="comment">//start...jçš„str</span></div><div class="line">                List&lt;List&lt;String&gt;&gt; afterResult = dfs(c,j+<span class="number">1</span>,n);<span class="comment">//ä»j+1åˆ°nçš„æ‰€æœ‰å›æ–‡ä¸²ç»„åˆ</span></div><div class="line">                <span class="keyword">if</span>( afterResult.size() == <span class="number">0</span> )&#123; <span class="comment">// preStringæ˜¯æœ«å°¾å…ƒç´ ï¼Œä¸”å®ƒæœ¬èº«å°±æ˜¯å›æ–‡åºåˆ—</span></div><div class="line">                        List&lt;String&gt; elementUnit = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">                        elementUnit.add(preString);</div><div class="line">                        thisResult.add(elementUnit);</div><div class="line">                        <span class="keyword">continue</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// preStringæ˜¯å‰ç¼€ï¼Œä¸”å®ƒæœ¬èº«å°±æ˜¯å›æ–‡åºåˆ—</span></div><div class="line">                <span class="keyword">for</span>( List&lt;String&gt; oneAfterResult : afterResult )&#123;</div><div class="line">                    List&lt;String&gt; unitResult = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">                    unitResult.add(preString);</div><div class="line">                    <span class="keyword">for</span>( String e : oneAfterResult )&#123;</div><div class="line">                        unitResult.add(e);</div><div class="line">                    &#125;</div><div class="line">                    thisResult.add(unitResult);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        map.put(start,thisResult);</div><div class="line">        <span class="keyword">return</span> thisResult;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="comment">//åˆ†å‰²ä¸»å‡½æ•°</span></div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; partition(String s) &#123;</div><div class="line">        map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        ifPalindrome = palindrome(s.toCharArray());</div><div class="line">        List&lt;List&lt;String&gt;&gt; res =  dfs( s.toCharArray(), <span class="number">0</span>, s.length() );</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Minesweeper">1.3. Minesweeper</h2><p>æ‰«é›·é¢˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">E : æ²¡æ‰“å¼€çš„åœ°æ–¹</div><div class="line">M : æ²¡æ‰“å¼€çš„é›·</div><div class="line">B : æ‰“å¼€äº†ï¼Œå‘¨å›´æ²¡æœ‰é›·</div><div class="line">æ•°å­—<span class="number">1</span>-<span class="number">8</span> ï¼š æ‰“å¼€äº†ï¼Œå‘¨å›´æœ‰kä¸ªé›·</div><div class="line">X: æ‰“å¼€äº†çš„é›·</div></pre></td></tr></table></figure>
<p>è§„åˆ™ï¼š</p>
<ol>
<li>ç‚¹å‡»æŸç‚¹ï¼Œå¦‚æœæ­¤ç‚¹ä¸ºé›·ï¼Œé‚£ä¹ˆå°†æ­¤ç‚¹è®¾ä¸ºXï¼Œæ¸¸æˆç»“æŸ</li>
<li>å¦åˆ™ï¼Œè‡ªåŠ¨æ¢æµ‹å‘¨å›´çš„8ä¸ªç‚¹ï¼Œå¦‚æœæŸç‚¹å‘¨å›´æ²¡æœ‰é›·ï¼Œåˆ™ç»§ç»­æ·±å…¥æ¢æµ‹ï¼›å¦‚æœæŸç‚¹å‘¨å›´æœ‰é›·ï¼Œåˆ™æ ‡è®°é›·ä¸ªæ•°</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] dx = &#123;<span class="number">1</span>, <span class="number">1</span>,<span class="number">1</span>, <span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>&#125;;</div><div class="line">    <span class="keyword">int</span>[] dy = &#123;<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>, <span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span> &#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(x &gt;= board.length || x &lt; <span class="number">0</span> || y &gt;= board[x].length || y &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(board[x][y] == <span class="string">'M'</span>) <span class="keyword">return</span> ; <span class="comment">// æœ‰é›·</span></div><div class="line">        <span class="keyword">if</span>(board[x][y] == <span class="string">'E'</span>) &#123;</div><div class="line">            board[x][y] = <span class="string">'0'</span>;</div><div class="line">          <span class="comment">// æ¢æµ‹å‘¨å›´æœ‰æ²¡æœ‰é›·</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dx.length; ++i) &#123;</div><div class="line">                <span class="keyword">int</span> x_neibor = x + dx[i], y_neibor = y + dy[i];</div><div class="line">                <span class="keyword">if</span>(x_neibor &gt;= board.length || x_neibor &lt; <span class="number">0</span> || y_neibor &gt;= board[x].length || y_neibor &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span> (board[x_neibor][y_neibor] == <span class="string">'M'</span>) &#123;board[x][y] += <span class="number">1</span>;&#125;</div><div class="line">            &#125;</div><div class="line">          <span class="comment">// å¯¹æ²¡æœ‰é›·çš„åœ°æ–¹ç»§ç»­é€’å½’æ¢æµ‹</span></div><div class="line">            <span class="keyword">if</span>(board[x][y] == <span class="string">'0'</span>) &#123;</div><div class="line">                board[x][y] = <span class="string">'B'</span>;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dx.length; ++i)&#123;</div><div class="line">                    helper(board, x + dx[i], y + dy[i] );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">char</span>[][] updateBoard(<span class="keyword">char</span>[][] board, <span class="keyword">int</span>[] click) &#123;</div><div class="line">        <span class="comment">/** E : æ²¡æ‰“å¼€çš„ç©ºåœ°</span></div><div class="line">         *  M : æ²¡æ‰“å¼€çš„é›·**/</div><div class="line">        <span class="keyword">if</span>(board[click[<span class="number">0</span>]][click[<span class="number">1</span>]] == <span class="string">'M'</span>) board[click[<span class="number">0</span>]][click[<span class="number">1</span>]] = <span class="string">'X'</span>;</div><div class="line">        <span class="keyword">else</span> helper(board, click[<span class="number">0</span>],click[<span class="number">1</span>]);</div><div class="line">        <span class="keyword">return</span> board;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Remove-Invalid-Parentheses">1.4. Remove Invalid Parentheses</h2><p>åˆ é™¤å°½é‡å°‘çš„æ‹¬å·ï¼Œä½¿å¾—ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‹¬å·ç¬¦åˆè¦æ±‚</p>
<p>å®åœ¨æ˜¯æ²¡æ€è·¯ï¼Œåˆ°ç°åœ¨ä¹Ÿæ²¡åšä¸Šã€‚å…ˆè®°ä¸€ä¸‹å¥—è·¯å§</p>
<p><strong>æ–¹æ³•1ï¼ŒDFS</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">removeInvalidParentheses</span><span class="params">(String s)</span></span>&#123;</div><div class="line">        <span class="comment">// åˆ†åˆ«æ˜¯å¤šä½™çš„å·¦æ‹¬å·å’Œå¤šä½™çš„å³æ‹¬å·</span></div><div class="line">        <span class="keyword">int</span> rmL = <span class="number">0</span>, rmR = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'('</span>)&#123;</div><div class="line">                ++rmL;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">')'</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(rmL &gt; <span class="number">0</span>)&#123; <span class="comment">// è¿˜æœ‰å¤šä½™çš„å·¦æ‹¬å·</span></div><div class="line">                    --rmL;</div><div class="line">                &#125;<span class="keyword">else</span> &#123; <span class="comment">// æ²¡æœ‰å¤šä½™çš„å·¦æ‹¬å·äº†</span></div><div class="line">                    ++rmR;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        Set&lt;String&gt; res = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">        dfs(s, <span class="number">0</span>, res, <span class="keyword">new</span> StringBuilder(), rmL, rmR, <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;(res);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(String s, <span class="keyword">int</span> i, Set&lt;String&gt; res, StringBuilder sb, <span class="keyword">int</span> rmL, <span class="keyword">int</span> rmR, <span class="keyword">int</span> open)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> len = sb.length();</div><div class="line">        <span class="comment">// rmLå’ŒrmRåˆ†åˆ«é™åˆ¶ç€æœ€å¤§çš„å¯å˜è¾¹ç•Œ</span></div><div class="line">        <span class="keyword">if</span>(open &lt; <span class="number">0</span> || rmL &lt; <span class="number">0</span> || rmR &lt; <span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(i == s.length())&#123;</div><div class="line">            <span class="keyword">if</span>(open == <span class="number">0</span>)res.contains(sb.toString());</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">char</span> c = s.charAt(i);</div><div class="line">        <span class="keyword">if</span>(c == <span class="string">'('</span>)&#123;</div><div class="line">            dfs(s, i + <span class="number">1</span>, res, sb, rmL - <span class="number">1</span>,rmR, open); <span class="comment">// å°è¯•å»é™¤ï¼ˆ</span></div><div class="line">            dfs(s, i + <span class="number">1</span>, res, sb.append(<span class="string">'('</span>), rmL, rmR, open - <span class="number">1</span>);<span class="comment">//ä¸å»é™¤</span></div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c == <span class="string">')'</span>)&#123;</div><div class="line">            dfs(s, i + <span class="number">1</span>, res, sb, rmL, rmR - <span class="number">1</span>, open);<span class="comment">//å°è¯•å»é™¤ ï¼‰</span></div><div class="line">            dfs(s, i + <span class="number">1</span>, res, sb.append(<span class="string">')'</span>), rmL, rmR, open - <span class="number">1</span>);<span class="comment">//ä¸å»é™¤</span></div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            dfs(s, i + <span class="number">1</span>,res, sb.append(c),rmL, rmR, open);</div><div class="line">        &#125;</div><div class="line">        sb.setLength(len); <span class="comment">//é‡ç½®sb</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•2ï¼Œå¥—è·¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(String s, List&lt;String&gt; ans, <span class="keyword">int</span> last_i, <span class="keyword">int</span> last_j, <span class="keyword">char</span>[] pair)</span></span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> stack = <span class="number">0</span>, i = last_i; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == pair[<span class="number">0</span>])++stack;</div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == pair[<span class="number">1</span>])--stack;</div><div class="line">            <span class="comment">//å·¦æ‹¬å·å¤šäºå³æ‹¬å·ï¼Œé‚£å°±ç»§ç»­å¾ªç¯</span></div><div class="line">            <span class="keyword">if</span>(stack &gt; <span class="number">0</span>)<span class="keyword">continue</span>;</div><div class="line">            <span class="comment">// æ­¤æ—¶å·¦æ‹¬å·å°‘äºå³æ‹¬å·ï¼Œä¸€å®šæ˜¯ä¸åˆæ³•çš„ï¼Œé‚£å°±å°è¯•å»é™¤ä¸€ä¸ª</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = last_j; j &lt;= i; ++j)&#123;</div><div class="line">                <span class="comment">// jæ˜¯å³æ‹¬å·ï¼Œä¸”jçš„å‰ä¸€ä¸ªä¸æ˜¯å³æ‹¬å·</span></div><div class="line"></div><div class="line">                <span class="keyword">if</span>(s.charAt(j) == pair[<span class="number">1</span>] &amp;&amp;(j == last_j || s.charAt(j-<span class="number">1</span>) != pair[<span class="number">1</span>]))&#123;</div><div class="line">                    remove(s.substring(<span class="number">0</span>,j) + s.substring(j + <span class="number">1</span>), ans, i, j, pair);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// å› ä¸ºä¹‹å‰æˆ‘ä»¬åªè€ƒè™‘äº†åˆ é™¤å³æ‹¬å·ã€‚é‚£ä¹ˆç°åœ¨åè¿‡æ¥ï¼Œè€ƒè™‘è¯•ä¸€è¯•åˆ é™¤å·¦æ‹¬å·</span></div><div class="line">            String reversed = <span class="keyword">new</span> StringBuilder(s).reverse().toString();</div><div class="line">            <span class="keyword">if</span> (pair[<span class="number">0</span>] == <span class="string">'('</span>) <span class="comment">// finished left to right</span></div><div class="line">                remove(reversed, ans, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">')'</span>, <span class="string">'('</span>&#125;);</div><div class="line">            <span class="keyword">else</span> <span class="comment">// finished right to left</span></div><div class="line">                ans.add(reversed);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Decode-String">1.5. Decode String</h2><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²<code>3[a]2[bc]</code> ã€‚æ•°å­—è¡¨ç¤ºåé¢æ‹¬å·é‡Œçš„å­—ç¬¦é‡å¤æ¬¡æ•°ã€‚æ±‚è§£å‹ä¹‹åçš„å­—ç¬¦ä¸²ã€‚</p>
<p>è¿™é“é¢˜ç¬¬ä¸€éæ²¡æƒ³æ˜ç™½ï¼Œç¬¬äºŒéé‡å†™çš„æ—¶å€™æ‰ä¸€æ°”å‘µæˆã€‚å…¶å®å°±æ˜¯dfsï¼Œå½“é‡åˆ°æ•°å­—æ—¶ï¼Œå°±å°†æ•°å­—åé¢çš„ä¸œè¥¿è§†ä¸ºä¸€ä¸ªæ–°çš„strï¼Œé€’å½’ä¸‹å»ï¼Œé‡åˆ°<code>]</code> å°±è·³å‡ºã€‚è·³å‡ºæ—¶éœ€è¦æºå¸¦è·³å‡ºæ—¶çš„ç»“æŸidxï¼Œå› æ­¤æˆ‘ç”¨äº†ä¸€ä¸ªNodeåŒ…è£…èµ·æ¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">  ä»¥<span class="number">3</span>[a2[c]]ä¸ºä¾‹</div><div class="line">  <span class="number">3</span> [ a <span class="number">2</span> [ c d ] ]</div><div class="line">  <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></div><div class="line">  idx = <span class="number">0</span>, é‡åˆ°<span class="number">3</span> --&gt; a2[cd]] , è·³è¿‡[</div><div class="line">  idx = <span class="number">2</span>, é‡åˆ°<span class="number">2</span> --&gt; cd]] ,å°†cã€dåˆ†åˆ«åŠ å…¥sb,ç„¶åé‡åˆ°äº†](idx = <span class="number">8</span>)ï¼Œå°±è·³å‡ºï¼Œè¿”å›åˆ°ä¸Šå±‚</div><div class="line">  idx = idxEnd = <span class="number">9</span>, ä¸”å°†`cd`é‡å¤<span class="number">2</span>æ¬¡å˜ä¸ºcdcdï¼Œæ­¤æ—¶é‡åˆ°](idx = <span class="number">9</span>)ï¼Œå†æ¬¡è·³å‡ºï¼Œè¿”å›ä¸Šå±‚</div><div class="line">  idx = idxEnd = <span class="number">10</span>, ä¸”å°†cdcdåŠ å…¥åˆ°sbä¸­ï¼Œæ­¤æ—¶sbå˜æˆacbcdï¼Œè·³å‡ºï¼Œè¿”å›ä¸Šå±‚</div><div class="line">  å†å°†acbcdé‡å¤<span class="number">3</span>æ¬¡</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">       String str;</div><div class="line">       <span class="keyword">int</span> endIdx;</div><div class="line">       Node(String str, <span class="keyword">int</span> endIdx)&#123;</div><div class="line">           <span class="keyword">this</span>.str = str;</div><div class="line">           <span class="keyword">this</span>.endIdx = endIdx;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isLetter</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">       <span class="keyword">return</span> (c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'z'</span>) || (c &gt;= <span class="string">'A'</span> &amp;&amp; c &lt;= <span class="string">'Z'</span>);</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isNum</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">       <span class="keyword">return</span> c &gt;=<span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">private</span> Node <span class="title">helper</span><span class="params">(String s, <span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">       StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">       <span class="keyword">while</span> (idx &lt; s.length())&#123;</div><div class="line">           <span class="keyword">while</span> (idx &lt; s.length() &amp;&amp; isLetter(s.charAt(idx)))&#123;</div><div class="line">               sb.append(s.charAt(idx++));</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">int</span> numStart = idx;</div><div class="line">           <span class="keyword">while</span>(idx &lt; s.length() &amp;&amp; isNum(s.charAt(idx)))&#123;++idx;&#125;</div><div class="line">           <span class="keyword">int</span> repeat = <span class="number">0</span>;</div><div class="line">           <span class="keyword">if</span>(idx &gt; numStart)&#123;</div><div class="line">               repeat = Integer.valueOf(s.substring(numStart, idx));</div><div class="line">               Node next = helper(s, idx + <span class="number">1</span>);</div><div class="line">               <span class="keyword">while</span> (repeat-- &gt; <span class="number">0</span>)&#123;sb.append(next.str);&#125;</div><div class="line">               idx = next.endIdx;</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">if</span>(idx &lt; s.length() &amp;&amp; s.charAt(idx) == <span class="string">']'</span>)&#123;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">new</span> Node(sb.toString(), idx + <span class="number">1</span>);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">new</span> Node(sb.toString(), idx + <span class="number">1</span>);</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">decodeString</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> helper(s,<span class="number">0</span>).str;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>å…¶å®å†æ€è€ƒäº†ä¸€ä¸‹ï¼Œidxå®Œå…¨å¯ä»¥è®¾ä¸ºå…¨å±€å˜é‡ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isLetter</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> (c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'z'</span>) || (c &gt;= <span class="string">'A'</span> &amp;&amp; c &lt;= <span class="string">'Z'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isNum</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> c &gt;=<span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> idx = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">helper</span><span class="params">(String s)</span></span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">while</span> (idx &lt; s.length())&#123;</div><div class="line">            <span class="keyword">while</span> (idx &lt; s.length() &amp;&amp; isLetter(s.charAt(idx)))&#123;</div><div class="line">                sb.append(s.charAt(idx++));</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> numStart = idx;</div><div class="line">            <span class="keyword">while</span>(idx &lt; s.length() &amp;&amp; isNum(s.charAt(idx)))&#123;++idx;&#125;</div><div class="line">            <span class="keyword">int</span> repeat = <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span>(idx &gt; numStart)&#123;</div><div class="line">                repeat = Integer.valueOf(s.substring(numStart, idx));</div><div class="line">                ++idx; <span class="comment">// è·³è¿‡[ç¬¦å·</span></div><div class="line">                String next = helper(s);</div><div class="line">                <span class="keyword">while</span> (repeat-- &gt; <span class="number">0</span>)&#123;sb.append(next);&#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(idx &lt; s.length() &amp;&amp; s.charAt(idx) == <span class="string">']'</span>)&#123;</div><div class="line">                ++idx;<span class="comment">//è·³è¿‡]ç¬¦å·</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">decodeString</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(s);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Pacific-Atlantic-Water-Flow">1.6. Pacific Atlantic Water Flow</h2><p>ç»™ä¸€ä¸ªçŸ©é˜µã€‚å·¦å’Œä¸Šæ˜¯å¤ªå¹³æ´‹ï¼Œå³å’Œä¸‹æ˜¯å¤§è¥¿æ´‹ã€‚æ±‚ä¸­é—´å“ªäº›ç‚¹çš„æ°´å¯ä»¥åŒæ—¶æµåˆ°ä¸¤ä¸ªæ´‹</p>
<p>æ€è·¯ï¼šåå‘æ€è€ƒã€‚ä»è¾¹ç•Œå‡ºå‘ï¼Œå¯»æ‰¾é€’å¢çš„æ–¹å‘ã€‚æ‰€æœ‰é€’å¢çš„éƒ½æ˜¯èƒ½æµåˆ°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setVisited</span><span class="params">(<span class="keyword">int</span>[][] matrix,<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> val )</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(i &gt;= matrix.length || i &lt; <span class="number">0</span> || j &gt;= matrix[i].length || j &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(visited[i][j] != <span class="number">0</span> &amp;&amp; visited[i][j] != val)&#123;</div><div class="line">        result.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i,j&#125;);</div><div class="line">        visited[i][j] = <span class="number">3</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        visited[i][j] = val;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//System.out.println(i + "\t"  + j + "\t" + visited[i][j] + val);</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> last, <span class="keyword">int</span> val)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(i &gt;= matrix.length || i &lt; <span class="number">0</span> || j &gt;= matrix[i].length || j &lt; <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(matrix[i][j] &lt; last || visited[i][j] == val || visited[i][j] == <span class="number">3</span>) <span class="keyword">return</span>;</div><div class="line">    setVisited(matrix,i, j, val );</div><div class="line">    <span class="comment">// ç»§ç»­æ¢æµ‹å‘¨å›´çš„ç‚¹</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</div><div class="line">        dfs(matrix, i + di[k], j + dj[k], matrix[i][j], val);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">List&lt;<span class="keyword">int</span>[]&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"><span class="keyword">int</span>[][] visited;</div><div class="line"><span class="keyword">int</span>[] di = &#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">int</span>[] dj = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">public</span> List&lt;<span class="keyword">int</span>[]&gt; pacificAtlantic(<span class="keyword">int</span>[][] matrix) &#123;</div><div class="line">    <span class="keyword">if</span>(matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>)<span class="keyword">return</span> result;</div><div class="line">    visited = <span class="keyword">new</span> <span class="keyword">int</span>[matrix.length][matrix[<span class="number">0</span>].length];</div><div class="line">    <span class="comment">// pacific : i == 0 or j == 0</span></div><div class="line">    <span class="comment">// atlantic : i == matrix.length - 1 or j == matrix[i].length - 1</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; matrix[<span class="number">0</span>].length; ++j)&#123;</div><div class="line">        dfs(matrix, <span class="number">0</span>, j, matrix[<span class="number">0</span>][j], <span class="number">1</span>);<span class="comment">// pacific</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrix.length; ++i)&#123;</div><div class="line">        dfs(matrix, i, <span class="number">0</span>,  matrix[i][<span class="number">0</span>], <span class="number">1</span>);<span class="comment">// pacific</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; matrix[<span class="number">0</span>].length; ++j)&#123;</div><div class="line">        dfs(matrix, matrix.length - <span class="number">1</span>, j,matrix[matrix.length - <span class="number">1</span>][j], <span class="number">2</span>);<span class="comment">// atlantic</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrix.length; ++i)&#123;</div><div class="line">        dfs(matrix, i, matrix[i].length - <span class="number">1</span>,  matrix[i][matrix[i].length - <span class="number">1</span>], <span class="number">2</span>);<span class="comment">// atlantic</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æ¶ˆé™¤æ¸¸æˆé›†é”¦">2. æ¶ˆé™¤æ¸¸æˆé›†é”¦</h1><h2 id="Strange-Printer">2.1. Strange Printer</h2><p>æœ‰ä¸€ç§æ‰“å°æ–¹å¼ï¼Œæ¯è½®åªæ‰“å°å…ƒç´ ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œæ‰“å°æ—¶è¿˜ä¼šè¦†ç›–åŸæ¥çš„å­—ç¬¦ä¸²ã€‚ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æ‰“å°è¿™ä¸ªå­—ç¬¦ä¸²æ‰€éœ€è¦æœ€å°‘çš„è½®æ•°ã€‚</p>
<p>æˆ‘å¥½åƒç†è§£é”™é¢˜æ„äº†ã€‚çœ‹å®Œäº†ç­”æ¡ˆï¼Œæƒ³å“­ã€‚å›å¤´å†æˆ˜ã€‚</p>
<h2 id="Zuma-Game">2.2. Zuma Game</h2><p>ç›´åˆ°ä¸‰åˆ·æ‰åšå‡ºæ¥çš„é¢˜ã€‚</p>
<p>ç»™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²boardè¡¨ç¤ºç°åœ¨çš„çƒï¼Œhandè¡¨ç¤ºæ‰‹é‡Œæ‹¿çš„çƒã€‚å¯ä»¥æŠŠæ‰‹é‡Œçš„æŸä¸ªé¢œè‰²çƒæ’å…¥åˆ°boardï¼Œä½¿å¾—æ’å…¥ä½ç½®ç›¸é‚»çš„æœ‰3ä¸ªæˆ–ä»¥ä¸Šçš„çƒé¢œè‰²ä¸€æ ·ï¼Œå°±ä¼šæ¶ˆé™¤é¢œè‰²ä¸€æ ·çš„çƒã€‚</p>
<p>æ±‚èƒ½æ¶ˆé™¤æ‰€æœ‰çƒæ—¶ï¼Œæ’å…¥çš„æœ€å°æ¬¡æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Character, Integer&gt; hand_hash;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findLongestSame</span><span class="params">(String board, <span class="keyword">int</span> start)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> end = start +<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (end &lt; board.length() &amp;&amp; board.charAt(start) == board.charAt(end))&#123;</div><div class="line">            ++end;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> counter = end - start;</div><div class="line">        <span class="keyword">return</span> counter;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æ±‚boardæœ€å°‘æ’å…¥æ¬¡æ•°</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(String board)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(board.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> used = <span class="number">1000</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; board.length(); )&#123;</div><div class="line">            <span class="comment">//ä»iå¼€å§‹å¯»æ‰¾æœ€é•¿çš„å­æ•°ç»„</span></div><div class="line">            <span class="keyword">int</span> counter = findLongestSame(board, i);</div><div class="line">            <span class="keyword">if</span>(counter&gt;= <span class="number">3</span>)&#123; <span class="comment">// ä»iå¼€å§‹å¯ä»¥æ¶ˆé™¤counterä¸ªï¼Œé‚£å°±å…ˆæ¶ˆé™¤äº†ï¼</span></div><div class="line">                <span class="keyword">return</span> helper(board.substring(<span class="number">0</span>,i) + board.substring(i+counter));</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// å¦åˆ™ï¼Œçœ‹çœ‹æ‰‹é‡Œçƒå¤Ÿä¸å¤Ÿï¼Œå°è¯•æ¶ˆé™¤è¯•ä¸€è¯•</span></div><div class="line">            <span class="keyword">if</span>(hand_hash.getOrDefault(board.charAt(i), <span class="number">0</span>) + counter &gt;= <span class="number">3</span>)&#123;</div><div class="line">                <span class="keyword">int</span> used_curr = <span class="number">3</span> - counter;</div><div class="line">                hand_hash.replace(board.charAt(i), hand_hash.get(board.charAt(i)) - used_curr);</div><div class="line">                used = Math.min(used,</div><div class="line">                        used_curr + helper(board.substring(<span class="number">0</span>,i) + board.substring(i + counter)));</div><div class="line">                hand_hash.replace(board.charAt(i), hand_hash.get(board.charAt(i)) + used_curr);</div><div class="line">            &#125;</div><div class="line">            i = i + counter;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> used;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMinStep</span><span class="params">(String board, String hand)</span> </span>&#123;</div><div class="line">        hand_hash = <span class="keyword">new</span> HashMap&lt;&gt;(hand.length());</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : hand.toCharArray())&#123;</div><div class="line">            hand_hash.put(c, hand_hash.getOrDefault(c, <span class="number">0</span>) + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> result = helper(board);</div><div class="line">        <span class="keyword">return</span> result == <span class="number">1000</span> ? -<span class="number">1</span> : result;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Remove-Boxes-leetcode">2.3. Remove Boxes leetcode</h2>]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-DP]]></title>
      <url>/2017/11/17/%E7%AE%97%E6%B3%95-DP/</url>
      <content type="html"><![CDATA[<h1 id="ç†è§£åŠ¨æ€è§„åˆ’">1. ç†è§£åŠ¨æ€è§„åˆ’</h1><p>å¼•å…¥ä¾‹é¢˜ï¼š<strong>triangle</strong></p>
<p>ç»™ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæ‰¾åˆ°ä»ä¸Šåˆ°ä¸‹æœ€çŸ­çš„è·¯å¾„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">     [2],</div><div class="line">    [3,4],</div><div class="line">   [6,5,7],</div><div class="line">  [4,1,8,3]</div><div class="line">]</div></pre></td></tr></table></figure>
<p>æœ€çŸ­è·¯å¾„æ˜¯<code>11</code> (i.e., 2 + 3 + 5 + 1 = 11).</p>
<p>n = ä¸‰è§’å½¢é«˜åº¦</p>
<p>æˆ‘ä»¬ç”¨ä¸‹é¢å‡ ç§æ–¹æ³•æ¥æ€è€ƒè¿™ä¸ªé¢˜ã€‚</p>
<a id="more"></a>
<h2 id="æ–¹æ³•1ï¼ŒDFSéå†">1.1. æ–¹æ³•1ï¼ŒDFSéå†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumTotal</span><span class="params">(<span class="keyword">int</span>[][] triangle)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> best = Integer.MAX_VALUE;</div><div class="line">  n = triangle.length;</div><div class="line">  dfs(triangle,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">  <span class="keyword">return</span> best;</div><div class="line">&#125;</div><div class="line"><span class="comment">// sum = root -&gt; x,y ,ä¸åŒ…å«x,yçš„è·¯å¾„å’Œ</span></div><div class="line"><span class="function"><span class="keyword">public</span> vid <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[][] triangle,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> sum)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( x == n )&#123;</div><div class="line">    best = Math.max(best,sum);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  dfs( triangle, x+<span class="number">1</span>, y, sum + triangle[x][y] );</div><div class="line">  dfs( triangle , x+<span class="number">1</span>, y+<span class="number">1</span>, sum + triangle[x][y] );</div><div class="line">  <span class="comment">/**åæ ‡å…³ç³»</span></div><div class="line">   [2]   -&gt;    [0,0]</div><div class="line">   [3,4]  -&gt;   [1,0],[1,1]</div><div class="line">  **/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¤æ‚åº¦ï¼š$O(2^n)$</p>
<h2 id="æ–¹æ³•2ï¼Œåˆ†æ²»æ³•">1.2. æ–¹æ³•2ï¼Œåˆ†æ²»æ³•</h2><p>æ²¡æœ‰bestå…¨å±€å˜é‡ï¼Œæ›´å¥½ä¸€äº›ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">divideConquer</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( x == n )&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> A[x][y] + Math.min(</div><div class="line">    divideConquer(x+<span class="number">1</span>,y),</div><div class="line">  	divideConquer(x+<span class="number">1</span>,y+<span class="number">1</span>)</div><div class="line">    );</div><div class="line">&#125;</div><div class="line"></div><div class="line">divideConquer(<span class="number">0</span>,<span class="number">0</span>);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªåˆ†æ²»çš„å®šä¹‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**åˆ†æ²»å®šä¹‰</span></div><div class="line"></div><div class="line">[x,y]è¡¨ç¤ºä»x,yå‡ºå‘ï¼Œåˆ°åº•å±‚çš„æœ€çŸ­è·ç¦»</div><div class="line"></div><div class="line">  [x,y]</div><div class="line">    â†“    â†˜</div><div class="line">[x+1,y] [x+1,y+1]</div><div class="line"></div><div class="line">ä»[x,y]å‡ºå‘ï¼Œæœ‰ä¸¤æ¡è·¯ï¼š[x+1,y]å’Œ[x+1,y+1]ï¼Œè¿™å…¶å®æ˜¯ä¸¤ä¸ªå­é—®é¢˜</div><div class="line"></div><div class="line">è€Œ[x,y] = Math.min( [x+1,y],[x+1,y+1] ) + A[x,y]</div><div class="line"></div><div class="line">**/</div></pre></td></tr></table></figure>
<p>å¤æ‚åº¦ï¼š$2^n$</p>
<h2 id="æ–¹æ³•3ï¼Œè®°å¿†åŒ–æœç´¢">1.3. æ–¹æ³•3ï¼Œè®°å¿†åŒ–æœç´¢</h2><p>æˆ‘ä»¬å…ˆå›å¤´çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">  [x,y]</div><div class="line">    â†“    â†˜</div><div class="line">[x+1,y] [x+1,y+1]</div><div class="line"></div><div class="line">   â†“      â†˜ â†“       â†˜</div><div class="line">[x+2,y] [x+2,y+1] [x+2,y+2]</div><div class="line"></div><div class="line">**/</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‘ç°[x+2,y+1]è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼</p>
<p>å°±å¯ä»¥ç”¨ä¸€å¼ å“ˆå¸Œè¡¨æ¥å­˜å‚¨æ›¾ç»è®¡ç®—è¿‡çš„[x,y]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">divideConquer</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(x == n)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//å¦‚æœä¹‹å‰è®¡ç®—è¿‡ï¼Œå°±ç›´æ¥è¿”å›</span></div><div class="line">  <span class="keyword">if</span>( hash[x][y] != Integer.MAX_VALUE )&#123;</div><div class="line">    <span class="keyword">return</span> hash[x][y];</div><div class="line">  &#125;</div><div class="line">  hash[x][y] =  A[x][y] + Math.min(</div><div class="line">    divideConquer(x+<span class="number">1</span>,y),</div><div class="line">  	divideConquer(x+<span class="number">1</span>,y+<span class="number">1</span>));</div><div class="line">  <span class="keyword">return</span> hash[x][y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">initialize: hash[*][*] = Integer.MAX_VALUE;</div><div class="line">answser: divideConqure(<span class="number">0</span>,<span class="number">0</span>);</div></pre></td></tr></table></figure>
<p>å¤æ‚åº¦:$n^2$</p>
<p>è§£å†³äº†é‡å¤è®¡ç®—çš„é—®é¢˜ã€‚</p>
<p>è®°å¿†åŒ–æœç´¢æ˜¯ä¸€ç§lazy loadingæ¨¡å¼ï¼Œéœ€è¦çš„æ—¶å€™å†å»ç®—ï¼Œç®—å®Œäº†å­˜ä¸‹æ¥ã€‚å±äºè‡ªé¡¶å‘ä¸‹çš„è®¡ç®—ã€‚</p>
<h2 id="æ–¹æ³•4ï¼Œå¤šé‡å¾ªç¯">1.4. æ–¹æ³•4ï¼Œå¤šé‡å¾ªç¯</h2><p>è¿™æ˜¯ä¸€ç§å¾ˆå‹¤åŠ³çš„æ¨¡å¼ã€‚å°±æ˜¯æå‰ç®—å¥½æ‰€éœ€è¦çš„ä¸€åˆ‡ï¼Œç„¶åå†è¿”å›ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span>,<span class="number">3</span></div><div class="line"><span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></div></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯è‡ªé¡¶å‘ä¸‹ï¼Œä¸€ç§æ˜¯è‡ªåº•å‘ä¸Šã€‚</p>
<h3 id="è‡ªé¡¶å‘ä¸‹">1.4.1. è‡ªé¡¶å‘ä¸‹</h3><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è‡ªé¡¶å‘ä¸‹ã€‚</p>
<p>æˆ‘ä»¬å…ˆè®¡ç®—ä»1åˆ°2ã€3çš„æœ€çŸ­è·¯å¾„ï¼Œç„¶åè®¡ç®—ä»1åˆ°4/5/6çš„æœ€çŸ­è·¯å¾„ã€‚æœ€åä»4/5/6ä¸­æŒ‘ä¸€ä¸ªæœ€å°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">f[i][j]è¡¨ç¤ºä»é¡¶å‡ºå‘ï¼Œèµ°åˆ°i,jçš„æœ€å°è·¯å¾„é•¿åº¦</div><div class="line"><span class="comment">//åˆå§‹åŒ–</span></div><div class="line">f[<span class="number">0</span>][<span class="number">0</span>] = A[<span class="number">0</span>][<span class="number">0</span>]</div><div class="line"><span class="comment">//åˆå§‹åŒ–ä¸‰è§’å½¢çš„å·¦è¾¹å’Œå³è¾¹</span></div><div class="line"><span class="comment">//æœ€å·¦ã€å³è¾¹çš„æ‰€æœ‰ç‚¹ï¼Œä»1å‡ºå‘åªæœ‰ä¸€æ¡è·¯å¾„ï¼</span></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++i)&#123;</div><div class="line">f[i][<span class="number">0</span>] = f[i-<span class="number">1</span>][<span class="number">0</span>] + A[i][<span class="number">0</span>];</div><div class="line">f[i][i] = f[i-<span class="number">1</span>][i-<span class="number">1</span>] + A[i][i];</div><div class="line">&#125;</div><div class="line"><span class="comment">//è‡ªé¡¶å‘ä¸‹</span></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++i )&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; i ; ++j )&#123;</div><div class="line">	f[i][j] = Math.min(f[i-<span class="number">1</span>][j],f[i-<span class="number">1</span>][j-<span class="number">1</span>]) + A[i][j];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> Math.min(f[n-<span class="number">1</span>][<span class="number">0</span>],f[n-<span class="number">1</span>][<span class="number">1</span>],...);</div></pre></td></tr></table></figure>
<h3 id="è‡ªåº•å‘ä¸Š">1.4.2. è‡ªåº•å‘ä¸Š</h3><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹è‡ªåº•å‘ä¸Šçš„æ–¹å¼ã€‚</p>
<p>æˆ‘ä»¬æƒ³è¦è®¡ç®—1åˆ°æœ€åº•ç«¯çš„æœ€å°è·ç¦»ï¼Œé‚£å°±éœ€è¦çŸ¥é“2å’Œ3çš„ã€‚é‚£ä¹ˆå°±è¦éœ€è¦çŸ¥é“4,5,6çš„ã€‚é‚£æˆ‘ä»¬å…ˆä»4,5,6è®¡ç®—èµ·ã€‚å±äºè‡ªåº•å‘ä¸Šçš„è®¡ç®—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">A[][]</div><div class="line"></div><div class="line"><span class="comment">//çŠ¶æ€å®šä¹‰</span></div><div class="line">f[i][j]è¡¨ç¤ºä»i,jå‡ºå‘èµ°åˆ°æœ€åä¸€å±‚çš„æœ€å°è·¯å¾„é•¿åº¦</div><div class="line"><span class="comment">//åˆå§‹åŒ–,ç»ˆç‚¹å…ˆæœ‰å€¼</span></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++i )&#123;</div><div class="line">	f[n-<span class="number">1</span>][i] = A[n-<span class="number">1</span>][i];</div><div class="line">&#125;</div><div class="line"><span class="comment">//å¾ªç¯æ±‚è§£</span></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span> ; --i )&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++j)&#123;</div><div class="line">	f[i][j] = Math.min(f[i+<span class="number">1</span>][j],f[i+<span class="number">1</span>][j+<span class="number">1</span>]) + A[i][j];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> f[<span class="number">0</span>][<span class="number">0</span>]</div></pre></td></tr></table></figure>
<h1 id="ä»€ä¹ˆæ—¶å€™ç”¨DP">2. ä»€ä¹ˆæ—¶å€™ç”¨DP</h1><p>ä¸‰ä¸ªæ¡ä»¶æ»¡è¶³å…¶ä¸€å³<strong>æœ‰å¯èƒ½</strong>æ˜¯è¦ç”¨DPï¼š</p>
<ul>
<li>æ±‚æå€¼</li>
<li>åˆ¤æ–­æ˜¯å¦å¯è¡Œ</li>
<li>ç»Ÿè®¡æ–¹æ¡ˆä¸ªæ•°</li>
<li>æ“…é•¿å°†$2^n-&gt;n^2$</li>
</ul>
<h1 id="ä»€ä¹ˆæ—¶å€™ä¸ç”¨DP">3. ä»€ä¹ˆæ—¶å€™ä¸ç”¨DP</h1><p>ä¸‰ä¸ªæ¡ä»¶æ»¡è¶³å…¶ä¸€å³<strong>æœ‰å¯èƒ½</strong>æ˜¯ä¸ç”¨DPï¼š</p>
<ul>
<li>æ±‚æ‰€æœ‰<strong>å…·ä½“</strong>çš„æ–¹æ¡ˆï¼ˆè¾“å‡ºæ‰€æœ‰å›æ–‡ä¸²ï¼‰</li>
<li>è¾“å…¥æ˜¯<strong>é›†åˆ</strong>ï¼ˆæ˜¯æ— åºçš„ï¼‰ï¼Œè€Œä¸æ˜¯åºåˆ—ï¼ˆæ±‚æœ€é•¿è¿ç»­åºåˆ—ï¼‰ï¼ŒèƒŒåŒ…é—®é¢˜æ˜¯ä¾‹å¤–</li>
<li>æš´åŠ›æ–¹æ³•çš„å¤æ‚åº¦å·²ç»æ˜¯å¤šé¡¹å¼çº§åˆ«ï¼Œä¸æ“…é•¿$n^3-&gt;n^2$</li>
</ul>
<h1 id="DPå››è¦ç´ ">4. DPå››è¦ç´ </h1><p><strong>çŠ¶æ€</strong>ï¼š<code>f[][]</code>çš„å«ä¹‰ï¼Œ<strong>æœ€éš¾</strong>ï¼</p>
<p><strong>æ–¹ç¨‹</strong>ï¼šçŠ¶æ€ä¹‹é—´çš„è”ç³»ï¼Œæ€ä¹ˆç”¨å°çŠ¶æ€ç®—å¤§çŠ¶æ€</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼šæœ€å°çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Œèµ·ç‚¹</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼šæœ€å¤§çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Œç»ˆç‚¹</p>
<p><strong>VSé€’å½’ä¸‰è¦ç´ </strong></p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼ˆçŠ¶æ€ï¼‰<ul>
<li>æ¥å—äº†ä»€ä¹ˆå‚æ•°</li>
<li>åšäº†ä»€ä¹ˆäº‹æƒ…</li>
<li>è¿”å›äº†ä»€ä¹ˆå€¼</li>
</ul>
</li>
<li><strong>æ‹†è§£</strong>ï¼ˆæ–¹ç¨‹ï¼‰<ul>
<li>ç¬¦åˆå°†å‚æ•°å˜å°</li>
</ul>
</li>
<li><strong>å‡ºå£</strong>ï¼ˆåˆå§‹åŒ–ï¼‰<ul>
<li>ä»€ä¹ˆæ—¶å€™å¯ä»¥ç›´æ¥return</li>
</ul>
</li>
</ul>
<h1 id="å¸¸è§DP">5. å¸¸è§DP</h1><p><strong>åæ ‡å‹ 15%</strong></p>
<p><strong>åºåˆ—å‹ 30%</strong></p>
<p><strong>åŒåºåˆ— 30%</strong></p>
<p>åˆ’åˆ†å‹ 10%</p>
<p>èƒŒåŒ…å‹ 10%</p>
<p>åŒºé—´å‹ 5%</p>
<h2 id="åæ ‡å‹ï¼ˆçŸ©é˜µï¼‰DP">5.1. åæ ‡å‹ï¼ˆçŸ©é˜µï¼‰DP</h2><p>ç‰¹ç‚¹ï¼šå°äººåœ¨æŒ‰ç…§æŸç§æ–¹å‘è·³</p>
<p><strong>çŠ¶æ€</strong>ï¼š</p>
<ul>
<li><code>f[x]</code>ï¼šä»èµ·ç‚¹èµ°åˆ°åæ ‡xâ€¦</li>
<li><code>f[x][y]</code>ï¼šä»èµ·ç‚¹èµ°åˆ°åæ ‡x,yâ€¦</li>
</ul>
<p><strong>æ–¹ç¨‹</strong>ï¼šç ”ç©¶èµ°åˆ°x,yè¿™ä¸ªç‚¹ä¹‹å‰çš„è¿™ä¸€æ­¥</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼šèµ·ç‚¹</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼šé‡ç‚¹</p>
<h3 id="ä¾‹é¢˜1ï¼šMinimum-Path-Sum">5.1.1. ä¾‹é¢˜1ï¼šMinimum Path Sum</h3><p>é¢˜ç›®ï¼šä»å·¦ä¸Šèµ°åˆ°å³ä¸‹æœ€çŸ­è·ç¦»ã€‚åªèƒ½å‘å³å‘ä¸‹èµ°ã€‚æ±‚æœ€å°è·¯å¾„</p>
<p><strong>çŠ¶æ€ï¼š</strong><code>f[x][y]</code> : ä»èµ·ç‚¹èµ°åˆ°x,yçš„æœ€çŸ­è·¯å¾„</p>
<p><strong>æ–¹ç¨‹</strong>ï¼š<code>f[x][y] = Math.min(f[x-1][y],f[x][y-1]+A[x][y]</code></p>
<p><strong>åˆå§‹åŒ–</strong>ï¼šè¾¹ç•Œ</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<code>f[n][m]</code></p>
<h3 id="ä¾‹é¢˜2ï¼ŒUnique-Paths">5.1.2. ä¾‹é¢˜2ï¼ŒUnique Paths</h3><p>é¢˜ç›®ï¼šä»å·¦ä¸Šèµ°åˆ°å³ä¸‹æœ€çŸ­è·ç¦»ã€‚åªèƒ½å‘å³å‘ä¸‹èµ°ã€‚æ±‚æ–¹æ¡ˆä¸ªæ•°ã€‚</p>
<p><strong>çŠ¶æ€</strong>ï¼š<code>f[x][y]</code>ï¼šä»[0,0]å‡ºå‘ï¼Œåˆ°[x,y]çš„æ–¹æ¡ˆæ€»æ•°</p>
<p><strong>æ–¹ç¨‹</strong>ï¼š<code>f[x][y] = f[x-1][y] + f[x][y-1]</code>ï¼ˆéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œ<code>[x-1,y]</code>å’Œ<code>[x,y-1]</code>ä¸¤ç§æ–¹æ¡ˆä¸ä¼šé‡å ï¼ï¼‰</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼šç¬¬0è¡Œã€ç¬¬0åˆ—çš„è¾¹ç•Œ</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<code>f[n][m]</code></p>
<h3 id="ä¾‹é¢˜3ï¼ŒUnique-Paths-II">5.1.3. ä¾‹é¢˜3ï¼ŒUnique Paths II</h3><p>å¦‚æœè·¯ä¸Šæœ‰éšœç¢ï¼Œæ±‚æ–¹æ¡ˆä¸ªæ•°ã€‚</p>
<h3 id="Knight-Probability-in-Chessboard">5.1.4. Knight Probability in Chessboard</h3><p>ç»™ä¸€ä¸ª$n \times n$ çš„æ£‹ç›˜ï¼Œæ¯æ¬¡å¯ä»¥èµ°å…«ä¸ªæ–¹å‘ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚æ±‚ä»[r,c] å‡ºå‘èµ°Kæ­¥ä¹‹åå®ƒè¿˜åœç•™åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2018-01-16-17-16-47.png" alt=""> </p>
<p><strong>æ–¹æ³•1ï¼Œæš´è§£</strong></p>
<p>æš´è§£è‚¯å®šä¼šè¶…æ—¶ï¼Œä½†æ˜¯åŸºç¡€æ€è·¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> in;</div><div class="line">        <span class="keyword">int</span> all;</div><div class="line">        Node(<span class="keyword">int</span> in, <span class="keyword">int</span> all)&#123;</div><div class="line">            <span class="keyword">this</span>.in = in; </div><div class="line">            <span class="keyword">this</span>.all = all;</div><div class="line">        &#125;</div><div class="line">        Node()&#123;&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span>[][] direct = &#123;&#123;<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">1</span>,-<span class="number">2</span>&#125;,&#123;-<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;-<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;-<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;-<span class="number">1</span>,-<span class="number">2</span>&#125;&#125;; <span class="comment">// è¿™ä¸ªæ–¹å‘å¾ˆé‡è¦å•Šï¼Œä¸€å¼€å§‹çš„æ—¶å€™çœ‹é”™é¢˜äº†ï¼Œä»¥ä¸ºæ˜¯ç›¸é‚»çš„å…«ä¸ªï¼Œç»“æœè°ƒäº†å¥½ä¹…</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">helper</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(r &lt; <span class="number">0</span> || c &lt; <span class="number">0</span> || r &gt;= N || c &gt;= N)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Node(<span class="number">0</span>, (<span class="keyword">int</span>)Math.pow(<span class="number">8</span>,K)); <span class="comment">// æ­¤æ—¶å·²ç»å‡ºæ ¼å­äº†ï¼Œæ— è®ºæ¥ä¸‹æ¥çš„Kæ­¥æ€ä¹ˆèµ°ï¼Œéƒ½ä¸èƒ½è·³å›å»ã€‚å› æ­¤æ¥ä¸‹æ¥çš„Kæ­¥çš„æ‰€æœ‰æ–¹æ¡ˆéƒ½ä¸è¡Œ</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(K == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> Node(<span class="number">1</span>, <span class="number">1</span>);</div><div class="line">        Node curr = <span class="keyword">new</span> Node();</div><div class="line">		<span class="comment">// å½“å‰æ ¼å­èµ°Kæ­¥åï¼Œç•™åœ¨æ£‹ç›˜å†…çš„å¯èƒ½ä¸ªæ•° = curr.in</span></div><div class="line">        <span class="comment">// å½“å‰æ ¼å­èµ°Kæ­¥çš„å…¨éƒ¨å¯èƒ½çš„èµ°æ³•ä¸ªæ•° = curr.all</span></div><div class="line">      </div><div class="line">        <span class="comment">// éå†æ‰€æœ‰çš„æ–¹å‘</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] dir : direct)&#123;</div><div class="line">            Node next = helper(N, K - <span class="number">1</span>, r + dir[<span class="number">0</span>], c + dir[<span class="number">1</span>]);</div><div class="line">            curr.all += next.all;</div><div class="line">            curr.in += next.in;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> curr;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">        Node res = helper(N, K, r, c);</div><div class="line">        <span class="keyword">return</span> ((<span class="keyword">double</span>)res.in) / ((<span class="keyword">double</span>)res.all);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å…¶å®åˆ°æœ€åres.all éƒ½ä¼šç­‰äº$8^K$ ,å› æ­¤åªéœ€è¦è®°å½•inçš„ä¸ªæ•°å³å¯ã€‚</p>
<p><strong>æ–¹æ³•2ï¼Œè®°å¿†åŒ–æœç´¢</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[][] direct = &#123;&#123;<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">1</span>,-<span class="number">2</span>&#125;,&#123;-<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;-<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;-<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;-<span class="number">1</span>,-<span class="number">2</span>&#125;&#125;;</div><div class="line"> <span class="keyword">double</span> [][][] memo;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">     <span class="keyword">if</span>(r &lt; <span class="number">0</span> || c &lt; <span class="number">0</span> || r &gt;= N || c &gt;= N)&#123;</div><div class="line">         <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     <span class="keyword">if</span>(memo[r][c][K] &gt;= <span class="number">0</span>) <span class="keyword">return</span> memo[r][c][K];</div><div class="line">     <span class="keyword">if</span>(K == <span class="number">0</span>)&#123;</div><div class="line">         memo[r][c][K] = <span class="number">1</span>;</div><div class="line">         <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">int</span> curr = <span class="number">0</span>;</div><div class="line">     <span class="comment">// å½“å‰æ ¼å­èµ°Kæ­¥åï¼Œç•™åœ¨æ£‹ç›˜å†…çš„å¯èƒ½ä¸ªæ•° = curr</span></div><div class="line">     <span class="keyword">for</span>(<span class="keyword">int</span>[] dir : direct)&#123;</div><div class="line">         curr += helper(N, K - <span class="number">1</span>, r + dir[<span class="number">0</span>], c + dir[<span class="number">1</span>]);</div><div class="line">     &#125;</div><div class="line">     memo[r][c][K] = curr;</div><div class="line">     System.out.println(curr);</div><div class="line">     <span class="keyword">return</span> memo[r][c][K];</div><div class="line"> &#125;</div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line"></div><div class="line">     memo = <span class="keyword">new</span> <span class="keyword">double</span>[N][N][K + <span class="number">1</span>];</div><div class="line">     <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</div><div class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j)&#123;</div><div class="line">             Arrays.fill(memo[i][j], -<span class="number">1</span>);</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">double</span> inCount = helper(N, K, r, c);</div><div class="line"></div><div class="line">     <span class="keyword">return</span> inCount / Math.pow(<span class="number">8</span>, K);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œå³ä½¿è®°å¿†åŒ–æœç´¢ï¼Œä¼šå‡ºç°inCountçˆ†äº†doubleçš„æƒ…å†µã€‚æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æƒ³å…¶å®ƒåŠæ³•ï¼â€”â€”é‚£å°±ä¸è¦è¿”å›å…¨éƒ¨çš„å’Œï¼Œæ¯æ¬¡éƒ½è¿”å›æ¦‚ç‡å—·å—·å—·å—·å—·</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[][] direct = &#123;&#123;<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">1</span>,-<span class="number">2</span>&#125;,&#123;-<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;-<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;-<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;-<span class="number">1</span>,-<span class="number">2</span>&#125;&#125;;</div><div class="line"><span class="keyword">double</span> [][][] memo;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(r &lt; <span class="number">0</span> || c &lt; <span class="number">0</span> || r &gt;= N || c &gt;= N)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(memo[r][c][K] &gt;= <span class="number">0</span>) <span class="keyword">return</span> memo[r][c][K];</div><div class="line">    <span class="keyword">if</span>(K == <span class="number">0</span>)&#123;</div><div class="line">        memo[r][c][K] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">double</span> curr = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] dir : direct)&#123;</div><div class="line">        curr += helper(N, K - <span class="number">1</span>, r + dir[<span class="number">0</span>], c + dir[<span class="number">1</span>]);</div><div class="line">    &#125;</div><div class="line">    memo[r][c][K] = curr/<span class="number">8.0</span>;</div><div class="line">    <span class="comment">//System.out.println(curr);</span></div><div class="line">    <span class="keyword">return</span> memo[r][c][K];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line"></div><div class="line">    memo = <span class="keyword">new</span> <span class="keyword">double</span>[N][N][K + <span class="number">1</span>];</div><div class="line">    <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j)&#123;</div><div class="line">            Arrays.fill(memo[i][j], -<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> helper(N, K, r, c);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•3ï¼ŒDPé€’æ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">memo[r][c][K] : [r,c]èµ°Kæ­¥åç•™åœ¨æ£‹ç›˜å†…çš„æ¦‚ç‡</div><div class="line"></div><div class="line">è½¬ç§»æ–¹ç¨‹ï¼š</div><div class="line"></div><div class="line">memo[r][c][K] += memo[r+dir[<span class="number">0</span>]][c+dir[<span class="number">1</span>]][K-<span class="number">1</span>]</div><div class="line">memo[r][c][K] = memo[r][c][K]/<span class="number">8</span></div><div class="line">  </div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line"></div><div class="line">memo[r][c][<span class="number">0</span>] = <span class="number">1</span></div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[][] direct = &#123;&#123;<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">1</span>,-<span class="number">2</span>&#125;,&#123;-<span class="number">2</span>,<span class="number">1</span>&#125;,&#123;-<span class="number">2</span>,-<span class="number">1</span>&#125;,&#123;-<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;-<span class="number">1</span>,-<span class="number">2</span>&#125;&#125;;</div><div class="line">        <span class="keyword">double</span> [][][] memo = <span class="keyword">new</span> <span class="keyword">double</span>[N][N][K + <span class="number">1</span>];</div><div class="line">        <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j)&#123;</div><div class="line">                memo[i][j][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= K; ++k)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i )&#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j)&#123;</div><div class="line">                    <span class="comment">// éå†å…«ä¸ªæ–¹å‘</span></div><div class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span>[] dir : direct)&#123;</div><div class="line">                        <span class="keyword">int</span> i_new = i + dir[<span class="number">0</span>], j_new = j + dir[<span class="number">1</span>];</div><div class="line">                        <span class="keyword">if</span>(i_new &lt; <span class="number">0</span> || j_new &lt; <span class="number">0</span> || i_new &gt;= N || j_new &gt;= N) <span class="keyword">continue</span>;</div><div class="line">                        memo[i][j][k] += memo[i_new][j_new][k-<span class="number">1</span>];</div><div class="line">                    &#125;</div><div class="line">                    memo[i][j][k] /= <span class="number">8</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> memo[r][c][K];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Out-of-Boundary-paths">5.1.5. Out of Boundary paths</h3><p>ç»™ä¸€ä¸ª$m\times n$ çš„æ£‹ç›˜ï¼Œæ¯æ¬¡å¯ä»¥èµ°å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ã€‚å¯ä»¥èµ°å›å¤´è·¯ã€‚æ±‚é—®åœ¨Næ­¥é™åˆ¶ä¸‹ï¼Œæœ‰å¤šå°‘ç§èµ°å‡ºæ£‹ç›˜çš„æ–¹æ³•ã€‚</p>
<p>è¿™é“é¢˜ä¸ä¹‹å‰çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå¯ä»¥å‘å››ä¸ªæ–¹å‘èµ°ã€‚ä½†é™åˆ¶æ¡ä»¶å°±æ˜¯æœ€å¤šèƒ½èµ°Næ­¥ã€‚</p>
<p><strong>è§£æ³•ä¸€ï¼Œæš´è§£</strong></p>
<p>æš´åŠ›DFSï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> M=<span class="number">1000000007</span>;</div><div class="line">   <span class="keyword">int</span>[][][] memo;</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> stepRemain)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(i &lt; <span class="number">0</span> || i &gt;= m || j &lt; <span class="number">0</span> || j &gt;= n)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">       <span class="keyword">if</span>(stepRemain == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¿™ä¸€æ­¥ä¸€å®šè¦å†™åœ¨ä¸Šä¸€ä¸ªåˆ¤æ–­ä¹‹å</span></div><div class="line">       </div><div class="line">       <span class="keyword">int</span>[] di = &#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>&#125;; <span class="keyword">int</span>[] dj = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>&#125;;</div><div class="line">       <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</div><div class="line">           sum += helper(m, n, i + di[k], j + dj[k], stepRemain - <span class="number">1</span>);</div><div class="line">           sum %= M;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> sum%M;</div><div class="line"></div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findPaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> N, <span class="keyword">int</span> i_in, <span class="keyword">int</span> j_in)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span>(i_in &lt; <span class="number">0</span> || i_in &gt;= m || j_in &lt; <span class="number">0</span> || j_in &gt;= n || N == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       <span class="keyword">return</span> helper(m, n, i_in, j_in,N);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼æœ€å®¹æ˜“æƒ³åˆ°ã€‚ï¼ˆä¸€å¼€å§‹æ²¡ç†æ¸…é¢˜æ„ï¼Œä»¥ä¸ºä¸å¯ä»¥æˆç¯ï¼Œä½†å…¶å®å¯ä»¥ï¼‰</p>
<p><strong>è§£æ³•äºŒï¼Œè®°å¿†åŒ–æœç´¢</strong></p>
<p>è¿™é‡Œçš„å…³é”®ç‚¹å°±æ˜¯ï¼ŒçŠ¶æ€ä¸ä»…ç”±iå’Œjå†³å®šï¼Œè¿˜æœ‰stepRemainï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> M=<span class="number">1000000007</span>;</div><div class="line">    <span class="keyword">int</span>[][][] memo;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> stepRemain)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(i &lt; <span class="number">0</span> || i &gt;= m || j &lt; <span class="number">0</span> || j &gt;= n)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(stepRemain == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(memo[i][j][stepRemain] &gt;= <span class="number">0</span>) <span class="keyword">return</span> memo[i][j][stepRemain];</div><div class="line">        <span class="keyword">int</span>[] di = &#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>&#125;; <span class="keyword">int</span>[] dj = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</div><div class="line">            sum += (helper(m, n, i + di[k], j + dj[k], stepRemain - <span class="number">1</span>)%M);</div><div class="line">            sum %= M;</div><div class="line">        &#125;</div><div class="line">        memo[i][j][stepRemain] = sum%M;</div><div class="line">        <span class="keyword">return</span> memo[i][j][stepRemain];</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findPaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> N, <span class="keyword">int</span> i_in, <span class="keyword">int</span> j_in)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(i_in &lt; <span class="number">0</span> || i_in &gt;= m || j_in &lt; <span class="number">0</span> || j_in &gt;= n || N == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        memo = <span class="keyword">new</span> <span class="keyword">int</span>[m][n][N + <span class="number">1</span>];</div><div class="line">        <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; m; ++a)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> b = <span class="number">0</span>; b &lt; n; ++b)&#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> c = <span class="number">0</span>; c &lt;= N; ++c) memo[a][b][c] = -<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> helper(m, n, i_in, j_in,N);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>è§£æ³•ä¸‰ï¼ŒDPé€’æ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">çŠ¶æ€ memo[i][j][step] : ä»[i,j]å‡ºå‘èµ°stepæ­¥æœ‰å¤šå°‘ç§æ–¹å¼èµ°å‡ºå»</div><div class="line"></div><div class="line">ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬åšä»¥ä¸‹ç¬¦å·å¤„ç†ï¼š</div><div class="line"><span class="number">1</span>. çŠ¶æ€è®°ä¸ºmemo[i,j][step]</div><div class="line"><span class="number">2</span>. memo[right][step] ä¸º[i,j]çš„å³è¾¹æ ¼å­å‡ºå‘èµ°stepæ­¥</div><div class="line"><span class="number">3</span>. memo[left][step] ã€ memo[down][step] ã€memo[up][step]åŒç†ï¼Œåˆ†åˆ«ä¸ºå·¦è¾¹ï¼Œä¸‹é¢ï¼Œä¸Šé¢</div><div class="line"></div><div class="line">æ–¹ç¨‹ï¼š</div><div class="line"></div><div class="line">å½“left,right,down,upéƒ½æ²¡æœ‰å‡ºè¾¹ç•Œæ—¶ï¼š</div><div class="line">memo[i,j][step] = memo[left][step-<span class="number">1</span>] + memo[right][step-<span class="number">1</span>] + memo[down][step-<span class="number">1</span>] + memo[up][step-<span class="number">1</span>]</div><div class="line"></div><div class="line"></div><div class="line">æ ¹æ®çŠ¶æ€æˆ‘ä»¬å¾—çŸ¥ï¼Œæœ¬æ¬¡è®¡ç®—éœ€è¦ç”¨åˆ°ä¸Šæ¬¡è®¡ç®—çš„step-<span class="number">1</span>çš„æ‰€æœ‰çŠ¶æ€ï¼Œå› æ­¤æœ€å¤–å±‚å¾ªç¯ä¸€å®šæ˜¯stepä¾æ¬¡++</div><div class="line">  </div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line"></div><div class="line">step = <span class="number">1</span>æ—¶ï¼Œæ‰€æœ‰è¾¹ç•Œæ ¼å­çš„åˆå§‹å€¼éƒ½ä¸º<span class="number">1</span>ï¼Œå››ä¸ªè§’çš„åˆå§‹å€¼ä¸º<span class="number">2</span>ï¼ˆ å«ä¹‰ï¼šè¾¹ä¸Šèµ°<span class="number">1</span>æ­¥åˆ°è¾¾å¤–é¢æ—¶ï¼Œèµ°æ³•åªæœ‰<span class="number">1</span>ç§ï¼å››ä¸ªè§’èµ°<span class="number">1</span>æ­¥åˆ°è¾¾å¤–é¢æ—¶ï¼Œèµ°æ³•æœ‰<span class="number">2</span>ç§ï¼‰å³ï¼š</div><div class="line"></div><div class="line"><span class="comment">// åˆå§‹åŒ–</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</div><div class="line">            memo[i][<span class="number">0</span>][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// å·¦è¾¹ç•Œ  ï¼ˆæ³¨æ„ï¼šè¿™é‡Œä¸€å®šå¿…é¡»æ˜¯åŠ å·ï¼Œå› ä¸ºæœ‰å¯èƒ½ä¸€ä¸ªæ ¼å­åŒæ—¶æ˜¯å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œï¼ï¼‰</span></div><div class="line">            memo[i][n-<span class="number">1</span>][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// å³è¾¹ç•Œ</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)&#123;</div><div class="line">            memo[<span class="number">0</span>][j][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// ä¸Šè¾¹ç•Œ</span></div><div class="line">            memo[m-<span class="number">1</span>][j][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// ä¸‹è¾¹ç•Œ</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">ç»“æœ ï¼š </div><div class="line">å› ä¸ºé™åˆ¶è‡³å¤šèµ°Næ­¥ï¼Œå› æ­¤ç»“æœåº”è¯¥ä¸º sum(memo[i_in][j_in][<span class="number">1</span>~N])</div><div class="line"></div><div class="line">  </div><div class="line"> ä»£ç ï¼š</div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findPaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> N, <span class="keyword">int</span> i_in, <span class="keyword">int</span> j_in)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(i_in &lt; <span class="number">0</span> || i_in &gt;= m || j_in &lt; <span class="number">0</span> || j_in &gt;= n || N == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> M=<span class="number">1000000007</span>;</div><div class="line">        <span class="keyword">int</span>[][][] memo = <span class="keyword">new</span> <span class="keyword">int</span>[m][n][N + <span class="number">1</span>];</div><div class="line">        <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</div><div class="line">            memo[i][<span class="number">0</span>][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// å·¦è¾¹ç•Œ</span></div><div class="line">            memo[i][n-<span class="number">1</span>][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// å³è¾¹ç•Œ</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)&#123;</div><div class="line">            memo[<span class="number">0</span>][j][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// ä¸Šè¾¹ç•Œ</span></div><div class="line">            memo[m-<span class="number">1</span>][j][<span class="number">1</span>] += <span class="number">1</span>; <span class="comment">// ä¸‹è¾¹ç•Œ</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// çŠ¶æ€è½¬ç§»</span></div><div class="line">        <span class="keyword">int</span>[] di = &#123;<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>&#125;; <span class="keyword">int</span>[] dj = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> step = <span class="number">2</span>; step &lt;= N; ++step)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m ; ++i)&#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n ; ++j)&#123;</div><div class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</div><div class="line">                        <span class="keyword">int</span> i_new = i + di[k], j_new = j + dj[k];</div><div class="line">                        <span class="keyword">if</span>(i_new &lt; <span class="number">0</span> || j_new &lt; <span class="number">0</span> || i_new &gt;= m || j_new &gt;= n)&#123;</div><div class="line">                            <span class="keyword">continue</span>;</div><div class="line">                        &#125;</div><div class="line">                        memo[i][j][step] += memo[i_new][j_new][step - <span class="number">1</span>];</div><div class="line">                        memo[i][j][step] %= M;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">         <span class="comment">// è®¡ç®—ç»“æœ</span></div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> step = <span class="number">0</span>; step &lt;= N; ++step)&#123;</div><div class="line">            sum = (sum + memo[i_in][j_in][step]) % M;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜4ï¼ŒClimbing-Stairs">5.1.6. ä¾‹é¢˜4ï¼ŒClimbing Stairs</h3><p>æœ‰ä¸€ä¸ªæ¥¼æ¢¯ï¼Œä¸€æ­¥åªèƒ½è·¨1/2æ­¥ã€‚é—®ä»0èµ°åˆ°nå±‚æœ‰å¤šå°‘å±‚æ–¹æ¡ˆã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">f[i] -&gt; iä½ç½®æœ‰å¤šå°‘ç§</div><div class="line"></div><div class="line">f[i] = f[i-<span class="number">1</span>] + f[i-<span class="number">2</span>] <span class="comment">//è¦ä¹ˆä»i-1æ¥çš„ï¼Œè¦ä¹ˆä»i-2æ¥çš„</span></div><div class="line"></div><div class="line"><span class="comment">//æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( n &lt;= <span class="number">2</span> ) <span class="keyword">return</span> n;</div><div class="line">        <span class="comment">//f[i] : æœ‰iä¸ªå°é˜¶æ—¶çš„æ–¹æ¡ˆä¸ªæ•°</span></div><div class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>];</div><div class="line">        f[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">        f[<span class="number">2</span>] = <span class="number">2</span>;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n ; ++i )&#123;</div><div class="line">            f[i] = f[i-<span class="number">1</span>] + f[i-<span class="number">2</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> f[n];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜5ï¼ŒJump-Game">5.1.7. ä¾‹é¢˜5ï¼ŒJump Game</h3><p>ç»™ä¸€ä¸ªæ•°ç»„A,<code>A[i]</code>è¡¨ç¤ºåœ¨è¿™é‡Œæ—¶æœ€å¤šå¯ä»¥è·³<code>A[i]</code>æ­¥ã€‚åªèƒ½å‘å‰è·³ã€‚ä»æ•°ç»„Açš„ç¬¬0ä½ç½®å‡ºå‘ï¼Œèƒ½ä¸èƒ½è·³åˆ°æœ«å°¾ã€‚</p>
<p>è¿™é“é¢˜æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ç§æ˜¯DPï¼Œä¸€ç§æ˜¯è´ªå¿ƒã€‚DPä¼šè¶…æ—¶ï¼Œä½†æ˜¯æ€è·¯éå¸¸å¥½ã€‚</p>
<p>å…ˆä»‹ç»DPï¼Œè¿™ä¸ªå¤æ‚åº¦æ˜¯$O(n^2)$:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* f[i] -&gt; ä»0åˆ°iæ˜¯å¦å¯è¾¾</div><div class="line">*</div><div class="line">* 1,2,...,j,...i</div><div class="line">* </div><div class="line">* å¦‚æœjå¯è¾¾ï¼Œä¸”ä»jå¯ä»¥è·³åˆ°iï¼Œåˆ™iå¯è¾¾ï¼Œå³ï¼šçœ‹çœ‹å­˜ä¸å­˜åœ¨ä¸€ä¸ªjï¼Œjæ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</div><div class="line">*  1. jå¯è¾¾ --&gt; f[j] == true</div><div class="line">*  2. ä»jå‡ºå‘å¤Ÿå¾—åˆ°i --&gt; i - j &lt;= A[j]</div><div class="line">**/</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canJump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">boolean</span>[] f = <span class="keyword">new</span> <span class="keyword">boolean</span>[nums.length];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        f[<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">int</span> i,j;</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; nums.length ; ++i )&#123;</div><div class="line">            <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; i ; ++j )&#123;</div><div class="line">                <span class="keyword">if</span>( f[j] &amp;&amp; i - j &lt;= nums[j] )&#123; <span class="comment">// jå¯è¾¾ï¼Œä¸”ä»jå¯ä»¥è·³åˆ°i</span></div><div class="line">                    f[i] = <span class="keyword">true</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> f[nums.length - <span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å†ä»‹ç»è´ªå¿ƒçš„æ€è·¯ï¼Œè¿™ä¸ªå¤æ‚åº¦æ˜¯$O(n)$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">ç»´æŠ¤ä¸¤ä¸ªä¸œè¥¿ï¼š</div><div class="line">	1. åˆ°ç›®å‰ä¸ºæ­¢èƒ½è·³åˆ°çš„æœ€è¿œè·ç¦»ï¼ˆå…¨å±€ï¼‰</div><div class="line">	2. ä»å½“å‰ä¸€æ­¥å‡ºå‘èƒ½è·³åˆ°çš„æœ€è¿œè·ç¦»ï¼ˆå±€éƒ¨ï¼‰</div><div class="line"></div><div class="line">å…¨å±€æœ€ä¼˜ global = Math.max(global, local)</div><div class="line"></div><div class="line">å±€éƒ¨æœ€ä¼˜ local = A[i]+i</div><div class="line"></div><div class="line">**/ </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canJump</span><span class="params">(<span class="keyword">int</span>[] A)</span> </span>&#123;</div><div class="line">  <span class="comment">// think it as merging n intervals</span></div><div class="line">  <span class="keyword">if</span> (A == <span class="keyword">null</span> || A.length == <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span> global = A[<span class="number">0</span>];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; A.length; i++) &#123;</div><div class="line">    <span class="keyword">if</span> (i &lt;= global &amp;&amp; A[i] + i &gt;= global) &#123;</div><div class="line">      global = A[i] + i;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> global &gt;= A.length - <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜6ï¼ŒJump-Game-II">5.1.8. ä¾‹é¢˜6ï¼ŒJump Game II</h3><p>ç»™ä¸€ä¸ªæ•°ç»„A,<code>A[i]</code>è¡¨ç¤ºåœ¨è¿™é‡Œæ—¶æœ€å¤šå¯ä»¥è·³<code>A[i]</code>æ­¥ã€‚åªèƒ½å‘å‰è·³ã€‚ä»æ•°ç»„Açš„ç¬¬0ä½ç½®å‡ºå‘ï¼Œé—®æœ€å°‘çš„è·³çš„æ¬¡æ•°ã€‚</p>
<p>è¿™é“é¢˜è¿˜æ˜¯æœ‰ä¸¤ä¸ªæ€è·¯ï¼Œä¸€ä¸ªDPï¼Œä¸€ä¸ªè´ªå¿ƒã€‚æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹DPï¼Œè™½ç„¶DPä¼šè¶…æ—¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"></div><div class="line">f[i] : ä»èµ·ç‚¹å‡ºå‘ï¼Œè·³åˆ°iæœ€å°‘éœ€è¦å‡ æ­¥</div><div class="line"></div><div class="line">          |---&gt;i-j&lt;---|</div><div class="line">1,3,.....,|j,.......,i|</div><div class="line"></div><div class="line">å¦‚æœjå¯è¾¾iï¼ˆå³i - j &lt;= nums[j]ï¼‰ï¼Œåˆ™ f[i] = min ( f[j] + 1 )</div><div class="line"></div><div class="line">**/</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">jump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="comment">//çŠ¶æ€ï¼šf[i] -&gt; ä»0åˆ°iæœ€å°‘çš„è·³è·ƒæ¬¡æ•°</span></div><div class="line">  <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">  <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">  f[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">  <span class="keyword">int</span> i,j;</div><div class="line">  <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; nums.length ; ++i )&#123;</div><div class="line">    f[i] = Integer.MAX_VALUE;</div><div class="line">    <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; i ; ++j )&#123;</div><div class="line">      <span class="keyword">if</span>( i - j &lt;= nums[j] )&#123;</div><div class="line">        f[i] = Math.min(f[i],f[j]+<span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> f[nums.length - <span class="number">1</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ€è·¯ï¼Œè´ªå¿ƒï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">æ€è·¯ï¼š</div><div class="line"></div><div class="line">è¦è®°å½•</div><div class="line">æœ€è¿œèƒ½è¦†ç›–åˆ°çš„åœ°æ–¹ -&gt; curr</div><div class="line">å·²ç»è¦†ç›–çš„åœ°æ–¹ -&gt; last</div><div class="line">å½“å‰æ‰€ä½¿ç”¨è·³æ•° -&gt; ret</div><div class="line"></div><div class="line">æ‰«æä»¥ç¡®å®šå½“å‰æœ€è¿œèƒ½è¦†ç›–çš„èŠ‚ç‚¹ï¼Œæ”¾å…¥currã€‚</div><div class="line">ç„¶åç»§ç»­æ‰«æï¼Œç›´åˆ°å½“å‰çš„è·¯ç¨‹è¶…è¿‡äº†ä¸Šä¸€æ¬¡ç®—å‡ºçš„è¦†ç›–èŒƒå›´ï¼Œé‚£ä¹ˆæ›´æ–°è¦†ç›–èŒƒå›´ï¼ŒåŒæ—¶æ›´æ–°æ¡æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ç»è¿‡äº†å¤šä¸€è·³æ‰èƒ½ç»§ç»­å‰è¿›çš„</div><div class="line"></div><div class="line">æ¯”å¦‚å°±æ˜¯æˆ‘ä»¬é¢˜ç›®ä¸­çš„[2,3,1,1,4]ã€‚åˆå§‹çŠ¶æ€æ˜¯è¿™æ ·çš„ï¼šcurè¡¨ç¤ºæœ€è¿œèƒ½è¦†ç›–åˆ°çš„åœ°æ–¹ï¼Œç”¨æ¡†é‡Œè¡¨ç¤ºã€‚lastè¡¨ç¤ºå·²ç»è¦†ç›–çš„åœ°æ–¹ã€‚å®ƒä»¬éƒ½æŒ‡åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ä¸Šã€‚</div><div class="line">==============================================================</div><div class="line">cur</div><div class="line">-â†“-</div><div class="line"> 2 |	3	1	1	4</div><div class="line">-â†‘-</div><div class="line">last</div><div class="line">==============================================================</div><div class="line"></div><div class="line">ç¬¬ä¸€å…ƒç´ å‘Šè¯‰curï¼Œæœ€è¿œå¯ä»¥èµ°ä¸¤æ­¥ï¼Œäºæ˜¯ï¼š</div><div class="line">            cur</div><div class="line">-------------â†“-</div><div class="line"> 2     3     1 |	1	4</div><div class="line">-â†‘-------------</div><div class="line">last</div><div class="line">==============================================================</div><div class="line"></div><div class="line">ä¸‹ä¸€å¾ªç¯ä¸­ï¼ŒiæŒ‡å‘1ï¼ˆå³ä¸Šé¢çš„3ï¼‰ã€‚å‘ç°iå°äºlastèƒ½åˆ°çš„èŒƒå›´ï¼Œäºæ˜¯æ›´æ–°lastï¼Œæ­¥æ•°ret+1ï¼ŒåŒæ—¶ä¹Ÿè¦æ›´æ–°curï¼Œå› ä¸ºæˆ‘ä»¬å‘ç°æ›´è¿œçš„è·ç¦»</div><div class="line">      i=1               cur</div><div class="line">-------â†“-----------------â†“-</div><div class="line"> 2     3     1     1	4 |</div><div class="line">-------------â†‘-------------</div><div class="line">           last</div><div class="line">==============================================================</div><div class="line"></div><div class="line">æ¥ä¸‹æ¥iç»§ç»­å‰è¿›ï¼Œå‘ç°iè¿˜åœ¨å½“å‰çš„å®ä¾‹èŒƒå›´å†…ï¼Œæ— éœ€æ›´æ–°lastå’Œæ­¥æ•°retï¼Œåªéœ€è¦æ›´æ–°curr</div><div class="line">            i=2         cur</div><div class="line">-------------â†“-----------â†“-</div><div class="line"> 2     3     1     1	4 |</div><div class="line">-------------â†‘-------------</div><div class="line">          last = 2</div><div class="line">==============================================================</div><div class="line"></div><div class="line">iç»§ç»­å‰è¿›ï¼Œæ¥ä¸‹æ¥å‘ç°è¶…è¿‡å½“å‰åŠ¿åŠ›èŒƒå›´ï¼Œæ›´æ–°lastå’Œæ­¥æ•°ã€‚curå·²ç„¶æœ€å¤§äº†ã€‚</div><div class="line">                  i=3   cur</div><div class="line">-------------------â†“-----â†“-</div><div class="line"> 2     3     1     1	4 |</div><div class="line">-------------------------â†‘-</div><div class="line">                     last = 4</div><div class="line">==============================================================</div><div class="line"></div><div class="line">æœ€åï¼Œiåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¾ç„¶åœ¨lastçš„åŠ¿åŠ›èŒƒå›´å†…ï¼Œéå†å®Œæˆï¼Œè¿”å›retã€‚</div><div class="line">                     i=cur=4</div><div class="line">-------------------------â†“-</div><div class="line"> 2     3     1     1	4 |</div><div class="line">-------------------------â†‘-</div><div class="line">                     last = 4</div><div class="line">==============================================================</div><div class="line">**/</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">jump</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> last = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> curr = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">          <span class="comment">//éœ€è¦è¿›è¡Œä¸‹æ¬¡è·³è·ƒï¼Œåˆ™æ›´æ–°lastå’Œå½“æ‰§è¡Œçš„è·³æ•°ret</span></div><div class="line">            <span class="keyword">if</span> (i &gt; last) &#123;</div><div class="line">                last = curr;</div><div class="line">                ++ret;</div><div class="line">            &#125;</div><div class="line">          	<span class="comment">//æœ€è¿œèƒ½è¦†ç›–åˆ°çš„åœ°æ–¹</span></div><div class="line">            curr = max(curr, i+A[i]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜7ï¼ŒLongest-Increasing-Subsequence">5.1.9. ä¾‹é¢˜7ï¼ŒLongest Increasing Subsequence</h3><p>æ±‚æœ€é•¿ä¸¥æ ¼é€’å¢çš„å­åºåˆ—ï¼ˆå­åºåˆ—ï¼šå¯ä»¥è·³ç€é€‰ï¼‰</p>
<p>ä¾‹å¦‚ç»™<code>[5,4,1,2,3]</code>,æœ€é•¿çš„LISå°±æ˜¯<code>1,2,3</code></p>
<p>å¯ä»¥ç”¨DPâ€”â€”$n^2$ï¼Œä¹Ÿå¯ä»¥ç”¨äºŒåˆ†â€”â€”$nlogn$ã€‚æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹DP</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></div><div class="line">ç†è§£ä¸ºï¼š</div><div class="line">  <span class="number">5</span></div><div class="line">|---| <span class="number">4</span></div><div class="line">|   |---|         <span class="number">3</span></div><div class="line">|   |   |     <span class="number">2</span> |---|</div><div class="line">|   |   | <span class="number">1</span> |---|   |</div><div class="line">|   |   |---|   |   | </div><div class="line">  <span class="number">5</span>   <span class="number">4</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   çš„æ¥¼æ¢¯ï¼Œç›®çš„æ˜¯ä»æŸä¸ªæœ¨æ¡©å‡ºå‘ï¼Œä»ä½åˆ°é«˜ï¼Œçœ‹èƒ½è¸©å¤šå°‘ä¸ªæœ¨æ¡©</div><div class="line"></div><div class="line">f[i] : ï¼ˆä»ä»»æ„æŸä¸ªæœ¨æ¡©ï¼‰è·³åˆ°ç¬¬iä¸ªæœ¨æ¡©ï¼Œæœ€å¤šèƒ½è¸©è¿‡å¤šå°‘ä¸ªæ¡©</div><div class="line"></div><div class="line">æ–¹ç¨‹ ï¼šf[i] = max&#123; f[j] + <span class="number">1</span> &#125; , j å¿…é¡»æ»¡è¶³ j &lt; i &amp;&amp; nums[j] &lt;= nums[i]</div><div class="line"></div><div class="line">åˆå§‹åŒ–ï¼šf[i] = <span class="number">1</span> <span class="comment">//æ¯ä¸ªæ ¼å­å¯¹äºè‡ªå·±æ¥è¯´éƒ½å¯è¾¾</span></div><div class="line"></div><div class="line">ç­”æ¡ˆï¼š Max(f[<span class="number">0</span>],f[<span class="number">1</span>],...,[n-<span class="number">1</span>])</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">  <span class="comment">//f[i] -&gt; è·³åˆ°å½“å‰iæ—¶ï¼Œæœ€å¤šå¯ä»¥è·³çš„æ¬¡æ•°</span></div><div class="line">  <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">  <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">  <span class="keyword">int</span> i,j;</div><div class="line">  <span class="comment">// è¿™ä¸ªå…¶å®å¯ä»¥æ”¾åˆ°æœ€åå†+1</span></div><div class="line">  <span class="comment">//        for( i = 0 ; i &lt; nums.length ; ++i)&#123;</span></div><div class="line">  <span class="comment">//            f[i] = 1;</span></div><div class="line">  <span class="comment">//        &#125;</span></div><div class="line">  <span class="comment">//å¼€å§‹</span></div><div class="line">  <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; nums.length ; ++i )&#123;</div><div class="line">    <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; i ; ++j )&#123;</div><div class="line">      <span class="keyword">if</span>( nums[j] &lt; nums[i] ) &#123;</div><div class="line">        f[i] = Math.max(f[i],f[j]+<span class="number">1</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//ç»“æœ j = max&#123;f[i]&#125;</span></div><div class="line">  j = -<span class="number">1</span>;</div><div class="line">  <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; f.length ; ++i )&#123;</div><div class="line">    j = Math.max(j,f[i]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> j+<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹äºŒåˆ†è¿™ä¸ªéªšæ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">tail[i] -&gt; é•¿åº¦ä¸ºi+<span class="number">1</span>çš„LISçš„ã€æœ€å°ã€‘æœ«å°¾æ˜¯tail[i]</div><div class="line">ä»¥nums = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>]ä¸ºä¾‹ï¼š</div><div class="line"></div><div class="line">len = <span class="number">1</span>   :      [<span class="number">4</span>], [<span class="number">5</span>], [<span class="number">6</span>], [<span class="number">3</span>]   =&gt; tails[<span class="number">0</span>] = <span class="number">3</span></div><div class="line">len = <span class="number">2</span>   :      [<span class="number">4</span>, <span class="number">5</span>], [<span class="number">5</span>, <span class="number">6</span>]       =&gt; tails[<span class="number">1</span>] = <span class="number">5</span></div><div class="line">len = <span class="number">3</span>   :      [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]            =&gt; tails[<span class="number">2</span>] = <span class="number">6</span></div><div class="line"></div><div class="line">æ­¤æ—¶å¦‚æœåé¢åˆæ¥äº†ä¸€ä¸ªx</div><div class="line"></div><div class="line">(<span class="number">1</span>) å¦‚æœxå¤§äºæ‰€æœ‰tailsï¼Œé‚£å°±æŠŠè¿™ä¸ªxæ”¾åœ¨è¿™ä¸ªé‡Œé¢ï¼Œå¹¶æŠŠé•¿åº¦+<span class="number">1</span></div><div class="line">(<span class="number">2</span>) å¦‚æœtails[i-<span class="number">1</span>] &lt; x &lt;= tails[i], æ›´æ–° tails[i]</div><div class="line"></div><div class="line">size -&gt; å½“å‰æœ€é•¿åºåˆ—é•¿åº¦</div><div class="line">åº[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]</div><div class="line">ä»¥[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">7</span>]ä¸ºä¾‹ï¼š</div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">0</span> --&gt; x = <span class="number">2</span>, tail = [<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">1</span></div><div class="line">[<span class="number">2</span>]   --&gt; å­åºåˆ— <span class="number">2</span></div><div class="line">  </div><div class="line">i = <span class="number">1</span> --&gt; x = <span class="number">1</span>, tail = [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">1</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>] --&gt; å­åºåˆ—[<span class="number">1</span>]</div><div class="line"></div><div class="line">i = <span class="number">2</span>   --&gt; x = <span class="number">5</span>, tail = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">2</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line">i = <span class="number">3</span>    --&gt; x = <span class="number">3</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">2</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>]</div><div class="line"></div><div class="line">i = <span class="number">4</span>       --&gt; x = <span class="number">6</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">3</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>]</div><div class="line"></div><div class="line">i = <span class="number">5</span>         --&gt; x = <span class="number">4</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">3</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>]</div><div class="line"></div><div class="line">i = <span class="number">6</span>           --&gt; x = <span class="number">8</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">4</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>]</div><div class="line"></div><div class="line">i = <span class="number">7</span>             --&gt; x = <span class="number">9</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">4</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">9</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">9</span>]</div><div class="line"></div><div class="line">i = <span class="number">8</span>               --&gt; x = <span class="number">7</span>, tail = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  -&gt; size = <span class="number">4</span></div><div class="line">[<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">7</span>] --&gt; å­åºåˆ—[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">9</span>]</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[] tails = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</div><div class="line">    <span class="keyword">int</span> size = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : nums) &#123;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = size;</div><div class="line">        <span class="comment">//ç”¨äºŒåˆ†åœ¨tailsä¸­å¯»æ‰¾ä¸€ä¸ªä½ç½®ï¼Œå°†xå®‰é¡¿ä¸€ä¸‹</span></div><div class="line">        <span class="keyword">while</span> (i != j) &#123;</div><div class="line">            <span class="keyword">int</span> m = (i + j) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span> (tails[m] &lt; x)</div><div class="line">                i = m + <span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                j = m;</div><div class="line">        &#125;</div><div class="line">        tails[i] = x;</div><div class="line">        <span class="keyword">if</span> (i == size) ++size;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> size;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Increasing-Subsequences">5.1.10. Increasing Subsequences</h3><p>æ±‚ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰é€’å¢å­åºåˆ—</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">ä¸€å¼€å§‹çš„æ€è·¯å°±æ˜¯ç”¨é€’å½’</div><div class="line"></div><div class="line">å®šä¹‰&lt;List&lt;List&gt;&gt;result[i]ä¸ºåŒ…å«nums[i]çš„æ‰€æœ‰é€’å¢å­åºåˆ—</div><div class="line">    &lt;List&lt;List&gt;&gt;result[i+<span class="number">1</span>]ä¸ºåŒ…å«nums[i+<span class="number">1</span>]çš„æ‰€æœ‰é€’å¢å­åºåˆ—ï¼Œé‚£ä¹ˆ</div><div class="line"></div><div class="line">å¯¹äº&lt;List&lt;List&gt;&gt;result[i+<span class="number">1</span>]ä¸­çš„æ¯ä¸ªæˆå‘˜&lt;List&gt;elementæ¥è¯´ï¼š</div><div class="line"></div><div class="line"><span class="number">1</span>. å¦‚æœ nums[i] &lt;= element.head , é‚£ä¹ˆ nums[i] + element å¯ä»¥ä½œä¸ºä¸€ä¸ªresult[i]ä¸­çš„ç»“æœ</div><div class="line"><span class="number">2</span>. element æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºresult[i]ä¸­çš„ç»“æœ</div><div class="line"><span class="number">3</span>. nums[i]ä¹Ÿå¯ä»¥ä½œä¸ºresult[i]ä¸­çš„ç»“æœ</div><div class="line"></div><div class="line">éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç”Ÿæˆåˆ°result[<span class="number">0</span>]æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦çš„æ˜¯é•¿åº¦å¤§äº<span class="number">1</span>çš„ç»“æœã€‚å› æ­¤éœ€è¦åˆ¤æ–­ä¸€ä¸‹ï¼Œå¦‚æœä»¥ä¸Šä¸‰ç§æƒ…å†µçš„æŸç§æƒ…å†µé•¿åº¦å°äºç­‰äº<span class="number">1</span>ï¼Œé‚£ä¹ˆå°±ä¸åŠ å…¥result[i]</div><div class="line"></div><div class="line"></div><div class="line">ç„¶è€Œè¿™æ ·ä¸‹å»çš„åæœæ˜¯ï¼Œå¦‚æœé‡åˆ°é‡å¤å…ƒç´ ï¼Œå°±ä¼šç”Ÿæˆé‡å¤çš„ç»“æœã€‚ä¾‹å¦‚æˆ‘è¾“å…¥nums = [<span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">7</span>]ã€‚é‚£ä¼šå¾—åˆ°ï¼š[[<span class="number">4</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">6</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">7</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">7</span>, <span class="number">7</span>], [<span class="number">6</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>]]</div><div class="line"></div><div class="line">ç”Ÿæˆäº†ä¸¤ä¸ª[<span class="number">4</span>,<span class="number">7</span>]</div><div class="line"></div><div class="line">è¿™ä¸ªé—®é¢˜æƒ³äº†ä¸€ä¸‹åˆéƒ½æ²¡æœ‰è§£å†³ã€‚</div><div class="line"></div><div class="line">çœ‹äº†ç½‘ä¸Šçš„è§£æ³•ï¼Œè·Ÿæˆ‘çš„ä¸æ˜¯ä¸€ä¸ªå¥—è·¯ã€‚å“ã€‚æ¥æ—¥é‡åˆ·æ­¤é¢˜ï¼</div><div class="line"></div><div class="line"></div><div class="line">======æ¥æ—¥</div><div class="line"></div><div class="line">å·²åœ¨å›æº¯é‡Œé¢è§£å†³æ­¤é¢˜ã€‚</div></pre></td></tr></table></figure>
<h3 id="Arithmetic-Slices">5.1.11. Arithmetic Slices</h3><p>ç»™ä¸€ä¸ªåºåˆ—ã€‚æ±‚è¿™ä¸ªåºåˆ—æœ‰å¤šå°‘ä¸ªç­‰å·®æ•°åˆ—ï¼ˆè‡³å°‘ä¸‰ä¸ªå…ƒç´ æ‰ç®—ç­‰å·®æ•°åˆ—ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// times[i] : é•¿åº¦ä¸ºiçš„ç­‰å·®åºåˆ—å¯ä»¥æ„æˆå¤šå°‘ä¸ªç­‰å·®åºåˆ—</span></div><div class="line"><span class="keyword">int</span>[] times;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getTimes</span><span class="params">( <span class="keyword">int</span> i )</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( i &lt; <span class="number">2</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">if</span>( times[i] &gt; <span class="number">0</span> )&#123;</div><div class="line">    <span class="keyword">return</span> times[i];</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// function</span></div><div class="line">  times[i] = getTimes(i-<span class="number">1</span>) + i - <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> times[i];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numberOfArithmeticSlices</span><span class="params">(<span class="keyword">int</span>[] A)</span> </span>&#123;</div><div class="line">  <span class="keyword">int</span> n = A.length;</div><div class="line">  <span class="keyword">if</span>( n &lt; <span class="number">3</span> )<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  times = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>];</div><div class="line">  times[<span class="number">3</span>] = <span class="number">1</span>;</div><div class="line">  <span class="keyword">int</span> last = A[<span class="number">1</span>] - A[<span class="number">0</span>],now;</div><div class="line">  <span class="keyword">int</span> result = <span class="number">0</span> ;</div><div class="line">  <span class="keyword">int</span> sameCount = <span class="number">2</span> ;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">2</span> ; i &lt; n ; ++i )&#123;</div><div class="line">    now = A[i] - A[i-<span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span>( now == last )&#123;</div><div class="line">      ++sameCount;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">if</span>( sameCount &gt;= <span class="number">3</span> )&#123;result += getTimes(sameCount);&#125;</div><div class="line">      sameCount = <span class="number">2</span>;</div><div class="line">      last = now;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>( sameCount &gt;= <span class="number">3</span> )&#123;result += getTimes(sameCount);&#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###ã€€Perfect Squares</p>
<p>ç»™ä¸€ä¸ªæ•°å­—ï¼Œæ±‚å®ƒè¢«æ‹†æˆå¹³æ–¹å’Œçš„æœ€å°‘å¹³æ–¹å’Œä¸ªæ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">çŠ¶æ€ f[i] : æ•°å­—iè¢«æ‹†æˆå¹³æ–¹å’Œçš„æœ€å°‘ä¸ªæ•°</div><div class="line"></div><div class="line"><span class="number">1</span>,.....,j*j,.....i</div><div class="line"></div><div class="line">æ–¹ç¨‹ï¼š</div><div class="line">f[i] = min ( f[i-j^<span class="number">2</span>] + <span class="number">1</span> )</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="comment">// nums[i] : æ•°å­—iè¢«æ‹†æˆå¹³æ–¹å’Œçš„æœ€å°‘ä¸ªæ•°</span></div><div class="line"><span class="keyword">int</span>[] nums;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( number &lt;= <span class="number">1</span> )&#123;</div><div class="line">    <span class="keyword">return</span> number;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>( nums[number] &gt; <span class="number">0</span> )&#123;</div><div class="line">    <span class="keyword">return</span> nums[number];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// a = n - i^2</span></div><div class="line">  <span class="keyword">int</span> a;</div><div class="line">  nums[number] = number;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; number ; ++i )&#123;</div><div class="line">    a = number - i*i;</div><div class="line">    <span class="keyword">if</span>(a &lt; <span class="number">0</span> )&#123; <span class="keyword">break</span>;&#125;</div><div class="line">    <span class="keyword">if</span>( a == <span class="number">0</span> )&#123;</div><div class="line">      nums[number] = <span class="number">1</span>;</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      <span class="comment">// æ–¹ç¨‹</span></div><div class="line">      nums[number] = Math.min(nums[number], <span class="number">1</span> + dp(a));</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> nums[number];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">numSquares</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">  nums = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>];</div><div class="line">  nums[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">  nums[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">  <span class="keyword">return</span> dp(n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Min-Cost-Climbing-Stairs">5.1.12. Min Cost Climbing Stairs</h3><p>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œ<code>cost[i]</code> ä»£è¡¨ä»ç¬¬iæ ¼è·³åˆ°ä¸‹ä¸€æ­¥çš„èŠ±è´¹ã€‚æ¯æ¬¡å¯ä»¥è·³1æˆ–ä¸¤æ ¼ã€‚æ±‚ä»å¼€å§‹ï¼ˆå¯ä»¥ä»0æˆ–1èµ·è·³ï¼‰è·³åˆ°æœ€åçš„æœ€å°èŠ±è´¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] dp;</div><div class="line"><span class="comment">// dp[i] ä»ç¬¬iæ ¼è·³åˆ°æœ€åéœ€è¦è€—è´¹çš„æœ€å°cost</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] cost, <span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(idx &gt;= cost.length) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(dp[idx] &gt; <span class="number">0</span>)<span class="keyword">return</span> dp[idx];</div><div class="line">    dp[idx] = Math.min(helper(cost, idx + <span class="number">1</span>),</div><div class="line">            helper(cost,idx + <span class="number">2</span>)) + cost[idx];</div><div class="line">    <span class="keyword">return</span> dp[idx];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>[] cost)</span> </span>&#123;</div><div class="line">    dp = <span class="keyword">new</span> <span class="keyword">int</span>[cost.length];</div><div class="line">    <span class="keyword">return</span> Math.min(helper(cost,<span class="number">0</span>),helper(cost,<span class="number">1</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Decode-Ways">5.1.13. Decode Ways</h3><p>ç»™ä¸€ä¸²æ•°å­—çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­1è¡¨ç¤º<code>A</code>, 2è¡¨ç¤º<code>B</code>â€¦ æ±‚å­—ç¬¦ä¸²å¯èƒ½çš„ç¼–ç æ–¹å¼ç§ç±»</p>
<p>æ€è·¯ï¼šåŠ¨æ€è§„åˆ’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">dp[i + <span class="number">1</span>] : å­—ç¬¦ä¸²[<span class="number">0</span>,i]å¯èƒ½çš„ç¼–ç æ–¹å¼</div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line">dp[<span class="number">0</span>] = <span class="number">1</span> <span class="comment">// ç©ºå­—ç¬¦ä¸²ï¼Œæ˜¯ä¸ªç‰¹ä¾‹</span></div><div class="line">dp[<span class="number">1</span>] = s.charAt(<span class="number">0</span>) &lt;= <span class="string">'9'</span> ? <span class="number">1</span> : <span class="number">0</span> ; <span class="comment">// å¦‚æœé¦–ä½å°äº10ï¼Œåˆ™é¦–ä½å¯ä»¥è¢«å•ç‹¬ç¼–ç </span></div><div class="line"></div><div class="line"></div><div class="line">[<span class="number">0</span>,<span class="number">1</span>,....,i-<span class="number">1</span>,i,i+<span class="number">1</span>]</div><div class="line"></div><div class="line">æƒ…å†µ<span class="number">1</span>ï¼šåªè¦å­—ç¬¦[i+<span class="number">1</span>]ä¸ç­‰äº`<span class="number">0</span>`ï¼Œé‚£å­—ç¬¦[i+<span class="number">1</span>]èƒ½å¤Ÿç‹¬è‡ªç¼–ç </div><div class="line">æƒ…å†µ<span class="number">2</span>ï¼šåªè¦å­—ç¬¦[i,i+<span class="number">1</span>]å°äº<span class="string">'26'</span>ä¸”å¤§äº<span class="string">'09'</span>ï¼Œé‚£å­—ç¬¦[i,i+<span class="number">1</span>]å°±èƒ½ç¼–ç </div><div class="line"></div><div class="line">è½¬ç§»æ–¹ç¨‹ï¼š</div><div class="line"></div><div class="line">dp[i+<span class="number">1</span>] = dp[i] + dp[i-<span class="number">1</span>];</div><div class="line">            â†‘        â†‘</div><div class="line">          æƒ…å†µ<span class="number">1</span>æˆç«‹  æƒ…å†µ<span class="number">2</span>æˆç«‹æ—¶</div><div class="line">          </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numDecodings</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(s.charAt(<span class="number">0</span>) == <span class="string">'0'</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[s.length() + <span class="number">1</span>];</div><div class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        dp[<span class="number">1</span>] = s.charAt(<span class="number">0</span>) &lt;= <span class="string">'9'</span> ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="comment">// æƒ…å†µ1</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'0'</span>)&#123;</div><div class="line">                dp[i + <span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                dp[i + <span class="number">1</span>] = dp[i];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// æƒ…å†µ2</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>) &gt; <span class="string">'0'</span> &amp;&amp; (s.charAt(i-<span class="number">1</span>) &lt; <span class="string">'2'</span> || (s.charAt(i-<span class="number">1</span>)==<span class="string">'2'</span>&amp;&amp;s.charAt(i) &lt;= <span class="string">'6'</span>)))&#123;</div><div class="line">                dp[i + <span class="number">1</span>] += dp[i-<span class="number">1</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(dp[i+<span class="number">1</span>] == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[s.length()];</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Decode-Ways-II">5.1.14. Decode Ways II</h3><p>æ¥ä¸Šé¢˜ï¼Œå¦‚æœå…¶ä¸­æœ‰å­—ç¬¦<code>*</code>è¡¨ç¤º<code>1-9</code>ã€‚åŒæ±‚å­—ç¬¦ä¸²å¯èƒ½çš„ç¼–ç æ–¹å¼ç§ç±»</p>
<p>æ€è·¯ï¼šæ¥ä¸Šé¢˜çš„æ€è·¯ï¼Œåªéœ€è¦è®¨è®º<code>*</code>å³å¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numDecodings</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span> s.length();</div><div class="line">        <span class="keyword">if</span>(s.charAt(<span class="number">0</span>) == <span class="string">'0'</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">long</span>[] dp = <span class="keyword">new</span> <span class="keyword">long</span>[s.length() + <span class="number">1</span>];</div><div class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(s.charAt(<span class="number">0</span>) == <span class="string">'*'</span>)</div><div class="line">            dp[<span class="number">1</span>] = <span class="number">9</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            dp[<span class="number">1</span>] = s.charAt(<span class="number">0</span>) &lt;= <span class="string">'9'</span> ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="comment">// æƒ…å†µ1</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'*'</span>)&#123;</div><div class="line">                dp[i + <span class="number">1</span>] = <span class="number">9</span>*dp[i];</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">'0'</span>)&#123;</div><div class="line">                dp[i + <span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">            &#125;<span class="keyword">else</span> &#123; <span class="comment">// 123456789</span></div><div class="line">                dp[i + <span class="number">1</span>] = dp[i];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// æƒ…å†µ2</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">'*'</span>)&#123;</div><div class="line">                <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>) == <span class="string">'*'</span>)&#123;</div><div class="line">                    dp[i + <span class="number">1</span>] += <span class="number">15</span>*dp[i-<span class="number">1</span>];</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>)==<span class="string">'1'</span>)&#123;</div><div class="line">                    dp[i + <span class="number">1</span>] += <span class="number">9</span>*dp[i-<span class="number">1</span>];</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>) == <span class="string">'2'</span>)&#123;</div><div class="line">                    dp[i + <span class="number">1</span>] += <span class="number">6</span>*dp[i-<span class="number">1</span>];</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>) == <span class="string">'*'</span>)&#123;</div><div class="line">                    <span class="keyword">if</span>(s.charAt(i) != <span class="string">'0'</span> &amp;&amp; s.charAt(i) &gt; <span class="string">'6'</span>)&#123;</div><div class="line">                        dp[i + <span class="number">1</span>] += dp[i-<span class="number">1</span>];</div><div class="line">                    &#125;<span class="keyword">else</span>&#123; <span class="comment">//  if(s.charAt(i) &lt;= '6')</span></div><div class="line">                        dp[i + <span class="number">1</span>] += <span class="number">2</span>*dp[i-<span class="number">1</span>];</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                &#125;<span class="keyword">else</span>  <span class="keyword">if</span>(s.charAt(i-<span class="number">1</span>) &gt; <span class="string">'0'</span> &amp;&amp; (s.charAt(i-<span class="number">1</span>) &lt; <span class="string">'2'</span> || (s.charAt(i-<span class="number">1</span>)==<span class="string">'2'</span>&amp;&amp;s.charAt(i) &lt;= <span class="string">'6'</span>)))&#123;</div><div class="line">                    dp[i + <span class="number">1</span>] += dp[i-<span class="number">1</span>];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(dp[i+<span class="number">1</span>] == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            dp[i+<span class="number">1</span>] = dp[i+<span class="number">1</span>]%<span class="number">1000000007</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(dp[s.length()]%<span class="number">1000000007</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Unique-Binary-Search-Trees">5.1.15. Unique Binary Search Trees</h3><p>æ±‚nä¸ªèŠ‚ç‚¹èƒ½ç»„æˆå¤šå°‘ç§äºŒå‰æ ‘ã€‚</p>
<p><strong>æ€è·¯ä¸€ï¼Œè®°å¿†åŒ–æœç´¢</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] memo;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span> remain)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(remain &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(memo[remain] &gt; <span class="number">0</span>) <span class="keyword">return</span> memo[remain];</div><div class="line">    <span class="keyword">if</span>(remain &lt;= <span class="number">1</span>)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; remain; ++i) &#123;</div><div class="line">        sum += helper(remain - i - <span class="number">1</span>)*helper(i);</div><div class="line">    &#125;</div><div class="line">    memo[remain] = sum;</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    memo = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</div><div class="line">    <span class="keyword">return</span> helper(n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼ŒDP</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">memo[i] : iä¸ªå…ƒç´ èƒ½ç»„æˆå¤šå°‘ç§äºŒå‰æ ‘</div><div class="line"></div><div class="line">åˆå§‹åŒ–ï¼š memo[<span class="number">0</span>] = <span class="number">1</span>, memo[<span class="number">1</span>] = <span class="number">1</span></div><div class="line"></div><div class="line">é€’æ¨å…¬å¼ï¼š</div><div class="line"></div><div class="line">memo[i] = Math.sum( memo[i - q - <span class="number">1</span>] * memo[q] ) , å…¶ä¸­ q = [<span class="number">0</span>,i)</div><div class="line"></div><div class="line">å«ä¹‰ï¼š iä¸ªèŠ‚ç‚¹çš„æ ‘ = å·¦å­æ ‘ä¸ºi-q-<span class="number">1</span>ä¸ªèŠ‚ç‚¹ * å³å­æ ‘ä¸ºqä¸ªèŠ‚ç‚¹                                                          </div><div class="line">                                                          </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[]memo = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</div><div class="line">        memo[<span class="number">0</span>] = <span class="number">1</span>; memo[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span>; q &lt; i; ++q)&#123;</div><div class="line">                memo[i] += memo[i-q-<span class="number">1</span>] * memo[q];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> memo[n];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="å•åºåˆ—å‹åŠ¨æ€è§„åˆ’">5.2. å•åºåˆ—å‹åŠ¨æ€è§„åˆ’</h2><p><strong>çŠ¶æ€</strong>ï¼š<code>f[i]</code>è¡¨ç¤º<strong>å‰iä¸ª</strong>ä½ç½®/æ•°å­—/å­—ç¬¦ï¼Œç¬¬iä¸ªâ€¦</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">   å‰iä¸ªä½ç½®</div><div class="line">|-------------|</div><div class="line">|<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,...,i|...,n</div><div class="line">|-------------|</div></pre></td></tr></table></figure>
<p><strong>æ–¹ç¨‹</strong>ï¼š<code>f[i] = f[j]</code>â€¦,jæ˜¯iä¹‹å‰çš„ä¸€ä¸ªä½ç½®</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼š<code>f[0]</code>â€¦</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<code>f[n]</code>â€¦</p>
<p>ä¸€èˆ¬answeræ˜¯<code>f[n]</code>è€Œä¸æ˜¯<code>f[n-1]</code>ï¼šå› ä¸ºå¯¹äºnä¸ªå­—ç¬¦ï¼ŒåŒ…å«å‰0ä¸ªå­—ç¬¦ï¼ˆç©ºä¸²ï¼‰ã€å‰1ä¸ªå­—ç¬¦ã€â€¦ã€å‰nä¸ªå­—ç¬¦</p>
<p>å› æ­¤<code>f[]</code>ä¸€èˆ¬éƒ½è¦å¼€<code>n+1</code>ä¸ª</p>
<h3 id="ä¾‹é¢˜1ï¼ŒWord-Break">5.2.1. ä¾‹é¢˜1ï¼ŒWord Break</h3><p>ç»™ä¸€ä¸ªè¯<code>lintcode</code>ï¼Œå’Œä¸€ä¸ªå­—å…¸<code>dict=[&quot;lint&quot;,&quot;code&quot;]</code>ï¼Œè¿™ä¸ªè¯èƒ½ä¸èƒ½è¢«è¯æ‹†åˆ†æˆè¯å…¸ä¸­çš„è¯â†’<code>lint code</code></p>
<p>æš´åŠ›æ–¹æ³•ï¼šé€’å½’æœç´¢å¤æ‚åº¦â†’$2^n$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">çŠ¶æ€ï¼šf[i]è¡¨ç¤ºå‰iä¸ªå­—ç¬¦èƒ½ä¸èƒ½è¢«åˆ‡æˆdictä¸­çš„è¯</div><div class="line">  </div><div class="line">^è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹</div><div class="line"></div><div class="line">idx â†’ <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></div><div class="line">f   â†’ <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> â† <span class="number">1</span>=<span class="keyword">true</span>,<span class="number">0</span>=<span class="keyword">false</span></div><div class="line">s   â†’ ^ l i n t c o d e</div><div class="line"></div><div class="line">è®¡ç®—æ­¥éª¤ï¼š</div><div class="line">i = <span class="number">4</span>,lint: </div><div class="line">lin + t -&gt; Ã—</div><div class="line">li  + nt -&gt; Ã—</div><div class="line">l   + <span class="keyword">int</span> -&gt; Ã—</div><div class="line"><span class="string">''</span>  + lint -&gt; âˆš</div><div class="line"></div><div class="line">i = <span class="number">8</span>,lintcodeï¼š</div><div class="line">lintcod + e</div><div class="line">lintco + de</div><div class="line">lintc + ode</div><div class="line">lint + code -&gt; âˆš</div><div class="line"></div><div class="line"></div><div class="line">f[<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">|=======å‰iä¸ªä½ç½®=======|</div><div class="line">  </div><div class="line">|------------|---------|</div><div class="line">|<span class="number">1</span>,<span class="number">2</span>,......,j|j+<span class="number">1</span>,...,i|</div><div class="line">|------------|---------|</div><div class="line"> åœ¨jä½ç½®åˆ‡ä¸€åˆ€ï¼Œå¦‚æœ<span class="number">1</span>~jèƒ½è¢«å®Œç¾åˆ‡åˆ†ï¼Œé‚£<span class="number">1</span>~iå°±å–å†³äºj+<span class="number">1</span>~jèƒ½ä¸èƒ½è¢«å®Œç¾åˆ‡åˆ†</div><div class="line"></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++i )&#123;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i ; ++j )&#123;</div><div class="line">  <span class="comment">// s[j~i]çš„æ“ä½œæ˜¯O(n)çš„ï¼</span></div><div class="line">  <span class="comment">// in dictæ“ä½œä¹Ÿæ˜¯O(n)çš„ï¼å› ä¸ºæ˜¯å•è¯çš„hashè¡¨ï¼Œè¦ä¾æ¬¡æ¯”è¾ƒçš„å“‡</span></div><div class="line">  <span class="keyword">if</span>(f[j] &amp;&amp; s[j~i] in dict )&#123;</div><div class="line">  		f[i] = <span class="keyword">true</span>;</div><div class="line">  		<span class="keyword">break</span>;</div><div class="line">  	&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$</p>
<p><strong>ä¼˜åŒ–</strong></p>
<p>åˆ©ç”¨å•è¯å¹³å‡é•¿åº¦ï¼ˆå•è¯ä¸ä¼šå¾ˆé•¿ï¼‰â€“ L ,ä»åå¾€å‰å“‡ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">i = <span class="number">4</span>,lint: </div><div class="line"><span class="string">''</span>  + lint -&gt; âˆš</div><div class="line"></div><div class="line">i = <span class="number">8</span>,lintcodeï¼š</div><div class="line">l + intcode</div><div class="line">li + ntcode</div><div class="line">lin + tcode</div><div class="line">lint + code -&gt; âˆš</div><div class="line"></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++i )&#123;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> j = i-<span class="number">1</span>; j &gt;= <span class="number">0</span> ; --j )&#123;</div><div class="line">  <span class="keyword">if</span>(f[j] &amp;&amp; s[j~i] in dict )&#123;</div><div class="line">  		f[i] = <span class="keyword">true</span>;</div><div class="line">  		<span class="keyword">break</span>;</div><div class="line">  	&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">nï¼šè¯é•¿åº¦</div><div class="line">mï¼šè¯å…¸å•è¯ä¸ªæ•°</div><div class="line">Lï¼šå•è¯å¹³å‡é•¿åº¦</div></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n\times L^2 + m)$</p>
<p>æœ€ç»ˆæˆ‘é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ï¼šç”¨trieç»™dictå»ºæ ‘ï¼Œæœç´¢æ—¶ä»åå¾€å‰æœç´¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        Node[] children;</div><div class="line">        <span class="keyword">boolean</span> hasWord;</div><div class="line">        Node()&#123;</div><div class="line">            children = <span class="keyword">new</span> Node[<span class="number">26</span>];</div><div class="line">            hasWord = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span></span>&#123;</div><div class="line">  Node root;</div><div class="line">  Trie()&#123;</div><div class="line">    root = <span class="keyword">new</span> Node();</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// æ·»åŠ èŠ‚ç‚¹</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String s)</span></span>&#123;</div><div class="line">    Node r = <span class="keyword">this</span>.root;</div><div class="line">    <span class="keyword">int</span> index;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">char</span> c : s.toCharArray() )&#123;</div><div class="line">      index = c - <span class="string">'a'</span>;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">null</span> == r.children[index])&#123;</div><div class="line">        r.children[index] = <span class="keyword">new</span> Node();</div><div class="line">      &#125;</div><div class="line">      r = r.children[index];</div><div class="line">    &#125;</div><div class="line">    r.hasWord = <span class="keyword">true</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//ä¼˜åŒ–åçš„æœç´¢</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">search</span><span class="params">(<span class="keyword">char</span>[] s,<span class="keyword">int</span> start,<span class="keyword">int</span> end)</span></span>&#123;</div><div class="line">    Node r = <span class="keyword">this</span>.root;</div><div class="line">    <span class="keyword">int</span> index,count = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = start ; i &lt; end ; ++i )&#123;</div><div class="line">      index = s[i] - <span class="string">'a'</span>;</div><div class="line">      <span class="keyword">if</span>( <span class="keyword">null</span> == r.children[index] )&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">        r = r.children[index];</div><div class="line">        ++count;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">boolean</span> res = count == end - start &amp;&amp; r.hasWord;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">wordBreak</span><span class="params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;</div><div class="line">  <span class="keyword">char</span>[] c = s.toCharArray();</div><div class="line">  <span class="keyword">int</span> n = c.length;</div><div class="line">  <span class="comment">// ä¸ºwordDictå»ºç«‹trieæ ‘</span></div><div class="line">  Trie trie = <span class="keyword">new</span> Trie();</div><div class="line">  <span class="keyword">for</span>( String w : wordDict )&#123;</div><div class="line">    trie.add(w);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//çŠ¶æ€f[i]:å•è¯0~iæ˜¯å¦èƒ½è¢«break</span></div><div class="line">  <span class="keyword">boolean</span>[] f = <span class="keyword">new</span> <span class="keyword">boolean</span>[n+<span class="number">1</span>];</div><div class="line">  <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">  f[<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">  <span class="comment">//dp</span></div><div class="line">  <span class="keyword">int</span> i,j;</div><div class="line">  <span class="comment">//O(N*L*L)</span></div><div class="line">  <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt;= n ; ++i )&#123; <span class="comment">// O(N) </span></div><div class="line">    <span class="keyword">for</span>( j = i ; j &gt;= <span class="number">0</span> ; --j )&#123;<span class="comment">//ä»åå¾€å‰æœç´¢,O(L)</span></div><div class="line">      <span class="keyword">if</span>( f[j] &amp;&amp; trie.search(c,j,i) )&#123;<span class="comment">//O(L)</span></div><div class="line">        f[i] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> f[n];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜2ï¼ŒPalindrome-Partitioning-II">5.2.2. ä¾‹é¢˜2ï¼ŒPalindrome Partitioning II</h3><p>ä¸€ä¸ªstræœ€å°‘è¢«åˆ‡å‰²å‡ æ¬¡å¯ä»¥åˆ‡å‰²ä¸ºéƒ½æ˜¯å›æ–‡ä¸²</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">f[i]:å‰iä¸ªå­—æ¯ï¼Œæœ€å°‘è¢«åˆ‡å‰²å‡ æ¬¡å¯ä»¥åˆ‡å‰²ä¸ºéƒ½æ˜¯å›æ–‡ä¸²</div><div class="line"></div><div class="line">|=======å‰iä¸ªä½ç½®=======|</div><div class="line">  </div><div class="line">|------------|---------|</div><div class="line">|<span class="number">1</span>,<span class="number">2</span>,......,j|j+<span class="number">1</span>,...,i|</div><div class="line">|------------|---------|</div><div class="line"></div><div class="line"> æ‰¾åˆ°ä¸€ä¸ªjï¼Œä½¿å¾—<span class="number">1</span>~jæ˜¯å›æ–‡ä¸²ï¼Œä¸”j+<span class="number">1</span>~ièƒ½è¢«åˆ†å‰²ä¸ºå›æ–‡ä¸²ã€‚åˆ™f[i] = f[j] + <span class="number">1</span></div><div class="line">  </div><div class="line"> éå†jï¼Œä½¿å¾—f[i] = min( f[j] + <span class="number">1</span> ) </div><div class="line">  </div><div class="line">f[<span class="number">0</span>]  = -<span class="number">1</span> <span class="comment">// åŸå› ï¼Œf[0]ä»£è¡¨ç©ºä¸²ï¼Œä¸ºäº†æŠµæ¶ˆç©ºä¸²å’ŒçœŸæ­£ä¸²çš„1</span></div><div class="line"><span class="comment">// ä¾‹å¦‚"aba",è¢«åˆ‡æˆ"aba"+""ï¼Œå³f[aba] = 1 + f[0]ï¼Œä½†å®ƒåº”è¯¥ç­‰äº0.æ‰€ä»¥æˆ‘ä»¬å®šä¹‰f[0] = -1</span></div><div class="line"></div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= s.length ; ++i )&#123;</div><div class="line">  f[i] = Integer.MAX_VALUE; <span class="comment">//å…¶å®ä¹Ÿå¯ä»¥æ˜¯i-1</span></div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; i ; ++j )&#123;</div><div class="line">    <span class="keyword">if</span>( s[j~i] is Palindrome )&#123;</div><div class="line">      f[i] = Math.min( f[i], f[j] + <span class="number">1</span> )</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[][] ifPalindrome;</div><div class="line">    <span class="keyword">int</span>[] min;</div><div class="line">    <span class="comment">//åˆ¤æ–­i~jæ˜¯å¦æ˜¯å›æ–‡ä¸²</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Palindrome</span><span class="params">(<span class="keyword">char</span>[] c,<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>( ifPalindrome[i][j] &gt; <span class="number">0</span> ) &#123;</div><div class="line">            <span class="keyword">return</span> ifPalindrome[i][j];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( i == j )&#123;</div><div class="line">            ifPalindrome[i][j] = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>( c[i] == c[j] )&#123;</div><div class="line">            <span class="keyword">if</span>( j - i &lt; <span class="number">3</span> )&#123;</div><div class="line">                ifPalindrome[i][j] = <span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                ifPalindrome[i][j] = ifPalindrome[i+<span class="number">1</span>][j-<span class="number">1</span>] ;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            ifPalindrome[i][j] = <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ifPalindrome[i][j];</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//dpé€’å½’</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">cut</span><span class="params">(<span class="keyword">char</span>[] c,<span class="keyword">int</span> idx, <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>( idx &gt;= n ) &#123;<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">        <span class="keyword">if</span>( min[idx] &gt; <span class="number">0</span> )&#123; <span class="keyword">return</span> min[idx];&#125;</div><div class="line">        <span class="comment">/** idx ....,j,....,n</span></div><div class="line">         * å¦‚æœidx~jæ˜¯å›æ–‡ï¼Œåˆ™ä»jåˆ‡ä¸€åˆ€ï¼Œ[i~n] = 1 + [j~n]**/</div><div class="line">        min[idx] = n;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> j = idx ; j &lt; n ; ++j )&#123;</div><div class="line">            <span class="keyword">if</span>( Palindrome(c,idx,j) == <span class="number">1</span> )&#123;</div><div class="line">                min[idx] = Math.min( <span class="number">1</span> + cut( c, j+<span class="number">1</span>, n ), min[idx] );</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> min[idx];</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//ä¸»å‡½æ•°</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCut</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = s.length();</div><div class="line">        <span class="keyword">if</span>( n &lt;= <span class="number">1</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        min = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">        ifPalindrome = <span class="keyword">new</span> <span class="keyword">int</span>[n][n];</div><div class="line">        <span class="keyword">char</span>[] c = s.toCharArray();</div><div class="line">        <span class="keyword">int</span> res =  cut(c,<span class="number">0</span>,n);</div><div class="line">        <span class="keyword">return</span> res-<span class="number">1</span>; <span class="comment">// å› ä¸ºåˆ°æœ«å°¾çš„æ—¶å€™ä¹Ÿåˆ‡äº†ä¸€åˆ€ï¼Œè¿™ä¸€åˆ€æ²¡æœ‰å¿…è¦ï¼</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å¦ä¸€ç§æ€è·¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f[i] : å‰iä¸ªå­—ç¬¦ï¼Œæœ€å°‘å¯ä»¥è¢«åˆ‡ä¸ºå‡ ä¸ªå›æ–‡ä¸²</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–</strong>ï¼šåˆ¤æ–­i~jæ˜¯å¦æ˜¯å›æ–‡ä¸²</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">i,i+<span class="number">1</span>.........,j-<span class="number">1</span>,j æ˜¯å›æ–‡ä¸²ï¼Œåˆ™</div><div class="line">i,i+<span class="number">1</span>,........,j-<span class="number">1</span>   æ˜¯å›æ–‡ä¸²</div><div class="line"></div><div class="line">è¿™æ˜¯ä¸€ç§åŒºé—´å‹DPï¼Œæˆ–è€…è¯´æ˜¯ä¸€ç§é€’æ¨</div></pre></td></tr></table></figure>
<h3 id="Palindromic-Substrings">5.2.3. Palindromic Substrings</h3><p>è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²æ‰€æœ‰çš„å›æ–‡å­ä¸²çš„ä¸ªæ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: &quot;aaa&quot;</div><div class="line">Output: 6</div><div class="line">Explanation: Six palindromic strings: &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;aa&quot;, &quot;aa&quot;, &quot;aaa&quot;.</div></pre></td></tr></table></figure>
<p>æˆ‘çš„æ€è·¯éå¸¸æš´åŠ›ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. str -&gt; <span class="keyword">char</span>[] c</div><div class="line"><span class="number">2</span>. å®šä¹‰<span class="keyword">int</span>[][] ifPalindromic -&gt; ifPalindromic[i][j] = <span class="number">1</span>-&gt;æ˜¯å›æ–‡ä¸²ï¼Œ<span class="number">2</span>-&gt;ä¸æ˜¯</div><div class="line"><span class="number">3</span>. <span class="keyword">if</span> c[i] == c[j]&#123; <span class="comment">// i~jå¯èƒ½æ˜¯å›æ–‡ä¸²</span></div><div class="line">	ifPalindromic = Palindromic[i+<span class="number">1</span>][j-<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="number">4</span>. <span class="keyword">else</span>:</div><div class="line">	<span class="comment">//è€ƒå¯Ÿi~j-1å’Œi+1~j</span></div><div class="line">   ifPalindromic[i+<span class="number">1</span>][j] = Palindromic(c,i+<span class="number">1</span>,j);</div><div class="line">   ifPalindromic[i][j-<span class="number">1</span>] = Palindromic(c,i,j-<span class="number">1</span>);</div><div class="line"></div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[][] ifPalindromic;</div><div class="line"><span class="keyword">int</span> count = <span class="number">0</span>; <span class="comment">//è®¡æ•°å™¨</span></div><div class="line"></div><div class="line"><span class="comment">//åˆ¤æ–­start~endæ˜¯ä¸æ˜¯å›æ–‡ä¸²</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">Palindromic</span><span class="params">(<span class="keyword">char</span>[] c, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>( start &gt;= end )<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">if</span>( ifPalindromic[start][end] &gt; <span class="number">0</span> )<span class="keyword">return</span> ifPalindromic[start][end];</div><div class="line">  <span class="keyword">if</span>( c[start] == c[end] )&#123;</div><div class="line">    ifPalindromic[start][end] = Palindromic(c,start+<span class="number">1</span>,end-<span class="number">1</span>);</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    ifPalindromic[start][end] = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(start+<span class="number">1</span>&lt;end)ifPalindromic[start+<span class="number">1</span>][end] = Palindromic(c,start+<span class="number">1</span>,end);</div><div class="line">  <span class="keyword">if</span>(start&lt;end-<span class="number">1</span>)ifPalindromic[start][end-<span class="number">1</span>] = Palindromic(c,start,end-<span class="number">1</span>);</div><div class="line">  <span class="keyword">if</span>( ifPalindromic[start][end] == <span class="number">1</span> )&#123;</div><div class="line">    ++count;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> ifPalindromic[start][end];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSubstrings</span><span class="params">(String s)</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">char</span>[] c = s.toCharArray();</div><div class="line">  <span class="keyword">int</span> n = c.length;</div><div class="line">  <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> n;</div><div class="line">  ifPalindromic = <span class="keyword">new</span> <span class="keyword">int</span>[n][n];</div><div class="line">  <span class="comment">// 1 -&gt; true</span></div><div class="line">  <span class="comment">// 2 -&gt; false</span></div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++i )&#123;</div><div class="line">    ifPalindromic[i][i] = <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  Palindromic(c,<span class="number">0</span>,n-<span class="number">1</span>);</div><div class="line">  <span class="keyword">return</span> count+n;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§æ€è·¯ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">è‹¥    ,i+<span class="number">1</span>,...,j-<span class="number">1</span>,     æ˜¯å›æ–‡ä¸² , ä¸”c[i] == c[j]</div><div class="line">åˆ™   i,...........,j    æ˜¯å›æ–‡ä¸²</div><div class="line"></div><div class="line">è®¡ç®—è¿‡ç¨‹ä¸º</div><div class="line"></div><div class="line">iæ˜¯ä»å¤§åˆ°å°çš„</div><div class="line">jæ˜¯ä»iåˆ°nçš„</div><div class="line"></div><div class="line">å› ä¸º[i+<span class="number">1</span>][...]å·²ç»ç®—è¿‡äº†</div><div class="line">å› æ­¤[i][j] = ...[i+<span class="number">1</span>][j-<span class="number">1</span>]è‚¯å®šèƒ½ç®—å‡ºæ¥</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSubstrings</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = s.length();</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][n];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; j++) &#123;</div><div class="line">            dp[i][j] = s.charAt(i) == s.charAt(j) &amp;&amp; (j - i &lt; <span class="number">3</span> || dp[i + <span class="number">1</span>][j - <span class="number">1</span>]);</div><div class="line">            <span class="keyword">if</span>(dp[i][j]) ++res;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶å®è¿˜æœ‰ä¸€ç§æ›´æš´åŠ›ï¼Œæ›´ç®€å•çš„è§£æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSubstrings</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (s == <span class="keyword">null</span> || s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) &#123; <span class="comment">// iæ˜¯å›æ–‡ä¸²çš„ä¸­ç‚¹</span></div><div class="line">    extendPalindrome(s, i, i); <span class="comment">//å¥‡æ•°é•¿åº¦</span></div><div class="line">    extendPalindrome(s, i, i + <span class="number">1</span>); <span class="comment">//å¶æ•°é•¿åº¦</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> count;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">extendPalindrome</span><span class="params">(String s, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">  <span class="keyword">while</span> (left &gt;=<span class="number">0</span> &amp;&amp; right &lt; s.length() &amp;&amp; s.charAt(left) == s.charAt(right)) &#123;</div><div class="line">    count++; left--; right++;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="House-Robber">5.2.4. House Robber</h3><p>ç»™ä¸€ä¸ªæ•°ç»„<code>int[] nums</code>ï¼Œè¡¨ç¤ºæ¯ä¸ªå•†åº—çš„ä»·å€¼ã€‚è¦æŠ¢åŠ«ï¼Œä½†æŠ¢åŠ«æ—¶å¿…é¡»è‡³å°‘éš”ä¸€ä¸ªå•†é“ºæŠ¢ã€‚é—®èƒ½æŠ¢åˆ°çš„æœ€å¤§ä»·å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( nums.length == <span class="number">0</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="comment">//çŠ¶æ€f[i]ï¼šå‰iå®¶æœ€å¤§ä»·å€¼</span></div><div class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length+<span class="number">1</span>];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        f[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        f[<span class="number">1</span>] = nums[<span class="number">0</span>];</div><div class="line">        <span class="comment">//DP</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; nums.length ; ++i )&#123;</div><div class="line">            f[i+<span class="number">1</span>] = Math.max(f[i],f[i-<span class="number">1</span>]+nums[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> f[nums.length];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="House-Robber-II">5.2.5. House Robber II</h3><p>ç»™ä¸€ä¸ªæ•°ç»„<code>int[] nums</code>ï¼Œè¡¨ç¤ºæ¯ä¸ªå•†åº—çš„ä»·å€¼ã€‚å•†åº—æ˜¯æˆç¯çš„ï¼Œå³é¦–å°¾ç›¸æ¥ã€‚è¦æŠ¢åŠ«ï¼Œä½†æŠ¢åŠ«æ—¶å¿…é¡»è‡³å°‘éš”ä¸€ä¸ªå•†é“ºæŠ¢ã€‚é—®èƒ½æŠ¢åˆ°çš„æœ€å¤§ä»·å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">5</span>]</div><div class="line">å…¶å®æˆç¯çš„å•†åº—å¦‚æœå»æ‰é¦–/å°¾æŸä¸ªçš„è¯ï¼Œå°±ä¸æˆç¯äº†ï¼Œå°±å˜æˆäº†ä¸Šä¸€é¢˜ã€‚</div><div class="line">  <span class="number">1</span> <span class="number">3</span> 	</div><div class="line"><span class="number">5</span>     <span class="number">4</span></div><div class="line">  <span class="number">2</span> <span class="number">6</span></div><div class="line">  </div><div class="line">ä¾‹å¦‚è¿™ä¸ªç¯ï¼Œ</div><div class="line">å‡è®¾è‚¯å®šä¸æŠ¢<span class="number">1</span>ï¼šå˜æˆäº†[<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">5</span>]</div><div class="line">å‡è®¾è‚¯å®šä¸æŠ¢<span class="number">5</span>ï¼šå˜æˆäº†[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>]</div></pre></td></tr></table></figure>
<h2 id="House-Robber-III">5.3. House Robber III</h2><p>å•†åº—å˜æˆäº†ä¸€ä¸ªäºŒå‰æ ‘</p>
<p><strong>æ€è·¯ä¸€ï¼Œhashè¡¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;TreeNode, <span class="keyword">int</span>[]&gt; memo = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="comment">// key : èŠ‚ç‚¹</span></div><div class="line">    <span class="comment">// value[0] = ä¸æŠ¢çš„maxï¼Œvalue[1] = æŠ¢çš„max</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(TreeNode root, <span class="keyword">boolean</span> robed)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(!memo.containsKey(root))&#123;</div><div class="line">            memo.put(root, <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>]);</div><div class="line">            memo.get(root)[<span class="number">0</span>] = dfs(root.left, <span class="keyword">false</span>) + dfs(root.right, <span class="keyword">false</span>);</div><div class="line">            memo.get(root)[<span class="number">1</span>] = root.val + dfs(root.left, <span class="keyword">true</span>) + dfs(root.right, <span class="keyword">true</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(robed)&#123; <span class="comment">// ä¸Šä¸€è½®æŠ¢äº†,è¿™ä¸€è½®åªèƒ½ä¸æŠ¢</span></div><div class="line">            <span class="keyword">return</span> memo.get(root)[<span class="number">0</span>];</div><div class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//ä¸Šä¸€è½®æ²¡æŠ¢ï¼Œè¿™æ¬¡éšæ„</span></div><div class="line">            <span class="keyword">return</span> Math.max(memo.get(root)[<span class="number">0</span>], memo.get(root)[<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Math.max(dfs(root, <span class="keyword">true</span>), dfs(root, <span class="keyword">false</span>));</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œä¼˜åŒ–</strong></p>
<p>å…¶å®åªéœ€è¦ç”¨åˆ°æœ¬çŠ¶æ€å’Œä¸Šä¸€çŠ¶æ€ï¼Œå¹¶ä¸éœ€è¦hashè¡¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span>[] result = help(root); <span class="comment">//return int[]&#123;with root, without root&#125;</span></div><div class="line">    <span class="keyword">return</span> Math.max(result[<span class="number">0</span>], result[<span class="number">1</span>]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] help(TreeNode root) &#123;</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span>[] left = help(root.left);</div><div class="line">    <span class="keyword">int</span>[] right = help(root.right);</div><div class="line">    <span class="comment">//with root</span></div><div class="line">    <span class="keyword">int</span> with = root.val + left[<span class="number">1</span>] + right[<span class="number">1</span>];</div><div class="line">    <span class="keyword">int</span> without = left[<span class="number">0</span>] + right[<span class="number">0</span>];</div><div class="line">    with = Math.max(with, without);</div><div class="line">    <span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;with, without&#125;;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Maximal-Square">5.3.1. Maximal Square</h3><p>ç»™ä¸€ä¸ª0/1çŸ©é˜µã€‚æ‰¾åˆ°æœ€å¤§å…¨1æ–¹é˜µï¼Œè¿”å›æ–¹é˜µå…ƒç´ ä¸ªæ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1 0 1 0 0</div><div class="line">1 0 1 1 1</div><div class="line">1 1 1 1 1</div><div class="line">1 0 0 1 0  </div><div class="line"></div><div class="line">-&gt; return 4</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜æˆ‘ä½¿ç”¨äº†ä¸€ç§è¾ƒç¬¨çš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">count[i][j] : å½“å‰æ ¼å­çš„å·¦ä¸Šè§’æœ‰å¤šå°‘è¡Œ/åˆ—å…¨<span class="number">1</span>æ–¹é˜µ</div><div class="line"></div><div class="line">[i,j]</div><div class="line">x x x x          x</div><div class="line">x x x x          x</div><div class="line">x x x x          x</div><div class="line">x x x c[i-<span class="number">1</span>,j-<span class="number">1</span>] x</div><div class="line">x x x x          <span class="number">1</span> &lt;- [i,j]</div><div class="line"></div><div class="line">å¦‚æœ c[i-<span class="number">1</span>,j-<span class="number">1</span>] == <span class="number">1</span>ï¼Œé‚£å¿…é¡»æ˜¯ä»¥ä¸‹è¿™æ ·æ—¶ï¼Œc[i,j] = <span class="number">1</span> + <span class="number">1</span> = <span class="number">1</span></div><div class="line">x x x x x</div><div class="line">x x x x x</div><div class="line">x x x x x</div><div class="line">x x x <span class="number">1</span> <span class="number">1</span></div><div class="line">x x x <span class="number">1</span> <span class="number">1</span> &lt;- [i,j]</div><div class="line"></div><div class="line">å¦‚æœ c[i-<span class="number">1</span>,j-<span class="number">1</span>] == <span class="number">2</span>ï¼Œé‚£å¿…é¡»æ˜¯ä»¥ä¸‹è¿™æ ·æ—¶ï¼Œc[i,j] = <span class="number">1</span> + <span class="number">2</span> = <span class="number">3</span></div><div class="line">x x x x x</div><div class="line">x x x x x</div><div class="line">x x x x <span class="number">1</span></div><div class="line">x x x <span class="number">1</span> <span class="number">1</span></div><div class="line">x x <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> &lt;- [i,j]</div><div class="line"></div><div class="line">æˆ–è€…è¿™æ ·ï¼Œc[i,j] = <span class="number">1</span> + <span class="number">1</span> = <span class="number">1</span></div><div class="line">x x x x x</div><div class="line">x x x x x</div><div class="line">x x x x <span class="number">0</span></div><div class="line">x x x <span class="number">1</span> <span class="number">1</span></div><div class="line">x x <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> &lt;- [i,j]</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximalSquare</span><span class="params">(<span class="keyword">char</span>[][] matrix)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span> )<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span>[][] counter = <span class="keyword">new</span> <span class="keyword">int</span>[matrix.length][matrix[<span class="number">0</span>].length];</div><div class="line">        <span class="keyword">int</span> i,j;</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; matrix.length ; ++i )&#123;</div><div class="line">            counter[i][<span class="number">0</span>] = (<span class="keyword">int</span>) matrix[i][<span class="number">0</span>] - <span class="number">48</span>;</div><div class="line">            max = Math.max(max,counter[i][<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; matrix[<span class="number">0</span>].length ; ++j )&#123;</div><div class="line">            counter[<span class="number">0</span>][j] = (<span class="keyword">int</span>) matrix[<span class="number">0</span>][j] - <span class="number">48</span>;</div><div class="line">            max = Math.max(max,counter[<span class="number">0</span>][j]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> k,q;</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; matrix.length ; ++i )&#123;</div><div class="line">            <span class="keyword">for</span>( j = <span class="number">1</span>; j &lt; matrix[i].length ; ++j )&#123;</div><div class="line">                <span class="keyword">if</span>( matrix[i][j] == <span class="string">'0'</span> ) <span class="keyword">continue</span>;</div><div class="line">                counter[i][j] = <span class="number">1</span>;</div><div class="line">                k = counter[i-<span class="number">1</span>][j-<span class="number">1</span>];</div><div class="line">                <span class="keyword">for</span>( q = <span class="number">1</span> ; q &lt;= k ; ++q )&#123;</div><div class="line">                    <span class="keyword">if</span>( matrix[i-q][j] != <span class="string">'1'</span> || matrix[i][j-q] !=<span class="string">'1'</span> )&#123;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        counter[i][j] += <span class="number">1</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                max = Math.max(max, counter[i][j]);</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max*max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œæœ‰ä¸€ç§éå¸¸éå¸¸æœºæ™ºçš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (matrix[i][j] == <span class="string">'1'</span>) &#123;</div><div class="line">                size[i][j] = min(size[i - <span class="number">1</span>][j - <span class="number">1</span>], min(size[i - <span class="number">1</span>][j], size[i][j - <span class="number">1</span>])) + <span class="number">1</span>;</div><div class="line">                maxsize = max(maxsize, size[i][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§æ›´æœºæ™ºçš„æ–¹æ³•ã€‚ç”±äº<code>f[i][j]</code>åªå’Œå‰3ä¸ªç»“æœç›¸å…³</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f[i - <span class="number">1</span>][j - <span class="number">1</span>]    f[i][j - <span class="number">1</span>]</div><div class="line">f[i - <span class="number">1</span>][j]        f[i][j]</div></pre></td></tr></table></figure>
<p>æ•…åªéœ€è¦ä¿ç•™ä¸€ä¸ª2è¡Œçš„æ•°ç»„ï¼ï¼ï¼<br>åˆ—ä¸Šä¸èƒ½ä¼˜åŒ–ï¼Œå› ä¸º2é‡å¾ªç¯çš„æ—¶å€™ ä¸‹åˆ—çš„æ—¶å€™ä¾èµ–äºä¸Šåˆ—çš„ç»“æœï¼Œä¸Šåˆ—çš„ç»“æœéœ€è¦ä¿å­˜åˆ°è®¡ç®—ä¸‹åˆ—çš„æ—¶å€™ç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;  </div><div class="line">    <span class="keyword">if</span> (matrix == <span class="keyword">null</span> || matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) &#123;  </div><div class="line">        <span class="keyword">return</span> ans;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> n = <span class="number">2</span>;  </div><div class="line">    <span class="keyword">int</span> m = matrix[<span class="number">0</span>].length;  </div><div class="line">      </div><div class="line">    <span class="comment">// çŠ¶æ€  </span></div><div class="line">    <span class="keyword">int</span>[][] f = <span class="keyword">new</span> <span class="keyword">int</span>[n][m];   <span class="comment">// 2è¡Œï¼Œmåˆ—</span></div><div class="line">    <span class="comment">// åˆå§‹åŒ–  </span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;  </div><div class="line">        f[i][<span class="number">0</span>] = matrix[i][<span class="number">0</span>];  </div><div class="line">        ans = Math.max(f[i][<span class="number">0</span>], ans);  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;  </div><div class="line">        f[<span class="number">0</span>][i] = matrix[<span class="number">0</span>][i];  </div><div class="line">        ans = Math.max(f[<span class="number">0</span>][i], ans);  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">// æ–¹ç¨‹  </span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; matrix.length; i++) &#123;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; m; j++) &#123;  </div><div class="line">            <span class="keyword">if</span> (matrix[i][j] == <span class="number">1</span>) &#123;  </div><div class="line">                f[i%<span class="number">2</span>][j] = Math.min(Math.min(f[(i-<span class="number">1</span>)%<span class="number">2</span>][j-<span class="number">1</span>], f[i%<span class="number">2</span>][j-<span class="number">1</span>]), f[(i-<span class="number">1</span>)%<span class="number">2</span>][j]) + <span class="number">1</span>;  </div><div class="line">            &#125; <span class="keyword">else</span> &#123;  </div><div class="line">                f[i%<span class="number">2</span>][j] = <span class="number">0</span>;  </div><div class="line">            &#125;  </div><div class="line">            ans = Math.max(ans, f[i%<span class="number">2</span>][j]);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">// ç»“æœ  </span></div><div class="line">    <span class="keyword">return</span> ans * ans;</div></pre></td></tr></table></figure>
<h3 id="Paint-House">5.3.2. Paint House</h3><p>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„<code>cost[][]</code>ï¼Œå¤§å°ä¸ºnÃ—3ã€‚å…¶ä¸­<code>cost[i][q]</code>è¡¨ç¤ºç¬¬iä¸ªæˆ¿å­æ¶‚ä¸Šç¬¬qç§é¢œè‰²æ—¶çš„é€ ä»·ã€‚ä¸€å…±æœ‰3ç§é¢œè‰²ã€‚è¦æ±‚ä¸¤ä¸ªç›¸é‚»æˆ¿å­ä¸å¯ä»¥åŒè‰²ã€‚æ±‚æ¶‚è‰²æœ€å°é€ ä»·</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="number">0</span>,<span class="number">1</span>,...,|i-<span class="number">1</span>| i |,.....</div><div class="line">        |   | g |</div><div class="line">        | r | b |</div><div class="line">        ---------</div><div class="line">        | g | r |</div><div class="line">        |   | b |</div><div class="line">        ---------</div><div class="line">        | b | r |</div><div class="line">        |   | g |</div><div class="line"></div><div class="line">å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ¶‚ç¬¬iä¸ªæˆ¿å­çš„æ—¶å€™ï¼Œå–å†³äºç¬¬i-<span class="number">1</span>ä¸ªæˆ¿å­æ˜¯ä»€ä¹ˆé¢œè‰²</div><div class="line"></div><div class="line">è€Œç¬¬<span class="number">0</span>~iä¸ªæˆ¿å­çš„æ€»æœ€å°é€ ä»·ï¼Œä¸€å®šæ˜¯ç¬¬iä¸ªæˆ¿å­æ¶‚r/g/bé¢œè‰²æ—¶çš„æœ€å°å€¼</div><div class="line"></div><div class="line">é‚£æˆ‘ä»¬å¯ä»¥å‡è®¾æˆ‘ä»¬å·²çŸ¥ç¬¬i-<span class="number">1</span>ä¸ªæˆ¿å­æ¶‚r/g/bæ—¶æœ€å°é€ ä»·ï¼Œå°±å¯ä»¥æ¨å‡ºç¬¬iä¸ªæˆ¿å­æ¶‚r/g/bæ—¶æœ€å°é€ ä»·</div><div class="line"></div><div class="line">total[i][q] = Math.min(</div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">0</span>] + cost[i][<span class="number">1</span>],</div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">0</span>] + cost[i][<span class="number">2</span>],</div><div class="line">  </div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">1</span>] + cost[i][<span class="number">2</span>],</div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">1</span>] + cost[i][<span class="number">0</span>],</div><div class="line">  </div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">2</span>] + cost[i][<span class="number">0</span>],</div><div class="line">  				total[i-<span class="number">1</span>][<span class="number">2</span>] + cost[i][<span class="number">1</span>]</div><div class="line">					)</div><div class="line">  </div><div class="line">å°†ä¸Šé¢è¿™ä¸ªå¼å­æ¢ä¸€ç§å½¢å¼ï¼š</div><div class="line">total[i][q] = Math.min(</div><div class="line">  Math.min(</div><div class="line">    total[i-<span class="number">1</span>][<span class="number">1</span>] + cost[i][<span class="number">0</span>], --&gt; ç¬¬iä¸ªæˆ¿å­é¢œè‰²ä¸º<span class="number">0</span>çš„min</div><div class="line">  	total[i-<span class="number">1</span>][<span class="number">2</span>] + cost[i][<span class="number">0</span>]), </div><div class="line"></div><div class="line">  Math.min(</div><div class="line">    total[i-<span class="number">1</span>][<span class="number">0</span>] + cost[i][<span class="number">1</span>], --&gt; ç¬¬iä¸ªæˆ¿å­é¢œè‰²ä¸º<span class="number">1</span>çš„min</div><div class="line">  	total[i-<span class="number">1</span>][<span class="number">2</span>] + cost[i][<span class="number">1</span>]), --&gt;</div><div class="line"></div><div class="line">  Math.min(</div><div class="line">    total[i-<span class="number">1</span>][<span class="number">0</span>] + cost[i][<span class="number">2</span>], --&gt; ç¬¬iä¸ªæˆ¿å­é¢œè‰²ä¸º<span class="number">2</span>çš„min</div><div class="line">  	total[i-<span class="number">1</span>][<span class="number">1</span>] + cost[i][<span class="number">2</span>])  --&gt;</div><div class="line">					)</div><div class="line"></div><div class="line">  å®ç°ï¼š</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCost</span><span class="params">(<span class="keyword">int</span>[][] costs)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>( costs.length == <span class="number">0</span> || costs[<span class="number">0</span>].length == <span class="number">0</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="comment">//çŠ¶æ€total[i][q]è¡¨ç¤ºç¬¬iä¸ªæˆ¿å­åœ¨æ¶‚ç¬¬qç§é¢œè‰²æ—¶ï¼Œå‰iä¸ªæˆ¿å­çš„çš„æœ€å°cost</span></div><div class="line">  <span class="comment">// 0 -&gt; red</span></div><div class="line">  <span class="comment">// 1 -&gt; blue</span></div><div class="line">  <span class="comment">// 2 -&gt; green</span></div><div class="line">  <span class="keyword">int</span> n = costs.length;</div><div class="line">  <span class="keyword">int</span>[][] total = <span class="keyword">new</span> <span class="keyword">int</span>[n][costs[<span class="number">0</span>].length];</div><div class="line"></div><div class="line">  <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; <span class="number">3</span> ; ++q )&#123;</div><div class="line">    total[<span class="number">0</span>][q] = costs[<span class="number">0</span>][q];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++i )&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; <span class="number">3</span> ; ++q )&#123;</div><div class="line">      total[i][q] = Integer.MAX_VALUE;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//dp</span></div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++i )&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; <span class="number">3</span> ; ++q )&#123;</div><div class="line">      total[i][q] = Math.min(total[i][q],costs[i][q] + total[i-<span class="number">1</span>][(q+<span class="number">1</span>)%<span class="number">3</span>]);</div><div class="line">      total[i][q] = Math.min(total[i][q],costs[i][q] + total[i-<span class="number">1</span>][(q+<span class="number">2</span>)%<span class="number">3</span>]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  n -= <span class="number">1</span>;</div><div class="line">  <span class="keyword">int</span> res = Math.min(total[n][<span class="number">0</span>],total[n][<span class="number">1</span>]);</div><div class="line">  res =Math.min(res,total[n][<span class="number">2</span>]);</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªç©ºé—´å¤æ‚åº¦æ˜¯$O(n)$,æ—¶é—´å¤æ‚åº¦æ˜¯$O(n)$ã€‚å…¶å®è¿˜æœ‰ä¼˜åŒ–æ–¹æ³•ï¼Œå°†ç©ºé—´å¤æ‚åº¦é™ä¸º$O(1)$ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCost</span><span class="params">(<span class="keyword">int</span>[][] costs)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(costs==<span class="keyword">null</span>||costs.length==<span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;costs.length; i++)&#123;</div><div class="line">        costs[i][<span class="number">0</span>] += Math.min(costs[i-<span class="number">1</span>][<span class="number">1</span>],costs[i-<span class="number">1</span>][<span class="number">2</span>]);</div><div class="line">        costs[i][<span class="number">1</span>] += Math.min(costs[i-<span class="number">1</span>][<span class="number">0</span>],costs[i-<span class="number">1</span>][<span class="number">2</span>]);</div><div class="line">        costs[i][<span class="number">2</span>] += Math.min(costs[i-<span class="number">1</span>][<span class="number">1</span>],costs[i-<span class="number">1</span>][<span class="number">0</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> n = costs.length-<span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> Math.min(Math.min(costs[n][<span class="number">0</span>], costs[n][<span class="number">1</span>]), costs[n][<span class="number">2</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Target-Sum">5.4. Target Sum</h2><p>ç»™ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetã€‚æ±‚æ•°ç»„çš„æ¯ä¸ªå…ƒç´ çš„æ­£ã€è´Ÿå’Œç­‰äºtargetçš„ä¸ªæ•°ã€‚</p>
<p><strong>æ€è·¯ä¸€ï¼Œé€’å½’memo</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[][] dp;</div><div class="line">	<span class="comment">// dp[idx][sum + 1000] : å‰idxä¸ªæ•°å­—çš„å’Œä¸ºsumæ—¶ï¼Œæœ€ç»ˆå’Œä¸ºSçš„ä¸ªæ•°</span></div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> idx, <span class="keyword">int</span> S, <span class="keyword">int</span> sum)</span></span>&#123;</div><div class="line">       <span class="keyword">if</span>(idx == nums.length)&#123;</div><div class="line">           <span class="keyword">if</span>(S == sum) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">           <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span>(dp[idx][<span class="number">1000</span>+sum] &gt; <span class="number">0</span>) <span class="keyword">return</span> dp[idx][<span class="number">1000</span>+sum];</div><div class="line">       dp[idx][<span class="number">1000</span>+sum] = helper(nums, idx + <span class="number">1</span>, S, sum + nums[idx]) +</div><div class="line">               helper(nums, idx + <span class="number">1</span>, S, sum - nums[idx]);</div><div class="line">       <span class="keyword">return</span> dp[idx][<span class="number">1000</span>+sum];</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTargetSumWays</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> S)</span> </span>&#123;</div><div class="line">       dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length][<span class="number">2001</span>];</div><div class="line">       <span class="keyword">return</span> helper(nums, <span class="number">0</span>, S, <span class="number">0</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯2ï¼Œéé€’å½’memo</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTargetSumWays</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> S)</span> </span>&#123;</div><div class="line">    <span class="comment">// å¦‚æœSè¿‡å¤§æˆ–è¿‡å°ï¼Œå¤§äºæ‰€æœ‰æ•°å­—çš„å’Œï¼Œæˆ–å°äºæ‰€æœ‰æ•°å­—çš„æœ€å°å’Œï¼Œé‚£å°±gg</span></div><div class="line">    <span class="keyword">int</span> allSum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> e : nums) allSum += e;</div><div class="line">    <span class="keyword">if</span>(S &gt; allSum || S &lt; -allSum)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length + <span class="number">1</span>][<span class="number">2001</span>];</div><div class="line">    <span class="comment">// dp[idx][sum + 1000] : å‰idxä¸ªæ•°å­—(ä¸å«)çš„å’Œä¸ºsumæ—¶ï¼Œæœ€ç»ˆå’Œä¸ºSçš„ä¸ªæ•°</span></div><div class="line">    <span class="comment">//åˆå§‹åŒ–,0ä¸ªæ•°å­—æ—¶</span></div><div class="line">    dp[<span class="number">0</span>][<span class="number">1000</span> + <span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="comment">//dp</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> idx = <span class="number">1</span>; idx &lt;= nums.length; ++idx )&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> sum = <span class="number">0</span>; sum &lt;<span class="number">2001</span>; ++sum)&#123; <span class="comment">// è¿™ä¸ªå¾ªç¯æˆ‘æ²¡æƒ³å‡ºæ¥ï¼</span></div><div class="line">            <span class="keyword">if</span>(dp[idx-<span class="number">1</span>][sum] != <span class="number">0</span> &amp;&amp;</div><div class="line">                sum + nums[idx-<span class="number">1</span>] &lt; <span class="number">2001</span> &amp;&amp;</div><div class="line">                sum - nums[idx-<span class="number">1</span>] &lt; <span class="number">2001</span>) &#123;</div><div class="line">                dp[idx][sum + nums[idx-<span class="number">1</span>]] += dp[idx - <span class="number">1</span>][sum];</div><div class="line">                dp[idx][sum - nums[idx-<span class="number">1</span>]] += dp[idx - <span class="number">1</span>][sum];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> dp[nums.length][<span class="number">1000</span> + S];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–æ€è·¯2</strong></p>
<p>ç”±äºåªä¼šç”¨åˆ°å‰ä¸€çŠ¶æ€çš„dpã€‚å› æ­¤å¯ä»¥ç®€åŒ–ç»´åº¦ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTargetSumWays</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> S)</span> </span>&#123;</div><div class="line">        <span class="comment">// å¦‚æœSè¿‡å¤§ï¼Œå¤§äºæ‰€æœ‰æ•°å­—çš„å’Œï¼Œé‚£å°±gg</span></div><div class="line">        <span class="keyword">int</span> allSum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e : nums) allSum += e;</div><div class="line">        <span class="keyword">if</span>(S &gt; allSum || S &lt; -allSum)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span>[] last = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2001</span>];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–,0ä¸ªæ•°å­—æ—¶</span></div><div class="line">        last[<span class="number">1000</span> + <span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="comment">//dp</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> idx = <span class="number">1</span>; idx &lt;= nums.length; ++idx )&#123;</div><div class="line">            <span class="keyword">int</span>[] curr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2001</span>];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> sum = <span class="number">0</span>; sum &lt;<span class="number">2001</span>; ++sum)&#123;</div><div class="line">                <span class="keyword">if</span>(last[sum] != <span class="number">0</span> &amp;&amp;</div><div class="line">                    sum + nums[idx-<span class="number">1</span>] &lt; <span class="number">2001</span> &amp;&amp;</div><div class="line">                    sum - nums[idx-<span class="number">1</span>] &lt; <span class="number">2001</span>) &#123;</div><div class="line">                    curr[sum + nums[idx-<span class="number">1</span>]] += last[sum];</div><div class="line">                    curr[sum - nums[idx-<span class="number">1</span>]] += last[sum];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            last = curr;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> last[<span class="number">1000</span> + S];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="åŒåºåˆ—åŠ¨æ€è§„åˆ’">5.5. åŒåºåˆ—åŠ¨æ€è§„åˆ’</h2><p>ç»™äº†ä¸¤ä¸ªä¸²ï¼Œç ”ç©¶ä¸¤ä¸ªä¸²ä¹‹é—´çš„å…³ç³»</p>
<p><strong>çŠ¶æ€</strong>ï¼š<code>f[i][j]</code>ä»£è¡¨ç¬¬ä¸€ä¸ªsequenceçš„å‰iä¸ªæ•°å­—/å­—ç¬¦ï¼Œé…ä¸Šç¬¬äºŒä¸ªsequenceçš„å‰jä¸ªâ€¦</p>
<p><strong>æ–¹ç¨‹</strong>ï¼š<code>f[i][j]</code>=ç ”ç©¶ç¬¬iå’Œç¬¬jä¹‹é—´çš„åŒ¹é…å…³ç³»</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼š<code>f[i][0]</code>å’Œ<code>f[0][i]</code></p>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<code>f[n][m]</code></p>
<p>n = s1.length()</p>
<p>m = s2.length()</p>
<h3 id="ä¾‹é¢˜1ï¼ŒLongest-Common-Subsequence">5.5.1. ä¾‹é¢˜1ï¼ŒLongest Common Subsequence</h3><p>æœ€é•¿å…¬å…±å­åºåˆ—</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">å­é—®é¢˜çš„æ¦‚å¿µ</div><div class="line"></div><div class="line">ä¾‹å¦‚åˆšæ‰çš„longest increasing subsequenceé—®é¢˜ï¼Œå…ˆæ±‚leetï¼Œå†æ±‚leetcode</div><div class="line"></div><div class="line">è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è¿™ä¹ˆè€ƒè™‘ï¼š</div><div class="line"></div><div class="line">s1 = abcd</div><div class="line">s2 = acde</div><div class="line"></div><div class="line">ab</div><div class="line">ac</div><div class="line"></div><div class="line">ab</div><div class="line">acd</div><div class="line"></div><div class="line">ab</div><div class="line">acde</div><div class="line"></div><div class="line">abc</div><div class="line">acd</div><div class="line"></div><div class="line">abc</div><div class="line">acde</div><div class="line"></div><div class="line">abcd</div><div class="line">acde</div><div class="line"></div><div class="line">æœ€åè¦æ±‚çš„æ˜¯f[abcd][acde] = ?  --&gt; f[<span class="number">4</span>][<span class="number">4</span>] = ?</div><div class="line">    </div><div class="line">   i</div><div class="line">   â†“</div><div class="line">abcd...</div><div class="line">acde...</div><div class="line">   â†‘</div><div class="line">   j</div><div class="line">   </div><div class="line">æƒ³è¦è®¡ç®—f[i][j] -&gt; å­—ç¬¦ä¸²<span class="number">0</span>~ié…ä¸Šå­—ç¬¦ä¸²<span class="number">0</span>~jçš„LCSæ˜¯å¤šå°‘ï¼Ÿ</div><div class="line"></div><div class="line">å¦‚æœæœ€åä¸€ä¸ªå­—ç¬¦ä¸€æ ·ï¼Œå’Œå¦ä¸€ç§ä¸ä¸€æ ·ï¼Œæ˜¯ä¸¤ç§æƒ…å†µã€‚</div><div class="line"></div><div class="line"><span class="number">1</span>. å¦‚æœä¸ä¸€æ ·ï¼Œå½“ç„¶ä¸èƒ½éƒ½æ‰”äº†ã€‚è€ƒè™‘æ‰”æ‰ä¸€ä¸ªè¯•è¯•ã€‚å³è€ƒè™‘f[i][j-<span class="number">1</span>]æˆ–f[i-<span class="number">1</span>][j]ã€‚å³ï¼š</div><div class="line">  <span class="keyword">if</span> a[i-<span class="number">1</span>]!=b[j-<span class="number">1</span>]</div><div class="line">      f[i][j] = Math.max(</div><div class="line">    	f[i-<span class="number">1</span>][j],<span class="comment">//iä¸åœ¨LCSé‡Œ</span></div><div class="line">    	f[i][j-<span class="number">1</span>],<span class="comment">//jä¸åœ¨LCSé‡Œ</span></div><div class="line">  		f[i-<span class="number">1</span>][j-<span class="number">1</span>])<span class="comment">//éƒ½ä¸åœ¨ (å…¶å®è¿™ä¸ªå·²ç»åŒ…å«åœ¨å‰ä¸¤ä¸ªé‡Œ)</span></div><div class="line"><span class="number">2</span>. å¦‚æœä¸€æ ·ï¼šå°±æŠŠä¸¤ä¸ªéƒ½å»æ‰è¯•è¯•(å…¶å®ä¹Ÿå¯ä»¥å»æ‰ä¸€ä¸ªè¯•è¯•)</div><div class="line">  <span class="keyword">else</span>:</div><div class="line">      f[i][j] = Math.max(</div><div class="line">      	f[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>,<span class="comment">//éƒ½ä¸åœ¨</span></div><div class="line">        f[i][j-<span class="number">1</span>],<span class="comment">//jä¸åœ¨LCSé‡Œ(å…¶å®è¿™ä¸ªå·²ç»åœ¨ç¬¬ä¸€ä¸ªé‡Œäº†ï¼Œè¿™æ˜¯ä¸€ç§è´ªå¿ƒçš„æ€è·¯)</span></div><div class="line">        f[i-<span class="number">1</span>][j]<span class="comment">//iä¸åœ¨LCSé‡Œ(å…¶å®è¿™ä¸ªå·²ç»åœ¨ç¬¬ä¸€ä¸ªé‡Œäº†)</span></div><div class="line">      	)</div><div class="line"><span class="keyword">return</span> f[n][m]</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜2ï¼ŒEdit-Distance">5.5.2. ä¾‹é¢˜2ï¼ŒEdit Distance</h3><p>å°†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æœ€å°‘æ”¹åŠ¨ï¼Œå˜æˆç¬¬äºŒä¸ªå­—ç¬¦ä¸²</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line">s1 = <span class="string">"mart"</span>;</div><div class="line">s2 = <span class="string">"karma"</span>;</div><div class="line"><span class="keyword">return</span> <span class="number">3</span></div><div class="line"></div><div class="line">f[i][j] ï¼š s1çš„å‰iä¸ªå­—ç¬¦é…ä¸Šs2çš„å‰jä¸ªå­—ç¬¦çš„LCSé•¿åº¦</div><div class="line">  </div><div class="line"><span class="keyword">if</span> æœ€åä¸€ä¸ªå­—ç¬¦ä¸ç­‰ï¼š</div><div class="line">	f[i][j] = Math.min(</div><div class="line">      <span class="comment">//ç›´æ¥æŠŠä¸ç­‰çš„è¿™ä¸€ä½æ›¿æ¢ -&gt; å°†s1[i]æ›¿æ¢ä¸ºs2[j]</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt;  mar|a</span></div><div class="line">      <span class="comment">// s2 = karma -&gt; karm|a</span></div><div class="line">      f[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>, <span class="comment">//+1æŒ‡æ›¿æ¢è¿™ä¸ªå­—ç¬¦çš„æ“ä½œ</span></div><div class="line">      </div><div class="line">      <span class="comment">//ç»™s1æ·»åŠ ä¸€ä¸ªs2[j]ï¼Œå¹¶å°†s2é”™ä¸€ä½ -&gt; åœ¨s1çš„iä½ç½®æ’å…¥s2[j]</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt; mart |a</span></div><div class="line">      <span class="comment">// s2 = karma -&gt; karm |a</span></div><div class="line">      f[i][j-<span class="number">1</span>] + <span class="number">1</span> ,</div><div class="line">      </div><div class="line">      <span class="comment">// å°†s1é”™ä¸€ä½  -&gt; åˆ é™¤s1[i]</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt;   mar |t</span></div><div class="line">      <span class="comment">// s2 = karma -&gt; karma</span></div><div class="line">      f[i-<span class="number">1</span>][j] + <span class="number">1</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">      f[i][j] = Math.min(</div><div class="line">      <span class="comment">//å°†ç›¸ç­‰çš„è¿™ä¸€ä½ä¿ç•™</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt;  mar|t</span></div><div class="line">      <span class="comment">// s2 =  kart -&gt;  kar|t</span></div><div class="line">      f[i][j] = f[i-<span class="number">1</span>][j-<span class="number">1</span>],</div><div class="line">        </div><div class="line">      <span class="comment">//å°†ç›¸ç­‰çš„ä¸€ä½æ”¾å¼ƒï¼Œå¹¶åœ¨ä¹‹åæ’å…¥ä¸€ä¸ªä¸ä¹‹ä¸€æ ·çš„(å…¶å®å·²ç»åŒ…å«åœ¨ç¬¬ä¸€ç§)</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt;  martt</span></div><div class="line">      <span class="comment">// s2 =  kart -&gt;   kart</span></div><div class="line">      f[i][j] = f[i][j-<span class="number">1</span>] + <span class="number">1</span>,</div><div class="line">        </div><div class="line">      <span class="comment">//å°†ç›¸ç­‰çš„ä¸€ä½åˆ é™¤(å…¶å®å·²ç»åŒ…å«åœ¨ç¬¬ä¸€ç§)</span></div><div class="line">      <span class="comment">// s1 =  mart -&gt;   mar</span></div><div class="line">      <span class="comment">// s2 =  kart -&gt;  kart</span></div><div class="line">      f[i][j] = f[i-<span class="number">1</span>][j] + <span class="number">1</span></div><div class="line">      )</div><div class="line">      </div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line"></div><div class="line">f[i][<span class="number">0</span>] = <span class="number">0</span>, f[<span class="number">0</span>][j] = <span class="number">0</span></div><div class="line">     </div><div class="line">        </div><div class="line">ç­”æ¡ˆï¼š</div><div class="line">f[n][m]</div><div class="line"></div><div class="line">ä»£ç </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(String word1, String word2)</span> </span>&#123;</div><div class="line">        <span class="keyword">char</span>[] c1 = word1.toCharArray();</div><div class="line">        <span class="keyword">char</span>[] c2 = word2.toCharArray();</div><div class="line">        <span class="keyword">int</span> n1 = c1.length;</div><div class="line">        <span class="keyword">int</span> n2 = c2.length;</div><div class="line">        <span class="comment">//min[i][j] ï¼š s1çš„å‰iä¸ªå­—ç¬¦é…ä¸Šs2çš„å‰jä¸ªå­—ç¬¦çš„æœ€å°‘æ”¹åŠ¨æ¬¡æ•°</span></div><div class="line">        ++n1;</div><div class="line">        ++n2;</div><div class="line">        <span class="keyword">int</span>[][] min = <span class="keyword">new</span> <span class="keyword">int</span>[n1][n2];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        min[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n1 ; ++i )&#123;</div><div class="line">            min[i][<span class="number">0</span>] = i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; n2; ++j )&#123;</div><div class="line">            min[<span class="number">0</span>][j] = j;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//dp</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n1 ; ++i )&#123;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; n2 ; ++j )&#123;</div><div class="line">                min[i][j] = n2;</div><div class="line">                <span class="keyword">if</span>( c1[i-<span class="number">1</span>] == c2[j-<span class="number">1</span>] )&#123;</div><div class="line">                    <span class="comment">//s1 = "...t"</span></div><div class="line">                    <span class="comment">//s2 = "...t"</span></div><div class="line">                    min[i][j] = Math.min( min[i-<span class="number">1</span>][j-<span class="number">1</span>] , <span class="comment">//ç›¸ç­‰</span></div><div class="line">                                Math.min(min[i][j-<span class="number">1</span>] + <span class="number">1</span>, <span class="comment">// åœ¨s1[i]åæ·»åŠ s2[j]</span></div><div class="line">                                         min[i-<span class="number">1</span>][j] + <span class="number">1</span>) );  <span class="comment">// åˆ s1[i]</span></div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="comment">// s1 = "....a"</span></div><div class="line">                    <span class="comment">// s2 = "....b"</span></div><div class="line">                    min[i][j] = Math.min(min[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>, <span class="comment">// ç”¨s2[j]æ›¿æ¢s1[i]</span></div><div class="line">                                Math.min(min[i][j-<span class="number">1</span>] + <span class="number">1</span>,  <span class="comment">// åœ¨s1åæ·»åŠ s[j]</span></div><div class="line">                                         min[i-<span class="number">1</span>][j] + <span class="number">1</span>));   <span class="comment">// åˆ s1[i]</span></div><div class="line"></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> min[n1-<span class="number">1</span>][n2-<span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜3ï¼ŒDistinct-Subsequences">5.5.3. ä¾‹é¢˜3ï¼ŒDistinct Subsequences</h3><p>ä»S=â€rabbbitâ€æŒ‘å‡ºT = â€œrabbitâ€æœ‰å‡ ç§æŒ‘æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">çŠ¶æ€ï¼šf[i][j]</div><div class="line">	Sçš„â€œå‰iâ€ä¸ªå­—ç¬¦ä¸­é€‰å–Tçš„å‰jä¸ªå­—ç¬¦ï¼Œæœ‰å¤šå°‘ç§æ–¹æ¡ˆ</div><div class="line"></div><div class="line">æ–¹ç¨‹ï¼š</div><div class="line"></div><div class="line">æœ€åä¸€ä½ç›¸ç­‰ï¼š</div><div class="line">S = rabb  ---- i</div><div class="line">T =  rab  ---- j</div><div class="line">f[i][j] = æœ‰å‡ ç§æ–¹æ¡ˆ ï¼š</div><div class="line"><span class="number">1</span>. f[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>  <span class="comment">// åŒ¹é…ä¸Šiå’Œj</span></div><div class="line">  S = rab | b</div><div class="line">  T =  ra | b</div><div class="line"><span class="number">2</span>. f[i-<span class="number">1</span>][j]   <span class="comment">//ä¸è¦i</span></div><div class="line">  S = rab | b</div><div class="line">  T = rab</div><div class="line">  </div><div class="line">  </div><div class="line">æœ€åä¸€ä½ä¸ç­‰ï¼š</div><div class="line">S = rabbbi  ---- i</div><div class="line">T = rab     ---- j</div><div class="line">ç›´æ¥æ‰”æ‰Sæœ€åä¸€ä½f[i][j] = f[i-<span class="number">1</span>][j]</div><div class="line"></div><div class="line"></div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line"></div><div class="line">f[i][<span class="number">0</span>] = <span class="number">1</span> <span class="comment">// ç©ºä¸²</span></div><div class="line">f[<span class="number">0</span>][j] = <span class="number">0</span>,j&gt;<span class="number">0</span></div><div class="line"></div><div class="line">ç­”æ¡ˆï¼šf[n][m]</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numDistinct</span><span class="params">(String s, String t)</span> </span>&#123;</div><div class="line">        <span class="keyword">char</span>[] cS = s.toCharArray();</div><div class="line">        <span class="keyword">char</span>[] cT = t.toCharArray();</div><div class="line">        <span class="keyword">int</span> nS = cS.length + <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> nT = cT.length + <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>( nS == <span class="number">1</span> &amp;&amp; nT &gt; <span class="number">1</span> ) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>( nT == <span class="number">1</span> ) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="comment">// num[i][j] Sçš„å‰iä¸ªå­—ç¬¦ï¼Œå’ŒTçš„å‰jä¸ªå­—ç¬¦ï¼ŒTè¢«Sç»„æˆçš„å¯èƒ½çš„æ•°ç›®</span></div><div class="line">        <span class="keyword">int</span>[][] num = <span class="keyword">new</span> <span class="keyword">int</span>[nS][nT];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        num[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; nS; ++i )&#123;</div><div class="line">            num[i][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; nT ; ++j )&#123;</div><div class="line">            num[<span class="number">0</span>][j] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// dp</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; nS ; ++i )&#123;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; nT ; ++j )&#123;</div><div class="line">                <span class="keyword">if</span>( cS[i-<span class="number">1</span>] == cT[j-<span class="number">1</span>] )&#123;</div><div class="line">                    num[i][j] = num[i-<span class="number">1</span>][j-<span class="number">1</span>]+ num[i-<span class="number">1</span>][j]; <span class="comment">// ç›¸ç­‰</span></div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    num[i][j] = num[i-<span class="number">1</span>][j];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num[nS-<span class="number">1</span>][nT-<span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="ä¾‹é¢˜4ï¼ŒInterleaving-String">5.5.4. ä¾‹é¢˜4ï¼ŒInterleaving String</h3><p>å¯è¡Œæ€§é—®é¢˜</p>
<p>ç»™äº†ä¸‰ä¸ªå­—ç¬¦ä¸²s1,s2,s3.åˆ¤æ–­s3æ˜¯å¦æ˜¯ç”±s1å’Œs2äº¤æ›¿ç»„æˆï¼ˆæŒ‰é¡ºåºï¼Œä¸”å¯äº¤æ›¿ç€æŒ‘ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">s1 = <span class="string">"aabcc"</span>,s2 = <span class="string">"dbbca"</span></div><div class="line">s3 = <span class="string">"aadbbcbcac"</span> - &gt; <span class="keyword">true</span></div><div class="line">s3 = <span class="string">"aadbbbaccc"</span> -&gt; <span class="keyword">false</span></div><div class="line">  </div><div class="line">ç›´è§‚æƒ³æ³•</div><div class="line">f[i][j][k] -- s1çš„å‰iä¸ªå’Œs2çš„å‰jä¸ª èƒ½ä¸èƒ½äº¤æ›¿ç»„æˆs3çš„å‰kä¸ª</div><div class="line">k=i+j</div><div class="line"></div><div class="line">å³f[i][j][i+j]  --&gt; f[i][j]</div><div class="line"></div><div class="line">å€’è¿‡æ¥çœ‹</div><div class="line"></div><div class="line">s1 = ab......i</div><div class="line">s2 = db......j</div><div class="line">s3 = aa......k</div><div class="line"></div><div class="line">f[i][j] = </div><div class="line"></div><div class="line">å¦‚æœs1[i]ä¸ç­‰äºs3[i+j]ï¼š</div><div class="line"></div><div class="line"> f[i-<span class="number">1</span>][j] &amp;&amp; s1[i-<span class="number">1</span>] == s3[i+j-<span class="number">1</span>]</div><div class="line"> </div><div class="line">  æˆ–è€…</div><div class="line">  </div><div class="line">å¦‚æœs2[j]ä¸ç­‰äºs3[i+j]:</div><div class="line">  </div><div class="line"> f[i][j-<span class="number">1</span>] &amp;&amp; s2[j-<span class="number">1</span>] == s3[i+j-<span class="number">1</span>]</div><div class="line"> </div><div class="line">å¦åˆ™çš„è¯ï¼Œå°±ä¸è¡Œäº†ï¼</div><div class="line"></div><div class="line"></div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line"></div><div class="line">f[i][<span class="number">0</span>] = ( s[<span class="number">0</span>....i-<span class="number">1</span>] == s3[<span class="number">0</span>...i-<span class="number">1</span>] ) <span class="comment">// å‰iæ®µåªç”¨s1</span></div><div class="line">f[<span class="number">0</span>][j] = ( s2[<span class="number">0</span>...j-<span class="number">1</span>] == s3[<span class="number">0</span>...j-<span class="number">1</span>] ) <span class="comment">// å‰jæ®µåªç”¨s2</span></div><div class="line"></div><div class="line">ç­”æ¡ˆï¼š</div><div class="line"></div><div class="line">f[n][m]</div><div class="line"></div><div class="line">n = s1.size</div><div class="line">m = s2.size</div><div class="line"></div><div class="line">ä»£ç ï¼š</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isInterleave</span><span class="params">(String s1, String s2, String s3)</span> </span>&#123;</div><div class="line">        <span class="keyword">char</span>[] c1 = s1.toCharArray(), c2 = s2.toCharArray(), c3 = s3.toCharArray();</div><div class="line">        <span class="keyword">int</span> n1 = c1.length, n2 = c2.length, n3 = c3.length;</div><div class="line">        <span class="keyword">if</span>( n3 != n1 + n2 ) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        ++n1;++n2;++n3;</div><div class="line">        <span class="comment">//dp[i][j] : c1[0~i]å’Œc2[0~j]èƒ½å¦äº¤æ›¿ç»„æˆc3[i+j]</span></div><div class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n1][n2];</div><div class="line">        <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n1 ; ++i )&#123;</div><div class="line">            dp[i][<span class="number">0</span>] = c1[i-<span class="number">1</span>] == c3[i-<span class="number">1</span>] &amp;&amp; dp[i-<span class="number">1</span>][<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; n2 ; ++j )&#123;</div><div class="line">            dp[<span class="number">0</span>][j] = c2[j-<span class="number">1</span>] == c3[j-<span class="number">1</span>] &amp;&amp; dp[<span class="number">0</span>][j-<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//dp</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n1 ; ++i )&#123;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n2; ++j )&#123;</div><div class="line">                <span class="keyword">if</span>( c1[i-<span class="number">1</span>] == c3[i + j - <span class="number">1</span>] )&#123;</div><div class="line">                    dp[i][j] = dp[i-<span class="number">1</span>][j];</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>( c2[j-<span class="number">1</span>] == c3[i + j - <span class="number">1</span>] )&#123;</div><div class="line">                    dp[i][j] = dp[i][j-<span class="number">1</span>] || dp[i][j];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[n1-<span class="number">1</span>][n2-<span class="number">1</span>];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="Dungeon-Game">5.5.5. Dungeon Game</h3><p>è‹±é›„æ•‘ç¾ï¼šç»™ä¸€ä¸ªçŸ©é˜µ<code>int[][] dungegon</code>ï¼Œæ¯ä¸ªæ ¼å­æ­£æ•°ä»£è¡¨èƒ½é‡åŠ æˆï¼Œè´Ÿæ•°ä»£è¡¨å‡å¼±èƒ½é‡ã€‚è‹±é›„è¦ä»å·¦ä¸Šèµ°åˆ°å³ä¸‹ï¼Œè¦æ±‚æ¯ä¸€æ—¶åˆ»è‹±é›„çš„èƒ½é‡ä¸ä½äº1.é—®è‹±é›„åˆå§‹æ—¶æœ€å°‘éœ€è¦å¤šå°‘èƒ½é‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">go</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span>[] direct, <span class="keyword">int</span>[][] dungeon,<span class="keyword">int</span>[][] init)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> initNow;</div><div class="line">  <span class="keyword">if</span>(dungeon[i][j] &gt; init[i+direct[<span class="number">0</span>]][j+direct[<span class="number">1</span>]])&#123;</div><div class="line">    <span class="comment">// æ­¤å¤„èƒ½é‡åŠ æˆï¼Œè¿›å…¥æ­¤å¤„å‰è‡³å°‘å…·æœ‰1çš„èƒ½é‡</span></div><div class="line">    initNow = <span class="number">1</span>;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// æ­¤å¤„å‡å¼±èƒ½é‡ï¼Œè¿›å…¥æ­¤å¤„å‰å¿…é¡»æ»¡è¶³ä¸‹ä¸€æ­¥çš„èƒ½é‡ï¼Œä¸”è‡³å°‘å…·æœ‰1çš„èƒ½é‡</span></div><div class="line">    initNow = init[i+direct[<span class="number">0</span>]][j+direct[<span class="number">1</span>]] - dungeon[i][j];</div><div class="line">    initNow = Math.max(initNow,<span class="number">1</span>); </div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> initNow;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateMinimumHP</span><span class="params">(<span class="keyword">int</span>[][] dungeon)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(dungeon.length == <span class="number">0</span> || dungeon[<span class="number">0</span>].length == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">int</span> n = dungeon.length;<span class="keyword">int</span> m = dungeon[<span class="number">0</span>].length;</div><div class="line">  <span class="comment">// init[i][j] : è¿›å…¥[i,j]å‰æœ€å°‘éœ€è¦çš„èƒ½é‡</span></div><div class="line">  <span class="keyword">int</span>[][] init = <span class="keyword">new</span> <span class="keyword">int</span>[n][m];</div><div class="line">  <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">  <span class="keyword">if</span>(dungeon[n-<span class="number">1</span>][m-<span class="number">1</span>] &gt; <span class="number">0</span>)&#123;</div><div class="line">    init[n-<span class="number">1</span>][m-<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">  &#125;<span class="keyword">else</span> &#123;</div><div class="line">    init[n-<span class="number">1</span>][m-<span class="number">1</span>] = -dungeon[n-<span class="number">1</span>][m-<span class="number">1</span>] + <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">int</span>[] right = &#123;<span class="number">0</span>,<span class="number">1</span>&#125;;</div><div class="line">  <span class="keyword">int</span>[] down = &#123;<span class="number">1</span>,<span class="number">0</span>&#125;;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span> ; i &gt;= <span class="number">0</span> ; --i)&#123;</div><div class="line">    init[i][m-<span class="number">1</span>] = go(i,m-<span class="number">1</span>,down,dungeon,init);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> j = m - <span class="number">2</span> ; j &gt;= <span class="number">0</span> ; --j)&#123;</div><div class="line">    init[n-<span class="number">1</span>][j] = go(n-<span class="number">1</span>,j,right,dungeon,init);</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// dp</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span> ; i &gt;= <span class="number">0</span> ; --i)&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = m - <span class="number">2</span> ; j &gt;= <span class="number">0</span> ; --j)&#123;</div><div class="line">      <span class="keyword">int</span> rightInit = go(i,j,right,dungeon,init);</div><div class="line">      <span class="keyword">int</span> downInit = go(i,j,down,dungeon,init);</div><div class="line">      init[i][j] = Math.min(rightInit,downInit);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> init[<span class="number">0</span>][<span class="number">0</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Maximum-Length-of-Repeated-Subarray">5.5.6. Maximum Length of Repeated Subarray</h3><p>æ±‚ä¸¤ä¸ªæ•°å­—çš„æœ€å¤§è¿ç»­å­æ•°ç»„é•¿åº¦</p>
<p>æ€è·¯ï¼šåŠ¨æ€è§„åˆ’</p>
<p>ä¸€å¼€å§‹æƒ³å¤šäº†ï¼Œç”¨äº†ä¸€ç§éå¸¸ç»•å¼¯çš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[][] dp;</div><div class="line"><span class="comment">// dp[i][j] :ä»A[i]å’ŒB[j]å¼€å§‹çš„æœ€å¤§å­æ•°ç»„é•¿åº¦</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span>[] B, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(i &gt;= A.length || j &gt;= B.length) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(dp[i][j] &gt; <span class="number">0</span>) <span class="keyword">return</span> dp[i][j];</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(A[i] == B[j])</div><div class="line">        dp[i][j] =  <span class="number">1</span> + helper(A, B, i + <span class="number">1</span>, j + <span class="number">1</span>);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        dp[i][j] = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> dp[i][j];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLength</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span>[] B)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(A.length == <span class="number">0</span> || B.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    dp = <span class="keyword">new</span> <span class="keyword">int</span>[A.length][B.length];</div><div class="line"></div><div class="line">    <span class="keyword">int</span> globalMAX = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.length; ++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; B.length; ++j)&#123;</div><div class="line">            <span class="keyword">if</span>(A[i] == B[j])&#123;</div><div class="line">                globalMAX = Math.max(globalMAX, helper(A, B, i ,j));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> globalMAX;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œæˆ‘å†™çš„å®åœ¨æ˜¯å¤ªç»•äº†ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹æ­£ç¡®çš„DPæ‰“å¼€æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLength</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span>[] B)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(A.length == <span class="number">0</span> || B.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[A.length][B.length];</div><div class="line">        <span class="comment">// dp[i][j]æ˜¯ä»¥A[i]å’ŒB[j]ç»“å°¾çš„æœ€å¤§å­æ•°ç»„é•¿åº¦</span></div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = A[<span class="number">0</span>] == B[<span class="number">0</span>] ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; A.length; ++i)&#123;</div><div class="line">            dp[i][<span class="number">0</span>] = A[i] == B[<span class="number">0</span>] ? <span class="number">1</span> : <span class="number">0</span>; <span class="comment">// åˆå§‹åŒ–è¾¹ç•Œ</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; B.length; ++j)&#123;</div><div class="line">                dp[<span class="number">0</span>][j] = A[<span class="number">0</span>] == B[j] ? <span class="number">1</span> : <span class="number">0</span>;<span class="comment">// åˆå§‹åŒ–è¾¹ç•Œ</span></div><div class="line">                <span class="keyword">if</span> (A[i] == B[j]) &#123;</div><div class="line">                    dp[i][j] = <span class="number">1</span> + dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</div><div class="line">                    max = Math.max(dp[i][j], max);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œè¿™å¹¶ä¸æ˜¯æœ€å¿«çš„ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹éªšæ“ä½œï¼š</p>
<p>å…¶å®å°±æ˜¯æŠŠ<code>dp[][]</code>å‹ç¼©åˆ°äº†ä¸€ç»´ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLength</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span>[] B)</span> </span>&#123;  </div><div class="line">        <span class="comment">//ç»™å®šä¸¤ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºä¸¤è€…å…¬å…±çš„æœ€é•¿å­ä¸²  </span></div><div class="line">        <span class="comment">//è¦æ±‚ï¼šä¸¤ä¸ªå­ä¸²çš„é•¿åº¦å‡å°äº1000ï¼Œå…ƒç´ çš„èŒƒå›´0-99  </span></div><div class="line">          </div><div class="line">        <span class="comment">//å‚è€ƒï¼šåŠ¨æ€è§„åˆ’é—®é¢˜DP,é‡‡ç”¨ä¸€ä¸ªé•¿åº¦ä¸ºm+1çš„ä¸€ç»´æ•°ç»„æ¥è®°å½•å„ä¸ªä½ç½®æœ€é•¿åŒ¹é…çš„é•¿åº¦  </span></div><div class="line">        <span class="keyword">int</span> n=A.length,m=B.length;  </div><div class="line">        <span class="keyword">int</span> [] dp=<span class="keyword">new</span> <span class="keyword">int</span>[m+<span class="number">1</span>];  </div><div class="line">        <span class="keyword">int</span> max=<span class="number">0</span>;  </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;  </div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=m;j&gt;<span class="number">0</span>;j--)&#123;  </div><div class="line">                <span class="keyword">if</span>(A[i-<span class="number">1</span>]==B[j-<span class="number">1</span>])&#123;  </div><div class="line">                    <span class="comment">//å­˜åœ¨ç›¸åŒçš„,æ›´æ–°åŠ¨æ€æ•°ç»„  </span></div><div class="line">                    dp[j]=dp[j-<span class="number">1</span>]+<span class="number">1</span>;  </div><div class="line">                    max=Math.max(max,dp[j]);  </div><div class="line">                &#125;<span class="keyword">else</span>&#123;  </div><div class="line">                    <span class="comment">//ä¸å­˜åœ¨ç›¸åŒï¼Œç½®0  </span></div><div class="line">                    dp[j]=<span class="number">0</span>;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> max;  </div><div class="line">          </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Freedom-Trail">5.6. Freedom Trail</h2><p>ç»™ä¸€ä¸ªç¯å½¢å­—ç¬¦ä¸²<code>ring</code>ï¼Œä»£è¡¨ä¸€ä¸ªè¡¨ç›˜ã€‚å†ç»™ä¸€ä¸ªå­—ç¬¦ä¸²keyã€‚å½“ringçš„åäºŒç‚¹é’Ÿæ–¹å‘ä¸keyçš„æŸä¸ªå­—ç¬¦ä¸€æ ·æ—¶ï¼Œå¯ä»¥æŒ‰ä¸‹buttonï¼Œè¡¨ç¤ºåŒ¹é…äº†è¿™ä¸ªå­—ç¬¦ã€‚åŒ¹é…å®Œäº‹å„¿ä¹‹åå¯ä»¥å°†ringé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆæ—‹è½¬ã€‚å…¶ä¸­å°†æ—‹è½¬ä¸€ä¸ªå­—ç¬¦è®°ä¸€æ¬¡æ“ä½œï¼Œä¸”æŒ‰ä¸‹buttonè®°ä¸€æ¬¡æ“ä½œã€‚æ±‚èƒ½å¤Ÿå°†keyåŒ¹é…å®Œæ¯•æ—¶çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</p>
<p><img src="https://leetcode.com/static/images/problemset/ring.jpg" alt="img"></p>
<p>åˆ†æï¼š</p>
<ol>
<li>æŒ‰ä¸‹buttonçš„æ“ä½œæ¬¡æ•°æ’ç­‰äºkeyçš„é•¿åº¦ã€‚</li>
<li>é¡ºæ—¶é’ˆæ—‹è½¬ä¸é€†æ—¶é’ˆæ—‹è½¬å…·æœ‰ç­‰æ•ˆæ€§ï¼Œå³é¡ºæ—¶é’ˆæ—‹è½¬kæ­¥ï¼Œç­‰äºé€†æ—¶é’ˆæ—‹è½¬ring.length - k æ­¥</li>
</ol>
<p><strong>æ€è·¯ä¸€ï¼Œæš´è§£</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// helper()å‡½æ•°ï¼šè¿”å›ringçš„[ring_idx, ring.lengh + ring_idx] ä¸keyçš„[key_idx, n] åŒ¹é…æ—¶çš„æœ€å°‘æ—‹è½¬æ¬¡æ•°</span></div><div class="line"></div><div class="line"><span class="comment">// å…¶ä¸­ï¼Œring.lengh + ring_idxä»£è¡¨æ—‹è½¬è‡³ring.length,ç„¶åä»å¤´å¼€å§‹çš„æ„æ€</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(String ring, String key, <span class="keyword">int</span> ring_idx, <span class="keyword">int</span> key_idx)</span></span>&#123;</div><div class="line">        </div><div class="line">  <span class="keyword">if</span>(key_idx == key.length())&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">int</span> min_rotated = Integer.MAX_VALUE;<span class="comment">//æœ¬è½®ç»“æœ</span></div><div class="line">  </div><div class="line">  </div><div class="line">  <span class="keyword">for</span>( <span class="keyword">int</span> i = ring_idx; i &lt; ring.length() + ring_idx; ++i)&#123;</div><div class="line">    <span class="keyword">if</span>(ring.charAt(i % ring.length()) == key.charAt(key_idx))&#123;</div><div class="line">      <span class="comment">// å¦‚æœring[i] == key[key_idx]ï¼Œé‚£ä¹ˆé¡ºæ—¶é’ˆçš„æ—‹è½¬æ¬¡æ•°roated_curr å°±æ˜¯ i - ring_idx</span></div><div class="line">      <span class="keyword">int</span> roated_curr = i - ring_idx;</div><div class="line">      <span class="comment">// é€†æ—¶é’ˆçš„æ—‹è½¬æ¬¡æ•° =  ring.length() - roated_curr</span></div><div class="line">      <span class="comment">// ä¸¤ä¸ªå–æœ€å°</span></div><div class="line">      roated_curr = Math.min(roated_curr, ring.length() - roated_curr);</div><div class="line">      <span class="comment">// æŠŠå‰©ä¸‹çš„å·¥ä½œäº¤ç»™helper(i,key_idx + 1)æ¥åš</span></div><div class="line">      <span class="comment">// å¹¶ä»æ‰€æœ‰çš„ié‡ŒæŒ‘ä¸€ä¸ªæ—‹è½¬æ¬¡æ•°æœ€å°çš„ï¼Œä½œä¸ºæœ¬è½®çš„ç»“æœï¼Œå¹¶è¿”å›</span></div><div class="line">      min_rotated = Math.min(min_rotated, roated_curr + helper(ring, key, i% ring.length(), key_idx + <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> min_rotated;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findRotateSteps</span><span class="params">(String ring, String key)</span> </span>&#123; </div><div class="line">  <span class="keyword">return</span> helper(ring, key, <span class="number">0</span>, <span class="number">0</span>) + key.length();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æš´è§£è‚¯å®šæ˜¯è¶…æ—¶çš„ã€‚</p>
<p><strong>æ€è·¯2ï¼Œè®°å¿†åŒ–æœç´¢</strong></p>
<p>åŒä¸€ä¸ª<code>[ring_idx, key_idx]</code> æ˜¯è°ƒç”¨äº†å¤šæ¬¡helper()å‡½æ•°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">int</span>[][] memo;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(String ring, String key, <span class="keyword">int</span> ring_idx, <span class="keyword">int</span> key_idx)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(key_idx == key.length())&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(memo[ring_idx][key_idx] &gt; <span class="number">0</span>) <span class="keyword">return</span> memo[ring_idx][key_idx];</div><div class="line">    <span class="keyword">int</span> roated_curr =<span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> min_rotated = Integer.MAX_VALUE;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> i = ring_idx; i &lt; ring.length() + ring_idx; ++i)&#123;</div><div class="line">        <span class="keyword">if</span>(ring.charAt(i % ring.length()) == key.charAt(key_idx))&#123;</div><div class="line">            roated_curr = i - ring_idx;</div><div class="line">            roated_curr = Math.min(roated_curr, ring.length() - roated_curr);</div><div class="line">            min_rotated = Math.min(min_rotated, roated_curr + helper(ring, key, i% ring.length(), key_idx + <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    memo[ring_idx][key_idx] = min_rotated;</div><div class="line">    <span class="keyword">return</span> min_rotated;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findRotateSteps</span><span class="params">(String ring, String key)</span> </span>&#123;</div><div class="line">    min = Integer.MAX_VALUE;</div><div class="line">    memo = <span class="keyword">new</span> <span class="keyword">int</span>[ring.length()][key.length()];</div><div class="line">    <span class="keyword">return</span> helper(ring, key, <span class="number">0</span>, <span class="number">0</span>) + key.length(); <span class="comment">// æœ€åè®°å¾—åŠ ä¸Špress buttonçš„æ¬¡æ•°</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ€è·¯3ï¼ŒDPé€’æ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">n = ring.length</div><div class="line">m = key.length</div><div class="line"></div><div class="line">çŠ¶æ€ï¼š</div><div class="line"></div><div class="line">memo[i][j] : ringçš„[i,n] ä¸ keyçš„[j,m] åŒ¹é…ä¸Šçš„æœ€å°‘æ—‹è½¬æ¬¡æ•°</div><div class="line"></div><div class="line"></div><div class="line">è½¬ç§»æ–¹ç¨‹ï¼š</div><div class="line"></div><div class="line">memo[i][j] = Math.min(memo[q][j+<span class="number">1</span>] + (iåˆ°qæ‰€éœ€çš„æ—‹è½¬æ¬¡æ•°)) , q = i,i+<span class="number">1</span>,...,n+iï¼Œä¸”ring[q%n] == key[j]  <span class="comment">// è½¬ç§»æ–¹ç¨‹ä¸€å¼€å§‹æé”™äº†ï¼æ°”æ­»äº†</span></div><div class="line"></div><div class="line">åˆå§‹åŒ–ï¼š</div><div class="line">j = m - <span class="number">1</span>æ—¶ï¼Œmemo[i][j] = Math.min(iåˆ°qæ‰€éœ€çš„æ—‹è½¬æ¬¡æ•°) </div><div class="line"></div><div class="line">è¿”å›å€¼ memo[<span class="number">0</span>][<span class="number">0</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findRotateSteps</span><span class="params">(String ring, String key)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = ring.length();</div><div class="line">        <span class="keyword">int</span> m = key.length();</div><div class="line">        <span class="keyword">int</span>[][] memo = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>][m+<span class="number">1</span>];</div><div class="line"></div><div class="line">        <span class="keyword">int</span> min= Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="comment">// dp</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = m - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)&#123;</div><div class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">                min = Integer.MAX_VALUE;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> q = i; q &lt; i + n; ++q) &#123;</div><div class="line">                    <span class="keyword">if</span> (ring.charAt(q % n) != key.charAt(j)) <span class="keyword">continue</span>;</div><div class="line">                    <span class="keyword">int</span> rotate = q - i;</div><div class="line">                    rotate = Math.min(rotate, n - rotate);</div><div class="line">                    <span class="keyword">int</span> min_curr = j &lt; m - <span class="number">1</span> ? memo[q % n][j + <span class="number">1</span>] + rotate : rotate;</div><div class="line">                    <span class="keyword">if</span> (min &gt; min_curr) &#123;min = min_curr;&#125;</div><div class="line">                &#125;</div><div class="line">                memo[i][j] = min;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> memo[<span class="number">0</span>][<span class="number">0</span>] + key.length();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="memoå‹">5.7. memoå‹</h2><h3 id="Shopping-Offers">5.7.1. Shopping Offers</h3><p>ç»™ä¸€äº›å•†å“çš„ä»·æ ¼å’Œéœ€è¦è´­ä¹°çš„å•†å“æ€»æ•°ã€‚æœ‰äº›å•†å“ä¼˜æƒ ç»„åˆå¯ä»¥ä¼˜æƒ è´­ä¹°å¥—è£…ã€‚æ±‚ä»¥æœ€å°‘çš„ä»·æ ¼åˆšå¥½è´­ä¹°æ‰€éœ€çš„å•†å“ã€‚</p>
<p>æ€è·¯ï¼šdfsã€‚</p>
<p>æ³¨æ„çš„ç‚¹ï¼šHashMapè¿˜å¯ä»¥æœ‰List</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">Map&lt;List&lt;Integer&gt;, Integer&gt; memo = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">// æ³¨æ„è¿™ä¸ªç‚¹ </span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(List&lt;Integer&gt; price, List&lt;List&lt;Integer&gt;&gt; special, List&lt;Integer&gt; needs)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(memo.containsKey(needs)) <span class="keyword">return</span> memo.get(needs);</div><div class="line"></div><div class="line">    <span class="comment">// å‡å¦‚ä¸ç”¨offer,ç”¨ç°é‡‘ä¹°äº†å‰©ä¸‹çš„å…¨éƒ¨ï¼ŒèŠ±è´¹ä¸ºbuyAllCost</span></div><div class="line">    <span class="keyword">int</span> buyAllCost = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; needs.size(); ++i)&#123;</div><div class="line">        buyAllCost += needs.get(i) * price.get(i);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//å‡å¦‚ç”¨offerä¹°</span></div><div class="line">    <span class="keyword">int</span> buyOffter = Integer.MAX_VALUE;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(List&lt;Integer&gt; sp : special)&#123;</div><div class="line">        List&lt;Integer&gt; needsCopy = <span class="keyword">new</span> ArrayList&lt;&gt;(needs);</div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; needsCopy.size(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(sp.get(i) &gt; needsCopy.get(i))<span class="keyword">break</span>;</div><div class="line">            needsCopy.set(i,needsCopy.get(i) - sp.get(i));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(i == needsCopy.size()) &#123;</div><div class="line">            buyOffter = Math.min(buyOffter,sp.get(sp.size()-<span class="number">1</span>) + helper(price, special, needsCopy));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    memo.put(needs, Math.min(buyAllCost, buyOffter));</div><div class="line">    <span class="keyword">return</span> Math.min(buyAllCost, buyOffter);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ç›¸å…³Leetcodeé¢˜">6. ç›¸å…³Leetcodeé¢˜</h1><h2 id="Ugly-Number">6.1. Ugly Number</h2><p>ç»™ä¸€ä¸ªæ•°numï¼Œåˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯uglyæ•°â€”â€”å®ƒçš„è´¨å› æ•°åªèƒ½è¯´æ˜¯2ã€3ã€5ã€‚</p>
<p>è¿™é“é¢˜ä¸€å¼€å§‹æƒ³å¤æ‚äº†ï¼Œå±…ç„¶å…ˆåˆ—å‡ºäº†æ‰€æœ‰æ¯”numå°çš„$2^i3^j5^k$çš„æ•°ã€‚ä»¥è‡³äºä»£ç å˜æˆäº†è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span>[] k2;</div><div class="line">    <span class="keyword">int</span>[] k3;</div><div class="line">    <span class="keyword">int</span>[] k5;</div><div class="line">    <span class="keyword">int</span> k2_num;</div><div class="line">    <span class="keyword">int</span> k3_num;</div><div class="line">    <span class="keyword">int</span> k5_num;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] setK(<span class="keyword">int</span> k_num,<span class="keyword">double</span> loge)&#123;</div><div class="line">        <span class="keyword">int</span> size = (<span class="keyword">int</span>)(loge/Math.log(k_num))+<span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>(k_num==<span class="number">2</span>)&#123;</div><div class="line">            k2_num = size;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(k_num==<span class="number">3</span>)&#123;</div><div class="line">            k3_num = size;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(k_num==<span class="number">5</span>)&#123;</div><div class="line">            k5_num = size;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] k = <span class="keyword">new</span> <span class="keyword">int</span>[size];</div><div class="line">        k[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">1</span>; i &lt; k.length ; ++i )&#123;</div><div class="line">            k[i] = k[i-<span class="number">1</span>]*k_num;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> k;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> num)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> i2,i3,i5;</div><div class="line">        <span class="keyword">long</span> re1,re2;</div><div class="line">        <span class="keyword">for</span>( i2 = <span class="number">0</span> ; i2 &lt; k2_num ; ++i2 )&#123;</div><div class="line">            <span class="keyword">for</span>( i3 = <span class="number">0</span> ; i3 &lt; k3_num ; ++i3 )&#123;</div><div class="line">                re1 = k2[i2] * k3[i3];</div><div class="line">                <span class="keyword">if</span>( re1 &gt; num )<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">for</span>( i5 = <span class="number">0</span> ; i5 &lt; k5_num ; ++i5 )&#123;</div><div class="line">                    re2 = re1 * k5[i5];</div><div class="line">                    <span class="keyword">if</span>( re2 &gt; num )<span class="keyword">continue</span>;</div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(re2 == num)&#123;</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUgly</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(num == <span class="number">0</span> )<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">double</span> loge = Math.log(num);</div><div class="line">        k2 = setK(<span class="number">2</span>,loge);</div><div class="line">        k3 = setK(<span class="number">3</span>,loge);</div><div class="line">        k5 = setK(<span class="number">5</span>,loge);</div><div class="line">        <span class="keyword">return</span> dp(num);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼å…¶å®æˆ‘åªéœ€è¦åˆ¤æ–­å®ƒèƒ½ä¸èƒ½è¢«2ã€3ã€5æ•´é™¤ï¼ï¼ï¼ï¼ï¼ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUgly</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (num&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">if</span>(num==<span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>(num%<span class="number">2</span>==<span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> isUgly(num/<span class="number">2</span>);</div><div class="line">        <span class="keyword">if</span>(num%<span class="number">3</span>==<span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> isUgly(num/<span class="number">3</span>);</div><div class="line">        <span class="keyword">if</span>(num%<span class="number">5</span>==<span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> isUgly(num/<span class="number">5</span>);</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> DP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-abstractå’Œinterface]]></title>
      <url>/2017/11/17/Java-abstract%E5%92%8Cinterface/</url>
      <content type="html"><![CDATA[<p> é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹æŠ½è±¡ç±»abstractã€‚å®ƒæ˜¯æ™®é€šç±»ä¸æ¥å£ä¹‹é—´çš„ä¸€ç§ä¸­åº¸ä¹‹é“ã€‚ç„¶åæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹æ¥å£ã€‚</p>
<a id="more"></a>
<h1 id="æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•">1. æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•</h1><p>Demoï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">====================================================================</div><div class="line">ç»§æ‰¿å…³ç³»ï¼š</div><div class="line"><span class="keyword">abstract</span> Instrument</div><div class="line">                â†³	Wind</div><div class="line">====================================================================</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.minview.util.Print.*;</div><div class="line"><span class="comment">/**ä¹å™¨æŠ½è±¡ç±»**/</span></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Instrument</span></span>&#123;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> i ;</div><div class="line">  <span class="comment">// æŠ½è±¡æ–¹æ³•</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(Note n)</span></span>;</div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">what</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">"Instrument"</span>;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**æŸä¸ªä¹å™¨çš„å…·ä½“ç±»**/</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wind</span> <span class="keyword">extends</span> <span class="title">Instrument</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">void</span> play&#123;Note n&#125;&#123;</div><div class="line">    print(<span class="string">"Wind.play()"</span> + n);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">what</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">"Wind"</span>;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>æŠ½è±¡ç±»ä¸èƒ½æœ‰å¯¹è±¡</li>
<li>å¦‚æœä¸€ä¸ªç±»åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œåˆ™è¯¥ç±»å¿…é¡»è¢«é™å®šä¸ºæŠ½è±¡çš„</li>
<li>æŠ½è±¡ç±»çš„å­ç±»å¿…é¡»å®šä¹‰æ‰€æœ‰æŠ½è±¡æ–¹æ³•</li>
</ul>
<h1 id="æ¥å£">2. æ¥å£</h1><p>æ¥å£å¹¶ä¸æ˜¯ä¸€ä¸ªç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªæåº¦æŠ½è±¡çš„ç±»ã€‚è¦è®©ä¸€ä¸ªç±»æˆä¸ºä¸€ä¸ªæ¥å£çš„â€œå­ç±»â€ï¼Œå¿…é¡»ç”¨<code>implements</code>å…³é”®å­—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">====================================================================</div><div class="line">å…³ç³»ï¼š</div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Instrument</span></span></div><div class="line">	<span class="keyword">implements</span> â†³ <span class="title">Wind</span></div><div class="line">		   <span class="keyword">extends</span>  â†³  <span class="title">Woodwind</span>		</div><div class="line">====================================================================</div><div class="line"><span class="comment">/**ä¹å™¨æŠ½è±¡æ¥å£**/</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Instrument</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> i = <span class="number">5</span> ; <span class="comment">// static &amp; final</span></div><div class="line">  <span class="comment">// æ¥å£æ–¹æ³•</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(Note n)</span></span>; <span class="comment">// ä¸å¯ä»¥æœ‰ä»»ä½•å®ç°</span></div><div class="line">&#125;</div><div class="line"><span class="comment">/**æŸä¸ªä¹å™¨çš„å…·ä½“ç±»**/</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wind</span> <span class="keyword">implements</span> <span class="title">Instrument</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">void</span> play&#123;Note n&#125;&#123;</div><div class="line">    print(<span class="string">"Wind.play()"</span> + n);</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">what</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">"Wind"</span>;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**ä¸€ä¸ªæ­£å¸¸çš„ç±»**/</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woodwind</span> <span class="keyword">extends</span> <span class="title">Wind</span></span>&#123;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Queueæ¥å£">3. Queueæ¥å£</h1><p>Javaé›†åˆç±»åº“å°†æ¥å£å’Œå®ç°è¿›è¡Œäº†åˆ†ç¦»ã€‚ä»¥é˜Ÿåˆ—ï¼ˆQueueï¼‰ä¸ºä¾‹ã€‚ä¸€ä¸ªé˜Ÿåˆ—æ¥å£å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt;</span>&#123;</div><div class="line">  <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(E element)</span></span>;</div><div class="line">  <span class="function">E <span class="title">remove</span><span class="params">()</span></span>;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">| <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span> | <span class="number">4</span> |</div><div class="line">  â†‘           â†‘</div><div class="line"> é˜Ÿå¤´        é˜Ÿå°¾</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ¥å£å¹¶æ²¡æœ‰è¯´æ˜é˜Ÿåˆ—æ˜¯å¦‚ä½•å®ç°çš„ã€‚é˜Ÿåˆ—å®ç°æœ‰ä¸¤ç§æ–¹å¼ï¼šå¾ªç¯æ•°ç»„ã€é“¾è¡¨ã€‚</p>
<p>å¾ªç¯æ•°ç»„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CircularArrayQueue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt;</span>&#123;</div><div class="line">  CircularArrayQueue(<span class="keyword">int</span> capacity)&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E element)</span></span>&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">()</span></span>&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;...&#125;</div><div class="line">  <span class="keyword">private</span> E[] elements;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> head;</div><div class="line">  <span class="keyword">private</span> tail;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é“¾è¡¨å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkedListQueue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt;</span>&#123;</div><div class="line">  LinkedListQueue()&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E element)</span></span>&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> E <span class="title">reove</span><span class="params">()</span></span>&#123;...&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;...&#125;</div><div class="line">  </div><div class="line">  <span class="keyword">private</span> Link head;</div><div class="line">  <span class="keyword">private</span> Link tail;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å®Œå…¨è§£è€¦">4. å®Œå…¨è§£è€¦</h1><p>ä¸ºäº†è§£é‡Šæ¥å£çš„è§£è€¦åŠŸèƒ½ï¼Œæˆ‘ä»¬å…ˆå¼•å…¥ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>ç¨‹åºå‘˜ç”²å†™äº†ä¸€ä¸ªNode1ï¼Œå¹¶ä¸”å†™äº†ä¸€ä¸ªä¸¤ä¸ªNode1çš„æ’åºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node1</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> val;</div><div class="line">  <span class="keyword">int</span> count;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Node1 o)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.val - o.val;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Node1[] sort(Node1 a,Node1 b)&#123;</div><div class="line">  <span class="keyword">if</span>( a.CompareTo(b) &gt; <span class="number">0</span> )&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">new</span> Node1[]&#123;a,b&#125;;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Node1[]&#123;b,a&#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">  Node1 a = <span class="keyword">new</span> Node1();<span class="comment">//æ­¤å¤„çœç•¥</span></div><div class="line">  Node1 b = <span class="keyword">new</span> Node1();</div><div class="line">  sort(a,b);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¨‹åºå‘˜ä¹™å†™äº†ä¸€ä¸ªNode2ï¼Œä¹Ÿå†™äº†ä¸€ä¸ªä¸¤ä¸ªNode2çš„æ’åºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node2</span></span>&#123;</div><div class="line">  String key;</div><div class="line">  <span class="keyword">int</span> val;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Node2 o)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.val - o.val;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Node2[] sort(Node2 a,Node2 b)&#123;</div><div class="line">  <span class="keyword">if</span>( a.CompareTo(b) &gt; <span class="number">0</span> )&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">new</span> Node2[]&#123;a,b&#125;;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Node2[]&#123;b,a&#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">  Node2 a = <span class="keyword">new</span> Node2();<span class="comment">//æ­¤å¤„çœç•¥</span></div><div class="line">  Node2 b = <span class="keyword">new</span> Node2();</div><div class="line">  sort(a,b);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ç”±äºNode1å’ŒNode2ä¸æ˜¯ç»§æ‰¿è‡ªåŒä¸€ä¸ªåŸºç±»ï¼Œå› æ­¤ä»£ç ä¸èƒ½é€šç”¨ã€‚æˆ‘ä»¬é€šè¿‡æ¥å£çš„æ–¹å¼æ¥æ”¹è¿›ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Comparable</span></span>&#123;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Object o)</span></span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node1</span> <span class="keyword">implements</span> <span class="title">Compareble</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> val;</div><div class="line">  <span class="keyword">int</span> count;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Node1 o)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.val - o.val;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node2</span> <span class="keyword">implements</span> <span class="title">Comparable</span></span>&#123;</div><div class="line">  String key;</div><div class="line">  <span class="keyword">int</span> val;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Node2 o)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.val - o.val;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨å¤šæ€æä¾›é€šç”¨çš„sortæ–¹æ³•ï¼ˆè¿™ä¸ªä¸œè¥¿ç±»ä¼¼äºArray.sort()ï¼‰</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Compareble[] sort(Comparable a,Comparable b)&#123;</div><div class="line">  <span class="keyword">return</span> a.CompareTo(b);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">  <span class="comment">//Node1</span></div><div class="line">  Node1 a = <span class="keyword">new</span> Node1();</div><div class="line">  Node1 b = <span class="keyword">new</span> Node1();</div><div class="line">  sort(a,b);</div><div class="line">  </div><div class="line">  <span class="comment">//Node2</span></div><div class="line">  Node2 c = <span class="keyword">new</span> Node2();</div><div class="line">  Node2 d = <span class="keyword">new</span> Node2();</div><div class="line">  sort(c,d);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸€æ¥ï¼Œåªè¦ç»§æ‰¿è‡ªComparableæ¥å£çš„ç±»ï¼Œéƒ½å¯ä»¥ä½¿ç”¨sort()æ–¹æ³•äº†ï¼</p>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-String]]></title>
      <url>/2017/11/16/Java-String/</url>
      <content type="html"><![CDATA[<p> é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€äº›Stringçš„ç‰¹æ€§ã€‚</p>
<ul>
<li>Stringå¯¹è±¡ä¸å¯å˜ï¼</li>
<li>åœ¨å‡½æ•°çš„å‚æ•°ä¼ é€’ä¸­ï¼ŒStringä¼ è¿›å»æ—¶æ˜¯ä¸€ç§æ‹·è´</li>
<li>Stringä¹‹é—´ç”¨+å·éå¸¸ä¸å¥½ï¼ï¼ˆ+å·å†…éƒ¨ç”¨çš„æ˜¯StringBuilderï¼‰</li>
</ul>
<a id="more"></a>
<h1 id="StringBuilder">1. StringBuilder</h1><p>å¦‚æœæƒ³å®ç°å°†String[] wordsè¿æ¥æˆä¸€ä¸ªStringï¼Œé‚£æœ€åœŸçš„æ–¹æ³•å°±æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String result = <span class="string">""</span>;</div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; words.length ; ++i )&#123;</div><div class="line">  result += words[i];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†ç”±äºæ¯ä¸ª+éƒ½è°ƒç”¨äº†ä¸€æ¬¡StringBuilderï¼Œè¿™æ— ç–‘å¢åŠ äº†å¾ˆå¤šè´Ÿæ‹…ã€‚è¾ƒå¥½çš„æ–¹å¼æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; words.length ; ++i )&#123;</div><div class="line">  stringBuilder.append(words[i]);</div><div class="line">&#125;</div><div class="line">String result = stringBuilder.toString();</div></pre></td></tr></table></figure>
<h1 id="éå†Stringçš„å…ƒç´ ">2. éå†Stringçš„å…ƒç´ </h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String a = <span class="string">"abc"</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">char</span> c : a.toCharArray())&#123;</div><div class="line">  <span class="comment">//c</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ä¸€äº›æ“ä½œ">3. ä¸€äº›æ“ä½œ</h1><h2 id="B-indexOf">3.1. B.indexOf(...)</h2><p><code>B.indexOf(A)</code> : ä»Bçš„å¤´çœ‹æ˜¯æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨A</p>
<p><code>B.indexOf(A, idx)</code> : ä»Bçš„ç¬¬idxä¸ªå­—ç¬¦å¼€å§‹æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨A</p>
<h2 id="B-startWith-A">3.2. B.startWith(A)</h2><p>åˆ¤æ–­Bæ˜¯å¦ä»¥Aå¼€å¤´</p>
<h2 id="B-contains-A">3.3. B.contains(A)</h2><p>Aæ˜¯å¦æ˜¯Bçš„å­ä¸²</p>
<h2 id="B-trim">3.4. B.trim()</h2><p>trim()æ–¹æ³•è¿”å›è°ƒç”¨å­—ç¬¦ä¸²å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œä½†æ˜¯æ‰€æœ‰èµ·å§‹å’Œç»“å°¾çš„ç©ºæ ¼éƒ½è¢«åˆ é™¤äº†</p>
<h1 id="ç›¸å…³é¢˜">4. ç›¸å…³é¢˜</h1><h2 id="Valid-Palindrome">4.1. Valid Palindrome</h2><p>åˆ¤æ–­ç»™å®šå­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æˆ–æ•°å­—ï¼Œå­—æ¯ä¸åˆ†å¤§å°å†™ï¼‰æ˜¯å¦æ˜¯å›æ–‡ï¼ˆå­—ç¬¦ä¸²ä¸­åŒ…å«çš„å…¶å®ƒå­—ç¬¦å¯ä»¥è·³è¿‡ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">ifAlpha</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> !((c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'z'</span>) || (c - <span class="string">'0'</span> &gt;= <span class="number">0</span> &amp;&amp; c - <span class="string">'0'</span> &lt; <span class="number">10</span>));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(String s, <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">boolean</span> deleted)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">        <span class="keyword">if</span>(ifAlpha(s.charAt(low)))&#123;</div><div class="line">            ++low;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(ifAlpha(s.charAt(high)))&#123;</div><div class="line">            --high;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(s.charAt(low) == s.charAt(high))&#123;</div><div class="line">            ++low;</div><div class="line">            --high;</div><div class="line">        &#125; <span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.length() &lt;= <span class="number">1</span>)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">return</span> helper(s.toLowerCase(), <span class="number">0</span>, s.length() - <span class="number">1</span>,<span class="keyword">false</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Valid-Palindrome-II">4.2. Valid Palindrome II</h2><p>åˆ¤æ–­ç»™å®šå­—ç¬¦ä¸²ï¼ˆåªæœ‰å­—æ¯ï¼‰è‡³å¤šå»æ‰ä¸€ä¸ªåï¼Œæ˜¯å¦æ˜¯å›æ–‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(String s, <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">boolean</span> deleted)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(high &gt;= s.length()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">        <span class="keyword">if</span>(s.charAt(low) == s.charAt(high))&#123;</div><div class="line">            ++low;</div><div class="line">            --high;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!deleted)&#123;</div><div class="line">            <span class="keyword">return</span> helper(s, low + <span class="number">1</span>, high, <span class="keyword">true</span>)||</div><div class="line">                    helper(s, low, high - <span class="number">1</span>, <span class="keyword">true</span>);</div><div class="line">        &#125;<span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validPalindrome</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.length() &lt;= <span class="number">2</span>)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">return</span> helper(s, <span class="number">0</span>, s.length() - <span class="number">1</span>,<span class="keyword">false</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Shortest-Palindrome">4.3. Shortest Palindrome</h2><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœåœ¨å‰é¢åŠ ä¸€äº›å­—ç¬¦ï¼Œä½¿å®ƒå˜æˆå›æ–‡ä¸²ã€‚æ±‚æœ€çŸ­çš„å›æ–‡ä¸²</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">æš´åŠ›</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(String left, String right)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> l = left.length() - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> r = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (l &gt;= <span class="number">0</span> &amp;&amp; left.charAt(l) == right.charAt(r))&#123;</div><div class="line">            l--;</div><div class="line">            r++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> l == -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">shortestPalindrome</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = s.length() / <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i)&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="number">2</span>*i + <span class="number">2</span> &lt;= s.length() &amp;&amp; s.charAt(i) == s.charAt( i + <span class="number">1</span>))&#123;</div><div class="line">                <span class="comment">// [0,i],[i+1,2*i + 1]</span></div><div class="line">                <span class="comment">// String left = s.substring(0, i + 1);</span></div><div class="line">                <span class="comment">// String right = s.substring(i + 1, 2*i + 2);</span></div><div class="line">                <span class="keyword">if</span>(helper(s.substring(<span class="number">0</span>, i + <span class="number">1</span>), s.substring(i + <span class="number">1</span>, <span class="number">2</span>*i + <span class="number">2</span>)))&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder(s.substring(<span class="number">2</span>*i + <span class="number">2</span>, s.length())).reverse().toString() + s;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i &gt; <span class="number">0</span> &amp;&amp; <span class="number">2</span>*i + <span class="number">1</span> &lt;= s.length() &amp;&amp; s.charAt(i-<span class="number">1</span>) == s.charAt(i+<span class="number">1</span>))&#123;</div><div class="line">                <span class="comment">//[0,i-1],[i],[i+1,2*i]</span></div><div class="line">                <span class="comment">// String left = s.substring(0,i);</span></div><div class="line">                <span class="comment">// String right = s.substring(i + 1,2*i + 1);</span></div><div class="line">                <span class="keyword">if</span>(helper(s.substring(<span class="number">0</span>,i), s.substring(i + <span class="number">1</span>,<span class="number">2</span>*i + <span class="number">1</span>)))&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder(s.substring(<span class="number">2</span>*i + <span class="number">1</span>, s.length())).reverse().toString() + s;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder(s.substring(<span class="number">1</span>, s.length())).reverse().toString() + s;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Largest-Palindrome-Product">4.4. Largest Palindrome Product</h2><p>ç»™ä¸€ä¸ªnï¼Œåˆ¤æ–­ä¸¤ä¸ªnä½æ•°çš„ä¹˜ç§¯æœ€å¤§çš„å›æ–‡æ•°ï¼Œè¾“å‡ºå›æ–‡æ•°mod 1337ã€‚</p>
<p>å¯¹æˆ‘æ¥è¯´è¿™å¹¶ä¸ä¸€é“easyçš„é¢˜ã€‚æˆ‘è‡ªå·±å†™äº†ç¨‹åºï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸å¯¹ï¼è¿˜è¶…æ—¶ï¼æ°”ç‚¸äº†ï¼</p>
<p>å…ˆè´´ä¸Šæˆ‘çš„<strong>é”™è¯¯çš„</strong> ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">ifPalindrome</span><span class="params">(String s, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(low &gt;= high) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">return</span> s.charAt(low) == s.charAt(high) &amp;&amp; ifPalindrome(s, low + <span class="number">1</span>, high - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">largestPalindrome</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = (<span class="keyword">int</span>)Math.pow(<span class="number">10</span>,n) - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> min = (<span class="keyword">int</span>)Math.pow(<span class="number">10</span>, n - <span class="number">1</span>);</div><div class="line">        <span class="keyword">int</span> n1 = max,n2 = max;</div><div class="line">        <span class="keyword">while</span> (n1 &gt;= min)&#123;</div><div class="line">            n2 = n1;</div><div class="line">            <span class="keyword">while</span> (n2 &gt;= min)&#123;</div><div class="line">                BigInteger bigInteger = BigInteger.valueOf(n1).multiply(BigInteger.valueOf(n2));</div><div class="line">                <span class="keyword">if</span>(ifPalindrome(bigInteger.toString(),<span class="number">0</span>, bigInteger.toString().length() - <span class="number">1</span>))</div><div class="line">                    <span class="keyword">return</span> bigInteger.mod(BigInteger.valueOf(<span class="number">1337</span>)).intValue();</div><div class="line">                --n2;</div><div class="line">            &#125;</div><div class="line">            --n1;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹</p>
<p><strong>æ­£ç¡®çš„æ€è·¯</strong>ï¼š</p>
<p>å®šç†ï¼šè¾“å…¥èŒƒå›´<code>nâˆˆ[1, 8]</code>ï¼Œé™¤<code>n = 1</code>ä»¥å¤–ï¼Œå…¶ä½™nå€¼æœ€å¤§å›æ–‡æ•°palindromeçš„ä½æ•°å‡ä¸ºå¶æ•°ä¸ªï¼Œå¯ä»¥æ‹†åˆ†ä¸º<code>half</code>ä¸<code>reversed(half)</code>å·¦å³ä¸¤åŠ</p>
<p>æ€è·¯ï¼šä»ä¸Šç•Œ<code>high = pow(10, n) - 1</code>å‘ä¸‹ç•Œ<code>low = pow(10, n - 1)</code>æšä¸¾halfï¼Œæ„é€ å›æ–‡ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªnä½æ•°çš„é™¤æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">largestPalindrome</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">9</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> high = (<span class="keyword">int</span>) Math.pow(<span class="number">10</span>, n) - <span class="number">1</span>, low = high / <span class="number">10</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = high; i &gt; low; i--) &#123;</div><div class="line">            <span class="keyword">long</span> palindrome = createPalindrome(i);</div><div class="line">            <span class="comment">// æ¢æµ‹palindromeæ˜¯å¦å¯ä»¥è¢«æ•´é™¤ï¼Œä¸”é™¤æ•°å’Œç»“æœéƒ½åœ¨(low,high]ä¹‹é—´</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">long</span> j = high; j &gt; low; j--) &#123;</div><div class="line">                <span class="keyword">if</span> (palindrome / j &gt; high)  <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">if</span> (palindrome % j == <span class="number">0</span>) <span class="keyword">return</span> (<span class="keyword">int</span>) (palindrome % <span class="number">1337</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">createPalindrome</span><span class="params">(<span class="keyword">long</span> num)</span></span>&#123;</div><div class="line">        <span class="comment">// æ„é€  num + mun çš„å­—ç¬¦ä¸²</span></div><div class="line">        String str = num + <span class="keyword">new</span> StringBuilder(Long.toString(num)).reverse().toString();</div><div class="line">        <span class="keyword">return</span> Long.parseLong(str);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼˜åŒ–</strong></p>
<p>å½“ç„¶äº†ï¼Œä»¥ä¸Šæ“ä½œè¿˜å¯ä»¥ä¼˜åŒ–ï¼</p>
<p>å°±æ˜¯åœ¨æ¢ç´¢æ—¶ï¼Œåªéœ€è¦æ¢ç´¢ä¸€åŠå•Šæˆ‘æ›¹ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">long</span> j = high; j &gt; low; j--) è¿™é‡Œï¼</div><div class="line"></div><div class="line">æ”¹æˆï¼</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">long</span> j = high; j*j &gt; palindrome; j--)</div></pre></td></tr></table></figure>
<p>é€Ÿåº¦æå‡äº†äºŒå€å•Šï¼</p>
<p><strong>éªšæ“ä½œ</strong></p>
<p>å½“ç„¶äº†ï¼Œè¿™äº›éƒ½æ²¡å•¥ã€‚ä¸‹é¢è¿™ä¸ªéªšæ“ä½œï¼Œèƒ½æŠŠäººæ°”æ­»ã€‚å‘µå‘µå“’</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">largestPalindrome</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span>(n)&#123;</div><div class="line">            <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">9</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">987</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">123</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">597</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">5</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">677</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">6</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">1218</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">7</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">877</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">8</span>:</div><div class="line">                <span class="keyword">return</span> <span class="number">475</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="String-to-Integer-atoi">4.5. String to Integer (atoi)</h2><p>è¿™é“é¢˜é¢˜æ„å®åœ¨æ˜¯å¤ªä¸æ˜æœ—äº†ï¼</p>
<p>å¤§åŸåˆ™ï¼šå°†strè½¬åŒ–ä¸ºint</p>
<p>å°åŸåˆ™ï¼š</p>
<ol>
<li>å¿½ç•¥å¼€å§‹çš„ç©ºæ ¼</li>
<li>å¯èƒ½æœ‰æ­£è´Ÿå·</li>
<li>å¦‚æœå‡ºç°äº†ä¸€ä¸ªå¼‚å¸¸å­—ç¬¦ï¼Œå°±ä¸¢å¼ƒè¿™ä¸ªå¼‚å¸¸å­—ç¬¦åŠå…¶ä¹‹åçš„ä¸œè¥¿</li>
<li>å¦‚æœæ²¡æœ‰è§£ï¼Œå°±è¿”å›0</li>
<li>å¦‚æœæ­£æ•°æº¢å‡ºï¼Œå°±è¿”å›æ­£æ•´æ•°<code>INT_MAX (2147483647)</code> ï¼›å¦‚æœè´Ÿæ•°æº¢å‡ºï¼Œå°±è¿”å›è´Ÿæ•´æ•°<code>INT_MIN (-2147483648)</code></li>
</ol>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">    <span class="comment">// ä¸¢å¼ƒç©ºç™½</span></div><div class="line">    <span class="keyword">int</span> start = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (start &lt; str.length() &amp;&amp; str.charAt(start) == <span class="string">' '</span>) ++start;</div><div class="line">    <span class="keyword">if</span>(start &gt;= str.length()) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="comment">// åˆ¤æ–­ç¬¦å·</span></div><div class="line">    <span class="keyword">int</span> sig = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(str.charAt(start) == <span class="string">'+'</span>)&#123;++start;sig = <span class="number">1</span>;&#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(str.charAt(start) == <span class="string">'-'</span>)&#123;++start; sig = -<span class="number">1</span>;&#125;</div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="comment">// å¼€å§‹å­—ç¬¦</span></div><div class="line">    <span class="keyword">while</span> (start &lt; str.length())&#123;</div><div class="line">        <span class="keyword">int</span> num = str.charAt(start) - <span class="string">'0'</span>;</div><div class="line">        <span class="keyword">if</span>(num &gt;= <span class="number">0</span> &amp;&amp; num &lt; <span class="number">10</span>)&#123;</div><div class="line">            sb.append(str.charAt(start));</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        ++start;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è§£ï¼Œå°±è¿”å›0</span></div><div class="line">    <span class="keyword">if</span>(sb.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="comment">// å¦‚æœæº¢å‡ºï¼Œå°±...</span></div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">return</span> sig * Integer.valueOf(sb.toString());</div><div class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</div><div class="line">        <span class="keyword">if</span>(sig &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2147483647</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">2147483648</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Roman-to-Integer">4.6. Roman to Integer</h2><p>å°†ç½—é©¬æ•°å­—è½¬åŒ–ä¸ºæ•´æ•°</p>
<p>ç½—é©¬æ•°å­—çš„è§„åˆ™ï¼š</p>
<ol>
<li>ç½—é©¬æ•°å­—å…±æœ‰7ä¸ªï¼Œå³â… ï¼ˆ1ï¼‰ã€â…¤ï¼ˆ5ï¼‰ã€â…©ï¼ˆ10ï¼‰ã€â…¬ï¼ˆ50ï¼‰ã€â…­ï¼ˆ100ï¼‰ã€â…®ï¼ˆ500ï¼‰å’Œâ…¯ï¼ˆ1000ï¼‰</li>
<li>é‡å¤æ•°æ¬¡ï¼šä¸€ä¸ªç½—é©¬æ•°å­—é‡å¤å‡ æ¬¡ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªæ•°çš„å‡ å€</li>
<li>å³åŠ å·¦å‡ï¼š<ol>
<li>åœ¨è¾ƒå¤§çš„ç½—é©¬æ•°å­—çš„å³è¾¹è®°ä¸Šè¾ƒå°çš„ç½—é©¬æ•°å­—ï¼Œè¡¨ç¤ºå¤§æ•°å­—åŠ å°æ•°å­—ã€‚</li>
<li>åœ¨è¾ƒå¤§çš„ç½—é©¬æ•°å­—çš„å·¦è¾¹ï¼ˆåªèƒ½æœ‰ä¸€ä½ï¼‰è®°ä¸Šè¾ƒå°çš„ç½—é©¬æ•°å­—ï¼Œè¡¨ç¤ºå¤§æ•°å­—å‡å°æ•°å­—ã€‚</li>
</ol>
</li>
</ol>
<p>æ€è·¯ï¼šè¾“å…¥ä¸€ä¸ªæ•°åï¼Œæˆ‘ä»¬å¯ä»¥æ¥éå†è¿™ä¸ªæ•°ï¼Œç”¨sumæ¥æ€»è®¡å’Œï¼Œæ¯”è¾ƒiå’Œi+1ï¼Œå¦‚æœï¼Œi+1æ¯”iå°çš„è¯ï¼Œç›´æ¥ç›¸åŠ ï¼Œå¦‚æœiå¤§äºi+1çš„è¯ï¼Œåˆ™å°†æ€»å’Œsumå‡å»iè¿™ä¸ªåœ°æ–¹æ•°çš„ä¸¤å€ï¼ŒåŒæ—¶åŠ ä¸Ši+1<br>å°±ç›¸å½“äºåè¾¹çš„æ•°æ¯”å·¦è¾¹çš„æ•°å¤§ï¼Œåˆ™ç”¨å³è¾¹çš„æ•°å‡å·¦è¾¹çš„æ•°ã€‚ä½†å› ä¸ºä¹‹å‰å·²ç»åŠ è¿‡ä¸€æ¬¡äº†ï¼Œæ‰€ä»¥å‡ä¸¤æ¬¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç½—é©¬æ•°å­—å…±æœ‰7ä¸ªï¼Œå³â… ï¼ˆ1ï¼‰ã€â…¤ï¼ˆ5ï¼‰ã€â…©ï¼ˆ10ï¼‰ã€â…¬ï¼ˆ50ï¼‰ã€</span></div><div class="line">    <span class="comment">// â…­ï¼ˆ100ï¼‰ã€â…®ï¼ˆ500ï¼‰å’Œâ…¯ï¼ˆ1000ï¼‰</span></div><div class="line">    <span class="keyword">int</span>[] nums = &#123;<span class="number">1000</span>,<span class="number">500</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">1</span>&#125;;</div><div class="line">    <span class="keyword">char</span>[] chars = &#123;<span class="string">'M'</span>,<span class="string">'D'</span>,<span class="string">'C'</span>,<span class="string">'L'</span>,<span class="string">'X'</span>,<span class="string">'V'</span>,<span class="string">'I'</span>&#125;;</div><div class="line">    HashMap&lt;Character, Integer&gt; roman = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">romanToInt</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; ++i)&#123;</div><div class="line">            roman.put(chars[i], nums[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> sum = roman.get(s.charAt(<span class="number">0</span>));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            sum += roman.get(s.charAt(i));</div><div class="line">            <span class="keyword">if</span>(roman.get(s.charAt(i)) &gt; roman.get(s.charAt(i-<span class="number">1</span>)))&#123;</div><div class="line">                sum -= <span class="number">2</span>*roman.get(s.charAt(i-<span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Integer-to-Roman">4.7. Integer to Roman</h2><p>å°†æ•´æ•°è½¬åŒ–ä¸ºç½—é©¬æ•°å­—</p>
<p>ç½—é©¬æ•°å­—è§„å¾‹ï¼š</p>
<ul>
<li>å¤§éƒ¨åˆ†æ—¶å€™ç”¨å­—ç¬¦ç›¸å åŠ æ¥è¡¨ç¤ºæ•°å­—ã€‚Iæ˜¯1ï¼Œ IIæ˜¯2ï¼Œ IIIæ˜¯3ã€‚VIæ˜¯6ï¼ˆæŒ¨ä¸ªçœ‹æ¥ï¼Œæ˜¯â€œ5 å’Œ 1â€çš„ç»„åˆï¼‰ï¼ŒVIIæ˜¯7ï¼ŒVIIIæ˜¯8ã€‚</li>
<li>å«æœ‰10çš„å­—ç¬¦ï¼ˆIï¼ŒXï¼ŒCå’ŒMï¼‰æœ€å¤šå¯ä»¥é‡å¤å‡ºç°ä¸‰ä¸ªã€‚ä¸ºäº†è¡¨ç¤º4ï¼Œå¿…é¡»ç”¨åŒä¸€ä½æ•°çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—5æ¥å‡å»ä¸€ã€‚ä¸èƒ½ç”¨IIIIæ¥è¡¨ç¤º4ï¼Œè€Œåº”è¯¥æ˜¯IVï¼ˆæ„æ€æ˜¯æ¯”5å°1ï¼‰ã€‚40å†™åšXLï¼ˆæ¯”50å°10ï¼‰ï¼Œ41å†™åšXLIï¼Œ42å†™åšXLIIï¼Œ43å†™åšXLIIIï¼Œ44å†™åšXLIVï¼ˆæ¯”50å°10å¹¶ä¸”æ¯”5å°1ï¼‰ã€‚</li>
<li>æœ‰äº›æ—¶å€™è¡¨ç¤ºæ–¹æ³•æ°æ°ç›¸åã€‚ä¸ºäº†è¡¨ç¤ºä¸€ä¸ªä¸­é—´çš„æ•°å­—ï¼Œéœ€è¦ä»ä¸€ä¸ªæœ€ç»ˆçš„å€¼æ¥å‡ã€‚æ¯”å¦‚ï¼š9éœ€è¦ä»10æ¥å‡ï¼š8æ˜¯VIIIï¼Œä½†9ç¡®æ˜¯IXï¼ˆæ¯”10å°1ï¼‰ï¼Œå¹¶ä¸æ˜¯VIIIï¼ˆIå­—ç¬¦ä¸èƒ½é‡å¤4æ¬¡ï¼‰ã€‚90æ˜¯XCï¼Œ900æ˜¯CMã€‚</li>
<li>è¡¨ç¤º5çš„å­—ç¬¦ä¸èƒ½åœ¨ä¸€ä¸ªæ•°å­—ä¸­é‡å¤å‡ºç°ã€‚10åªèƒ½ç”¨Xè¡¨ç¤ºï¼Œä¸èƒ½ç”¨VVè¡¨ç¤ºã€‚100åªèƒ½ç”¨Cè¡¨ç¤ºï¼Œè€Œä¸æ˜¯LLã€‚</li>
<li>ç½—é©¬æ•°å­—æ˜¯ä»å·¦åˆ°å³æ¥è®¡ç®—ï¼Œå› æ­¤å­—ç¬¦çš„é¡ºåºéå¸¸é‡è¦ã€‚DCè¡¨ç¤º600ï¼Œè€ŒCDå®Œå…¨æ˜¯å¦ä¸€ä¸ªæ•°å­—400ï¼ˆæ¯”500å°100ï¼‰ã€‚CIæ˜¯101ï¼ŒICä¸æ˜¯ä¸€ä¸ªç½—é©¬æ•°å­—ï¼ˆå› ä¸ºä½ ä¸èƒ½ä»100å‡1ï¼Œä½ åªèƒ½å†™æˆXCIXï¼Œè¡¨ç¤ºæ¯”100å°10ï¼Œä¸”æ¯”10å°1ï¼‰ã€‚</li>
</ul>
<p>æœ‰äº†ä»¥ä¸Šè§„åˆ™ï¼ŒæŒ‰ç…§è§„åˆ™æŒ¨ä¸ªä½ç½®è®¡ç®—å°±å¥½å•¦</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">intToRoman</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[][] roman = &#123;</div><div class="line">            &#123;<span class="string">'M'</span>,<span class="string">'D'</span>,<span class="string">'C'</span>&#125;,</div><div class="line">            &#123;<span class="string">'C'</span>,<span class="string">'L'</span>,<span class="string">'X'</span>&#125;,</div><div class="line">            &#123;<span class="string">'X'</span>,<span class="string">'V'</span>,<span class="string">'I'</span>&#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="comment">//åƒåˆ†ä½</span></div><div class="line">    <span class="keyword">int</span> digit = num/<span class="number">1000</span>;</div><div class="line">    num -= digit*<span class="number">1000</span>;</div><div class="line">    <span class="keyword">while</span> (digit &gt; <span class="number">0</span>)&#123;</div><div class="line">        sb.append(<span class="string">'M'</span>);</div><div class="line">        --digit;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int</span>[] divisor = &#123;<span class="number">100</span>,<span class="number">10</span>,<span class="number">1</span>&#125;;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</div><div class="line">        <span class="comment">// 500/100åˆ†ä½</span></div><div class="line">        digit = num / divisor[i];</div><div class="line">        num -= digit * divisor[i];</div><div class="line">        <span class="comment">// 900 -&gt; digit = 9 -&gt; CM</span></div><div class="line">        <span class="keyword">if</span> (digit == <span class="number">9</span>) &#123;</div><div class="line">            <span class="comment">//sb.append("CM");</span></div><div class="line">            sb.append(roman[i][<span class="number">2</span>]);</div><div class="line">            sb.append(roman[i][<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 700 -&gt; digit = 7 -&gt; DCC</span></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (digit &gt;= <span class="number">5</span>) &#123;</div><div class="line">            <span class="comment">//sb.append("D");</span></div><div class="line">            sb.append(roman[i][<span class="number">1</span>]);</div><div class="line">            digit--;</div><div class="line">            <span class="keyword">while</span> (digit &gt;= <span class="number">5</span>) &#123;</div><div class="line">                <span class="comment">//sb.append("C");</span></div><div class="line">                sb.append(roman[i][<span class="number">2</span>]);</div><div class="line">                digit--;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 400 -&gt; digit = 4 -&gt; CD</span></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (digit == <span class="number">4</span>) &#123;</div><div class="line">            <span class="comment">//sb.append("CD");</span></div><div class="line">            sb.append(roman[i][<span class="number">2</span>]);</div><div class="line">            sb.append(roman[i][<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 300 -&gt; digit = 3 -&gt; CCC</span></div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">while</span> (digit &gt; <span class="number">0</span>) &#123;</div><div class="line">                <span class="comment">//sb.append("C");</span></div><div class="line">                sb.append(roman[i][<span class="number">2</span>]);</div><div class="line">                digit--;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Integer-to-English-Words">4.8. Integer to English Words</h2><p>å°†æ•°å­—è½¬åŒ–ä¸ºè‹±æ–‡è¯»éŸ³</p>
<p>è¯»éŸ³è§„åˆ™ï¼š</p>
<ol>
<li>ä¸‰ä½ä¸€ä½“ï¼Œæ¯ä¸‰ä½éƒ½æ˜¯åŒä¸€ä¸ªè¯»æ³•ï¼Œåªæ˜¯åœ¨åé¢åŠ thunsand/Million/Billionå³å¯ã€‚ä¾‹å¦‚123,456,789å¯ä»¥åˆ†è§£ä¸ºï¼š123 million, 456 thunsand, 789</li>
<li>ä¸‰ä½æ•°å­—è¯»æ³•ï¼šç™¾ä½ç›´æ¥å°±æ˜¯æ•°å­— + thunsandï¼› åä½å’Œä¸ªä½æ¯”è¾ƒéº»çƒ¦ã€‚20ä»¥ä¸‹çš„æ•°å­—ç›´æ¥è¯»ï¼Œ20ä»¥ä¸Šçš„æ•°å­—ç”¨ å‡ å + å‡ çš„æ–¹æ³•</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(num == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"Zero"</span>;</div><div class="line">        String[] splitWords = &#123;<span class="string">""</span>,<span class="string">"Thousand"</span>,<span class="string">"Million"</span>,<span class="string">"Billion"</span>&#125;;</div><div class="line">        String[] key1 = &#123;<span class="string">""</span>,<span class="string">"One"</span>,<span class="string">"Two"</span>,<span class="string">"Three"</span>,<span class="string">"Four"</span>,<span class="string">"Five"</span>,<span class="string">"Six"</span>,<span class="string">"Seven"</span>,<span class="string">"Eight"</span>,<span class="string">"Nine"</span>,<span class="string">"Ten"</span>,</div><div class="line">        <span class="string">"Eleven"</span>,<span class="string">"Twelve"</span>,<span class="string">"Thirteen"</span>,<span class="string">"Fourteen"</span>,<span class="string">"Fifteen"</span>,<span class="string">"Sixteen"</span>,<span class="string">"Seventeen"</span>,<span class="string">"Eighteen"</span>,<span class="string">"Nineteen"</span>,<span class="string">"Twenty"</span>&#125;;</div><div class="line">        String[] key2 = &#123;<span class="string">""</span>,<span class="string">""</span>,<span class="string">"Twenty"</span>,<span class="string">"Thirty"</span>,<span class="string">"Forty"</span>,<span class="string">"Fifty"</span>,<span class="string">"Sixty"</span>,<span class="string">"Seventy"</span>,<span class="string">"Eighty"</span>,<span class="string">"Ninety"</span>&#125;;</div><div class="line">        <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line">        StringBuilder sb_global = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">while</span> (num &gt; <span class="number">0</span>)&#123;</div><div class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">            <span class="keyword">int</span> last = num - <span class="number">1000</span>*(num/<span class="number">1000</span>); <span class="comment">// åä¸‰ä½</span></div><div class="line">            <span class="keyword">if</span>(last == <span class="number">0</span>)&#123;</div><div class="line">                counter += <span class="number">1</span>;</div><div class="line">                num = num/<span class="number">1000</span>;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> hundred_digit = last/<span class="number">100</span>;</div><div class="line">            <span class="keyword">if</span>(hundred_digit &gt; <span class="number">0</span>)&#123;</div><div class="line">                sb.append(<span class="string">" "</span>);</div><div class="line">                sb.append(key1[hundred_digit]);</div><div class="line">                sb.append(<span class="string">" Hundred"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> low_two_digit = last - hundred_digit*<span class="number">100</span>;</div><div class="line">            <span class="keyword">if</span>(low_two_digit &gt; <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">if</span> (low_two_digit &lt;= <span class="number">20</span>) &#123;</div><div class="line">                    sb.append(<span class="string">" "</span>);</div><div class="line">                    sb.append(key1[low_two_digit]);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">int</span> tens = low_two_digit / <span class="number">10</span>;</div><div class="line">                    <span class="keyword">int</span> units = low_two_digit - tens * <span class="number">10</span>;</div><div class="line">                    <span class="keyword">if</span> (tens &gt; <span class="number">0</span>) &#123;</div><div class="line">                        sb.append(<span class="string">" "</span>);</div><div class="line">                        sb.append(key2[tens]);</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (units &gt; <span class="number">0</span>) &#123;</div><div class="line">                        sb.append(<span class="string">" "</span>);</div><div class="line">                        sb.append(key1[units]);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (counter &gt; <span class="number">0</span>) &#123;</div><div class="line">                sb.append(<span class="string">" "</span>);</div><div class="line">                sb.append(splitWords[counter]);</div><div class="line">            &#125;</div><div class="line">            sb_global.insert(<span class="number">0</span>, sb.toString());</div><div class="line">            counter += <span class="number">1</span>;</div><div class="line">            num = num/<span class="number">1000</span>;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb_global.subSequence(<span class="number">1</span>, sb_global.length()).toString();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä»£ç ç®€åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String[] LESS_THAN_20 = &#123;<span class="string">""</span>, <span class="string">"One"</span>, <span class="string">"Two"</span>, <span class="string">"Three"</span>, <span class="string">"Four"</span>, <span class="string">"Five"</span>, <span class="string">"Six"</span>, <span class="string">"Seven"</span>, <span class="string">"Eight"</span>, <span class="string">"Nine"</span>, <span class="string">"Ten"</span>, <span class="string">"Eleven"</span>, <span class="string">"Twelve"</span>, <span class="string">"Thirteen"</span>, <span class="string">"Fourteen"</span>, <span class="string">"Fifteen"</span>, <span class="string">"Sixteen"</span>, <span class="string">"Seventeen"</span>, <span class="string">"Eighteen"</span>, <span class="string">"Nineteen"</span>&#125;;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String[] TENS = &#123;<span class="string">""</span>, <span class="string">"Ten"</span>, <span class="string">"Twenty"</span>, <span class="string">"Thirty"</span>, <span class="string">"Forty"</span>, <span class="string">"Fifty"</span>, <span class="string">"Sixty"</span>, <span class="string">"Seventy"</span>, <span class="string">"Eighty"</span>, <span class="string">"Ninety"</span>&#125;;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> String[] THOUSANDS = &#123;<span class="string">""</span>, <span class="string">"Thousand"</span>, <span class="string">"Million"</span>, <span class="string">"Billion"</span>&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">numberToWords</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (num == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"Zero"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    String words = <span class="string">""</span>;</div><div class="line">    </div><div class="line">    <span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (num % <span class="number">1000</span> != <span class="number">0</span>)</div><div class="line">    	    words = helper(num % <span class="number">1000</span>) +THOUSANDS[i] + <span class="string">" "</span> + words;</div><div class="line">    	num /= <span class="number">1000</span>;</div><div class="line">    	i++;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> words.trim();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">helper</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (num == <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (num &lt; <span class="number">20</span>)</div><div class="line">        <span class="keyword">return</span> LESS_THAN_20[num] + <span class="string">" "</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (num &lt; <span class="number">100</span>)</div><div class="line">        <span class="keyword">return</span> TENS[num / <span class="number">10</span>] + <span class="string">" "</span> + helper(num % <span class="number">10</span>);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> LESS_THAN_20[num / <span class="number">100</span>] + <span class="string">" Hundred "</span> + helper(num % <span class="number">100</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Group-Anagrams">4.9. Group Anagrams</h2><p>ç»™<code>str[]</code> ï¼Œå°†åŒä¸€æ’åˆ—ç»„åˆçš„stråˆ†ä¸ºä¸€ç»„ã€‚</p>
<p>ä¸€å¼€å§‹æƒ³å¤šäº†ï¼Œå…¶å®æŒºç®€å•çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">toHash</span><span class="params">(String s)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span>[] hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">        ++hash[s.charAt(i) - <span class="string">'a'</span>];</div><div class="line">    &#125;</div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : hash)sb.append(i);</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; groupAnagrams(String[] strs) &#123;</div><div class="line">    <span class="keyword">if</span>(strs.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span>  LinkedList&lt;List&lt;String&gt;&gt;();</div><div class="line">    HashMap&lt;String, List&lt;String&gt;&gt; set = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(String s:strs)&#123;</div><div class="line">        String hash = toHash(s);</div><div class="line">        <span class="keyword">if</span>(set.containsKey(hash))&#123;</div><div class="line">            set.get(hash).add(s);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            List&lt;String&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">            list.add(s);</div><div class="line">            set.put(hash,list);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> LinkedList&lt;List&lt;String&gt;&gt;(set.values());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Mini-Parser">4.10. Mini Parser</h2><p>å¥½å¤æ‚çš„ä¸€é¢˜ã€‚å°†æ‹¬å·çš„listsååºåˆ—åŒ–ã€‚å¾ˆå¤æ‚ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        NestedInteger nestedInteger;</div><div class="line">        <span class="keyword">int</span> end;</div><div class="line">        Node(NestedInteger nestedInteger, <span class="keyword">int</span> end)&#123;</div><div class="line">            <span class="keyword">this</span>.nestedInteger = nestedInteger;</div><div class="line">            <span class="keyword">this</span>.end = end;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">helper</span><span class="params">(String s, <span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(idx == s.length()) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="comment">//System.out.println(idx);</span></div><div class="line">        NestedInteger obj = <span class="keyword">new</span> NestedInteger();</div><div class="line">        <span class="keyword">int</span> start = idx;</div><div class="line">        <span class="keyword">int</span> addCounter = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i = idx;</div><div class="line">        <span class="keyword">for</span>(i = idx; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="comment">//System.out.println(idx + "\t" + s.charAt(i));</span></div><div class="line">            <span class="keyword">if</span>(s.charAt(i) == <span class="string">','</span>)&#123;</div><div class="line">                addCounter+= <span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>(start &lt; i)obj.add(<span class="keyword">new</span> NestedInteger(Integer.valueOf(s.substring(start, i))));</div><div class="line">                start = i + <span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i) == <span class="string">'['</span>)&#123;</div><div class="line">                Node next = helper(s, i + <span class="number">1</span>);</div><div class="line"></div><div class="line">                <span class="keyword">if</span>(next != <span class="keyword">null</span>) &#123;</div><div class="line">                    obj.add(next.nestedInteger);</div><div class="line">                    addCounter+= <span class="number">1</span>;</div><div class="line">                    i = next.end;</div><div class="line">                    <span class="keyword">if</span>(i &lt; s.length())--i;<span class="comment">//å› ä¸ºforå¾ªç¯ä¼š+1</span></div><div class="line">                    start = next.end + <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i)== <span class="string">']'</span>)&#123;</div><div class="line">                addCounter+= <span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>(start &lt; i)obj.add(<span class="keyword">new</span> NestedInteger(Integer.valueOf(s.substring(start, i))));</div><div class="line">                ++i;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">         <span class="comment">// if(addCounter == 0)</span></div><div class="line">         <span class="comment">//     obj.setInteger(Integer.valueOf(s.substring(0, s.length())));</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Node(obj, i);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> NestedInteger <span class="title">deserialize</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span>  <span class="keyword">new</span> NestedInteger();</div><div class="line">        <span class="keyword">if</span>(s.length() == <span class="number">1</span> || s.charAt(<span class="number">0</span>) != <span class="string">'['</span>) <span class="keyword">return</span> <span class="keyword">new</span> NestedInteger(Integer.valueOf(s));</div><div class="line">        <span class="keyword">return</span> helper(s,<span class="number">1</span>).nestedInteger;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Validate-IP-Address">4.11. Validate IP Address</h2><p>éªŒè¯ç»™å®šå­—ç¬¦ä¸²æ˜¯å¦æ˜¯IPV4æˆ–IPV6åœ°å€</p>
<p>è¿™é“é¢˜å®åœ¨æ˜¯å¤ªå¿ƒé…¸äº†ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹ï¼š</p>
<ol>
<li><code>split</code>æ“ä½œä¼šå¿½ç•¥æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºåˆ†éš”ç¬¦çš„æƒ…å†µ</li>
<li>IPv4 ï¼š<ol>
<li>é•¿åº¦å¿…é¡»ä¸º4</li>
<li>æ¯ä¸ªå­—ç¬¦ä¸å¯æœ‰æœ‰å‰å¯¼0</li>
<li>ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸å¯ä»¥ä¸º0</li>
<li>ä¸å¯ä»¥å‡ºç°å…¶ä»–å­—ç¬¦</li>
<li>å€¼ä¸å¯ä»¥å¤§äº255</li>
</ol>
</li>
<li>IPv6ï¼š<ol>
<li>é•¿åº¦è¦ä¹ˆä¸º8ï¼Œè¦ä¹ˆ åªå­˜åœ¨ä¸€ä¸ª<code>::</code> ã€‚ï¼ˆé€šè¿‡ä½¿ç”¨åŒå†’å·ï¼ˆ::ï¼‰æ›¿æ¢ä¸€ç³»åˆ—é›¶æ¥æŒ‡å®š IPv6 åœ°å€ã€‚ä¾‹å¦‚ï¼ŒIPv6 åœ°å€ ff06:0:0:0:0:0:0:c3 å¯å†™ä½œ ff06::c3ã€‚ä¸€ä¸ª IP åœ°å€ä¸­åªå¯ä½¿ç”¨ä¸€æ¬¡åŒå†’å·ã€‚</li>
<li>å¯ä»¥æœ‰å‰å¯¼é›¶</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">validIPv4</span><span class="params">(String[] ipv4)</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ipv4.length; ++i)&#123;</div><div class="line">                <span class="comment">// ç©ºå­—ç¬¦ï¼Œé”™è¯¯</span></div><div class="line">                <span class="keyword">if</span>(ipv4[i].length() == <span class="number">0</span>)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                <span class="comment">// å‰å¯¼é›¶ï¼Œé”™è¯¯</span></div><div class="line">                <span class="keyword">if</span>(ipv4[i].length() &gt; <span class="number">1</span> &amp;&amp; ipv4[i].charAt(<span class="number">0</span>) == <span class="string">'0'</span>)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                <span class="comment">// æœ‰å…¶ä»–å­—ç¬¦ï¼Œé”™è¯¯</span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">char</span> c : ipv4[i].toCharArray()) <span class="keyword">if</span>(c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                <span class="keyword">int</span> val = Integer.valueOf(ipv4[i]);</div><div class="line">                <span class="comment">// ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º0ï¼Œé”™è¯¯</span></div><div class="line">                <span class="keyword">if</span>(i == <span class="number">0</span> &amp;&amp; val == <span class="number">0</span>)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                <span class="comment">// å€¼é”™è¯¯</span></div><div class="line">                <span class="keyword">if</span>(val &lt; <span class="number">0</span> || val &gt;= <span class="number">256</span>) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="string">"IPv4"</span>;</div><div class="line">        &#125;<span class="keyword">catch</span> (NumberFormatException e)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">validIPv6</span><span class="params">(String[] IPv6)</span></span>&#123;</div><div class="line">        <span class="keyword">boolean</span> lenOK = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; IPv6.length; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(IPv6[i].length()==<span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">if</span>(lenOK) <span class="keyword">return</span>  <span class="string">"Neither"</span>;</div><div class="line">                lenOK = <span class="keyword">true</span>;</div><div class="line">                <span class="comment">//æ£€æŸ¥å·¦è¾¹æ˜¯å¦å­˜åœ¨0</span></div><div class="line">                <span class="keyword">if</span>(i &gt; <span class="number">0</span>)&#123;</div><div class="line">                    <span class="comment">//IPv6[i-1]</span></div><div class="line">                    <span class="keyword">if</span>(IPv6[i-<span class="number">1</span>].length() == <span class="number">0</span>)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(IPv6[i-<span class="number">1</span>].length() == <span class="number">1</span>) &#123;</div><div class="line">                        <span class="keyword">if</span> (IPv6[i - <span class="number">1</span>].equals(<span class="string">"0"</span>)) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                    &#125;<span class="keyword">else</span>&#123; <span class="comment">// é•¿åº¦å¤§äº0</span></div><div class="line">                        <span class="keyword">boolean</span> allZero = <span class="keyword">true</span>;</div><div class="line">                        <span class="keyword">for</span>(<span class="keyword">char</span> c : IPv6[i - <span class="number">1</span>].toCharArray())&#123;</div><div class="line">                            <span class="keyword">if</span>(c != <span class="string">'0'</span>)&#123;</div><div class="line">                                allZero = <span class="keyword">false</span>;</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">if</span>(allZero)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(IPv6[i].length() &gt; <span class="number">4</span>)<span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">char</span> c : IPv6[i].toCharArray())&#123;</div><div class="line">                <span class="keyword">if</span>((c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'f'</span>)||</div><div class="line">                    (c &gt;=<span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)||</div><div class="line">                    (c &gt;= <span class="string">'A'</span> &amp;&amp; c &lt;= <span class="string">'F'</span>))&#123;</div><div class="line">                    <span class="comment">// åˆæ³•</span></div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>((lenOK &amp;&amp; IPv6.length &lt; <span class="number">8</span>) || IPv6.length == <span class="number">8</span>) <span class="keyword">return</span> <span class="string">"IPv6"</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span>  <span class="string">"Neither"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">validIPAddress</span><span class="params">(String IP)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(IP.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        <span class="comment">// å› ä¸ºsplitæ“ä½œæ£€æµ‹ä¸åˆ°æœ€åä¸€ä¸ª.æˆ–è€…ï¼š</span></div><div class="line">        <span class="keyword">char</span> last = IP.charAt(IP.length() - <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(!((last &gt;= <span class="string">'a'</span> &amp;&amp; last &lt;= <span class="string">'f'</span>)||</div><div class="line">            (last &gt;=<span class="string">'0'</span> &amp;&amp; last &lt;= <span class="string">'9'</span>)||</div><div class="line">            (last &gt;= <span class="string">'A'</span> &amp;&amp; last &lt;= <span class="string">'F'</span>)))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        &#125;</div><div class="line">        String[] ipv4 = IP.split(<span class="string">"\\."</span>); <span class="comment">// .æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œå¿…é¡»ç”¨\\.</span></div><div class="line">        <span class="keyword">if</span>(ipv4.length == <span class="number">4</span>)&#123;</div><div class="line">            <span class="keyword">return</span>  validIPv4(ipv4);</div><div class="line">        &#125;</div><div class="line">        String[] IPv6 = IP.split(<span class="string">":"</span>);</div><div class="line">        <span class="keyword">if</span>(IPv6.length &gt; <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> validIPv6(IPv6);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>  <span class="string">"Neither"</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è‡ªå·±å†™çš„ä»£ç å¥½ä¹±ï¼Œå­¦ä¹ ä¸€ä¸‹åˆ«äººçš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">validIPAddress</span><span class="params">(String IP)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (IP.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        <span class="keyword">int</span> lastChar = IP.charAt(IP.length() - <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span> (lastChar == <span class="string">':'</span> || lastChar == <span class="string">'.'</span>) <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        String[] groups = IP.split(<span class="string">"\\."</span>);</div><div class="line">        <span class="keyword">if</span> (groups.length == <span class="number">1</span>) &#123;</div><div class="line">            groups = IP.split(<span class="string">":"</span>);</div><div class="line">            <span class="keyword">if</span> (validateIPv6(groups)) <span class="keyword">return</span> <span class="string">"IPv6"</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> (validateIPv4(groups)) <span class="keyword">return</span> <span class="string">"IPv4"</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">"Neither"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// éªŒè¯v4å•ä¸ªç»„</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">validateIPv4Group</span><span class="params">(String group)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (group.length() &gt; <span class="number">3</span> || group.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span> (group.length() &gt; <span class="number">1</span> &amp;&amp; group.charAt(<span class="number">0</span>) == <span class="string">'0'</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; group.length(); i++) &#123;</div><div class="line">            <span class="keyword">char</span> c = group.charAt(i);</div><div class="line">            <span class="keyword">if</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) res = res * <span class="number">10</span> + c - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res &lt; <span class="number">256</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// éªŒè¯v4æ•´ä¸ªç»„</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">validateIPv4</span><span class="params">(String[] groups)</span> </span>&#123;</div><div class="line">        <span class="comment">//System.out.println(Arrays.toString(groups));</span></div><div class="line">        <span class="keyword">if</span> (groups.length != <span class="number">4</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; groups.length; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (!validateIPv4Group(groups[i])) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">     <span class="comment">// éªŒè¯v6å•ä¸ªç»„</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">validateIPv6Group</span><span class="params">(String group)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (group.length() &gt; <span class="number">4</span> || group.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; group.length(); i++) &#123;</div><div class="line">            <span class="keyword">char</span> c = Character.toLowerCase(group.charAt(i));</div><div class="line">            <span class="keyword">if</span> ((c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) || (c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'f'</span>)) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// éªŒè¯v6æ•´ä¸ªç»„</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">validateIPv6</span><span class="params">(String[] groups)</span> </span>&#123;</div><div class="line">        <span class="comment">//System.out.println(Arrays.toString(groups));</span></div><div class="line">        <span class="keyword">if</span> (groups.length != <span class="number">8</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (!validateIPv6Group(groups[i])) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Compare-Version-Numbers">4.12. Compare Version Numbers</h2><p>æ¯”è¾ƒä¸¤ä¸ªstrçš„ç‰ˆæœ¬å·çš„å¤§å°ã€‚</p>
<p>æ³¨æ„ï¼šæœ‰<code>1.0000.00</code> ä¸<code>1.0</code> çš„è¿™ç§å˜æ€æ ·ä¾‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareVersion</span><span class="params">(String version1, String version2)</span> </span>&#123;</div><div class="line">    String[] v1 = version1.split(<span class="string">"\\."</span>);</div><div class="line">    String[] v2 = version2.split(<span class="string">"\\."</span>);</div><div class="line">    <span class="keyword">int</span> v1_idx = <span class="number">0</span>, v2_idx = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (v1_idx &lt; v1.length &amp;&amp; v2_idx &lt; v2.length)&#123;</div><div class="line">        <span class="keyword">if</span>(Integer.valueOf(v1[v1_idx]) == Integer.valueOf(v2[v2_idx]))&#123;++v1_idx; ++v2_idx;&#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Integer.valueOf(v1[v1_idx]) &gt; Integer.valueOf(v2[v2_idx]))&#123;<span class="keyword">return</span> <span class="number">1</span>;&#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(v1_idx &lt; v1.length)&#123;</div><div class="line">        <span class="keyword">while</span>(v1_idx &lt; v1.length &amp;&amp; Integer.valueOf(v1[v1_idx]) == <span class="number">0</span>)&#123;++v1_idx;&#125;</div><div class="line">        <span class="keyword">if</span>(v1_idx == v1.length) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(v2_idx &lt; v2.length)&#123;</div><div class="line">        <span class="keyword">while</span>(v2_idx &lt; v2.length &amp;&amp; Integer.valueOf(v2[v2_idx]) == <span class="number">0</span>)&#123;++v2_idx;&#125;</div><div class="line">        <span class="keyword">if</span>(v2_idx == v2.length) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reverse-Words-in-a-String">4.13. Reverse Words in a String</h2><p>å°†stringé‡Œçš„å•è¯é¡ºåºæåã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœæœ‰å¤šä¸ªè¿ç»­ç©ºæ ¼ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚ç»“æœä¸å¯ä»¥å‡ºç°å‰å¯¼ç©ºæ ¼æˆ–è€…åç¼€ç©ºæ ¼ã€‚</p>
<p>è¿™é“é¢˜ä¸€å¼€å§‹æƒ³å¤šäº†ã€‚å…¶å®æŒºç®€å•çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">reverseWords</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(s.length() == <span class="number">0</span>) <span class="keyword">return</span> s;</div><div class="line">    String[] strs = s.split(<span class="string">" +"</span>); <span class="comment">// åˆ†å‰²æ—¶å¯ä»¥æœ‰å¤šä¸ªç©ºæ ¼</span></div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = strs.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)&#123;</div><div class="line">        <span class="keyword">if</span>(strs[i].length() == <span class="number">0</span>)<span class="keyword">continue</span>;</div><div class="line">        sb.append(<span class="string">' '</span>);</div><div class="line">        sb.append(strs[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sb.length() == <span class="number">0</span> ? <span class="string">""</span>: sb.subSequence(<span class="number">1</span>, sb.length()).toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reverse-Words-in-a-String-II">4.14. Reverse Words in a String II</h2><p>å°†è¾“å…¥çš„stringæ”¹æˆchar[]çš„å½¢å¼ï¼Œè¦æ±‚ç”¨O(1)ç©ºé—´å¤æ‚åº¦å°†å•è¯é¡ºåºæåã€‚è¿™æ¬¡æ²¡æœ‰å¤šä¸ªç©ºæ ¼ï¼Œä¹Ÿæ²¡æœ‰å‰å¯¼å’Œåç¼€ç©ºæ ¼ã€‚</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>å…ˆå°†å…¨éƒ¨å­—ç¬¦ä¸²ç¿»è½¬</li>
<li>ç„¶åå¯¹æ¯ä¸ªå•è¯è¿›è¡Œç¿»è½¬</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">char</span>[] str, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">        <span class="keyword">char</span> temp =str[low];</div><div class="line">        str[low] = str[high];</div><div class="line">        str[high] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverseWords</span><span class="params">(<span class="keyword">char</span>[] str)</span> </span>&#123;</div><div class="line">        <span class="comment">// 1. å°†æ•´ä¸ªstråè½¬</span></div><div class="line">        <span class="keyword">int</span> low = <span class="number">0</span>, high = str.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">            swap(str, low, high);</div><div class="line">            ++low;</div><div class="line">            --high;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 2. é€ä¸ªå•è¯å†…éƒ¨åè½¬</span></div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        low = i;high = i;</div><div class="line">        <span class="keyword">char</span> space = <span class="string">' '</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; str.length)&#123;</div><div class="line">            <span class="keyword">if</span>(str[i] == space)&#123;++i;&#125;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                <span class="comment">// str[i]ä¸æ˜¯space</span></div><div class="line">                low = i; ++i;</div><div class="line">                <span class="keyword">while</span> (i &lt; str.length &amp;&amp; str[i] != space)&#123;</div><div class="line">                    ++i;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// [low, i) éƒ½ä¸æ˜¯spaceï¼Œåè½¬lowåˆ°i</span></div><div class="line">                high = i - <span class="number">1</span>;</div><div class="line">                <span class="keyword">while</span> (low &lt; high)&#123;</div><div class="line">                    swap(str, low, high);</div><div class="line">                    ++low; --high;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å…¶å®ä»¥ä¸Šä»£ç å¯ä»¥ç®€åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverseWords</span><span class="params">(<span class="keyword">char</span>[] str)</span> </span>&#123;</div><div class="line">    reverse(str, <span class="number">0</span>, str.length-<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> r = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(r &lt; str.length)&#123;</div><div class="line">        <span class="keyword">int</span> l = r;</div><div class="line">        <span class="keyword">while</span>(r &lt; str.length &amp;&amp; str[r] != <span class="string">' '</span>)</div><div class="line">            r++;</div><div class="line">        reverse(str, l, r-<span class="number">1</span>);</div><div class="line">        r++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">char</span>[] s, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">    <span class="keyword">while</span>(l &lt; r)&#123;</div><div class="line">        <span class="keyword">char</span> tmp = s[l];</div><div class="line">        s[l++] = s[r];</div><div class="line">        s[r--] = tmp;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reverse-Words-in-a-String-III">4.15. Reverse Words in a String III</h2><p>è¿™é“é¢˜å…¶å®æ˜¯ä¸Šä¸€é¢˜çš„easyç‰ˆã€‚è¦å°†å­—ç¬¦ä¸²å†…çš„æ¯ä¸ªå•è¯çš„å•è¯å†…éƒ¨é¡ºåºæåã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">char</span>[] str, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span></span>&#123;</div><div class="line">    <span class="keyword">while</span> (low &lt; high) &#123;</div><div class="line">        <span class="keyword">char</span> temp = str[low];</div><div class="line">        str[low] = str[high];</div><div class="line">        str[high] = temp;</div><div class="line">        ++low;</div><div class="line">        --high;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">reverseWords</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] str = s.toCharArray();</div><div class="line">    <span class="comment">// 1. é€ä¸ªå•è¯å†…éƒ¨åè½¬</span></div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> low = i; <span class="keyword">int</span> high = i;</div><div class="line">    <span class="keyword">char</span> space = <span class="string">' '</span>;</div><div class="line">    <span class="keyword">while</span> (i &lt; str.length)&#123;</div><div class="line">        <span class="keyword">if</span>(str[i] == space)&#123;++i;&#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="comment">// str[i]ä¸æ˜¯space</span></div><div class="line">            low = i; ++i;</div><div class="line">            <span class="keyword">while</span> (i &lt; str.length &amp;&amp; str[i] != space)&#123;</div><div class="line">                ++i;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// [low, i) éƒ½ä¸æ˜¯spaceï¼Œåè½¬lowåˆ°i</span></div><div class="line">            high = i - <span class="number">1</span>;</div><div class="line">            reverse(str, low, high);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> String.valueOf(str);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Excel-Sheet-Column-Title">4.16. Excel Sheet Column Title</h2><p>å°†æ•°å­—è¡¨ç¤ºæˆExcelä¸­çš„å­—æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">1 -&gt; A</div><div class="line">2 -&gt; B</div><div class="line">3 -&gt; C</div><div class="line">...</div><div class="line">26 -&gt; Z</div><div class="line">27 -&gt; AA</div><div class="line">28 -&gt; AB</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜çš„æ£˜æ‰‹ä¹‹å¤„åœ¨äºæ²¡æœ‰0å…ƒç´ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">helper</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (n &gt; <span class="number">26</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(n%<span class="number">26</span> == <span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> helper(n/<span class="number">26</span> - <span class="number">1</span>) +</div><div class="line">                        helper((n - <span class="number">26</span>*(n/<span class="number">26</span>) == <span class="number">0</span> ? <span class="number">25</span> :n - <span class="number">26</span>*(n/<span class="number">26</span>) ) + <span class="number">1</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> helper(n/<span class="number">26</span>) + helper(n - <span class="number">26</span>*(n/<span class="number">26</span>));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> String.valueOf((<span class="keyword">char</span>)(n+<span class="number">64</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convertToTitle</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(n);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä»£ç å†™çš„å¤ªç»•äº†ï¼Œçœ‹çœ‹åˆ«äººçš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">convertToTitle</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">       StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">       <span class="keyword">while</span>(n&gt;<span class="number">0</span>)&#123;</div><div class="line">           n--; <span class="comment">// è¿™ä¸ªå¤„ç†éå¸¸å·§å¦™ï¼Œå°†æ‰€æœ‰çš„å­—ç¬¦è¡¨ç¤ºç»Ÿç»Ÿå‡äº†1</span></div><div class="line">           sb.insert(<span class="number">0</span>,(<span class="keyword">char</span>)(<span class="string">'A'</span>+n%<span class="number">26</span>));</div><div class="line">           n=n/<span class="number">26</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> sb.toString();</div><div class="line">       </div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Excel-Sheet-Column-Number">4.17. Excel Sheet Column Number</h2><p>å°†Excelä¸­çš„å­—æ¯è¡¨ç¤ºæˆæ•°å­—ã€‚</p>
<p>åšå®Œä¸Šä¸€é¢˜ï¼Œè¿™ä¸€é¢˜å°±ç®€å•å¾ˆå¤šã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">titleToNumber</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : s.toCharArray())&#123;</div><div class="line">            num *= <span class="number">26</span>;</div><div class="line">            num += (c - <span class="string">'A'</span> + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Bulls-and-Cows">4.18. Bulls and Cows</h2><p>ç”²ä¹™äºŒäººç©çŒœæ•°å­—æ¸¸æˆã€‚ç”²å¿ƒé‡Œé»˜è®¤ä¸€ä¸ªæ•°å­—ï¼Œä¹™å»çŒœã€‚ä»¤A = ä¹™å®Œå…¨çŒœä¸­ï¼ˆä½ç½®å’Œæ•°å­—éƒ½çŒœä¸­ï¼‰çš„ä¸ªæ•°ã€‚B = ä¹™çŒœä¸­æ•°å­—ä½†æ²¡çŒœå¯¹ä½ç½®çš„ä¸ªæ•°ã€‚ç»Ÿè®¡Aå’ŒBã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Secret number:  &quot;1123&quot;</div><div class="line">Friend&apos;s guess: &quot;0111&quot;</div><div class="line"></div><div class="line">è¾“å‡º &quot;1A1B&quot;</div></pre></td></tr></table></figure>
<p>æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯hashã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getHint</span><span class="params">(String secret, String guess)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[] secret_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</div><div class="line">        <span class="keyword">int</span>[] guess_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</div><div class="line">        <span class="keyword">int</span> A = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; secret.length(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(secret.charAt(i) == guess.charAt(i))&#123;</div><div class="line">                ++A;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                ++secret_hash[secret.charAt(i) - <span class="string">'0'</span>];</div><div class="line">                ++guess_hash[guess.charAt(i) - <span class="string">'0'</span>];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç»Ÿè®¡Bçš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">int</span> B = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(secret_hash[i] &gt; <span class="number">0</span> &amp;&amp; guess_hash[i] &gt; <span class="number">0</span>)&#123;</div><div class="line">                B += Math.min(secret_hash[i], guess_hash[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> String.valueOf(A)+<span class="string">"A"</span> + String.valueOf(B) + <span class="string">"B"</span> ;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="å·§ç”¨unicodeç¼–ç åšHash">5. å·§ç”¨unicodeç¼–ç åšHash</h1><p>å°å†™å­—ç¬¦åªæœ‰26ä¸ªã€‚å› æ­¤å¯ä»¥ç”³è¯·é•¿åº¦ä¸º26çš„int[]åšhashã€‚</p>
<p>å¦‚æœä¸ä¸€å®šå¤§å°å†™ï¼Œå¯ä»¥ç”¨256å¤§å°çš„æ•°ç»„åšhashã€‚å› ä¸ºæœ€å¤§çš„Zçš„unicodeä¸è¶…è¿‡256.</p>
<h2 id="Isomorphic-Strings">5.1. Isomorphic Strings</h2><p>åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯åŒæ„çš„ã€‚</p>
<p>æ€è·¯ï¼šå¦‚æœæ˜¯åŒæ„çš„ï¼Œé‚£ä¹ˆå¦‚æœç¬¬iä½ç½®çš„å­—ç¬¦æ›¾ç»å‡ºç°è¿‡ï¼Œé‚£ä¹ˆä¸¤ä¸ªå­—ç¬¦çš„æ›¾ç»å‡ºç°è¿‡çš„ä½ç½®ä¸€å®šæ˜¯ä¸€æ ·çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isIsomorphic</span><span class="params">(String s, String t)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[] s_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        <span class="keyword">int</span>[] t_hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];</div><div class="line">        Arrays.fill(s_hash, -<span class="number">1</span>);</div><div class="line">        Arrays.fill(t_hash, -<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="keyword">if</span>(s_hash[s.charAt(i)] != t_hash[t.charAt(i)]) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            s_hash[s.charAt(i)] = i;</div><div class="line">            t_hash[t.charAt(i)] = i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="åŠ å‡ä¹˜é™¤é—®é¢˜">6. åŠ å‡ä¹˜é™¤é—®é¢˜</h1><h2 id="Additive-Number">6.1. Additive Number</h2><p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ˜¯additiveåºåˆ—ã€‚å…¶ä¸­additiveåºåˆ—çš„å«ä¹‰æ˜¯å‰ä¸¤ä¸ªå…ƒç´ çš„å’Œç­‰äºæœ¬å…ƒç´ ã€‚</p>
<p>è¦ç‚¹ï¼šä¸€ä¸ªå…ƒç´ å¯èƒ½ç”±å¤šä½çš„charç»„æˆã€‚å› æ­¤æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">add</span><span class="params">(String a, String b)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> a_idx = a.length() - <span class="number">1</span>, b_idx = b.length() - <span class="number">1</span>;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">int</span> lastMod = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (a_idx &gt;= <span class="number">0</span> || b_idx &gt;= <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">int</span> sum = lastMod;</div><div class="line">            <span class="keyword">if</span>(a_idx &gt;= <span class="number">0</span>)&#123;</div><div class="line">                sum += Integer.valueOf(a.charAt(a_idx) - <span class="string">'0'</span>);</div><div class="line">                --a_idx;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(b_idx &gt;= <span class="number">0</span>)&#123;</div><div class="line">                sum += Integer.valueOf(b.charAt(b_idx) - <span class="string">'0'</span>);</div><div class="line">                --b_idx;</div><div class="line">            &#125;</div><div class="line">            lastMod = sum/<span class="number">10</span>;</div><div class="line">            sum %= <span class="number">10</span>;</div><div class="line">            sb.append(sum);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(lastMod &gt; <span class="number">0</span>) sb.append(lastMod);</div><div class="line">        <span class="keyword">return</span> sb.reverse().toString();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(String num, String lastNum, String currNum, <span class="keyword">int</span> end)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(end == num.length()) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span>((lastNum.length() &gt; <span class="number">1</span> &amp;&amp; lastNum.charAt(<span class="number">0</span>) == <span class="string">'0'</span>) ||</div><div class="line">            (currNum.length() &gt; <span class="number">1</span> &amp;&amp; currNum.charAt(<span class="number">0</span>) == <span class="string">'0'</span>)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        String sum = add(currNum, lastNum);</div><div class="line">        <span class="keyword">if</span>(end + sum.length() &lt;= num.length() &amp;&amp; sum.equals(num.substring(end, end + sum.length())))&#123;</div><div class="line">            <span class="keyword">if</span>(dfs(num, currNum, sum , end + sum.length())) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAdditiveNumber</span><span class="params">(String num)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(num.length() &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="comment">// éå†ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ•°å­—</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; num.length(); ++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; num.length(); ++j)&#123;</div><div class="line">                <span class="keyword">if</span>(dfs(num, num.substring(<span class="number">0</span>,i), num.substring(i,j),j))&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> String </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-LinkedList]]></title>
      <url>/2017/11/15/Java-LinkedList/</url>
      <content type="html"><![CDATA[<h1 id="LinkedListç®€ä»‹">1. LinkedListç®€ä»‹</h1><p><strong>LinkedListç®€ä»‹</strong></p>
<p>LinkedList æ˜¯ä¸€ä¸ªç»§æ‰¿äºAbstractSequentialListçš„åŒå‘é“¾è¡¨ã€‚å®ƒä¹Ÿå¯ä»¥è¢«å½“ä½œå †æ ˆã€é˜Ÿåˆ—æˆ–åŒç«¯é˜Ÿåˆ—è¿›è¡Œæ“ä½œã€‚</p>
<ul>
<li><p>LinkedList å®ç° Queue  æ¥å£ï¼Œèƒ½å¯¹å®ƒè¿›è¡Œé˜Ÿåˆ—æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">queue.offer(<span class="number">1</span>);</div><div class="line">queue.poll();</div></pre></td></tr></table></figure>
</li>
<li><p>LinkedList å®ç° Deque æ¥å£ï¼Œå³èƒ½å°†LinkedListå½“ä½œåŒç«¯é˜Ÿåˆ—ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">Deque&lt;Integer&gt; deque = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line"></div><div class="line">Dequeæ¥å£çš„æ–¹æ³•ï¼š</div><div class="line"><span class="comment">// ä»å¤´å¢</span></div><div class="line">addFirst(element);</div><div class="line">offerFirst(element):å¦‚æœå¢åŠ æˆåŠŸï¼Œè¿”å›<span class="function"><span class="keyword">true</span></span></div><div class="line"><span class="title">push</span><span class="params">(element)</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä»å°¾å¢</span></div><div class="line">add(element);</div><div class="line">addLast(element);</div><div class="line">offer(element) ;  å¦‚æœå¢åŠ æˆåŠŸï¼Œè¿”å›<span class="function"><span class="keyword">true</span></span></div><div class="line"><span class="title">offerLast</span><span class="params">(element)</span>; å¦‚æœå¢åŠ æˆåŠŸï¼Œè¿”å›<span class="keyword">true</span></div><div class="line"></div><div class="line"><span class="comment">// è¿­ä»£</span></div><div class="line">iterator();</div><div class="line">descendingIterator();: é€†åºè¿­ä»£</div><div class="line"></div><div class="line"><span class="comment">// ä»å¤´åˆ </span></div><div class="line">pop(element) ; è¿”å›åˆ é™¤çš„å…ƒç´ </div><div class="line">removeFirst();</div><div class="line"></div><div class="line"><span class="comment">// ä»å°¾åˆ </span></div><div class="line">removeLast();</div><div class="line"></div><div class="line"><span class="comment">// éœ€è¦æ³¨æ„çš„æ˜¯</span></div><div class="line">Collection--&gt;Queue--&gt;Deque--å®ç°--&gt;LinkedList(å®ç°ç±»)</div><div class="line">  </div><div class="line">- Dequeæ¥å£ç»§æ‰¿äº†Queueæ¥å£,è€ŒQueueæ¥å£ç»§æ‰¿äº†Collectionæ¥å£,</div><div class="line">- LinkedListå®ç°äº†Dequeæ¥å£</div><div class="line"></div><div class="line"><span class="comment">// ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç°è±¡ï¼š</span></div><div class="line"></div><div class="line">LinkedList&lt;Integer&gt; test = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">test.addFirst(<span class="number">1</span>);</div><div class="line"></div><div class="line">List&lt;Integer&gt; ret = test;</div><div class="line">ret.addFirst(<span class="number">1</span>);<span class="comment">// éæ³•æ“ä½œï¼</span></div></pre></td></tr></table></figure>
</li>
<li><p>LinkedList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½å…‹éš†ã€‚</p>
</li>
<li><p>LinkedList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€LinkedListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚</p>
</li>
<li><p>LinkedList æ˜¯éåŒæ­¥çš„ã€‚</p>
</li>
</ul>
<a id="more"></a>
<p><strong>LinkedListæ„é€ å‡½æ•°</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></div><div class="line">LinkedList()</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªLinkedListï¼Œä¿æŠ¤Collectionä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚</span></div><div class="line">LinkedList(Collection&lt;? extends E&gt; collection)</div></pre></td></tr></table></figure>
<p><strong>LinkedListçš„API</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">LinkedListçš„<span class="function">API</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">add</span><span class="params">(E object)</span></div><div class="line"><span class="keyword">void</span>          <span class="title">add</span><span class="params">(<span class="keyword">int</span> location, E object)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; collection)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> location, Collection&lt;? extends E&gt; collection)</span></div><div class="line"><span class="keyword">void</span>          <span class="title">addFirst</span><span class="params">(E object)</span></div><div class="line"><span class="keyword">void</span>          <span class="title">addLast</span><span class="params">(E object)</span></div><div class="line"><span class="keyword">void</span>          <span class="title">clear</span><span class="params">()</span></div><div class="line">Object        <span class="title">clone</span><span class="params">()</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">contains</span><span class="params">(Object object)</span></div><div class="line">Iterator&lt;E&gt;   <span class="title">descendingIterator</span><span class="params">()</span></div><div class="line">E             <span class="title">element</span><span class="params">()</span></div><div class="line">E             <span class="title">get</span><span class="params">(<span class="keyword">int</span> location)</span></div><div class="line">E             <span class="title">getFirst</span><span class="params">()</span></div><div class="line">E             <span class="title">getLast</span><span class="params">()</span></div><div class="line"><span class="keyword">int</span>           <span class="title">indexOf</span><span class="params">(Object object)</span></div><div class="line"><span class="keyword">int</span>           <span class="title">lastIndexOf</span><span class="params">(Object object)</span></div><div class="line">ListIterator&lt;E&gt;     <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> location)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">offer</span><span class="params">(E o)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">offerFirst</span><span class="params">(E e)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">offerLast</span><span class="params">(E e)</span></div><div class="line">E             <span class="title">peek</span><span class="params">()</span></div><div class="line">E             <span class="title">peekFirst</span><span class="params">()</span></div><div class="line">E             <span class="title">peekLast</span><span class="params">()</span></div><div class="line">E             <span class="title">poll</span><span class="params">()</span></div><div class="line">E             <span class="title">pollFirst</span><span class="params">()</span></div><div class="line">E             <span class="title">pollLast</span><span class="params">()</span></div><div class="line">E             <span class="title">pop</span><span class="params">()</span></div><div class="line"><span class="keyword">void</span>          <span class="title">push</span><span class="params">(E e)</span></div><div class="line">E             <span class="title">remove</span><span class="params">()</span></div><div class="line">E             <span class="title">remove</span><span class="params">(<span class="keyword">int</span> location)</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">remove</span><span class="params">(Object object)</span></div><div class="line">E             <span class="title">removeFirst</span><span class="params">()</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">removeFirstOccurrence</span><span class="params">(Object o)</span></div><div class="line">E             <span class="title">removeLast</span><span class="params">()</span></div><div class="line"><span class="keyword">boolean</span>       <span class="title">removeLastOccurrence</span><span class="params">(Object o)</span></div><div class="line">E             <span class="title">set</span><span class="params">(<span class="keyword">int</span> location, E object)</span></div><div class="line"><span class="keyword">int</span>           <span class="title">size</span><span class="params">()</span></div><div class="line">&lt;T&gt; T[]       <span class="title">toArray</span><span class="params">(T[] contents)</span></div><div class="line">Object[]     <span class="title">toArray</span><span class="params">()</span></div></pre></td></tr></table></figure>
<p><strong>AbstractSequentialListç®€ä»‹</strong></p>
<p>åœ¨ä»‹ç»LinkedListçš„æºç ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹AbstractSequentialListã€‚æ¯•ç«Ÿï¼ŒLinkedListæ˜¯AbstractSequentialListçš„å­ç±»ã€‚</p>
<p>AbstractSequentialList å®ç°äº†get(int index)ã€set(int index, E element)ã€add(int index, E element) å’Œ remove(int index)è¿™äº›å‡½æ•°ã€‚<strong>è¿™äº›æ¥å£éƒ½æ˜¯éšæœºè®¿é—®Listçš„</strong>ï¼ŒLinkedListæ˜¯åŒå‘é“¾è¡¨ï¼›æ—¢ç„¶å®ƒç»§æ‰¿äºAbstractSequentialListï¼Œå°±ç›¸å½“äºå·²ç»å®ç°äº†â€œget(int index)è¿™äº›æ¥å£â€ã€‚</p>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è‹¥éœ€è¦é€šè¿‡AbstractSequentialListè‡ªå·±å®ç°ä¸€ä¸ªåˆ—è¡¨ï¼Œåªéœ€è¦æ‰©å±•æ­¤ç±»ï¼Œå¹¶æä¾› listIterator() å’Œ size() æ–¹æ³•çš„å®ç°å³å¯ã€‚è‹¥è¦å®ç°ä¸å¯ä¿®æ”¹çš„åˆ—è¡¨ï¼Œåˆ™éœ€è¦å®ç°åˆ—è¡¨è¿­ä»£å™¨çš„ hasNextã€nextã€hasPreviousã€previous å’Œ index æ–¹æ³•å³å¯ã€‚</p>
<p>#LinkedListæ•°æ®ç»“æ„</p>
<p> <strong>LinkedListçš„ç»§æ‰¿å…³ç³»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">java.lang.Object</div><div class="line">   â†³     java.util.AbstractCollection&lt;E&gt;</div><div class="line">         â†³     java.util.AbstractList&lt;E&gt;</div><div class="line">               â†³     java.util.AbstractSequentialList&lt;E&gt;</div><div class="line">                     â†³     java.util.LinkedList&lt;E&gt;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span>&lt;<span class="title">E</span>&gt;</span></div><div class="line">    <span class="keyword">extends</span> <span class="title">AbstractSequentialList</span>&lt;<span class="title">E</span>&gt;</div><div class="line">    <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">Deque</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> &#123;&#125;</div></pre></td></tr></table></figure>
<p><strong>LinkedListä¸Collectionçš„å…³ç³»å›¾</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-15-19-53-26.png" alt=""> </p>
<p>LinkedListçš„æœ¬è´¨æ˜¯åŒå‘é“¾è¡¨ã€‚<br>(01) LinkedListç»§æ‰¿äºAbstractSequentialListï¼Œå¹¶ä¸”å®ç°äº†Dequeueæ¥å£ã€‚<br>(02) LinkedListåŒ…å«ä¸¤ä¸ªé‡è¦çš„æˆå‘˜ï¼šheader å’Œ sizeã€‚<br>ã€€ã€€headeræ˜¯åŒå‘é“¾è¡¨çš„è¡¨å¤´ï¼Œå®ƒæ˜¯åŒå‘é“¾è¡¨èŠ‚ç‚¹æ‰€å¯¹åº”çš„ç±»Entryçš„å®ä¾‹ã€‚Entryä¸­åŒ…å«æˆå‘˜å˜é‡ï¼š previous, next, elementã€‚å…¶ä¸­ï¼Œpreviousæ˜¯è¯¥èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œnextæ˜¯è¯¥èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œelementæ˜¯è¯¥èŠ‚ç‚¹æ‰€åŒ…å«çš„å€¼ã€‚<br>ã€€ã€€sizeæ˜¯åŒå‘é“¾è¡¨ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">2. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/skywang12345/p/3308807.html" target="_blank" rel="external">Java é›†åˆç³»åˆ—05ä¹‹ LinkedListè¯¦ç»†ä»‹ç»(æºç è§£æ)å’Œä½¿ç”¨ç¤ºä¾‹</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[leetcodeåˆ·é¢˜æ€»ç»“]]></title>
      <url>/2017/11/15/%E7%AE%97%E6%B3%95-leetcode%E5%88%B7%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>ä¸»è¦æ€»ç»“è‡ªå·±åšè¿‡çš„é¢˜çš„çŸ¥è¯†ç‚¹ã€‚</p>
<p>è§£é‡Šï¼š</p>
<p>â˜…ï¼šéœ€è¦å†æ¬¡çœ‹</p>
<p>â¤ï¼šåšäº†å¾ˆä¹…</p>
<p>â–²ï¼šæ²¡åšå‡ºæ¥</p>
<p><strong>ç›¸å…³æ–‡ç« </strong>ï¼š</p>
<ol>
<li><a href="/2017/11/16/Java-String/" title="Java-String">Java-String</a></li>
<li><a href="/2017/11/13/ç®—æ³•-Trieæ ‘/" title="ç®—æ³•-Trieæ ‘">ç®—æ³•-Trieæ ‘</a></li>
<li><a href="/2017/11/05/ç®—æ³•-å¹¶æŸ¥é›†/" title="ç®—æ³•-å¹¶æŸ¥é›†">ç®—æ³•-å¹¶æŸ¥é›†</a></li>
<li><a href="/2017/11/03/ç®—æ³•-å †/" title="ç®—æ³•-å †">ç®—æ³•-å †</a></li>
<li><a href="/2017/11/17/ç®—æ³•-DP/" title="ç®—æ³•-DP">ç®—æ³•-DP</a></li>
<li></li>
<li><a href="/2017/11/21/ç®—æ³•-DFS/" title="ç®—æ³•-DFS">ç®—æ³•-DFS</a></li>
<li><a href="/2017/11/24/ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾/" title="ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾">ç®—æ³•-äºŒåˆ†æŸ¥æ‰¾</a></li>
<li><a href="/2017/11/28/ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»/" title="ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»">ç®—æ³•-äºŒå‰æ ‘ä¸åˆ†æ²»</a></li>
<li><a href="/2017/12/04/ç®—æ³•-é“¾è¡¨/" title="ç®—æ³•-é“¾è¡¨">ç®—æ³•-é“¾è¡¨</a>
</li>
</ol>
<a id="more"></a>
<table>
<thead>
<tr>
<th>é¢˜</th>
<th>é¢˜æ„</th>
<th>çŸ¥è¯†ç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>Implement Trie (Prefix Tree)</td>
<td>å®ç° Trieçš„insertã€searchã€prefixï¼ˆåˆ¤æ–­æ˜¯å¦æ˜¯å‰ç¼€ï¼‰</td>
<td>Trie</td>
</tr>
<tr>
<td>Add and Search Word - Data structure design</td>
<td>å®ç°strçš„addä¸searchï¼Œå…¶ä¸­strâ€™.â€™ä»£è¡¨ä»»æ„å­—ç¬¦</td>
<td>Trie</td>
</tr>
<tr>
<td>Top K Frequent Words</td>
<td>ç»™ä¸€ç»„str[]ï¼Œç»Ÿè®¡é¢‘ç‡æœ€é«˜çš„kä¸ªstr</td>
<td>Trie+HashHeap</td>
</tr>
<tr>
<td>Map Sum Pairs</td>
<td>å®ç°insert(str,val)å’Œsum(str)ï¼Œä½¿å¾—sum(str)èƒ½è¾“å‡ºä»¥strä¸ºå‰ç¼€çš„æ‰€æœ‰å•è¯çš„ä»·å€¼å’Œ</td>
<td>Trie</td>
</tr>
<tr>
<td>Word Search</td>
<td>ç»™<code>char[][] board</code>å’Œstr wordã€‚åˆ¤æ–­wordæ˜¯å¦è¢«åŒ…å«åœ¨boardä¸­</td>
<td>DFS</td>
</tr>
<tr>
<td>Word Search II</td>
<td>ç»™<code>char[][] board</code>å’Œstr[] wordsã€‚ä»wordsä¸­æ‰¾åˆ°è¢«åŒ…å«åœ¨boardä¸­çš„å•è¯</td>
<td>Trie+DFS</td>
</tr>
<tr>
<td>Replace Words</td>
<td>ç»™ä¸€ä¸ªè¯æ ¹è¡¨<code>str[] dict = [&quot;cat&quot;, &quot;bat&quot;, &quot;rat&quot;]</code> ï¼Œå’Œsentence = â€œthe cattle was rattled by the batteryâ€<code>ã€‚æ›¿æ¢å¥å­ä¸º</code>â€œthe cat was rat by the batâ€`</td>
<td>Trie+Stringçš„æ“ä½œ</td>
</tr>
<tr>
<td>Number of Islands</td>
<td>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…ƒç´ ä¸º1/0ã€‚åˆ¤æ–­å²›å±¿çš„ä¸ªæ•°</td>
<td>å¹¶æŸ¥é›†/dfs</td>
</tr>
<tr>
<td>Number of Islands II</td>
<td>ä¸Šé¢˜äºŒç»´æ•°æ®æ”¹æˆåŠ¨æ€çš„</td>
<td>å¹¶æŸ¥é›†</td>
</tr>
<tr>
<td>Graph Valid Tree</td>
<td>ç»™ä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯ä¸€æ£µæ ‘</td>
<td>å¹¶æŸ¥é›†</td>
</tr>
<tr>
<td>Number of Connected Components in an Undirected Graph</td>
<td>ç»™ä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œåˆ¤æ–­æœ‰å‡ ä¸ªè”é€šå—</td>
<td>å¹¶æŸ¥é›†</td>
</tr>
<tr>
<td>Friend Circles</td>
<td>æœ‰nä¸ªäººï¼ŒçŸ©é˜µMè¡¨ç¤ºnä¸ªäººäº’ç›¸çš„å…³ç³»ã€‚æ±‚è¿™nä¸ªäººä¸€å…±æœ‰å¤šå°‘ä¸ªæœ‹å‹åœˆ</td>
<td>å¹¶æŸ¥é›†</td>
</tr>
<tr>
<td>Surrounded Regions</td>
<td>ç»™ä¸€ä¸ªçŸ©é˜µï¼Œé‡Œé¢å…ƒç´ æ˜¯Xæˆ–Oã€‚å¦‚æœä¸€ä¸ªOçš„è¿é€šå—è¢«Xå®Œå…¨å›´ä½ï¼Œå°±å°†Oå…¨éƒ¨æ”¹æˆXã€‚è¾“å‡ºæ”¹ä¹‹åçš„çŸ©é˜µ</td>
<td>å¹¶æŸ¥é›†/dfs</td>
</tr>
<tr>
<td>Redundant Connection</td>
<td>ç»™ä¸€ä¸ªæ— å‘è¿é€šå›¾ã€‚è¦ä»ä¸­å–å‡ºä¸€æ¡è¾¹ï¼Œä½¿å¾—å®ƒæˆä¸ºä¸€æ£µæ ‘ã€‚ å¦‚æœæœ‰å¤šä¸ªè§£ï¼Œè¾“å‡ºinputä¸­æœ€åä¸€ä¸ªå‡ºç°çš„è¾¹</td>
<td>å¹¶æŸ¥é›†</td>
</tr>
<tr>
<td>Longest Consecutive Sequence</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„int[] nums = {100,4,200,1,3,2}ï¼Œè¾“å‡ºè¿ç»­æ•°å­—çš„æœ€å¤§ä¸ªæ•°â€”â€”4</td>
<td>å¹¶æŸ¥é›†/å…ˆsortåéå†</td>
</tr>
<tr>
<td>Top K Frequent Elements</td>
<td>ç»™ä¸€ä¸ªint[],è¾“å‡ºé¢‘ç‡æœ€é«˜çš„kä¸ªæ•°å­—</td>
<td>å †</td>
</tr>
<tr>
<td>â˜…Kth Smallest Element in a Sorted Matrix</td>
<td>ç»™ä¸€ä¸ª <em>n</em> x <em>n</em>çš„æ•°ç»„ï¼Œè¡Œåˆ—éƒ½æœ‰åºï¼ˆå³<code>A[i][j]&lt;A[i+1][j]ä¸”A[i][j]&lt;A[i][j+1]</code>ï¼‰ã€‚æ‰¾åˆ°ç¬¬Kå°çš„å…ƒç´ </td>
<td>å †/äºŒåˆ†</td>
</tr>
<tr>
<td>Find K Pairs with Smallest Sums</td>
<td>ç»™å®šä¸¤ä¸ªæ•°ç»„nums1å’Œnums2ï¼Œæ‰¾åˆ°nums1[i] + nums2[i] çš„ä»æœ€å°åˆ°ç¬¬kå°çš„å¯¹(i,j)</td>
<td>å †</td>
</tr>
<tr>
<td>â˜…Merge k Sorted Lists</td>
<td>ç»™äº†kä¸ªé“¾è¡¨ListNode[k] listsã€‚æ¯ä¸ªé“¾è¡¨éƒ½å·²æ’åºã€‚å°†è¿™kä¸ªé“¾è¡¨mergeä¸ºä¸€ä¸ªæœ‰åºé“¾è¡¨</td>
<td>å †ï¼ˆæ³¨æ„å°†listNodeè§†ä¸ºæ•´ä½“çš„æŠ€å·§ï¼‰/ é“¾è¡¨åˆ†æ²»</td>
</tr>
<tr>
<td>Design Twitter</td>
<td>è®¾è®¡ä¸€ä¸ªtwitterç±»ï¼Œå®ç°å‘å¾®åšã€å…³æ³¨ã€å–å…³ï¼Œæ‹‰å–å…³æ³¨å¥½å‹åˆ—è¡¨çš„æœ€è¿‘10æ¡ä¿¡æ¯æµ</td>
<td>å †ï¼ˆä¸ä¸Šä¸€é¢˜ä¸€ä¸ªæŠ€å·§ï¼‰</td>
</tr>
<tr>
<td>â¤Split Array into Consecutive Subsequences</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„<code>[1,2,3,3,4,5]</code>ï¼Œé—®å®ƒèƒ½ä¸èƒ½åˆ†æˆå¤šä¸ªé•¿åº¦å¤§äº3çš„è¿ç»­å­æ•°ç»„[1,2,3]å’Œ[3,4,5]</td>
<td>HashMap+å †</td>
</tr>
<tr>
<td>â–²The Skyline Problem</td>
<td>é¢˜æ„ï¼šç»™ä¸€äº›å¤§æ¥¼<code>int[][] build</code>ï¼Œæ¯ä¸ªæ¥¼æ˜¯ä¸‰å…ƒç»„[left,right,h]ã€‚æ±‚è¿™äº›å¤§æ¥¼çš„å…³é”®ç‚¹</td>
<td>å †</td>
</tr>
<tr>
<td>Trapping Rain Water</td>
<td>Given <code>[0,1,0,2,1,0,1,3,2,1,2,1]</code>,è¾“å‡ºå®ƒèƒ½ä¹˜çš„æœ€å¤§é›¨æ°´æ•°é‡ <code>6</code></td>
<td>åŒæŒ‡é’ˆ</td>
</tr>
<tr>
<td>Trapping Rain Water II</td>
<td>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå‡è®¾è¿™æ˜¯ä¸€ä¸ªå°å­ã€‚è¾¹ç•Œæ²¡æœ‰æŒ¡æ¿ã€‚æ±‚é—®è¿™ä¸ªå°å­æœ€å¤šèƒ½ä¹˜å¤šå°‘é›¨æ°´</td>
<td>å †</td>
</tr>
<tr>
<td>â˜…Sort Characters By Frequency</td>
<td>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²â€treeâ€ï¼ŒæŒ‰ç…§å­—æ¯é¢‘ç‡è¾“å‡ºâ€œeetrâ€æˆ–â€eertâ€</td>
<td>HashMapçš„æ’åº/<strong>æ¡¶æ’åº</strong>/å †</td>
</tr>
<tr>
<td>â˜…Maximum Subarray</td>
<td>è¾“å‡ºæ•°ç»„çš„è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</td>
<td>DP</td>
</tr>
<tr>
<td>Triangle</td>
<td>ç»™ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæ‰¾åˆ°ä»ä¸Šåˆ°ä¸‹æœ€çŸ­è·¯å¾„å’Œ</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Climbing Stairs</td>
<td>æœ‰ä¸€ä¸ªæ¥¼æ¢¯ï¼Œä¸€æ­¥åªèƒ½è·¨1/2æ­¥ã€‚é—®ä»0èµ°åˆ°nå±‚æœ‰å¤šå°‘å±‚æ–¹æ¡ˆ</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Unique Paths</td>
<td>mÃ—næ ¼å­ï¼Œä»å·¦ä¸Šèµ°åˆ°å³ä¸‹ï¼Œæœ‰å¤šå°‘ç§èµ°æ³•ï¼ˆåªèƒ½å‘ä¸‹æˆ–å‘å³èµ°ï¼‰</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Unique Paths II</td>
<td>æ ¼å­é‡Œå¯èƒ½æœ‰éšœç¢ç‰©ï¼Œè¿˜æœ‰å¤šå°‘ç§èµ°æ³•</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Minimum Path Sum</td>
<td>æ‰¾åˆ°è·¯å¾„æƒé‡æœ€å°çš„è·¯</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Jump Game</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„A,<code>A[i]</code>è¡¨ç¤ºåœ¨è¿™é‡Œæ—¶æœ€å¤šå¯ä»¥è·³<code>A[i]</code>æ­¥ã€‚åªèƒ½å‘å‰è·³ã€‚ä»æ•°ç»„Açš„ç¬¬0ä½ç½®å‡ºå‘ï¼Œèƒ½ä¸èƒ½è·³åˆ°æœ«å°¾</td>
<td>åæ ‡DP/è´ªå¿ƒ</td>
</tr>
<tr>
<td>Jump Game II</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„A,<code>A[i]</code>è¡¨ç¤ºåœ¨è¿™é‡Œæ—¶æœ€å¤šå¯ä»¥è·³<code>A[i]</code>æ­¥ã€‚åªèƒ½å‘å‰è·³ã€‚ä»æ•°ç»„Açš„ç¬¬0ä½ç½®å‡ºå‘ï¼Œé—®æœ€å°‘çš„è·³çš„æ¬¡æ•°ã€‚</td>
<td>åæ ‡DP/è´ªå¿ƒ</td>
</tr>
<tr>
<td>Longest Increasing Subsequence</td>
<td>æ±‚æœ€é•¿ä¸¥æ ¼é€’å¢çš„å­åºåˆ—ï¼ˆå­åºåˆ—ï¼šå¯ä»¥è·³ç€é€‰ï¼‰</td>
<td>åæ ‡DP/äºŒåˆ†</td>
</tr>
<tr>
<td>Arithmetic Slices</td>
<td>ç»™ä¸€ä¸ªåºåˆ—ã€‚æ±‚è¿™ä¸ªåºåˆ—æœ‰å¤šå°‘ä¸ªç­‰å·®æ•°åˆ—ï¼ˆè‡³å°‘ä¸‰ä¸ªå…ƒç´ æ‰ç®—ç­‰å·®æ•°åˆ—ï¼‰</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>Perfect Squares</td>
<td>ç»™ä¸€ä¸ªæ•°å­—ï¼Œæ±‚å®ƒè¢«æ‹†æˆå¹³æ–¹å’Œçš„æœ€å°‘å¹³æ–¹å’Œä¸ªæ•°</td>
<td>åæ ‡DP</td>
</tr>
<tr>
<td>â˜…Maximal Square</td>
<td>ç»™ä¸€ä¸ª0/1çŸ©é˜µã€‚æ‰¾åˆ°æœ€å¤§å…¨1æ–¹é˜µï¼Œè¿”å›æ–¹é˜µå…ƒç´ ä¸ªæ•°</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>â˜…Best Time to Buy and Sell Stock</td>
<td>ç»™ä¸€ä¸ªint[] pricesè¡¨ç¤ºè‚¡ç¥¨ä»·æ ¼ã€‚æ±‚å‡ºæœ€å¥½çš„ä¹°å–æ–¹å¼çš„é’±</td>
<td>DP</td>
</tr>
<tr>
<td>â˜…Word Break</td>
<td>ç»™ä¸€ä¸ªstr så’Œä¸€ä¸ªstr[] dictï¼Œåˆ¤æ–­sæ˜¯å¦èƒ½è¢«dictä¸­çš„å•è¯ç»„æˆ</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>Palindrome Partitioning II</td>
<td>ä¸€ä¸ªstræœ€å°‘è¢«åˆ‡å‰²å‡ æ¬¡å¯ä»¥åˆ‡å‰²ä¸ºéƒ½æ˜¯å›æ–‡ä¸²</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>House Robber</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„<code>int[] nums</code>ï¼Œè¡¨ç¤ºæ¯ä¸ªå•†åº—çš„ä»·å€¼ã€‚è¦æŠ¢åŠ«ï¼Œä½†æŠ¢åŠ«æ—¶å¿…é¡»è‡³å°‘éš”ä¸€ä¸ªå•†é“ºæŠ¢ã€‚é—®èƒ½æŠ¢åˆ°çš„æœ€å¤§ä»·å€¼</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>House Robber II</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„<code>int[] nums</code>ï¼Œè¡¨ç¤ºæ¯ä¸ªå•†åº—çš„ä»·å€¼ã€‚å•†åº—æ˜¯æˆç¯çš„ï¼Œå³é¦–å°¾ç›¸æ¥ã€‚è¦æŠ¢åŠ«ï¼Œä½†æŠ¢åŠ«æ—¶å¿…é¡»è‡³å°‘éš”ä¸€ä¸ªå•†é“ºæŠ¢ã€‚é—®èƒ½æŠ¢åˆ°çš„æœ€å¤§ä»·å€¼ã€‚</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>Paint House</td>
<td>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„<code>cost[][]</code>ï¼Œå¤§å°ä¸ºnÃ—3ã€‚å…¶ä¸­<code>cost[i][q]</code>è¡¨ç¤ºç¬¬iä¸ªæˆ¿å­æ¶‚ä¸Šç¬¬qç§é¢œè‰²æ—¶çš„é€ ä»·ã€‚ä¸€å…±æœ‰3ç§é¢œè‰²ã€‚è¦æ±‚ä¸¤ä¸ªç›¸é‚»æˆ¿å­ä¸å¯ä»¥åŒè‰²ã€‚æ±‚æ¶‚è‰²æœ€å°é€ ä»·</td>
<td>å•åºåˆ—DP</td>
</tr>
<tr>
<td>Longest Common Subsequence</td>
<td>æœ€é•¿å…¬å…±å­åºåˆ—</td>
<td>åŒåºåˆ—DP</td>
</tr>
<tr>
<td>Edit Distance</td>
<td>å°†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æœ€å°‘æ”¹åŠ¨ï¼Œå˜æˆç¬¬äºŒä¸ªå­—ç¬¦ä¸²</td>
<td>åŒåºåˆ—DP</td>
</tr>
<tr>
<td>Distinct Subsequences</td>
<td>ä»S=â€rabbbitâ€æŒ‘å‡ºT = â€œrabbitâ€æœ‰å‡ ç§æŒ‘æ³•</td>
<td>åŒåºåˆ—DP</td>
</tr>
<tr>
<td>Interleaving String</td>
<td>ç»™äº†ä¸‰ä¸ªå­—ç¬¦ä¸²s1,s2,s3.åˆ¤æ–­s3æ˜¯å¦æ˜¯ç”±s1å’Œs2äº¤æ›¿ç»„æˆï¼ˆæŒ‰é¡ºåºï¼Œä¸”å¯äº¤æ›¿ç€æŒ‘ï¼‰</td>
<td>åŒåºåˆ—DP</td>
</tr>
<tr>
<td>Dungeon Game</td>
<td>è‹±é›„æ•‘ç¾ï¼šç»™ä¸€ä¸ªçŸ©é˜µ<code>int[][] dungegon</code>ï¼Œæ¯ä¸ªæ ¼å­æ­£æ•°ä»£è¡¨èƒ½é‡åŠ æˆï¼Œè´Ÿæ•°ä»£è¡¨å‡å¼±èƒ½é‡ã€‚è‹±é›„è¦ä»å·¦ä¸Šèµ°åˆ°å³ä¸‹ï¼Œè¦æ±‚æ¯ä¸€æ—¶åˆ»è‹±é›„çš„èƒ½é‡ä¸ä½äº1.é—®è‹±é›„åˆå§‹æ—¶æœ€å°‘éœ€è¦å¤šå°‘èƒ½é‡</td>
<td>åŒåºåˆ—DP</td>
</tr>
<tr>
<td>â–²<strong>Paint Fence</strong></td>
<td><a href="https://segmentfault.com/a/1190000003790650" target="_blank" rel="external">https://segmentfault.com/a/1190000003790650</a></td>
<td></td>
</tr>
<tr>
<td>â–²Ugly Number</td>
<td>ç»™ä¸€ä¸ªæ•°numï¼Œåˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯uglyæ•°â€”â€”å®ƒçš„è´¨å› æ•°åªèƒ½è¯´æ˜¯2ã€3ã€5</td>
<td>DP</td>
</tr>
<tr>
<td>â˜…Range Sum Query - Immutable</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„ï¼Œè¾“å‡ºæŒ‡å®šiï¼Œjä¹‹é—´çš„å’Œ</td>
<td>DP</td>
</tr>
<tr>
<td>â–²Word Break  II</td>
<td>ç»™ä¸€ä¸ªstr så’Œä¸€ä¸ªstr[] dict,è¾“å‡ºæ‰€æœ‰så¯èƒ½è¢«dictæ‹¼æ¥çš„ç»„åˆ</td>
<td>DFS</td>
</tr>
<tr>
<td>Binary Tree Preorder Traversal</td>
<td>å®ç°äºŒå‰æ ‘çš„å‰åºéå†</td>
<td>é€’å½’/æ ˆ</td>
</tr>
<tr>
<td>Binary Tree Inorder Traversal</td>
<td>å®ç°äºŒå‰æ ‘çš„ä¸­åºéå†</td>
<td>é€’å½’/æ ˆ</td>
</tr>
<tr>
<td>Validate Binary Search Tree</td>
<td>éªŒè¯ä¸€ä¸ªäºŒå‰æ ‘æ˜¯ä¸æ˜¯æœç´¢äºŒå‰æ ‘</td>
<td>ä¸­åºéå†</td>
</tr>
<tr>
<td>Find Mode in Binary Search Tree</td>
<td>ç»™ä¸€ä¸ªæœ‰é‡çš„BSTã€‚å…¶ä¸­å·¦å­æ ‘å°äºç­‰äºæœ¬èº«ï¼Œå³å­æ ‘å¤§äºæœ¬èº«ã€‚ç»Ÿè®¡æœ€å¤šæ¬¡æ•°å‡ºç°çš„æ•°å­—</td>
<td>BST + ä¸­åºéå†</td>
</tr>
<tr>
<td>Binary search Tree Iterator</td>
<td>æŒ‰ç…§ä¸­åºéå†æ–¹å¼å°†äºŒå‰æ ‘å…ƒç´ ä¸€ä¸ªä¸€ä¸ªè¾“å‡ºï¼ˆè¦ä¸€ä¸ªç»™ä¸€ä¸ªï¼‰</td>
<td>æ ˆçš„ä¸­åºéå†</td>
</tr>
<tr>
<td>Convert Sorted List to Binary Search Tree</td>
<td>å°†æœ‰åºé“¾è¡¨è½¬åŒ–ä¸ºå¹³è¡¡BST</td>
<td>ä¸­åº+é€’å½’+BST</td>
</tr>
<tr>
<td>Convert Sorted Array to Binary Search Tree</td>
<td>å°†æœ‰åºæ•°ç»„è½¬åŒ–ä¸ºå¹³è¡¡BST</td>
<td>ä¸­åº+äºŒåˆ†+BST</td>
</tr>
<tr>
<td>Kth Smallest Element in a BST</td>
<td>BSTä¸­ç¬¬Kå°çš„æ•°</td>
<td>ä¸­åº+BST</td>
</tr>
<tr>
<td>Delete Node in a BST</td>
<td>åˆ é™¤BSTä¸­æŸä¸ªèŠ‚ç‚¹</td>
<td>BST</td>
</tr>
<tr>
<td>Binary Tree Postorder Traversal</td>
<td>å®ç°äºŒå‰æ ‘çš„ååºéå†</td>
<td>é€’å½’/æ ˆ/åŒæ ˆ</td>
</tr>
<tr>
<td>Maximum Depth of Binary Tree</td>
<td>æ±‚äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</td>
<td>é€’å½’+åˆ†æ²»</td>
</tr>
<tr>
<td>Binary Tree Maximum Path Sum</td>
<td>ç»™ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾åˆ°ä»any node åˆ° any nodeæœ€å¤§è·¯å¾„å’Œã€‚è·¯å¾„å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«ç»“æŸæ‰</td>
<td>é€’å½’+åˆ†æ²»</td>
</tr>
<tr>
<td>Balanced Binary Tree</td>
<td>åˆ¤æ–­ä¸€ä¸ªæ ‘æ˜¯ä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘</td>
<td>é€’å½’+åˆ†æ²»</td>
</tr>
<tr>
<td>Lowest Common Ancestor</td>
<td>æ±‚ä¸€é¢—äºŒå‰æ ‘ä¸­ä¸¤ä¸ªç‚¹a,bçš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</td>
<td>é€’å½’+åˆ†æ²»</td>
</tr>
<tr>
<td>Binary Tree Level Order Traversal</td>
<td>è¾“å‡ºäºŒå‰æ ‘çš„å±‚åºéå†</td>
<td>é˜Ÿåˆ—</td>
</tr>
<tr>
<td>Binary Tree Level Order Traversal II</td>
<td>è¾“å‡ºäºŒå‰æ ‘çš„å±‚åºéå†ï¼Œè¦ä»ä¸‹å¾€ä¸Šè¾“å‡º</td>
<td>é˜Ÿåˆ—+LinkedList</td>
</tr>
<tr>
<td>Binary Search</td>
<td>ç»™ä¸€ä¸ªint[] nums,æ‰¾åˆ°targetç¬¬ä¸€æ¬¡å‡ºç°çš„indexã€‚æ²¡æ‰¾åˆ°å°±è¿”å›-1.</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Search for a range</td>
<td>ç»™ä¸€ä¸ªint[] nums = {5,7,7,8,8,10],æ‰¾åˆ°target=8å‡ºç°çš„èŒƒå›´[3,4]ã€‚æ²¡æ‰¾åˆ°å°±è¿”å›[-1,-1].</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Search Insert Position</td>
<td>ç»™ä¸€ä¸ªæœ‰åºæ— é‡æ•°ç»„nums = [1,3,5,6],æŠŠtarget=5æ’å…¥ï¼Œé—®æ’å…¥çš„ä½ç½®=2</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Search a 2D Matrix</td>
<td>ç»™ä¸€ä¸ªä¸¥æ ¼é€’å¢çš„çŸ©é˜µï¼Œå¯»æ‰¾æ˜¯å¦å­˜åœ¨target</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Search a 2D Matrix II</td>
<td>ç»™ä¸€ä¸ªéä¸¥æ ¼é€’å¢çš„çŸ©é˜µï¼Œå¯»æ‰¾æ˜¯å¦å­˜åœ¨target</td>
<td>å·§å¦™çš„éå†</td>
</tr>
<tr>
<td>First Bad Version</td>
<td>ä»£ç åº“çš„ç‰ˆæœ¬å·æ˜¯ä» 1 åˆ° <em>n</em> çš„æ•´æ•°ã€‚æŸä¸€å¤©ï¼Œæœ‰äººæäº¤äº†é”™è¯¯ç‰ˆæœ¬çš„ä»£ç ï¼Œå› æ­¤é€ æˆè‡ªèº«åŠä¹‹åç‰ˆæœ¬çš„ä»£ç åœ¨å•å…ƒæµ‹è¯•ä¸­å‡å‡ºé”™ã€‚è¯·æ‰¾å‡ºç¬¬ä¸€ä¸ªé”™è¯¯çš„ç‰ˆæœ¬å·</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Find Peak Element</td>
<td>ç»™ä¸€ä¸ªæ•°ç»„ã€‚æ‰¾å³°å€¼ã€‚ç›¸é‚»ä¸¤ä¸ªæ•°éƒ½ä¸ä¸€æ ·ã€‚å¦‚æœæœ‰å¤šä¸ªå³°å€¼ï¼Œå°±éšä¾¿è¾“å‡ºä¸€ä¸ª</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Find Minimum in rotated sorted array</td>
<td>æ‰¾æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­çš„æœ€å°å€¼ã€‚æ•°ç»„ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ </td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Find Minimum in rotated sorted array II</td>
<td>æ‰¾æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­çš„æœ€å°å€¼ã€‚æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ </td>
<td>éå†/äºŒåˆ†</td>
</tr>
<tr>
<td>Search in Rotated Sorted Array</td>
<td>ä»æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­æ‰¾targetã€‚æ•°ç»„ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ </td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Search in Rotated Sorted Array II</td>
<td>ä»æœ‰åºæ—‹è½¬æ•°ç»„ï¼ˆé¦–ä½ç›¸æ¥ï¼‰ä¸­æ‰¾targetã€‚æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ ã€‚</td>
<td>éå†/äºŒåˆ†</td>
</tr>
<tr>
<td>Median of two Sorted Arrays</td>
<td>æ‰¾åˆ°ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°</td>
<td>äºŒåˆ†</td>
</tr>
<tr>
<td>Remove Duplicates from Sorted List</td>
<td>å°†æœ‰åºé“¾è¡¨å»é‡</td>
<td>é“¾è¡¨</td>
</tr>
<tr>
<td>Remove Duplicates from Sorted List II</td>
<td>å°†æœ‰åºé“¾è¡¨ä¸­çš„å…¨éƒ¨é‡å¤å…ƒç´ åˆ é™¤</td>
<td>é“¾è¡¨+dummy</td>
</tr>
<tr>
<td>Remove Linked List Elements</td>
<td>åˆ é™¤é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹</td>
<td>é“¾è¡¨+dummy</td>
</tr>
<tr>
<td>Reverse Linked List</td>
<td>å°†é“¾è¡¨åè½¬</td>
<td>é“¾è¡¨</td>
</tr>
<tr>
<td>Reverse Linked List II</td>
<td>å°†ä¸€ä¸ªé“¾è¡¨çš„måˆ°nåè½¬</td>
<td>é“¾è¡¨+dummy</td>
</tr>
<tr>
<td>Reverse Nodes in k-Group</td>
<td>å°†é“¾è¡¨æŒ‰ç…§kå¤§å°çš„ç»„ï¼Œåè½¬ã€‚å¦‚æœæœ€åä¸å¤Ÿkä¸ªï¼Œåˆ™ä¿æŒåŸæ ·</td>
<td>é“¾è¡¨+dummy</td>
</tr>
<tr>
<td>Partition List</td>
<td>è¦æ±‚æŠŠå°äºxçš„å…ƒç´ æ”¾åˆ°é“¾è¡¨å‰é¢</td>
<td>é“¾è¡¨+dummy</td>
</tr>
<tr>
<td>Sort List</td>
<td>ç”¨O(nlogn)çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦æ’åºé“¾è¡¨</td>
<td>é“¾è¡¨+å–ä¸­ç‚¹+å¿«æ’/å½’å¹¶</td>
</tr>
<tr>
<td>Reorder List</td>
<td>å°†é“¾è¡¨ <em>L</em>0â†’<em>L</em>1â†’â€¦â†’<em>L</em>n-1â†’<em>L</em>n, é‡æ’åºä¸º<em>L</em>0â†’<em>L**n</em>â†’<em>L</em>1â†’<em>L**n</em>-1â†’<em>L</em>2â†’<em>L**n</em>-2â†’â€¦</td>
<td>é“¾è¡¨+å–ä¸­ç‚¹+åè½¬</td>
</tr>
<tr>
<td>Linked List Cycle</td>
<td>åˆ¤æ–­é“¾è¡¨é‡Œæœ‰æ²¡æœ‰ç¯å½¢</td>
<td>é“¾è¡¨+fast-slow</td>
</tr>
<tr>
<td>Linked List Cycle II</td>
<td>å¦‚æœæœ‰ç¯ï¼Œæ‰¾åˆ°ç¯çš„å…¥å£</td>
<td>é“¾è¡¨+fast-slow</td>
</tr>
<tr>
<td>Rotate List</td>
<td>å°†é“¾è¡¨å¾ªç¯ç§»åŠ¨kä¸ª</td>
<td>é“¾è¡¨+fast-slow</td>
</tr>
<tr>
<td>Merge k Sorted Lists</td>
<td>å°†kä¸ªæœ‰åºé“¾è¡¨åˆå¹¶</td>
<td>å †+é“¾è¡¨</td>
</tr>
<tr>
<td>Delete Node in a Linked List</td>
<td>ä»é“¾è¡¨ä¸­åˆ é™¤æŸä¸ªNode</td>
<td>ç¥å¥‡çš„åç§»</td>
</tr>
<tr>
<td>Palindrome Linked List</td>
<td>åˆ¤æ–­ä¸€ä¸ªlistæ˜¯ä¸æ˜¯å›æ–‡ä¸²</td>
<td>é“¾è¡¨åè½¬</td>
</tr>
<tr>
<td>Odd Even Linked List</td>
<td>å°†é“¾è¡¨çš„å¥‡æ•°ä½æ”¾å‰é¢ï¼Œå¶æ•°ä½æ”¾åé¢</td>
<td>é“¾è¡¨</td>
</tr>
<tr>
<td>Split Linked List in Parts</td>
<td>å°†ä¸€ä¸ªé“¾è¡¨åˆ†ä¸ºkä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†çš„é•¿åº¦å·®ä¸å¾—è¶…è¿‡1ï¼Œä¸”å‰é¢çš„é•¿åº¦ä¸å¾—å°äºåé¢çš„é•¿åº¦</td>
<td>é“¾è¡¨</td>
</tr>
<tr>
<td>Insertion Sort List</td>
<td>å®ç°é“¾è¡¨çš„æ’å…¥æ’åº</td>
<td>é“¾è¡¨</td>
</tr>
<tr>
<td>Copy List with Random Pointer</td>
<td>æ·±æ‹·è´ä¸€ä¸ªå¸¦æœ‰randomæŒ‡é’ˆçš„é“¾è¡¨</td>
<td>é“¾è¡¨+ä¸‰æ­¥èµ°</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-ä¹ç« æ¨¡æ¿æ€»ç»“]]></title>
      <url>/2017/11/14/%E7%AE%97%E6%B3%95-%E4%B9%9D%E7%AB%A0%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<ol>
<li><a href="http://www.jiuzhang.com/solutions/implement-trie/" target="_blank" rel="external">Trieæ ‘</a></li>
<li><a href="https://www.jiuzhang.com/solution/heapify/" target="_blank" rel="external">å †</a></li>
<li><a href="https://www.jiuzhang.com/solution/hashheap/" target="_blank" rel="external">hashå †</a></li>
<li><a href="http://www.jiuzhang.com/solution/number-of-islands/" target="_blank" rel="external">å¹¶æŸ¥é›†</a></li>
<li><a href="http://www.jiuzhang.com/solution/number-of-airplanes-in-the-sky/" target="_blank" rel="external">æ‰«æçº¿</a></li>
<li><a href="http://www.jiuzhang.com/solutions/?search=" target="_blank" rel="external">leetcodeé¢˜è§£æ¨¡æ¿</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Java-Comparableæ¥å£]]></title>
      <url>/2017/11/13/Java-Compareable%E6%8E%A5%E5%8F%A3/</url>
      <content type="html"><![CDATA[<p>Arraysç±»ä¸­çš„sortæ–¹æ³•å¯ä»¥å¯¹å¯¹è±¡æ•°ç»„è¿›è¡Œæ’åºã€‚ä½†å‰ææ˜¯å¯¹è±¡æ‰€å±çš„ç±»å¿…é¡»å®ç°äº†Comparableæ¥å£ã€‚</p>
<p><strong>æ¥å£ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Comparable</span></span>&#123;</div><div class="line">  <span class="function"><span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object other)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†è®©æŸä¸ªç±»å®ç°ä»¥ä¸ŠComparableæ¥å£ï¼Œé€šå¸¸éœ€è¦ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å°†ç±»å£°æ˜ä¸ºå®ç°ç»™å®šçš„æ¥å£ï¼›</li>
<li>å¯¹æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œå®šä¹‰ã€‚</li>
</ol>
<a id="more"></a>
<p><strong>ä¾‹å­</strong></p>
<p>è¿™ä¸ªNodeå†…æœ‰ä¸¤ä¸ªå˜é‡ï¼škeyå’Œcountã€‚å¦‚æœæˆ‘ä»¬æƒ³é€šè¿‡countæ¥å®šä¹‰å¤§å°çš„è¯ï¼Œæˆ‘ä»¬è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">  <span class="keyword">int</span> key;</div><div class="line">  <span class="keyword">int</span> count;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.count &gt; o.count)&#123;</div><div class="line">      <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.count == o.count)&#123;</div><div class="line">      <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="String-çš„compareTo">1. String çš„compareTo</h1><p>å¦‚æœè¦æ¯”è¾ƒå­—ç¬¦ä¸²çš„å­—å…¸é¡ºåºï¼Œé‚£å°±ä½¿ç”¨ï¼š </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s1 = <span class="string">"ab"</span>;</div><div class="line">s2 = <span class="string">"ac"</span>;</div><div class="line">s1.compareTo(s2); <span class="comment">//return -1,s1åœ¨s2å‰</span></div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Comparable </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-Trieæ ‘]]></title>
      <url>/2017/11/13/%E7%AE%97%E6%B3%95-Trie%E6%A0%91/</url>
      <content type="html"><![CDATA[<p>Trieæ ‘ï¼Œå³å­—å…¸æ ‘/å‰ç¼€æ ‘ï¼Œåˆç§°å•è¯æŸ¥æ‰¾æ ‘æˆ–é”®æ ‘ï¼Œæ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ã€‚å…¸å‹åº”ç”¨æ˜¯ç”¨äºç»Ÿè®¡å’Œæ’åºå¤§é‡çš„å­—ç¬¦ä¸²ï¼ˆä½†ä¸ä»…é™äºå­—ç¬¦ä¸²ï¼‰ï¼Œæ‰€ä»¥ç»å¸¸è¢«æœç´¢å¼•æ“ç³»ç»Ÿç”¨äºæ–‡æœ¬è¯é¢‘ç»Ÿè®¡ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯æœ€å¤§é™åº¦åœ°å‡å°‘æ— è°“çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒé«˜ã€‚</p>
<p>Trieçš„æ ¸å¿ƒæ€æƒ³æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥é™ä½æŸ¥è¯¢æ—¶é—´çš„å¼€é”€ä»¥è¾¾åˆ°æé«˜æ•ˆç‡çš„ç›®çš„ã€‚</p>
<p>ä¾‹å¦‚æœ‰abc,abcd,abd,b,bcd,efg,hiiè¿™7ä¸ªå•è¯ï¼Œæˆ‘ä»¬æ„å»ºçš„æ ‘å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-09-44-44.png" alt="">  </p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»æ ¹éå†åˆ°ä»–çš„è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªå•è¯ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹è¢«æ ‡è®°ä¸ºçº¢è‰²ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªå•è¯å­˜åœ¨ï¼Œå¦åˆ™ä¸å­˜åœ¨ã€‚</p>
<a id="more"></a>
<p>â€‹    é‚£ä¹ˆï¼Œå¯¹äºä¸€ä¸ªå•è¯ï¼Œæˆ‘åªè¦é¡ºç€ä»–ä»æ ¹èµ°åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œå†çœ‹è¿™ä¸ªèŠ‚ç‚¹æ˜¯å¦è¢«æ ‡è®°ä¸ºçº¢è‰²å°±å¯ä»¥çŸ¥é“å®ƒæ˜¯å¦å‡ºç°è¿‡äº†ã€‚æŠŠè¿™ä¸ªèŠ‚ç‚¹æ ‡è®°ä¸ºçº¢è‰²ï¼Œå°±ç›¸å½“äºæ’å…¥äº†è¿™ä¸ªå•è¯ã€‚</p>
<p>â€‹    è¿™æ ·ä¸€æ¥æˆ‘ä»¬<strong>æŸ¥è¯¢å’Œæ’å…¥å¯ä»¥ä¸€èµ·å®Œæˆ</strong>ï¼ˆé‡ç‚¹ä½“ä¼šè¿™ä¸ªæŸ¥è¯¢å’Œæ’å…¥æ˜¯å¦‚ä½•ä¸€èµ·å®Œæˆçš„ï¼Œç¨åï¼Œä¸‹æ–‡å…·ä½“è§£é‡Šï¼‰ï¼Œæ‰€ç”¨æ—¶é—´ä»…ä»…ä¸ºå•è¯é•¿åº¦ï¼Œåœ¨è¿™ä¸€ä¸ªæ ·ä¾‹ï¼Œä¾¿æ˜¯10ã€‚<br>â€‹    æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œtrieæ ‘æ¯ä¸€å±‚çš„èŠ‚ç‚¹æ•°æ˜¯26^içº§åˆ«çš„ã€‚æ‰€ä»¥ä¸ºäº†èŠ‚çœç©ºé—´ã€‚æˆ‘ä»¬ç”¨åŠ¨æ€é“¾è¡¨ï¼Œæˆ–è€…ç”¨æ•°ç»„æ¥æ¨¡æ‹ŸåŠ¨æ€ã€‚ç©ºé—´çš„èŠ±è´¹ï¼Œä¸ä¼šè¶…è¿‡å•è¯æ•°Ã—å•è¯é•¿åº¦ã€‚</p>
<p>å®ƒæœ‰3ä¸ªåŸºæœ¬æ€§è´¨ï¼š</p>
<ol>
<li>æ ¹èŠ‚ç‚¹ä¸åŒ…å«å­—ç¬¦ï¼Œé™¤æ ¹èŠ‚ç‚¹å¤–æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åªåŒ…å«ä¸€ä¸ªå­—ç¬¦ã€‚</li>
<li>ä»æ ¹èŠ‚ç‚¹åˆ°æŸä¸€èŠ‚ç‚¹ï¼Œè·¯å¾„ä¸Šç»è¿‡çš„å­—ç¬¦è¿æ¥èµ·æ¥ï¼Œä¸ºè¯¥èŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚</li>
<li>æ¯ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹åŒ…å«çš„å­—ç¬¦éƒ½ä¸ç›¸åŒã€‚</li>
</ol>
<h1 id="å®ç°">1. å®ç°</h1><h2 id="HashMapæ–¹å¼">1.1. HashMapæ–¹å¼</h2><p>è¿™æ˜¯æ€»å®¹æ˜“æƒ³åˆ°çš„æ–¹å¼ã€‚æ¯ä¸ªTrieNodeèŠ‚ç‚¹çš„å½¢çŠ¶å¦‚è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>boolean</th>
<th>HashMap<char,trienode></char,trienode></th>
</tr>
</thead>
<tbody>
<tr>
<td>hasWord</td>
<td>children</td>
</tr>
</tbody>
</table>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Character,Trie&gt; children ;</div><div class="line"><span class="keyword">boolean</span> hasWord;</div><div class="line"><span class="comment">/*åˆå§‹åŒ–*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Trie</span><span class="params">()</span></span>&#123;</div><div class="line">  children = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">  hasWord = <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*æ’å…¥ä¸€ä¸ªè¯*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String word)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> length = word.length();</div><div class="line">  Trie root = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">char</span> c;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">    c = word.charAt(i);</div><div class="line">    <span class="keyword">if</span>(!root.children.containsKey(c))&#123;</div><div class="line">      root.children.put(c,<span class="keyword">new</span> Trie());</div><div class="line">    &#125;</div><div class="line">    root = root.children.get(c);</div><div class="line">  &#125;</div><div class="line">  root.hasWord = <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*æŸ¥æ‰¾*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">search</span><span class="params">(String word)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> length = word.length();</div><div class="line">  Trie root = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">char</span> c;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">    c = word.charAt(i);</div><div class="line">    <span class="keyword">if</span>(root.children.containsKey(c))&#123;</div><div class="line">      root = root.children.get(c);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(root.hasWord)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*è¿”å›prefixæ˜¯å¦æ˜¯æ ‘ä¸­æŸä¸ªå•è¯çš„å‰ç¼€*/</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">startsWith</span><span class="params">(String prefix)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> length = prefix.length();</div><div class="line">  Trie root = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">char</span> c;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">    c = prefix.charAt(i);</div><div class="line">    <span class="keyword">if</span>(root.children.containsKey(c))&#123;</div><div class="line">      root = root.children.get(c);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„æ–¹å¼">1.2. æ•°ç»„æ–¹å¼</h2><p>ç”±äºå­—æ¯ä¸€å…±å°±26ä¸ªã€‚æ‰€ä»¥å¯ä»¥æ˜ å°„çš„æ–¹å¼å°†å­—æ¯æ˜ å°„åˆ°é•¿åº¦ä¸º26çš„æ•°ç»„ä¸Šï¼Œè€Œä¸‹æ ‡å°±æ˜¯å­—æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span> </span>&#123;</div><div class="line">        TrieNode[] next;</div><div class="line">        <span class="keyword">boolean</span> isWord;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TrieNode</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.next = <span class="keyword">new</span> TrieNode[<span class="number">26</span>];</div><div class="line">            <span class="keyword">this</span>.isWord = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    TrieNode root;</div><div class="line">    </div><div class="line">    <span class="comment">/** Initialize your data structure here. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Trie</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.root = <span class="keyword">new</span> TrieNode();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/** Inserts a word into the trie. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String word)</span> </span>&#123;</div><div class="line">        TrieNode cur = <span class="keyword">this</span>.root;</div><div class="line">        <span class="keyword">char</span>[] w = word.toCharArray(); <span class="comment">// è¿™æ˜¯ä¸ªéªšæ“ä½œï¼Œå°†strè½¬åŒ–ä¸ºchar[]</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; word.length(); i++) &#123;</div><div class="line">            <span class="keyword">if</span>(cur.next[w[i]-<span class="string">'a'</span>]==<span class="keyword">null</span>) &#123;</div><div class="line">                cur.next[w[i]-<span class="string">'a'</span>] = <span class="keyword">new</span> TrieNode();</div><div class="line">            &#125;</div><div class="line">            cur = cur.next[w[i]-<span class="string">'a'</span>];</div><div class="line">        &#125;</div><div class="line">        cur.isWord = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/** Returns if the word is in the trie. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">search</span><span class="params">(String word)</span> </span>&#123;</div><div class="line">        <span class="comment">// return startsWith(word) &amp;&amp; </span></div><div class="line">        <span class="keyword">char</span>[] w = word.toCharArray();</div><div class="line">        TrieNode cur = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; word.length(); i++) &#123;</div><div class="line">            <span class="keyword">if</span>(cur.next[w[i]-<span class="string">'a'</span>]==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            cur = cur.next[w[i]-<span class="string">'a'</span>];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> cur.isWord;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/** Returns if there is any word in the trie that starts with the given prefix. */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">startsWith</span><span class="params">(String prefix)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(prefix.length()==<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">char</span>[] word = prefix.toCharArray();</div><div class="line">        TrieNode cur = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; prefix.length(); i++) &#123;</div><div class="line">            <span class="keyword">if</span>(cur.next[word[i]-<span class="string">'a'</span>]==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            cur = cur.next[word[i]-<span class="string">'a'</span>];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="é—®é¢˜å®ä¾‹">2. é—®é¢˜å®ä¾‹</h1><p><strong>1ã€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå¤§çº¦æœ‰ä¸€ä¸‡è¡Œï¼Œæ¯è¡Œä¸€ä¸ªè¯ï¼Œè¦æ±‚ç»Ÿè®¡å‡ºå…¶ä¸­æœ€é¢‘ç¹å‡ºç°çš„å‰10ä¸ªè¯ï¼Œè¯·ç»™å‡ºæ€æƒ³ï¼Œç»™å‡ºæ—¶é—´å¤æ‚åº¦åˆ†æ</strong></p>
<p><strong>æç¤º</strong>ï¼šç”¨trieæ ‘ç»Ÿè®¡æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n<em>le)ï¼ˆleè¡¨ç¤ºå•è¯çš„å¹³å‡é•¿åº¦ï¼‰ï¼Œç„¶åæ˜¯æ‰¾å‡ºå‡ºç°æœ€é¢‘ç¹çš„å‰10ä¸ªè¯ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨å †æ¥å®ç°ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n</em>lg10)ã€‚æ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ˜¯O(n<em>le)ä¸O(n</em>lg10)ä¸­è¾ƒå¤§çš„å“ªä¸€ä¸ªã€‚</p>
<p><strong>2ã€å¯»æ‰¾çƒ­é—¨æŸ¥è¯¢</strong></p>
<p><strong>åŸé¢˜</strong>ï¼šæœç´¢å¼•æ“ä¼šé€šè¿‡æ—¥å¿—æ–‡ä»¶æŠŠç”¨æˆ·æ¯æ¬¡æ£€ç´¢ä½¿ç”¨çš„æ‰€æœ‰æ£€ç´¢ä¸²éƒ½è®°å½•ä¸‹æ¥ï¼Œæ¯ä¸ªæŸ¥è¯¢ä¸²çš„é•¿åº¦ä¸º1-255å­—èŠ‚ã€‚å‡è®¾ç›®å‰æœ‰ä¸€åƒä¸‡ä¸ªè®°å½•ï¼Œè¿™äº›æŸ¥è¯¢ä¸²çš„é‡å¤è¯»æ¯”è¾ƒé«˜ï¼Œè™½ç„¶æ€»æ•°æ˜¯1åƒä¸‡ï¼Œä½†æ˜¯å¦‚æœå»é™¤é‡å¤å’Œï¼Œä¸è¶…è¿‡3ç™¾ä¸‡ä¸ªã€‚ä¸€ä¸ªæŸ¥è¯¢ä¸²çš„é‡å¤åº¦è¶Šé«˜ï¼Œè¯´æ˜æŸ¥è¯¢å®ƒçš„ç”¨æˆ·è¶Šå¤šï¼Œä¹Ÿå°±è¶Šçƒ­é—¨ã€‚è¯·ä½ ç»Ÿè®¡æœ€çƒ­é—¨çš„10ä¸ªæŸ¥è¯¢ä¸²ï¼Œè¦æ±‚ä½¿ç”¨çš„å†…å­˜ä¸èƒ½è¶…è¿‡1Gã€‚</p>
<p><strong>æç¤º</strong>ï¼šåˆ©ç”¨trieæ ‘ï¼Œå…³é”®å­—åŸŸå­˜è¯¥æŸ¥è¯¢ä¸²å‡ºç°çš„æ¬¡æ•°ï¼Œæ²¡æœ‰å‡ºç°ä¸º0ã€‚æœ€åç”¨10ä¸ªå…ƒç´ çš„æœ€å°æ¨æ¥å¯¹å‡ºç°é¢‘ç‡è¿›è¡Œæ’åºã€‚</p>
<h1 id="ç›¸å…³leetcodeé¢˜">3. ç›¸å…³leetcodeé¢˜</h1><h2 id="Implement-Trie-Prefix-Tree">3.1. Implement Trie (Prefix Tree)</h2><p>å®ç°Trieæ ‘å³å¯ã€‚å¦‚ä¸Šä»£ç æ‰€ç¤ºã€‚ä¸åšè¿‡å¤šä»‹ç»ã€‚</p>
<h2 id="Add-and-Search-Word-Data-structure-design">3.2. Add and Search Word - Data structure design</h2><p>å®ç°å¦‚ä¸‹æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addWord</span><span class="params">(word)</span></span></div><div class="line">bool <span class="title">search</span><span class="params">(word)</span></div><div class="line">ä¾‹å¦‚ï¼š</div><div class="line"><span class="title">addWord</span><span class="params">(<span class="string">"bad"</span>)</span></div><div class="line"><span class="title">addWord</span><span class="params">(<span class="string">"dad"</span>)</span></div><div class="line"><span class="title">addWord</span><span class="params">(<span class="string">"mad"</span>)</span></div><div class="line"><span class="title">search</span><span class="params">(<span class="string">"pad"</span>)</span> -&gt; <span class="keyword">false</span></div><div class="line"><span class="title">search</span><span class="params">(<span class="string">"bad"</span>)</span> -&gt; <span class="keyword">true</span></div><div class="line"><span class="title">search</span><span class="params">(<span class="string">".ad"</span>)</span> -&gt; <span class="keyword">true</span></div><div class="line"><span class="title">search</span><span class="params">(<span class="string">"b.."</span>)</span> -&gt; <span class="keyword">true</span></div></pre></td></tr></table></figure>
<p>å³ï¼Œæ·»åŠ å­—ç¬¦ä¸²ã€‚å½“æŸ¥æ‰¾æ—¶ï¼Œâ€™.â€™å¯ä½œä¸ºé€šé…ç¬¦ã€‚</p>
<p>æ€è·¯ï¼šç”¨Trieæ ‘å³å¯ã€‚éœ€è¦æ³¨æ„é€šé…ç¬¦çš„ä½¿ç”¨ï¼Œéœ€è¦è¿›è¡Œä¾æ¬¡éå†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/13.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordDictionary</span> </span>&#123;</div><div class="line">    WordDictionary[] children;</div><div class="line">    <span class="keyword">boolean</span> hasWord;</div><div class="line">    <span class="comment">/*åˆå§‹åŒ–*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordDictionary</span><span class="params">()</span></span>&#123;</div><div class="line">        children = <span class="keyword">new</span> WordDictionary[<span class="number">27</span>];</div><div class="line">        hasWord = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*æ’å…¥ä¸€ä¸ªè¯*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addWord</span><span class="params">(String word)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> length = word.length();</div><div class="line">        WordDictionary root = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">int</span> pos;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">            pos = word.charAt(i) - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> == root.children[pos])&#123;</div><div class="line">                root.children[pos] = <span class="keyword">new</span> WordDictionary();</div><div class="line">            &#125;</div><div class="line">            root = root.children[pos];</div><div class="line">        &#125;</div><div class="line">        root.hasWord = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*æŸ¥æ‰¾*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(String word, <span class="keyword">int</span> index,WordDictionary root)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> length = word.length();</div><div class="line">        <span class="keyword">int</span> pos;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = index ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">            pos = word.charAt(i) - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">if</span>( pos == -<span class="number">51</span> )&#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">26</span> ; j += <span class="number">1</span>)&#123;</div><div class="line">                    <span class="keyword">if</span>(<span class="keyword">null</span> != root.children &amp;&amp; dfs(word,i+<span class="number">1</span>,root.children[j]))&#123;</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> != root.children[pos])&#123;</div><div class="line">                root = root.children[pos];</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root.hasWord;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">search</span><span class="params">(String word)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> dfs(word,<span class="number">0</span>,<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        WordDictionary obj = <span class="keyword">new</span> WordDictionary();</div><div class="line">        obj.addWord(<span class="string">"at"</span>);</div><div class="line">        obj.addWord(<span class="string">"and"</span>);</div><div class="line">        obj.addWord(<span class="string">"add"</span>);</div><div class="line">        obj.addWord(<span class="string">"a"</span>);</div><div class="line">        obj.addWord(<span class="string">"bat"</span>);</div><div class="line">        System.out.println(obj.search(<span class="string">"a.d."</span>));</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Top-K-Frequent-Words">3.3. Top K Frequent Words</h2><p>ç»™ä¸€ç»„str[]ï¼Œç»Ÿè®¡é¢‘ç‡æœ€é«˜çš„kä¸ªstrï¼Œå¹¶è¾“å‡º</p>
<p>å¦‚æœä¸¤ä¸ªstré¢‘ç‡ä¸€æ ·ï¼Œåˆ™å­—å…¸é¡ºåºä½çš„strä¼˜å…ˆè¾“å‡º</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: [&quot;i&quot;, &quot;love&quot;, &quot;leetcode&quot;, &quot;i&quot;, &quot;love&quot;, &quot;coding&quot;], k = 2</div><div class="line">Output: [&quot;i&quot;, &quot;love&quot;]</div><div class="line">iå’Œloveæ˜¯é¢‘ç‡æœ€é«˜çš„ä¸¤ä¸ªstrï¼Œä¸”é¢‘ç‡éƒ½æ˜¯2ã€‚iåœ¨loveå‰é¢ï¼Œå› ä¸ºiçš„å­—å…¸é¡ºåºé å‰</div></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: [&quot;the&quot;, &quot;day&quot;, &quot;is&quot;, &quot;sunny&quot;, &quot;the&quot;, &quot;the&quot;, &quot;the&quot;, &quot;sunny&quot;, &quot;is&quot;, &quot;is&quot;], k = 4</div><div class="line">Output: [&quot;the&quot;, &quot;is&quot;, &quot;sunny&quot;, &quot;day&quot;]</div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šè¿™é“é¢˜å…ˆç”¨trieæ ‘è¿›è¡Œç»Ÿè®¡ï¼Œç„¶åç”¨ä¸€ä¸ªæœ€å¤§å †æ¥ç»´æŠ¤å½“å‰æ¯ä¸ªstrçš„æ¬¡æ•°ã€‚å½“ç»Ÿè®¡ç»“æŸæ—¶ï¼Œä»å †é¡¶è¾“å‡ºkæ¬¡å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">            String s;</div><div class="line">            <span class="keyword">int</span> count;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.count &gt; o.count)&#123;</div><div class="line">                    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.count == o.count)&#123;</div><div class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.s.compareTo(o.s)&gt;<span class="number">0</span>)&#123;</div><div class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            Node(String s,<span class="keyword">int</span> count)&#123;</div><div class="line">                <span class="keyword">this</span>.s = s;</div><div class="line">                <span class="keyword">this</span>.count = count;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">HashHeap</span></span>&#123;</div><div class="line">        Node[] E;</div><div class="line">        HashMap&lt;String,Integer&gt; map;</div><div class="line">        <span class="keyword">int</span> heapSize;</div><div class="line">        <span class="keyword">int</span> k;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HashHeap</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">            E = <span class="keyword">new</span> Node[k+<span class="number">1</span>];</div><div class="line">            heapSize = <span class="number">0</span>;</div><div class="line">            map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            <span class="keyword">this</span>.k = k ;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">left</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="number">2</span> * i;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">right</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">father</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> i/<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">brother</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">2</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> i+<span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> i-<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> q)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> indexq = map.get(E[q].s);</div><div class="line">            map.replace(E[q].s,map.get(E[p].s));</div><div class="line">            map.replace(E[p].s,indexq);</div><div class="line">            Node temp = E[p];</div><div class="line">            E[p] = E[q];</div><div class="line">            E[q] = temp;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Push</span><span class="params">(Node e)</span></span>&#123;</div><div class="line">    <span class="comment">//        while(heapSize &gt;= k)&#123;</span></div><div class="line">    <span class="comment">//            this.Pop();</span></div><div class="line">    <span class="comment">//        &#125;</span></div><div class="line">            E[heapSize] = e;</div><div class="line">            heapSize+=<span class="number">1</span>;</div><div class="line">            map.put(e.s,heapSize-<span class="number">1</span>);</div><div class="line">            FixUP(heapSize-<span class="number">1</span>);</div><div class="line">    </div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FixUP</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">            <span class="keyword">int</span> father = father(i);</div><div class="line">            <span class="keyword">if</span>(E[father].compareTo(E[i])&gt;<span class="number">0</span>) &#123;</div><div class="line">                swap(i, father);</div><div class="line">            &#125;</div><div class="line">            FixUP(father);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> Node <span class="title">Pop</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(heapSize==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">            swap(<span class="number">0</span>,heapSize-<span class="number">1</span>);</div><div class="line">            heapSize-=<span class="number">1</span>;</div><div class="line">            FixDown(<span class="number">0</span>);</div><div class="line">            <span class="keyword">return</span> E[heapSize];</div><div class="line">    </div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FixDown</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">int</span> l = left(i);</div><div class="line">            <span class="keyword">int</span> r = right(i);</div><div class="line">            <span class="keyword">int</span> min = -<span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (l &lt; <span class="keyword">this</span>.heapSize &amp;&amp; E[l].compareTo(E[i])&lt;<span class="number">0</span>)&#123;</div><div class="line">                min = l;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                min = i;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>( r &lt; <span class="keyword">this</span>.heapSize &amp;&amp; E[r].compareTo(E[min])&lt;<span class="number">0</span> )&#123;</div><div class="line">                min = r;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>( min != i )&#123;</div><div class="line">                swap(i,min);</div><div class="line">                FixDown(min);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">count_add1</span><span class="params">(String s)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> index = map.get(s);</div><div class="line">            E[index].count+=<span class="number">1</span>;</div><div class="line">            FixUP(index);</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Trie</span> </span>&#123;</div><div class="line">        Trie[] children;</div><div class="line">        <span class="keyword">int</span> wordCount;</div><div class="line">        <span class="comment">/*åˆå§‹åŒ–*/</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Trie</span><span class="params">()</span></span>&#123;</div><div class="line">            children = <span class="keyword">new</span> Trie[<span class="number">26</span>];</div><div class="line">            wordCount = <span class="number">0</span>;</div><div class="line">    </div><div class="line">        &#125;</div><div class="line">        <span class="comment">/*æ’å…¥ä¸€ä¸ªè¯*/</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addWord</span><span class="params">(String word)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> length = word.length();</div><div class="line">            Trie root = <span class="keyword">this</span>;</div><div class="line">            <span class="keyword">int</span> pos;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; length ; i += <span class="number">1</span>)&#123;</div><div class="line">                pos = word.charAt(i) - <span class="string">'a'</span>;</div><div class="line">                <span class="keyword">if</span>(<span class="keyword">null</span> == root.children[pos])&#123;</div><div class="line">                    root.children[pos] = <span class="keyword">new</span> Trie();</div><div class="line">                &#125;</div><div class="line">                root = root.children[pos];</div><div class="line">            &#125;</div><div class="line">            root.wordCount += <span class="number">1</span>;</div><div class="line">          <span class="comment">// è¿™é‡Œç»´æŠ¤ä¸€ä¸ªhashheap</span></div><div class="line">            <span class="keyword">if</span>(root.wordCount==<span class="number">1</span>)&#123;</div><div class="line">                heap.Push(<span class="keyword">new</span> Node(word,<span class="number">1</span>));</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                heap.count_add1(word);</div><div class="line">            &#125;</div><div class="line">         </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    HashHeap heap ;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">topKFrequent</span><span class="params">(String[] words, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        List&lt;String&gt; ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        Trie trie = <span class="keyword">new</span> Trie();</div><div class="line">        heap = <span class="keyword">new</span> HashHeap(words.length);</div><div class="line">        <span class="keyword">for</span>(String w : words)&#123;</div><div class="line">            trie.addWord(w);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; k ; i +=<span class="number">1</span> )&#123;</div><div class="line">            ans.add(heap.Pop().s);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Map-Sum-Pairs">3.4. Map Sum Pairs</h2><p>å®ç°å¦‚ä¸‹æ¥å£ï¼š</p>
<p>insert(String s,int val)   â€” sæ˜¯å…³é”®å­—ï¼Œvalæ˜¯ä»·å€¼</p>
<p>sum(String prefix)  â€” è¾“å‡ºä»¥prefixä¸ºå‰ç¼€çš„æ‰€æœ‰å•è¯çš„ä»·å€¼å’Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Input: insert(&quot;apple&quot;, 3), Output: Null</div><div class="line">Input: sum(&quot;ap&quot;), Output: 3</div><div class="line">Input: insert(&quot;app&quot;, 2), Output: Null</div><div class="line">Input: sum(&quot;ap&quot;), Output: 5</div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šç”¨Trieæ ‘ä¿å­˜insertä¹‹åçš„strï¼Œå¹¶ç»™æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¿å­˜ä¸€ä¸ªvalå€¼ã€‚å¦‚æœè¿™ä¸ªèŠ‚ç‚¹ä¸æ˜¯å•è¯ï¼Œvalå°±ä¸º0ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/14.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapSum</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        Node[] children;</div><div class="line">        <span class="keyword">int</span> Val;</div><div class="line">        Node()&#123;</div><div class="line">            children = <span class="keyword">new</span> Node[<span class="number">26</span>];</div><div class="line">            Val = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetVal</span><span class="params">(<span class="keyword">int</span> Val)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.Val = Val;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*åˆå§‹åŒ–*/</span></div><div class="line">    Node root;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MapSum</span><span class="params">()</span> </span>&#123;</div><div class="line">        root = <span class="keyword">new</span> Node();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*æ’å…¥*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String key, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> index;</div><div class="line">        Node e = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; key.length() ; i += <span class="number">1</span>)&#123;</div><div class="line">            index = key.charAt(i) - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> == e.children[index])&#123;</div><div class="line">                e.children[index] = <span class="keyword">new</span> Node();</div><div class="line">            &#125;</div><div class="line">            e = e.children[index];</div><div class="line">        &#125;</div><div class="line">        e.SetVal(val);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*å‰ç¼€å°¾prefixçš„å•è¯çš„æƒé‡å’Œ*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(String prefix)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> index;</div><div class="line">        Node e = <span class="keyword">this</span>.root;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; prefix.length() ; i += <span class="number">1</span> )&#123;</div><div class="line">            index = prefix.charAt(i) - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">if</span>( <span class="keyword">null</span> != e.children[index] )&#123;</div><div class="line">                e = e.children[index];</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// eåœç•™åœ¨å‰ç¼€æœ«å°¾</span></div><div class="line">        <span class="keyword">return</span> dfs(e);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(Node root)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> val = root.Val;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span>; i += <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>( <span class="keyword">null</span> == root.children[i] )&#123;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            val += dfs(root.children[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> val;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        MapSum t = <span class="keyword">new</span> MapSum();</div><div class="line">        t.insert(<span class="string">"a"</span>,<span class="number">3</span>);</div><div class="line">        System.out.println(t.sum(<span class="string">"ap"</span>));</div><div class="line">        t.insert(<span class="string">"b"</span>,<span class="number">2</span>);</div><div class="line">        System.out.println(t.sum(<span class="string">"a"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Word-Search-II">3.5. Word Search II</h2><p>ç»™ä¸€ä¸ª<code>char[][] board</code>ï¼Œå’Œä¸€ä¸ªString[] wordsã€‚ä»wordsä¸­æ‰¾åˆ°è¢«åŒ…å«åœ¨boardä¸­çš„å•è¯ã€‚</p>
<p><strong>words</strong> = <code>[&quot;oath&quot;,&quot;pea&quot;,&quot;eat&quot;,&quot;rain&quot;]</code> and <strong>board</strong> =</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  [&apos;o&apos;,&apos;a&apos;,&apos;a&apos;,&apos;n&apos;],</div><div class="line">  [&apos;e&apos;,&apos;t&apos;,&apos;a&apos;,&apos;e&apos;],</div><div class="line">  [&apos;i&apos;,&apos;h&apos;,&apos;k&apos;,&apos;r&apos;],</div><div class="line">  [&apos;i&apos;,&apos;f&apos;,&apos;l&apos;,&apos;v&apos;]</div><div class="line">]</div></pre></td></tr></table></figure>
<p>Return </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[&quot;eat&quot;,&quot;oath&quot;]</div></pre></td></tr></table></figure>
<p>.æ€è·¯ï¼šç»™wordså»ºç«‹ä¸€ä¸ªtrieæ ‘ã€‚ç„¶åä¾æ¬¡å¯¹boardä¸­æ¯ä¸ªç‚¹è¿›è¡Œdfsï¼ŒæŸ¥çœ‹ç»„æˆçš„å•è¯åœ¨ä¸åœ¨trieæ ‘ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        Node[] children;</div><div class="line">        <span class="keyword">boolean</span> hasword;</div><div class="line">        Node()&#123;</div><div class="line">            children = <span class="keyword">new</span> Node[<span class="number">26</span>];</div><div class="line">            hasword = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    Node root;</div><div class="line">    <span class="keyword">boolean</span>[][] flag;</div><div class="line">    List&lt;String&gt; ans;</div><div class="line">    <span class="comment">/*æ’å…¥*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String key)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> index;</div><div class="line">        Node e = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; key.length() ; i += <span class="number">1</span>)&#123;</div><div class="line">            index = key.charAt(i) - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> == e.children[index])&#123;</div><div class="line">                e.children[index] = <span class="keyword">new</span> Node();</div><div class="line">            &#125;</div><div class="line">            e = e.children[index];</div><div class="line">        &#125;</div><div class="line">        e.hasword = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*å¯¹boardè¿›è¡Œdfséå†*/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">char</span>[][] board,<span class="keyword">int</span> i, <span class="keyword">int</span> j , Node e,String w)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(flag[i][j])<span class="keyword">return</span>;</div><div class="line">        <span class="keyword">int</span> index = board[i][j] - <span class="string">'a'</span>;</div><div class="line">        <span class="keyword">if</span>( <span class="keyword">null</span> == e.children[index] )&#123;<span class="keyword">return</span>;&#125;</div><div class="line">        w = w+board[i][j];</div><div class="line">        <span class="keyword">if</span>( e.children[index].hasword )&#123;</div><div class="line">            ans.add(w);</div><div class="line">            e.children[index].hasword = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        flag[i][j] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">int</span>[] dx = &#123;-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] dy = &#123;<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">int</span> x,y;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; dx.length ;  q+=<span class="number">1</span>)&#123;</div><div class="line">            x = i + dx[q];</div><div class="line">            y = j + dy[q];</div><div class="line">            <span class="keyword">if</span>(  x &lt; <span class="number">0</span> ||  x &gt;= board.length)<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span>(  y &lt; <span class="number">0</span> ||  y &gt;= board[i].length )<span class="keyword">continue</span>;</div><div class="line">            dfs(board,x,y,e.children[index],w);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        flag[i][j] = <span class="keyword">false</span>;</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findWords</span><span class="params">(<span class="keyword">char</span>[][] board, String[] words)</span> </span>&#123;</div><div class="line">        ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(board.length == <span class="number">0</span> || board[<span class="number">0</span>].length == <span class="number">0</span> || words.length==<span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> ans;</div><div class="line">        &#125;</div><div class="line">        root = <span class="keyword">new</span> Node();</div><div class="line">        flag = <span class="keyword">new</span> <span class="keyword">boolean</span>[board.length][board[<span class="number">0</span>].length];</div><div class="line">        <span class="keyword">for</span>(String s : words)&#123;</div><div class="line">            insert(s);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; board.length ; i += <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; board[i].length ; j += <span class="number">1</span> )&#123;</div><div class="line">                dfs(board,i,j,<span class="keyword">this</span>.root,<span class="string">""</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Replace-Words">3.6. Replace Words</h2><p>ç»™ä¸€ä¸ªè¯æ ¹è¡¨<code>str[] dict = [&quot;cat&quot;, &quot;bat&quot;, &quot;rat&quot;]</code> ï¼Œå’Œä¸€ä¸ªå¥å­<code>sentence = &quot;the cattle was rattled by the battery&quot;</code>ã€‚ç”¨è¯æ ¹æ›¿æ¢å¥å­ä¸º<code>&quot;the cat was rat by the bat&quot;</code></p>
<p>æ€è·¯ï¼šè¿™é“é¢˜æˆ‘ä¸€å¼€å§‹æ˜¯ç”¨dfsæ¥åšçš„ã€‚ä½†æ˜¯æµ‹è¯•æ ·ä¾‹å¤ªå˜æ€äº†ï¼Œå¥½é•¿çš„å­—ç¬¦ä¸²ï¼Œå¯¼è‡´è¶…æ—¶äº†ã€‚è¿™é“é¢˜åªèƒ½ç”¨å¾ªç¯æ¥åšï¼</p>
<p>è¿™é“é¢˜æœ‰Stringçš„ä¸¤ä¸ªéªšæ“ä½œï¼š</p>
<ol>
<li><p>å¯¹String s çš„å¾ªç¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>( <span class="keyword">char</span> s : s.toCharArray() )&#123;</div><div class="line">  System.out.println(s);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å¯¹å¤šä¸ªstrçš„concatï¼š<code>StringBuilder</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line"><span class="keyword">for</span>( String e : strs )&#123;</div><div class="line">  stringBuilder.append(e);</div><div class="line">&#125;</div><div class="line">String concatResult = stringBuilder.toString();</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/13.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrieTree</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Trie</span></span>&#123;</div><div class="line">        <span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span></span>&#123;</div><div class="line">            TrieNode[] children;</div><div class="line">            <span class="keyword">boolean</span> hasWord;</div><div class="line">            TrieNode()&#123;</div><div class="line">                children = <span class="keyword">new</span> TrieNode[<span class="number">26</span>];</div><div class="line">                hasWord = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        TrieNode root;</div><div class="line">        Trie()&#123;</div><div class="line">            root = <span class="keyword">new</span> TrieNode();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String word)</span></span>&#123;</div><div class="line">            TrieNode r = <span class="keyword">this</span>.root;</div><div class="line">            <span class="keyword">int</span> index;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">char</span> c: word.toCharArray() )&#123;</div><div class="line">                index = c-<span class="string">'a'</span>;</div><div class="line">                <span class="keyword">if</span>( <span class="keyword">null</span> == r.children[index] )&#123;</div><div class="line">                    r.children[index] = <span class="keyword">new</span> TrieNode();</div><div class="line">                &#125;</div><div class="line">                r = r.children[index];</div><div class="line">            &#125;</div><div class="line">            r.hasWord = <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// åˆ¤æ–­æ ‘ä¸­æœ‰æ²¡æœ‰wordçš„å‰ç¼€</span></div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">prefix</span><span class="params">(String word)</span></span>&#123;</div><div class="line">            StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">            TrieNode r = <span class="keyword">this</span>.root;</div><div class="line">            <span class="keyword">int</span> idx;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">char</span> c : word.toCharArray() )&#123;</div><div class="line">                idx = c - <span class="string">'a'</span>;</div><div class="line">                <span class="keyword">if</span>( <span class="keyword">null</span> != r.children[idx] )&#123;</div><div class="line">                    stringBuilder.append(c);</div><div class="line">                    <span class="keyword">if</span>(r.children[idx].hasWord)&#123;</div><div class="line">                        <span class="keyword">return</span> stringBuilder.toString();</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">else</span>&#123;</div><div class="line">                        r = r.children[idx];</div><div class="line">                    &#125;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">return</span> word;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> word;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">replaceWords</span><span class="params">(List&lt;String&gt; dict, String sentence)</span> </span>&#123;</div><div class="line">        Trie trie = <span class="keyword">new</span> Trie();</div><div class="line">        <span class="keyword">for</span>(String word : dict)&#123;</div><div class="line">            trie.insert(word);</div><div class="line">        &#125;</div><div class="line">        String[] words = sentence.split(<span class="string">" "</span>);</div><div class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span>( String word : words )&#123;</div><div class="line">            stringBuilder.append(trie.prefix(word));</div><div class="line">            stringBuilder.append(<span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> stringBuilder.toString().substring(<span class="number">0</span>,stringBuilder.length()-<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        String sentence = <span class="string">"a aa a aaaa aaa aaa aaa aaaaaa bbb baba ababa"</span>;</div><div class="line">        String[] d = &#123;<span class="string">"a"</span>, <span class="string">"aa"</span>, <span class="string">"aaa"</span>, <span class="string">"aaaa"</span>&#125;;</div><div class="line">        ArrayList&lt;String&gt; dict = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(String e : d)&#123;</div><div class="line">            dict.add(e);</div><div class="line">        &#125;</div><div class="line">        System.out.println(<span class="keyword">new</span> TrieTree().replaceWords(dict,sentence));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Concatenated-Words">3.7. Concatenated Words</h2><p>ç»™ä¸€ä¸ªstræ•°ç»„ã€‚æ‰¾åˆ°å…¶ä¸­æŸäº›èƒ½è¢«å…¶å®ƒå­—ç¬¦concatè€Œæˆçš„å•è¯</p>
<p>ç”¨äº†trieæ ‘ï¼Œbeats 93%.ç®€ç›´ç¾æ»‹æ»‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span></span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">        <span class="keyword">boolean</span> hasWord = <span class="keyword">false</span>;</div><div class="line">        Node[] children = <span class="keyword">new</span> Node[<span class="number">26</span>];</div><div class="line">    &#125;</div><div class="line">    Node root = <span class="keyword">new</span> Node();</div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">newNode</span><span class="params">(Node root, <span class="keyword">char</span> c)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(root.children[c - <span class="string">'a'</span>] == <span class="keyword">null</span>)</div><div class="line">            root.children[c - <span class="string">'a'</span>] = <span class="keyword">new</span> Node();</div><div class="line">        <span class="keyword">return</span> root.children[c - <span class="string">'a'</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String s)</span></span>&#123;</div><div class="line">        Node e = newNode(root, s.charAt(<span class="number">0</span>));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); ++i)&#123;</div><div class="line">            e = newNode(e, s.charAt(i));</div><div class="line">        &#125;</div><div class="line">        e.hasWord = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">canBeConcat</span><span class="params">(String s, <span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(idx &gt;= s.length())<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        Node e = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = idx; i &lt; s.length(); ++i)&#123;</div><div class="line">            <span class="keyword">char</span> c = s.charAt(i);</div><div class="line">            <span class="keyword">if</span>(e.children[c - <span class="string">'a'</span>] == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span>(e.children[c -<span class="string">'a'</span>].hasWord) &#123;</div><div class="line">                <span class="keyword">if</span>(i == s.length() - <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">                <span class="keyword">int</span> next = canBeConcat(s, i + <span class="number">1</span>);</div><div class="line">                <span class="keyword">if</span> (next &gt; <span class="number">0</span>) <span class="keyword">return</span> next + <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            e = e.children[c-<span class="string">'a'</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findAllConcatenatedWordsInADict</span><span class="params">(String[] words)</span> </span>&#123;</div><div class="line">    Trie trie = <span class="keyword">new</span> Trie();</div><div class="line">    <span class="keyword">for</span>(String str : words)&#123;</div><div class="line">        <span class="keyword">if</span>(str.length() == <span class="number">0</span>)<span class="keyword">continue</span>;</div><div class="line">        trie.add(str);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// æŸ¥çœ‹æ¯ä¸ªå•è¯æ˜¯å¦èƒ½è¢«ç»„åˆ</span></div><div class="line">    List&lt;String&gt; result = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span>(String str : words)&#123;</div><div class="line">        <span class="keyword">if</span>(str.length() == <span class="number">0</span>)<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(trie.canBeConcat(str, <span class="number">0</span>) &gt;= <span class="number">2</span>)result.add(str);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">4. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://wizardforcel.gitbooks.io/the-art-of-programming-by-july/content/06.09.html" target="_blank" rel="external">ç¼–ç¨‹ä¹‹æ³•</a></li>
<li><a href="http://blog.csdn.net/v_july_v/article/details/6897097" target="_blank" rel="external">July, ä»Trieæ ‘ï¼ˆå­—å…¸æ ‘ï¼‰è°ˆåˆ°åç¼€æ ‘</a></li>
<li><a href="http://www.jiuzhang.com/solutions/implement-trie/" target="_blank" rel="external">ä¹ç« ç®—æ³•æ¨¡æ¿</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Trie </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å¹¶æŸ¥é›†]]></title>
      <url>/2017/11/05/%E7%AE%97%E6%B3%95-%E5%B9%B6%E6%9F%A5%E9%9B%86/</url>
      <content type="html"><![CDATA[<h1 id="å…³äºåŠ¨æ€è¿é€šæ€§">1. å…³äºåŠ¨æ€è¿é€šæ€§</h1><p>æˆ‘ä»¬çœ‹ä¸€å¼ å›¾æ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯åŠ¨æ€è¿é€šæ€§</p>
<p><img src="https://i.loli.net/2017/11/05/59ff21287f5d9.png" alt=""> </p>
<p>å‡è®¾æˆ‘ä»¬è¾“å…¥äº†ä¸€ç»„æ•´æ•°å¯¹ï¼Œå³ä¸Šå›¾ä¸­çš„(4, 3) (3, 8)ç­‰ç­‰ï¼Œæ¯å¯¹æ•´æ•°ä»£è¡¨è¿™ä¸¤ä¸ªpoints/sitesæ˜¯è¿é€šçš„ã€‚é‚£ä¹ˆéšç€æ•°æ®çš„ä¸æ–­è¾“å…¥ï¼Œæ•´ä¸ªå›¾çš„è¿é€šæ€§ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»ä¸Šå›¾ä¸­å¯ä»¥å¾ˆæ¸…æ™°çš„å‘ç°è¿™ä¸€ç‚¹ã€‚åŒæ—¶ï¼Œå¯¹äºå·²ç»å¤„äºè¿é€šçŠ¶æ€çš„points/sitesï¼Œç›´æ¥å¿½ç•¥ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„(8,9)ã€‚</p>
<a id="more"></a>
<p><strong>åŠ¨æ€è¿é€šæ€§çš„åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç½‘ç»œè¿æ¥åˆ¤æ–­ï¼š<br>å¦‚æœæ¯ä¸ªpairä¸­çš„ä¸¤ä¸ªæ•´æ•°åˆ†åˆ«ä»£è¡¨ä¸€ä¸ªç½‘ç»œèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¯¥pairå°±æ˜¯ç”¨æ¥è¡¨ç¤ºè¿™ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯éœ€è¦è¿é€šçš„ã€‚é‚£ä¹ˆä¸ºæ‰€æœ‰çš„pairså»ºç«‹äº†åŠ¨æ€è¿é€šå›¾åï¼Œå°±èƒ½å¤Ÿå°½å¯èƒ½å°‘çš„å‡å°‘å¸ƒçº¿çš„éœ€è¦ï¼Œå› ä¸ºå·²ç»è¿é€šçš„ä¸¤ä¸ªèŠ‚ç‚¹ä¼šè¢«ç›´æ¥å¿½ç•¥æ‰ã€‚</li>
<li>å˜é‡åç­‰åŒæ€§(ç±»ä¼¼äºæŒ‡é’ˆçš„æ¦‚å¿µ)ï¼š<br>åœ¨ç¨‹åºä¸­ï¼Œå¯ä»¥å£°æ˜å¤šä¸ªå¼•ç”¨æ¥æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡ä¸ºç¨‹åºä¸­å£°æ˜çš„å¼•ç”¨å’Œå®é™…å¯¹è±¡å»ºç«‹åŠ¨æ€è¿é€šå›¾æ¥åˆ¤æ–­å“ªäº›å¼•ç”¨å®é™…ä¸Šæ˜¯æŒ‡å‘åŒä¸€å¯¹è±¡ã€‚</li>
</ul>
<p><strong>å¯¹é—®é¢˜å»ºæ¨¡ï¼š</strong></p>
<p>åœ¨å¯¹é—®é¢˜è¿›è¡Œå»ºæ¨¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡æƒ³æ¸…æ¥šéœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆã€‚å› ä¸ºæ¨¡å‹ä¸­é€‰æ‹©çš„æ•°æ®ç»“æ„å’Œç®—æ³•æ˜¾ç„¶ä¼šæ ¹æ®é—®é¢˜çš„ä¸åŒè€Œä¸åŒï¼Œå°±åŠ¨æ€è¿é€šæ€§è¿™ä¸ªåœºæ™¯è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>ç»™å‡ºä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿é€šï¼Œå¦‚æœè¿é€šï¼Œä¸éœ€è¦ç»™å‡ºå…·ä½“çš„è·¯å¾„</li>
<li>ç»™å‡ºä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿é€šï¼Œå¦‚æœè¿é€šï¼Œéœ€è¦ç»™å‡ºå…·ä½“çš„è·¯å¾„</li>
</ul>
<p>å°±ä¸Šé¢ä¸¤ç§é—®é¢˜è€Œè¨€ï¼Œè™½ç„¶åªæœ‰æ˜¯å¦èƒ½å¤Ÿç»™å‡ºå…·ä½“è·¯å¾„çš„åŒºåˆ«ï¼Œä½†æ˜¯è¿™ä¸ªåŒºåˆ«å¯¼è‡´äº†é€‰æ‹©ç®—æ³•çš„ä¸åŒï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»çš„æ˜¯ç¬¬ä¸€ç§æƒ…å†µï¼Œå³ä¸éœ€è¦ç»™å‡ºå…·ä½“è·¯å¾„çš„Union-Findç®—æ³•ï¼Œè€Œç¬¬äºŒç§æƒ…å†µå¯ä»¥ä½¿ç”¨åŸºäºDFSçš„ç®—æ³•ã€‚</p>
<h1 id="å¹¶æŸ¥é›†">2. å¹¶æŸ¥é›†</h1><p> å¹¶æŸ¥é›†æ˜¯è‹¥å¹²ä¸ªä¸ç›¸äº¤çš„é›†åˆï¼Œèƒ½è¾ƒå¿«åœ°åˆå¹¶å’Œåˆ¤æ–­å…ƒç´ æ‰€åœ¨çš„é›†åˆã€‚</p>
<h2 id="æ•°æ®ç»“æ„">2.1. æ•°æ®ç»“æ„</h2><p>å¹¶æŸ¥é›†çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç”±å®ƒå’Œå®ƒçš„çˆ¶èŠ‚ç‚¹ï¼ˆé›†åˆå†…çš„ä¸€ä¸ªä»£è¡¨ï¼‰ç»„æˆï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>key</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>element</td>
<td>parent</td>
</tr>
</tbody>
</table>
<p>ç®€å•çš„å¹¶æŸ¥é›†åªéœ€è¦å­˜å‚¨åœ¨ä¸€ä¸ªhashè¡¨ä¸­ï¼Œkeyæ˜¯å®ƒæœ¬èº«ï¼Œvalueå°±æ˜¯å®ƒçš„çˆ¶èŠ‚ç‚¹çš„å€¼ã€‚</p>
<p><img src="https://i.loli.net/2017/11/05/59ff249bb6d17.png" alt=""> </p>
<p>å¦‚ä¸Šå›¾çš„å·¦è¾¹ä¸¤ä¸ªé›†åˆæ‰€ç¤ºï¼Œå·¦è¾¹çš„é›†åˆè¡¨ç¤ºä¸ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">c</th>
<th>h</th>
<th>e</th>
<th>b</th>
<th>f</th>
<th>d</th>
<th>g</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">c</td>
<td>c</td>
<td>c</td>
<td>h</td>
<td>f</td>
<td>f</td>
<td>d</td>
</tr>
</tbody>
</table>
<h2 id="åˆå§‹åŒ–">2.2. åˆå§‹åŒ–</h2><p>åˆå§‹åŒ–åæ¯ä¸€ä¸ªå…ƒç´ çš„çˆ¶äº²èŠ‚ç‚¹æ˜¯å®ƒæœ¬èº«ï¼Œå³è‡ªå·±æ˜¯è‡ªå·±çš„å¤§å“¥:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">HashMap&lt;Integer,Integer&gt; father;</div><div class="line">    UnionFind(<span class="keyword">int</span>[] element)&#123;</div><div class="line">        father = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        Initialization(element);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialization</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="comment">// initialize your data structure here.</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)</div><div class="line">            father.put(nums[i],nums[i]);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="æŸ¥æ‰¾">2.3. æŸ¥æ‰¾</h2><p>æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ æ‰€åœ¨çš„é›†åˆï¼Œå…¶ç²¾é«“æ˜¯æ‰¾åˆ°è¿™ä¸ªå…ƒç´ çš„ç»ˆæå¤§bossï¼è¿™ä¸ªæ‰æ˜¯å¹¶æŸ¥é›†åˆ¤æ–­å’Œåˆå¹¶çš„æœ€ç»ˆä¾æ®ã€‚<br>åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å±äºåŒä¸€é›†åˆï¼Œåªè¦çœ‹ä»–ä»¬æ˜¯ä¸æ˜¯æœ€ç»ˆéƒ½å½’ä¸€ä¸ªç»ˆæå¤§bossç®¡, æ¨¡æ¿å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">  <span class="keyword">int</span> key_father = key;</div><div class="line">  <span class="keyword">while</span>(key_father != father.get(key_father))&#123;</div><div class="line">    key_father = father.get(key_father);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> key_father;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œè¿™æ ·çš„æœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n)$ï¼Œä¾‹å¦‚è¿™ä¸ªä¾‹å­ï¼š</p>
<p>aâ†’ bâ†’ xâ†’ yâ†’ w</p>
<p>ä¿®æ­£çš„æ–¹æ³•å°±æ˜¯åœ¨find()ä¹‹åè¿›è¡Œè·¯å¾„å‹ç¼©ï¼š</p>
<p><img src="https://i.loli.net/2017/11/05/59ff337e15b12.png" alt=""> </p>
<p>äºæ˜¯å°±å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2017/11/05/59ff33bd936a0.png" alt=""> </p>
<p>ä»£ç ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> key_father = key;</div><div class="line">    <span class="keyword">while</span>(key_father != father.get(key_father))&#123;</div><div class="line">        key_father = father.get(key_father);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> temp = key;</div><div class="line">    <span class="keyword">int</span> temp_father;</div><div class="line">    <span class="keyword">while</span>(temp != key_father)&#123;</div><div class="line">        temp_father = father.get(temp);</div><div class="line">        father.replace(temp,key_father);</div><div class="line">        temp = temp_father;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> key_father;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ç¬¬ä¸€æ¬¡æ˜¯O(n), ä½†æ˜¯å¤šæ¬¡ä¸‹æ¥æ˜¯log*n (è§<a href="https://en.wikipedia.org/wiki/Iterated_logarithm" target="_blank" rel="external">https://en.wikipedia.org/wiki/Iterated_logarithm</a>), è¯æ˜ç•¥</p>
<p><img src="https://i.loli.net/2017/11/05/59ff345251520.png" alt=""> </p>
<p>å› ä¸º1-5éƒ½å¾ˆå°, æ‰€ä»¥findåŸºæœ¬ä¸Šæ˜¯O(1)çš„æ“ä½œ.</p>
<h2 id="åˆå¹¶">2.4. åˆå¹¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public void union(int x,int y)&#123;</div><div class="line">    int fa_x = find(x);</div><div class="line">    int fa_y = find(y);</div><div class="line">    if( fa_x != fa_y )&#123;</div><div class="line">        father.put(fa_x,fa_y);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æ¨¡æ¿">3. æ¨¡æ¿</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.HashSet;</div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/5.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UnionFind</span> </span>&#123;</div><div class="line">    HashMap&lt;Integer,Integer&gt; father;</div><div class="line">    UnionFind()&#123;</div><div class="line">        father = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key,<span class="keyword">int</span> fa)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(father.containsKey(key))<span class="keyword">return</span>;</div><div class="line">        father.put(key,fa);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialization</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="comment">// initialize your data structure here.</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)</div><div class="line">            father.put(nums[i],nums[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> key_father = key;</div><div class="line">        <span class="keyword">while</span>(key_father != father.get(key_father))&#123;</div><div class="line">            key_father = father.get(key_father);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> temp = key;</div><div class="line">        <span class="keyword">int</span> temp_father;</div><div class="line">        <span class="keyword">while</span>(temp != key_father)&#123;</div><div class="line">            temp_father = father.get(temp);</div><div class="line">            father.replace(temp,key_father);</div><div class="line">            temp = temp_father;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> key_father;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> fa_x = find(x);</div><div class="line">        <span class="keyword">int</span> fa_y = find(y);</div><div class="line">        <span class="keyword">if</span>( fa_x != fa_y )&#123;</div><div class="line">            father.put(fa_x,fa_y);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">setNum</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//è¾“å‡ºé›†åˆä¸ªæ•°</span></div><div class="line">        Iterator iter = father.entrySet().iterator();</div><div class="line">        <span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">            Object key = ((Map.Entry) iter.next()).getKey();</div><div class="line">            find((Integer) key);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// å¯¹æ‰€æœ‰valå»é‡</span></div><div class="line">        iter = father.entrySet().iterator();</div><div class="line">        HashSet&lt;Integer&gt; counter = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">            Integer val = (Integer)(((Map.Entry) iter.next()).getValue());</div><div class="line">            <span class="keyword">if</span>(counter.contains(val))&#123;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                counter.add(val);</div><div class="line">                num+=<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å¹¶æŸ¥é›†ç›¸å…³leetcodeé¢˜">4. å¹¶æŸ¥é›†ç›¸å…³leetcodeé¢˜</h1><h2 id="Number-of-Islands">4.1. Number of Islands</h2><p>ç»™å®šä¸€ä¸ªäºŒç»´æ•°ç»„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">11110</div><div class="line">11010</div><div class="line">11000</div><div class="line">00000</div></pre></td></tr></table></figure>
<p>å…¶ä¸­1ä¸ºå²›å±¿ï¼Œ0ä¸ºæµ·æ´‹ã€‚å¦‚æœä¸Šä¸‹å·¦å³ç›¸é‚»ï¼Œåˆ™ä¸ºåŒä¸€ä¸ªå²›å±¿ã€‚åˆ¤æ–­å…¶ä¸­æœ‰å¤šå°‘ä¸ªå²›å±¿ã€‚</p>
<p>è¿™ä¸ªé¢˜å¯ä»¥ç”¨å¹¶æŸ¥é›†æ¥åšã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numIslands</span><span class="params">(<span class="keyword">char</span>[][] grid)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(grid.length == <span class="number">0</span> || grid[<span class="number">0</span>].length == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n = grid.length, m = grid[<span class="number">0</span>].length;</div><div class="line">    UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">    <span class="keyword">int</span> index,fa_1,fa_2;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; m ; j+=<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(grid[i][j]==<span class="string">'1'</span>)&#123;</div><div class="line">                System.out.println(set.father);</div><div class="line">                index = i*m + j;</div><div class="line">                set.add(index,index);</div><div class="line">                <span class="keyword">if</span>( i&gt;<span class="number">0</span> &amp;&amp; grid[i-<span class="number">1</span>][j]==<span class="string">'1'</span>)&#123;</div><div class="line">                    fa_1 = set.find((index - m));</div><div class="line">                    fa_2 = set.find(index);</div><div class="line">                    set.union(fa_1,fa_2);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(j &gt; <span class="number">0</span> &amp;&amp; grid[i][j-<span class="number">1</span>] == <span class="string">'1'</span>)&#123;</div><div class="line">                    fa_1 = set.find(index - <span class="number">1</span>);</div><div class="line">                    fa_2 = set.find(index);</div><div class="line">                    set.union(fa_1,fa_2);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// è¿”å›æœ‰å‡ ä¸ªå²›å±¿</span></div><div class="line"><span class="keyword">return</span> set.setNum();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜æ˜¯å¹¶æŸ¥é›†çš„å…¥é—¨é¢˜ã€‚ä½†å…¶å®å¹¶æŸ¥é›†æ›´é€‚ç”¨äºåŠ¨æ€å˜åŒ–çš„é›†åˆã€‚è¿™ä¸ªé¢˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯dfs:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">char</span> grid,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>( x&lt;<span class="number">0</span> || y&lt;<span class="number">0</span> || x&gt;= grid.length || y &gt;= grid[<span class="number">0</span>].length || grid[x][y]==<span class="string">'0'</span>)&#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(grid[x][y]==<span class="string">'1'</span>)&#123;</div><div class="line">        grid[x][y]=<span class="string">'0'</span>;</div><div class="line">        dfs(grid,x+<span class="number">1</span>,y);</div><div class="line">        dfs(grid,x,y+<span class="number">1</span>);</div><div class="line">        dfs(grid,x-<span class="number">1</span>,y);</div><div class="line">        dfs(grid,x,y-<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numIslands</span><span class="params">(<span class="keyword">char</span>[][] grid)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">int</span> nums = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt; grid.length ; i+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">for</span>(j = <span class="number">0</span> ; j &lt; grid[i].length ; j+=<span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>(grid[i][j]==<span class="string">'1'</span>) &#123;</div><div class="line">                dfs(grid, i, j);</div><div class="line">                nums += <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> nums;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Number-of-Islands-II">4.2. Number of Islands II</h2><p>è¿™é“é¢˜æ˜¯ä¸Šé“é¢˜çš„å‡çº§ç‰ˆâ€”â€”åŠ¨æ€å˜åŒ–çš„è¿é€šå›¾ã€‚å¾ˆæ˜æ˜¾ç”¨å¹¶æŸ¥é›†æ˜¯æœ€å¥½çš„ã€‚</p>
<p> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åƒä¸Šä¸€é¢˜ï¼Œéå†æ—¶åªéœ€è¦éå†å·¦ä¸‹ã€‚è¿™ä¸€é¢˜çš„å²›å±¿çŠ¶æ€æ˜¯åŠ¨æ€çš„ï¼Œå› æ­¤å¿…é¡»åŒæ—¶éå†ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘æ‰è¡Œã€‚</p>
<p>æ­¤å¤„æ˜¯è¿™é“é¢˜çš„è§£ç­”ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">numIslands2</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span>[][] positions)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (positions == <span class="keyword">null</span> || positions.length == <span class="number">0</span> || m == <span class="number">0</span> || n == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span>[] island = <span class="keyword">new</span> <span class="keyword">int</span>[m * n + <span class="number">1</span>];</div><div class="line">        ArrayList&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> current = <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] position : positions) &#123;</div><div class="line">            <span class="keyword">int</span> x = position[<span class="number">0</span>];</div><div class="line">            <span class="keyword">int</span> y = position[<span class="number">1</span>];</div><div class="line">            <span class="keyword">int</span> index = x * n + y + <span class="number">1</span>;</div><div class="line">            current++;</div><div class="line">            island[index] = index;</div><div class="line">            <span class="keyword">if</span> (x != m - <span class="number">1</span> &amp;&amp; island[index + n] != <span class="number">0</span> &amp;&amp; union(index, index + n, island)) &#123;</div><div class="line">                current--;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">0</span> &amp;&amp; island[index - n] != <span class="number">0</span> &amp;&amp; union(index, index - n, island)) &#123;</div><div class="line">                current--;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (y != n - <span class="number">1</span> &amp;&amp; island[index + <span class="number">1</span>] != <span class="number">0</span> &amp;&amp; union(index, index + <span class="number">1</span>, island)) &#123;</div><div class="line">                current--;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (y != <span class="number">0</span> &amp;&amp; island[index - <span class="number">1</span>] != <span class="number">0</span> &amp;&amp; union(index, index - <span class="number">1</span>, island)) &#123;</div><div class="line">                current--;</div><div class="line">            &#125;</div><div class="line">            result.add(current);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> fa_a = find(a, array);</div><div class="line">        <span class="keyword">int</span> fa_b = find(b, array);</div><div class="line">        <span class="keyword">if</span> (fa_a == fa_b) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        array[fa_a] = fa_b;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> fa = array[i];</div><div class="line">        <span class="keyword">while</span>(array[fa] != fa) &#123;</div><div class="line">            fa = array[fa];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> next = array[i];</div><div class="line">        <span class="keyword">while</span> (next != fa) &#123;</div><div class="line">            array[i] = fa;</div><div class="line">            i = next;</div><div class="line">            next = array[next];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> fa;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Graph-Valid-Tree">4.3. Graph Valid Tree</h2><p>ç»™ä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯ä¸€æ£µæ ‘ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">è¾“å…¥ï¼šn = 5` å’Œè¾¹é›† edges = [[0, 1], [0, 2], [0, 3], [1, 4]]</div><div class="line">è¾“å‡ºï¼štrue</div></pre></td></tr></table></figure>
<p>ç”¨è¿é€šå›¾ï¼Œæ¯éå†åˆ°ä¸€æ¡è¾¹å‰ï¼Œå…ˆåˆ¤æ–­ä¸¤ç‚¹æ˜¯ä¸æ˜¯å±äºä¸€ä¸ªé›†åˆã€‚å¦‚æœå±äºåŒä¸€ä¸ªé›†åˆï¼Œé‚£å°±ä¼šå˜æˆç¯å½¢ï¼Œå°±ä¸èƒ½æ˜¯æ ‘äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæœ€åæ•´ä¸ªç½‘ç»œå˜æˆäº†æ£®æ—ï¼Œä¹Ÿä¸è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validTree</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span>[][] edges)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>( n == <span class="number">0</span> )<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i+=<span class="number">1</span>)&#123;</div><div class="line">        set.add(i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] e : edges)&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>( set.find(e[<span class="number">0</span>]) == set.find(e[<span class="number">1</span>]) )&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            set.union(e[<span class="number">0</span>],e[<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(set.setNums==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Number-of-Connected-Components-in-an-Undirected-Graph">4.4. Number of Connected Components in an Undirected Graph</h2><p>ç»™ä¸€ä¸ªæ— å‘è¿é€šå›¾ï¼Œåˆ¤æ–­æœ‰å‡ ä¸ªè”é€šå—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">è¾“å…¥ï¼šn = 5` å’Œè¾¹é›† edges = [[0, 1], [1, 2], [2, 3], [3, 4]]</div><div class="line">è¾“å‡ºï¼š1</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">int</span> <span class="title">countComponents</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span>[][] edges)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>( n == <span class="number">0</span> )<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>( edges.length ==<span class="number">0</span>  )<span class="keyword">return</span> n;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i+=<span class="number">1</span>)&#123;</div><div class="line">        set.add(i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] e : edges)&#123;</div><div class="line">        set.union(e[<span class="number">0</span>],e[<span class="number">1</span>]);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> set.setNums;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Friend-Circles">4.5. Friend Circles</h2><p>æœ‰nä¸ªäººï¼Œç»™å‡ºä¸€ä¸ªçŸ©é˜µMè¡¨ç¤ºnä¸ªäººäº’ç›¸çš„å…³ç³»ã€‚æ±‚è¿™nä¸ªäººä¸€å…±æœ‰å¤šå°‘ä¸ªæœ‹å‹åœˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">è¾“å…¥ï¼š</div><div class="line">[[1,1,0],</div><div class="line"> [1,1,0],</div><div class="line"> [0,0,1]]</div><div class="line">è¾“å‡º: 2</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ç›´æ¥ç”¨è”é€šå›¾åšå°±å¥½äº†ã€‚è¾“å‡ºé›†åˆçš„ä¸ªæ•°å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">int</span> <span class="title">findCircleNum</span><span class="params">(<span class="keyword">int</span>[][] M)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>( M.length == <span class="number">0</span> || M[<span class="number">0</span>].length == <span class="number">0</span> )<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n = M.length;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">    <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; n ; i += <span class="number">1</span> )&#123;</div><div class="line">        set.add(i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">for</span>( j = i + <span class="number">1</span> ; j &lt; n ; j += <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>( M[i][j] == <span class="number">1</span> )&#123;</div><div class="line">                set.union(i,j);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> set.setNums;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶å®è¿™é“é¢˜ä¸ 200.Number of Islands æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯ä»¥ç”¨dfsæ¥åšã€‚æ­¤å¤„çœç•¥ã€‚</p>
<h2 id="Surrounded-Regions">4.6. Surrounded Regions</h2><p>ç»™ä¸€ä¸ªçŸ©é˜µï¼Œé‡Œé¢å…ƒç´ æ˜¯Xæˆ–Oã€‚å¦‚æœä¸€ä¸ªOçš„è¿é€šå—è¢«Xå®Œå…¨å›´ä½ï¼Œå°±å°†Oå…¨éƒ¨æ”¹æˆXã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">è¾“å…¥ï¼š</div><div class="line">X X X X</div><div class="line">X O O X</div><div class="line">X X O X</div><div class="line">X O X X</div><div class="line">è¾“å‡ºï¼š</div><div class="line">X X X X</div><div class="line">X X X X</div><div class="line">X X X X</div><div class="line">X O X X</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ä¹Ÿå¯ä»¥ç”¨å¹¶æŸ¥é›†æ¥åšã€‚æˆ‘ä»¬åªéœ€è¦ç¨å¾®æ”¹ä¸€ä¸‹å¹¶æŸ¥é›†ï¼Œåœ¨å¹¶æˆ–æŸ¥çš„æ—¶å€™åŠ å…¥ä¸€ä¸ªboolean çš„flagï¼Œæ¥è¡¨ç¤ºè¿™ä¸ªè¿é€šå—æ˜¯å¦åœ¨äºè¾¹ç•Œå¤„ç›¸è¿å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">UnionFind</span> </span>&#123;</div><div class="line">        HashMap&lt;Integer,Integer&gt; father;</div><div class="line">        HashMap&lt;Integer,Boolean&gt; hash;<span class="comment">//ç”¨æ¥è®°å½•è¿™ä¸ªå—æ˜¯å¦åœ¨è¾¹ç•Œ</span></div><div class="line">        <span class="keyword">int</span> setNums;</div><div class="line">        UnionFind()&#123;</div><div class="line">            father = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            hash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            setNums = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key,<span class="keyword">boolean</span> hash)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(father.containsKey(key))<span class="keyword">return</span>;</div><div class="line">            father.put(key,key);</div><div class="line">            <span class="keyword">this</span>.hash.put(key,hash);</div><div class="line">            setNums+=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialization</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">            <span class="comment">// initialize your data structure here.</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)</div><div class="line">                father.put(nums[i],nums[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> key_father = key;</div><div class="line">            <span class="keyword">while</span>(key_father != father.get(key_father))&#123;</div><div class="line">                key_father = father.get(key_father);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> temp = key;</div><div class="line">            <span class="keyword">int</span> temp_father;</div><div class="line">            <span class="keyword">while</span>(temp != key_father)&#123;</div><div class="line">                temp_father = father.get(temp);</div><div class="line">                <span class="keyword">if</span>(hash.get(temp))&#123;</div><div class="line">                    hash.replace(temp_father,<span class="keyword">true</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(hash.get(temp_father))&#123;</div><div class="line">                    hash.replace(temp,<span class="keyword">true</span>);</div><div class="line">                &#125;</div><div class="line">                father.replace(temp,key_father);</div><div class="line"></div><div class="line">                temp = temp_father;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> key_father;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> fa_x = find(x);</div><div class="line">            <span class="keyword">int</span> fa_y = find(y);</div><div class="line">            <span class="keyword">if</span>( fa_x != fa_y )&#123;</div><div class="line">                <span class="keyword">if</span>(hash.get(fa_x))&#123;</div><div class="line">                    hash.replace(fa_y,<span class="keyword">true</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(hash.get(fa_y))&#123;</div><div class="line">                    hash.replace(fa_x,<span class="keyword">true</span>);</div><div class="line">                &#125;</div><div class="line">                father.put(fa_x,fa_y);</div><div class="line">                setNums-=<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">char</span>[][] board)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(board.length ==<span class="number">0</span> || board[<span class="number">0</span>].length == <span class="number">0</span> )<span class="keyword">return</span>;</div><div class="line">        <span class="keyword">int</span> i,j,index;</div><div class="line">        <span class="keyword">int</span> n = board.length ;</div><div class="line">        <span class="keyword">int</span> m = board[<span class="number">0</span>].length ;</div><div class="line">        UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; m ; j += <span class="number">1</span> )&#123;</div><div class="line">                <span class="keyword">if</span>(  board[i][j] == <span class="string">'O'</span> )&#123;</div><div class="line">                    index = i * m + j;</div><div class="line">                    <span class="keyword">if</span>( i == <span class="number">0</span> || i == n - <span class="number">1</span> || j == <span class="number">0</span> || j == m - <span class="number">1</span> )&#123;</div><div class="line">                        set.add(index,<span class="keyword">true</span>);</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        set.add(index,<span class="keyword">false</span>);</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span>( i &gt; <span class="number">0</span> &amp;&amp; board[i-<span class="number">1</span>][j] == <span class="string">'O'</span>)&#123;<span class="comment">//ä¸Š</span></div><div class="line">                        set.union(index,index - m);</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span>(j &gt; <span class="number">0</span> &amp;&amp; board[i][j-<span class="number">1</span>] == <span class="string">'O'</span>)&#123;<span class="comment">//å·¦</span></div><div class="line">                        set.union(index,index-<span class="number">1</span>);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( i = <span class="number">0</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; m ; j += <span class="number">1</span> )&#123;</div><div class="line">                <span class="keyword">if</span>(  board[i][j] == <span class="string">'O'</span>)&#123;</div><div class="line">                    index = i * m + j;</div><div class="line">                    <span class="keyword">if</span>(!set.hash.get(set.find(index)))&#123;</div><div class="line">                        board[i][j] = <span class="string">'X'</span>;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†å› ä¸ºè¿™é“é¢˜ä¸æ˜¯ä¸€ä¸ªâ€œåŠ¨æ€è¿é€šâ€å›¾ã€‚å¹¶ä¸é€‚ç”¨äºå¹¶æŸ¥é›†ã€‚å…¶å®ç”¨DFSå°±å·²ç»å¾ˆå¥½åšäº†ã€‚é¦–å…ˆéå†è¾¹ç•Œï¼Œå¦‚æœè¾¹ç•Œä¸Šæœ‰Oï¼Œå°±è¿›è¡ŒDFSï¼Œç„¶åæŠŠè¿™äº›ä¸å¤–ç•Œæ¥è§¦çš„Oè¿é€šå›¾çš„flagå¼„ä¸ºtrueã€‚è¿™æ ·æ‰€æœ‰è¢«å›´èµ·æ¥çš„Oå°±æ˜¯fauseã€‚åˆ°æœ€åç»Ÿä¸€ç½®ä¸ºXå³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">boolean</span>[] hash, <span class="keyword">int</span> i , <span class="keyword">int</span> j, <span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">       <span class="keyword">int</span>[][] dir = &#123;&#123;-<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">1</span>&#125;,&#123;<span class="number">0</span>,-<span class="number">1</span>&#125;&#125;;</div><div class="line">       <span class="keyword">int</span> i1,j1;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span>[] d : dir)&#123;</div><div class="line">           i1 = i + d[<span class="number">0</span>];</div><div class="line">           j1 = j + d[<span class="number">1</span>];</div><div class="line">           <span class="keyword">if</span>( i1&lt; <span class="number">0</span> || i1 &gt;= n || j1 &lt; <span class="number">0</span> || j1 &gt;= m )&#123;</div><div class="line">               <span class="keyword">continue</span>;</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">if</span>( !hash[i1 * m + j1] &amp;&amp; board[i1][j1] == <span class="string">'O'</span>)&#123;</div><div class="line">               hash[i1 * m + j1] = <span class="keyword">true</span>;</div><div class="line">               dfs(board,hash,i1,j1,n,m);</div><div class="line">           &#125;</div><div class="line"></div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">char</span>[][] board)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span>( board.length == <span class="number">0</span> || board[<span class="number">0</span>].length == <span class="number">0</span> )<span class="keyword">return</span>;</div><div class="line">       <span class="keyword">int</span> i,j;</div><div class="line">       <span class="keyword">int</span> n = board.length;</div><div class="line">       <span class="keyword">int</span> m = board[<span class="number">0</span>].length;</div><div class="line">       <span class="keyword">boolean</span>[] hash = <span class="keyword">new</span> <span class="keyword">boolean</span>[n*m];</div><div class="line">       <span class="comment">//éå†è¾¹ç•Œ</span></div><div class="line">       <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt; n ; i +=<span class="number">1</span> )&#123;</div><div class="line">           <span class="keyword">if</span>(!hash[i * m ] &amp;&amp;board[i][<span class="number">0</span>] == <span class="string">'O'</span>)&#123;</div><div class="line">               hash[i * m ] = <span class="keyword">true</span>;</div><div class="line">               dfs(board,hash,i,<span class="number">0</span>,n,m);</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">if</span>(!hash[i * m + m - <span class="number">1</span>] &amp;&amp;board[i][m-<span class="number">1</span>] == <span class="string">'O'</span>)&#123;</div><div class="line">               hash[i * m + m - <span class="number">1</span> ] = <span class="keyword">true</span>;</div><div class="line">               dfs(board,hash,i,m-<span class="number">1</span>,n,m);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">for</span>(j = <span class="number">0</span> ; j &lt; m ; j +=<span class="number">1</span> )&#123;</div><div class="line">           <span class="keyword">if</span>(!hash[j] &amp;&amp;board[<span class="number">0</span>][j] == <span class="string">'O'</span>)&#123;</div><div class="line">               hash[j] = <span class="keyword">true</span>;</div><div class="line">               dfs(board,hash,<span class="number">0</span>,j,n,m);</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">if</span>(!hash[(n-<span class="number">1</span>)*m + j] &amp;&amp;board[n-<span class="number">1</span>][j] == <span class="string">'O'</span>)&#123;</div><div class="line">               hash[(n-<span class="number">1</span>)*m + j] = <span class="keyword">true</span>;</div><div class="line">               dfs(board,hash,n-<span class="number">1</span>,j,n,m);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">           <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; m ; j+=<span class="number">1</span> )&#123;</div><div class="line">               <span class="keyword">if</span>(board[i][j] == <span class="string">'O'</span> &amp;&amp; !hash[ i*m + j ])&#123;</div><div class="line">                   board[i][j] = <span class="string">'X'</span>;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="Redundant-Connection">4.7. Redundant Connection</h2><p>è¿™é“é¢˜ç»™äº†ä¸€ä¸ªæ— å‘è¿é€šå›¾ã€‚è¦ä»ä¸­å–å‡ºä¸€æ¡è¾¹ï¼Œä½¿å¾—å®ƒæˆä¸ºä¸€æ£µæ ‘ã€‚å¦‚æœæœ‰å¤šä¸ªè§£ï¼Œè¾“å‡ºinputä¸­æœ€åä¸€ä¸ªå‡ºç°çš„è¾¹ã€‚</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Input: [[1,2], [1,3], [2,3]]</div><div class="line">Output: [2,3]</div><div class="line">Explanation: The given undirected graph will be like this:</div><div class="line">  1</div><div class="line"> / \</div><div class="line">2 - 3</div></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Input: [[1,2], [2,3], [3,4], [1,4], [1,5]]</div><div class="line">Output: [1,4]</div><div class="line">Explanation: The given undirected graph will be like this:</div><div class="line">5 - 1 - 2</div><div class="line">    |   |</div><div class="line">    4 - 3</div></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šè¿™é“é¢˜è¿˜æ˜¯ç›´æ¥ç”¨å¹¶æŸ¥é›†å°±å¯ä»¥ã€‚éœ€è¦è®°å½•å“ªæ¡è¾¹çš„åŠ å…¥ä½¿å¾—æ ‘å‡ºç°äº†ç¯ï¼Œå³åˆ¤æ–­å“ªä¸¤ä¸ªç‚¹åœ¨åŠ å…¥è¿™æ¡è¾¹ä¹‹å‰å°±å±äºåŒä¸€ä¸ªé›†åˆã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] findRedundantConnection(<span class="keyword">int</span>[][] edges) &#123;</div><div class="line">    <span class="keyword">int</span> j,i=<span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> result_i = -<span class="number">1</span>;</div><div class="line">    <span class="keyword">boolean</span> flag;</div><div class="line">    UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] e : edges)&#123;</div><div class="line">        flag = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; <span class="number">2</span> ; j += <span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>(!set.father.containsKey(e[j]))&#123;</div><div class="line">                flag = <span class="keyword">true</span>;</div><div class="line">                set.add(e[j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(!flag &amp;&amp; (set.find(e[<span class="number">0</span>]) == set.find(e[<span class="number">1</span>])))&#123;</div><div class="line">            result_i = i;</div><div class="line">        &#125;</div><div class="line">        set.union(e[<span class="number">0</span>],e[<span class="number">1</span>]);</div><div class="line">        i+=<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(result_i==-<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> edges[result_i];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Longest-Consecutive-Sequence">4.8. Longest Consecutive Sequence</h2><p>è¿™é“é¢˜ç»™äº†ä¸€ä¸ªæ•°ç»„int[] nums = {100,4,200,1,3,2}ï¼Œè¦è¾“å‡ºè¿ç»­æ•°å­—çš„æœ€å¤§ä¸ªæ•°4ã€‚</p>
<p>å½“ç„¶äº†å¯ä»¥ç”¨å¹¶æŸ¥é›†æ¥åšï¼Œéœ€è¦æ”¹åŠ¨ä¸€ä¸‹å¹¶æŸ¥é›†ï¼Œè®©å®ƒæ”¯æŒå¯¹æ¯ä¸ªseté‡Œçš„å…ƒç´ ä¸ªæ•°è®¡æ•°ã€‚æœ€åè¾“å‡ºæœ€å¤šå…ƒç´ çš„setçš„å…ƒç´ ä¸ªæ•°å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">UnionFind</span> </span>&#123;</div><div class="line">        HashMap&lt;Integer,Integer&gt; father;</div><div class="line">        HashMap&lt;Integer,Integer&gt; eleNums;</div><div class="line">        <span class="keyword">int</span> setNums;</div><div class="line">        UnionFind()&#123;</div><div class="line">            father = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            eleNums = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            setNums = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(father.containsKey(key))<span class="keyword">return</span>;</div><div class="line">            father.put(key,key);</div><div class="line">            eleNums.put(key,<span class="number">1</span>);</div><div class="line">            setNums+=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialization</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">            <span class="comment">// initialize your data structure here.</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i)</div><div class="line">                father.put(nums[i],nums[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> key_father = key;</div><div class="line">            <span class="keyword">while</span>(key_father != father.get(key_father))&#123;</div><div class="line">                key_father = father.get(key_father);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> temp = key;</div><div class="line">            <span class="keyword">int</span> temp_father;</div><div class="line">            <span class="keyword">while</span>(temp != key_father)&#123;</div><div class="line">                temp_father = father.get(temp);</div><div class="line"></div><div class="line">                eleNums.replace(key_father,eleNums.get(key_father)+eleNums.get(temp));</div><div class="line">                eleNums.replace(temp,<span class="number">0</span>);</div><div class="line">                father.replace(temp,key_father);</div><div class="line"></div><div class="line">                temp = temp_father;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> key_father;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> fa_x = find(x);</div><div class="line">            <span class="keyword">int</span> fa_y = find(y);</div><div class="line">            <span class="keyword">if</span>( fa_x != fa_y )&#123;</div><div class="line">                father.put(fa_x,fa_y);</div><div class="line">                eleNums.replace(fa_y,eleNums.get(fa_y)+eleNums.get(fa_x));</div><div class="line">                eleNums.replace(fa_x,<span class="number">0</span>);</div><div class="line">                setNums-=<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">longestConsecutive</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(nums.length==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">        UnionFind set = <span class="keyword">new</span> UnionFind();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e : nums)&#123;</div><div class="line">            set.add(e);</div><div class="line">            <span class="keyword">if</span>(set.father.containsKey(e-<span class="number">1</span>))&#123;</div><div class="line">                set.union(e,e-<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(set.father.containsKey(e+<span class="number">1</span>))&#123;</div><div class="line">                set.union(e,e+<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e:nums)&#123;</div><div class="line">          <span class="keyword">if</span>(ans &lt; set.eleNums.get(e))&#123;</div><div class="line">              ans = set.eleNums.get(e);</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†å…¶å®æˆ‘ä¸€å¼€å§‹å°±è¢«å¹¶æŸ¥é›†ç»™é™åˆ¶æ­»äº†ã€‚è¿™é“é¢˜å…¶å®æœ‰æ›´å¿«çš„åšæ³•ï¼Œå°±æ˜¯å…ˆå¯¹æ•°ç»„æ’åºï¼ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">longestConsecutive</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> longest = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (nums[i] - nums[i - <span class="number">1</span>] == <span class="number">1</span>) &#123;</div><div class="line">                l++;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[i] == nums[i - <span class="number">1</span>]) &#123;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                longest = Math.max(l, longest);</div><div class="line">                l = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        longest = Math.max(l,longest);</div><div class="line">        <span class="keyword">return</span> longest;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Accounts-Merge">4.9. Accounts Merge</h2><p>ç»™äº†ä¸€ä¸ªaccoutsçš„listã€‚listå½“ä¸­çš„æ¯ä¸ªå…ƒç´ accounts[i]æ˜¯ä¸€ä¸ªstring listï¼š<code>accounts[i][0]</code>ä»£è¡¨åå­—ï¼Œå‰©ä¸‹çš„å°±æ˜¯è¿™ä¸ªäººçš„é‚®ç®±ã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆå¹¶è¿™äº›listï¼š</p>
<ol>
<li>è¾“å‡ºæ¯ä¸ªäººçš„è´¦å·åˆ—è¡¨accounts[j]</li>
<li>å¦‚æœä¸¤ä¸ªäººåç›¸åŒï¼Œä½†è´¦å·ä¸åŒï¼Œè¿™å¯èƒ½æ˜¯äººé‡åäº†</li>
<li>ä¸€ä¸ªäººæœ€åˆå¯ä»¥æ‹¥æœ‰ä»»æ„æ•°é‡çš„è´¦å·ï¼Œä½†æ‰€æœ‰è¿™äº›è´¦å·éƒ½å½’å±äºåŒä¸€ä¸ªäºº</li>
</ol>
<p>è¾“å‡ºï¼š</p>
<ol>
<li>[äººåï¼Œè´¦å·åˆ—è¡¨]ï¼Œè´¦å·åˆ—è¡¨è¦æ’åº</li>
</ol>
<p>æ ·ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Input: </div><div class="line">accounts = [</div><div class="line">[&quot;John&quot;, &quot;johnsmith@mail.com&quot;, &quot;john00@mail.com&quot;], </div><div class="line">[&quot;John&quot;, &quot;johnnybravo@mail.com&quot;], </div><div class="line">[&quot;John&quot;, &quot;johnsmith@mail.com&quot;, &quot;john_newyork@mail.com&quot;], </div><div class="line">[&quot;Mary&quot;, &quot;mary@mail.com&quot;]]</div><div class="line"></div><div class="line">Output: [</div><div class="line">[&quot;John&quot;, &apos;john00@mail.com&apos;, &apos;john_newyork@mail.com&apos;, &apos;johnsmith@mail.com&apos;],  </div><div class="line">[&quot;John&quot;, &quot;johnnybravo@mail.com&quot;], </div><div class="line">[&quot;Mary&quot;, &quot;mary@mail.com&quot;]]</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¬¬1ã€5è¡Œçš„Johnä¸€å®šæ˜¯åŒä¸€ä¸ªäººï¼›ä½†ä¸ä¸€å®šä¸ç¬¬4è¡Œçš„äººæ˜¯åŒä¸€äººï¼Œå› æ­¤è¿™ä¸¤ä¸ªäººä¸èƒ½åˆå¹¶</p>
<h1 id="å‚è€ƒèµ„æ–™">5. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="https://stomachache007.wordpress.com/2017/10/23/%E4%B9%9D%E7%AB%A0%E7%AE%97%E6%B3%95%E9%AB%98%E7%BA%A7%E7%8F%AD%E7%AC%94%E8%AE%B02-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8A/" target="_blank" rel="external">ä¹ç« ç®—æ³•é«˜çº§ç­ç¬”è®°2.æ•°æ®ç»“æ„ï¼ˆä¸Šï¼‰</a></li>
<li><a href="http://blog.csdn.net/dm_vincent/article/details/7655764" target="_blank" rel="external">å¹¶æŸ¥é›†(Union-Find)ç®—æ³•ä»‹ç»</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-DP-æœ€é•¿å…¬å…±å­åºåˆ—]]></title>
      <url>/2017/11/05/%E7%AE%97%E6%B3%95-DP-%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97/</url>
      <content type="html"><![CDATA[<p><strong>å­åºåˆ—</strong>ï¼š</p>
<p>æœ‰åºåˆ—$X=<x_1,x_2,...,x_m>$ï¼Œå¦ä¸€ä¸ªå­åºåˆ—$Z=<z_1,z_2,...,z_k>$ï¼Œä¸”Zæ˜¯æŒ‰é¡ºåºä»Xä¸­æŒ‘å‡ºæ¥çš„ã€‚å¯ä»¥è·³ç€æŒ‘ã€‚</z_1,z_2,...,z_k></x_1,x_2,...,x_m></p>
<p><strong>æœ€é•¿å…¬å…±å­åºåˆ—</strong>(LCS)</p>
<p>ä»ä¸¤ä¸ªåºåˆ—Xå’ŒYä¸­ï¼Œæ‰¾åˆ°æœ€é•¿çš„å…¬å…±å­åºåˆ—ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>è¿™é“é¢˜æœ‰ä¸€ä¸ªéå¸¸å·§å¦™çš„åŠæ³•ã€‚æˆ‘ä»¬å…ˆå®šä¹‰$c[i,j]è¡¨ç¤ºX_iå’ŒY_j$çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ï¼Œé‚£ä¹ˆï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-06-14-01-29.png" alt=""> </p>
<a id="more"></a>
<p>å…¬å¼æ²¡æ˜¾ç¤ºå‡ºæ¥ã€‚æˆªæˆå›¾äº†ã€‚<br>$$<br>c[i,j] = \left{<br>\begin{array}{c}<br>0  \text{â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦}è‹¥x=0 æˆ– j=0\ <br>c[i-1,j-1]+1 \text{â€¦â€¦â€¦â€¦â€¦â€¦}è‹¥x_i==y_j \ <br>max(c[i,j-1],c[i-1,j])\text{â€¦â€¦.} è‹¥x_i!=y_j<br>\end{array}<br>\right.<br>$$</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">LCS</span><span class="params">(String[] s1,String [] s2)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">int</span> n = s1.length, m  = s2.length;</div><div class="line">    <span class="keyword">int</span>[][] c = <span class="keyword">new</span> <span class="keyword">int</span>[n][m];</div><div class="line">    <span class="keyword">if</span>(s1[<span class="number">0</span>] == s2[<span class="number">0</span>])&#123;c[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;&#125;</div><div class="line">    <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">if</span>(s1[i] == s2[<span class="number">0</span>])&#123;c[i][<span class="number">0</span>] = c[i-<span class="number">1</span>][<span class="number">0</span>] + <span class="number">1</span>; &#125;</div><div class="line">        <span class="keyword">else</span>&#123;c[i][<span class="number">0</span>] =  c[i-<span class="number">1</span>][<span class="number">0</span>];&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( j = <span class="number">1</span> ; j &lt; m ; j+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">if</span>(s1[<span class="number">0</span>] == s2[j])&#123;c[<span class="number">0</span>][j] = c[<span class="number">0</span>][j-<span class="number">1</span>] + <span class="number">1</span>; &#125;</div><div class="line">        <span class="keyword">else</span>&#123;c[<span class="number">0</span>][j] =  c[<span class="number">0</span>][j-<span class="number">1</span>];&#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; n ; i+=<span class="number">1</span> )&#123;</div><div class="line">        <span class="keyword">for</span>( j = <span class="number">1</span> ; j &lt; m ; j+=<span class="number">1</span> )&#123;</div><div class="line">            <span class="keyword">if</span>( s1[i]==s2[j] )&#123;</div><div class="line">                c[i][j] = c[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                c[i][j] = Math.max( c[i-<span class="number">1</span>][j] , c[i][j-<span class="number">1</span>] );</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> c[n-<span class="number">1</span>][m-<span class="number">1</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> DP </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[è¿›é˜¶-ladder]]></title>
      <url>/2017/11/05/%E7%AE%97%E6%B3%95-%E8%BF%9B%E9%98%B6Ladder/</url>
      <content type="html"><![CDATA[<script src="/crypto-js.js"></script><script src="/mcommon.js"></script><h3 id="encrypt-message">Please enter the password to read the blog.</h3><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css"> <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"> <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script> <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> <div id="security"> <div> <div class="input-group"> <input type="text" class="form-control" aria-label="Enter the password." id="pass"/> <div class="input-group-btn"> <button type="button" class="btn btn-default" onclick="decryptAES()">Decrypt</button> </div> </div> </div> </div> <div id="encrypt-blog" style="display:none"> U2FsdGVkX1+bnrUhaA+vX3kkIoSdxlD3YVA3/cVPRBMB61TemMZmA+H+cwnvwfMwkKGWjYe70+7MXIdF7UzG3akp40lTMlUAyVWaT8katRwDXk56CdrncTDrgVfS+yeZfQHjDKq9sGjOD7qaed9LHErRkufCySqWBEBOt7lKdTecDB4aIJe9HRGGiTfxWjREfLRkfwpGhgFwyGHyqq9afa1ihXDaXJXLZIU/0ZKwBPetoOswuZB/hYqJzXVA1i9wpw9l9YDGI1m6ogsoLVSpvn0BAKdNWQWi4j4iPxi3EWhB0aBbo8TA6hbxiKAx+0VCJIOMn7Ijpw5f8OLr+ia1gehW90x3xixqhk2nrRqerh+J/8AVD267wKNGFR1fDPWaRsnHW/ZJK9P18jjY0eAvrTvOi4us++ZBC/CnEvUlNt0aPuUpH85Ii7sNu2DU9d6uwSJS+zCshHy9w8REqH1gGTXr5rLeMpB1HbWLgR2Vls6wcEy24PTMrjIWbwmU9CsczuxmmD9YT1DikjohG0yd1FOu36TlNLSQKQPgZAc07Gq6XwkoTU1dC4W1UF5r84r/L+Yc1LYM+qC3pCROjJt/m2skHCbgYoKhJifWtZDdIozkyjQVvLOx2FEXKAvv98E3HbmwO1HavKvoyUc/wdabV9G2Azo/U1YXq4FyBjliFsJviwJ9ilNmyk6mtx2/Oa+MczlffwdvS2V5wh4HwxM6cORLgJyyzYUXrhTJ2cP2jQ4VL4IwdreLsxeC1Hg2UarLpKWGmFvdC6PNkScYh52k7Kxi8YHDHAoS9exDdTaY/7Q9wqrNO42ulMl0pVZuVCclgAB98EHNWdYiyhZSs6HUEhBE2YZpjWbFJiZ6C6sXKx4XJ2KvdUQDTEfg8R3VIyIYFBSlHmhsPQe+k5tT0p7USul6fbd/ve9vBkN6ZmEMoc+zO14hya7gnp6fK4OPSxnyrBigyTdHvdDaOBQacEb3CkyI3hBsW5TkoHOunMZoGUn/wRDaoktIDBh3egDeGT3cR/NIAEg/oZjfFmFzu1uvy3rvKO96QXakweksQT7hgxPie0F02qaaDSkAuSXEoeDy1kWQlH/wYAUdYIfBC7rLTOWhyeT5iZgYmK8xKf1FCQL/AamQslK5UAfhmqVlbSPNtCKi4ZQ+KtnP1KO/gIP///Ahtf9AFESYJ6ZG4/5P4J9gpHCtDCoiRMksLAOqEB+GhoXUE2B8sF5nGS+IjqM7qEbvX+xo4R1Max7vYhgciuatozv+Xs/QvIHNheY/K0Ln5j+Xg2FVN5kiNLWR2/vgRc33z82WolNCqTCjg+bp2TSNYhhWYYmk1/j3ThA7YoK3dXbjXAy5C0ZSilz8BzIOhizgjByHgqdMA46JiiMlb7TF4mwU21Y8pj7ZDBuNFb+yw3GtC3QYPu8pMreyHBSr1p5n5388egdupY1ufi2r4Mh9fS0IHTKfxBA9KsU7XEXbSzFTyqd66af0uKSds2gbcz+lzPjqoaRxrBnOGOoo05boGtNtsMQrUzTmT45Wzo/XqSEIKlqohQo7p/fSBPHu8tmZSXNUodz67SNjjd9axyqZVgPSpMMeILrO/kT1+7zsiFurmzJtdX3NQ9cRqZIaPEx11XP/dMy1DlJBxZTgKA3iDxkhY8kDeOEqd3xBx6ipu1A46UOMaU0EbSRvpzaQ4jWAtA+9Gh+zjJ8EA0J5Y0UELoHiHdkOlD7p66wH1Xuq9o8of8xcimiFLCdBSfJvEcVkioKGjtvP5fa7wowJQvN+ckboLTtIBINjBEA4lg1x5oCn+SP2M8HypZ9Da5IjwHFYGNuzAsgI3YHLt0pCAt+q5hYimKmLTohR3WnHyGf+cKKDBYxK8QDuSXPs4FB/fu+KHuaiblfkDDzmTIaLdQ0ZBENWbUmkHibbmzXAg33ngu2F1plq/BQ6qyQ5C3luB9ml86v8SXyV3dlK7U8HLCuz1k+F1uVPkRoqNGsvcXZNuRhfx2tX06BK8h2tWMkgzT2/p2TXXtQfWDzm8GhXPhO4Tq5FqXynXGONYUOBS+M0MgtMbXC+wjEo3SwXTEhBEjYL8ChzMdf3B06xtA7zw/Bbn45Tk3jXJ4l6wW3cnfGs/UHdmhd1jO+IwX/S7rXvR4U0mphlgA/ut3Ku8oJzuN2HfaBEijUPojGAwp59Xw82bUC4ih56n6X+aAqgVjwlFAwPbBMeBkrRDP7yZAIvHuHoUUsbhk6T24a1+RqCnXQMGtTo6SZC7Kkm9aU3oC+Ea47TORnYH6GU7HZx4e5suSGvMWy+vXRKN0yDioxMFIsa+PKcq5c+Z62gEOf1MLx6KmmjvKypl0eBFhdWtFNP1eMF3+gmFQUBFUKVohwu2wQudK1W+E9IYvuBKV5dR/fc9r8eqbJasalpgNtg9W0MIPI+0unCfkgntTkn3qVJgCHvMC8zIS61bD41TROeNB6482sBzMzMBc+RWTw/UgnJE/hFlCUt9UW1uaifSApSPKBsGtyIRaM3bMFxC/xVE131EtfLsVo4Knw4w4E8JhBlnmCxJXpESr3ThIqcxlNA8heCdhsPWu+5PHEiT5GOpjiiYZnsUUFhekPYvam1tMenxV4nV9+qMr3T9OP3Q84cuF2zW/KsBxk1RZY2iJAajCGqUnJEZ8oE0XzBe1to3+ow/d+sWuaTldbutv2EnwIWO4f4YteuH86j6Ec8b7KbMI/1mJaKtDPA0a8MHJgPxsGlx1db2EiWwVawAxeKFvbhLE5LynKYAgzj/pSzh3SogK+t03RgmV8QuYMM3otxLLTPYK26zEAAc19XYgQ6etSe0ZfRyDTaLNQYz/35ScN8RvNMGzrIa9xMip5mawuxUKA1iXN8X42tON8P5gdMKyaNDLcRgLilxGzNmxwJjFLGoe5qgIOiW8+TWkZxf3IvKHGg6/3Pca/exx/g3FW1HZxmt2Imtkw7c2Vp53gknMj5FAAvKqp4Obbnqpa5ZvczMKpG1XqKt8UdDofSCqNNUnsAGtnsi4F26XQBJtVj9uPu7u6O+axjTdLzb20ydB4mQkmfZHVSy1R0ok6ypUqJxAMtGI0bRRLnuOery6mbQ3wq9G5HkUpTYrEM1y3t2V1j6SaFAPN5EiHJ+0PaY43hACrOP4aY0J5E7k+o79sH1UFbZAoiQN+9PvMRxSsfMyd/5SzN2L0vZ7pcXmYU6LQmxeAph7NAlgGdx+fccvhf6lLOZUyKNGVwjbt7fGa4KFGM+SFYxo0SCmPLg8rm8gy7mNFl4BJ3sko+hQq6nZ28hlYA2w8qi78fEFpEEChubwev7+1MI/rT4myHXAgm2Z2VxeIB3IKrvybbEgRsML/BLlO650UQ9yv22aQpCLlFQPlLbFF5+cdC1EUJZap3WQr0OFVXsS/cjcHVM9fWboQo8PJA7XjlkcKxYnkz3hXrjDz4AVKVd6VoL5XIJeM5azgb6mHfTl39Huju0xFr9ex7rM9YQ3m0mF6nIMspX9vx7m4nnKP+086T4/NblLer0WYmIhYnTbJxvPYFie1lqaUndeRrKDckIeT3uQrOELDmPpZ2Tv1npTLIAhA8z3fQzs9jqmQRyAFuoZ8EpW8XFCkF4nqJ/kGPgsfTZwHHBbFPiqBzopvGMcby9QuCWd34R2o/j/88yKlT5EK5Xt/Dn4a3z2niKpaCN4ZTDB3CTa4bCklpZmhRao8KfuLUL448d8DWrH+XgWqXon6DxpUsljazf3wEQiNfObdwgMtYSHgFlpdiMQTdHJ1HDKJUwE9NJBPPkX3+ceAk7TBV3flu+vQw+UuxRPqBmVnrmwWTDBKc/dX2MPrZV3P0SjnQX4TRFVZJJU1gkZ3rXO3UdXHeZSpHE5rqaPfd7xbzwo9DuLeSNPlEJICjIUDkIIJUEwkRvAudsWrNhjYtyV4H+DOhW2JgPXPh04ndTsaH7D2k2j7yn7BFC7p9FYmAI/xfbwA/zRPkRYSM3CSfjsL4R0lCw/hCKzee56ZsL1MzfCzNv3Ukx9PZzsMaqFZ2U2NfIxHyjZ9iEhWwfFyWmVCVwci3ylJxWqiQcI3itKOk/FiTR/YAH1OrIUN8cScqk/dVWb5uLd+Y/CbT7M7krgjozSN6Rw+dIFFJWSDXy6wXGeha7qPcIl9k5/rfuuJ2VN+UQ3YYhAjTxozoqCoR3XydZYNEryjh+xT4/silz9Czk5ylj3kgooRgVjmuHmoDZQAhQI3KalnObcQBIju0IK05H2JI4hjYXUKdhoekXuY2+emX0lAnp+MI//HriXW/i2lE4xfBnLg0gKEf/M+JydWio4hc+SG+bTBjov+Tq+VhdA7zZVq7AMDInmPXMPABuw2IWteXbODdxjtGnlCU8ioCHQIReiNnyeEvSmv93/fE7Ah9iyymqydssGGpodx91R5AjHuvpbf6s9InnTlVC+0IS0T29gDhcee6dxK3Nev1n48jgFp9HvTvpezhCRDzzczUoAxAP0LAKUhZbFqQCHs89Q4MZQ90dBObLIjpqQ897qCxKFCpe/Z2j/ckyXKMQx8l7/ju4IVuZkyXYEbtXcvKlmuYnp3l2bCCWxtjuSTQSmYRl2U2HOVBzROlR8ae49aEvBsASdMrBzopj7eKj7KvusSHHcIX2tQ9C7q0rhRIfB1wgr530FQz3WJIk9fzvODt1GaDmmj4MwoSjVjFDW/cg7Wa0p1l/0lQzuUBMVjCWgRw906/SQLOKzYvEzGi5RtsjOcAJhst0YgBSFqqSfjCgNzARdIjWiVmcSGQGCScHCioYzIijro9iv+OXInptdK5Dkl+ZyXM4dWE7NWNLkOTh4WUlElaiGc3frvG4vsTKXXD6Zj7pCL1PdRrnHWTPyuPzNPHsmnL5QorcjOf9R9kgBYDFQsCRYJA/bCUHTw2c7zlitgAFbFZG1lpmCSjixJFmVLEiRvGP04vTa4icy7uGYz2x2KMBI6xb8C2lDpqfziizExe4wCNA3ZGxhHzk33h26pS2Si7bzEtLwOgaS40gM63d77GtWr91MTbuPqW3r9NafGR4vdEnHa0OH78/2m08ez6JWFGqe4SAlAbKLRkIHI0VSVC5f9r/untP6KftX1R5lmvTIDTIf87a7uRj5sbf3vJ9tpvIjVj6KogKxHBAr/9z9YIKdLR28Hv3J0t3gW/Yn8Ifl0rWe6vWOdMtbPQPPdLyXZNDYhyPEOxP0qCparmA0q2Xb7aTqsgI+3barDT+vFYiF7Ti4zGEZk/BO4whsob7Wv99I1y4ma5owjFwQ6xu6hVnOq05CdWjy9jsN3Wt6qi0EoUeBX7LIYwUDac5wZWLwKZoIuzfqlaqSY86ScWOGotwTcAN5f84+8JMpxO/wTQlhddpdvWZEBWBvtpHPBtsu8wVJt60NlwuBb/nvRpwqiPDcywoefJidj9qr43nQslvBIWJW8hJY8tWiEYS5S9zwJixH4sX/GjW1mMSMOpcpTo2FFCo6883msmueZh/2nF+GENAi93akFnhZ74ihz/+actjfbS6rkL1Pvj8chWr9anObBgNWQLHrqc3MtqY5/8lqfVhPVpupdMAczgAz1tRYRMkfHf1oIBYQsWo9yqDA0O6CUcgSB7b3HVFTnrozuM9KydYsBAhov13Li2E5SS3EQIkA4uHfp5G3rfAcWZ6S3bh6AkYMICuT3hSB1K+UWqUAg2u9dB1tGrNZjyGBD/6F6dixv3NMqU13bA7dIV/J3ucAJP+/F98wDK2Lae4duOsHp+DG9o3t3sMq9e8SFrlxmJBkXHyBsdKayndYYr5Y94Rrny0OugyJ0rPAZlBD03eM13IdgMye3YJtFZFF1Gpyliss/eGGYuY+P6kNTIkPLwCS5r8c+sun5ypeNJ2TikTxa0+CcE7g1pdzbNUIhFiIOYJtF6nxSop9EhxGVVDDDeL8Mwq5jCVJrC1tkIjb4V5lFc7qAF3Wsy0GSRiUGQ+sLmoqQ4YKqEnUyX3TJLVnKkLqDS4xrxUUq8cysrvkSOVKwQ+cNp1ZfBzItlZged6MoEmAbbdlVRkpJlDnvTYuNAmv8ICaokqN4QCaMQPoRciutT3GgGagwUoCzBTQ3jPmnWNsBR+KtQFiF5CCgnIMKN8/hBELimlE6Gz/P86WB1Q7KKQ9iXNlUiXEqj0GLsQ8ECaNZCJcM9KgN6fze6LSzC/K1Yhb7OmVLnYBJypArDViRefQUpyu9JTqcUw4a/nE7JSxTx9cxH3AJcgcTKbE2wb49Q7RW/FoX9+KFrkVdmNKxgM1cCfhsktL2LhiDBsZdmIZoFYL8X3nFi2XVX1gSO2IbvXNR6EtODfUvafKJSBcuZFsuIwQKKbL85rbo8GauOQKR3qRGgG4Ek6mOaKZ2sxKVAXBPvJk82DrmEm5dELM/oC4YV3rzr+AqvfWbJHbW/js4JDrk+/SIE8l8SWwhUnZf/rPOKm/IMVcVTgLxusJzpDVrMrYZ6zfJ2RjfP0/+OGRlic25yi1ATC6jRHVWFr6ucYUw1p6eg0yHF1Kf0A63YAbykuA5TW6Hl9m2DKk1JUHcvb5CdIIS3FlWtbHM46WfSEzVoxeQPozD8t/ElVOF+YrOEz2nQhXHrsaFKtwG9jYb4Z8PJeJ/0HrJLk6nQUz+RNNemQc4EGWh/D1CHWlHcdIGLolrQ4GdWPoF3LF4lWkhcULHdUjch615zMoWqxWPQ1qbhC+PtEl6cYgQltpZv0/3hIdLDOjVav68kxFlrW5HPt8An5twGFYcy0qnVi9t+yypPOu3hnHDc23hQshY0yU00sEFce5wzgfnljCQ2xieJIPqPwxpsBj93RSp8J3/YAF7t+UaVLeAF68nEVoQEd+MtVV3esSNBqHP3aV884wg4qPbt/wYOcXV7ikHbSTcv24S+JgfZIqYwuoRgjs77vBUo4ilMARkSX8ZIF06sAtdjtbE9qMwYTeRRHqoFcvKXGpVyamo7XNmd10P1mVP5XioFy3MC3e5nHmfZqsSwVLQnSvoxJBcIMlskZbNLJaagr+LhrA8Tw1jlJeDO4XBCIRKP0vEw352ob/eLIgIolU8Ui3Ya/d7Jtc2XKoi85/VWPmQXbqnFBAy/0P1hzYQkq9ko3MAN02kchCF+BANWmLfm7mghZOiM3gGnzDhA+aRTx0hETw4pe8gbCjzDawUDrkARXyrghiBPlOYC6a8tY/8tUesaH1ikksE927sVdcnJwozrSSzGeLRq3Z3S4SKtYvd+JYrLjblyTuFBPJC1+u1ovoPF7v03iROra+rTRq7L2jNqqBUWDpJl0in8UMhS8AA/8mxX/hlQDfUXu9Qe8iN6hlWMNiMwq5oEZHyNb5zMm5okHE83tb2hb5QKQAdf5Tl40ePcH8+KjobtED6o4rq5nSiuhProznzCykDEB2nq7rru8DYxk/VXiubFMrQ3enq2il9Tqrf5W6eICNQlAz+eE2UUfH3MMJhN3j+tblbCitFxfL9dMnYWDkl6JuNkV55h2hJDwbuy8BwATzN1RAaS5PNcucQ+eNeigFSBATywWY9RrAKczklWBb+KfS21tU1l+lpiPDZINCMY0dWLNKAQ9xwG3OCl0/5Mxgt6LEmFL5kcUoeaUgM++WYQlRjdxPVfr9r0AwJ67wBtldw/44M8quNFwX+79Ecakh8BqkJ7Gm+Lr8l5o+IbS0+Njflevw2Ab7Zhg4rux6q/fEIdiQOn3WuKoHtT97jwWAt/7TaDoLcsYALsjtWC/abv8FjfWeYgzd4BOu2N19uFO8JQLD499LJiB5x13dymM88yMiRHFKWU//dqutGAsBoPmTMjpd7mPCkkdxqSzOp53/ZE6SPR4ipgoj7jtHz2aMLgTvi79CASwUUwstLGN0HufLqEPL8d1HWTfmkACHZLwFQgUxSvQiKFTNPwBGFtYsWQ+cUNiFvBDYw63fSGV7qgwMjrt2KGSmKapFj+Q66t8Z0em2glcz09DIldShlsT2+N3tfMAWqvh5lGS2W108eP1JI9DE16/fswWj2+WxX8O1umjirk+Yv/hbkR3z8q2JBe+APEcaYbFnSHwo1Zy+0SI8kiztUWN50y6Ky13bdF/qTjza4HooF+68t0v2Pm3zM2VSdMGE5ww6+P1cqnsdzd2H4w5VEu4q5TD8YkvLRSrRXq8sJdZRbCvFA3+F8w1etUzW48LOdrmecPwm6a5W4QXfGvwumluSN/yKcrCJzAuJEZW4ICCPF4hmXBGTQtJy1mj+tDKzx5HfTIW6lyaa4N2WfsCGncgeju2KbWZxdKQs+tQ3+NaI5iMNKW2EWw2mCGwe8hKZYbw9NCjET2k2PvV3vaJa4IOBJ2WArfs520EovtBWPvOZIZJSoMov0V3kNn8tSijGiMthLHCGdSja3B5JxLiPqSIXD58ItY07ytDO4hr6k5LV8lA4HeAUrMcHBqx2F1HV5o3LLjxKpZWlayElPhpBUn3vvP/lzw85NQ6trYYmnUT2YzSowyWlmQ3y/jTh2w0CZXryd/m7c6f/N1Lud/87jQl3krkk5aBPsBt99caS0OynqReE0ev1Nf6k8MehftmTB2L2Rd5sNgqyjQND36U2gw4EEwPsou2Q0a7dDhHMhn1A/zoR2eHPa6dp9g2vLs7P8bisRTUOugM855auZwJty8iJcCBw/zpZQU2ecx5G5AFopud6hnP2eRjPd4r3Pg8AJbaGGfWOhoa7Ms79cBV/ABluKqwLSf38VNqY4sOulJsa9Ie37aMMf2ufP+iGYAU6r10vxLv6Abb20kEJ8ySFKIjOfP/8QCNnDrKu3jVQKPh6zER5OdBTS7EkxUP8SMJy4CDFQ2m4U/o+EQPwmNAnQHnrNYANOlVsl4WX0b3lVxRhnFVIZb2an/vNbYy3e0OeFC5YXSKAj0KqjFHPQGn1M6Ebbo7WRCBzlYNcSYQIIgd0trws9LziK7XFJ/kAuTto4DYFiY/UowQEIb6bPfL0iTRS+E9EOJPSDq9A/kqiUznhmngpX4s5w6SSydIQ2NwoPcumu8pRYsLj9u1wztHQwki1TuwZyAfZIzT18IknQkXdLrCGUOBXrHgoAsW9lpHq2oFxaEvfL6TdRV8sCXPJrxH0q0Vv/qOUw7dPacTebehP4c/7605z2U18n3g1OkFqT7+z4KUP3ZsJf7BHIOer2rR3krMmGCVgrX6o7v6nvA5bHMEE/sQ8o1wVIe0NDXrd2tff8fjVozh9JCE/CX0F29rj2DznygfRTqPo5chjtGNdDujdlZ0e6G75jogszI5PBLl9GXLTGi3gV78Vjz0mkAZtpFqSIVahOPpdoCoWKbBas9ltOfKp4ld86GvwscHn+aJ5AR2AQ3CBqXG+t7iG4pyTWfzT6ybXdrcE5cHSUyo/n/pEM6W08vfwJ7TeQ4mfpMaPGGWBHIWifMQzJ2Na1SXQ3NdpcOSgmkXmACOxOwiWc/Uju5d77CdmQxXr9VE2t2TrRJ4rSPDlTmX9FRSV1wvP5QJVjNFQXs2fDylhRCwIwdmlSoemPiBmeDLLXcm+PstUAMJ77FcAaeoTwItSGGdZN2uA9pPTWlT2AN8IAP8j6XwNM2HzLMAKC5DpqJFfzmDU0m3prdMzu5GUymJDH6Og9vg3j6P7MW5/2RO7ztF0dJ5BUfZTDu0T5bHGInChZ6evGqpYA76bTS8N4p9zWHIU7LijEUYi5lnrbfoqa0kxQjeo8VvRlHbXlsZL4CA3d/o3eD2DhKIvZN65d4Oh+JMkKsYCYcC84aMFUzCj8w19m9enAuNLhfpaa/r0DIntvjQZ8DsEcCQVOG9SbAkabkSWBH0uQKywKRU41JcVOidU80NdJJXILs1h94tS6Fje11YL6WiDaq4lWz+cVT2VIZfgnh09uVaLXC7kV2JXgmqQKnDZg3eeDsB73obeWvNjU6f+/pTDdrJKJHKZFEpRwFsiXRPsK2GP4U2VZnoRN8JTaktumsJ7dm5WBByr5j5sUycDyEaLEaKTBKFanKHxrUOpRTc3v1R6g37qP03Ld6trspgCWgn5Ogn7Zt4ag0Xc0RlF1uUBHs9e1JeCt3ETaqif982sptvFi0fBCLgZj1TrNK4UgTcL/GO/fT38ELWygzBgB2Lcn9QamOIfNgj1oOeS3hb1YhFUSHgONHob6MCc+PHSwmdC6XHjnA4PEhIrkuyQAvg+Ygovya/3pPo52H9zirppVVtig9XtBF3wWt0gvLr9wFKVqCAQC4knH9abktRiA12NrZS4ga8OoEcewvFTU8KoXNDABM82JnlfrO1oj9uXEngfiKeybGTl0NwpIKyszH1KHOYMx2NcPuRgKDfFidVKC/5uY1OICyxfhoAOehSND6l8PgOdHqeW30fahS7lOj7vH0LvTiNvTMqvbMlgSqNgc05wjrjlr4Zn2pRIaJE12qGCXZ5Z6Ac4JD7gJ+5vzMtMDnlUbb5OZ+jy/Q5A3c5NWj8P6cH9E/bkrgtyKSSnZbkZTZMYz1Qe6mUsMK6qKWxU5XGdOCM983TbgaVW/OB0X51EZV4TeekYxWJUFHaHK6GlrELc0Gl4ZqcpPYTmeRVC5igU21QtCo0Y3GrY/CiQnuQ6EaYeZ3yNdb1X/uBDCtw65jTzOHLgK4TWC2Mjr69sHz4dlxV0rXDLsla0i8KKfG+hh24Jwz43CFBPM4/b9qC1QiVYb05xMJHX1c2hsnCHtmUHogryI2ZtyHBV91HtDQepfPOm9NkDIzZzQQtsvcjEQtO7ULqHM6gLVRKbBPCkECXmTz3GaKlwh5RS/INpMmwDheYTzIQU0Qv06KHVYoXOJPplDnDwUyhxz64LISIG8IpUDq+iMlA8b/WUluIkjXUhlkbZSVWn2QI9UE4Cm973db4zNTCmTOOUQLH3wKtEfCVE595vlPhR807KRgqQNZT8aLk9+7pIg8Rv6gP3VOfZKmIwyePT7OrpkQ5/HlSQZugAMnMB5UUCbS6EwIKiCFJMtk20+tELiZuuY1U2IPSdB4kH4A+8CslKtRzfUTNRSeFIQK1mW3MaBS2lq/xqyfWwJ9oesJaXyobE1WxXg8uv3UxORFTXbgvlsYpr2m9CJ4Z9mVJDZPJvUBkFqUmgZ+P043epTrxF72srDemkMv7G2+i3lORyth9ntdn5Au/hF69yfNMcI58MDlQmrH/QeFILKCXyJSZ6SoCYQGqCqSuUsq73RS+lxhg0IE/LsMxWQuxmttHLg/Mw+702Fl/cWsZmL84T6r6HS9Xjt+Mka6zeL4/DVYIS/YiefDWI51fXPSSsvsYbC5gdy8zhj8Wyt2kEacE/ZjrwhPnMtNKdEKvWnlz2u3ETRCK0/WQ18FMW2e46p4giT0/YoYEtiEfBi7V3ulu5PFSlVvcusW0DE9TdF7+E7+kQY5oSNTjAoN6vYNv25yIdOSyoPNB3zhdRuU3FfQlqj4cRmyVkYfBxlnI9cTrV5VKpIH+2BRKxJrdh3SLDaxyUKiFHR8nMIBD1yT75XHmrP1Q9XCibUXo+yTDQ1pd0eHdKibBccZ0AfS9awJTM57aGUNglAh9+izavAKZ7S2kqDuo4gyMz+yTxd5R2+Kpj/74xxA2f6C69x4IRlnLf6aJmdHVVlbAlBtAKuysi7hJElUNoqFRydbhtMss+zJIxbOZECzutguBa+pvnOT++46SUUPDT9DPE6VqegS05JBZQZ3jXMWTYPa6vFI5yvLApej6PGx9uoOXOv3RqVCrbGOmfRv1Bb19baQ3V2g+fN5hY04odA0eO2e45JOPuP0VzfNhYFEY9SR8avMFv3f0NbS8weOxcoQchXE3GRmBe/hzAuN4V6PGIi1/dO7ULCF1rv1BByQ9BAcS/WVFGWDm+5eKnxRPTNIRY1NvyP5c1wJsnAFX2sNXiP+Qd02oREAU8MCxM2SAeqafz4MyKC8BHkjU9ajKJrfRFUlvd5YUB19vacdWYosOEjKRJVSPg96uKTMlXe22oLodcAratKfftXOL1urCX2wgGEIe+Zxtfux5m21XW4zHsJm3i+aVagGn/jcImg2cQ+RCsb0ip9Ckp5xjBT2mWe9SaiExdItzerPwtIJdHdPFhFvE4XpzYy5VNhwOtKpbfRz6e+XLHc1CKpgY3KU/HQ6k32BxR/NZUkI6NmVD8FSu4nlOCFmFdkNYJx+iAm/WHHRkkJvUgPCy/hicQSLE+rDzNLj3pVusvXeuAIw10FRH+C2//HXk4u85NLssGJuyv7UDbiCGWB1shy6iO5JRZmfo1fWk79X/KzkAYElIUuy8FWR+5dUZzLA/kJQXL1fBi1mShkD1t0LmDLiJf4zg58QAvx/cimhZwBt33LpigPQ9UEiaVi0U1n6Vu7cGxLxLedim1StPClwmxqhalgajt0FP4Ew0lGlDllJTLomdRJRe7wjYR2DVkHPVJ4CZsXIzumGora2clY2BWOCts0noxZuqF0GnlRIQolw4YjnUgjq0SqnJopq9QMXYSXqyBG8L/ScUKtLG5cfoEIds23iBQtJT/WfaJKDQhvMVQEwqPY9Zz+bcXtyy+mrEeDliyeHbCyhSswI1K6IkP13DMLbpAGBzHNi1/ZDqrJhClv4dCwUHPkfAhfv57/ZhWimfMbMRjj2DtuCL9qUQIVHS9Ii3a45gG+wsyfy+mfkVemxp/xA48XehSdDKVjj/4Zf6OlOFVf8cV0MCNA2/l9gEjZyJDyu66EaJKWu0yTQKU6QjYVimhXGW3P7dCKZSVYIZDpVYKp+RwBWhcvRp04jbO+uSCedyILEz8jk+XkfUzF5qJb4fKL6Kp5OoPjC5cDkSH9wwu7j8mdQroUIYD3ov/fbJTjM5TambxnbLGB4/u0q2XTD8cMXnxOPhy4XrTpwr+lIK5R0qbOZVUeZ7018RF9clDib/zXsr5lPrO+PeB6W2VhncxOxRcXuSoTvfEdU6HZ9fEafSFDUouwWWmzSW0IU2w/HfmtIdPJGQHu/GFZJRBhwIV8RWAKsoZy4YE6kS5GpkcpDWXNAXs+KMwngfIco7rSa9Rx4o5I6+Hsi3mVOmZCQOITqb3bI27ehYz9zyNkY6YgwwQn9RvFnl5Ara3/Hk4mBa7hSnmvvHRVikBBqGipvT0cbod7qfk5PjdfEYU3ZOftovNQ8K/ac5ojC0gcJmnL2rdq67ulxBNsfv09x2iDqIWU4rvxiigKZSCYuN7u3N5kRWejxMsP8haIBTmIt8YPQaEeQwMBWYMFN8M5o6oOjyXdi/aKduglV7d2Ss5hY4CBDvJqeDp8/QFOqJc9laeRIiVEwaJbNKb6kKsXVL5yiNmjwoW51H2S7wneh5PIurvHRdMtY2mlBFFeRIYqSKbgOtlrDobztJhL2FaEny23hKW5o5J5kmJMMmUE/ObbjicEzSsOa8Mfr+S/2TVnPoTPVvQ2+qm9nll97+rC2mMpXa+O0ZkoywZUJuDsSLLe63EuxLnx7wMKeNmrdjwU/LGdFwE8i69aCmlV8wmghSmu7HR+PChg/7Q/5nqEvgGVe9PJQnpYEnvNVAjCOymUsTC3HqySb8V7R+X+08msVwQJKM8Btg+ZyPSdoKUULX5OrV0HYMAnNnjtT8MX0yPyNoTOEzTUZp8JQt4iH1V7wgbGVBz1tJGf0KErg71Wthc9Blb+5wyGXPDQXtUB7d+bGc0Y+sGfd58lpaiM3OTU/OdXNTk7qrbKjjEYPcQcrHkMyDJ6EF6Rcsy2145a5fYGDttctCgdeii38PkjvJPZRq92q6aNey5Rb81SjsGB4/eEMNYOpkrPcvhBQBDCDBA0qItaqO1+8wS9KDkiHeiEySYzERVaICltMvRh+Evib0eccEOALOv71T5qltki1N5gP+MvmNtqd5dpf6qsu6/l7T4bZ6PdAZbjHCI24rHG1rKAZkoIImwNektpxciPWY46iAQ14pEn0UfT7tOiMYdiGAlL1COqyjeiw54a/A1p996cEms16aWQCxeGvY0EOvYWC2WEMvcGNCEGa2dhdp6nflZ6mRrSMDLlIHdMxPRJiXlDPGOFS+neLigzZIsXGrECtyJNjoIJZzMXJSr1TCDEfd6XGPDl8zMhACv19JskU6e5RSdkLb/7039/QQGjaOK34jsSMqvh4qfC0bhI/TUz1+ym8lgLNU7iDbTG1SnbUMtyvy8t8pO+J0LJoIYaeX5zK0n1Pt7agXzbeUEXlpxcsqswprQCX4LUVAwBpM0PTmjmJ6tULNUvyL212qFmGE8yCp+xpAo+tLjC10W6fUbahnE4ISmkX9tR+EPlNft+eUr7ptyLugxksIRyBAV1/ZN1KaFuuwCzzSoWCzXzL7BxUiK1ZAINcZ6Ym0Rad+YoNSAL8Funl7M6b7cUnvkcdVKTBKzE0+QE6O3qHQLwk1ne0P//GMM/NoSU5kLSEwzR8+OOw1+VuLroXLzxfX/j5Kn6X1DbqQmFqZSVVtGLszbEk+Bunv0QRz8Xa4csAmHCG+VIR6IzSknOp8b0I6k3A1S+r27Zn/Q6VI6lI2RxonkrLpmSZ9+Roa0jDTUG708KlX8F9KEui4IEZpLo6BumuWCfYXf5CgRS5ghbN3+9a/CrIhmRMB6N9il3aG78FGP4fbbFDiiw7Pjk+KFziUb3+gTgTEx1not5zgVLFCtgAQfN9awnUjMcKPsLHOiHcJRW7pdkR8QQcbGnfmVLuWbBwDmZNe5N1JXDxi0G+QPZeKpixB+B4csZrh+B1UEVFzoplJuhyhOFgeigcRY/Z5WperRzKP9UEuFviES1xF/PAUKvTac92B5bPU/kaQRYVpG3UHt1cGzSxhnzyK5Andi7T8aVHPEGJqUrzVrm74p6mgJLKlb7CSNy9Z7MaJkmbgKU38uPHw2WeM1/DIqUDe3z3sopkj9fDOhcWQ70gNvqQyF7M+g4851PF3+AgOHfl2AadXGZEYMbH4HRYmK6si5LZSgbgy0q0BaN/l10TvrKiygEenLn9aBoEzTuJx+JDjDN44Ag0Tou9DSgR9k4bxjyNUtva+eyfoqExnkXnxOFqq3BBUCfdBOTN52TyMPP4MtnPgeJNep4NrkAuS/ZyBtY25vXF62t5Iu+2EiXtNWqWvWpgPKyhc3bzTsdSfdwuBRg4gtPI+lq1PpcxbUVQngEOQmipccKQvHhhLBkC0iwuNXKzTQtRUL5JDjBdOZgsVbt+EZDeSVpb8g4lEBLXipjZvpmCeoITle25op+R1Clb/V9zADWJWCxsJDoCtnOJIubuK7omUeIoG62YMwQiMQOCYqNpDp5nrhgABgdp27y9ChtAI8bJmKqBfkSVsJhhc+v3c93SKmcRyc0roml4d72Nuglwk7cRLHJDWgJaTZ9JKQ32d/SEHNFDLrH2z0o2Y8rvOg6292QCiiUfw4naIUsjuLxUrpbaqDRmmogpYfWd9LoO4EFlTwif/KHqFvO9F4VaLAWd+4/MjyKnocIPqc5vjFxMmMGiKY7LodKO3MC3SLyHOU2eSVv1m/SCHlVD7u2ZIlYc8eimmXs35leL59NOkZYCHTWohDZLBlMGwbZO724VoN++ntOEuLqeAaPXJw2DVHfkfX8oDOqfHkfocXWYOvvXl5pBk+UgAeWhrHr0Elix+AN72IfG9Twb9NkctUBqQG5EMQfJ8R+oowss25M52+ysCbu4TucutnpRExAW/VP3MLr1OiX4TLj2WvS1wKdfdS2SEhwl1IXMJfNNIK/CAylNlsavW4KwQotSWrnE4iRFyafTWu2AIQ1FQ/gT56WZV2JE8yYSZDKni5mUSJjMjYXyYn8GuDwaLnyN/tFVme5iQ2WQGrvys3k3CGUnX8gfN67M7SW7fJ8ODIgSo3dIHSoiVOGsFRghhcNi4p6gc7cLm95HDZS8YKYFD0+5aMAidikPqK8X88XWMZERGFW0lOB/7QC6BUBCkH8tx6fVp4/JDdYUyGmH4n6dllsyKBs6v+vE+Gi2EBmzwwFIMH0/6TtAI2kOPU+0YvqE0/ZFpK6drVfzPYaGvmnnmUxunYRzTDj0ozisGtGBn4ZWXmxBhRp1AYe35KLdVbN7YGOompkz/m8XiMwYkGgN+Tsq3/poHPDrsXO9ybuZ8g37ghTDwVB9TGrCXwKgWgn4H76OTUueBAhK3AwEPcmLW+kS/0gtvr/njLyMStBzVaThwWr9jgx8yhyxFdOF0A8HHfAJU2kzU5lWzZCvR88jskDmLbq4t40RW+2panEE6sW1g50bOExaRFlwdmHKVQUzrnpuf4SqBgPspMXE4w1URUVtZ9WWN+1FqKYp64v4vqAexiQ+usZjjLdWpzzbn08eZ0qJlJbD9RSXSviGH7GvXjuHPpyJuYqdqWEi3aGMEyLTPZXyWnA5wBsLKkJx8jPUC8yGu8puqPFNHNWBoMgMdOLP90U+z1WtMZUPonxlctaAB1CbHdmORsVQnf9FfQEV3dCUCbngXceCjW01qgfRRsPKTsxNJXZYEMD6dB+HNulD7Tj8ZM/nD+rcUmLQ1oUG0ZUsogtmXvBL4WO0geujqCABpx9HKwGC3+djW3zCpLH9oH1uuHtRR25mXlaoDHkrOKhcs8/+R/V8KhMArqjZh+fnaUrk/gcZm5iRWGEDMnv6j4asALTKs48uNhkQusxstsC7b6kJQOdAE/9qZEAYtJjSm0Hfcaf1l8NBKqbkZhSwwMSOSXmt+SUMFk7jCwcuVQfSEJM24wuXAhlMB7cLiuCqIPKLXsp1CiPBXP2iBbs9Kz2/+Y06dqK09FNApmv5XLgZx8B/q2b2AFDvrwxHnVOOyDNuyGGkZWvUl+KGYjtlZfXc73JPhr08puptEtdSjob2QwP0/MkjBThobQRM5jVLFZkzIMYv64VZjhHVpHk00hpAMCVqE2qjZTtBluOJW+gNbU78yxBVhmmOEK+dNof9PRuQZSCutwb/UH8ik8+eyEda2U8NzAWWWI0Vejgvu4waXiFGbd7y9O7BC8P+4MX4Gan99SinzKxQAjAcBd/rg5DtGAIAQ77q36JOl7H1EImcdxDD9UluSvFda98nVWg4ByFXPSfI723gxWj7Bt0RDhd063DP3Jpe/wR3lqkUuKzeTFZAtRPF5kpmDCjfhx4NwZZXjSOmxQGQ7jgQcbFKuyOarMpmH434PzK708k5hWbhqBn/jiwrwM3j1db5E+34IIP23KsT6XH1LHAkUHfDyAYojU3JFm8FZy4Wpz/IqWVXInDd1tkWkeOPfAiSZC4nxD8i6lwF9KrUrwjG2SrP3EDv3lkrz2Xs15hJjz5qZlCbx4LCXMxPc0P58jrazq06rt0MyuVsaDZL7lQJDu7fWdHx0oKeg/dpE3nqNBE4oBqj4Jc+0Nsl6KG3lbzAFkhj6huEWI3+rAp3Wf3LFsRPwlR9vN9y5ZKx/FSZ5Suy5IOckfEIh2SqeiznR8TsdcIH/TVgivXUEwZQbViqu/CMGMcVwjysXPuE3gs66pHsF1Fhb49ZTZZ0G28iroYDGjtIw1DP+cXrRQ7TMkvaAKEdtKAR9lFdvZ1KqtUN2VTqGvwlP+r5HTiyGpepZi70eFHqpw+RrsdyBwcLpnqlr67t/e1Am8YvovZQYMa35n3yYUQKv6csyZRnbuDwEpTZC0xgqOQXB+78avMsuq1mPxPoMQ7koL6mBSlVpNi1PVf1rnCSNR00XkQeJYQf8FrBbRNOk38Pz6ylnqDcrbzQcbzbAGtuRpd/s51aeQpR78697LE7xLDVfqYuBV+XKhTnKLpxNAsSt0BrNc7ainE+8w0J4u1gpyn0N4iEOP9bLlG7b06PNUeI72aABPKZpK3aRsNeBIV73byA8S4IFolfFHqFG8cvRPIUUCQYFJOhQRsXiYzIr90ex3R5tCKLZes7AECfIp70WzT/kv1kKnWgQQTYJZaXNX0i20TYsrTiuuO+Gi2+f44NbyOsFOPWq7NVGJ4f0piO1p0IKEN5toxre2YVfKRk/+kZz/fmnLIZ0yAwYDZVURq/uBf3B/tF8qZRfVxiu8HzVa0/CVvhhY61aI2vvVBKDj+8ilK13QerUkV2H+WoH7+u7t4N+RrwTwOXPy8ooMut53Z2F6YyjLmI1kHUYaHYVsDVVZmwUjP56nCiL8UfUJ8B2ZuCoh1sjHxU6/usqJzTub0wSl+28c7/6KxqFqW0XXhjR8XweWDNTXvQHzqeAhg5EduDgqRL+aiY4mYRy/S9E8e17+M7bUq8xLCuZR8nA9CmjT5l+Jz5L9epo6HeQBBPs4bAVUg8Zfx7zMB/F8iXrEiCDPVvJNvfloL40IhH4jQcK8D0REqHA7PNBtZTM/FL5GNp6UG8YLhdxXNYig9fGpdNfbuUJCIPwMaIeX2oUKn+2c9r9av9UxK0tdubb8zDjMwgNOc6Rdc1PGYMR0LWSh6jCh2vC0crW4NW5+/f1QiARFuj6L+gcE7D85mgGuzN5orh2CD6tM7rL6N/UHv9sn1ASZP+6x/PgShj9WUpSInm0YaBdHUIB+7R6Rvj+C+NfRlayLyCCBM+Y3fyVXs7khts8JFV1Vz77ivz8PgWWW7rcWFtIqreNTJNIXqzDbuk5TE3rSYDnZHjbN+hveDdgz3YcUAGw5/Ay5kR0ciaij/1o7KaJJ24RxcAYHPm+gV8FnDD5EhjIoBBVWRF5lcj/9p7Z2CQD7WRJ3YGMAv30yO3N5aaaG+Mh7iesSN8LKsa9RuZWYzU+Utl8c/lmr/bgwvEs5uiLKyEilPQBKcEH/FtHtwWw6yVIPCnu+6UWK0nJSMat8NB44TLxKzKkbsZzh/DqNN/aRarCGtu19oJDtLg5jYbBtndTxsIcUmDHMrf8fT4E8/4pOvRczkBk7+v+O3krShKsWKflrXnV0Wqq96EVH10fOijhw+bvhiygBL4hxKp5dU6XlkUllQQd01m18EX2Fpu2qOWGsF2Zw5KUJ3C3QnlaOmB9Wyj8S8IP+DRrihTB5Bkm97O15U5giQ5L1LddnuUlzKQT1GwFA/qjx9HNRmqd4VBMABHvaBhDXgkxAJgjvvUPO2a7wQuoIChB1IWOlyckZi77fTe4663ck1eVI9FiiZn2NuX9DQVGSKSveZ2ckZNuNPgj06BPi05khJK57owoOLrptKI5K3ftcJnckL2zw7TVXMJmF4NKDtqTJipslYaOSZjv22MRU590f1q5wzG0BRFOzlTcR1UMrQdqer4+ZlW4YUJG8ju/vtkzx1jKrr5DSa71kSGT7JUUYeuMngjb1+xjPrtMTKXOK9vcUsXGYTfs04QEEKZKA0vm5HiaFLbf329W7euY9yWsEyucH8KsZ+cxyH3V69q/LglTzXmk+PQKb7HajqR8qXVwO0M0BUov1XokOGhfKL6LoeyganBtXUguPLSQmR4stTWY2JT0DDgI3IRJuEYUbt6AVVINGohkwa3ZbPSro4aBwhsYkWL4JNS0jp/35pbfj4nbrXZX6BOR52/aJvS2prYBlcsBsOuLrdI10ClpKDqEkQv59RDt+ywmhLK+0yz3OUnFvz4DDBCx6MQwIr1htHi+AKs2DtJy4wTaRr+VBK1OkkOh++smyvHRxCBNPo7MCIPaidU6f0ln0CLJvC4vafrUf9PnKeHSVKDl3G5tdO3e2Nl04P9h6yWI/TvYHYsAVlDtWqKTBshzBBpObkdVODPy2jysr+ypodf6Avjm/RSlGI52GY3kKnXdpve1AN7uzZj6OOANxIG3OgL5/UUqP5i7AWU6KmeMXRM1iFWhFFK0KTTcwdzTYHkZVqAkdJPnGAcQRvbKiBjFyV5NvIQvqwkKn31tLu7zprarCC0IMTyAJPl6EHY1yw+CGk0d3T+qX9qPYfmWeXKNCp063DNuR1n6uv/w/YOVwRWda/WLz3MfoUdcUpsEm3hLcfkY3M/HZC+yluhN3enD2NgvS/tsDtWBOx8P/yEIa/kQsSDOGsNFd9p+Nju8B1GmPyzeAz3l4V41Fpml46OMY76CvXjkODe4rWO2gY+m4Ku5u7J1hnuc5puys8IRR+joL++R6zAYSwA2u1SdQQCOlk/qm7mkB8ILd5usyoA14yEOIv+prdmrCUfpCJ7ELyHMowy0i8qpvTJ7JHxuDcmwn9lsGMvfmh0BkxP+gMdcsH3XB88A48cpmMEo5GLy/Zhr4w/gaj97XUQV1lyEWNVYMTELTCb6ucQbJ/3TlNGC3G0NKxkEXjDvIagpXPror3aureyrPtLnBOoTMQMI4RZbFeuNogqM62wKAs/vZrnELpPcB+em6ov94NKQngBW5OQCeOAu/BhB2Hg0xD6KT2htMVKhs0qPUHTaV16ZobofagokJ9rUgn3EHSlTImdnufwUl53HFpn9xV6eSRT7TkVB8oMpqQMeq/uvzx2K0E87vxYoBALUEf+rHHaLYxs89CCEiI3YCY6kHXtfxtwRcm/arpnxl6rDH2MqnHHfjdzUS9lcVTrlC9NIV9pEXHHqAFEOcXgQ3kqdLJI16xwTZiCLEYNEy6ixPD7/0fzSReyccksggwTwUPq/kx7Mpc/IJq608pliLBDjIla+rU92Mrw/+U3wukjifyBt3Nski6KfoxmUiOscUEZ556sHU9g+7e9SVuNOuy+DcTI04hQDjcP4cOo7nfjYRyHrpfb3PpHbwZlFYS2I356b007RWFcOe9cpzbYgbAWXHRne1oGS0Y5chBu7lyPmau8R/ICrUI8ZC0YZNm9dbJd6iSMfwXj++/urqC9b10stp9UVGnRArsijRXgD8Xc7a37I27zCw3pryTlyUbawxQRIyq4SNhthx+JgJeL0cKrRDUquXxC7hufpnWL5/GiXh1yZyTSxMV9ex3/9pbhggtXWWzauDrv8CZiXrJpRf+w75OwnHVHetgPsyYsy4Dk3y7oVWSa6nY7wfWsJMNPp60L2E5kO4brNo5oBINQ4sKlyWilkxtRcdMCelqtqXDyNn4hqzxVRGGs/q9S+dxzhaI8GPomBPvwenDSUy4iBEI/p7pO9/CUqpnW7ECauO5wDZoUqP8F2t2LIvPPmBkXHJZ4r9vIYQA6fVqdaJKube04ZqWsXv01KzIvKmiAEbGAVldoBSKPERNrU2ltX6C9aqCgXVUNJpWou0BK8Mhgwfn7XkR9EhT92BIC8M7KtTOq7JPUOkRJNhI10YbE0ucTTzCxqaJEbjPCyLmMhIu8ZMRCLN76+zmPTD2gEnSeYStPL/iuXvxatAsDsz9B6M9Ruo2rY9+4wBVON/zCUHNcMBwDaKrViErpDG4RbHOz56019EW6n0nUhbQHDE2A/Ld9f+O/nhkuQqp6DaVLNXK3H2AVzSEIIkPvVOEOyj6y1DUoFvo4CqF630O5yW4D5qXmEL6UVV5BpgMbVRQ5Jk+v/7RlNw4M+RofRUo19n34qcrJEVvAuHO4ZlpXi/Q4GMIKfo1VK5XApyfbWN4jZw0BL4WQYp342QczA9hKqYsx2lOU0MZJPOgHy9DwD71Icg5A26hM/NRbn9UE9VQaEYo5Kkf2DAoCxQZZYaH52E0KKsNKdsUiiGzHx1USV+Rhf1zIoux+f9+ICpCpvKK2glRaTjCbaxoiTYzaIoC8/Fzf1ZpyCZiaJRQAUWp7d4s7dO+zCpKfvRMDdCH9Nw1Nmy6hmkm1tHUBidTC3sLcjmzzkazo9cJh+HUXmGVVu8MCvbh0f73CZUhAvhMRSQj7+0WtaV6XlOoYVI7kRTPnCmYQMi1Ca3MQd23hUMEnD5SAEr9BHPEVywHFxsvSMNU5DYeG5Z7uUuwlI2D6nrVaNhU/XsRVs+Q9LbpxCde4oc3w6WDudAej4E3McvHeSpPlGp8rUV82dK5LmVoTjfhMLYQPLGE/EJe826BRZW11jhTuHtRoLuFwPj+BWomcca56uoUSey5nHlKVobrSz4h2vOiISPlL6xJWVEXL6QAyjPyAUgJd6xau8Mxdq/tvwNEnXNV/ayuFvXAc1B9GLP9ylWcPHyI1GEPvhL766xWPfY38J1NZDuGL2z9lQiQ/H1WA01diTflq9oBTo3rr1YDnIaWZeEQs4/NKsOze6ttIh58ZCWHIVogns4gx/ljvVRmjUsiA3g4MLeCB5/2MFD5QqiRf2zDuS3lSZ0yyC2rJNTZxNATP/wG2ICBY8lcT3LSKyP2LJYSbBmi3U2MLYEWn1atLhE9fuCKlIcj2A4nyj28N2xaHkHRtTGnHCGF86iyH5h9gPXLHDpfJMBa7BbJVeiAdoS8LaJFAH1YdjQE2YlkPhEUcjZZlrAGH4iV0LZnOJvFaM1C4DKUbJlJ+GGFu/M2+UmSECxO+ww7OmBWWJFBMFB3XwzqNwvju66cndU/dCd9kOhb5nM7jElGTL8BiPzqAJssE1xyb2CvEVR64Wt9SU9c+Vw3kuKQjwEBTxH60XpWwJea/3meFizNxJx7MzkYQ83z5eICb14ZWUtHH33MNZM3CGQmmIOZceaSIUIfYni3bppwOXytSTenh7/ncyeVjQWt6xVhiiRx6+Blg06dVCjpEE0jjr+tv5bVr+XXQ6XQjzHt2iSNUy6IuSiILTyCRjlHCDYt5D+95J7WIrOgnoRJohlpZ43vzcG0S7Hhqf4Q0yJJeBhpyY9rkgQhtur4aflLrvvXbPGZRKYVHUSj7qPg8cwNXdOubWppqwa3SH1SCkocDPSpgMBLITQltbSwybklZoUWHo9wAsxfXEuMvcxNbCqcpG7oHFDeb4aShS0FEvk/hTcq9zq6kHYfcthDqVx0X+wlZ2ktJwVBcqgFaPNr9XP/POPOdj8AIrpxAmtzaxQ0/aHdxiu6f0U+ne32OSgzhf7juhY55ohhpsiiApRk1IfLEYZ5fssfRzr+FlIfire/1uUz1aMO1xhrNr4Z5Cr/0Gg2jtn+eeu7/RzyuoRzN++ZbDfysPJsh03NsLYdH250ojc6sx28J4UgcmsQUk2JcmpUCZzQ0KoGSJKvKtu+3eR7uUazgV2HQ2lwxfay93KqFqRqde40lyWXIUooZlWH/Jn1RK4kznl2iT48kEZpnqVmPRa9sPeGoglFZfUZmh5ShOBaKf4slOtess1fvTVedk05edEf/pEIYCu4Xl21KFHY4JvmzLC30/neuQ2tkrPe+fZM4hbnDuArf4WEke37fx03CvVBF8nv3H/KQdGkzos4zseyn7dJYcGwUqxvA3g8v6T1s4tEgZrJAKUNhmI/HHG8ukxJEbSFds/LlMP6bBVpJ3WUUixJCenNEcShZjQ45AtncJiU8tIkzlGCs4IB6H9OF4HxAf/P598k1Y2xjH32L/fTVuNZ9MDIgJV7Fo3z7NWbMaKq0BnGTbwUJrmAmoMN6ZeAct67zvO5J0e+9qRrONC+ysg1Obg4e8hDceHnOxk16GZ9t1gJMrRy1gfj6qs50K+849POFlD/vn+REVfIFh/Hm9QRv2P57TWokPRLdWdPNExg4JmBx9Ynv3UNHSmYDydxmXPKFkmoixwtd1ok5sXGTWtIQsI2QPe+BmvJ+ZYg4YPBNzOzCn2UH7lllUxI7aFxLpSe6tM/8Np6Wv5yxR0QQCNZtxxBaqyFK8X/PEgt+RYpC18wLtkl7N54UhGEb5ijOEvliSg+Lmf1sPOcCDoC1F8rpLA0h98WbKHkmKF7ES6l7g0BwFIQeFVa+kNN/eY1L9JxaoE+7tQGqUEYkbGFzfJRE0VMP27/2mfDwHZoZkOvBh1vZKeGPrTzbBpNYgZJ9ZC38goVYRrClQFDCzEYQoQypu32FqYNeOLRx1PZf9DADNBcivBOOume7GrtNCzi0iYFeVKVHTvyCGrBG5GnbL10EsP/35cRbXQ58eEjkxe66ddDc7gR4rKJg3dSJ8HDvsw5U1XfJbD/NPfD8PhG+SctZ4W5x3v8ixsz+AYSzId2CwOWlw3J3JC2rLMEgmqx32d3PudFj4cRhik+KUJeO5gJSgqeQqu8diBIssQtEbUA6PaOHS+Ugqz9YECozOJsPo1OEGAmx3PFDOst18b48NJGPrdSzu8ljGOw1rMpmqNX8dyvC3L+32SODlKHq6Mx3XTSFyYeo9bEKfww6nsK4l1GCY/x7iyQ/1LPza9eYPPFIGhyvJn3AbVaonhA8oQgSl8SrUlw3Vs76wC4SuKy2OT4SSDMb6wcjXZuyZLXH1rpqs0VE2y1J9FJ2D+78K9axSPPH1bPIFQqB5Fy/dz2az5QHCYN9aVvlpgRB7HvQ1Msgw0aNnBza9aZwlOOat7fzaP1zwcYCq8UozoVdaFXJpeFeeDkD+S2VVrdhx0E5D7NSzabUdmNq1W71Aw/MgFAPphSi2H/mOVZPO8hZ6P1lwDrMtbt0ku6wmHw+vGLauIXrHPON1mAARtU2BpoBCDBeps+kmODjng9FWv0++FZmagveAYsg8oieyh852z1LEmX8iNQks7n44ZEw8d1bXeDb/U6fwxaP/Z5E170G8w2cCgDGh/M4rkWDXe5Gx1v7xXGwfSS9/BOrrzkR4VSGAAsEX4jCtSQxfXasqqHmTAGbpJka8KJEGgqSFJ+zqHsY71Z0b/zF5S17Tug/wUgs2uLeNkX+I90M4nZyusolbDlV3yxwiTVmWojVlScmXG2Yh1q+xNGRn79TOQf2sTXQ/6vWcI1RmgUnPonrY5TiB1hYS8owpV/rFtXl5eoDlM32EJJtduq5SoWxQm++eQv2isCudnqN8DRjsdeMddbF8MiAoNzhhJSr95zmEjdZlWeFsk/ELSCJbznzO/uHjkaOekMTGWGGEAisByuxAKcoBOKm7YfvCuCDp189p8f/rk2S/bsC/sz74UGit0DUzNqBnHGVBaw5ejVt7yrqoER2YnlAj7uhQD6efnRW4A4NetZm1XsQLDHiFegQ5oKvo3Nq+kPixWKuMIhEHI4XANZ7fL9WKfpNPsxFgrtxOo21tkuwiP1//ETecFtkdhljhpO0B68CJr8USamPSq4C2guxk0Zyzrd10NaeSajUc//lLZD6roZuGBojuuvgexG6/bxMBLy1mfrZFbPsdIJkq6j5eCOUfR3zuVNi0PvBBM3jXvuVcMZu7VqQcPX6svCzKnwB63O5THRqKSHlfNuN9mXtUtkzTmJJFnLraMyK6f9sh7LfvEU0KkvxZekSGgNxWUAvxARjalbq2AWLqa/VpKieScxfju9YtTju9+8e5kXEKy0zVO7vrpFIg9CWp3s+Fxv9tc7vW4cx0AxjLxeCMfao/tVLPdgEFGTPxObYyE5cxah9a+JMy/Tj0K+x9lFciw3M3vlCdRGdjd7v95dekvoPPx8xHpYk1tZH71+kx7j2cdSfDAhKo538Nu1RMIGWgx+VG1LrQlHqA8wuNRWVTzimzLiMiQKwEnYFKh0DJXHhFSFWQZUNI9fGhhNkD1Y2dmil2vNCe1/scpAHlaeQiqhGuqqJthOQOCR2QJTHYbMjd/CRgZZlpjzpZ2J5Xa/nUE7BdXSDrIA4Y7SJ3FHhJmfDC1f5pwOHjccZl0q0x3HwhusSzxdSrsuJVz9hjOzAUKFdKUl3XoPT0vJnCAJF1rwP8EDGrmgN93TiPd/MbKgyUBDBdGFcMnBYlULBoF632y+RGUD9ZcguEJo+hmwdzRacvAAyjfKViiwXkqw+yOTpoh25b75F5XnpwGz2QZHShE3t9nBa1htDMcuchoNItdPDfHNchMKqiTuth1u5PAgDD8ZRwsxEFSPN1GVNEcCHaAIVlnIy9edIhmGsWHOOd7aJGRKleQLmPLxfyKnvjUs06N5WHqPz5tcDadjLJEV8iOrFzqoRRWAG8JkX1mw2x7uqxJC/JuvnoBIldNT2t0w1qT9YWdctjUS5O+0ZBa3mssFz1NcU2wokrOFIcViDIwtTNivXlLBkaHs2kaL40m6IHgNn9p2dymu7tftEdjE0E+il5bEed7D0i+CH4zhtl0T05tIJllooYHR1d6b4PJevadnHxs9bF6p9ga+SVG94tooXX3fLotT54M65U08lmgx39XcdHllCnGJQeAfL/ad+XgfmTIjAO3uEWTt2jZJ5YRDcJGZj5wBowyH+kgx90qxjMddXg77rB2sARfEWv+lySOksSwkjeZYWrr4TscLFEGf70HMFZ4i2E/ySMGZl3yrtUybnGWvSM3wTThCJi20slGKh1Ydpqpz0tFkFRpxokvKldsJ/CZkLydEq/oL3vofoCtbev4cgZsYcc57UeWVZzRDh5BBqWnXnkAGjX1gW96sOIG25AMc4Q1EtXGQNg/3cPqgKDeC0Vsq31zv75c9/FLT9xMZvuQvzeg13nyUb7rmYlm6nTtfgnihd6MW5nG7BiHU41TMQttSTPlfHZWxqJWDoI+1H7C0ZoxQfb6VYWBe1fjhgeB0EcXDsBx8+kapbtPcGwdsvR/ZTM0gNOr/DERF2aWnde4bVWGzXoHWoHi30qWw74pSRmvUuEoysKAZqUj5Lzt2m+NO6fAop2ARC84aT65DHfHQz/WiSNQw7rYDhaWQAohX743gPloWXgk7iFR2yFh+0A5+SzQQ0WnsGxXBstpM6L/AXGHK6US+rGV1uLsQssxkh2f3bbw22seoDnudPgGmOZmCCLtZ2HbDacH4ZRSghXcHWuV48b23li+rAQo+X7ijsfyx/S0UqRq8VufC5Lu7IXzc3oAN/qQ9eizwh7oH4YwC5l7typXQ8Sry0RK+JSS/K+3M+9AKnWhlW53d95e2aDD0RbAXuFwcOrrr021CPPZm0x+UingeyWm8u++WyrUNNteixn6akZKVtmk7LD6Zy2LAB5mO5dJfQQRkxeZJtskmv+grYJ8iHE8W6fMDyxYipaWZtOZBF4rpKp+4vQuWXmF14ZQJjfiobuz4X8/U8L1T9q8VIb4Z7uAEvjkZp+B9KgtOXmgY9Oc4fgIXefRl50hsfUnnbgwvxyU+lvd+/EtEIro6tYDVBDoPqEYuV/pZXIlX/BJbiPaq5w7Zh4bk/zc650Yj37YA+gVssZlLn3VA77RtlM2nadMRktOvAAOHsdnB+9ygO2TgiRukR2zxStXmkGez4woxdRyVS0DCodBR6tLttai9tn0Tsc0+tOF0ee8etk4vmFdHrZ56OrQIc0H82MtfWy+AaUJSLW/kuqs4E8HP73n68DDY9M+BgA4XnFF1vKdMWhXzciGTN1QRQfuIG1AloeVpUBksf1ALJZPvHMmYBcuC8ljGytuJ7avoXKerhToa4ukSPlmJ17O5mbXSgQVkkMNQjCqjGluBZg8SN0yVMEaml3pqmTC7kXyMOV7noWGgrAdDk/JUt4xQe+/fpjbivIzCR8xDCd6PeXe4nlvy5dtfl9/EuK9FY+qQThgLBB3Xeje/CSM4CFZNcW/DsvP4t9KZZjzMsULyCDhVUlWOGOVAF7CcVd/1z9vX1+GBgQ46ESh/PWKrQN0N62MyedQY8XGvNu41IvF/mh00fYVHbFx62d1VtPCLR8Fpv7pwwMwpZ3JML+bUE5wQmzCWFoHKikNay+rcYTNg/zKz20G+2/5nq/uoJYPJB+KbBXUm20eK1VqZccC0sZFLmY0nnJum742FE8Vo1457pqTK3tYhDueIvu9fapmtHRP27eZnY1UZ7m6gvztE7IHHNj55SZKW7B/nLGn39t4yHEYiJDUG8H1vSi7Ocr5xRNjigg0SnTIUIsvoDdr3CehqDxNhnqFNQJiWmi//sgNYkhpGXUtghcSzCFm5AV+sOzrim0BMQfiGE6j8numWSLMUTOi4+D1lM7PF7VTJ+Zhs6H5bHsht4MMnig2EnRcxPaVgkKdCzQOX1Q9gwXUlREGErp+wumXW6GXV8HW9duJKeRC1YSZBI5p515t+lIROqVGdaqoMNY1nq6OLEOAtHrGfB2sqJRBOzrgWciNYbR9uBcTTDjcsgPdTGuNF9ogHbLS8wNmDydOt4cK/BlsT3i6yVVUuKkXIKK0oS3n2NCKENNX2cQLWCQmSBodmjwRuT2XcN3b3z73S20mN9CM10mNNgQeBTcsJxU5AhO3SYMZDbaAK6/sENOp+HdhaFU7JG6U28pUyuhIOpaZ76QPKXhmXvQu/JvCY/gkMW815s3juzcFPXCEOZcQ0EipBlcBAXRrhHI9YCBbnXQqucrS7mBgN7kJ4+FXOB+mqfNeFPv/mJsyyL/NgPco14+18eUSucECaGktKiGSTxLmQsDyrPWTFSRsWDrDFZtkO08h6iA2YzT4XKo+gVOi/UtUfqHgtb+IxBrvJ9A8W1nWBaCs27B6kNhE/EOOjw2JUhPBW9coCia4b+ISwiNJ2V3/7nNaxkjp9ntmwuE4qDWcGeCxGzjsOMVKNylwTehQOxqurJJd67CP+i39udiYnuX4BaecCsks+xNl4RcDavGuvmdIQ+7M8tppYd1IK4zHcZ4Qd3oA3rQwhogGlEKgkTzTPW2K0m6vN4RAa3hifeqmRmw7B1hqZZVSuGN1l24SmD3XFyMK5onlT96S9UA95MBN9g/LIcQClXf+T6N8T/Tl7iW5tDKgpwnyI2TLggSrif57qZvorhJDMdJhR2xK6Fn5vmyNJPanfR+rlGYn3zI8xcnSZlmpFZfUshUoIUpEqiR0Wy0XH8RT50nDEtARGLBcKwdkSgCrN2mwbMvVHi5jZL1AtHm09yB1Z2+NX8gF4F72BPyhBiLnFswkd9Y3qLMX7JXUjekRsgQZsgM26ohTMV1GVs/PzG7vNAQLLoQ2Zz9u3vQpsjQmIsNu8VvQSQe4ZMb1L4idW2D3rStZNrxJGNLeERGhxgZJ3TMX5fjwzYxaIMgw1v+gnOb2K6fBpF2IJ2J/qRJvzmAQWqxVvKkHoRPJerZNETq3IeILkyU5SGpCRthkx/4bHHw/lHHNHp+exqcEoYvlsxkB4GEiihgVlvJvbujUNhAwXpeMUSa5vwYJUZkZBRGFTntsUbtyxZZg6ommBoYseGqm7Tz9t95KcaMmuIGjuOPWwhIrQjK/yvI9TQnLSD/2zoqEQEz89JGH7z7oz2AG4gfUoHTxRmC7qcZrkXNsVW9Uk+ihoMeLKM+znmQ5EKSGNuMy2+99cMgwe5Khi0uD10doqUIasmpIakqL7hTCwp3Br7pcwWweUMNuVFmVIDbpmYjPfTz//7yBO+tLrPsr/JfOqFwxk+Pd2vPwwkF31D8qAyGFVfQFDQnk+MGBj6Gy5arm3eHCgBO4VbhY43mUW7s9IzmKoeS7o0Q2OHtBIv1xw5UTPjcs11JjwbSplvyaImeF2af/pAhMRlId/2lB1B8SUJ1D7GMlnee7o3FfcErYBEW/hGasoXtZ+55Eon7Q4Sp53DjOhj89/VMwJqmBJBIonGso/PbyixcWbUEreLinPgjIKkAI6NfOBo56ACNznnMabD4tyjVMsFcJ9MHm1+Xrn4F5//ciUhxfyC6zJgDzh7yCwhP9o8dMhF6A6cbFwsFCQkw7ZFYdlZL0Kvyt8EA8F8R05/MGWwH+nCEcJFg/dBhO+6QxIlAw3VOhAtu96eHNrsl5crtOiH+ahbtMSlbPvH4eAyrzZ5QYxZNBg+rHpGWvkAc0mivP2s2TGjsIjHenpeZK31zTdSES8n8oJ5sM23BX5NUrS11oMtFes8Ed0HHaAYYlKGD5n+YN4vz3F29OSoG1I13zRDvgAUCym8xbgaSz+jr22S+lEer8/tesnhI4U/jncWqThGfbDyeSM5HrVQ89gzUyz8q4dv7t3lCutus/oSajm65FMYNXLGv+2GQBTcEolO5x6/PbxETSr6aw+7L3YwIPVs3u1aM8bEDzTuJkqHUOhXjcsU1UOKzxK6Qlv2OPsvgM9MQAJcZDw1/Uj+YBDUHIfPIrLljKeis4fb4a2qOkYLgL9x7TMCt/Z2jLhq55bGytWHwEOhz1XyC2TKPtfOm0bJwC+GqRYp5V8NMXpFhhJZLZFJ449rnFP5tRj+nqeDqO+A10nc4bVl2xSlLn+KI3G+SUznxUbysZJ26dUe8RWfPYXMA13AxdP2ITVfeQlo3N/Wgm7Irfq5BgMd417KtwOMJjrIVYBWe4mD5PThDI6tW0Rzhzz5ehU/fXSW8xJpNxDyLvtEpgI/VC0S/XkeoB5ku0hEz1Ji8VBuHmwViORKAKHqLxtm7wFAHiUJC0d9NFlDJa6sS3IZk5IBdG0/3rVxeReYihRJdAdchJHf5bKSe1eNxpLqGGi/TuLtULheLZLtwU3gfZcQlX6VvSFeAPoo8pJ8Dn7Ux6xeRTKF37MlN4LJxqom6Zl48ePLjJedngjWmx4KbKJqjrHb80nR8HOOD7TDXXMbGoJ0SJ8s2QrPOHP6XCXu6H6aTerBN8p6CtexOk6hKCxwcGUfIt/o3WywKZ0hRFerL4skWRk6PXfQeU6zheHWP59U1GVGNbjTDLlSz/VxOrmPCMuqWrBqJgsafOv9tEnLpw599ULsbqFjf05B4K5JVdVEDjJjKyRs88ch9rkd7vtI8WziOhRHItU1oMV4dIFbbg62XXc5vi6yhrmjNLT+VBbPaunR1MSX07Hbkjfw1ejnLYCCDhNsbw8Zz5N/sEzWq0Y6wBalv9Kyh0I1jLN3dZa/v52sK9ddiZpvLN1Owf8WHr4qtqqmiUW1E9Pfnp/dP0kXFe/GExMDRf+WQMkzWr8gewa1phudJ3AgPACxZQP99vO9y3gGAnz4NJL5kQJaLpW96uduhuIzYuH/fa6i9isr0vOtRV4DyL+5LXpnMB6Ntconn2D0E3Et7PnIaIHfJCunRr+QQdbeFzkQq6dJBT93VorPwxZR9153FsDjroWRGzeKzTDg8MWTTBmlmPDB6GMSSCR1aeEKgB5RQ97cxQk5j8wPFRGinAMisw9FJV6CSZl/dO50q2SoFlRhju7Lal/0sZInBYRYX2/hTJzhFDbgH7LYFexQVE8lowJ/nMI7m836UFLGVUr2+Zhd8Xcic8ELB5EVNz0B/E325srU35i6hW8kDFroubBO4WVj3vJ4kOMs7OEXAEOoyxmUTuzPrbNLLt+yEREjsM9mZW8YMtO7JVkTZudI21s4W3w1lhlknbfUEGZwS0JqA5FVNb4VJ+UNTtyM/P0AMIn7cpeJnVRTWGtwcCkWGZEN+e8BpMxLmGtA4MrlGyPfRo8sMpb/ISOWwVFJyAqKM8xS7CsU09q2a6tFKcKgmFIbYu2xLdH2DCPM/SqCCLUQRZesIMotNVCAwJTKu0htZYxAAPF2ptYjiOLS3kplsbtZ+bJktGkETp+HXtVwt00iBLtNXz83iTx0GD6YhWX9Pu+T8jzxD3JRUk36EkEtkAfaf1CJPr0D9QJiTaOyG0Fel4LetNgvCuJaubVvOXI5iHYlaTGhYlIq0c07zti7p9xVXCSfK87fcvzh8EFZaLFAsaYH3n+03iQrCJnwkcakAEoxTH7pJbcQBW271E/6Yt08VImE+lRuCDxj5e3mGEcmXfsaxOdZDKtIQZ4EzR5R9XCKMBh4NnczbZMkjTDT5JKQhAIOWQ0l413kToViMtApRk0oEBmPnHuZcgbvtnrQneEJHaRRz2PptoxblJ2sWrOKOaAVtyao9XBZWlKXJDN+MGEGVoMRpZDWIqgZqFt9MFHaJLlO7ckLYTCkJjkK7xwB6PKzrOPn6jwbNGIMHaX6KjXznQpRUXrfnJksYiDQ9+4ghv7kJcYqDSVgKyMR6GFD0aN+DToSwRgKmrJGPE7luahrpLvQHHSi5ZCtLt5p76KmkoMgbFjFvtWK6DsdfCQ7YjKCv8jQw/r88gmPvCjkC8WKxrEod7GleqzWNq0+SmiOBhaBV+jTCNUMuUC5wBGLYm/pZf8hrvkU7FObIzF7uy67JmlPKYYSKFYfZ85MKJwZ25IAa/Oq6DmQHGP2VMchuCDQEsE5oPZuXwkuOTtRcPIW9ScoAhW+GWkJik1UZ5N4V4y8M9GCOen2f0As4SqS8jQaYNWksSzIXrsvMwPnRDt4o053pTuEWRp3mEaSRk+pCSydcV8gxBY3X+UeTObU4zMHWtCMZgWZ0cC9EGjTHYHMreogUZj35M8WwrnZqz4STjdhKfA1xJIW7c9iELkuM5tYsIkZoAoUL83GiGYfJbYCcR97ZtJrEjuewZhr89MgC+F5JBnlSh7cyko60tcIM8dVmT3rpu/+hKB7pO9NmLrWHjuUDPY7ZZ3MNMfXfqZThADYbq5IjNTFbEkiM60KjpwkjW9kqRwVWYwEeBzIs5zoeuqJ+6HH2yqY/Fp92sgBGcdO1wrOp8XuHL3m+i49jf0dwV3ljKOXLgJS2KFZJVq6WUbTyuQ9oPlbiGjCsyYNTPwJzzGXMKxQGW9dCBjZm6H5PFFqoWuSoeH1Hw1wu5PfhXFrHa5E0XrpRxCM/Z2b3DSbTAIe+8B1D5JTG4d1xDOyMBB7RfnqXu3gw84DImObt1w0lhfRrClTOAK8ApWI4iWtqWiXD1sjcRPTzY3P23rhR+y97YOoED/3SfJrYYVMaTMxuCNiKiLG94cb+ej+BuV7Hcp2Ni+r3q533oNwGsK3csY2Efq7KwuV8oqGbwO8fNU/uMD2IQnerMedDslEhPllz7/sm6Ko1L8jECzjgg7myjxWeblU2Ck2sdzMtk6A6F/b6iWK61Wdy126sdMrI9ZBQszvCNvkn/5BxM30Jwfg5vwe4LcHVV4fGd+saxlhJvSp/sOJgRS283YEZwI5I3fh2SKx0U9Ya/1s5BIgd0tCjMdAEnvB9vvjqnszDfje6QjH0BXfXwrx3fF6N/XF0D1V4J6EaWmB1Pw9p8xaPfxZxqSOVWRZ0LfJLmh4/Gpl8ruMYAx/nRIt35w1Y7SVXphd+8rc9pNdIWT0rJdA1Lo0vQyuoMLwwIp/Mu47+kGAdnyP1SXg3OkYpX3TF1umm+DSEhQCk/7whDtsQvqrqadWXCo+cMydjWX5LYHosbDVieIWanYlhH39cZJnh6O1tx+EimXRU+erG+A6v9du+bpDD9SDvGPiEWlfEf1C2DKjLVPcLQAS4882s0vHxDKWZ87LwWSn+bd3sLm2XQ5CIcKfCitjh/wA7H8NG+PDBOivE9yRL0nZOj4DqZFBhgV0hMg1LLd5H/Ro7QmIFJOak5WAXdGfTuEEsIMaXxyfAC+onYnE7PFHABlaWjHpHK3LXG5SZFJ+/c8wKsJ662izL7fycgnFvreQ68HYmXQQLQQyqTcUJ1nlPmkDzoLhtQh7ACoAzhglcUoNxUYvm3YCFih61IY= </div>]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å †]]></title>
      <url>/2017/11/03/%E7%AE%97%E6%B3%95-%E5%A0%86/</url>
      <content type="html"><![CDATA[<p>å †(heap)åˆè¢«ä¸ºä¼˜å…ˆé˜Ÿåˆ—(priority queue)ã€‚å°½ç®¡åä¸ºä¼˜å…ˆé˜Ÿåˆ—ï¼Œä½†å †å¹¶ä¸æ˜¯é˜Ÿåˆ—ã€‚å›å¿†ä¸€ä¸‹ï¼Œåœ¨<a href="http://www.cnblogs.com/vamei/archive/2013/03/15/2961729.html" target="_blank" rel="external">é˜Ÿåˆ—</a>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçš„é™å®šæ“ä½œæ˜¯dequeueå’Œenqueueã€‚dequeueæ˜¯æŒ‰ç…§è¿›å…¥é˜Ÿåˆ—çš„å…ˆåé¡ºåºæ¥å–å‡ºå…ƒç´ ã€‚è€Œåœ¨å †ä¸­ï¼Œæˆ‘ä»¬ä¸æ˜¯æŒ‰ç…§å…ƒç´ è¿›å…¥é˜Ÿåˆ—çš„å…ˆåé¡ºåºå–å‡ºå…ƒç´ çš„ï¼Œè€Œæ˜¯æŒ‰ç…§å…ƒç´ çš„ä¼˜å…ˆçº§å–å‡ºå…ƒç´ ã€‚</p>
<p>è¿™å°±å¥½åƒå€™æœºçš„æ—¶å€™ï¼Œæ— è®ºè°å…ˆåˆ°è¾¾å€™æœºå…ï¼Œæ€»æ˜¯å¤´ç­‰èˆ±çš„ä¹˜å®¢å…ˆç™»æœºï¼Œç„¶åæ˜¯å•†åŠ¡èˆ±çš„ä¹˜å®¢ï¼Œæœ€åæ˜¯ç»æµèˆ±çš„ä¹˜å®¢ã€‚æ¯ä¸ªä¹˜å®¢éƒ½æœ‰å¤´ç­‰èˆ±ã€å•†åŠ¡èˆ±ã€ç»æµèˆ±ä¸‰ç§ä¸ªé”®å€¼(key)ä¸­çš„ä¸€ä¸ªã€‚å¤´ç­‰èˆ±-&gt;å•†åŠ¡èˆ±-&gt;ç»æµèˆ±ä¾æ¬¡äº«æœ‰ä»é«˜åˆ°ä½çš„ä¼˜å…ˆçº§ã€‚</p>
<p>Linuxå†…æ ¸ä¸­çš„è°ƒåº¦å™¨(scheduler)ä¼šæŒ‰ç…§å„ä¸ªè¿›ç¨‹çš„ä¼˜å…ˆçº§æ¥å®‰æ’CPUæ‰§è¡Œå“ªä¸€ä¸ªè¿›ç¨‹ã€‚è®¡ç®—æœºä¸­é€šå¸¸æœ‰å¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰ä¸åŒçš„ä¼˜å…ˆçº§(è¯¥ä¼˜å…ˆçº§çš„è®¡ç®—ä¼šç»¼åˆå¤šä¸ªå› ç´ ï¼Œæ¯”å¦‚è¿›ç¨‹æ‰€éœ€è¦è€—è´¹çš„æ—¶é—´ï¼Œè¿›ç¨‹å·²ç»ç­‰å¾…çš„æ—¶é—´ï¼Œç”¨æˆ·çš„ä¼˜å…ˆçº§ï¼Œç”¨æˆ·è®¾å®šçš„è¿›ç¨‹ä¼˜å…ˆç¨‹åº¦ç­‰ç­‰)ã€‚å†…æ ¸ä¼šæ‰¾åˆ°ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹ï¼Œå¹¶æ‰§è¡Œã€‚å¦‚æœæœ‰ä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹è¢«æäº¤ï¼Œé‚£ä¹ˆè°ƒåº¦å™¨ä¼šè½¬è€Œå®‰æ’è¯¥è¿›ç¨‹è¿è¡Œã€‚ä¼˜å…ˆçº§æ¯”è¾ƒä½çš„è¿›ç¨‹åˆ™ä¼šç­‰å¾…ã€‚â€œå †â€æ˜¯å®ç°è°ƒåº¦å™¨çš„ç†æƒ³æ•°æ®ç»“æ„ã€‚</p>
<a id="more"></a>
<h1 id="å †çš„æ€§è´¨">1. å †çš„æ€§è´¨</h1><p>å †çš„å®ç°é€šè¿‡æ„é€ äºŒå‰å †ï¼ˆbinary heapï¼‰ï¼Œå®ä¸ºäºŒå‰æ ‘çš„ä¸€ç§ï¼›ç”±äºå…¶åº”ç”¨çš„æ™®éæ€§ï¼Œå½“ä¸åŠ é™å®šæ—¶ï¼Œå‡æŒ‡è¯¥æ•°æ®ç»“æ„çš„è¿™ç§å®ç°ã€‚è¿™ç§æ•°æ®ç»“æ„å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>ä»¥æœ€å¤§å †ä¸ºä¾‹ï¼Œæœ€å¤§å †æŒ‡é™¤äº†æ ¹èŠ‚ç‚¹ä»¥å¤–çš„æ‰€æœ‰èŠ‚ç‚¹iéƒ½è¦æ»¡è¶³$A[PARENT(i)]\geq A[i]$</li>
<li>å †æ˜¯ä¸€é¢—å®Œå…¨æ ‘ã€‚å³é™¤äº†æœ€åº•å±‚ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹éƒ½è¢«å…ƒç´ å¡«æ»¡ï¼Œä¸”æœ€åº•å±‚å°½å¯èƒ½åœ°ä»å·¦åˆ°å³å¡«å…¥ã€‚</li>
</ol>
<h1 id="å †çš„åº”ç”¨åœºæ™¯">2. å †çš„åº”ç”¨åœºæ™¯</h1><p>å †æ’åºä»¥åŠä¼˜å…ˆé˜Ÿåˆ—</p>
<ul>
<li>å †æ’åºå¯å…·ä½“å‚è€ƒ<a href="http://vickyqi.com/2015/08/14/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%A0%86%E6%8E%92%E5%BA%8F/" target="_blank" rel="external">æ’åºç®—æ³•ç³»åˆ—â€”â€”å †æ’åº</a></li>
<li>ä¼˜å…ˆé˜Ÿåˆ—å¯å‚è€ƒ<a href="http://blog.csdn.net/vickyway/article/details/49005011" target="_blank" rel="external">JDKå¹¶å‘å·¥å…·ç±»æºç å­¦ä¹ ç³»åˆ—â€”â€”ä»‹ç»</a></li>
</ul>
<h1 id="å †çš„å­˜å‚¨">3. å †çš„å­˜å‚¨</h1><p>ç”±äºæˆ‘ä»¬éœ€è¦é¢‘ç¹çš„å¯¹å †è¿›è¡Œå¢åŠ åˆ é™¤ï¼Œæ‰€ä»¥ä¸€èˆ¬å †çš„åº•å±‚éƒ½æ˜¯é€šè¿‡æ•°ç»„æ¥å®ç°ï¼ˆè€Œä¸èƒ½ç”¨é“¾è¡¨ï¼Œå› ä¸ºé“¾è¡¨éœ€è¦é¢‘ç¹new æˆ– deleteå¯¹è±¡ï¼Œéå¸¸æ…¢ï¼‰</p>
<p>å› æ­¤å †çš„å­˜å‚¨ä¸ºï¼Œå¯¹äºå…ƒç´ $A[i]$ï¼š</p>
<ul>
<li>çˆ¶èŠ‚ç‚¹ï¼š$A[i/2]$(å³ç§»1)</li>
<li>å·¦å­©å­ï¼š$A[2i]$ (å·¦ç§»1ï¼Œå¯å¾—åˆ°2i)</li>
<li>å³å­©å­ï¼š$A[2i+1]$(å·¦ç§»1ï¼Œä½ä½+1ï¼Œå¯å¾—åˆ°2i+1)</li>
</ul>
<h1 id="å †çš„åŸºæœ¬æ“ä½œ">4. å †çš„åŸºæœ¬æ“ä½œ</h1><p>å †çš„å¢åˆ ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-22-10-15.png" alt=""> </p>
<h2 id="MAX-HEAPIFY-A-i">4.1. MAX-HEAPIFY(A,i)</h2><p>ç”±äºå †çš„å»ºç«‹æ˜¯åŸºäºåŸæ¥çš„æ•°ç»„çš„ã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†ä¸€ä¸ªåŠæˆå“çš„å †ã€‚</p>
<p>åˆå§‹çŠ¶æ€å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åœ¨èŠ‚ç‚¹i=2å¤„ï¼ŒA[2]è¿èƒŒäº†æœ€å¤§å †æ€§è´¨ï¼Œå› ä¸ºå®ƒâ‰¤å®ƒçš„å­©å­ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-22-11-32.png" alt=""></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰¾å‡ºièŠ‚ç‚¹çš„å­©å­ä¸­æœ€å¤§çš„èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹4ï¼Œé€šè¿‡äº¤æ¢A[2]å’ŒA[4]çš„å€¼ï¼ŒèŠ‚ç‚¹2æ¢å¤äº†æœ€å¤§å †çš„æ€§è´¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-22-11-59.png" alt=""></p>
<p>ä½†æ­¤æ—¶åˆå¯¼è‡´äº†èŠ‚ç‚¹4è¿åäº†æœ€å¤§å †çš„æ€§è´¨ã€‚æ­¤æ—¶åªéœ€è¦é€’å½’è°ƒç”¨MAX-HEAPIFY(A,4)ï¼Œæ­¤æ—¶i=4ï¼Œé€šè¿‡äº¤æ¢A[4]å’ŒA[9]çš„å€¼ï¼ŒèŠ‚ç‚¹4çš„æœ€å¤§å †æ€§è´¨å¾—åˆ°äº†æ¢å¤ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p>  <img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-22-13-00.png" alt=""> </p>
<p>ä»¥ä¸Šæ“ä½œçš„ä¼ªä»£ç ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">MAX-HEAPIFY(A,i)</div><div class="line">  l = LEFT(i)</div><div class="line">  r = RIGHT(i)</div><div class="line">  <span class="keyword">if</span> l&lt;= A.heap-size and A[l]&gt;A[i]</div><div class="line">  	largest = l</div><div class="line">  <span class="keyword">else</span> largest = i</div><div class="line">  <span class="keyword">if</span> r&lt;= A.heap-size and A[r] &gt; A[largest]</div><div class="line">  	largest = r</div><div class="line">  <span class="keyword">if</span> largest != i</div><div class="line">  	exchange A[i] with A[largest]</div><div class="line">  	MAX-HEAPIFY(A,largest)</div></pre></td></tr></table></figure>
<h2 id="BUILD-MAX-HEAP-A">4.2. BUILD-MAX-HEAP(A)</h2><p><strong>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥è¯´æ˜å…·ä½“çš„å»ºå †æ­¥éª¤ã€‚</strong></p>
<p>å‡è®¾æˆ‘ä»¬æœ‰æ•°ç»„<code>4,1,3,2,16,9,10,14,8,7</code></p>
<p>å®ƒçš„å½¢çŠ¶ä¸ºï¼š</p>
<p><img src="https://ooo.0o0.ooo/2017/11/03/59fc1f33088db.png" alt=""> </p>
<p>å½“ç„¶æœ€æš´åŠ›çš„æ–¹å¼å°±æ˜¯ä»æœ€åä¸€ä¸ªå…ƒç´ ã€7ã€‘å¼€å§‹ï¼Œå‘ä¸Šä»¥æ­¤å¯¹æ ‘è¿›è¡Œç»´æŠ¤ã€‚ä½†äº‹å®ä¸Šç”±äºå[n/2]ä¸ªå…ƒç´ éƒ½æ˜¯æ ¹èŠ‚ç‚¹ï¼Œä¸éœ€è¦è¿›è¡Œç»´æŠ¤ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤å‰[n/2]ä¸ªèŠ‚ç‚¹ã€‚</p>
<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-13-22-13-17.png" alt=""> </p>
<p>ä¼ªä»£ç ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">BUILD-MAX-HEAP(A)</div><div class="line">	A.heap.size = A.length</div><div class="line">	<span class="keyword">for</span> i = [A.length/<span class="number">2</span>] downto <span class="number">1</span></div><div class="line">      MAX-HEAPIFTY(A,i)</div></pre></td></tr></table></figure>
<p><strong>Javaå®ç°</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HEAPIFY</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] A;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> heapSise;</div><div class="line">    HEAPIFY(<span class="keyword">int</span>[] A)&#123;</div><div class="line">        heapSise = A.length;</div><div class="line">        <span class="keyword">this</span>.A = A;</div><div class="line">        Build();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> q)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> temp = A[p];</div><div class="line">        A[p] = A[q];</div><div class="line">        A[q] = temp;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Heapify</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">2</span>*i;</div><div class="line">        <span class="keyword">int</span> r = <span class="number">2</span>*i+<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;<span class="comment">//è¿™ä¸ªæ¡ä»¶çœŸçš„å¾ˆé‡è¦</span></div><div class="line">            l = <span class="number">1</span>;</div><div class="line">            r = <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> largest = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(l&lt;heapSise &amp;&amp; A[l]&gt;A[i])&#123;<span class="comment">//ä¸€å®šè¦åˆ¤æ–­æ˜¯å¦å°äºheapSize!æ‰¾äº†å¥½ä¹…è¿™ä¸ªbug</span></div><div class="line">            largest = l;</div><div class="line">        &#125;<span class="keyword">else</span> largest = i;</div><div class="line">        <span class="keyword">if</span>(r &lt; heapSise &amp;&amp; A[r] &gt; A[largest])&#123;</div><div class="line">            largest = r;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(largest != i)&#123;</div><div class="line">            swap(i,largest);</div><div class="line">            Heapify(largest);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Build</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = (heapSise-<span class="number">1</span>)/<span class="number">2</span>; i&gt;=<span class="number">0</span> ; i-=<span class="number">1</span>)&#123;</div><div class="line">            Heapify(i);</div><div class="line">            System.out.println(Arrays.toString(A));</div><div class="line">        &#125;</div><div class="line">        System.out.println(Arrays.toString(A));</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span>[] A = &#123;<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">16</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">7</span>&#125;;</div><div class="line">        HEAPIFY t = <span class="keyword">new</span> HEAPIFY(A);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å¤æ‚åº¦">4.3. å¤æ‚åº¦</h2><p>åœ¨é«˜åº¦ä¸ºhçš„ç»“ç‚¹ä¸Šè¿è¡ŒMAX-HEAPIFYçš„ä»£ä»·æ˜¯$O(h)$ï¼Œå› æ­¤å»ºæ ‘çš„æ€»ä»£ä»·ä¸ºï¼š</p>
<p>$$\sum_{h=0}^{lgn}O(h)=O(n\sum_{h=0}^{lgn}\frac{h}{2^h})=O(n)$$</p>
<h2 id="poll">4.4. poll()</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œåˆ é™¤å…ƒç´ å¯¹è±¡é’ˆå¯¹äºæ ¹èŠ‚ç‚¹ã€‚</p>
<p>åˆ é™¤æ‰æ ¹èŠ‚ç‚¹ä¹‹åè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿã€Šç®—æ³•å¯¼è®ºã€‹è¯´ç›´æ¥æŠŠæœ€åä¸€ä¸ªå…ƒç´ æä¸Šæ¥å°±å¯ä»¥äº†ã€‚ä¸€å¼€å§‹æƒ³ä¸é€šä¸ºä»€ä¹ˆï¼Œæˆ‘æƒ³çš„æ˜¯ç›´æ¥æŠŠå·¦å³å­©å­ä¸­çš„æ¯”è¾ƒå¤§çš„é‚£ä¸ªæä¸Šæ¥ï¼Œç„¶åå‘ä¸‹é€’å½’å°±å¯ä»¥äº†ã€‚ä½†å†ä»”ç»†æ€ç´¢ï¼Œå¦‚æœè¿™æ ·æ“ä½œï¼Œé‚£è¿™ä¸ªå­©å­ä¸‹é¢å‡ ä¹æ‰€æœ‰çš„å…ƒç´ éƒ½è¦å˜åŒ–ä½ç½®ã€‚ç„¶è€Œå¦‚æœç›´æ¥æŠŠæœ€åä¸€ä¸ªå…ƒç´ æä¸Šæ¥ï¼Œåªéœ€è¦å˜åŒ–ä¸€åŠã€‚å¾ˆç¥å¥‡ã€‚</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POP()</div><div class="line">  swap(<span class="number">1</span>,heapSize)</div><div class="line">  heapSize -= <span class="number">1</span></div><div class="line">  MAX-HEAPFITY(A,<span class="number">1</span>)</div></pre></td></tr></table></figure>
<h1 id="å †æ’åº">5. å †æ’åº</h1><p>å †æ’åºå…¶å®åªéœ€è¦åˆ©ç”¨å †çš„æ€§è´¨â€”â€”æ ¹èŠ‚ç‚¹æœ€å¤§ï¼Œç„¶åä¾æ¬¡å°†æ ¹èŠ‚ç‚¹æ‰§è¡ŒPOPæ“ä½œå³å¯ã€‚</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SORT()</div><div class="line">  <span class="keyword">while</span> heapSize &gt; <span class="number">0</span>:</div><div class="line">		POP();</div></pre></td></tr></table></figure>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> e = A[<span class="number">0</span>];</div><div class="line">    swap(<span class="number">0</span>,heapSise-<span class="number">1</span>);</div><div class="line">    heapSise -= <span class="number">1</span>;</div><div class="line">    Heapify(<span class="number">0</span>);</div><div class="line">    System.out.println(Arrays.toString(A)+<span class="string">'\t'</span>+heapSise);</div><div class="line">    <span class="keyword">return</span> e;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">while</span>(heapSise&gt;<span class="number">0</span>)&#123;</div><div class="line">        pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="HashHeap">6. HashHeap</h1><p>Hashå †ä¸æ™®é€šå †çš„åŒºåˆ«ï¼šHashå †å¤šäº†ä¸€ä¸ªç”¨æ¥æŒ‡ç¤ºå…ƒç´ ä½ç½®çš„ç´¢å¼•ã€‚è¿™ä¸ªç´¢å¼•è¡¨ç¤ºå…ƒç´ åœ¨å †ä¸­çš„ä½ç½®ã€‚</p>
<h2 id="add">6.1. add()</h2><p>å‘å †ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ </p>
<ol>
<li>å°†å…ƒç´ åŠ åˆ°æ•°ç»„æœ«å°¾</li>
<li>ä¾æ¬¡å‘ä¸Šè°ƒæ•´</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> now)</span> </span>&#123;</div><div class="line">        size_t++;</div><div class="line">        <span class="keyword">if</span> (hash.containsKey(now)) &#123;</div><div class="line">            Node hashnow = hash.get(now);</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(hashnow.id, hashnow.num + <span class="number">1</span>));</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            heap.add(now);</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(heap.size() - <span class="number">1</span>, <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        siftup(heap.size() - <span class="number">1</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="poll-1">6.2. poll()</h2><p>ä»å †é¡¶æ‹¿èµ°ä¸€ä¸ªå…ƒç´ </p>
<ol>
<li>å°†å †é¡¶å…ƒç´ æ‹¿èµ°</li>
<li>å°†å †å°¾å…ƒç´ æ”¾åˆ°å †é¡¶</li>
<li>ä¾æ¬¡å‘ä¸‹è°ƒæ•´</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function">Integer <span class="title">poll</span><span class="params">()</span> </span>&#123;</div><div class="line">        size_t--;</div><div class="line">        Integer now = heap.get(<span class="number">0</span>);</div><div class="line">        Node hashnow = hash.get(now);</div><div class="line">        <span class="keyword">if</span> (hashnow.num == <span class="number">1</span>) &#123;</div><div class="line">            swap(<span class="number">0</span>, heap.size() - <span class="number">1</span>);</div><div class="line">            hash.remove(now);</div><div class="line">            heap.remove(heap.size() - <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> (heap.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">                siftdown(<span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(<span class="number">0</span>, hashnow.num - <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> now;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="peak">6.3. peak()</h2><p>ä»å †é¡¶æ‹¿å‡ºä¸€ä¸ªå€¼ï¼Œå¹¶ä¸åˆ é™¤</p>
<h2 id="delete">6.4. delete()</h2><p>åˆ é™¤æŒ‡å®šå…ƒç´ now</p>
<ol>
<li>æ ¹æ®hashMapæ‰¾åˆ°nowåœ¨æ•°ç»„ä¸­çš„ä½ç½®</li>
<li>åˆ é™¤è¿™ä¸ªå…ƒç´ ï¼Œå¹¶å°†æœ«å°¾å…ƒç´ æ”¾åˆ°è¿™ä¸ªä½ç½®</li>
<li>å‘ä¸Šã€å‘ä¸‹è°ƒæ•´</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> now)</span> </span>&#123;</div><div class="line">        size_t--;</div><div class="line">        ;</div><div class="line">        Node hashnow = hash.get(now);</div><div class="line">        <span class="keyword">int</span> id = hashnow.id;</div><div class="line">        <span class="keyword">int</span> num = hashnow.num;</div><div class="line">        <span class="keyword">if</span> (hashnow.num == <span class="number">1</span>) &#123;</div><div class="line"></div><div class="line">            swap(id, heap.size() - <span class="number">1</span>);</div><div class="line">            hash.remove(now);</div><div class="line">            heap.remove(heap.size() - <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> (heap.size() &gt; id) &#123;</div><div class="line">                siftup(id);</div><div class="line">                siftdown(id);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(id, num - <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ä»£ç ">6.5. ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HashHeap</span> </span>&#123;</div><div class="line">    ArrayList&lt;Integer&gt; heap;</div><div class="line">    String mode;</div><div class="line">    <span class="keyword">int</span> size_t;</div><div class="line">    HashMap&lt;Integer, Node&gt; hash;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</div><div class="line">        <span class="keyword">public</span> Integer id;</div><div class="line">        <span class="keyword">public</span> Integer num;</div><div class="line"></div><div class="line">        Node(Node now) &#123;</div><div class="line">            id = now.id;</div><div class="line">            num = now.num;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Node(Integer first, Integer second) &#123;</div><div class="line"></div><div class="line">            <span class="keyword">this</span>.id = first;</div><div class="line">            <span class="keyword">this</span>.num = second;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashHeap</span><span class="params">(String mod)</span> </span>&#123; <span class="comment">// ä¼ å…¥min è¡¨ç¤ºæœ€å°å †ï¼Œmax è¡¨ç¤ºæœ€å¤§å †</span></div><div class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></div><div class="line">        heap = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">        mode = mod;</div><div class="line">        hash = <span class="keyword">new</span> HashMap&lt;Integer, Node&gt;();</div><div class="line">        size_t = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">peak</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> heap.get(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> size_t;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function">Boolean <span class="title">empty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (heap.size() == <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">parent</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (id == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (id - <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lson</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id * <span class="number">2</span> + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rson</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id * <span class="number">2</span> + <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">comparesmall</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (a &lt;= b) &#123;</div><div class="line">            <span class="keyword">if</span> (mode == <span class="string">"min"</span>)</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> (mode == <span class="string">"min"</span>)</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> idA, <span class="keyword">int</span> idB)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> valA = heap.get(idA);</div><div class="line">        <span class="keyword">int</span> valB = heap.get(idB);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> numA = hash.get(valA).num;</div><div class="line">        <span class="keyword">int</span> numB = hash.get(valB).num;</div><div class="line">        hash.put(valB, <span class="keyword">new</span> Node(idA, numB));</div><div class="line">        hash.put(valA, <span class="keyword">new</span> Node(idB, numA));</div><div class="line">        heap.set(idA, valB);</div><div class="line">        heap.set(idB, valA);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function">Integer <span class="title">poll</span><span class="params">()</span> </span>&#123;</div><div class="line">        size_t--;</div><div class="line">        Integer now = heap.get(<span class="number">0</span>);</div><div class="line">        Node hashnow = hash.get(now);</div><div class="line">        <span class="keyword">if</span> (hashnow.num == <span class="number">1</span>) &#123;</div><div class="line">            swap(<span class="number">0</span>, heap.size() - <span class="number">1</span>);</div><div class="line">            hash.remove(now);</div><div class="line">            heap.remove(heap.size() - <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> (heap.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">                siftdown(<span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(<span class="number">0</span>, hashnow.num - <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> now;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> now)</span> </span>&#123;</div><div class="line">        size_t++;</div><div class="line">        <span class="keyword">if</span> (hash.containsKey(now)) &#123;</div><div class="line">            Node hashnow = hash.get(now);</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(hashnow.id, hashnow.num + <span class="number">1</span>));</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            heap.add(now);</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(heap.size() - <span class="number">1</span>, <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        siftup(heap.size() - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> now)</span> </span>&#123;</div><div class="line">        size_t--;</div><div class="line">        ;</div><div class="line">        Node hashnow = hash.get(now);</div><div class="line">        <span class="keyword">int</span> id = hashnow.id;</div><div class="line">        <span class="keyword">int</span> num = hashnow.num;</div><div class="line">        <span class="keyword">if</span> (hashnow.num == <span class="number">1</span>) &#123;</div><div class="line"></div><div class="line">            swap(id, heap.size() - <span class="number">1</span>);</div><div class="line">            hash.remove(now);</div><div class="line">            heap.remove(heap.size() - <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> (heap.size() &gt; id) &#123;</div><div class="line">                siftup(id);</div><div class="line">                siftdown(id);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            hash.put(now, <span class="keyword">new</span> Node(id, num - <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">siftup</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (parent(id) &gt; -<span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">int</span> parentId = parent(id);</div><div class="line">            <span class="keyword">if</span> (comparesmall(heap.get(parentId), heap.get(id)) == <span class="keyword">true</span>) &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                swap(id, parentId);</div><div class="line">            &#125;</div><div class="line">            id = parentId;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">siftdown</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (lson(id) &lt; heap.size()) &#123;</div><div class="line">            <span class="keyword">int</span> leftId = lson(id);</div><div class="line">            <span class="keyword">int</span> rightId = rson(id);</div><div class="line">            <span class="keyword">int</span> son;</div><div class="line">            <span class="keyword">if</span> (rightId &gt;= heap.size() || (comparesmall(heap.get(leftId), heap.get(rightId)) == <span class="keyword">true</span>)) &#123;</div><div class="line">                son = leftId;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                son = rightId;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (comparesmall(heap.get(id), heap.get(son)) == <span class="keyword">true</span>) &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                swap(id, son);</div><div class="line">            &#125;</div><div class="line">            id = son;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Javaçš„PriorityQueue">7. Javaçš„PriorityQueue</h1><p><strong>Integeræœ€å°å †å®ä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Queue&lt;Integer&gt; integerPriorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(<span class="number">7</span>);</div><div class="line">Random rand = <span class="keyword">new</span> Random();</div><div class="line"><span class="comment">//æ”¾</span></div><div class="line">integerPriorityQueue.add(<span class="keyword">new</span> Integer(rand.nextInt(<span class="number">100</span>)));</div><div class="line"><span class="comment">//æ‹¿</span></div><div class="line">Integer in = integerPriorityQueue.poll();</div></pre></td></tr></table></figure>
<p><strong>Integeræœ€å¤§å †å®ä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Queue&lt;Integer&gt; heap = <span class="keyword">new</span> PriorityQueue&lt;&gt;(nums.length+<span class="number">1</span>,idComparator);</div><div class="line"><span class="comment">//æ”¾</span></div><div class="line">heap.add(e);</div><div class="line"><span class="comment">//æ‹¿</span></div><div class="line">heap.poll();</div><div class="line"><span class="comment">//åŒ¿åComparatorå®ç°</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Comparator&lt;Integer&gt; idComparator = <span class="keyword">new</span> Comparator&lt;Integer&gt;()&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer c1, Integer c2)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>) (c2 - c1);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>è‡ªå®šä¹‰ç±»çš„æœ€å°å †</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Queue&lt;Customer&gt; cutomerPriorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(<span class="number">7</span>,idComparator);</div><div class="line"><span class="comment">//æ”¾</span></div><div class="line">customerPriorityQueue.add(<span class="keyword">new</span> Customer(id, <span class="string">"Pankaj "</span>+id));</div><div class="line"><span class="comment">//æ‹¿</span></div><div class="line">Customer cust = customerPriorityQueue.poll();</div><div class="line"></div><div class="line"><span class="comment">//åŒ¿åComparatorå®ç°</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> Comparator&lt;Customer&gt; idComparator = <span class="keyword">new</span> Comparator&lt;Customer&gt;()&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Customer c1, Customer c2)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>) (c1.getId() - c2.getId());</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h1 id="ç›¸å…³leetcodeé¢˜">8. ç›¸å…³leetcodeé¢˜</h1><p>TOP Ké—®é¢˜ä¹Ÿæœ‰å¤šç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚æ’åºï¼Œæœ€åæˆªå–é å‰æˆ–è€…é åçš„Kä¸ªæ•°æ®ã€‚å½“æ•°æ®é‡å°çš„æ—¶å€™ï¼Œæ’åºè§£å†³èµ·æ¥å½“ç„¶å¯ä»¥ï¼Œç®—æ³•ç®€å•ï¼Œæ’åºç®—æ³•ä¹Ÿæœ‰å¾ˆå¤šç°æˆçš„ã€‚å½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œç»´æŠ¤ä¸€ä¸ªå¾ˆé•¿çš„æ•°ç»„ï¼Œä¸ç®¡æ˜¯ç©ºé—´å­˜å‚¨ä¸Šè¿˜æ˜¯æ’åºè€—è´¹çš„æ—¶é—´ä¸Šéƒ½å¯èƒ½éš¾ä»¥æ¥å—ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æœ€å°å †çš„æ–¹å¼æ¥å®ç°ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªKé•¿åº¦çš„æ•°ç»„å°±è¡Œã€‚</p>
<p>ç„¶è€Œå…·ä½“åˆ°é—®é¢˜ï¼Œå°±ä¼šæœ‰éå¸¸å¤šçš„å˜ç§ã€‚</p>
<h2 id="Kth-Largest-Element-in-an-Array">8.1. Kth Largest Element in an Array</h2><p>ç»™ä¸€ä¸ªæ•°ç»„ <code>[3,2,1,5,6,4]</code> å’Œ k = 2, è¾“å‡ºç¬¬kå¤§çš„å€¼ï¼Œ5</p>
<p>è¿™é“é¢˜ç”¨ä¸€ä¸ªæœ€å¤§å †å®Œæˆå³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Comparator;</div><div class="line"><span class="keyword">import</span> java.util.PriorityQueue;</div><div class="line"><span class="keyword">import</span> java.util.Queue;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/13.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findKthLargest</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        Queue&lt;Integer&gt; heap = <span class="keyword">new</span> PriorityQueue&lt;&gt;(nums.length+<span class="number">1</span>,idComparator);</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> e : nums )&#123;</div><div class="line">            heap.add(e);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> ( k&gt;<span class="number">1</span> )&#123;</div><div class="line">            heap.poll();</div><div class="line">            --k;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> heap.peek();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//åŒ¿åComparatorå®ç°</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Comparator&lt;Integer&gt; idComparator = <span class="keyword">new</span> Comparator&lt;Integer&gt;()&#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer c1, Integer c2)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> (<span class="keyword">int</span>) (c2 - c1);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span>[] nums = &#123;<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>&#125;;</div><div class="line">        <span class="keyword">int</span> k = <span class="number">2</span>;</div><div class="line">        System.out.println(<span class="keyword">new</span> Main().findKthLargest(nums,k));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Top-K-Frequent-Elements">8.2. Top K Frequent Elements</h2><p>ç»™ä¸€ä¸ªint[],è¾“å‡ºé¢‘ç‡æœ€é«˜çš„kä¸ªæ•°å­—ã€‚</p>
<p>For example,<br>Given <code>[1,1,1,2,2,3]</code> and k = 2, return <code>[1,2]</code>.</p>
<p>æ€è·¯ï¼šç›´æ¥å»ºä¸€ä¸ªå †ï¼Œåœ¨éå†çš„åŒæ—¶å¯¹å †è¿›è¡Œç»´æŠ¤ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">        Integer s;</div><div class="line">        <span class="keyword">int</span> count;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.count &gt; o.count)&#123;</div><div class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.count == o.count)&#123;</div><div class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.s.compareTo(o.s)&gt;<span class="number">0</span>)&#123;</div><div class="line">                    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        Node(Integer s,<span class="keyword">int</span> count)&#123;</div><div class="line">            <span class="keyword">this</span>.s = s;</div><div class="line">            <span class="keyword">this</span>.count = count;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">HashHeap</span></span>&#123;</div><div class="line">        Node[] E;</div><div class="line">        HashMap&lt;Integer,Integer&gt; map;</div><div class="line">        <span class="keyword">int</span> heapSize;</div><div class="line">        <span class="keyword">int</span> k;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HashHeap</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">            E = <span class="keyword">new</span> Node[k+<span class="number">1</span>];</div><div class="line">            heapSize = <span class="number">0</span>;</div><div class="line">            map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">            <span class="keyword">this</span>.k = k ;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">left</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="number">2</span> * i;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">right</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">father</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> i/<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">brother</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">2</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> i+<span class="number">1</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> i-<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> q)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> indexq = map.get(E[q].s);</div><div class="line">            map.replace(E[q].s,map.get(E[p].s));</div><div class="line">            map.replace(E[p].s,indexq);</div><div class="line">            Node temp = E[p];</div><div class="line">            E[p] = E[q];</div><div class="line">            E[q] = temp;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Push</span><span class="params">(Node e)</span></span>&#123;</div><div class="line">            E[heapSize] = e;</div><div class="line">            heapSize+=<span class="number">1</span>;</div><div class="line">            map.put(e.s,heapSize-<span class="number">1</span>);</div><div class="line">            FixUP(heapSize-<span class="number">1</span>);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FixUP</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)<span class="keyword">return</span>;</div><div class="line">            <span class="keyword">int</span> father = father(i);</div><div class="line">            <span class="keyword">if</span>(E[father].compareTo(E[i])&gt;<span class="number">0</span>) &#123;</div><div class="line">                swap(i, father);</div><div class="line">            &#125;</div><div class="line">            FixUP(father);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> Node <span class="title">Pop</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(heapSize==<span class="number">0</span>)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">            swap(<span class="number">0</span>,heapSize-<span class="number">1</span>);</div><div class="line">            heapSize-=<span class="number">1</span>;</div><div class="line">            FixDown(<span class="number">0</span>);</div><div class="line">            <span class="keyword">return</span> E[heapSize];</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FixDown</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">            <span class="keyword">int</span> l = left(i);</div><div class="line">            <span class="keyword">int</span> r = right(i);</div><div class="line">            <span class="keyword">int</span> min = -<span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (l &lt; <span class="keyword">this</span>.heapSize &amp;&amp; E[l].compareTo(E[i])&lt;<span class="number">0</span>)&#123;</div><div class="line">                min = l;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                min = i;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>( r &lt; <span class="keyword">this</span>.heapSize &amp;&amp; E[r].compareTo(E[min])&lt;<span class="number">0</span> )&#123;</div><div class="line">                min = r;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>( min != i )&#123;</div><div class="line">                swap(i,min);</div><div class="line">                FixDown(min);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">count_add1</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</div><div class="line">            <span class="keyword">int</span> index = map.get(s);</div><div class="line">            E[index].count+=<span class="number">1</span>;</div><div class="line">            FixUP(index);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">topKFrequent</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        HashHeap heap = <span class="keyword">new</span> HashHeap(nums.length);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; nums.length ; i += <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(heap.map.containsKey(nums[i]))&#123;</div><div class="line">                heap.count_add1(nums[i]);<span class="comment">//åŒæ—¶å¯¹å †è¿›è¡Œç»´æŠ¤</span></div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                heap.Push(<span class="keyword">new</span> Node(nums[i],<span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        List&lt;Integer&gt; ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; k ; i += <span class="number">1</span>)&#123;</div><div class="line">            ans.add(heap.Pop().s);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Kth-Smallest-Element-in-a-Sorted-Matrix">8.3. Kth Smallest Element in a Sorted Matrix</h2><p><strong>åŸé¢˜</strong></p>
<p>Given a <em>n</em> x <em>n</em> matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.</p>
<p>Note that it is the kth smallest element in the sorted order, not the kth distinct element.</p>
<p>ç»™ä¸€ä¸ª <em>n</em> x <em>n</em>çš„æ•°ç»„ï¼Œè¡Œåˆ—éƒ½æœ‰åºï¼ˆå³$A[i][j]&lt;A[i+1][j]ä¸”A[i][j]&lt;A[i][j+1]$ï¼‰ã€‚æ‰¾åˆ°ç¬¬Kå°çš„å…ƒç´ ã€‚</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">matrix = [</div><div class="line">   [ 1,  5,  9],</div><div class="line">   [10, 11, 13],</div><div class="line">   [12, 13, 15]</div><div class="line">],</div><div class="line">k = 8,</div><div class="line"></div><div class="line">return 13.</div></pre></td></tr></table></figure>
<p><strong>Note: </strong><br>You may assume k is always valid, 1 â‰¤ k â‰¤ n2.</p>
<p><strong>æ€è·¯</strong></p>
<p>å¦‚æœè¿™é“é¢˜ç”¨å †æ¥è§£å†³ï¼Œæ€è€ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>k=1æ—¶ï¼Œå †ä¸º[1]ï¼Œæ­¤æ—¶ç¬¬ä¸€å°ä¸º1</li>
<li>k=2æ—¶ï¼Œç¬¬2å°ä¸€å®šæ˜¯1çš„å³æˆ–ä¸‹ï¼Œé‚£å°±å°†å®ƒä¸¤éƒ½æ”¾è¿›å»ã€‚è€ŒåŒæ—¶1ä¸å¯èƒ½æ˜¯ç¬¬äºŒå°ï¼Œé‚£å°±æå‰æŠŠå®ƒæ‹¿å‡ºæ¥ã€‚é‚£ä¹ˆå †ä¸º[5,10]ï¼Œæ­¤æ—¶ç¬¬2å°ä¸º5</li>
<li>k=3æ—¶ï¼Œç¬¬3å°ä¸€å®šæ˜¯5çš„å³/ä¸‹ï¼Œæˆ–è€…å°±æ˜¯10æœ¬èº«ã€‚è€Œä¸”ä¸å¯èƒ½æ˜¯5ã€‚æ­¤æ—¶å †ä¸º[9,10,11]ï¼Œé‚£ä¹ˆç¬¬3å°å°±æ˜¯9</li>
<li>k=4æ—¶ï¼Œç¬¬4å°ä¸€å®šæ˜¯9çš„å³/ä¸‹ï¼Œæˆ–è€…å°±æ˜¯10æœ¬èº«ã€‚è€Œä¸”ä¸å¯èƒ½æ˜¯9ã€‚æ­¤æ—¶å †ä¸º[10,11,12]ï¼Œé‚£ä¹ˆç¬¬4å°å°±æ˜¯10</li>
</ul>
<p>å°†ä»¥ä¸Šæ€è€ƒè¿‡ç¨‹å†™ä¸ºä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt; </span>&#123;</div><div class="line">        <span class="keyword">int</span> x;</div><div class="line">        <span class="keyword">int</span> y;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        Node(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val)&#123;</div><div class="line">            <span class="keyword">this</span>.x = x;</div><div class="line">            <span class="keyword">this</span>.y = y;</div><div class="line">            <span class="keyword">this</span>.val = val;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o1)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.val - o1.val;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(matrix.length==<span class="number">0</span> || matrix[<span class="number">0</span>].length==<span class="number">0</span>)<span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">boolean</span>[][] hash = <span class="keyword">new</span> <span class="keyword">boolean</span>[matrix.length][matrix[<span class="number">0</span>].length];</div><div class="line">        Queue&lt;Node&gt; priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(k);</div><div class="line">        Node top_i;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i+=<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(priorityQueue.size()==<span class="number">0</span>)&#123;</div><div class="line">               priorityQueue.add(<span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>,matrix[<span class="number">0</span>][<span class="number">0</span>]));</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                top_i = priorityQueue.poll();</div><div class="line">                <span class="keyword">if</span>(top_i.x+<span class="number">1</span>&lt;matrix[top_i.y].length &amp;&amp; !hash[top_i.x+<span class="number">1</span>][top_i.y]) &#123;</div><div class="line">                    hash[top_i.x+<span class="number">1</span>][top_i.y]=<span class="keyword">true</span>;</div><div class="line">                    priorityQueue.add(<span class="keyword">new</span> Node(top_i.x + <span class="number">1</span>, top_i.y, matrix[top_i.x + <span class="number">1</span>][top_i.y]));</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(top_i.y+<span class="number">1</span>&lt;matrix.length &amp;&amp; !hash[top_i.x][top_i.y+<span class="number">1</span>]) &#123;</div><div class="line">                    hash[top_i.x][top_i.y+<span class="number">1</span>]=<span class="keyword">true</span>;</div><div class="line">                    priorityQueue.add(<span class="keyword">new</span> Node(top_i.x, top_i.y + <span class="number">1</span>, matrix[top_i.x][top_i.y + <span class="number">1</span>]));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>  priorityQueue.peek().val;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>å¤æ‚åº¦åˆ†æ</strong></p>
<p>ç”±äºå †çš„addå’Œpollæ“ä½œçš„å¤æ‚åº¦éƒ½æ˜¯log(m)ï¼Œå…¶ä¸­mæ˜¯å †çš„å¤§å°ã€‚</p>
<p>è€Œæ­¤é¢˜å †é•¿åº¦ä¸å¤§äºkï¼Œå› æ­¤ç²—ç•¥æ¥çœ‹æ€»ä½“å¤æ‚åº¦ä¸º$O(klog(k))$ã€‚</p>
<p>ä½†ç»è¿‡æˆ‘æµ‹è¯•å‘ç°ï¼Œå‡è®¾è¾“å…¥æ•°ç»„ä¸º$n \times n$ï¼Œå½“$k&gt;n$æ—¶ï¼Œå †é•¿åº¦æ˜¯ä¸€å®šä¸å¤§äºnçš„ã€‚è¿™é‡Œæˆ‘æœ‰ç‚¹æƒ³ä¸é€šã€‚</p>
<p><strong>å¦ä¸€ç§å †çš„æ€è·¯</strong></p>
<p>ä»¥ä¸‹è¿™ç§æ–¹å¼ï¼Œä»…ä»…åªéœ€è¦å‘ä¸‹éå†ã€‚æˆ‘ä»¬ä»ç¬¬ä¸€è¡Œæ„å»ºåˆå§‹çš„æœ€å°å †ï¼Œæ¯æ¬¡ä»ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå†ä»ä¸‹ä¸€è¡Œçš„å¯¹åº”ä½ç½®åŠ ä¸€ä¸ªå…ƒç´ è¿›å…¥æœ€å°å †ï¼ˆæ€è€ƒä¸€ä¸‹ï¼Œè¿™æ ·åšä¿è¯äº†æ‰€æœ‰å…ƒç´ æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºåŠ å…¥æœ€å°å †ï¼ŒåŒæ—¶ä¸åŠ å…¥è¿‡å¤šå…ƒç´ ï¼‰ï¼Œæ‰§è¡Œk-1æ¬¡è¿™ä¸ªè¿‡ç¨‹ï¼Œå †é¡¶å…ƒç´ å³ä¸ºæ‰€æ±‚ã€‚ </p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šOï¼ˆklogn) </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = matrix.length;</div><div class="line">        PriorityQueue&lt;Tuple&gt; pq = <span class="keyword">new</span> PriorityQueue&lt;Tuple&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n-<span class="number">1</span>; j++) pq.offer(<span class="keyword">new</span> Tuple(<span class="number">0</span>, j, matrix[<span class="number">0</span>][j]));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k-<span class="number">1</span>; i++) &#123;</div><div class="line">            Tuple t = pq.poll();</div><div class="line">            <span class="keyword">if</span>(t.x == n-<span class="number">1</span>) <span class="keyword">continue</span>;</div><div class="line">            pq.offer(<span class="keyword">new</span> Tuple(t.x+<span class="number">1</span>, t.y, matrix[t.x+<span class="number">1</span>][t.y]));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> pq.poll().val;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tuple</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Tuple</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">int</span> x, y, val;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tuple</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.x = x;</div><div class="line">        <span class="keyword">this</span>.y = y;</div><div class="line">        <span class="keyword">this</span>.val = val;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span> <span class="params">(Tuple that)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.val - that.val;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>éªšæ“ä½œâ€”â€”äºŒåˆ†æ³•</strong></p>
<p>å…ˆæ‰¾åˆ°æ•°ç»„çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œç„¶åä»¥æ­¤ä½œä¸ºäºŒå‰æœç´¢çš„å·¦å³ä¸¤è¾¹ï¼Œæ±‚å‡ºå…¶ä¸­é—´å€¼ï¼Œç„¶åçœ‹æ¯”è¯¥å€¼å°çš„æœ‰å¤šå°‘ä¸ªï¼Œæ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶å°±è¿”å›ï¼Œä¸ç„¶å°±å°†å·¦å³è¾¹ç•Œä¿®æ”¹ä¸ºmidå³å¯ã€‚ä»£ç å…¥ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = matrix.length;</div><div class="line">        <span class="keyword">int</span> lo = matrix[<span class="number">0</span>][<span class="number">0</span>], hi = matrix[n - <span class="number">1</span>][n - <span class="number">1</span>];</div><div class="line">        <span class="keyword">while</span> (lo &lt;= hi) &#123;</div><div class="line">            <span class="keyword">int</span> mid = lo + (hi - lo) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">int</span> count = getLessEqual(matrix, mid);</div><div class="line">            <span class="keyword">if</span> (count &lt; k) lo = mid + <span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span> hi = mid - <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> lo;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getLessEqual</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> n = matrix.length, i = n - <span class="number">1</span>, j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &gt;= <span class="number">0</span> &amp;&amp; j &lt; n) &#123;</div><div class="line">            <span class="keyword">if</span> (matrix[i][j] &gt; val) i--;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                res += i + <span class="number">1</span>;</div><div class="line">                j++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Find-K-Pairs-with-Smallest-Sums">8.4. Find K Pairs with Smallest Sums</h2><p><strong>é¢˜ç›®</strong></p>
<p>You are given two integer arrays <strong>nums1</strong> and <strong>nums2</strong> sorted in ascending order and an integer <strong>k</strong>.</p>
<p>Define a pair <strong>(u,v)</strong> which consists of one element from the first array and one element from the second array.</p>
<p>Find the k pairs <strong>(u1,v1),(u2,v2) â€¦(uk,vk)</strong> with the smallest sums.</p>
<p>ç»™å®šä¸¤ä¸ªæ•°ç»„nums1å’Œnums2ï¼Œæ‰¾åˆ°nums1[i] + nums2[i] çš„ä»æœ€å°åˆ°ç¬¬kå°çš„å¯¹(i,j)ï¼Œå¹¶è¿”å›ã€‚</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Given nums1 = [1,7,11], nums2 = [2,4,6],  k = 3</div><div class="line"></div><div class="line">Return: [1,2],[1,4],[1,6]</div><div class="line"></div><div class="line">The first 3 pairs are returned from the sequence:</div><div class="line">[1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]</div></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Given nums1 = [1,1,2], nums2 = [1,2,3],  k = 2</div><div class="line"></div><div class="line">Return: [1,1],[1,1]</div><div class="line"></div><div class="line">The first 2 pairs are returned from the sequence:</div><div class="line">[1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]</div></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Given nums1 = [1,2], nums2 = [3],  k = 3 </div><div class="line"></div><div class="line">Return: [1,3],[2,3]</div><div class="line"></div><div class="line">All possible pairs are returned from the sequence:</div><div class="line">[1,3],[2,3]</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ä¸ä¸Šä¸€é“é¢˜éå¸¸åƒã€‚è¦æ³¨æ„çš„æœ‰å‡ ç‚¹ï¼š</p>
<ol>
<li>å¹¶æ²¡æœ‰è¯´ä¸¤ä¸ªæ•°ç»„å·²æ’åºï¼›</li>
<li>å¹¶æ²¡æœ‰è¯´kä¼šå°äºnum1.length * nums2.length</li>
</ol>
<p><strong>æ€è·¯</strong></p>
<p>é¦–å…ˆå°†nums1å’Œnums2æ’åºï¼Œç„¶ååˆ—å‡ºå¦‚ä¸‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>nums2  nums1</th>
<th>1</th>
<th>7</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>2+1</td>
<td>2+7</td>
<td>2+4</td>
</tr>
<tr>
<td>4</td>
<td>4+1</td>
<td>4+7</td>
<td>4+4</td>
</tr>
<tr>
<td>6</td>
<td>6+1</td>
<td>6+7</td>
<td>6+4</td>
</tr>
</tbody>
</table>
<p>ç„¶åè¿™é“é¢˜å°±è½¬åŒ–æˆäº†ä¸Šä¸€é“é¢˜ï¼æŒ‰ç…§ä¸Šä¸€é“é¢˜çš„æ€è·¯è§£å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt; </span>&#123;</div><div class="line">        <span class="keyword">int</span> x;</div><div class="line">        <span class="keyword">int</span> y;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        Node(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> val)&#123;</div><div class="line">            <span class="keyword">this</span>.x = x;</div><div class="line">            <span class="keyword">this</span>.y = y;</div><div class="line">            <span class="keyword">this</span>.val = val;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o1)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.val - o1.val;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> List&lt;<span class="keyword">int</span>[]&gt; kSmallestPairs(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> k) &#123;</div><div class="line">        List&lt;<span class="keyword">int</span>[]&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span>(nums1.length==<span class="number">0</span> || nums2.length==<span class="number">0</span> || k==<span class="number">0</span>) <span class="keyword">return</span> result;</div><div class="line">        <span class="keyword">if</span>(k&gt;nums1.length*nums2.length) k = nums1.length*nums2.length;</div><div class="line">        Arrays.sort(nums1);</div><div class="line">        Arrays.sort(nums2);</div><div class="line">        <span class="keyword">int</span> i,x,y;</div><div class="line">        Queue&lt;Node&gt; priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(k);</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nums1.length;i+=<span class="number">1</span>)&#123;</div><div class="line">            priorityQueue.offer(<span class="keyword">new</span> Node(i,<span class="number">0</span>,nums2[<span class="number">0</span>]+nums1[i]));</div><div class="line">        &#125;</div><div class="line">        Node temp;</div><div class="line">        k-=<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; k ; i+=<span class="number">1</span>)&#123;</div><div class="line">            temp = priorityQueue.poll();</div><div class="line">            x = temp.x;</div><div class="line">            y = temp.y;</div><div class="line">            <span class="keyword">int</span>[] aRes = &#123;nums1[x],nums2[y]&#125;;</div><div class="line">            result.add(aRes);</div><div class="line">            <span class="keyword">if</span>(y+<span class="number">1</span>&lt;nums2.length)</div><div class="line">                priorityQueue.offer(<span class="keyword">new</span> Node(x,y+<span class="number">1</span>,nums1[x]+nums2[y+<span class="number">1</span>]));</div><div class="line">        &#125;</div><div class="line">        temp = priorityQueue.poll();</div><div class="line">        x = temp.x;</div><div class="line">        y = temp.y;</div><div class="line">        <span class="keyword">int</span>[] aRes = &#123;nums1[x],nums2[y]&#125;;</div><div class="line">        result.add(aRes);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Merge-k-Sorted-Lists">8.5. Merge k Sorted Lists</h2><p>è¿™é“é¢˜ç»™äº†kä¸ªé“¾è¡¨ListNode[k] listsã€‚æ¯ä¸ªé“¾è¡¨éƒ½å·²æ’åºã€‚å°†è¿™kä¸ªé“¾è¡¨mergeä¸ºä¸€ä¸ªæœ‰åºé“¾è¡¨ã€‚</p>
<p>æ€è·¯ï¼šç”±äºæ¯æ¬¡éƒ½è¦æ‹¿å‡ºæœ€å°çš„ï¼Œé‚£ä¹ˆä¸€ç§è§£æ³•å°±æ˜¯ç”¨ç»´æŠ¤ä¸€ä¸ªæœ€å°å †ï¼Œæœ€å°å †çš„å…ƒç´ ç”±å½“å‰çš„è¡¨å¤´å…ƒç´ ç»„æˆã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Comparator;</div><div class="line"><span class="keyword">import</span> java.util.PriorityQueue;</div><div class="line"><span class="keyword">import</span> java.util.Queue;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/13.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        ListNode next;</div><div class="line">        ListNode(<span class="keyword">int</span> x)&#123;</div><div class="line">            val = x;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">  <span class="comment">//ä¼˜å…ˆé˜Ÿåˆ—çš„å…ƒç´ </span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">int</span> val;</div><div class="line">        <span class="keyword">int</span> idx;</div><div class="line">        Node(<span class="keyword">int</span> val,<span class="keyword">int</span> idx)&#123;</div><div class="line">            <span class="keyword">this</span>.val = val ;</div><div class="line">            <span class="keyword">this</span>.idx = idx ;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.val - o.val;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    Queue&lt;Node&gt; priorityQueue;</div><div class="line">  <span class="comment">// å°†é“¾è¡¨listçš„å¤´åŠ å…¥åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œå¹¶åˆ é™¤å½“å‰çš„å¤´</span></div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">add</span><span class="params">(ListNode list,<span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">        priorityQueue.add(<span class="keyword">new</span> Node(list.val,idx));</div><div class="line">        list = list.next;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">   <span class="comment">// merge éƒ¨åˆ†</span></div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(ListNode[] lists)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( lists.length == <span class="number">0</span> )<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(lists.length);</div><div class="line">        <span class="keyword">int</span> hashCount = <span class="number">0</span>;</div><div class="line">        <span class="keyword">boolean</span>[] hash = <span class="keyword">new</span> <span class="keyword">boolean</span>[lists.length];</div><div class="line">      <span class="comment">//æŠŠå½“å‰æ¯ä¸ªé“¾è¡¨çš„å¤´ä»¥æ­¤åŠ å…¥è¿›ä¼˜å…ˆé˜Ÿåˆ—</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; lists.length ; ++i )&#123;</div><div class="line">            <span class="keyword">if</span>( <span class="keyword">null</span> == lists[i] )&#123;</div><div class="line">                hash[i] = <span class="keyword">true</span>;</div><div class="line">                ++hashCount;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                lists[i] = add(lists[i],i);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">      <span class="comment">// å¦‚æœå½“å‰é“¾è¡¨å…¨éƒ¨ä¸ºç©º</span></div><div class="line">        <span class="keyword">if</span>( hashCount == lists.length )&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">       <span class="comment">// åˆå§‹åŒ–</span></div><div class="line">        Node min = priorityQueue.poll();</div><div class="line">        ListNode root = <span class="keyword">new</span> ListNode(min.val);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != lists[min.idx]) &#123;</div><div class="line">            lists[min.idx] = add(lists[min.idx], min.idx);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">if</span>( !hash[min.idx] )&#123;</div><div class="line">                hash[min.idx] = <span class="keyword">true</span>;</div><div class="line">                ++hashCount;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>( hashCount == lists.length )&#123;</div><div class="line">            <span class="keyword">return</span> root;</div><div class="line">        &#125;</div><div class="line">        ListNode r = root;</div><div class="line">      <span class="comment">// æ¯æ¬¡ä»å †ä¸­å–å‡ºä¸€ä¸ªæœ€å°å…ƒç´ ï¼Œç„¶åå°†è¿™ä¸ªæœ€å°å…ƒç´ å¯¹åº”çš„é“¾è¡¨çš„å¤´åŠ å…¥åˆ°æœ€å°å †ä¸­</span></div><div class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">            min = priorityQueue.poll();</div><div class="line">            ListNode temp = <span class="keyword">new</span> ListNode(min.val);</div><div class="line">            r.next = temp;</div><div class="line">            r = r.next;</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != lists[min.idx]) &#123;</div><div class="line">                lists[min.idx] = add(lists[min.idx], min.idx);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">if</span>( ! hash[min.idx] )&#123;</div><div class="line">                    hash[min.idx] = <span class="keyword">true</span>;</div><div class="line">                    ++hashCount;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(hashCount == lists.length)&#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line">   <span class="comment">// è¾…åŠ©å‡½æ•°ï¼Œå°†æ•°ç»„æ’å…¥åˆ°é“¾è¡¨ä¸­</span></div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">insert</span><span class="params">(<span class="keyword">int</span>[] a)</span></span>&#123;</div><div class="line">        ListNode root = <span class="keyword">new</span> ListNode(a[<span class="number">0</span>]);</div><div class="line">        ListNode r = root;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">1</span>; i &lt; a.length ; ++i )&#123;</div><div class="line">            ListNode l = <span class="keyword">new</span> ListNode(a[i]);</div><div class="line">            r.next = l;</div><div class="line">            r = r.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span>[] a1 = &#123;<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] a2 = &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</div><div class="line">        Main t = <span class="keyword">new</span> Main();</div><div class="line">        ListNode[] lists = <span class="keyword">new</span> ListNode[<span class="number">1</span>];</div><div class="line">        lists[<span class="number">0</span>] = t.insert(a1);</div><div class="line"><span class="comment">//        lists[1] = t.insert(a2);</span></div><div class="line">        t.mergeKLists(lists);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä½†æ˜¯ï¼è¿˜æœ‰ä¸€ç§æ›´éªšçš„æ“ä½œï¼</strong>ï¼æŠŠæ¯ä¸ªLinkNodeçœ‹åšä¸€ä¸ªå…ƒç´ ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> Comparator&lt;ListNode&gt; ListNodeComparator = <span class="keyword">new</span> Comparator&lt;ListNode&gt;() &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(ListNode left, ListNode right)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> left.val - right.val;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(List&lt;ListNode&gt; lists)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (lists == <span class="keyword">null</span> || lists.size() == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        Queue&lt;ListNode&gt; heap = <span class="keyword">new</span> PriorityQueue&lt;ListNode&gt;(lists.size(), ListNodeComparator);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lists.size(); i++) &#123;</div><div class="line">            <span class="keyword">if</span> (lists.get(i) != <span class="keyword">null</span>) &#123;</div><div class="line">                heap.add(lists.get(i));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        ListNode tail = dummy;</div><div class="line">        <span class="keyword">while</span> (!heap.isEmpty()) &#123;</div><div class="line">            ListNode head = heap.poll();</div><div class="line">            tail.next = head;</div><div class="line">            tail = head;</div><div class="line">            <span class="keyword">if</span> (head.next != <span class="keyword">null</span>) &#123;</div><div class="line">                heap.add(head.next);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dummy.next;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Design-Twitter">8.6. Design Twitter</h2><p>è¿™é“é¢˜éå¸¸ç¹çã€‚è¦è®¾è®¡ä¸€ä¸ªtwitterç±»ï¼Œä½¿å¾—å®ƒèƒ½å¤Ÿå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li><strong>postTweet(userId, tweetId)</strong>: å‘tweet</li>
<li><strong>getNewsFeed(userId)</strong>: è¿”å›ç”¨æˆ·userIdå…³æ³¨å¥½å‹çš„æœ€è¿‘10ä¸ªfeedæµï¼Œå¹¶æŒ‰å‘è¡¨æ—¶é—´è¾“å‡º</li>
<li><strong>follow(followerId, followeeId)</strong>: Follower å…³æ³¨ followee.</li>
<li><strong>unfollow(followerId, followeeId)</strong>: Followerå–å…³ followeeï¼ˆå¦‚æœå®ƒæƒ³å–å…³å®ƒè‡ªå·±ï¼Œå°±ä»€ä¹ˆéƒ½ä¸åšï¼‰</li>
</ol>
<p>æ€è·¯ï¼šè¿™é“é¢˜ä¸»è¦è¦è®¾è®¡å¾ˆå¤šç±»ã€‚æ ¸å¿ƒç®—æ³•ä¸ä¸Šä¸€é¢˜ç›¸åŒï¼Œä¸€å®šè¦å‚è€ƒä¸Šä¸€é¢˜çš„è§£æ³•äºŒã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.lang.reflect.Array;</div><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/16.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Twitter</span> </span>&#123;</div><div class="line">    HashMap&lt;Integer,User&gt; users;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> time;</div><div class="line">    <span class="comment">/** åˆå§‹åŒ– */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Twitter</span><span class="params">()</span> </span>&#123;</div><div class="line">        users = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        time = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">timego</span><span class="params">()</span></span>&#123;</div><div class="line">        ++<span class="keyword">this</span>.time;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.time;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	<span class="comment">//ä¸€æ¡ä¿¡æ¯</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">tweet</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">tweet</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">int</span> tweetId;</div><div class="line">        <span class="keyword">int</span> userId;</div><div class="line">        <span class="keyword">int</span> time;</div><div class="line">        tweet(<span class="keyword">int</span> tweetId,<span class="keyword">int</span> userId, <span class="keyword">int</span> time)&#123;</div><div class="line">            <span class="keyword">this</span>.tweetId = tweetId;</div><div class="line">            <span class="keyword">this</span>.time = time;</div><div class="line">            <span class="keyword">this</span>.userId = userId;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(tweet o)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> o.time - <span class="keyword">this</span>.time;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ä¿¡æ¯æµç±»ï¼Œç”¨é“¾è¡¨è¡¨ç¤º</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ListTweet</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">ListTweet</span>&gt;</span>&#123;</div><div class="line">        tweet tw;</div><div class="line">        ListTweet next;</div><div class="line">        ListTweet()&#123;</div><div class="line">            tw = <span class="keyword">null</span>;</div><div class="line">            next = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        ListTweet(tweet tw)&#123;</div><div class="line">            <span class="keyword">this</span>.tw = tw;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(ListTweet o)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.tw.compareTo(o.tw);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//ç”¨æˆ·ç±»</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> userId;</div><div class="line">        ListTweet feed;</div><div class="line">        ListTweet feed_readed;</div><div class="line">        HashSet&lt;Integer&gt; follows;</div><div class="line">        <span class="keyword">int</span> helper;</div><div class="line">        User(<span class="keyword">int</span> userId)&#123;</div><div class="line">            <span class="keyword">this</span>.userId = userId;</div><div class="line">            feed = <span class="keyword">new</span> ListTweet();</div><div class="line">            follows = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">            follows.add(userId);</div><div class="line">            helper = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">       	<span class="comment">//å‘å¾®åš</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">post</span><span class="params">(<span class="keyword">int</span> tweetId)</span></span>&#123;</div><div class="line">            ListTweet tw = <span class="keyword">new</span> ListTweet(<span class="keyword">new</span> tweet(tweetId,<span class="keyword">this</span>.userId,timego()));</div><div class="line">            tw.next = <span class="keyword">this</span>.feed;</div><div class="line">            <span class="keyword">this</span>.feed = tw;</div><div class="line">        &#125;</div><div class="line">       	<span class="comment">//å…³æ³¨æŸäºº</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFollows</span><span class="params">(<span class="keyword">int</span> followId)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(!follows.contains(followId))</div><div class="line">                follows.add(followId);</div><div class="line">        &#125;</div><div class="line">      	<span class="comment">//å–å…³</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unFollow</span><span class="params">(<span class="keyword">int</span> folleeId)</span></span>&#123;</div><div class="line">            <span class="keyword">if</span>(follows.contains(folleeId))&#123;</div><div class="line">                follows.remove(folleeId);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/** ç”¨æˆ·userIdå‘ä¸€æ¡tweeter tweetId */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postTweet</span><span class="params">(<span class="keyword">int</span> userId, <span class="keyword">int</span> tweetId)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( ! users.containsKey(userId) )&#123;</div><div class="line">            users.put(userId,<span class="keyword">new</span> User(userId));</div><div class="line">        &#125;</div><div class="line">        users.get(userId).post(tweetId);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** è¿”å›ç”¨æˆ·userIdå…³æ³¨å¥½å‹çš„æœ€è¿‘10ä¸ªfeedæµï¼Œå¹¶æŒ‰å‘è¡¨æ—¶é—´è¾“å‡º */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getNewsFeed</span><span class="params">(<span class="keyword">int</span> userId)</span> </span>&#123;</div><div class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        Queue&lt;ListTweet&gt; feeds = <span class="keyword">new</span> PriorityQueue&lt;&gt;(<span class="number">10</span>);</div><div class="line">        <span class="keyword">if</span>( !users.containsKey(userId) )&#123;</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;</div><div class="line">        User user = users.get(userId);</div><div class="line">        <span class="comment">// è·å–ç”¨æˆ·æ‰€æœ‰å¥½å‹</span></div><div class="line">        HashSet&lt;Integer&gt; follows = user.follows;</div><div class="line">        <span class="comment">//è·å–æ¯ä¸ªå¥½å‹feedæµ</span></div><div class="line">        <span class="keyword">for</span>( Integer f : follows )&#123;</div><div class="line">            ListTweet f_feeds = users.get(f).feed;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != f_feeds.tw)feeds.offer(f_feeds);</div><div class="line">        &#125;</div><div class="line">		<span class="comment">//éªšæ“ä½œ</span></div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (!feeds.isEmpty())&#123;</div><div class="line">            ListTweet head = feeds.poll();</div><div class="line">            result.add(head.tw.tweetId);</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != head.next.tw)feeds.offer(head.next);</div><div class="line">            ++i;</div><div class="line">            <span class="keyword">if</span>( i == <span class="number">10</span> )&#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**ç”¨æˆ·follderidå…³æ³¨followee**/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">follow</span><span class="params">(<span class="keyword">int</span> followerId, <span class="keyword">int</span> followeeId)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(! users.containsKey(followeeId) )&#123;</div><div class="line">            users.put(followeeId,<span class="keyword">new</span> User(followeeId));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(! users.containsKey(followerId) )&#123;</div><div class="line">            users.put(followerId,<span class="keyword">new</span> User(followerId));</div><div class="line">        &#125;</div><div class="line">        User er = users.get(followerId);</div><div class="line"></div><div class="line">        er.setFollows(followeeId);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** å–å…³ï¼Œå¦‚æœæ“ä½œéæ³•ï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸åš **/</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unfollow</span><span class="params">(<span class="keyword">int</span> followerId, <span class="keyword">int</span> followeeId)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(followeeId == followerId)<span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span>(! users.containsKey(followeeId) )&#123;</div><div class="line">            users.put(followeeId,<span class="keyword">new</span> User(followeeId));</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(! users.containsKey(followerId) )&#123;</div><div class="line">            users.put(followerId,<span class="keyword">new</span> User(followerId));</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        User er = users.get(followerId);</div><div class="line">        er.unFollow(followeeId);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        Twitter twitter = <span class="keyword">new</span> Twitter();</div><div class="line">        <span class="comment">// User 1 posts a new tweet (id = 5).</span></div><div class="line"></div><div class="line">        twitter.postTweet(<span class="number">1</span>, <span class="number">1</span>);</div><div class="line"></div><div class="line">        <span class="comment">// User 1's news feed should return a list with 1 tweet id -&gt; [5].</span></div><div class="line">        System.out.println(twitter.getNewsFeed(<span class="number">1</span>));</div><div class="line">        <span class="comment">// User 1 follows user 2.</span></div><div class="line">        twitter.follow(<span class="number">2</span>, <span class="number">1</span>);</div><div class="line">        System.out.println(twitter.getNewsFeed(<span class="number">2</span>));</div><div class="line"><span class="comment">// User 2 posts a new tweet (id = 6).</span></div><div class="line">        twitter.postTweet(<span class="number">2</span>, <span class="number">6</span>);</div><div class="line"></div><div class="line"><span class="comment">// User 1's news feed should return a list with 2 tweet ids -&gt; [6, 5].</span></div><div class="line"><span class="comment">// Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5.</span></div><div class="line">        System.out.println(twitter.getNewsFeed(<span class="number">1</span>));</div><div class="line">        twitter.unfollow(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="comment">// User 1's news feed should return a list with 1 tweet id -&gt; [5],</span></div><div class="line"><span class="comment">// since user 1 is no longer following user 2.</span></div><div class="line">        System.out.println(twitter.getNewsFeed(<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Split-Array-into-Consecutive-Subsequences">8.7. Split Array into Consecutive Subsequences</h2><p>ç»™ä¸€ä¸ªæ•°ç»„<code>[1,2,3,3,4,5]</code>ï¼Œé—®å®ƒèƒ½ä¸èƒ½åˆ†æˆå¤šä¸ªé•¿åº¦å¤§äº3çš„è¿ç»­å­æ•°ç»„[1,2,3]å’Œ[3,4,5]ã€‚</p>
<p>æ€è·¯ï¼šå¯¹æˆ‘æ¥è¯´è¾ƒéš¾ã€‚å¾ˆç»•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">==================step <span class="number">1</span>==================</div><div class="line"><span class="comment">//é¦–å…ˆå‡è®¾å·²ç»æœ‰ä¸¤ä¸ªè¿ç»­å­æ•°ç»„äº†ï¼š</span></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">==================step <span class="number">2</span>==================</div><div class="line"><span class="comment">//in --&gt; 3</span></div><div class="line"><span class="comment">//ä¹‹å‰å­æ•°ç»„æœ«å°¾æ²¡æœ‰3-1=2ï¼Œå¼€å¯æ–°çš„å­æ•°ç»„</span></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">b = [<span class="number">3</span>]</div><div class="line">==================step <span class="number">3</span>==================</div><div class="line"><span class="comment">//in --&gt; 4</span></div><div class="line"><span class="comment">//ä¹‹å‰çš„å­æ•°ç»„çš„æœ«å°¾æœ‰4-1=3ï¼Œä¸”æœ‰ä¸¤ä¸ªï¼Œé€‰æ‹©è¾ƒçŸ­çš„é‚£ä¸ª</span></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">b = [<span class="number">3</span>,<span class="number">4</span>]</div><div class="line">==================step <span class="number">4</span>==================</div><div class="line"><span class="comment">// in --&gt; 5</span></div><div class="line"><span class="comment">//ä¹‹å‰çš„å­æ•°ç»„çš„æœ«å°¾æœ‰5-1=4</span></div><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">b = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</div><div class="line">==================step <span class="number">5</span>==================</div><div class="line"><span class="comment">//å­æ•°ç»„é•¿åº¦éƒ½&gt;=3ã€‚è¿”å›true</span></div></pre></td></tr></table></figure>
<p>å…¶å®è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤æ¯ä¸ªå­æ•°ç»„çš„æœ€å¤§å€¼ï¼</p>
<p>ç»´æŠ¤ä¸€ä¸ªhashMapï¼Œkeyæ˜¯å½“å‰æŸå­æ•°ç»„çš„æœ€å¤§å€¼ï¼Œvalueæ˜¯å­æ•°ç»„çš„é•¿åº¦ã€‚ç”±äºåŒä¸€ä¸ªkeyå¯èƒ½å¯¹åº”å¤šä¸ªvalueï¼Œä¸”æ¯æ¬¡æˆ‘ä»¬éƒ½è¦å–æœ€å°å€¼ã€‚å› æ­¤æˆ‘ä»¬å°†valueè®¾ç½®ä¸ºä¸€ä¸ªæœ€å°å †ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPossible</span><span class="params">(<span class="keyword">int</span>[] nums)</span></span>&#123;</div><div class="line">        HashMap&lt;Integer,Queue&lt;Integer&gt;&gt; helper = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        Queue&lt;Integer&gt; heap;</div><div class="line">        <span class="keyword">int</span> min_count;</div><div class="line">        <span class="comment">/**</span></div><div class="line">         * æµç¨‹</div><div class="line">         * å‡è®¾è¾“å…¥[1,2,3,3,4,5]</div><div class="line">         * [1] -&gt; helper = [1,[1]]</div><div class="line">         * [2] -&gt; helper = [2,[2]]</div><div class="line">         * [3] -&gt; helper = [3,[3]]</div><div class="line">         * [3] -&gt; helper = [3,[1,3]]</div><div class="line">         * [4] -&gt; helper = [3,[3]],[4,[1]]</div><div class="line">         * [5] -&gt; helper = [3,[3]],[5,[2]]</div><div class="line">         * **/</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> n : nums )&#123;</div><div class="line">            <span class="keyword">if</span>( helper.containsKey(n-<span class="number">1</span>) )&#123;</div><div class="line">                heap = helper.get(n-<span class="number">1</span>);</div><div class="line">                min_count = heap.poll()+<span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>( heap.isEmpty() ) helper.remove(n-<span class="number">1</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                min_count = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>( !helper.containsKey(n) )&#123;</div><div class="line">                helper.put(n,<span class="keyword">new</span> PriorityQueue&lt;&gt;());</div><div class="line">            &#125;</div><div class="line">            heap = helper.get(n);</div><div class="line">            heap.offer(min_count);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(Map.Entry&lt;Integer, Queue&lt;Integer&gt;&gt; key : helper.entrySet())&#123;</div><div class="line">            heap = key.getValue();</div><div class="line">            <span class="keyword">while</span> (!heap.isEmpty())&#123;</div><div class="line">                <span class="keyword">if</span>(heap.poll() &lt; <span class="number">3</span>)&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="Trapping-Rain-Water-II">8.8. Trapping Rain Water II</h2><p>ç»™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå‡è®¾è¿™æ˜¯ä¸€ä¸ªå°å­ã€‚è¾¹ç•Œæ²¡æœ‰æŒ¡æ¿ã€‚æ±‚é—®è¿™ä¸ªå°å­æœ€å¤šèƒ½ä¹˜å¤šå°‘é›¨æ°´ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  [1,4,3,1,3,2],</div><div class="line">  [3,2,1,3,2,4],</div><div class="line">  [2,3,3,2,3,1]</div><div class="line">]</div><div class="line">è¿”å›4</div></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ç›¸å¯¹æ¥è¯´æ¯”è¾ƒéš¾ã€‚æ€è·¯å°±æ˜¯ç”¨å †ç»´æŠ¤ä¸€ä¸ªæœ€å°è¾¹ç•Œï¼Œæ¯æ¬¡æ ¹æ®è¿™ä¸ªæœ€å°è¾¹ç•Œè¿›è¡Œå¡«æ°´ã€‚</p>
<ul>
<li>ç»´æŠ¤ä¸€ä¸ªæœ€å°å †ï¼Œä¿å­˜æœ€å¤–é¢ä¸€åœˆçš„é«˜åº¦ï¼Œå› ä¸ºæœ€çŸ®çš„æ ¼å­å†³å®šäº†æ°´èƒ½å­˜æ”¾å¤šå°‘</li>
<li>æ¯æ¬¡å–æœ€å°é«˜åº¦ hï¼Œä¸å‘¨å›´4ä¸ªä¸­æ²¡æœ‰è¢«è®¿é—®è¿‡çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒ<ul>
<li>å¦‚æœè¯¥å…ƒç´ çš„é«˜åº¦å°äº hï¼Œåˆ™æ³¨æ°´åˆ°å…¶ä¸­ï¼Œå¹¶å°†å…¶åŠ å…¥åˆ°æœ€å°å †ä¸­ï¼Œè®¾ç½®è¯¥å…ƒç´ è¢«è®¿é—®è¿‡</li>
<li>å¦‚æœè¯¥å…ƒç´ çš„é«˜åº¦å¤§äº hï¼Œåˆ™ç›´æ¥å°†å…¶åŠ å…¥åˆ°æœ€å°å †ä¸­ï¼Œè®¾ç½®æ”¹å…ƒç´ è¢«è®¿é—®è¿‡</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Node</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">int</span> h;</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">int</span> j;</div><div class="line">        Node(<span class="keyword">int</span> h,<span class="keyword">int</span> i,<span class="keyword">int</span> j)&#123;</div><div class="line">            <span class="keyword">this</span>.h = h;</div><div class="line">            <span class="keyword">this</span>.i = i;</div><div class="line">            <span class="keyword">this</span>.j = j;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Node o)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.h - o.h;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">trapRainWater</span><span class="params">(<span class="keyword">int</span>[][] heightMap)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( heightMap.length &lt;= <span class="number">2</span> || heightMap[<span class="number">0</span>].length &lt;= <span class="number">2</span> )<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        Queue&lt;Node&gt; heap = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</div><div class="line">        <span class="keyword">int</span>[] bound_j = &#123;<span class="number">0</span>,heightMap[<span class="number">0</span>].length-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] bound_i = &#123;<span class="number">0</span>,heightMap.length-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">boolean</span>[][] hash = <span class="keyword">new</span> <span class="keyword">boolean</span>[heightMap.length][heightMap[<span class="number">0</span>].length];</div><div class="line">        <span class="keyword">int</span> i,j;</div><div class="line">        <span class="keyword">int</span> count = heightMap.length * heightMap[<span class="number">0</span>].length ;</div><div class="line">        <span class="comment">//å°†è¾¹ç•Œæ”¾å…¥å †</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> b : bound_i )&#123;</div><div class="line">            <span class="keyword">for</span>( j = <span class="number">0</span> ; j &lt; heightMap[<span class="number">0</span>].length ; ++j )&#123;</div><div class="line">                heap.offer(<span class="keyword">new</span> Node(heightMap[b][j],b,j));</div><div class="line">                hash[b][j] = <span class="keyword">true</span>;</div><div class="line">                --count;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> b : bound_j )&#123;</div><div class="line">            <span class="keyword">for</span>( i = <span class="number">1</span> ; i &lt; heightMap.length-<span class="number">1</span> ; ++i )&#123;</div><div class="line">                heap.offer(<span class="keyword">new</span> Node(heightMap[i][b],i,b));</div><div class="line">                hash[i][b] = <span class="keyword">true</span>;</div><div class="line">                --count;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        Node min;</div><div class="line">        <span class="keyword">int</span>[] ii = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span>&#125;;</div><div class="line">        <span class="keyword">int</span>[] jj = &#123;<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</div><div class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> k;</div><div class="line">        <span class="keyword">while</span> (count &gt; <span class="number">0</span>)&#123;</div><div class="line">            min = heap.poll();</div><div class="line">            <span class="comment">//æ£€æŸ¥minçš„ä¸Šä¸‹å·¦å³</span></div><div class="line">            <span class="keyword">for</span>( k = <span class="number">0</span> ; k &lt; ii.length ; ++k )&#123;</div><div class="line">                i = min.i + ii[k];</div><div class="line">                j = min.j + jj[k];</div><div class="line">                <span class="keyword">if</span>( i &lt; <span class="number">0</span> || i &gt;= hash.length || j &lt; <span class="number">0</span> || j &gt;= hash[<span class="number">0</span>].length )<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span>(!hash[i][j])&#123;</div><div class="line">                    <span class="keyword">if</span>(min.h &gt; heightMap[i][j])&#123;</div><div class="line">                        result +=  min.h - heightMap[i][j];</div><div class="line">                        heightMap[i][j] = min.h;</div><div class="line">                    &#125;</div><div class="line">                    heap.offer(<span class="keyword">new</span> Node(heightMap[i][j],i,j));</div><div class="line">                    hash[i][j] = <span class="keyword">true</span>;</div><div class="line">                    --count;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="The-Skyline-Problem">8.9. The Skyline Problem</h2><p>é¢˜æ„ï¼šç»™ä¸€äº›å¤§æ¥¼<code>int[][] build</code>ï¼Œæ¯ä¸ªæ¥¼æ˜¯ä¸‰å…ƒç»„[left,right,h]ã€‚å¦‚<code>[ [2 9 10], [3 7 15], [5 12 12], [15 20 10], [19 24 8] ]</code>ã€‚æ±‚è¿™äº›å¤§æ¥¼çš„å…³é”®ç‚¹ã€‚å³æ±‚è¿™äº›ç‚¹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-17-15-30-30.png" alt=""> </p>
<p>è¾“å‡ºä¸ºï¼š<code>[ [2 10], [3 15], [7 12], [12 0], [15 10], [20 8], [24, 0] ]</code></p>
<p>è¿™é¢˜å¥½éš¾å•Šï¼ï¼ï¼</p>
<p><strong>å‡ºå‘ç‚¹ï¼š</strong></p>
<ol>
<li>å·¦é¡¶ç‚¹å‡ºç°ä¼´éšç€è¿™æ ‹æ¥¼å¼€å§‹</li>
<li>å³é¡¶ç‚¹å‡ºç°ä¼´éšç€è¿™æ ‹æ¥¼ç»“æŸ</li>
<li>ä¸€æ—¦å“ªä¸ªé¡¶ç‚¹å¤„çš„max_heightä¸å‰ä¸€ä¸ªä¸ä¸€æ ·ï¼Œé‚£è¿™ä¸ªå°±æ˜¯key pointäº†ï¼</li>
</ol>
<p><strong>æ€è·¯</strong>ï¼šå€ŸåŠ©å¤§é¡¶å †ç»´æŠ¤å½“å‰æœ€é«˜çš„æ¥¼ï¼Œæ—¶é—´O(NlogN) ç©ºé—´O(N)ã€‚<br>1 æŠŠè¿™äº›çŸ©å½¢æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªå·¦ä¸Šé¡¶ç‚¹ï¼Œä¸€ä¸ªå³ä¸Šé¡¶ç‚¹ã€‚å°†æ‰€æœ‰é¡¶ç‚¹æŒ‰ç…§æ¨ªåæ ‡æ’åºåï¼Œå¼€å§‹éå†è¿™äº›ç‚¹ã€‚<br>2 éå†æ—¶ï¼Œé€šè¿‡ä¸€ä¸ªå¤§é¡¶å †æ¥å¾—çŸ¥å½“å‰å›¾å½¢çš„æœ€é«˜ä½ç½®ã€‚å †é¡¶æ˜¯æ‰€æœ‰é¡¶ç‚¹ä¸­æœ€é«˜çš„ç‚¹ï¼Œåªè¦è¿™ä¸ªç‚¹æ²¡è¢«ç§»å‡ºå †ï¼Œè¯´æ˜è¿™ä¸ªæœ€é«˜çš„çŸ©å½¢è¿˜æ²¡ç»“æŸã€‚<br>3 å¯¹äºå·¦é¡¶ç‚¹ï¼Œæˆ‘ä»¬å°†å…¶åŠ å…¥å †ä¸­ã€‚å¯¹äºå³é¡¶ç‚¹ï¼Œæˆ‘ä»¬æ‰¾å‡ºå †ä¸­å…¶ç›¸åº”çš„å·¦é¡¶ç‚¹ï¼Œç„¶åç§»å‡ºè¿™ä¸ªå·¦é¡¶ç‚¹ï¼ŒåŒæ—¶ä¹Ÿæ„å‘³è¿™è¿™ä¸ªçŸ©å½¢çš„ç»“æŸã€‚<br>4 ä»£ç ä¸­ï¼Œä¸ºäº†åŒºåˆ†å·¦å³é¡¶ç‚¹ï¼Œå·¦é¡¶ç‚¹é«˜åº¦å€¼æ˜¯è´Ÿæ•°ï¼Œè€Œå³é¡¶ç‚¹é«˜åº¦å€¼åˆ™å­˜çš„æ˜¯æ­£æ•°ã€‚æ³¨æ„ï¼Œå †ä¸­å…ˆåŠ å…¥ä¸€ä¸ª0é«˜åº¦ï¼Œå¸®åŠ©æˆ‘ä»¬åœ¨åªæœ‰æœ€çŸ®çš„å»ºç­‘ç‰©æ—¶é€‰æ‹©æœ€ä½å€¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by jiayi on 2017/11/13.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;<span class="keyword">int</span>[]&gt; getSkyline(<span class="keyword">int</span>[][] buildings) &#123;</div><div class="line">        List&lt;<span class="keyword">int</span>[]&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        List&lt;<span class="keyword">int</span>[]&gt; height = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="comment">//æ„å»ºå·¦å³é¡¶ç‚¹æ··åˆåˆ—è¡¨</span></div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span>[] b : buildings )&#123;</div><div class="line">            <span class="comment">//b[0] å·¦é¡¶ç‚¹</span></div><div class="line">            <span class="comment">//b[1] å³é¡¶ç‚¹</span></div><div class="line">            <span class="comment">//b[2] æ¥¼é«˜åº¦</span></div><div class="line">            height.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;b[<span class="number">0</span>],-b[<span class="number">2</span>]&#125;);<span class="comment">//å·¦é«˜åº¦ä¸ºè´Ÿ</span></div><div class="line">            height.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;b[<span class="number">1</span>],b[<span class="number">2</span>]&#125;);<span class="comment">//å³é«˜åº¦ä¸ºè´Ÿ</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æŒ‰æ¨ªåæ ‡æ’åºï¼Œç›¸åŒæ¨ªåæ ‡å…¶hå°çš„åœ¨å‰</span></div><div class="line">        Collections.sort(height,(a,b) -&gt; &#123;</div><div class="line">            <span class="keyword">if</span>( a[<span class="number">0</span>] != b[<span class="number">0</span>] ) <span class="keyword">return</span> a[<span class="number">0</span>] - b[<span class="number">0</span>];</div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> a[<span class="number">1</span>] - b[<span class="number">1</span>];</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">// æ„å»ºå¤§é¡¶å †ï¼ŒæŒ‰ç…§çºµåæ ‡æ¥åˆ¤æ–­å¤§å°</span></div><div class="line">        Queue&lt;Integer&gt; pq = <span class="keyword">new</span> PriorityQueue&lt;&gt;(<span class="number">11</span>, (i1,i2) -&gt; (i2-i1));</div><div class="line">        <span class="comment">//å°†åœ°å¹³çº¿å€¼0åŠ å…¥å †</span></div><div class="line">        pq.offer(<span class="number">0</span>);</div><div class="line">        <span class="comment">//prevç”¨äºè®°å½•ä¸Šæ¬¡çš„keypointé«˜åº¦</span></div><div class="line">        <span class="keyword">int</span> prev = <span class="number">0</span> ;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span>[] h : height )&#123;</div><div class="line">            <span class="keyword">if</span>( h[<span class="number">1</span>] &lt; <span class="number">0</span> )&#123;<span class="comment">//hæ˜¯å·¦é¡¶ç‚¹</span></div><div class="line">                <span class="comment">//å°†å·¦é¡¶ç‚¹åŠ å…¥å †</span></div><div class="line">                pq.offer(-h[<span class="number">1</span>]);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;<span class="comment">//hæ˜¯å³é¡¶ç‚¹</span></div><div class="line">                <span class="comment">// å°†å³é¡¶ç‚¹å¯¹åº”çš„å·¦é¡¶ç‚¹ç§»å»</span></div><div class="line">                pq.remove(h[<span class="number">1</span>]);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> cur = pq.peek();</div><div class="line">            <span class="comment">// å¦‚æœå †çš„æ–°é¡¶éƒ¨å’Œä¸Šä¸ªkeypointé«˜åº¦ä¸ä¸€æ ·ï¼Œåˆ™åŠ å…¥ä¸€ä¸ªæ–°çš„keypoint</span></div><div class="line">            <span class="keyword">if</span>( prev != cur )&#123;</div><div class="line">                result.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;h[<span class="number">0</span>],cur&#125;);</div><div class="line">                prev = cur;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">        <span class="comment">/**æ‰§è¡Œæµç¨‹</span></div><div class="line">         * in -&gt; [2,9,10],[3 7 15]</div><div class="line">         * height -&gt; [2,-10],[3,-15],[7,15],[9,10]</div><div class="line">         * loop = 1 -&gt; [2,-10]æ˜¯å·¦é¡¶ç‚¹ï¼Œpq = [10] --&gt; out [2,10]</div><div class="line">         * loop = 2 -&gt; [3,-15]æ˜¯å·¦é¡¶ç‚¹ï¼Œpq = [10,15] --&gt; out [3,15]</div><div class="line">         * loop = 3 -&gt; [7,15]æ˜¯å³é¡¶ç‚¹ï¼Œpq = [10] --&gt; out[7,10]</div><div class="line">         * loop = 4 -&gt; [9,10]æ˜¯å³é¡¶ç‚¹ï¼Œpq = [] --&gt; out[]</div><div class="line">         * **/</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span>[][] nums = &#123;</div><div class="line">                &#123;<span class="number">2</span>,<span class="number">9</span>,<span class="number">10</span>&#125;,</div><div class="line">                &#123;<span class="number">3</span>,<span class="number">7</span>,<span class="number">15</span>&#125;,</div><div class="line">                &#123;<span class="number">5</span>,<span class="number">12</span>,<span class="number">12</span>&#125;,</div><div class="line">                &#123;<span class="number">15</span>,<span class="number">20</span>,<span class="number">10</span>&#125;,</div><div class="line">                &#123;<span class="number">19</span>,<span class="number">24</span>,<span class="number">8</span>&#125;</div><div class="line">        &#125;;</div><div class="line">        Main t = <span class="keyword">new</span> Main();</div><div class="line">        System.out.println(t.getSkyline(nums));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">9. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/vamei/archive/2013/03/20/2966612.html" target="_blank" rel="external">çº¸ä¸Šè°ˆå…µï¼šå †</a></li>
<li><a href="http://vickyqi.com/2015/11/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%A0%86/" target="_blank" rel="external">æ•°æ®ç»“æ„ç³»åˆ—-å †</a></li>
<li><a href="http://eugeneyang.com/2016/04/13/The%20Skyline%20Problem%20-%20%E5%A4%A9%E9%99%85%E7%BA%BF%E9%97%AE%E9%A2%98/" target="_blank" rel="external">The Skyline Problem - å¤©é™…çº¿é—®é¢˜</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> TOP-K </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-DP-é’¢æ¡åˆ‡å‰²é—®é¢˜]]></title>
      <url>/2017/11/02/%E7%AE%97%E6%B3%95-DP-%E9%92%A2%E6%9D%A1%E5%88%87%E5%89%B2%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>åœ¨è¯´é’¢æ¡åˆ‡å‰²é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¯´è¯´åŠ¨æ€è§„åˆ’ã€‚</p>
<p><strong>åŠ¨æ€è§„åˆ’</strong>â€”â€”Dynamic programming(è¿™ä¸ªè¯æŒ‡è¡¨æ ¼)ï¼šé€šè¿‡ç»„åˆå­é—®é¢˜çš„è§£æ±‚è§£åŸé—®é¢˜ã€‚</p>
<p><strong>ä¸åˆ†æ²»æ³•å¯¹æ¯”ï¼š</strong></p>
<ol>
<li>ç›¸åŒç‚¹ï¼šéƒ½æ˜¯é€šè¿‡å­é—®é¢˜ç»„åˆæ±‚è§£åŸé—®é¢˜</li>
<li>ä¸åŒç‚¹ï¼šåˆ†æ²»æ³•å°†é—®é¢˜åˆ’åˆ†ä¸º<strong>ä¸ç›¸äº¤</strong>çš„å­é—®é¢˜ï¼Œæ±‚è§£å†åˆå¹¶ã€‚åŠ¨æ€è§„åˆ’åº”ç”¨äº<strong>å­é—®é¢˜é‡å </strong>çš„æƒ…å†µï¼Œå³<strong>ä¸åŒ</strong>çš„å­é—®é¢˜å…·æœ‰<strong>å…¬å…±</strong>çš„å­å­é—®é¢˜ï¼Œæ­¤æ—¶å¦‚æœç”¨åˆ†æ²»æ³•å°±ä¼šå‡ºç°é‡å¤è®¡ç®—æ±‚è§£ã€‚ä¸ºäº†é¿å…é‡å¤åŠ¨æ€è§„åˆ’å¯¹å­é—®é¢˜åªæ±‚è§£ä¸€æ¬¡ï¼Œå°†å…¶ä¿å­˜åœ¨è¡¨æ ¼ä¸­ï¼Œä»è€Œæ— éœ€æ¯æ±‚è§£ä¸€ä¸ªå­å­é—®é¢˜æ—¶é‡å¤è®¡ç®—ã€‚</li>
</ol>
<p><strong>æ±‚è§£æ­¥éª¤</strong></p>
<ol>
<li>åˆ»ç”»æœ€ä¼˜è§£çš„ç»“æ„ç‰¹å¾</li>
<li>é€’å½’å®šä¹‰æœ€ä¼˜è§£çš„å€¼</li>
<li>è®¡ç®—æœ€ä¼˜è§£çš„å€¼ï¼Œé€šå¸¸é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•ï¼ˆå¯èƒ½éœ€è¦åŒæ—¶ç»´æŠ¤ä¸€äº›é¢å¤–ä¿¡æ¯ï¼‰</li>
<li>åˆ©ç”¨è®¡ç®—å‡ºçš„ä¿¡æ¯æ„é€ æœ€ä¼˜è§£ï¼ˆä¸æ˜¯å¿…é¡»ï¼‰</li>
</ol>
<h1 id="é’¢æ¡åˆ‡å‰²">1. é’¢æ¡åˆ‡å‰²</h1><p>Serlingå…¬å¸è´­ä¹°ä¸€æ ¹é•¿é’¢ç®¡ï¼Œå°†å…¶åˆ‡å‰²æˆçŸ­é’¢ç®¡å‡ºå”®ï¼Œç»™å®šé’¢ç®¡é•¿åº¦å’Œå¯¹åº”çš„ä»·é’±å¦‚ä¸‹è¡¨ï¼š</p>
<p><img src="https://i.loli.net/2017/10/31/59f7536b8fc8f.png" alt="img"></p>
<p>é—®é¢˜è¦æ±‚æ ¹æ®ä¸Šé¢çš„ä»·æ ¼ï¼Œç»™å‡ºæœ€ä½³çš„åˆ‡å‰²æ–¹æ¡ˆï¼Œä½¿å¾—æ”¶ç›Šæœ€å¤§ã€‚</p>
<p>ä»¥n=4ä¸ºä¾‹ï¼Œå¯ä»¥å°†é’¢æ¡åˆ‡å‰²æˆå¦‚ä¸‹å›¾æ‰€ç¤ºçš„8ç§æƒ…å†µï¼Œå…¶ä¸­æ”¶ç›Šæœ€å¤§çš„æ˜¯(c)ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2017/10/30/59f73938d2f50.png" alt="img"></p>
<p>è¿™ä¸ªé¢˜çš„åˆ‡å…¥ç‚¹éå¸¸é‡è¦ï¼Œä¹Ÿå°±æ˜¯â€”â€”å½“çŸ¥é“é•¿åº¦ä¸º1åˆ°içš„é’¢æ¡çš„åˆ‡å‰²æ–¹æ¡ˆæ—¶ï¼Œå¯ä»¥æ¨å¯¼å‡ºé•¿åº¦ä¸ºi+1çš„é’¢æ¡å¦‚ä½•åˆ‡å‰²æœ€ä¼˜ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰é•¿åº¦=iï¼Œä¸”é•¿åº¦ä¸ºiæ—¶æœ€ä¼˜åˆ‡å‰²æ–¹æ¡ˆçš„æ”¶ç›Šæ˜¯$r_i$</p>
<ul>
<li>i=1æ—¶ï¼Œ å½“ç„¶ä¸åˆ‡å‰²ï¼Œå³$r_1=p_1$</li>
<li>i=2æ—¶ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œè¦ä¹ˆåˆ‡ä¸€åˆ€ï¼Œè¦ä¹ˆä¸åˆ‡ï¼Œå³$r_2=max[p_2,r_1+r_1]$</li>
<li>i=3æ—¶ï¼Œæˆ‘ä»¬ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°ï¼Œå‡è®¾æˆ‘ä»¬ä»å®ƒä¸Šé¢éšä¾¿åˆ‡ä¸€åˆ€ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ— è®ºæ˜¯å·¦è¾¹è¿˜æ˜¯å³è¾¹éƒ½æ˜¯å·²çŸ¥çš„ã€‚å³$r_3=max[p_3,r_1+r_2,r_2+r_1]$</li>
<li>i=4æ—¶ï¼Œè¿˜æ˜¯å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæˆ‘ä»¬ä»å“ªé‡Œåˆ‡ä¸€åˆ€ï¼Œä¼šå‘ç°æ— è®ºæ˜¯å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼Œéƒ½æ˜¯å·²çŸ¥çš„ï¼å³$r_4=max[p_4,r_1+r_3,r_2+r_2,r_3+r_1]$</li>
</ul>
<p><img src="https://i.loli.net/2017/11/02/59fb152d32886.png" alt="">  </p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<strong>æ›´çŸ­çš„é’¢æ¡çš„æœ€ä¼˜åˆ‡å‰²æ”¶ç›Š</strong>æ¥æè¿°å®ƒï¼š</p>
<p>$$r_n = max[p_n,r_1+r_{n-1},r_2+r_{n-2},â€¦,r_{n-1}+r_1]$$</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public int[] q;</div><div class="line">private void solve(int n,int k,int[] p)&#123;</div><div class="line">    if(k&gt;n)return;</div><div class="line">    //é•¿åº¦kçš„é’¢æ¡</div><div class="line">    q[k] = p[k];</div><div class="line">    //éå†ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—max = [r_1+r_&#123;n-1&#125;,r_2+r_&#123;n-2&#125;,...,r_&#123;n-1&#125;+r_1]</div><div class="line">    for(int i=1;i&lt;k;i+=1)&#123;</div><div class="line">        q[k] = Math.max(q[i]+ q[k-i], q[k]);</div><div class="line">    &#125;</div><div class="line">    solve(n,k+1,p);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="é’¢æ¡åˆ‡å‰²å‡çº§ç‰ˆ">2. é’¢æ¡åˆ‡å‰²å‡çº§ç‰ˆ</h1><p>ã€Šç®—æ³•å¯¼è®ºã€‹ç»ƒä¹ é¢˜15.1-3æå‡ºï¼šé™¤äº†åˆ‡å‰²ä¸‹çš„é’¢æ¡æ®µå…·æœ‰ä¸åŒä»·æ ¼$p_i$å¤–ï¼Œæ¯æ¬¡åˆ‡å‰²è¿˜è¦ä»˜å‡ºå›ºå®šæˆæœ¬$c$ã€‚æ±‚ä¿®æ”¹åçš„é’¢æ¡åˆ‡å‰²é—®é¢˜ã€‚</p>
<p><img src="https://i.loli.net/2017/11/02/59fb1b5eabefa.png" alt=""> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public int[] q;</div><div class="line"></div><div class="line">private void solve(int n,int k,int[] p,int c)&#123;</div><div class="line">    if(k&gt;n)return;</div><div class="line">    //é•¿åº¦kçš„é’¢æ¡</div><div class="line">    q[k] = p[k];</div><div class="line">    for(int i=1;i&lt;k;i+=1)&#123;</div><div class="line">        q[k] = Math.max(q[i]+ q[k-i] - c, q[k]);</div><div class="line">    &#125;</div><div class="line">    solve(n,k+1,p,c);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> DP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ ç®—æ³•-å·ç§¯ç½‘ç»œ]]></title>
      <url>/2017/10/31/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C/</url>
      <content type="html"><![CDATA[<p>ä¸€èˆ¬æ¥è¯´ï¼Œå›¾ç‰‡æ˜¯éå¸¸å¤§çš„ã€‚è‡³å°‘æœ‰$n\times n\times 3$çš„åƒç´ ï¼Œå³æœ‰è¿™ä¹ˆå¤šç‰¹å¾ã€‚ å¯¹äºå°å°ºå¯¸çš„å›¾ç‰‡é—®é¢˜ï¼Œä¹Ÿè®¸æˆ‘ä»¬ç”¨æ·±åº¦ç¥ç»ç½‘ç»œçš„ç»“æ„å¯ä»¥è¾ƒä¸ºç®€å•çš„è§£å†³ä¸€å®šçš„é—®é¢˜ã€‚ä½†æ˜¯å½“åº”ç”¨åœ¨å¤§å°ºå¯¸çš„å›¾ç‰‡ä¸Šï¼Œè¾“å…¥è§„æ¨¡å°†å˜å¾—ååˆ†åºå¤§ï¼Œä½¿ç”¨ç¥ç»ç½‘ç»œå°†ä¼šæœ‰éå¸¸å¤šçš„å‚æ•°éœ€è¦å»å­¦ä¹ ï¼Œè¿™ä¸ªæ—¶å€™ç¥ç»ç½‘ç»œå°±ä¸å†é€‚ç”¨ã€‚</p>
<p>å·ç§¯ç¥ç»ç½‘ç»œåœ¨è®¡ç®—æœºè§†è§‰é—®é¢˜ä¸Šæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç½‘ç»œç»“æ„ã€‚</p>
<h1 id="æ¦‚è¿°">1. æ¦‚è¿°</h1><h2 id="å›¾åƒè¯†åˆ«è¿‡ç¨‹">1.1. å›¾åƒè¯†åˆ«è¿‡ç¨‹</h2><p> å½“æˆ‘ä»¬ç»™å®šä¸€ä¸ªâ€Xâ€çš„å›¾æ¡ˆï¼Œè®¡ç®—æœºæ€ä¹ˆè¯†åˆ«è¿™ä¸ªå›¾æ¡ˆå°±æ˜¯â€œXâ€å‘¢ï¼Ÿä¸€ä¸ªå¯èƒ½çš„åŠæ³•å°±æ˜¯è®¡ç®—æœºå­˜å‚¨ä¸€å¼ æ ‡å‡†çš„â€œXâ€å›¾æ¡ˆï¼Œç„¶åæŠŠéœ€è¦è¯†åˆ«çš„æœªçŸ¥å›¾æ¡ˆè·Ÿæ ‡å‡†â€Xâ€å›¾æ¡ˆè¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœäºŒè€…ä¸€è‡´ï¼Œåˆ™åˆ¤å®šæœªçŸ¥å›¾æ¡ˆå³æ˜¯ä¸€ä¸ªâ€Xâ€å›¾æ¡ˆã€‚</p>
<p>è€Œä¸”å³ä¾¿æœªçŸ¥å›¾æ¡ˆå¯èƒ½æœ‰ä¸€äº›å¹³ç§»æˆ–ç¨ç¨å˜å½¢ï¼Œä¾ç„¶èƒ½è¾¨åˆ«å‡ºå®ƒæ˜¯ä¸€ä¸ªXå›¾æ¡ˆã€‚å¦‚æ­¤ï¼ŒCNNæ˜¯æŠŠæœªçŸ¥å›¾æ¡ˆå’Œæ ‡å‡†Xå›¾æ¡ˆä¸€ä¸ªå±€éƒ¨ä¸€ä¸ªå±€éƒ¨çš„å¯¹æ¯”ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2017/11/02/59fa7bbb36b29.png" alt=""> </p>
<p><strong>è€ŒæœªçŸ¥å›¾æ¡ˆçš„å±€éƒ¨å’Œæ ‡å‡†Xå›¾æ¡ˆçš„å±€éƒ¨ä¸€ä¸ªä¸€ä¸ªæ¯”å¯¹æ—¶çš„è®¡ç®—è¿‡ç¨‹ï¼Œä¾¿æ˜¯å·ç§¯æ“ä½œ</strong>ã€‚å·ç§¯è®¡ç®—ç»“æœä¸º1è¡¨ç¤ºåŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…ã€‚</p>
<h2 id="å›¾åƒè¾¹ç¼˜æ£€æµ‹">1.2. å›¾åƒè¾¹ç¼˜æ£€æµ‹</h2><p>å·ç§¯è¿ç®—æ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ã€‚ä¸‹é¢ä»¥è¾¹ç¼˜æ£€æµ‹çš„ä¾‹å­æ¥ä»‹ç»å·ç§¯è¿ç®—ã€‚</p>
<p>æ‰€è°“è¾¹ç¼˜æ£€æµ‹ï¼Œåœ¨ä¸‹é¢çš„å›¾ä¸­ï¼Œåˆ†åˆ«é€šè¿‡å‚ç›´è¾¹ç¼˜æ£€æµ‹å’Œæ°´å¹³è¾¹ç¼˜æ£€æµ‹å¾—åˆ°ä¸åŒçš„ç»“æœï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-14-38-35.png" alt=""> </p>
<p><strong>å‚ç›´è¾¹ç¼˜æ£€æµ‹ï¼š</strong></p>
<p>å‡è®¾å¯¹äºä¸€ä¸ª 6Ã—6 å¤§å°çš„å›¾ç‰‡ï¼ˆä»¥æ•°å­—è¡¨ç¤ºï¼‰ï¼Œä»¥åŠä¸€ä¸ª 3Ã—3 å¤§å°çš„ <strong>filter</strong>ï¼ˆå·ç§¯æ ¸ï¼‰ è¿›è¡Œå·ç§¯è¿ç®—ï¼Œä»¥â€œâˆ—â€ç¬¦å·è¡¨ç¤ºã€‚å›¾ç‰‡å’Œå‚ç›´è¾¹ç¼˜æ£€æµ‹å™¨åˆ†åˆ«å¦‚å·¦å’Œä¸­çŸ©é˜µæ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-14-40-48.png" alt=""> </p>
<p><strong>filter</strong> ä¸æ–­åœ°å’Œå…¶å¤§å°ç›¸åŒçš„éƒ¨åˆ†åšã€å¯¹åº”å…ƒç´ çš„ä¹˜æ³•è¿ç®—å¹¶æ±‚å’Œã€‘ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°å­—ç›¸å½“äºæ–°å›¾ç‰‡çš„ä¸€ä¸ªåƒç´ å€¼ï¼Œå¦‚å³çŸ©é˜µæ‰€ç¤ºï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª 4Ã—4 å¤§å°çš„å›¾ç‰‡ã€‚</p>
<p><strong>è¾¹ç¼˜æ£€æµ‹çš„åŸç†ï¼š</strong></p>
<p>ä»¥ä¸€ä¸ªæœ‰ä¸€æ¡å‚ç›´è¾¹ç¼˜çº¿çš„ç®€å•å›¾ç‰‡æ¥è¯´æ˜ã€‚é€šè¿‡å‚ç›´è¾¹ç¼˜ <strong>filter</strong> æˆ‘ä»¬å¾—åˆ°çš„æœ€ç»ˆç»“æœå›¾ç‰‡å¯ä»¥æ˜æ˜¾åœ°å°†è¾¹ç¼˜å’Œéè¾¹ç¼˜åŒºåˆ†å‡ºæ¥ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-14-41-29.png" alt=""> </p>
<p>å·ç§¯è¿ç®—æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•æ¥æ£€æµ‹å›¾åƒä¸­çš„è¾¹ç¼˜ï¼Œæˆä¸ºå·ç§¯ç¥ç»ç½‘ç»œä¸­é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p><strong>å¤šç§è¾¹ç¼˜æ£€æµ‹ï¼š</strong></p>
<p>å‚ç›´å’Œæ°´å¹³è¾¹ç¼˜æ£€æµ‹</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-05-41.png" alt=""> </p>
<p>æ›´å¤æ‚çš„<strong>filter</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-05-55.png" alt=""> </p>
<p>å¯¹äºå¤æ‚çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†<strong>filter</strong>ä¸­çš„æ•°å­—ç›´æ¥çœ‹ä½œæ˜¯éœ€è¦å­¦ä¹ çš„å‚æ•°ï¼Œå…¶å¯ä»¥å­¦ä¹ åˆ°å¯¹äºå›¾ç‰‡æ£€æµ‹ç›¸æ¯”ä¸Šé¢filteræ›´å¥½çš„æ›´å¤æ‚çš„<strong>filter</strong>ï¼Œå¦‚ç›¸å¯¹äºæ°´å¹³å’Œå‚ç›´æ£€æµ‹å™¨ï¼Œæˆ‘ä»¬è®­ç»ƒçš„ filter å‚æ•°ä¹Ÿè®¸å¯ä»¥çŸ¥é“ä¸åŒè§’åº¦çš„è¾¹ç¼˜ã€‚</p>
<p>é€šè¿‡å·ç§¯è¿ç®—ï¼Œåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­é€šè¿‡åå‘ä¼ æ’­ç®—æ³•ï¼Œå¯ä»¥å­¦ä¹ åˆ°ç›¸åº”äºç›®æ ‡ç»“æœçš„<strong>filter</strong>ï¼Œå°†å…¶åº”ç”¨äºæ•´ä¸ªå›¾ç‰‡ï¼Œè¾“å‡ºå…¶æå–åˆ°çš„æ‰€æœ‰æœ‰ç”¨çš„ç‰¹å¾ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-06-48.png" alt=""> </p>
<h2 id="å·ç§¯ç½‘ç»œç»“æ„">1.3. å·ç§¯ç½‘ç»œç»“æ„</h2><p>æœ¬èŠ‚ä¸»è¦æ¥è‡ªå‚è€ƒæ–‡çŒ®<a href="http://blog.csdn.net/v_july_v/article/details/51812459" target="_blank" rel="external">CNNç¬”è®°ï¼šé€šä¿—ç†è§£å·ç§¯ç¥ç»ç½‘ç»œ</a></p>
<p><a href="http://cs231n.github.io/convolutional-networks/#overview" target="_blank" rel="external">cs231n</a>è¯¾ç¨‹é‡Œç»™å‡ºäº†å·ç§¯ç¥ç»ç½‘ç»œå„ä¸ªå±‚çº§ç»“æ„ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160702205047459" alt="img"></p>
<p>å›¾ä¸­CNNè¦åšçš„äº‹æƒ…æ˜¯ï¼šç»™å®šä¸€å¼ å›¾ç‰‡ï¼Œæ˜¯è½¦è¿˜æ˜¯é©¬æœªçŸ¥ï¼Œæ˜¯ä»€ä¹ˆè½¦ä¹ŸæœªçŸ¥ï¼Œç°åœ¨éœ€è¦æ¨¡å‹åˆ¤æ–­è¿™å¼ å›¾ç‰‡é‡Œå…·ä½“æ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œæ€»ä¹‹è¾“å‡ºä¸€ä¸ªç»“æœï¼šå¦‚æœæ˜¯è½¦ï¼Œé‚£æ˜¯ä»€ä¹ˆè½¦ã€‚</p>
<p>ä¸Šå›¾çš„ç½‘ç»œç»“æ„ä¸ºï¼š</p>
<ul>
<li>æœ€å·¦è¾¹æ˜¯æ•°æ®è¾“å…¥å±‚ï¼Œå¯¹æ•°æ®åšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚å»å‡å€¼ï¼ˆæŠŠè¾“å…¥æ•°æ®å„ä¸ªç»´åº¦éƒ½ä¸­å¿ƒåŒ–ä¸º0ï¼Œé¿å…æ•°æ®è¿‡å¤šåå·®ï¼Œå½±å“è®­ç»ƒæ•ˆæœï¼‰ã€å½’ä¸€åŒ–ï¼ˆæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½å½’ä¸€åˆ°åŒæ ·çš„èŒƒå›´ï¼‰ã€PCA/ç™½åŒ–ç­‰ç­‰ã€‚CNNåªå¯¹è®­ç»ƒé›†åšâ€œå»å‡å€¼â€è¿™ä¸€æ­¥ã€‚</li>
<li>ä¸­é—´æ˜¯<ul>
<li>CONVï¼šå·ç§¯è®¡ç®—å±‚ï¼Œçº¿æ€§ä¹˜ç§¯æ±‚å’Œã€‚</li>
<li>ReLUï¼šæ¿€åŠ±å±‚ï¼Œä¸Šæ–‡2.2èŠ‚ä¸­æœ‰æåˆ°ï¼šReLUæ˜¯æ¿€æ´»å‡½æ•°çš„ä¸€ç§ã€‚</li>
<li>POOLï¼šæ± åŒ–å±‚ï¼Œç®€è¨€ä¹‹ï¼Œå³å–åŒºåŸŸå¹³å‡æˆ–æœ€å¤§ã€‚</li>
</ul>
</li>
<li>æœ€å³è¾¹æ˜¯<ul>
<li>FCï¼šå…¨è¿æ¥å±‚</li>
</ul>
</li>
</ul>
<p>è¿™å‡ ä¸ªéƒ¨åˆ†ä¸­ï¼Œå·ç§¯è®¡ç®—å±‚æ˜¯CNNçš„æ ¸å¿ƒï¼Œä¸‹æ–‡å°†é‡ç‚¹é˜è¿°ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»ä¸€ä¸‹è¿™å‡ ä¸ªéƒ¨åˆ†ã€‚</p>
<h1 id="å·ç§¯ç½‘ç»œç»“æ„-1">2. å·ç§¯ç½‘ç»œç»“æ„</h1><p>å·ç§¯ç½‘ç»œç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">è¾“å…¥å±‚  --&gt;  å·ç§¯è®¡ç®—å±‚  --&gt; æ¿€åŠ±å±‚ --&gt; æ± åŒ–å±‚  </div><div class="line">       --&gt;  å·ç§¯è®¡ç®—å±‚  --&gt; æ¿€åŠ±å±‚ --&gt; æ± åŒ–å±‚  </div><div class="line">       --&gt; ...</div><div class="line">--&gt;å…¨è¿æ¥å±‚</div></pre></td></tr></table></figure>
<p>å·ç§¯ç½‘ç»œä¸­ä¸€ä¸ªå…¸å‹å±‚åŒ…æ‹¬ä¸‰çº§ï¼šå·ç§¯è®¡ç®—å±‚ã€æ¿€åŠ±å±‚ï¼ˆæ¢æµ‹å±‚ï¼‰å’Œæ± åŒ–å±‚ã€‚</p>
<p>é€šè¿‡ä¸Šä¸€æ­¥çš„å·ç§¯è¿ç®—ï¼Œç„¶åç»è¿‡äº†æ¿€æ´»å‡½æ•°ï¼Œæˆ‘ä»¬å°†æ­¤æ—¶çš„è¾“å…¥ä¼šè¾“å…¥æ± åŒ–å±‚ã€‚</p>
<p><img src="https://i.loli.net/2017/10/31/59f881a6783fa.png" alt=""> </p>
<p><strong>å·ç§¯å±‚</strong>ï¼šå¹¶è¡Œè®¡ç®—å¤šä¸ªå·ç§¯ï¼Œäº§ç”Ÿä¸€ç»„çº¿æ€§æ¿€æ´»å“åº”ï¼›</p>
<p><strong>æ¿€åŠ±å±‚(æ¢æµ‹å±‚)</strong>(detector stage)ï¼šæ¯ä¸ªçº¿æ€§æ¿€æ´»å“åº”ä¼šé€šè¿‡ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼›</p>
<p><strong>æ± åŒ–å±‚</strong>ï¼šæˆ‘ä»¬ä½¿ç”¨æ± åŒ–(pooling)å‡½æ•°æ¥è¿›ä¸€æ­¥è°ƒæ•´è¿™ä¸€å±‚çš„è¾“å‡ºã€‚</p>
<h2 id="å·ç§¯è®¡ç®—å±‚">2.1. å·ç§¯è®¡ç®—å±‚</h2><p>å·ç§¯è®¡ç®—å±‚æœ€é‡è¦çš„å°±æ˜¯å·ç§¯è¿ç®—ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»å·ç§¯è¿ç®—ã€‚</p>
<h3 id="å·ç§¯è¿ç®—">2.1.1. å·ç§¯è¿ç®—</h3><p>å‡è®¾æˆ‘ä»¬åœ¨ç”¨æ¿€å…‰ä¼ æ„Ÿå™¨è¿½è¸ªå®‡å®™é£èˆ¹çš„ä½ç½®ï¼Œ$t$æ—¶åˆ»ä½ç½®åœ¨$x(t)$ã€‚</p>
<p>ä¸ºäº†æ›´å¥½åœ°ä¼°è®¡ï¼Œæˆ‘ä»¬å°†æ—¶é—´è¶Šè¿‘çš„æµ‹é‡ç»™äºˆæ›´é«˜çš„æƒé‡$w(a)$ï¼Œå…¶ä¸­$a$è¡¨ç¤ºæµ‹é‡ç»“æœè·å½“å‰çš„æ—¶é—´é—´éš”ï¼Œé‚£ä¹ˆï¼š</p>
<p>$$s(t)=\int x(a)w(t-a)da = (x*w)(t)$$</p>
<p>tips:<br>$a$ï¼šè·ç¦»å½“å‰æ—¶é—´çš„é—´éš”ï¼›<br>$x(a)$ï¼š$a$æ—¶åˆ»ï¼Œé£èˆ¹ä½ç½®ï¼Œ$x$ä¹Ÿå«è¾“å…¥<br>$w(t-a)$ï¼š$t-a$æ—¶åˆ»ï¼Œä¹Ÿå°±æ˜¯aç§’å‰ï¼Œé£èˆ¹çš„æƒé‡ï¼Œä¹Ÿæ˜¯ä¸€ç§æ¦‚ç‡å¯†åº¦ï¼Œå«åšæ ¸å‡½æ•°</p>
<p>ç¦»æ•£å½¢å¼çš„å·ç§¯æ˜¯ï¼š<br>$$s(t)=(x*w)(t)=\sum_{\alpha=-\infty}^{\infty}x(a)w(t-a)$$</p>
<p>äºŒç»´å½¢å¼çš„å·ç§¯ï¼ˆæˆ‘ä»¬å®šä¹‰æ ¸ä¸ºKï¼‰ï¼š</p>
<p>$$S(i,j)=(I*K)(i,j)=\sum_m \sum_n I(m,n)K(i-m,j-n)$$</p>
<p>å·ç§¯æ˜¯å¯äº¤æ¢çš„ï¼Œä¹Ÿå¯å†™ä½œï¼š</p>
<p>$$S(i,j)=(K*I)(i,j)=\sum_m \sum_n I(i-m,j-n)K(m,n)$$</p>
<p>å‡ºç°ä¸Šé¢å¯äº¤æ¢çš„åŸå› æ˜¯ï¼šæˆ‘ä»¬å°†æ ¸çš„ç›¸å¯¹è¾“å…¥è¿›è¡Œäº†ç¿»è½¬ï¼Œä¹Ÿç›¸å½“äºä¸€ç§å˜é‡æ›¿æ¢ï¼›</p>
<p>ç„¶è€Œï¼Œåœ¨è®¸å¤šç¥ç»ç½‘ç»œä¸­é‡‡ç”¨çš„æ˜¯<strong>äº’ç›¸å…³å‡½æ•°(cross-correlation)</strong>ï¼š</p>
<p>$$S(i,j)=(I*K)(i,j)=\sum_m \sum_n I(i+m,j+n)K(m,n)$$</p>
<p>è¿™ä¸ªæ˜¯ä¸å¯äº¤æ¢çš„ã€‚</p>
<p>åœ¨æ•°å­¦å®šä¹‰ä¸Šï¼ŒçŸ©é˜µçš„<strong>å·ç§¯</strong>ï¼ˆconvolutionï¼‰æ“ä½œä¸ºé¦–å…ˆå°†å·ç§¯æ ¸åŒæ—¶åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šè¿›è¡Œç¿»è½¬ï¼Œæ„æˆä¸€ä¸ªå·ç§¯æ ¸çš„é•œåƒï¼Œç„¶åä½¿ç”¨è¯¥é•œåƒå†å’Œå‰é¢çš„çŸ©é˜µè¿›è¡Œç§»åŠ¨ç›¸ä¹˜æ±‚å’Œæ“ä½œã€‚å¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-07-46.png" alt=""> </p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç§°ä¸ºçš„å·ç§¯è¿ç®—å®åˆ™æ²¡æœ‰å·ç§¯æ ¸å˜æ¢ä¸ºé•œåƒçš„è¿™ä¸€æ­¥æ“ä½œï¼Œå› ä¸ºåœ¨æƒé‡å­¦ä¹ çš„è§’åº¦ï¼Œå˜æ¢æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚æ·±åº¦å­¦ä¹ çš„å·ç§¯æ“ä½œåœ¨æ•°å­¦ä¸Šå‡†ç¡®åº¦æ¥è¯´ç§°ä¸º<strong>äº’ç›¸å…³</strong>ï¼ˆcross-correlationï¼‰ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå›¾åƒé¢†åŸŸçš„å·ç§¯ç”¨çš„å°±æ˜¯äº’ç›¸å…³å‡½æ•°ã€‚å‚è€ƒæ–‡çŒ®<a href="http://blog.csdn.net/v_july_v/article/details/51812459" target="_blank" rel="external">CNNç¬”è®°ï¼šé€šä¿—ç†è§£å·ç§¯ç¥ç»ç½‘ç»œ</a>å¯¹å·ç§¯çš„å®šä¹‰æ˜¯ï¼šå¯¹å›¾åƒï¼ˆä¸åŒçš„æ•°æ®çª—å£æ•°æ®ï¼‰å’Œæ»¤æ³¢çŸ©é˜µï¼ˆä¸€ç»„å›ºå®šçš„æƒé‡ï¼šå› ä¸ºæ¯ä¸ªç¥ç»å…ƒçš„å¤šä¸ªæƒé‡å›ºå®šï¼Œæ‰€ä»¥åˆå¯ä»¥çœ‹åšä¸€ä¸ªæ’å®šçš„æ»¤æ³¢å™¨filterï¼‰åšå†…ç§¯ï¼ˆé€ä¸ªå…ƒç´ ç›¸ä¹˜å†æ±‚å’Œï¼‰çš„æ“ä½œå°±æ˜¯æ‰€è°“çš„ã€å·ç§¯ã€æ“ä½œï¼Œä¹Ÿæ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„åå­—æ¥æºã€‚</p>
<hr>
<h3 id="å·ç§¯è®¡ç®—å±‚-1">2.1.2. å·ç§¯è®¡ç®—å±‚</h3><p>ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ã€‚æ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œå›¾ä¸­å·¦è¾¹éƒ¨åˆ†æ˜¯åŸå§‹è¾“å…¥æ•°æ®ï¼Œå›¾ä¸­ä¸­é—´éƒ¨åˆ†æ˜¯æ»¤æ³¢å™¨filter(æœ‰ä¸ªé«˜å¤§ä¸Šçš„åå­—å«<strong>å·ç§¯æ ¸</strong>)ï¼Œå›¾ä¸­å³è¾¹æ˜¯è¾“å‡ºçš„æ–°çš„äºŒç»´æ•°æ®ã€‚</p>
<p><img src="https://i.loli.net/2017/11/02/59fa7db46ec71.png" alt=""> </p>
<p>å³å°†ä¸‹é¢ ä¸¤ä¸ªçŸ©é˜µå¯¹åº”ä½ç½®å…ˆç›¸ä¹˜ï¼Œåç›¸åŠ ï¼š</p>
<p><img src="https://i.loli.net/2017/11/02/59fa7dcd89f03.png" alt=""> $$*$$<img src="https://i.loli.net/2017/11/02/59fa7de2c136e.png" alt=""> $$=$$<img src="https://i.loli.net/2017/11/02/59fa7df2b7759.png" alt=""> </p>
<p><img src="https://i.loli.net/2017/11/02/59fa82a30ef95.png" alt=""> </p>
<p>åœ¨CNNä¸­ï¼Œæ»¤æ³¢å™¨filterï¼ˆå¸¦ç€ä¸€ç»„å›ºå®šæƒé‡çš„ç¥ç»å…ƒï¼‰å¯¹å±€éƒ¨è¾“å…¥æ•°æ®è¿›è¡Œå·ç§¯è®¡ç®—ã€‚æ¯è®¡ç®—å®Œä¸€ä¸ªæ•°æ®çª—å£å†…çš„å±€éƒ¨æ•°æ®åï¼Œæ•°æ®çª—å£ä¸æ–­å¹³ç§»æ»‘åŠ¨ï¼Œç›´åˆ°è®¡ç®—å®Œæ‰€æœ‰æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªå‚æ•°ï¼š </p>
<h4 id="Depth-æ·±åº¦">2.1.2.1. Depth-æ·±åº¦</h4><p>ç¥ç»å…ƒä¸ªæ•°ï¼Œå†³å®šè¾“å‡ºçš„depthåšåº¦ã€‚åŒæ—¶ä»£è¡¨æ»¤æ³¢å™¨ä¸ªæ•°ã€‚</p>
<h4 id="Stride-æ­¥é•¿">2.1.2.2. Stride-æ­¥é•¿</h4><p>å†³å®šæ»‘åŠ¨å¤šå°‘æ­¥å¯ä»¥åˆ°è¾¹ç¼˜ã€‚</p>
<p>ä»¥sè¡¨ç¤ºstrideçš„å¤§å°ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œå·ç§¯è¿ç®—åï¼Œå›¾ç‰‡çš„å˜åŒ–ä¸ºï¼š$nÃ—n â€“&gt; âŒŠ\frac{n+2pâˆ’f}{s}+1âŒ‹Ã—âŒŠ\frac{n+2pâˆ’f}{s}+1âŒ‹$ã€‚</p>
<p>æ³¨æ„ï¼Œåœ¨å½“paddingâ‰ 1æ—¶ï¼Œè‹¥ç§»åŠ¨çš„çª—å£è½åœ¨å›¾ç‰‡å¤–é¢æ—¶ï¼Œåˆ™ä¸è¦å†è¿›è¡Œç›¸ä¹˜çš„æ“ä½œï¼Œä¸¢å¼ƒè¾¹ç¼˜çš„æ•°å€¼ä¿¡æ¯ï¼Œæ‰€ä»¥è¾“å‡ºå›¾ç‰‡çš„æœ€ç»ˆç»´åº¦ä¸º<strong>å‘ä¸‹å–æ•´</strong>ã€‚</p>
<h4 id="Padding-å¡«å……å€¼">2.1.2.3. Padding-å¡«å……å€¼</h4><p>åœ¨å¤–å›´è¾¹ç¼˜è¡¥å……è‹¥å¹²åœˆ0ï¼Œæ–¹ä¾¿ä»åˆå§‹ä½ç½®ä»¥æ­¥é•¿ä¸ºå•ä½å¯ä»¥åˆšå¥½æ»‘åˆ°æœ«å°¾ä½ç½®ï¼Œé€šä¿—åœ°è®²å°±æ˜¯ä¸ºäº†æ€»é•¿èƒ½è¢«æ­¥é•¿æ•´é™¤ã€‚</p>
<p>æ²¡æœ‰Paddingçš„ç¼ºç‚¹ ï¼š </p>
<ol>
<li>æ¯æ¬¡å·ç§¯æ“ä½œï¼Œå›¾ç‰‡ä¼šç¼©å°ï¼› å°±å‰é¢çš„ä¾‹å­æ¥è¯´ï¼Œ6Ã—6 å¤§å°çš„å›¾ç‰‡ï¼Œç»è¿‡ 3Ã—3 å¤§å°çš„ filterï¼Œç¼©å°æˆäº† 4Ã—4 å¤§å° ã€‚å›¾ç‰‡ï¼šnÃ—n â€“&gt; (nâˆ’f+1)Ã—(nâˆ’f+1)</li>
<li>è§’è½å’Œè¾¹ç¼˜ä½ç½®çš„åƒç´ è¿›è¡Œå·ç§¯è¿ç®—çš„æ¬¡æ•°å°‘ï¼Œå¯èƒ½ä¼šä¸¢å¤±æœ‰ç”¨ä¿¡æ¯ã€‚<br>å…¶ä¸­ï¼Œnè¡¨ç¤ºå›¾ç‰‡çš„é•¿æˆ–å®½çš„å¤§å°ï¼Œfè¡¨ç¤ºfilterçš„é•¿æˆ–å®½çš„å¤§å°ã€‚</li>
</ol>
<p>æœ‰Padding ï¼š </p>
<ol>
<li>ä¸ºäº†è§£å†³ä¸Šé¢çš„ä¸¤ä¸ªç¼ºç‚¹ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå·ç§¯è¿ç®—å‰ä¸ºå›¾ç‰‡åŠ paddingï¼ŒåŒ…å›´è§’è½å’Œè¾¹ç¼˜çš„åƒç´ ï¼Œä½¿å¾—é€šè¿‡filterçš„å·ç§¯è¿ç®—åï¼Œå›¾ç‰‡å¤§å°ä¸å˜ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±è§’è½å’Œè¾¹æ²¿çš„ä¿¡æ¯ã€‚</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-11-15.png" alt=""> </p>
<p>ä»¥pè¡¨ç¤º Padding çš„å€¼ï¼Œåˆ™è¾“å…¥nÃ—nå¤§å°çš„å›¾ç‰‡ï¼Œæœ€ç»ˆå¾—åˆ°çš„å›¾ç‰‡å¤§å°ä¸º (n+2pâˆ’f+1)Ã—(n+2pâˆ’f+1)ï¼Œä¸ºä½¿å›¾ç‰‡å¤§å°ä¿æŒä¸å˜ï¼Œéœ€æ ¹æ®filterçš„å¤§å°è°ƒæ•´pçš„å€¼ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2017/11/02/59fa7f3498ba3.png" alt=""> </p>
<h3 id="å·ç§¯è®¡ç®—çš„è¿‡ç¨‹">2.1.3. å·ç§¯è®¡ç®—çš„è¿‡ç¨‹</h3><p>å¯¹äºç°è‰²å›¾åƒä¸­ï¼Œå·ç§¯æ ¸å’Œå›¾åƒå‡æ˜¯äºŒç»´çš„ã€‚è€Œåº”ç”¨äºå½©è‰²å›¾åƒä¸­ï¼Œå› ä¸ºå›¾ç‰‡æœ‰Rã€Gã€Bä¸‰ä¸ªé¢œè‰²é€šé“ï¼Œæ‰€ä»¥æ­¤æ—¶çš„å·ç§¯æ ¸åº”ä¸º<strong>ä¸‰ç»´å·ç§¯æ ¸</strong>ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-19-44.png" alt=""> </p>
<p>å•ä¸ªå·ç§¯æ ¸åº”ç”¨äºå›¾ç‰‡æ—¶ï¼Œæå–å›¾ç‰‡ç‰¹å®šçš„ç‰¹å¾ï¼Œä¸åŒçš„å·ç§¯æ ¸æå–ä¸åŒçš„ç‰¹å¾ã€‚å¦‚ä¸¤ä¸ªå¤§å°å‡ä¸º3Ã—3Ã—3 çš„å·ç§¯æ ¸åˆ†åˆ«æå–å›¾ç‰‡çš„å‚ç›´è¾¹ç¼˜å’Œæ°´å¹³è¾¹ç¼˜ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-20-50.png" alt=""> </p>
<p>ç”±å›¾å¯çŸ¥ï¼Œæœ€ç»ˆæå–åˆ°å½©è‰²å›¾ç‰‡çš„å‚ç›´ç‰¹å¾å›¾å’Œæ°´å¹³ç‰¹å¾å›¾ï¼Œå¾—åˆ°æœ‰2ä¸ªé€šé“çš„4Ã—4å¤§å°çš„ç‰¹å¾å›¾ç‰‡ã€‚</p>
<p>è¿™å¼ gifè¯ é‡Šäº†ä¸‰ç»´ã€ä¸¤ä¸ªå·ç§¯æ ¸çš„å·ç§¯è¿‡ç¨‹ï¼š</p>
<p>è¾“å…¥å›¾åƒï¼šä¸‰ç»´</p>
<p>å·ç§¯æ ¸W0å’ŒW1ï¼šåˆ†åˆ«éƒ½æ˜¯ä¸‰ç»´</p>
<p><img src="http://img.blog.csdn.net/20160707204048899" alt=""></p>
<p>  å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>ä¸¤ä¸ªç¥ç»å…ƒï¼Œå³depth=2ï¼Œæ„å‘³ç€æœ‰ä¸¤ä¸ªæ»¤æ³¢å™¨ã€‚</li>
<li>æ•°æ®çª—å£æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªæ­¥é•¿å–3*3çš„å±€éƒ¨æ•°æ®ï¼Œå³stride=2ã€‚</li>
<li>zero-padding=1ã€‚</li>
</ul>
<p>ç„¶ååˆ†åˆ«ä»¥ä¸¤ä¸ªæ»¤æ³¢å™¨filterä¸ºè½´æ»‘åŠ¨æ•°ç»„è¿›è¡Œå·ç§¯è®¡ç®—ï¼Œå¾—åˆ°ä¸¤ç»„ä¸åŒçš„ç»“æœã€‚</p>
<p>â€‹    å¦‚æœåˆçœ‹ä¸Šå›¾ï¼Œå¯èƒ½ä¸ä¸€å®šèƒ½ç«‹é©¬ç†è§£å•¥æ„æ€ï¼Œä½†ç»“åˆä¸Šæ–‡çš„å†…å®¹åï¼Œç†è§£è¿™ä¸ªåŠ¨å›¾å·²ç»ä¸æ˜¯å¾ˆå›°éš¾çš„äº‹æƒ…ï¼š</p>
<ul>
<li>è“è‰²è¾“å…¥ï¼ˆ<strong>7*7*3</strong>ä¸­ï¼Œ7*7ä»£è¡¨å›¾åƒçš„åƒç´ /é•¿å®½ï¼Œ3ä»£è¡¨Rã€Gã€B ä¸‰ä¸ªé¢œè‰²é€šé“ï¼‰</li>
<li>çº¢è‰²æ˜¯ä¸¤ä¸ªä¸åŒçš„æ»¤æ³¢å™¨Filter w0ã€Filter w1</li>
<li>ç»¿è‰²åˆ™æ˜¯ä¸¤ä¸ªä¸åŒçš„è¾“å‡ºï¼Œæ¯ä¸€ä¸ªæ ¼å­éƒ½ç­‰äºä¸€æ¬¡æ»¤æ³¢çª—å£å†…çš„å†…ç§¯å’Œï¼ˆRGBä¸‰é€šé“ç›¸åŠ ï¼‰</li>
</ul>
<p>â€‹    éšç€å·¦è¾¹æ•°æ®çª—å£çš„å¹³ç§»æ»‘åŠ¨ï¼Œæ»¤æ³¢å™¨Filter w0 / Filter w1å¯¹ä¸åŒçš„å±€éƒ¨æ•°æ®è¿›è¡Œå·ç§¯è®¡ç®—ã€‚å¦‚æœè¿™ä¸€éƒ¨åˆ†çœ‹ä¸æ˜ç™½ï¼Œå¯ä»¥ç»§ç»­çœ‹<a href="http://blog.csdn.net/v_july_v/article/details/51812459" target="_blank" rel="external">CNNç¬”è®°ï¼šé€šä¿—ç†è§£å·ç§¯ç¥ç»ç½‘ç»œ</a>ï¼Œè¿™é‡Œè®²çš„éå¸¸è¯¦ç»†ã€‚</p>
<h4 id="å•å±‚å·ç§¯ç½‘ç»œ">2.1.3.1. å•å±‚å·ç§¯ç½‘ç»œ</h4><p>å’Œæ™®é€šçš„ç¥ç»ç½‘ç»œå•å±‚å‰å‘ä¼ æ’­çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œå·ç§¯ç¥ç»ç½‘ç»œä¹Ÿæ˜¯ä¸€ä¸ªå…ˆç”±è¾“å…¥å’Œæƒé‡åŠåç½®åšçº¿æ€§è¿ç®—ï¼Œç„¶åå¾—åˆ°çš„ç»“æœè¾“å…¥ä¸€ä¸ªæ¿€æ´»å‡½æ•°ä¸­ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºï¼š</p>
<p>$$z^{[1]}=w^{[1]}a^{[0]}+b^{[1]}$$</p>
<p>$$a^{[1]}=g(z^{[1]})$$</p>
<p>ä¸åŒç‚¹æ˜¯åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæƒé‡å’Œè¾“å…¥è¿›è¡Œçš„æ˜¯å·ç§¯è¿ç®—ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-28-06.png" alt=""> </p>
<p><strong>å•å±‚å·ç§¯çš„å‚æ•°ä¸ªæ•°ï¼š</strong></p>
<p>åœ¨ä¸€ä¸ªå·ç§¯å±‚ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰10ä¸ª 3Ã—3Ã—3 å¤§å°çš„å·ç§¯æ ¸ï¼Œé‚£ä¹ˆåŠ ä¸Šæ¯ä¸ªå·ç§¯æ ¸å¯¹åº”çš„åç½®ï¼Œåˆ™å¯¹äºä¸€ä¸ªå·ç§¯å±‚ï¼Œæˆ‘ä»¬å…±æœ‰çš„å‚æ•°ä¸ªæ•°ä¸ºï¼š</p>
<p>$$(3Ã—3Ã—3+1)Ã—10=280$$</p>
<p>æ— è®ºå›¾ç‰‡å¤§å°æ˜¯å¤šå°‘ï¼Œè¯¥ä¾‹å­ä¸­çš„å·ç§¯å±‚å‚æ•°ä¸ªæ•°ä¸€ç›´éƒ½æ˜¯280ä¸ªï¼Œç›¸å¯¹äºæ™®é€šçš„ç¥ç»ç½‘ç»œï¼Œå·ç§¯ç¥ç»ç½‘ç»œçš„å‚æ•°ä¸ªæ•°è¦å°‘å¾ˆå¤šã€‚</p>
<h4 id="å¤šå±‚å·ç§¯ç½‘ç»œ">2.1.3.2. å¤šå±‚å·ç§¯ç½‘ç»œ</h4><p>å¤šå±‚å·ç§¯æ„æˆå·ç§¯ç¥ç»ç½‘ç»œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œçš„ä¾‹å­ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-30-34.png" alt=""></p>
<h2 id="æ¿€åŠ±å±‚">2.2. æ¿€åŠ±å±‚</h2><p>å‡ ç§ä¸åŒçš„æ¿€æ´»å‡½æ•°$g(x)$ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-14-16-43.png" alt=""> </p>
<ul>
<li><p>sigmoidï¼š</p>
<p>$$a = \frac{1}{1+e^{-z}}$$</p>
<p>å¯¼æ•°ï¼š$aâ€²=a(1âˆ’a)$</p>
</li>
<li><p>tanhï¼š</p>
<p>$$a = \frac{e^z - e^{-z}}{e^z + e{-z}}$$</p>
<p>å¯¼æ•°ï¼š$aâ€²=1âˆ’a2$</p>
</li>
<li><p>ReLUï¼ˆä¿®æ­£çº¿æ€§å•å…ƒï¼‰ï¼š<br>$$a=max(0,z)$$</p>
</li>
<li><p>Leaky ReLUï¼š<br>$$a=max(0.01z,z)$$</p>
</li>
</ul>
<p><strong>æ¿€æ´»å‡½æ•°çš„é€‰æ‹©</strong></p>
<p>sigmoidå‡½æ•°å’Œtanhå‡½æ•°æ¯”è¾ƒï¼š</p>
<ul>
<li>éšè—å±‚ï¼štanhå‡½æ•°çš„è¡¨ç°è¦å¥½äºsigmoidå‡½æ•°ï¼Œå› ä¸ºtanhå–å€¼èŒƒå›´ä¸º[âˆ’1,+1]ï¼Œè¾“å‡ºåˆ†å¸ƒåœ¨0å€¼çš„é™„è¿‘ï¼Œå‡å€¼ä¸º0ï¼Œä»éšè—å±‚åˆ°è¾“å‡ºå±‚æ•°æ®èµ·åˆ°äº†å½’ä¸€åŒ–ï¼ˆå‡å€¼ä¸º0ï¼‰çš„æ•ˆæœã€‚</li>
<li>è¾“å‡ºå±‚ï¼šå¯¹äºäºŒåˆ†ç±»ä»»åŠ¡çš„è¾“å‡ºå–å€¼ä¸º{0,1}ï¼Œæ•…ä¸€èˆ¬ä¼šé€‰æ‹©sigmoidå‡½æ•°ã€‚</li>
</ul>
<p>ç„¶è€Œsigmoidå’Œtanhå‡½æ•°åœ¨å½“|z|å¾ˆå¤§çš„æ—¶å€™ï¼Œæ¢¯åº¦ä¼šå¾ˆå°ï¼Œåœ¨ä¾æ®æ¢¯åº¦çš„ç®—æ³•ä¸­ï¼Œæ›´æ–°åœ¨åæœŸä¼šå˜å¾—å¾ˆæ…¢ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¦ä½¿|z|å°½å¯èƒ½çš„è½åœ¨0å€¼é™„è¿‘ã€‚</p>
<p>ReLUå¼¥è¡¥äº†å‰ä¸¤è€…çš„ç¼ºé™·ï¼Œå½“z&gt;0æ—¶ï¼Œæ¢¯åº¦å§‹ç»ˆä¸º1ï¼Œä»è€Œæé«˜ç¥ç»ç½‘ç»œåŸºäºæ¢¯åº¦ç®—æ³•çš„è¿ç®—é€Ÿåº¦ã€‚ç„¶è€Œå½“z&lt;0æ—¶ï¼Œæ¢¯åº¦ä¸€ç›´ä¸º0ï¼Œä½†æ˜¯å®é™…çš„è¿ç”¨ä¸­ï¼Œè¯¥ç¼ºé™·çš„å½±å“ä¸æ˜¯å¾ˆå¤§ã€‚</p>
<p>Leaky ReLUä¿è¯åœ¨z&lt;0çš„æ—¶å€™ï¼Œæ¢¯åº¦ä»ç„¶ä¸ä¸º0ã€‚</p>
<p>åœ¨é€‰æ‹©æ¿€æ´»å‡½æ•°çš„æ—¶å€™ï¼Œå¦‚æœåœ¨ä¸çŸ¥é“è¯¥é€‰ä»€ä¹ˆçš„æ—¶å€™å°±é€‰æ‹©ReLUï¼Œå½“ç„¶ä¹Ÿæ²¡æœ‰å›ºå®šç­”æ¡ˆï¼Œè¦ä¾æ®å®é™…é—®é¢˜åœ¨äº¤å‰éªŒè¯é›†åˆä¸­è¿›è¡ŒéªŒè¯åˆ†æã€‚</p>
<h2 id="æ± åŒ–å±‚">2.3. æ± åŒ–å±‚</h2><p><strong>æ± åŒ–å‡½æ•°</strong></p>
<p>ä½¿ç”¨æŸä¸€ä½ç½®çš„ç›¸é‚»è¾“å‡ºçš„æ€»ä½“ç»Ÿè®¡ç‰¹å¾æ¥ä»£æ›¿ç½‘ç»œå†è¯¥ä½ç½®çš„è¾“å‡ºã€‚</p>
<p>æœ€å¤§æ± åŒ–å‡½æ•°ï¼šç»™å‡ºç›¸é‚»çŸ©å½¢åŒºåŸŸå†…çš„æœ€å¤§å€¼ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-33-58.png" alt=""> </p>
<p>åœ¨æœ€å¤§æ± åŒ–ä¸­ï¼Œæœ‰ä¸€ç»„è¶…å‚æ•°éœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œå…¶ä¸­ï¼Œ$f $è¡¨ç¤ºæ± åŒ–çš„å¤§å°ï¼Œ$s$è¡¨ç¤ºæ­¥é•¿ã€‚</p>
<ul>
<li>æ± åŒ–å‰ï¼š$nÃ—n$</li>
<li>æ± åŒ–åï¼š$âŒŠ\frac{n+2pâˆ’f}{s}+1âŒ‹Ã—âŒŠ\frac{n+2pâˆ’f}{s}+1âŒ‹$</li>
</ul>
<p>æ­¤å¤–è¿˜æœ‰å¹³å‡æ± åŒ–ã€æœ€å°æ± åŒ–ç­‰ç­‰ã€‚æ³¨æ„ï¼Œæ± åŒ–å±‚æ²¡æœ‰éœ€è¦å­¦ä¹ çš„å‚æ•°ã€‚</p>
<p><strong>æ± åŒ–çš„ç”¨é€”</strong></p>
<p>æ± åŒ–å‡½æ•°å¸®åŠ©è¾“å…¥è¿‘ä¼¼ä¸å˜ï¼šå³å½“æˆ‘ä»¬å¯¹è¾“å…¥è¿›è¡Œå°‘é‡å¹³ç§»æ—¶ï¼Œç»è¿‡æ± åŒ–å‡½æ•°åçš„å¤§å¤šæ•°è¾“å‡ºå¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚é€šä¿—åœ°è¯´å°±æ˜¯â€”â€”ä¸ºäº†è®©æˆ‘ä»¬çš„ç½‘ç»œå…·æœ‰å¹³ç§»ä¸å˜å½¢ï¼ˆæˆ‘çš„ç†è§£æ˜¯æ— è®ºè¾“å…¥è½»å¾®æ—‹è½¬æˆ–å¹³ç§»ï¼Œè¾“å‡ºéƒ½ä¸å˜ï¼‰ï¼Œæˆ‘ä»¬å¼•å…¥æ± åŒ–è¿™ä¸ªéªšæ“ä½œæ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚</p>
<p>ä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¾‹å­ã€‚ä¸Šå›¾æ˜¯ä¸€ä¸ªç½‘ç»œï¼Œä¸‹å›¾æ˜¯ä¸€ä¸ªç½‘ç»œï¼Œæ¯ä¸ªç½‘ç»œçš„ä¸‹å±‚æ˜¯éçº¿æ€§è¾“å‡ºï¼Œä¸Šå±‚æ˜¯æœ€å¤§æ± åŒ–è¾“å‡ºã€‚ä¸‹å›¾çš„éçº¿æ€§è¾“å‡ºæ˜¯é€šè¿‡å‘å³å¹³ç§»ä¸€ä¸ªåƒç´ å¾—åˆ°çš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ± åŒ–å±‚çš„è¾“å‡ºåªæœ‰ä¸€åŠå‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™æ˜¯å› ä¸ºæœ€å¤§æ± åŒ–å•å…ƒåªå¯¹å‘¨å›´çš„æœ€å¤§å€¼è¾ƒæ•æ„Ÿï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä½ç½®ã€‚</p>
<p><img src="https://i.loli.net/2017/11/01/59f939076125c.png" alt=""> </p>
<p>å½“æˆ‘ä»¬åªå…³å¿ƒæŸä¸ªç‰¹å¾æ˜¯å¦å‡ºç°ï¼ˆæ¯”å¦‚æ˜¯å¦æœ‰çœ¼ç›ï¼‰ï¼Œè€Œä¸å…³å¿ƒå®ƒçš„å…·ä½“ä½ç½®æ—¶ï¼Œå±€éƒ¨å¹³ç§»ä¸å˜æ€§æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ€§è´¨ã€‚</p>
<p>å¯¹ç©ºé—´åŒºåŸŸè¿›è¡Œæ± åŒ–äº§ç”Ÿäº†å¹³ç§»ä¸å˜æ€§ã€‚ä¸‹å›¾æ˜¯ä¸€ç§å­¦ä¹ ä¸å˜æ€§çš„å®ä¾‹ï¼šåæ˜ çš„æ˜¯æ± åŒ–çš„æ—‹è½¬ä¸å˜æ€§ï¼Œå¯¹äºè¾“å…¥æ‰‹å†™5ï¼Œæœ‰ä¸‰ä¸ªæ»¤æ³¢å™¨åˆ†åˆ«æ£€æµ‹é€‰æ‹©ä¸åŒè§’åº¦çš„æ‰‹å†™5ã€‚å½“æ»¤æ³¢å™¨å’Œå¯¹åº”çš„æ‰‹å†™5åŒ¹é…æ—¶ï¼Œæ»¤æ³¢å™¨ä¼šå¾—åˆ°ä¸€ä¸ªè¾ƒå¤§çš„æ¿€æ´»å€¼ï¼Œç„¶åæ± åŒ–ä¼šé€‰æ‹©å¾—åˆ°æœ€å¤§çš„æ¿€æ´»å€¼ï¼Œæ— è®ºæ‰‹å†™5æ˜¯æ€æ ·çš„æ—‹è½¬çš„ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2017/11/01/59f95b688c95b.png" alt=""> </p>
<p>æ€»çš„æ¥è¯´å°±æ˜¯ï¼šé€šè¿‡å·ç§¯åï¼Œä¸ºäº†å¼•å…¥ä¸å˜æ€§ï¼ŒåŒæ—¶é˜²æ­¢è¿‡æ‹Ÿåˆé—®é¢˜æˆ–æ¬ æ‹Ÿåˆé—®é¢˜ã€é™ä½è®¡ç®—é‡ï¼Œæˆ‘ä»¬å¸¸è¿›è¡Œæ± åŒ–å¤„ç†ã€‚</p>
<h1 id="å·ç§¯ç½‘ç»œçš„ä¼˜åŠ¿">3. å·ç§¯ç½‘ç»œçš„ä¼˜åŠ¿</h1><p>æˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹å·ç§¯ç½‘ç»œçš„æ¦‚å¿µï¼šå·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networksï¼‰çš„å·ç§¯æ“ä½œæ˜¯é€šè¿‡å¯è®­ç»ƒçš„æ»¤æ³¢å™¨å¯¹ä¸Šä¸€å±‚çš„è¾“å‡ºè¿›è¡Œå·ç§¯æ±‚å’Œï¼Œç„¶åæ·»åŠ ä¸Šåç§»é‡ç»è¿‡æ¿€æ´»å‡½æ•°ï¼Œå¾—åˆ°äº†ç‰¹å¾æ˜ å°„å›¾ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚å·ç§¯æ“ä½œç›¸å¯¹äºä¼ ç»Ÿç¥ç»ç½‘ç»œä¸»è¦æœ‰ç¨€ç–é“¾æ¥ã€æƒå€¼å…±äº«å’Œç­‰å˜è¡¨è¾¾çš„ç‰¹æ€§ã€‚</p>
<p>å·ç§¯é€šè¿‡ä¸‰ä¸ªé‡è¦æ€æƒ³æ¥å¸®åŠ©æ”¹è¿›æœºå™¨å­¦ä¹ ç³»ç»Ÿï¼šç¨€ç–äº¤äº’ã€å‚æ•°å…±äº«ã€ç­‰å˜è¡¨ç¤ºã€‚</p>
<p>ä¸æ™®é€šçš„å…¨è¿æ¥ç¥ç»ç½‘ç»œç›¸æ¯”ï¼Œå·ç§¯ç¥ç»ç½‘ç»œçš„å‚æ•°æ›´å°‘ã€‚å¦‚å›¾ä¸­çš„ä¾‹å­ï¼Œå·ç§¯ç¥ç»ç½‘ç»œä»…æœ‰6Ã—(5Ã—5+1)=156ä¸ªå‚æ•°ï¼Œè€Œæ™®é€šçš„å…¨è¿æ¥ç½‘ç»œæœ‰3072Ã—4704â‰ˆ14Mä¸ªå‚æ•°ã€‚</p>
<p><strong>ç¨€ç–äº¤äº’</strong></p>
<p>å¯¹äºä¸€å¼ å›¾åƒæ¥è¯´ï¼Œè¾“å…¥å›¾åƒå¯èƒ½åŒ…å«ä¸Šåƒä¸‡åƒç´ ç‚¹ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡åªå ç”¨å‡ åæˆ–å‡ ç™¾çš„æ ¸æ¥æ£€æµ‹ä¸€äº›å°çš„ä½†æœ‰æ„ä¹‰çš„ç‰¹å¾ï¼Œä¾‹å¦‚å›¾åƒè¾¹ç¼˜ã€‚å³â€”â€”åœ¨æ¯ä¸€å±‚ä¸­ï¼Œæ¯ä¸ªè¾“å‡ºå€¼åªå–å†³äºå°‘é‡çš„è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯ç¨€ç–äº¤äº’ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-15-51-25.png" alt=""> </p>
<p>ä¸‹å›¾æ˜¯ä¸€ç§ç¨€ç–è¿æ¥çš„ä¾‹å­ï¼Œä»ä¸‹å¾€ä¸Šçœ‹ï¼Œæˆ‘ä»¬å¼ºè°ƒäº†ä¸€ä¸ªè¾“å…¥å•å…ƒ$x_3$ä»¥åŠ$s$ä¸­å—è¯¥å•å…ƒå½±å“çš„è¾“å‡ºå•å…ƒã€‚è¿™ä¸ªæ˜¯å½“$s$ç”±æ ¸å®½åº¦ä¸º3çš„å·ç§¯äº§ç”Ÿçš„ï¼Œåªæœ‰3ä¸ªè¾“å‡ºå—åˆ°äº†$x$çš„å½±å“ï¼š</p>
<p><img src="https://i.loli.net/2017/10/31/59f865cb07946.png" alt=""> </p>
<p>ä»å¦ä¸€ä¸ªè§’åº¦ï¼Œä»ä¸Šå¾€ä¸‹çœ‹ï¼Œè¿™æ¬¡æˆ‘ä»¬æŠ¢åˆ°äº†ä¸€ä¸ªè¾“å‡ºå•å…ƒ$s_3$ä»¥åŠ$x$ä¸­å½±å“è¯¥å•å…ƒçš„è¾“å…¥å•å…ƒã€‚è¿™äº›å•å…ƒè¢«ç§°ä¸º$s_3$çš„<strong>æ¥å—åŸŸ</strong>ã€‚</p>
<p><img src="https://i.loli.net/2017/10/31/59f86ae962147.png" alt=""> </p>
<p>ä»æ·±å±‚çš„ç½‘ç»œæ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å°½ç®¡è¿æ¥ç¨€ç–ï¼Œä½†å¤„åœ¨æ›´æ·±å±‚çš„å•å…ƒå¯ä»¥é—´æ¥åœ°è¿æ¥åˆ°å…¨éƒ¨æˆ–å¤§éƒ¨åˆ†è¾“å…¥å›¾åƒä¸­ã€‚</p>
<p><img src="https://i.loli.net/2017/10/31/59f86aff4a4b1.png" alt="">  </p>
<p><strong>å‚æ•°å…±äº«</strong></p>
<p>ä¸€ä¸ªç‰¹å¾æ£€æµ‹å™¨ï¼ˆfilterï¼‰å¯¹å›¾ç‰‡çš„ä¸€éƒ¨åˆ†æœ‰ç”¨çš„åŒæ—¶ä¹Ÿæœ‰å¯èƒ½å¯¹å›¾ç‰‡çš„å¦å¤–ä¸€éƒ¨åˆ†æœ‰ç”¨ã€‚</p>
<p>å› ä¸ºæ ¸çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä½œç”¨åœ¨è¾“å…¥çš„æ¯ä¸€ä¸ªä½ç½®ä¸Šï¼Œå› æ­¤å·ç§¯è¿ç®—ä¼šå¯¼è‡´ç”¨äºä¸€ä¸ªè¾“å…¥çš„æƒé‡ä¹Ÿä¼šè¢«ç»‘å®šåœ¨å…¶å®ƒæƒé‡ä¸Šã€‚è¿™æ ·çš„å‚æ•°å…±äº«ä¿è¯äº†æˆ‘ä»¬åªéœ€è¦å­¦ä¹ ä¸€ä¸ªå‚æ•°é›†åˆï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸€ä¸ªä½ç½®éƒ½éœ€è¦å­¦ä¹ ä¸€ä¸ªå•ç‹¬çš„å‚æ•°é›†åˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé»‘è‰²ç®­å¤´è¡¨ç¤ºä¸¤ä¸ªä¸åŒæ¨¡å‹ä¸­ä½¿ç”¨äº†ç‰¹æ®Šçš„å‚æ•°è¿æ¥ã€‚ç°è‰²ç®­å¤´è¡¨ç¤ºå®ƒç”¨äº†é»‘è‰²ç®­å¤´çš„å‚æ•°ã€‚å…¶å®å°±æ˜¯ä¸€ä¸ª$x$åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä½†è¿™ä¸ªå‚æ•°è¢«ç”¨äºäº†å¤šä¸ªä¸‹ä¸€å±‚ã€‚</p>
<p><img src="https://i.loli.net/2017/10/31/59f86f09c700e.png" alt="">  </p>
<p>å¯¹äºå·ç§¯ï¼Œå‚æ•°å…±äº«çš„ç‰¹æ®Šå½¢å¼ä½¿å¾—ç¥ç»ç½‘ç»œå±‚å…·æœ‰å¯¹<strong>å¹³ç§»ç­‰å˜çš„æ€§è´¨</strong>ï¼šå…ˆå¹³ç§»åå·ç§¯=å…ˆå·ç§¯åå¹³ç§»ã€‚</p>
<p><strong>è¾¹ç¼˜æ£€æµ‹çš„ä¾‹å­</strong></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨æ¯ä¸ªåƒç´ å‡å»å·¦è¾¹ç›¸é‚»åƒç´ å½¢æˆçš„ã€‚è¿™å…¶å®å°±æ˜¯ä¸€ç§æœ€ç®€å•çš„å·ç§¯ã€‚</p>
<p><img src="https://i.loli.net/2017/10/31/59f879f482dd9.png" alt=""></p>
<h1 id="è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œ">4. è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œ</h1><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-06-16-04-01.png" alt=""> </p>
<p>æˆ‘ä»¬å°†è®­ç»ƒé›†è¾“å…¥åˆ°å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œå¯¹ç½‘ç»œè¿›è¡Œè®­ç»ƒã€‚åˆ©ç”¨æ¢¯åº¦ä¸‹é™ï¼ˆAdamã€momentumç­‰ä¼˜åŒ–ç®—æ³•ï¼‰æœ€å°åŒ–ä»£ä»·å‡½æ•°æ¥å¯»æ‰¾ç½‘ç»œæœ€ä¼˜çš„å‚æ•°ã€‚</p>
<h1 id="å¤æ‚åº¦">5. å¤æ‚åº¦</h1><h2 id="å·ç§¯ç½‘ç»œçš„æ—¶é—´å¤æ‚åº¦">5.1. å·ç§¯ç½‘ç»œçš„æ—¶é—´å¤æ‚åº¦</h2><h3 id="å•ä¸ªå·ç§¯å±‚çš„æ—¶é—´å¤æ‚åº¦">5.1.1. å•ä¸ªå·ç§¯å±‚çš„æ—¶é—´å¤æ‚åº¦</h3><p>$$O(M^2 K^2 C_{in}C_{out})$$</p>
<ul>
<li>M : æ¯ä¸ªå·ç§¯æ ¸è¾“å‡ºç‰¹å¾å›¾ï¼ˆfeature mapï¼‰çš„è¾¹é•¿<ul>
<li><strong>è¾“å‡º</strong>ç‰¹å¾å›¾å°ºå¯¸æœ¬èº«åˆç”±<strong>è¾“å…¥</strong>çŸ©é˜µå°ºå¯¸ X ã€å·ç§¯æ ¸å°ºå¯¸Kã€å¡«å……å¤§å°Paddingã€æ­¥é•¿Stride è¿™å››ä¸ªå‚æ•°æ‰€å†³å®šï¼Œè¡¨ç¤ºå¦‚ä¸‹ï¼š<br>$$M = (X - K + 2 * Padding) / Stride + 1$$</li>
</ul>
</li>
<li>K : æ¯ä¸ªå·ç§¯æ ¸çš„è¾¹é•¿</li>
<li>Cin :  æ¯ä¸ªå·ç§¯æ ¸çš„é€šé“æ•°ï¼Œä¹Ÿå³è¾“å…¥é€šé“æ•°ï¼Œä¹Ÿå³ä¸Šä¸€å±‚çš„è¾“å‡ºé€šé“æ•°</li>
<li>Cout : æœ¬å·ç§¯å±‚å…·æœ‰çš„å·ç§¯æ ¸ä¸ªæ•°ï¼Œä¹Ÿå³è¾“å‡ºé€šé“æ•°</li>
</ul>
<h3 id="å·ç§¯ç¥ç»ç½‘ç»œæ•´ä½“çš„æ—¶é—´å¤æ‚åº¦">5.1.2. å·ç§¯ç¥ç»ç½‘ç»œæ•´ä½“çš„æ—¶é—´å¤æ‚åº¦</h3><p>$$O\sum_{l = 1}^D(M^2_l K_l ^2 C_{l-1}C_{l})$$</p>
<ul>
<li>D : ç½‘ç»œæ·±åº¦</li>
</ul>
<h2 id="å·ç§¯ç½‘ç»œçš„ç©ºé—´å¤æ‚åº¦">5.2. å·ç§¯ç½‘ç»œçš„ç©ºé—´å¤æ‚åº¦</h2><p>$$O(\sum_{l = 1}^D K_l^2 C_{l - 1}C_l)$$</p>
<ul>
<li>ä¸è¾“å…¥æ•°æ®å¤§å°æ— å…³</li>
<li>å½“æˆ‘ä»¬éœ€è¦è£å‰ªæ¨¡å‹æ—¶ï¼Œç”±äºå·ç§¯æ ¸çš„å°ºå¯¸é€šå¸¸å·²ç»å¾ˆå°ï¼Œè€Œç½‘ç»œçš„æ·±åº¦åˆä¸æ¨¡å‹çš„èƒ½åŠ›ç´§å¯†ç›¸å…³ï¼Œä¸å®œè¿‡å¤šå‰Šå‡ï¼Œå› æ­¤æ¨¡å‹è£å‰ªé€šå¸¸æœ€å…ˆä¸‹æ‰‹çš„åœ°æ–¹å°±æ˜¯é€šé“æ•°</li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">6. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="">æ·±åº¦å­¦ä¹ </a></li>
<li><a href="http://www.datagrand.com/blog/neural.html" target="_blank" rel="external">è¾¾è§‚æ•°æ®æ·±åº¦å­¦ä¹ </a></li>
<li><a href="http://www.dlworld.cn/ZiLiaoXiaZai/1757.html" target="_blank" rel="external">æ·±åº¦å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Networks)</a></li>
<li><a href="http://blog.csdn.net/v_july_v/article/details/51812459" target="_blank" rel="external">CNNç¬”è®°ï¼šé€šä¿—ç†è§£å·ç§¯ç¥ç»ç½‘ç»œ</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/31575074" target="_blank" rel="external">å·ç§¯ç¥ç»ç½‘ç»œçš„å¤æ‚åº¦åˆ†æ</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> å·ç§¯ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ•°å­¦-æœ€å¤§ä¼¼ç„¶ä¼°è®¡]]></title>
      <url>/2017/10/26/%E6%95%B0%E5%AD%A6-%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1/</url>
      <content type="html"><![CDATA[<p>å…¶å®åœ¨ä¹‹å‰çš„åšå®¢<a href="https://jiayi797.github.io/2017/07/15/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%9A%84%E7%90%86%E8%A7%A3/">æœ´ç´ è´å¶æ–¯çš„ç†è§£</a>ä¸€æ–‡ä¸­æ›¾ç»æåˆ°è¿‡æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<p>æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæˆ‘ä»¬å·²çŸ¥$x$å·²å‘ç”Ÿï¼Œæˆ‘ä»¬å†æ ¹æ®å®é™…æƒ…å†µå†™å‡º$x$å‘ç”Ÿçš„æ¦‚ç‡$p(x;Î¸)$ã€‚ç›®æ ‡å‡½æ•°æ˜¯ä½¿å¾—è¿™ä¸ªæ¦‚ç‡$p(x;Î¸)$æœ€å¤§ï¼Œç„¶åæ±‚å¾—$Î¸$ï¼š</p>
<p>$$\theta_{ML}=arg max_\theta p(X;\theta)=arg max_\theta âˆ_{i=1}^mp(x^{i};\theta)$$</p>
<font size="2.5">ä¸Šå…¬å¼ä¸­ï¼š<br>$p(X;\theta)$æ˜¯æ ·æœ¬é›†$X$å‡ºç°çš„æ¦‚ç‡ï¼›<br>$p(x^{i};\theta)$æ˜¯æŸä¸ªæ ·æœ¬å‡ºç°çš„æ¦‚ç‡ï¼›<br>å·¦å¼ç­‰äºå³å¼åŸå› æ˜¯æ¯ä¸ªæ ·æœ¬å‡ºç°çš„æ¦‚ç‡ç‹¬ç«‹ï¼›<br></font>

<p>å¤šä¸ªæ•°çš„è¿ä¹˜å®¹æ˜“æº¢å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒè½¬åŒ–ä¸ºlogè¿ç®—ï¼š<br>$$\theta_{ML}=arg max_\theta \sum{i=1}^mlog p(x^{i};\theta)$$<br>å°†ä¸Šå¼é™¤ä»¥$m$ï¼Œå¾—åˆ°ä¸€ç§æœŸæœ›ï¼š<br>$$\theta_{ML}=arg max_\theta E_{x\text{~}pâ€™_{data}}log p(x^{i};\theta) \tag{å…¬å¼1}$$<br>è¿™ä¸ªå¼å­çš„å«ä¹‰æ˜¯ï¼šåœ¨ç»éªŒåˆ†å¸ƒ$x\text{~}p^`$ä¸Šï¼Œæ±‚å¾—ä¸€ä¸ª$\theta$ï¼Œä½¿å¾—æ¨¡å‹åˆ†å¸ƒçš„æœŸæœ›æœ€å¤§åŒ–ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬æš‚æ—¶å…ˆä¸çœ‹ä¸Šé¢è¿™ä¸ªå…¬å¼ã€‚æˆ‘ä»¬ä»å¦ä¸€ä¸ªè§’åº¦â€”â€”è¯¯å·®æ¥è¡¡é‡ã€‚è®­ç»ƒé›†ä¸Šçš„ç»éªŒåˆ†å¸ƒ$pâ€™_{data}â€‹$å’Œæ¨¡å‹ä¹‹é—´çš„åˆ†å¸ƒå·®å¼‚å¯ä»¥ç”¨KLæ•£åº¦è¡¡é‡ï¼š</p>
<p>$$D_{KL}(pâ€™_{data}||p_{model}) = E_{x\text{~}pâ€™_{data}}[logpâ€™_{data}(x)-logp_{model}(x)]$$</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿ä¸Šå¼æœ€å°åŒ–ã€‚å‡å·å·¦è¾¹æ˜¯åœ¨è®­ç»ƒé›†ä¸Šçš„ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼›æˆ‘ä»¬åªå…³å¿ƒå³è¾¹ï¼š</p>
<p>$$\theta_{KL}=argmin_{\theta} -E_{x\text{~}pâ€™_{data}}[logp_{model}(x)]\tag{å…¬å¼2}$$</p>
<p>å¾ˆæ˜æ˜¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…¬å¼2ä¸å…¬å¼1å…¶å®æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä»è¿™ä¸ªè§’åº¦è¯æ˜äº†è¿™ç§åº¦é‡ä¸‹çš„è¯¯å·®ä¸æå¤§ä¼¼ç„¶æ˜¯ç›¸åŒçš„ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ ç®—æ³•-è¯¯å·®å‡½æ•°æ¢ç©¶]]></title>
      <url>/2017/10/25/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E8%AF%AF%E5%B7%AE%E5%87%BD%E6%95%B0%E6%8E%A2%E7%A9%B6/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰æˆ‘ä»¬åœ¨<a href="https://jiayi797.github.io/2017/09/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E4%BB%8B/">ç¥ç»ç½‘ç»œç®€ä»‹</a>ä¸­æ›¾ç»æåˆ°è¿‡è¯¯å·®å‡½æ•°ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¯¯å·®å‡½æ•°ã€‚</p>
<p>è¯¯å·®å‡½æ•°ä¸€èˆ¬æœ‰ä¸¤ç§æ¥æºï¼š</p>
<ol>
<li>å¦‚æœå‚æ•°æ¨¡å‹å®šä¹‰äº†ä¸€ä¸ªåˆ†å¸ƒ$p(y|x;\theta)$ï¼Œæˆ‘ä»¬é‡‡ç”¨æœ€å¤§ä¼¼ç„¶åŸç†å¾—åˆ°ä»£ä»·å‡½æ•°ï¼šè®­ç»ƒæ•°æ®å’Œæ¨¡å‹é¢„æµ‹é—´çš„äº¤å‰ç†µã€‚è¿™ä¸ªåœ¨ä¹‹åä¼šè¯¦ç»†è§£é‡Šã€‚</li>
<li>å¦‚æœä¸é¢„æµ‹yçš„å®Œæ•´æ¦‚ç‡åˆ†å¸ƒï¼Œä»…ä»…é¢„æµ‹åœ¨ç»™å®šxæ¡ä»¶ä¸‹yçš„æŸç§ç»Ÿè®¡é‡ï¼Œé‚£å°±ç”¨æŸäº›ä¸“é—¨çš„æŸå¤±å‡½æ•°æ¥è®¡ç®—ã€‚</li>
</ol>
<h1 id="æ–¹æ³•1ï¼Œä½¿ç”¨æœ€å¤§ä¼¼ç„¶å­¦ä¹ æ¡ä»¶åˆ†å¸ƒ">1. æ–¹æ³•1ï¼Œä½¿ç”¨æœ€å¤§ä¼¼ç„¶å­¦ä¹ æ¡ä»¶åˆ†å¸ƒ</h1><p>å¯ä»¥åœ¨åšå®¢<a href="https://jiayi797.github.io/2017/10/26/%E6%95%B0%E5%AD%A6-%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1/">æœ€å¤§ä¼¼ç„¶ä¼°è®¡</a>ä¸­çœ‹åˆ°ï¼Œå‚æ•°æ¨¡å‹å®šä¹‰äº†ä¸€ä¸ªåˆ†å¸ƒ$p(y|x;\theta)$ï¼Œä¸ºäº†æ±‚å¾—å‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å¤§ä¼¼ç„¶åŸç†ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç›®æ ‡å‡½æ•°æ˜¯æœ€å°åŒ–ä»£ä»·å‡½æ•°Jâ€”â€”<strong>è®­ç»ƒæ•°æ®</strong>å’Œ<strong>æ¨¡å‹é¢„æµ‹</strong>é—´çš„<strong>äº¤å‰ç†µ:</strong></p>
<p>$$J(\theta)=-E_{x,y\sim pâ€™_{data}}log p_{model}(y|x)$$</p>
<p>ä¸Šå¼çš„æ„ä¹‰æ˜¯ï¼šåœ¨$x,y$æœä»è®­ç»ƒæ•°æ®$ pâ€™_{data}$åˆ†å¸ƒä¸‹ï¼Œä½¿å¾—æ¨¡å‹çš„$-Elog p_{model}(y|x)$æœ€å°ã€‚</p>
<p>ç”¨ä¼¼ç„¶è§£å†³é—®é¢˜å¸¦æ¥çš„å¥½å¤„ï¼š</p>
<ol>
<li>å½“æ˜ç¡®äº†ä¸€ä¸ªæ¨¡å‹$p(y|x)$æ—¶ï¼Œå°±è‡ªåŠ¨åœ°ç¡®å®šäº†ä»£ä»·å‡½æ•°$logp(y|x)$ã€‚</li>
<li>å¯¹æ•°å‡½æ•°èƒ½å¸®æˆ‘ä»¬é¿å…æ¢¯åº¦è¿‡å°ï¼ˆä¾‹å¦‚æœ‰çš„è¾“å‡ºå•å…ƒæœ‰ä¸€ä¸ªæŒ‡æ•°å‡½æ•°ï¼Œå–å¯¹æ•°åæ¢¯åº¦å°±ä¸é‚£ä¹ˆå°äº†ï¼‰</li>
</ol>
<h1 id="æ–¹æ³•2ï¼Œç®€å•å­¦ä¹ æ¡ä»¶ç»Ÿè®¡é‡">2. æ–¹æ³•2ï¼Œç®€å•å­¦ä¹ æ¡ä»¶ç»Ÿè®¡é‡</h1><p>æˆ‘ä»¬ç”¨å†å²çš„æ•°æ®ï¼Œè®¡ç®—å‡ºç‰¹å¾xä¸‹yå‘ç”Ÿçš„æ¦‚ç‡ï¼š$f(x)=p(y|x)$ï¼Œå°†å®ƒä½œä¸ºxç‰¹å¾ä¸‹yçš„é¢„æµ‹ã€‚å­¦ä¹ è¿™ä¸ªæ¡ä»¶ç»Ÿè®¡é‡çš„è¿‡ç¨‹å°±æ˜¯æˆ‘ä»¬è¿™èŠ‚ä»‹ç»çš„æ–¹æ³•ã€‚</p>
<h2 id="å‡æ–¹è¯¯å·®">2.1. å‡æ–¹è¯¯å·®</h2><p>é€šè¿‡è§£ä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$$f^*=arg min_f E_{x,y\sim p_{data}}||y-f(x)||^2 \tag{å‡æ–¹è¯¯å·®æœ€å°åŒ–æ—¶çš„f^{â€»}}$$</p>
<p>å¾—åˆ°$f^*$,æˆ‘ä»¬ç”¨å®ƒæ¥è¿›è¡Œé¢„æµ‹å¾—åˆ°ï¼š</p>
<p>$$f^*(x)=E_{y\sim p_{data}(y|x)}[y]\tag{å°†æ‰€æœ‰æœä»p_{data}(y|x)çš„yçš„yå‡å€¼ä½œä¸ºxç‰¹å¾ä¸‹yçš„é¢„æµ‹}$$</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¿™æ ·å¾—åˆ°çš„å‡½æ•°æ˜¯å¯ä»¥ç”¨æ¥å¯¹æ¯ä¸ªxçš„å€¼é¢„æµ‹å‡ºyçš„<strong>å‡å€¼</strong>ã€‚</p>
<h2 id="å¹³å‡ç»å¯¹è¯¯å·®">2.2. å¹³å‡ç»å¯¹è¯¯å·®</h2><p>è¿˜æœ‰å¦ä¸€ç§è¯¯å·®å«å¹³å‡ç»å¯¹è¯¯å·®ï¼Œé€šè¿‡è§£ä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$$f^*=arg min_f E_{x,y \sim p_{data}}||y-f(x)||_1$$</p>
<p>å¾—åˆ°çš„å‡½æ•°ï¼Œå¯ä»¥å¯¹æ¯ä¸ªxé¢„æµ‹yå–å€¼çš„<strong>ä¸­ä½æ•°</strong>ã€‚</p>
<h1 id="æ¯”è¾ƒ">3. æ¯”è¾ƒ</h1><p>ä¸€èˆ¬ï¼Œå‡æ–¹è¯¯å·®å’Œå¹³å‡ç»å¯¹è¯¯å·®åœ¨æ¢¯åº¦ä¸‹é™æ³•è¡¨ç°ä¸å¥½ï¼Œå› ä¸ºé¥±å’Œçš„è¾“å‡ºå•å…ƒæ¢¯åº¦éå¸¸å°ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´äº¤å‰ç†µä»£ä»·å‡½æ•°æ›´å—æ¬¢è¿ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-L2Rè¿›ä¸€æ­¥äº†è§£]]></title>
      <url>/2017/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-L2R%E8%BF%9B%E4%B8%80%E6%AD%A5%E4%BA%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰çš„åšå®¢ä¸­ç®€å•ä»‹ç»äº†Learning to Rankçš„åŸºæœ¬åŸç†ï¼Œä¹Ÿè®²åˆ°äº†Learning to Rankçš„å‡ ç±»å¸¸ç”¨çš„æ–¹æ³•ï¼špointwiseï¼Œpairwiseï¼Œlistwiseã€‚è¿™ç¯‡åšå®¢å°±pairwiseä¸­çš„RankSVMã€GBRankå’ŒLambdaRankåšç®€è¦ä»‹ç»ã€‚</p>
<p>RankSVMæ˜¯2000å¹´æå‡ºçš„ï¼›GBRankæ˜¯2007å¹´æå‡ºçš„ï¼›LambdaMARTæ˜¯2008å¹´æå‡ºçš„ã€‚å› æ­¤æˆ‘ä»¬æŒ‰ç…§æå‡ºé¡ºåºæ¥è®²è§£è¿™ä¸‰ç§ç®—æ³•ã€‚</p>
<h1 id="å¼•è¨€">1. å¼•è¨€</h1><p>æœºå™¨å­¦ä¹ ä¸€èˆ¬éƒ½æ˜¯è§£å†³åˆ†ç±»é—®é¢˜ã€‚è€Œåœ¨Rankä¸­æˆ‘ä»¬é‡åˆ°çš„æ˜¯æ’åºé—®é¢˜ã€‚é‚£ä¹ˆå¦‚ä½•å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜æˆäº†å½“ä¸‹çš„å…³é”®ã€‚</p>
<h2 id="å¦‚ä½•å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Ÿ">1.1. å¦‚ä½•å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Ÿ</h2><p>å¯¹äºä¸€ä¸ªquery-doc pairï¼ˆæ£€ç´¢-æ–‡æ¡£ç»“æœå¯¹ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç”¨ä¸€ä¸ªfeature vectorè¡¨ç¤ºï¼šxã€‚è€Œæ’åºå‡½æ•°ä¸ºf(x)ï¼Œæˆ‘ä»¬æ ¹æ®f(x)çš„å¤§å°æ¥å†³å®šå“ªä¸ªdocæ’åœ¨å‰é¢ï¼Œå“ªä¸ªdocæ’åœ¨åé¢ã€‚å³å¦‚æœf(xi) &gt; f(xj)ï¼Œåˆ™xiåº”è¯¥æ’åœ¨xjçš„å‰é¢ï¼Œåä¹‹äº¦ç„¶ã€‚å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼è¡¨ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2017/09/25/59c8b1ffea865.png" alt=""> </p>
<p>ç†è®ºä¸Šï¼Œf(x)å¯ä»¥æ˜¯ä»»æ„å‡½æ•°ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾å…¶ä¸ºçº¿æ€§å‡½æ•°ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8b2152e915.png" alt=""><br>å¦‚æœè¿™ä¸ªæ’åºå‡½æ•°f(x)æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥å°†ä¸€ä¸ªæ’åºé—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªäºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚ç†ç”±å¦‚ä¸‹ï¼š<br>é¦–å…ˆï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªfeature vector xiå’Œ xjï¼Œåœ¨f(x)æ˜¯çº¿æ€§å‡½æ•°çš„å‰æä¸‹ï¼Œä¸‹é¢çš„å…³ç³»éƒ½æ˜¯å­˜åœ¨çš„ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8b41b9bba0.png" alt=""><br>ç„¶åï¼Œä¾¿å¯ä»¥å¯¹xiå’Œ xjçš„å·®å€¼å‘é‡è€ƒè™‘äºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶èµ‹å€¼ä¸€ä¸ªlabelï¼š<br><img src="https://i.loli.net/2017/09/25/59c8b4335d7e6.png" alt=""> </p>
<p>æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­è¯´æ˜äº†å¦‚ä½•å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Œåœ¨L2Rçš„ç¬”è®°ä¸­å·²æåˆ°è¿‡ï¼Œæ­¤å¤„ä¸å†å¤šåŠ é˜è¿°ã€‚</p>
<p>å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ä¹‹å, æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¸¸ç”¨çš„æœºå™¨å­¦ä¹ æ–¹æ³•è§£å†³è¯¥é—®é¢˜ã€‚</p>
<h1 id="RankSVM">2. RankSVM</h1><p>RankSVMçš„<strong>åŸºæœ¬æ€æƒ³</strong>æ˜¯ï¼Œå°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºpairwiseçš„åˆ†ç±»é—®é¢˜ï¼Œç„¶åä½¿ç”¨SVMåˆ†ç±»æ¨¡å‹è¿›è¡Œå­¦ä¹ å¹¶æ±‚è§£ã€‚Ranking SVMä½¿ç”¨SVMæ¥è¿›è¡Œåˆ†ç±»:<br><img src="https://i.loli.net/2017/09/25/59c8b8e74b0df.png" alt=""> </p>
<p>å…¶ä¸­wä¸ºå‚æ•°å‘é‡, xä¸ºæ–‡æ¡£çš„ç‰¹å¾,yä¸ºæ–‡æ¡£å¯¹ä¹‹é—´çš„ç›¸å¯¹ç›¸å…³æ€§, Î¾ä¸ºæ¾å¼›å˜é‡ã€‚</p>
<p>å¯¹è¿™ä¸ªå…¬å¼ï¼Œ<a href="https://www.zhihu.com/question/23764120" target="_blank" rel="external">çŸ¥ä¹</a>ä¸Šæœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£é‡Šï¼š<br>ä¹‹å‰svmä¸ºå®ç°è½¯é—´éš”æœ€å¤§åŒ–ï¼Œçº¦æŸæ¡ä»¶é‡Œæœ‰<img src="https://i.loli.net/2017/09/25/59c8b458a2a54.png" alt=""> ã€‚è€Œrank-svmæ˜¯å…¸å‹çš„pairwiseæ–¹æ³•ï¼Œè€ƒè™‘ä¸¤ä¸ªæœ‰ååºå…³ç³»çš„æ–‡æ¡£å¯¹ï¼Œè®­ç»ƒæ ·æœ¬æ˜¯xi^(1)-xi^(2)ï¼Œæ‰€ä»¥è¦æŠŠçº¦æŸæ¡ä»¶æ”¹æˆ<img src="https://i.loli.net/2017/09/25/59c8b472b130b.png" alt=""> ï¼Œç”±äºç›¸å‡ä¸å†éœ€è¦åç½®bã€‚è€Œä¼˜åŒ–é—®é¢˜ä¸­çš„ç›®æ ‡å‡½æ•°å’Œå…¶ä»–çº¦æŸé¡¹ä¸å˜ã€‚</p>
<h2 id="ä½¿ç”¨Clikthroughæ•°æ®ä½œä¸ºè®­ç»ƒæ•°æ®">2.1. ä½¿ç”¨Clikthroughæ•°æ®ä½œä¸ºè®­ç»ƒæ•°æ®</h2><p>T. Joachimsæå‡ºäº†ä¸€ç§éå¸¸å·§å¦™çš„æ–¹æ³•, æ¥ä½¿ç”¨Clickthroughæ•°æ®ä½œä¸ºRanking SVMçš„è®­ç»ƒæ•°æ®ã€‚</p>
<p>å‡è®¾ç»™å®šä¸€ä¸ªæŸ¥è¯¢â€Support Vector Machineâ€, æœç´¢å¼•æ“çš„è¿”å›ç»“æœä¸º<br><img src="https://ooo.0o0.ooo/2017/09/25/59c8b9563cab6.png" alt=""><br>å…¶ä¸­1, 3, 7ä¸‰ä¸ªç»“æœè¢«ç”¨æˆ·ç‚¹å‡»è¿‡, å…¶ä»–çš„åˆ™æ²¡æœ‰ã€‚å› ä¸ºè¿”å›çš„ç»“æœæœ¬èº«æ˜¯æœ‰åºçš„, ç”¨æˆ·æ›´å€¾å‘äºç‚¹å‡»æ’åœ¨å‰é¢çš„ç»“æœ, æ‰€ä»¥ç”¨æˆ·çš„ç‚¹å‡»è¡Œä¸ºæœ¬èº«æ˜¯æœ‰å(Bias)çš„ã€‚ä¸ºäº†ä»æœ‰åçš„ç‚¹å‡»æ•°æ®ä¸­è·å¾—æ–‡æ¡£çš„ç›¸å…³ä¿¡æ¯, æˆ‘ä»¬è®¤ä¸º: å¦‚æœä¸€ä¸ªç”¨æˆ·ç‚¹å‡»äº†aè€Œæ²¡æœ‰ç‚¹å‡»b, ä½†æ˜¯båœ¨æ’åºç»“æœä¸­çš„ä½ç½®é«˜äºa, åˆ™a&gt;bã€‚<br>æ‰€ä»¥ä¸Šé¢çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºæ„å‘³ç€: 3&gt;2, 7&gt;2, 7&gt;4, 7&gt;5, 7&gt;6ã€‚</p>
<h2 id="Ranking-SVMçš„å¼€æºå®ç°">2.2. Ranking SVMçš„å¼€æºå®ç°</h2><p><a href="http://www.cs.cornell.edu/people/tj/svm_light/svm_rank.html" target="_blank" rel="external">Joachimsçš„ä¸»é¡µ</a>ä¸Šæœ‰Ranking SVMçš„å¼€æºå®ç°ã€‚</p>
<p>æ•°æ®çš„æ ¼å¼ä¸LIBSVMçš„è¾“å…¥æ ¼å¼æ¯”è¾ƒç›¸ä¼¼, ç¬¬ä¸€åˆ—ä»£è¡¨æ–‡æ¡£çš„ç›¸å…³æ€§, å€¼è¶Šå¤§ä»£è¡¨è¶Šç›¸å…³, ç¬¬äºŒåˆ—ä»£è¡¨æŸ¥è¯¢, åé¢çš„ä»£è¡¨ç‰¹å¾:<br>qid:1 1:1 2:1 3:0 4:0.2 5:0 # 1A<br>qid:1 1:0 2:0 3:1 4:0.1 5:1 # 1B<br>qid:1 1:0 2:1 3:0 4:0.4 5:0 # 1C<br>qid:1 1:0 2:0 3:1 4:0.3 5:0 # 1D<br>qid:2 1:0 2:0 3:1 4:0.2 5:0 # 2A<br>qid:2 1:1 2:0 3:1 4:0.4 5:0 # 2B<br>qid:2 1:0 2:0 3:1 4:0.1 5:0 # 2C<br>qid:2 1:0 2:0 3:1 4:0.2 5:0 # 2D<br>qid:3 1:0 2:0 3:1 4:0.1 5:1 # 3A<br>qid:3 1:1 2:1 3:0 4:0.3 5:0 # 3B<br>qid:3 1:1 2:0 3:0 4:0.4 5:1 # 3C<br>qid:3 1:0 2:1 3:1 4:0.5 5:0 # 3D</p>
<h1 id="GBRank">3. GBRank</h1><p>å‚è€ƒæ–‡çŒ®<a href="http://www.tuicool.com/articles/yAfiQ3r" target="_blank" rel="external">GBRank:ä¸€ç§åŸºäºå›å½’çš„å­¦ä¹ æ’åºç®—æ³•</a><br>å¯¹GBRankåšå‡ºäº†è¾ƒå¥½çš„è§£é‡Šã€‚åŸè®ºæ–‡æ˜¯[A Regression Framework for Learning Ranking Functions Using Relative Relevance Judgments]ã€‚ä¸‹é¢å¯¹è¿™ä¸ªåšå®¢å’Œè®ºæ–‡è¿›è¡Œæ‘˜å½•å’Œæ•´ç†ã€‚</p>
<h2 id="ç®—æ³•åŸç†">3.1. ç®—æ³•åŸç†</h2><p>ä¸€èˆ¬æ¥è¯´åœ¨æœç´¢å¼•æ“é‡Œé¢ï¼Œç›¸å…³æ€§è¶Šé«˜çš„è¶Šåº”è¯¥æ’åœ¨å‰é¢ã€‚ç°åœ¨ query-doc çš„ç‰¹å¾ä½¿ç”¨å‘é‡xæˆ–è€…yè¡¨ç¤ºï¼Œå‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªæ–‡æ¡£å¯¹<xi,yi>ï¼Œå½“xiæ’åœ¨yiå‰é¢æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨xi&gt;yiæ¥è¡¨ç¤ºã€‚æˆ‘ä»¬å«é¡ºåºçš„ pair å¯¹ç”¨å¦‚ä¸‹é›†åˆè¡¨ç¤º(ä¹Ÿå°±æ˜¯çœŸçš„xiçœŸçš„æ’åœ¨yiå‰é¢):<br><img src="https://i.loli.net/2017/09/25/59c8b9d26d47d.png" alt=""><br>ç°å‡è®¾å­¦ä¹ çš„æ’åºå‡½æ•°ä¸ºhï¼Œæˆ‘ä»¬å¸Œæœ›å½“h(xi)&gt;h(yi)æ—¶ï¼Œæ»¡è¶³xi&gt;yiçš„æ•°é‡è¶Šå¤šè¶Šå¥½ã€‚é‚£ä¹ˆå¦‚ä½•æ¥è¯„ä»·è¿™ä¸ªhåˆ°åº•å¥½ä¸å¥½å‘¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰hçš„é£é™©å‡½æ•°ä¸º:<br><img src="https://i.loli.net/2017/09/25/59c8ba28f012e.png" alt=""><br>å¯¹äºè¿™ä¸ªé£é™©å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹è§£é‡Šã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼šå¯¹äºé›†åˆSä¸­çš„æŸä¸ªæ–‡æ¡£å¯¹<xi,yi>æ¥è¯´ï¼Œhè¦ç¬¦åˆæˆ‘ä»¬ä¹‹å‰çš„è®¾å®šï¼Œä¹Ÿå°±æ˜¯ï¼š</xi,yi></xi,yi></p>
<p>å½“h(xi)&gt;h(yi)æ—¶ï¼Œhæ˜¯æ­£ç¡®çš„ï¼Œä¸é€ æˆæŸå¤±ï¼›<br>å½“h(xi)&lt;h(yi)æ—¶ï¼Œhæ˜¯ä¸ç¬¦åˆé¢„æœŸçš„ï¼Œä¼šé€ æˆæŸå¤±ï¼Œå¹¶ä¸”æŸå¤±çš„å¤§å°æˆæ®‹å·®çš„å¹³æ–¹çº§åˆ«ï¼›</p>
<p>å°†R(h)ä¸æ¯ä¸ª pair å¯¹<xi,yi>çš„costç”»æˆå›¾å¯è¡¨ç¤ºä¸ºï¼š<br><img src="https://i.loli.net/2017/09/25/59c8ba5bd7a2e.png" alt=""> </xi,yi></p>
<p>ä¸Šè¿°é£é™©å‡½æ•°ç›´æ¥ä¼˜åŒ–æ¯”è¾ƒå›°éš¾ï¼Œè¿™é‡Œä¸€ä¸ªå·§å¦™çš„è§£å†³æ–¹æ¡ˆï¼šä¹Ÿå°±æ˜¯é¦–å…ˆå›ºå®šh(xi)æˆ–è€…h(yi)å½“ä¸­å…¶ä¸­çš„ä¸€ä¸ªï¼Œç„¶åå†é€šè¿‡å›å½’çš„æ–¹å¼æ¥è§£å†³é—®é¢˜ã€‚<br>ä¸ºäº†é¿å…ä¼˜åŒ–å‡½æ•°hæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œæˆ‘ä»¬å¯¹é£é™©å‡½æ•°åŠ å…¥ä¸€ä¸ªå¹³æ»‘é¡¹Ï„(0&lt;Ï„â‰¤10)ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8ba71a4abd.png" alt=""><br>å…¶å®åŠ ä¸Šäº†è¿™ä¸ªå¹³æ»‘é¡¹ä¹‹åï¼Œä¸€æ¥å¯ä»¥é˜²æ­¢hå˜ä¸ºå¸¸æ•°ï¼ŒäºŒæ¥è¿˜å¯¹æŸå¤±å‡½æ•°ç»™äº†æ›´ä¸¥æ ¼çš„æ¡ä»¶ï¼šå¦‚æœå¸Œæœ›xi&gt;yiï¼Œå°±å¾—æœ‰h(xi)&gt;h(yi)+Ï„ï¼Œä¹Ÿå°±æ˜¯æ›´ä¸ºä¸¥æ ¼äº†ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Functional Gradient Descentæ³•æ¥æ±‚è§£h.</p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://www.cnblogs.com/bentuwuying/p/6684585.html" target="_blank" rel="external">Learning to Rankç®—æ³•ä»‹ç»ï¼šGBRank</a>å¯¹è¿™ä¸ªæ±‚è§£æ–¹æ³•åšäº†æ‰¼è¦çš„ä»‹ç»ï¼š</p>
<p>åœ¨GBDTä¸­ï¼ŒFunctional Gradient Descentçš„ä½¿ç”¨ä¸ºï¼šå°†éœ€è¦æ±‚è§£çš„F(x)è¡¨ç¤ºæˆä¸€ä¸ªadditive modelï¼Œå³å°†ä¸€ä¸ªå‡½æ•°åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå°å‡½æ•°çš„åŠ å’Œå½¢å¼ï¼Œè€Œè¿™æ¯ä¸ªå°å‡½æ•°çš„äº§ç”Ÿè¿‡ç¨‹æ˜¯ä¸²è¡Œç”Ÿæˆçš„ï¼Œå³æ¯ä¸ªå°å‡½æ•°éƒ½æ˜¯åœ¨æ‹Ÿåˆ loss functionåœ¨å·²æœ‰çš„F(x)ä¸Šçš„æ¢¯åº¦æ–¹å‘ï¼ˆç”±äºè®­ç»ƒæ•°æ®æ˜¯æœ‰é™ä¸ªæ•°çš„ï¼Œæ‰€ä»¥F(x)æ˜¯ç¦»æ•£å€¼çš„å‘é‡ï¼Œè€Œæ­¤æ¢¯åº¦æ–¹å‘ä¹Ÿè¡¨ç¤ºæˆä¸€ä¸ªç¦»æ•£å€¼çš„å‘é‡ï¼‰ï¼Œç„¶åå°†æ‹Ÿåˆçš„ç»“æœå‡½æ•°è¿›ä¸€æ­¥æ›´æ–°åˆ°F(x)ä¸­ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„F(x)ã€‚</p>
<ol>
<li>å°†h(xi)å’Œh(xi)ä½œä¸ºæœªçŸ¥æ•°ã€‚æ¢¯åº¦ä¸‹é™ä½¿å¾—Ræœ€å°ï¼Œæ¥æ±‚å¾—è¿™äº›æœªçŸ¥æ•°ã€‚</li>
<li>å¯¹Rè®¡ç®—hçš„è´Ÿæ¢¯åº¦ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8baf10df1f.png" alt=""> </li>
<li>å½“pairå¯¹<xi,yi>ç¬¦åˆæ¡ä»¶æ—¶ï¼Œä¸Šè¿°æ¢¯åº¦ä¸º0ï¼›åä¹‹ï¼Œä»–ä»¬å¯¹åº”çš„æ¢¯åº¦ä¸ºï¼š<br><img src="https://i.loli.net/2017/09/25/59c8bb529920a.png" alt=""> </xi,yi></li>
<li>æ¥ä¸‹æ¥ï¼Œè¿˜éœ€è¦çŸ¥é“å¦‚ä½•å°†æ¢¯åº¦ä½œç”¨åˆ°hçš„æ›´æ–°ä¸Šã€‚é€šè¿‡è®¾å®šxiçš„ç›®æ ‡å€¼ä¸ºh(yi)+Ï„ã€‚yiçš„ç›®æ ‡å€¼ä¸ºh(xi)âˆ’Ï„ï¼ˆè¿™ä¸€æ­¥æˆ‘çš„ç†è§£å°±æ˜¯é¦–å…ˆå›ºå®šx/yä¸­çš„æŸä¸€ä¸ªï¼Œç„¶åå»è®¡ç®—å¦ä¸€ä¸ªï¼‰ã€‚å› æ­¤åœ¨æ¯è½®è¿­ä»£ä¸­ï¼Œå½“hä¸æ»¡è¶³<xi,yi>ä¼šäº§ç”Ÿä¸€ç»„æ•°æ®ï¼š<img src="https://i.loli.net/2017/09/25/59c8bb6276a5c.png" alt=""> </xi,yi></li>
</ol>
<p>æˆ‘ä»¬éœ€è¦æ‹Ÿåˆæœ¬è½®äº§ç”Ÿçš„æ‰€æœ‰è´Ÿä¾‹ã€‚</p>
<p>ä¸‹é¢å½¢å¼åŒ–æœ¬ç®—æ³•ï¼š<br><img src="https://ooo.0o0.ooo/2017/09/25/59c8d9a57ef9f.png" alt=""><br>å¯ä»¥çœ‹åˆ°step3é‡Œé¢æ¯è½®éƒ½æ‹Ÿåˆè¯¯åˆ¤çš„ç»“æœï¼Œåœ¨è¿­ä»£ä¸­è¿™ä¸ªé›†åˆä¼šè¶Šæ¥è¶Šå°ã€‚è¿˜æœ‰ä¸€ç§åšæ³•æ˜¯å°†æ›¾ç»è¯¯åˆ¤çš„é›†åˆç»´æŒåœ¨è®­ç»ƒé›†ä¸­ï¼Œé‚£ä¹ˆè®­ç»ƒé›†å°±ä¼šå§‹ç»ˆå¢é•¿ã€‚åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ä½¿ç”¨GBDTæ¨¡å‹è¿›è¡Œå›å½’é¢„æµ‹ï¼Œå½“ç„¶å…¶ä»–çš„å›å½’æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p>
<h1 id="LambdaMART">4. LambdaMART</h1><p>åœ¨learn to rankçš„æˆé•¿è¿‡ç¨‹ä¸­ï¼Œ2000æå‡ºäº†SVMRankï¼Œ2006å¹´æå‡ºGBrankï¼Œ2008å¹´æå‡ºlambdaMARTã€‚çœ‹äº†å‡ ä¸ªæ¯”è¾ƒå¤§çš„æ¡†æ¶ï¼Œæˆ‘å‘ç°ç°åœ¨å¸‚é¢ä¸Šæœ€å¸¸è§çš„learn to rankç®—æ³•å°±æ˜¯LambdaMARTäº†ã€‚æ¥ä¸‹æ¥å…ˆä»‹ç»ä¸€ä¸‹LambdaMARTçš„åŸç†ï¼Œç„¶åå†ä»‹ç»xgboostä¸­æ˜¯æ€ä¹ˆå†™çš„LambdaMartã€‚</p>
<h2 id="LambdaMartçš„åŸç†">4.1. LambdaMartçš„åŸç†</h2><p>è¿™ä¸€å°èŠ‚ä¸»è¦å‚è€ƒèµ„æ–™<a href="https://liam0205.me/2016/07/10/a-not-so-simple-introduction-to-lambdamart/" target="_blank" rel="external">LambdaMART ä¸å¤ªç®€çŸ­ä¹‹ä»‹ç»</a></p>
<p>Pointwiseå’ŒPairwiseç±»å‹çš„LTRç®—æ³•ï¼Œå°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºå›å½’ã€åˆ†ç±»æˆ–è€…æœ‰åºåˆ†ç±»é—®é¢˜ã€‚Listwise ç±»å‹çš„ LTR ç®—æ³•åˆ™å¦è¾Ÿè¹Šå¾„ï¼Œå°†ç”¨æˆ·æŸ¥è¯¢ï¼ˆQueryï¼‰æ‰€å¾—çš„ç»“æœä½œä¸ºæ•´ä½“ï¼Œä½œä¸ºè®­ç»ƒç”¨çš„å®ä¾‹ï¼ˆInstanceï¼‰ã€‚</p>
<p>LambdaMART æ˜¯ä¸€ç§ Listwise ç±»å‹çš„ LTR ç®—æ³•ï¼Œå®ƒåŸºäº LambdaRank ç®—æ³•å’Œ MART(Multiple Additive Regression Tree)ç®—æ³•ï¼Œ<strong>å°†æœç´¢å¼•æ“ç»“æœæ’åºé—®é¢˜è½¬åŒ–ä¸ºå›å½’å†³ç­–æ ‘é—®é¢˜</strong>ã€‚MARTå®é™…å°±æ˜¯æ¢¯åº¦æå‡å†³ç­–æ ‘ï¼ˆGBDT, Gradient Boosting Decision Treeï¼‰ç®—æ³•ã€‚GBDT çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ä¸æ–­çš„è¿­ä»£ä¸­ï¼Œæ–°ä¸€è½®è¿­ä»£äº§ç”Ÿçš„å›å½’å†³ç­–æ ‘æ¨¡å‹æ‹ŸåˆæŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„å›å½’å†³ç­–æ ‘å åŠ å¾—åˆ°æœ€ç»ˆçš„æ¨¡å‹ã€‚LambdaMARTä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ Lambda å€¼æ¥ä»£æ›¿ä¸Šè¿°æ¢¯åº¦ï¼Œä¹Ÿå°±æ˜¯å°†LambdaRankç®—æ³•ä¸MARTç®—æ³•åŠ å’Œèµ·æ¥ã€‚è€ƒè™‘åˆ°LambdaRankæ˜¯åŸºäºRankNetç®—æ³•çš„ï¼Œæ‰€ä»¥åœ¨ææ¸…æ¥šLambdaMARTç®—æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ MARTã€RankNet å’Œ LambdaRank æ˜¯æ€ä¹ˆå›äº‹ã€‚</p>
<p>MARTå…¶å®ä¹Ÿæ˜¯GBDTã€‚æ­¤å¤„å¯¹GBDTä¸å†åšè¿‡å¤šçš„ä»‹ç»ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMARTå¹¶ä¸å¯¹æŸå¤±å‡½æ•°çš„å½¢å¼åšå…·ä½“è§„å®šã€‚å®é™…ä¸Šï¼ŒæŸå¤±å‡½æ•°å‡ ä¹åªéœ€è¦æ»¡è¶³å¯å¯¼è¿™ä¸€æ¡ä»¶å°±å¯ä»¥äº†ã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥æŠŠä»»ä½•åˆç†çš„å¯å¯¼å‡½æ•°å®‰æ’åœ¨ MART æ¨¡å‹ä¸­ã€‚LambdaMART å°±æ˜¯ç”¨ä¸€ä¸ª Î» å€¼ä»£æ›¿äº†æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œå°† Î»å’Œ MART ç»“åˆèµ·æ¥ç½¢äº†ã€‚</p>
<h2 id="LambdaMARTæ˜¯æ€ä¹ˆæ¥çš„">4.2. LambdaMARTæ˜¯æ€ä¹ˆæ¥çš„</h2><p>Lambda çš„è®¾è®¡ï¼Œæœ€æ—©æ˜¯ç”± LambdaRank ä» RankNet ç»§æ‰¿è€Œæ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å…ˆè¦ä» RankNet è®²èµ·ã€‚<br>åè®°ï¼šå…¶å®è¿™äº›æ–‡ç« éƒ½æ˜¯åˆ°å¤„æ•´ç†å¾—æ¥ï¼Œè¿œä¸åŠç›´æ¥çœ‹è®ºæ–‡çš„å¥½ã€‚å¦‚æœæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥è¯»ä¸€è¯»å¾®è½¯æ•´ç†çš„è¿™ç¯‡è®ºæ–‡<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/MSR-TR-2010-82.pdf" target="_blank" rel="external">https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/MSR-TR-2010-82.pdf</a></p>
<p><strong>RankNetçš„åˆ›æ–°</strong></p>
<p>Rankingå¸¸è§çš„è¯„ä»·æŒ‡æ ‡éƒ½æ— æ³•æ±‚æ¢¯åº¦ï¼Œå› æ­¤æ²¡æ³•ç›´æ¥å¯¹è¯„ä»·æŒ‡æ ‡åšæ¢¯åº¦ä¸‹é™ã€‚</p>
<p>RankNet çš„åˆ›æ–°ä¹‹å¤„åœ¨äºï¼Œå®ƒå°†ä¸é€‚å®œç”¨æ¢¯åº¦ä¸‹é™æ±‚è§£çš„Rankingé—®é¢˜ï¼Œè½¬åŒ–ä¸ºå¯¹æ¦‚ç‡çš„äº¤å‰ç†µæŸå¤±å‡½æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä»è€Œé€‚ç”¨æ¢¯åº¦ä¸‹é™æ–¹æ³•ã€‚</p>
<p>RankNetçš„ç»ˆæç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªå¸¦å‚çš„ç®—åˆ†å‡½æ•°s = f(x;w)</p>
<p>å‚è€ƒæ–‡çŒ®æœºå™¨å­¦ä¹ â€”RankNet.md](<a href="https://github.com/MangoLiu/mangoliu.github.io/blob/master/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0---RankNet.md)ç»™äº†ä¸€ä¸ªéå¸¸å¥½çš„ä¾‹å­ï¼šé‚£ä¹ˆå¦‚ä½•é€šè¿‡pairæ¥è®­ç»ƒï¼Œå¹¶æœ€ç»ˆä½œç”¨åˆ°é’ˆå¯¹pointçš„ç®—åˆ†å‡½æ•°ä¸Šï¼Œè¯·çœ‹ä¸‹é¢çš„ç®€å•ä¾‹å­ã€‚å‡è®¾æœ‰ä»¥ä¸‹åŒä¸€ä¸ªqueryä¸‹çš„4ä¸ªæ–‡æ¡£ï¼Œå¹¶ä¸”æœ‰3ä¸ªç‰¹å¾ç»´åº¦ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œäº†äººå·¥æ‰“åˆ†ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨å®ƒä»¬æ¥è®­ç»ƒmodelã€‚" target="_blank" rel="external">https://github.com/MangoLiu/mangoliu.github.io/blob/master/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0---RankNet.md)ç»™äº†ä¸€ä¸ªéå¸¸å¥½çš„ä¾‹å­ï¼šé‚£ä¹ˆå¦‚ä½•é€šè¿‡pairæ¥è®­ç»ƒï¼Œå¹¶æœ€ç»ˆä½œç”¨åˆ°é’ˆå¯¹pointçš„ç®—åˆ†å‡½æ•°ä¸Šï¼Œè¯·çœ‹ä¸‹é¢çš„ç®€å•ä¾‹å­ã€‚å‡è®¾æœ‰ä»¥ä¸‹åŒä¸€ä¸ªqueryä¸‹çš„4ä¸ªæ–‡æ¡£ï¼Œå¹¶ä¸”æœ‰3ä¸ªç‰¹å¾ç»´åº¦ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œäº†äººå·¥æ‰“åˆ†ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨å®ƒä»¬æ¥è®­ç»ƒmodelã€‚</a></p>
<pre><code>point       ç‰¹å¾f1  ç‰¹å¾f2  ç‰¹å¾f3  label     
æ–‡æ¡£doc1      3       2        1      3(å¾ˆå¥½) 
æ–‡æ¡£doc2      1       2        1      2ï¼ˆå¥½ï¼‰ 
æ–‡æ¡£doc3      1       1        2      1ï¼ˆä¸€èˆ¬ï¼‰ 
æ–‡æ¡£doc4      1       0        3      0ï¼ˆä¸å¥½ï¼‰ 
</code></pre><p>äºæ˜¯ï¼Œæ ¹æ®è¿™ä¸ªç®—åˆ†å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç‰¹å¾æ¥è®¡ç®—æ–‡æ¡£xiå’Œxjçš„å¾—åˆ†siå’Œsjï¼š<br>                        Si = f(xi;w),sj = f(xj,w)</p>
<p>æˆ‘ä»¬å¹¶ä¸çŸ¥é“æ¯ä¸ªç‰¹å¾ç»´åº¦çš„å…·ä½“æƒå€¼w[i]ã€‚ä½†æˆ‘ä»¬æ„Ÿè§‰åˆ°è¦è®­ç»ƒå‡ºè¿™æ ·çš„ç»“æœï¼Œå°±æ˜¯ä½¿labelå¾—åˆ†æ¯”è¾ƒé«˜çš„æ ·æœ¬å¾—åˆ†å°½é‡å¤§ï¼Œè®©labelä½çš„æ ·æœ¬å¾—åˆ†å°½é‡å°ã€‚<br>å³æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥è®©f(doc1)å¾—åˆ†å°½é‡å¤§ï¼Œf(doc4)å¾—åˆ†å°½é‡å°ã€‚å…¶å®ä¹Ÿå°±æ˜¯f(doc1)-f(doc4)çš„ç»“æœå°½é‡å¤§ï¼Œå› ä¸ºè¿™ä¸ªåˆ†å·®å®é™…å°±åŒ…å«äº†å‰è€…å°½é‡å¤§åè€…å°½é‡å°çš„å«ä¹‰ã€‚å¹¶ä¸”ä¹‹å‰é‚£ä¸ªå¸¸é‡bé€šè¿‡ä½œå·®åï¼Œä¸è§äº†ã€‚<br>è¿™æ ·ä¸¤ä¸¤æ–‡æ¡£å³å¯ç»„æˆä¸€ä¸ªæ–‡æ¡£å¯¹ï¼Œæˆ‘ä»¬æŠŠå‰è€…å¥½äºåè€…çš„æˆä¸ºæ­£å‘æ–‡æ¡£å¯¹ï¼›åä¹‹ç§°ä¹‹ä¸ºè´Ÿå‘æ–‡æ¡£å¯¹ã€‚æ­£å‘å¯¹è¡¨ç¤ºå‰è€…å¥½äºåè€…ï¼Œè´Ÿå‘å¯¹è¡¨ç¤ºåè€…åŠ£äºå‰è€…ã€‚å…¶å®è¡¨è¿°çš„æ˜¯åŒæ ·çš„æ„ä¹‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ­£å‘çš„å¯¹å°±å¥½äº†ã€‚å› ä¸ºè´Ÿå‘å¯¹ä¸èƒ½å†é¢å¤–æä¾›æœ‰æ„ä¹‰çš„ä¿¡æ¯äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬æå–å‡ºä¸Šé¢çš„æ­£å‘å¯¹ï¼š</p>
<pre><code>Pair  ä½œå·®       ç‰¹å¾f1 ç‰¹å¾f2  ç‰¹å¾f3
P12 (doc1-doc2)    2      0       0
P13 (doc1-doc3)    2      1      -1
P14 (doc1-doc4)    2      2      -2
P23 (doc2-doc3)    0      1      -1
P24 (doc2-doc4)    0      2      -2
P34 (doc3-doc4)    0      1      -1
</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ç‰¹å¾ä¹Ÿè¿›è¡Œäº†ç›¸å‡ï¼</p>
<p>æˆ‘ä»¬å†å¼•å…¥ä¸€ä¸ªæ–‡æ¡£å¯¹æ¦‚ç‡ï¼Œè¡¨ç¤ºæ–‡æ¡£iå¥½äºæ–‡æ¡£jçš„æ¦‚ç‡ã€‚æˆ‘ä»¬å°†å®ƒç§°ä¸ºä¸¤è€…çš„ååºæ¦‚ç‡ï¼š(è¿™ä¸ªä¸œè¥¿æˆ‘ç†è§£ä¸ºæ˜¯å°†ååºå…³ç³»è½¬åŒ–ä¸ºæ¦‚ç‡çš„å‡½æ•°ï¼Œç±»ä¼¼äºlré‡Œé¢çš„sigmodå‡½æ•°)<br><img src="https://i.loli.net/2017/09/25/59c8db05e3ddb.png" alt=""> </p>
<p>é‚£ä¹ˆï¼Œç°åœ¨è¿™ä¸ªé—®é¢˜å°±è½¬åŒ–æˆäº†ä½¿æ‰€æœ‰æ­£å‘å¯¹çš„æ¦‚ç‡å’Œæœ€å¤§ã€‚æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“äº†ç›®æ ‡å‡½æ•°ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±éœ€è¦ä¸€ä¸ªæŸå¤±å‡½æ•°æ¥å°†è¿™ä¸ªç›®æ ‡å‡½æ•°æœ€ä¼˜åŒ–ã€‚<br>å†å°†ä»¥ä¸Šçš„äº¤å‰ç†µå®šä¹‰ä¸ºæŸå¤±å‡½æ•°ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8db19cd5b2.png" alt=""><br>ç„¶åå¯¹è¿™ä¸ªæŸå¤±å‡½æ•°è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8db276ebc2.png" alt=""><br>åœ¨ä»¥ä¸Šçš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†ååºå…³ç³»è½¬åŒ–ä¸ºç›®æ ‡å‡½æ•°ï¼Œç„¶åå†å®šä¹‰ç›®æ ‡å‡½æ•°çš„æŸå¤±å‡½æ•°ï¼Œå†é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ±‚å‚æ•°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°ï¼Œå¾—åˆ°ç›®æ ‡å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ç›´æ¥å®šä¹‰æ¢¯åº¦å‘¢ï¼Ÿ</p>
<p><strong>LambdaRank</strong></p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://blog.csdn.net/huagong_adu/article/details/40710305" target="_blank" rel="external">Learning To Rankä¹‹LambdaMARTçš„å‰ä¸–ä»Šç”Ÿ</a>å¯¹ä¸‹é¢è¿™ä¸ªå›¾æœ‰éå¸¸è¯¦ç»†çš„è§£é‡Šã€‚æ­¤å¤„å¯¹ä¸€äº›é‡ç‚¹å†…å®¹è¿›è¡Œæ‘˜å½•ã€‚<br><img src="https://ooo.0o0.ooo/2017/09/25/59c8db4cb37ec.png" alt=""><br>å¦‚å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªçº¿æ¡è¡¨ç¤ºæ–‡æ¡£ï¼Œè“è‰²è¡¨ç¤ºç›¸å…³æ–‡æ¡£ï¼Œç°è‰²è¡¨ç¤ºä¸ç›¸å…³æ–‡æ¡£ã€‚<br>RankNetä»¥pairwise errorçš„æ–¹å¼è®¡ç®—costï¼Œå·¦å›¾çš„costä¸º13ï¼Œå³å›¾é€šè¿‡æŠŠç¬¬ä¸€ä¸ªç›¸å…³æ–‡æ¡£ä¸‹è°ƒ3ä¸ªä½ç½®ï¼Œç¬¬äºŒä¸ªæ–‡æ¡£ä¸Šæ¡5ä¸ªä½ç½®ï¼Œå°†costé™ä¸º11ï¼Œä½†æ˜¯åƒNDCGæˆ–è€…ERRç­‰è¯„ä»·æŒ‡æ ‡åªå…³æ³¨top kä¸ªç»“æœçš„æ’åºï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ä¸‹è°ƒå‰é¢ç›¸å…³æ–‡æ¡£çš„ä½ç½®ä¸æ˜¯æˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„ç»“æœã€‚å›¾ 1å³å›¾å·¦è¾¹é»‘è‰²çš„ç®­å¤´è¡¨ç¤ºRankNetä¸‹ä¸€è½®çš„è°ƒåºæ–¹å‘å’Œå¼ºåº¦ï¼Œä½†æˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯å³è¾¹çº¢è‰²ç®­å¤´ä»£è¡¨çš„æ–¹å‘å’Œå¼ºåº¦ï¼Œå³æ›´å…³æ³¨é å‰ä½ç½®çš„ç›¸å…³æ–‡æ¡£çš„æ’åºä½ç½®çš„æå‡ã€‚</p>
<p>LambdaRankæ­£æ˜¯åŸºäºè¿™ä¸ªæ€æƒ³æ¼”åŒ–è€Œæ¥ï¼Œå…¶ä¸­LambdaæŒ‡çš„å°±æ˜¯çº¢è‰²ç®­å¤´ï¼Œä»£è¡¨ä¸‹ä¸€æ¬¡è¿­ä»£ä¼˜åŒ–çš„æ–¹å‘å’Œå¼ºåº¦ï¼Œä¹Ÿå°±æ˜¯æ¢¯åº¦ã€‚<br>å—LambdaNetçš„å¯å‘ï¼ŒLambdaRankå¯¹RankNetçš„æ¢¯åº¦åšå› å¼åˆ†è§£ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8db76c9652.png" alt=""><br>æ³¨æ„æœ‰ä¸‹é¢å¯¹ç§°æ€§<br><img src="https://i.loli.net/2017/09/25/59c8db85eb3f3.png" alt=""><br><img src="https://i.loli.net/2017/09/25/59c8db9255992.png" alt=""><br>ä¹Ÿå°±æ˜¯è¯´ï¼š<strong>æ¯æ¡æ–‡æ¡£ç§»åŠ¨çš„æ–¹å‘å’Œè¶‹åŠ¿å–å†³äºå…¶ä»–æ‰€æœ‰ä¸ä¹‹ label ä¸åŒçš„æ–‡æ¡£</strong>ã€‚<br>ç°åœ¨å›è¿‡å¤´æ¥çœ‹ï¼Œçœ‹çœ‹æˆ‘ä»¬åšäº†äº›ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>åˆ†æäº†æ¢¯åº¦çš„ç‰©ç†æ„ä¹‰ï¼›</li>
<li>ç»•å¼€æŸå¤±å‡½æ•°ï¼Œç›´æ¥å®šä¹‰æ¢¯åº¦ã€‚<br>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åæ¨ä¸€ä¸‹ LambdaRank çš„æŸå¤±å‡½æ•°ï¼š<br><img src="https://i.loli.net/2017/09/25/59c8dbaf0603f.png" alt=""> </li>
</ul>
<p><strong>LambdaMART</strong><br>ç°åœ¨çš„æƒ…å†µå˜æˆäº†è¿™æ ·ï¼š</p>
<ul>
<li>MART æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œç¼ºä¸€ä¸ªã€Œæ¢¯åº¦ã€ï¼›</li>
<li>LambdaRank å®šä¹‰äº†ä¸€ä¸ªã€Œæ¢¯åº¦ã€ã€‚<br>äºæ˜¯ï¼Œå°±æœ‰äº† LambdaMARTï¼š<br><img src="https://i.loli.net/2017/09/25/59c8dbc928934.png" alt=""> </li>
</ul>
<h1 id="Xgboostä¸­çš„Learning-to-rank">5. Xgboostä¸­çš„Learning to rank</h1><p>ä¸ºäº†åç»­æ–¹ä¾¿åç»­å°ä¼™ä¼´ä»¬çš„ä½¿ç”¨ï¼Œæˆ‘å°†å®˜æ–¹æ–‡æ¡£<a href="https://github.com/dmlc/xgboost/tree/master/demo/rank" target="_blank" rel="external">xgboostçš„learning to rankæ–‡æ¡£</a>è¿›è¡Œæ‰¼è¦çš„ç¿»è¯‘ï¼Œå¹¶åœ¨æ­¤è´´å‡ºã€‚<br>Xgboostçš„rankæ¨¡å‹æ˜¯åŸºäºlambdaRankçš„ã€‚<br>XGBoostæ”¯æŒä»¥rankingä¸ºç›®æ ‡çš„å­¦ä¹ ã€‚åœ¨rankingçš„æƒ…å†µä¸‹ï¼Œæ•°æ®é›†ä¸€èˆ¬éƒ½éœ€è¦è¢«æ ¼å¼åŒ–ä¸ºgroup inputï¼š<br>åœ¨rankingä¸­ï¼Œæ•°æ®æ˜¯æ ¹æ®ä¸åŒçš„çœŸå®åœºæ™¯è¢«åˆ†ä¸ºgroupsçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨å­¦ä¹ web pagesçš„rankåœºæ™¯ä¸‹ï¼Œrank pageæ•°æ®æ˜¯æ ¹æ®ä¸åŒçš„queriesåˆ†åˆ°å„groupsçš„ã€‚</p>
<p><strong>æ•°æ®å½¢å¼</strong><br><strong>åŸºæœ¬æ•°æ®å½¢å¼train.txt</strong><br>Xgboostæ¥å—åƒlibSVMæ ¼å¼æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code>1 101:1.2 102:0.03
0 1:2.1 10001:300 10002:400
0 0:1.3 1:0.3
1 0:0.01 1:0.3
0 0:0.2 1:0.3
</code></pre><p>æ¯è¡Œè¡¨ç¤ºï¼š</p>
<pre><code>label   ç‰¹å¾1ç´¢å¼•:å€¼ ç‰¹å¾2ç´¢å¼•:å€¼
</code></pre><p><strong>groupsç´¢å¼•æ–‡ä»¶train.txt.group</strong><br>é™¤äº†group input format,XGboostéœ€è¦ä¸€ä¸ªç´¢å¼•groupä¿¡æ¯çš„æ–‡ä»¶ï¼Œç´¢å¼•æ–‡ä»¶train.txt.groupæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>2
3
</code></pre><p>è¿™æ„å‘³ç€ï¼Œæ•°æ®é›†åŒ…å«5ä¸ªå®ä¾‹ï¼Œå‰ä¸¤ä¸ªæ˜¯ä¸€ä¸ªgroupï¼Œåä¸‰ä¸ªæ˜¯ä¸€ä¸ªgroupã€‚</p>
<p><strong>å®ä¾‹æƒé‡æ–‡ä»¶train.txt.weight</strong></p>
<p>XGboostè¿˜æ”¯æŒæ¯ä¸ªå®ä¾‹çš„æƒé‡è°ƒæ•´ï¼Œæ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>1
0.5
0.5
1
0.5
</code></pre><p><strong>åˆå§‹marginæ–‡ä»¶train.txt.base_margin</strong></p>
<p>XGBoostè¿˜å¯ä»¥æ”¯æŒæ¯ä¸ªå®ä¾‹çš„åˆå§‹åŒ–margin prediction.ä¾‹å¦‚æˆ‘ä»¬å¯¹train.txtå¯ä»¥æœ‰ä¸€ä¸ªinitial margin file:</p>
<pre><code>-0.4
1.0
3.4
</code></pre><p>XGBoost will take these values as initial margin prediction and boost from that. An important note about base_margin is that it should be margin prediction before transformation, so if you are doing logistic loss, you will need to put in value before logistic transformation. If you are using XGBoost predictor, use pred_margin=1 to output margin values.</p>
<p><strong>ä½¿ç”¨Demo:</strong></p>
<p><a href="https://github.com/stegben/kaggle_outbrain/blob/990f5e1cc18ff0f6156a56b9d919ac0d52222268/train_xgb.py" target="_blank" rel="external">https://github.com/stegben/kaggle_outbrain/blob/990f5e1cc18ff0f6156a56b9d919ac0d52222268/train_xgb.py</a></p>
<p><strong>xgboostçš„pairwiseRankå®ç°</strong></p>
<p><strong>**å¦‚ä½•æ„é€ pairå¯¹ï¼Ÿ</strong><br>xgboost/src/objective/rank_obj.cc,75è¡Œå¼€å§‹æ„é€ pairå¯¹ã€‚å¦‚ä¸Šç†è®ºæ‰€è¯´ï¼Œæ¯æ¡æ–‡æ¡£ç§»åŠ¨çš„æ–¹å‘å’Œè¶‹åŠ¿å–å†³äºå…¶ä»–æ‰€æœ‰ä¸ä¹‹ label ä¸åŒçš„æ–‡æ¡£ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦æ„é€ ä¸åŒlabelçš„â€œæ­£å‘æ–‡æ¡£å¯¹â€ã€‚å…¶æ–¹æ³•ä¸»è¦ä¸º:éå†æ‰€æœ‰çš„æ ·æœ¬ï¼Œä»ä¸æœ¬æ ·æœ¬labelä¸åŒçš„å…¶ä»–labelæ¡¶ä¸­ï¼Œä»»æ„å–ä¸€ä¸ªæ ·æœ¬ï¼Œæ„é€ æˆæ­£æ ·æœ¬ï¼›<br><strong>**å¦‚ä½•å®šä¹‰æ¢¯åº¦ï¼Ÿ</strong><br>xgboost/src/objective/rank_obj.ccä¸­ï¼Œå†™åˆ°äº†å®ƒæ˜¯ä½¿ç”¨lambdaWeight.<br>ç„¶åå°†æ¢¯åº¦å’Œæ–‡æ¡£å¯¹è¾“å…¥GBDTè®­ç»ƒå³å¯ã€‚<br><strong>**è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>æ ¹æ®labdaMartåŸç†ï¼Œè¾“å‡ºæ˜¯æ¨¡å‹å¯¹æ¯ä¸ªæ–‡æ¡£çš„æ‰“åˆ†ã€‚</p>
<p>#ã€€å‚è€ƒæ–‡çŒ®</p>
<p><a href="http://www.cnblogs.com/kemaswill/p/3241963.html" target="_blank" rel="external">Learning to Rankä¹‹Ranking SVM ç®€ä»‹</a><br><a href="http://www.tuicool.com/articles/yAfiQ3r" target="_blank" rel="external">GBRank:ä¸€ç§åŸºäºå›å½’çš„å­¦ä¹ æ’åºç®—æ³•</a><br><a href="http://mlnote.com/2016/09/18/gbRank-logsitRank-from-up-to-bottom/" target="_blank" rel="external">gbRank &amp; logsitcRankè‡ªé¡¶å‘ä¸‹</a></p>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ ç®—æ³•-ç¥ç»ç½‘ç»œ]]></title>
      <url>/2017/09/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å´æ©è¾¾è€å¸ˆçš„è¯¾ç¨‹æ€»ç»“ã€‚ä¸»è¦å‚è€ƒäº†<a href="http://blog.csdn.net/koala_tree" target="_blank" rel="external">å¤§æ ‘å…ˆç”Ÿ</a>å’Œ<a href="http://www.bijishequ.com/authorarticle.html?author=PilgrimHui#" target="_blank" rel="external">PilgrimHui</a> çš„ç¬”è®°ã€‚å¦‚æœ‰ä¸å½“ä¹‹å¤„ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºã€‚</p>
<p>æœ¬è¯¾ç¨‹é™„å¸¦ç¼–ç¨‹ä½œä¸šã€‚æœ¬æ–‡çš„ç¼–ç¨‹ä½œä¸šæœ‰ï¼š</p>
<ol>
<li><p>å®ç°æµ…å±‚ç¥ç»ç½‘ç»œ ï¼š<a href="/2017/12/05/æ·±åº¦å­¦ä¹ å®è·µ-1-3-æ„å»ºæµ…å±‚ç¥ç»ç½‘ç»œ/" title="æ·±åº¦å­¦ä¹ å®è·µ-1-3-æ„å»ºæµ…å±‚ç¥ç»ç½‘ç»œ">æ·±åº¦å­¦ä¹ å®è·µ-1-3-æ„å»ºæµ…å±‚ç¥ç»ç½‘ç»œ</a></p>
</li>
<li><p>å®ç°æ·±å±‚ç¥ç»ç½‘ç»œï¼š <a href="/2017/12/10/æ·±åº¦å­¦ä¹ å®è·µ-1-4-1-æ„å»ºæ·±å±‚ç¥ç»ç½‘ç»œ/" title="æ·±åº¦å­¦ä¹ å®è·µ-1-4-1-æ„å»ºæ·±å±‚ç¥ç»ç½‘ç»œ">æ·±åº¦å­¦ä¹ å®è·µ-1-4-1-æ„å»ºæ·±å±‚ç¥ç»ç½‘ç»œ</a></p>
</li>
<li><p>ç”¨ç¥ç»ç½‘ç»œåšçŒ«è„¸è¯†åˆ«ï¼š<a href="/2017/12/10/æ·±åº¦å­¦ä¹ å®è·µ-1-4-2-ç”¨ç¥ç»ç½‘ç»œè¯†åˆ«çŒ«/" title="æ·±åº¦å­¦ä¹ å®è·µ-1-4-2-ç”¨ç¥ç»ç½‘ç»œè¯†åˆ«çŒ«">æ·±åº¦å­¦ä¹ å®è·µ-1-4-2-ç”¨ç¥ç»ç½‘ç»œè¯†åˆ«çŒ«</a></p>
</li>
<li><p>å¾…ç»­</p>
</li>
</ol>
<h1 id="ç¥ç»ç½‘ç»œæ¦‚å¿µ">1. ç¥ç»ç½‘ç»œæ¦‚å¿µ</h1><p>æ‰€è°“ç¥ç»ç½‘ç»œå°±æ˜¯å°†è®¸å¤šä¸ªå•ä¸€â€œç¥ç»å…ƒâ€è”ç»“åœ¨ä¸€èµ·ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªâ€œç¥ç»å…ƒâ€çš„è¾“å‡ºå°±å¯ä»¥æ˜¯å¦ä¸€ä¸ªâ€œç¥ç»å…ƒâ€çš„è¾“å…¥ã€‚ç¥ç»ç½‘ç»œå°±æ˜¯æŒ‰ç…§ä¸€å®šè§„åˆ™å°†å¤šä¸ªç¥ç»å…ƒè¿æ¥èµ·æ¥çš„ç½‘ç»œã€‚</p>
<p><img src="https://i.loli.net/2017/09/05/59aea656bf8da.png" alt=""><br>æˆ‘ä»¬ä½¿ç”¨åœ†åœˆæ¥è¡¨ç¤ºç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œæ ‡ä¸Šâ€œ+1â€çš„åœ†åœˆè¢«ç§°ä¸º<strong>åç½®èŠ‚ç‚¹</strong>ï¼Œä¹Ÿå°±æ˜¯æˆªè·é¡¹ã€‚ç¥ç»ç½‘ç»œæœ€å·¦è¾¹çš„ä¸€å±‚å«åš<strong>è¾“å…¥å±‚</strong>ï¼Œæœ€å³çš„ä¸€å±‚å«åš<strong>è¾“å‡ºå±‚</strong>ï¼ˆæœ¬ä¾‹ä¸­ï¼Œè¾“å‡ºå±‚åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ã€‚ä¸­é—´æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„ä¸€å±‚å«åš<strong>éšè—å±‚</strong>ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½åœ¨è®­ç»ƒæ ·æœ¬é›†ä¸­è§‚æµ‹åˆ°å®ƒä»¬çš„å€¼ã€‚åŒæ—¶å¯ä»¥çœ‹åˆ°ï¼Œä»¥ä¸Šç¥ç»ç½‘ç»œçš„ä¾‹å­ä¸­æœ‰3ä¸ª<strong>è¾“å…¥å•å…ƒ</strong>ï¼ˆåç½®å•å…ƒä¸è®¡åœ¨å†…ï¼‰ï¼Œ3ä¸ª<strong>éšè—å•å…ƒ</strong>åŠä¸€ä¸ª<strong>è¾“å‡ºå•å…ƒ</strong>ã€‚</p>
<p>è®°ï¼š<br>$a^{[0]} = X$ï¼Œè¡¨ç¤ºè¾“å…¥ç‰¹å¾ï¼Œä¹Ÿè¡¨ç¤ºâ€œacitive valueâ€<br>$a^{[1]}$ï¼Œè¡¨ç¤ºéšè—å±‚çš„â€œactive valueâ€<br>$a^{[2]} = y^{\text{~}}$ï¼Œè¡¨ç¤ºè¾“å‡ºå±‚</p>
<p>åˆšæ‰æåˆ°çš„æ˜¯ä¸€ç§æœ€ç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå«<strong>æ·±åº¦å‰é¦ˆ(feedforword)ç½‘ç»œ</strong>ï¼Œåˆç§°å‰é¦ˆç¥ç»ç½‘ç»œã€å¤šå±‚æ„ŸçŸ¥æœºï¼Œæ˜¯å…¸å‹çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚</p>
<p>å‰é¦ˆç½‘ç»œçš„ç›®æ ‡æ˜¯è¿‘ä¼¼æŸä¸ªå‡½æ•°$f^*(x)$,å°†è¾“å…¥$x$æ˜ å°„åˆ°è¾“å‡º$y$ã€‚</p>
<p>è€Œæ˜ å°„$ f(x;\theta)$ï¼Œå¹¶ä¸”å­¦ä¹ å‚æ•°$\theta$çš„å€¼ï¼Œä½¿å®ƒèƒ½å¤Ÿå¾—åˆ°æœ€ä½³å‡½æ•°$f^*(x) $çš„è¿‘ä¼¼ã€‚</p>
<p>å‰é¦ˆæ˜¯å› ä¸ºæ²¡æœ‰åé¦ˆè¿æ¥ã€‚å¦‚æœæœ‰åé¦ˆçš„è¯ï¼Œå«å¾ªç¯(recurrent)ç¥ç»ç½‘ç»œã€‚</p>
<p>å…¨è¿æ¥ï¼šç¬¬Nå±‚çš„æ¯ä¸ªç¥ç»å•å…ƒå’Œç¬¬N-1å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿ã€‚</p>
<a id="more"></a>
<h1 id="æµ…å±‚ç¥ç»ç½‘ç»œ">2. æµ…å±‚ç¥ç»ç½‘ç»œ</h1><p>ä¸Šé¢ç®€å•åœ°ä»‹ç»äº†ç¥ç»ç½‘ç»œçš„æ„é€ ã€‚æˆ‘ä»¬é¦–å…ˆä»æµ…å±‚ç¥ç»ç½‘ç»œå¼€å§‹çœ‹èµ·ï¼Œçœ‹çœ‹å¦‚ä½•é€šè¿‡æ ·æœ¬å­¦ä¹ åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åç”¨è¿™ä¸ªæ¨¡å‹å¯¹æ–°çš„æ ·æœ¬è¿›è¡Œé¢„æµ‹ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li><p>å¦‚ä½•é€šè¿‡x+æ¨¡å‹ â€“&gt; è®¡ç®—yâ€™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">---------------------------------------</div><div class="line">  --&gt; |	          |</div><div class="line">x --&gt; |	ç¥ç»ç½‘ç»œ   | ---&gt; å¾—åˆ°é¢„æµ‹çš„y&apos;</div><div class="line">  --&gt; |	          |</div><div class="line">---------------------------------------</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚ä½•é€šè¿‡x + y â€“&gt; è®¡ç®—æ¨¡å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-------------------------------------------</div><div class="line">      --&gt; |	          |</div><div class="line">x + y --&gt; |	å‰å‘+åå‘  | ---&gt; å¾—åˆ°ç½‘ç»œå‚æ•°w,b</div><div class="line">      --&gt; |	          |</div><div class="line">--------------------------------------------</div></pre></td></tr></table></figure>
<p>é¦–å…ˆæˆ‘ä»¬æ¥è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•è®¡ç®—è¾“å‡ºã€‚</p>
</li>
</ol>
<h2 id="å¦‚ä½•è®¡ç®—è¾“å‡ºï¼Ÿ">2.1. å¦‚ä½•è®¡ç®—è¾“å‡ºï¼Ÿ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬å›é¡¾æœ€ç®€å•çš„LRå•å…ƒå¦‚ä½•è®¡ç®—è¾“å‡ºï¼š</p>
<ol>
<li>é¦–å…ˆè®¡ç®—$z = w^Tx+b$;</li>
<li>ä»£å…¥æ¿€æ´»å‡½æ•°è®¡ç®—$a = a(z)$</li>
<li>å¾—åˆ°é¢„æµ‹å€¼$a = y^{\text ~}$</li>
</ol>
<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ä»¥æ­¤è®¡ç®—æ¯ä¸ªç¥ç»å…ƒå³å¯ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿è¡¨ç¤ºï¼Œæˆ‘ä»¬å…ˆçº¦å®šç¬¦å·ï¼š<br>$$a_{i\text{&lt;- node index in layer}}^{[j]\text{&lt;- layer index}}$$</p>
<p>ä¸Šæ ‡æ–¹æ‹¬å·è¡¨ç¤ºå±‚æ•°ï¼›ä¸‹æ ‡è¡¨ç¤ºåœ¨æœ¬å±‚çš„ç¬¬å‡ ä¸ªnodeã€‚</p>
<p>å› æ­¤ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬è®¡ç®—ä»¥ä¸‹å³å¯ï¼š<br><img src="https://i.loli.net/2017/09/06/59afebe9849fe.png" alt=""> </p>
<p>å³ä¾æ¬¡è®¡ç®—zå’Œaå³å¯ã€‚</p>
<p>æˆ‘ä»¬å°†ä¸Šé¢çš„è®¡ç®—è¿‡ç¨‹å‘é‡åŒ–ï¼Œå¾—åˆ°ï¼š<br>$$<br>z^{[1]} =<br>\begin{bmatrix}<br>w_1^{[1]T}\\<br>w_2^{[1]T}\\<br>w_3^{[1]T} \\<br>\end{bmatrix}<br>\begin{bmatrix}<br>x_1\\<br>x_2\\<br>x_3\\<br>\end{bmatrix}<br>+\begin{bmatrix}<br>b_1^{[1]}\\<br>b_2^{[1]}\\<br>b_3^{[1]} \\<br>\end{bmatrix}<br>$$<br>$$=\begin{bmatrix}<br>w_1^{[1]T}x+b_1^{[1]}\\<br>w_2^{[1]T}x+b_2^{[1]}\\<br>w_3^{[1]T}x+b_3^{[1]} \\<br>\end{bmatrix}<br>=\begin{bmatrix}<br>z_1^{[1]}\\<br>z_2^{[1]}\\<br>z_3^{[1]} \\<br>\end{bmatrix}<br>$$</p>
<p>è€Œè¿™ä¸€å±‚å¾—åˆ°çš„è¾“å‡º$a$ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥$x$</p>
<p>å› æ­¤åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è®¡ç®—ï¼š<br><img src="https://i.loli.net/2017/09/06/59aff15c7043c.png" alt=""> </p>
<p>æˆ‘ä»¬å°†ä¸Šé¢çš„è®¡ç®—æ­¥éª¤å«ä½œ<strong>å‰å‘ä¼ æ’­</strong>ã€‚å³ï¼šç»™å®šç¬¬$l$å±‚æ¿€æ´»å€¼$a^{[l]}$ï¼Œç¬¬$l+1$å±‚çš„æ¿€æ´»å€¼$a^{[l+1]}$å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¾—åˆ°ï¼š<br>$z^{[l+1]} = w^{[l]}a^{[l]}+b^{[l]}$<br>$a^{[l+1]} =  a(z^{[l+1]})$</p>
<p><strong>å‘é‡åŒ–-åŠ é€Ÿå¤šæ ·æœ¬è®¡ç®—</strong></p>
<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°æˆ‘ä»¬çš„è¾“å‡ºæ˜¯ä¾æ¬¡è®¡ç®—çš„ã€‚å³ä»$x^{(1)}$åˆ°$x^{(m)}$</p>
<p>å‡è®¾è¾“å…¥æ ·æœ¬$X$æœ‰mä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼š<br>$x^{(1)} \text{  â€”â€”â€”-&gt;  } a^{[l]\text{(1)}} = y^{\text{~(1)}}$<br>â€¦<br>$x^{(i)} \text{  â€”â€”â€”-&gt;  } a^{[l]\text{(i)}} = y^{\text{~(i)}}$<br>â€¦<br>$x^{(m)} \text{  â€”â€”â€”-&gt;  } a^{[l]\text{(m)}} = y^{\text{~(m)}}$</p>
<p>åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å‘é‡åŒ–ï¼Œåªéœ€è¦å°†mä¸ªæ ·æœ¬æ”¾å…¥ä¸€ä¸ªå¤§çŸ©é˜µ$X$ä¸­å³å¯ã€‚æ­¤å¤„å¯¹äºæˆ‘æ¥è¯´è¾ƒå®¹æ˜“ç†è§£ï¼Œæ•…ä¸å†å¤šåŠ é˜è¿°ã€‚</p>
<p><strong>æ¿€æ´»å‡½æ•°</strong></p>
<p>å›é¡¾ä¹‹å‰çš„å†…å®¹ï¼Œæˆ‘ä»¬çš„ç½‘ç»œä¸ºï¼š</p>
<ol>
<li>è®¡ç®—$z = wx+b$</li>
<li>å°†$z$ä»£å…¥æ¿€æ´»å‡½æ•°$\sigma(z)$å¾—åˆ°é¢„æµ‹å€¼</li>
</ol>
<p>å…¶ä¸­çš„$\sigma = \frac{1}{1+e^{-z}}$å°±æ˜¯sigmodæ¿€æ´»å‡½æ•°ã€‚å½“ç„¶ä¹Ÿæœ‰å…¶å®ƒçš„æ¿€æ´»å‡½æ•°ï¼š</p>
<ol>
<li>$tanh$(åœ¨ç¥ç»ç½‘ç»œéšè—å±‚ï¼Œ$tanh$æ¯”$\sigma$è¡¨ç°æ›´ä½³)<br>$tanh(z) = \frac{e^z-e^{-z}}{e^z+e^{-z}}$<br><img src="https://i.loli.net/2017/10/15/59e3657d65b64.png" alt=""> </li>
<li>$ReLU$-ä¿®æ­£çº¿æ€§å•å…ƒï¼Œæ›´æ™®é<br>$a=max(0,z)$<br>å­¦ä¹ é€Ÿåº¦å¾ˆå¿«</li>
<li>å¸¦æ³„éœ²çš„ReLU<br>$a=max(0.0001z,z)$<br>zå°äºé›¶æ—¶ï¼Œå‡½æ•°ç¨å¾®å€¾æ–œä¸€äº›</li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°ï¼Ÿ</strong></p>
<p>ä¼šå¯¼è‡´è¾“å‡ºç»“æœå°±æ˜¯è¾“å…¥ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œå¯¼è‡´ç½‘ç»œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ã€‚</p>
<h2 id="å¦‚ä½•è®¡ç®—å‚æ•°">2.2. å¦‚ä½•è®¡ç®—å‚æ•°?</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p>
<p>å¦‚ä½•é€šè¿‡x + y â€“&gt; è®¡ç®—æ¨¡å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-------------------------------------------</div><div class="line">      --&gt; |	          |</div><div class="line">x + y --&gt; |	å‰å‘+åå‘  | ---&gt; å¾—åˆ°ç½‘ç»œå‚æ•°w,b</div><div class="line">      --&gt; |	          |</div><div class="line">--------------------------------------------</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ä¸»è¦ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼š</p>
<ol>
<li>æ­£å‘ä¼ æ’­ï¼Œé€šè¿‡ç°æœ‰çš„ç½‘ç»œè®¡ç®—è¾“å‡ºyâ€˜ï¼Œç„¶åè®¡ç®—æŸå¤±å‡½æ•°L</li>
<li>åå‘ä¼ æ’­ï¼Œé€šè¿‡æŸå¤±å‡½æ•°Lï¼Œè®¡ç®—å‚æ•°å¯¹Lçš„å¯¼æ•°dL/dwå’ŒdL/dbï¼Œç„¶åå¾—åˆ°æ–°çš„wå’Œbã€‚å›åˆ°ç¬¬1æ­¥ã€‚</li>
</ol>
<h3 id="æ­£å‘ä¼ æ’­">2.2.1. æ­£å‘ä¼ æ’­</h3><p>æˆ‘çš„ç†è§£æ˜¯ï¼šæ­£å‘ä¼ æ’­å°±æ˜¯ä»è¾“å…¥è®¡ç®—è¾“å‡ºçš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„è¿›è¡Œé¢„æµ‹ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç°åœ¨å·²ç»æœ‰äº†ä¸€ä¸ªæ¨¡å‹ï¼Œåªéœ€è¦æŠŠè¾“å…¥å–‚è¿›å»ï¼Œç„¶åå¾—åˆ°çš„è¾“å‡ºå°±æ˜¯é¢„æµ‹å€¼ã€‚</p>
<ol>
<li>$z^{[1]}=w^{[1]}x+b^{[1]}$</li>
<li>$A^{[1]}=g^{[1]}(z^{[1]})$è¯¥å±‚çš„æ¿€æ´»å‡½æ•°</li>
<li>$z^{[2]}=w^{[2]}A^{[1]}+B^{[2]}$</li>
<li>$A^{[2]}=g^{[2]}(^{[2]})=\sigma(z^{[2]})$</li>
</ol>
<h3 id="åå‘ä¼ æ’­">2.2.2. åå‘ä¼ æ’­</h3><p>ä¸Šè¿°æ­£å‘ä¼ æ’­æ—¶æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªæ¨¡å‹ã€‚ä½†äº‹å®ä¸Šæˆ‘ä»¬åº”è¯¥æ˜¯å·²ç»æœ‰äº†ä¸€å †æ ·æœ¬æƒ³å’Œæ ·æœ¬çš„yï¼Œæˆ‘ä»¬æƒ³å»å­¦ä¹ è¿™ä¸ªæ¨¡å‹ã€‚é‚£å¦‚ä½•è¿›è¡Œæ¨¡å‹å­¦ä¹ å‘¢ï¼Ÿå°±è¦ç”¨åˆ°åå‘ä¼ æ’­æ³•ï¼Œä»å·²çŸ¥çš„è¾“å‡ºyå‡ºå‘ï¼Œç»“åˆæ¢¯åº¦ä¸‹é™ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œä½¿å¾—è¿™ä¸ªæ¨¡å‹æœ€ç¬¦åˆxçš„åˆ†å¸ƒã€‚</p>
<p>åå‘ä¼ æ’­ç®—æ³•å…¶å®æŒ‡çš„æ˜¯ç”¨äºè®¡ç®—æ¢¯åº¦çš„æ–¹æ³•ã€‚è€Œæ¢¯åº¦ä¸‹é™æ˜¯ä½¿ç”¨è¿™ä¸ªè®¡ç®—å¥½äº†çš„æ¢¯åº¦æ¥è¿›è¡Œå­¦ä¹ çš„æ–¹æ³•ã€‚</p>
<p>å…·ä½“è¿‡ç¨‹çš„<strong>æ€æƒ³ç²¾åï¼šåœ¨æ ·æœ¬é›†ä¸‹ï¼Œæƒ³è¦å¾—åˆ°å„å±‚çš„z=wx+bçš„å‚æ•°wå’Œbï¼Œä½¿å¾—æŸå¤±å‡½æ•°L(a,y)æœ€å°ã€‚ç”¨æ¢¯åº¦ä¸‹é™æ³•çš„è¯ï¼Œå°±è¦æ²¿ç€$L(a,y)$å¯¼æ•°çš„æ–¹å‘æ¥è°ƒèŠ‚wå’Œbã€‚</strong></p>
<p>å…³äºè¯¯å·®å‡½æ•°$L(a,y)$æˆ‘ä¼šåœ¨ä¹‹åçš„åšå®¢<a href="https://jiayi797.github.io/2017/10/25/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E8%AF%AF%E5%B7%AE%E5%87%BD%E6%95%B0%E6%8E%A2%E7%A9%B6/">è¯¯å·®å‡½æ•°æ¢ç©¶</a>é‡Œè¿›è¡Œå™è¿°ã€‚</p>
<p>è¦è®¡ç®—$L(a,y)$çš„å¯¼æ•°$\frac{dL(a,y)}{da}=-\frac{y}{a} + \frac{1-y}{1-a}$,é‚£ä¹ˆå°±è¦è®¡ç®—$dz=\frac{dL}{dz}$ï¼Œä»è€Œè¦è®¡ç®—$dw=\frac{dL}{dw}$å’Œ$db=\frac{dL}{db}$</p>
<ol>
<li>$dz^{[2]}=A^{[2]}-Y,Y=[y^{[1]}],y^{[2]},â€¦,y^{[m]}$</li>
<li>$dw^{[2]}=\frac{1}{m}dz^{[2]}A^{[1]T}$</li>
<li>$db^{[2]}=\frac{1}{m}sum(dz^{[2]},axis=1,keepdims=True)$</li>
<li>$dz^{[1]}=w^{[2]T}dz^{[2]} \times g^{[1]â€™}(z^{[1]})$</li>
<li>$dw^{[1]}=\frac{1}{m}dz^{[1]}X^T$</li>
<li>$db^{[1]}=\frac{1}{m}np.sum(dz^{[1]},axis=1,keepdims=True)$</li>
</ol>
<h1 id="æ·±åº¦ç¥ç»ç½‘ç»œ">3. æ·±åº¦ç¥ç»ç½‘ç»œ</h1><p>ä¸Šé¢ä»‹ç»å®Œäº†æµ…å±‚ç¥ç»ç½‘ç»œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æ·±åº¦ç¥ç»ç½‘ç»œæ˜¯æ€æ ·è®¡ç®—çš„ã€‚</p>
<h2 id="æ·±åº¦ç¥ç»ç½‘ç»œçš„å¥½å¤„">3.1. æ·±åº¦ç¥ç»ç½‘ç»œçš„å¥½å¤„</h2><p><strong>äººè„¸è¯†åˆ«å’Œè¯­éŸ³è¯†åˆ«</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-20-02-37.png" alt=""> </p>
<p>å¯¹äºäººè„¸è¯†åˆ«ï¼Œç¥ç»ç½‘ç»œçš„ç¬¬ä¸€å±‚ä»åŸå§‹å›¾ç‰‡ä¸­æå–äººè„¸çš„è½®å»“å’Œè¾¹ç¼˜ï¼Œæ¯ä¸ªç¥ç»å…ƒå­¦ä¹ åˆ°ä¸åŒè¾¹ç¼˜çš„ä¿¡æ¯ï¼›ç½‘ç»œçš„ç¬¬äºŒå±‚å°†ç¬¬ä¸€å±‚å­¦å¾—çš„è¾¹ç¼˜ä¿¡æ¯ç»„åˆèµ·æ¥ï¼Œå½¢æˆäººè„¸çš„ä¸€äº›å±€éƒ¨çš„ç‰¹å¾ï¼Œä¾‹å¦‚çœ¼ç›ã€å˜´å·´ç­‰ï¼›åé¢çš„å‡ å±‚é€æ­¥å°†ä¸Šä¸€å±‚çš„ç‰¹å¾ç»„åˆèµ·æ¥ï¼Œå½¢æˆäººè„¸çš„æ¨¡æ ·ã€‚éšç€ç¥ç»ç½‘ç»œå±‚æ•°çš„å¢åŠ ï¼Œç‰¹å¾ä¹Ÿä»åŸæ¥çš„è¾¹ç¼˜é€æ­¥æ‰©å±•ä¸ºäººè„¸çš„æ•´ä½“ï¼Œç”±æ•´ä½“åˆ°å±€éƒ¨ï¼Œç”±ç®€å•åˆ°å¤æ‚ã€‚å±‚æ•°è¶Šå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å­¦ä¹ çš„æ•ˆæœä¹Ÿå°±è¶Šç²¾ç¡®ã€‚</p>
<p>å¯¹äºè¯­éŸ³è¯†åˆ«ï¼Œç¬¬ä¸€å±‚ç¥ç»ç½‘ç»œå¯ä»¥å­¦ä¹ åˆ°è¯­è¨€å‘éŸ³çš„ä¸€äº›éŸ³è°ƒï¼Œåé¢æ›´æ·±å±‚æ¬¡çš„ç½‘ç»œå¯ä»¥æ£€æµ‹åˆ°åŸºæœ¬çš„éŸ³ç´ ï¼Œå†åˆ°å•è¯ä¿¡æ¯ï¼Œé€æ¸åŠ æ·±å¯ä»¥å­¦åˆ°çŸ­è¯­ã€å¥å­ã€‚</p>
<p>æ‰€ä»¥ä»ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºéšç€ç¥ç»ç½‘ç»œçš„æ·±åº¦åŠ æ·±ï¼Œæ¨¡å‹èƒ½å­¦ä¹ åˆ°æ›´åŠ å¤æ‚çš„é—®é¢˜ï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ å¼ºå¤§ã€‚</p>
<p><strong>ç”µè·¯é€»è¾‘è®¡ç®—</strong></p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-20-03-13.png" alt=""> </p>
<p>å‡å®šè®¡ç®—å¼‚æˆ–é€»è¾‘è¾“å‡ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-20-03-48.png" alt=""></p>
<p>å¯¹äºè¯¥è¿ç®—ï¼Œè‹¥æœä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ¯å±‚å°†å‰ä¸€å±‚çš„ç›¸é‚»çš„ä¸¤å•å…ƒè¿›è¡Œå¼‚æˆ–ï¼Œæœ€ååˆ°ä¸€ä¸ªè¾“å‡ºï¼Œæ­¤æ—¶æ•´ä¸ªç½‘ç»œçš„å±‚æ•°ä¸ºä¸€ä¸ªæ ‘å½¢çš„å½¢çŠ¶ï¼Œç½‘ç»œçš„æ·±åº¦ä¸º <img src="http://www.zhihu.com/equation?tex=O%28%5Clog_%7B2%7D%28n%29%29" alt="O(\log_{2}(n))"> ï¼Œå…±ä½¿ç”¨çš„ç¥ç»å…ƒçš„ä¸ªæ•°ä¸ºï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-20-04-05.png" alt=""> </p>
<p>å³è¾“å…¥ä¸ªæ•°ä¸ºnï¼Œè¾“å‡ºä¸ªæ•°ä¸ºn-1ã€‚</p>
<p>ä½†æ˜¯å¦‚æœä¸é€‚ç”¨æ·±å±‚ç½‘ç»œï¼Œä»…ä»…ä½¿ç”¨å•éšå±‚çš„ç½‘ç»œï¼ˆå¦‚å³å›¾æ‰€ç¤ºï¼‰ï¼Œéœ€è¦çš„ç¥ç»å…ƒä¸ªæ•°ä¸º <img src="http://www.zhihu.com/equation?tex=2%5E%7Bn-1%7D" alt="2^{n-1}"> ä¸ª ã€‚åŒæ ·çš„é—®é¢˜ï¼Œä½†æ˜¯æ·±å±‚ç½‘ç»œè¦æ¯”æµ…å±‚ç½‘ç»œæ‰€éœ€è¦çš„ç¥ç»å…ƒä¸ªæ•°è¦å°‘å¾—å¤šã€‚</p>
<h2 id="å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­">3.2. å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-21-20-54.png" alt=""> </p>
<p>è§„å®šä»¥ä¸‹ç¬¦å·ï¼š</p>
<ul>
<li>$L$ï¼šDNNçš„å±‚æ•°</li>
<li>$n^{[l]}$ï¼šç¬¬$l$å±‚çš„åŒ…å«çš„å•å…ƒä¸ªæ•°</li>
<li>$a^{[l]}$ï¼šç¬¬$l$å±‚æ¿€æ´»å‡½æ•°çš„è¾“å‡º</li>
<li>$W^{l}$ï¼šç¬¬$l$å±‚çš„å‚æ•°</li>
<li>è¾“å…¥$x$è®°ä¸º$a^{[0]}$ã€‚è¾“å‡º$yâ€™$è®°ä¸º$a^{[L]}$</li>
</ul>
<p><strong>æ€»ä½“æ¡†æ¶</strong></p>
<p>æ·±å±‚ç½‘ç»œçš„å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-07-21-29-22.png" alt=""> </p>
<ol>
<li>è¾“å…¥X</li>
<li>é€šè¿‡ä¸€å±‚å±‚çš„è®¡ç®—$a^{[l]}=g^{[l]}(w^{[l]}\cdot a^{[l-1]}+b^{[l]})$ï¼Œå¾—åˆ°æœ€ç»ˆçš„$yâ€™$â€”â€”<strong>å‰å‘ä¼ æ’­</strong></li>
<li>é€šè¿‡$yâ€™$è®¡ç®—æŸå¤±$L(yâ€™,y)$ï¼Œè®¡ç®—å‡º$da^{[l]}$â€”â€”<strong>åå‘ä¼ æ’­1</strong></li>
<li>é€šè¿‡$da^{[l]}$è®¡ç®—$da^{[l-1]}$ï¼Œç„¶åé€šè¿‡æ¯å±‚çš„$da^{[l]}$è®¡ç®—æœ¬å±‚çš„$dw^{[l]}$å’Œ$db^{[l]}$â€”â€”<strong>åå‘ä¼ æ’­2</strong></li>
<li>ç„¶åå†è¿”å›ç¬¬2æ­¥ï¼Œè¿›è¡Œè¿­ä»£</li>
</ol>
<p><strong>å‰å‘ä¼ æ’­</strong></p>
<p>è¾“å…¥ï¼š$a^{[l-1]}$</p>
<p>è¾“å‡ºï¼š$a^{[l]}$å’Œä¸´æ—¶å˜é‡$cache(z^{[l]})$</p>
<p>è®¡ç®—ï¼š</p>
<p>$$z^{[l]}=w^{[l]}\cdot a^{[l-1]}+b^{[l]}$$</p>
<p>$$a^{[l]}=g^{[l]}(z^{[l]})$$</p>
<p><strong>åå‘ä¼ æ’­</strong></p>
<p>è¾“å…¥ï¼š$da^{[l]}$</p>
<p>è¾“å‡ºï¼š$dw^{[l]},db^{[l]},da^{[l-1]}$</p>
<p>è®¡ç®—$dz^{[l]}$ï¼š</p>
<p>$$dz^{[l]}=\frac{dL}{dz^{[l]}}=\frac{dL}{da^{[l]}}\cdot \frac{dL}{d^{[l]}}=\frac{dL}{da^{[l]}}\cdot  g^{[l]â€™}(z^{[l]}) = da^{[l]}\cdot g^{[l]â€™}(z^{[l]})$$</p>
<p>è®¡ç®—$dw^{[l]}$ï¼š</p>
<p>$$dw^{[l]}=\frac{dL}{dw^{[l]}}=\frac{dL}{dz^{[l]}}*\frac{dz^{[l]}}{dw^{[l]}}=\frac{dL}{dz^{[l]}}\cdot a^{[l-1]}=dz \cdot a^{[l-1]}$$</p>
<p>è®¡ç®—$db^{[l]}$:</p>
<p>$$db^{[l]}=\frac{dL}{db^{[l]}}=\frac{dL}{dz^{[l]}}*\frac{dz^{[l]}}{db^{[l]}}=\frac{dL}{dz^{[l]}}=dz^{[l]}$$</p>
<p>è®¡ç®—$da^{[l-1]}$:</p>
<p>$$da^{[l-1]}=\frac{dL}{da^{[l-1]}}=\frac{dL}{dz^{[l]}}\cdot \frac{dz^{[l]}}{da^{[l-1]}}=dz^{[l]}\cdot w^{[l]}$$</p>
<h1 id="æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œ">4. æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œ</h1><h2 id="è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•é›†">4.1. è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•é›†</h2><p>å¯¹äºä¸€ä¸ªéœ€è¦è§£å†³çš„é—®é¢˜çš„æ ·æœ¬æ•°æ®ï¼Œåœ¨å»ºç«‹æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†é—®é¢˜çš„<strong>data</strong>åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>è®­ç»ƒé›†</strong>ï¼ˆtrain setï¼‰ï¼šç”¨è®­ç»ƒé›†å¯¹ç®—æ³•æˆ–æ¨¡å‹è¿›è¡Œè®­ç»ƒè¿‡ç¨‹ï¼›</li>
<li><strong>éªŒè¯é›†</strong>ï¼ˆdevelopment setï¼‰ï¼šåˆ©ç”¨éªŒè¯é›†æˆ–è€…åˆç§°ä¸ºç®€å•äº¤å‰éªŒè¯é›†ï¼ˆhold-out cross validation setï¼‰è¿›è¡Œäº¤å‰éªŒè¯ï¼Œé€‰æ‹©å‡ºæœ€å¥½çš„æ¨¡å‹ï¼›</li>
<li><strong>æµ‹è¯•é›†</strong>ï¼ˆtest setï¼‰ï¼šæœ€ååˆ©ç”¨æµ‹è¯•é›†å¯¹æ¨¡å‹è¿›è¡Œæµ‹è¯•ï¼Œè·å–æ¨¡å‹è¿è¡Œçš„æ— åä¼°è®¡ã€‚</li>
</ul>
<p><strong>å°æ•°æ®æ—¶ä»£</strong></p>
<p>åœ¨å°æ•°æ®é‡çš„æ—¶ä»£ï¼Œå¦‚ï¼š100ã€1000ã€10000çš„æ•°æ®é‡å¤§å°ï¼Œå¯ä»¥å°†<strong>data</strong>åšä»¥ä¸‹åˆ’åˆ†ï¼š</p>
<ul>
<li>æ— éªŒè¯é›†çš„æƒ…å†µï¼š70% / 30%ï¼›</li>
<li>æœ‰éªŒè¯é›†çš„æƒ…å†µï¼š60% / 20% / 20%ï¼›</li>
</ul>
<p>é€šå¸¸åœ¨å°æ•°æ®é‡æ—¶ä»£ï¼Œä»¥ä¸Šæ¯”ä¾‹çš„åˆ’åˆ†æ˜¯éå¸¸åˆç†çš„ã€‚</p>
<p><strong>å¤§æ•°æ®æ—¶ä»£</strong></p>
<p>ä½†æ˜¯åœ¨å¦‚ä»Šçš„å¤§æ•°æ®æ—¶ä»£ï¼Œå¯¹äºä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ‹¥æœ‰çš„<strong>data</strong>çš„æ•°é‡å¯èƒ½æ˜¯ç™¾ä¸‡çº§åˆ«çš„ï¼Œæ‰€ä»¥éªŒè¯é›†å’Œæµ‹è¯•é›†æ‰€å çš„æ¯”é‡ä¼šè¶‹å‘äºå˜å¾—æ›´å°ã€‚</p>
<p>éªŒè¯é›†çš„ç›®çš„æ˜¯ä¸ºäº†éªŒè¯ä¸åŒçš„ç®—æ³•å“ªç§æ›´åŠ æœ‰æ•ˆï¼Œæ‰€ä»¥éªŒè¯é›†åªè¦è¶³å¤Ÿå¤§èƒ½å¤ŸéªŒè¯å¤§çº¦2-10ç§ç®—æ³•å“ªç§æ›´å¥½å°±è¶³å¤Ÿäº†ï¼Œä¸éœ€è¦ä½¿ç”¨20%çš„æ•°æ®ä½œä¸ºéªŒè¯é›†ã€‚å¦‚ç™¾ä¸‡æ•°æ®ä¸­æŠ½å–1ä¸‡çš„æ•°æ®ä½œä¸ºéªŒè¯é›†å°±å¯ä»¥äº†ã€‚</p>
<p>æµ‹è¯•é›†çš„ä¸»è¦ç›®çš„æ˜¯è¯„ä¼°æ¨¡å‹çš„æ•ˆæœï¼Œå¦‚åœ¨å•ä¸ªåˆ†ç±»å™¨ä¸­ï¼Œå¾€å¾€åœ¨ç™¾ä¸‡çº§åˆ«çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©å…¶ä¸­1000æ¡æ•°æ®è¶³ä»¥è¯„ä¼°å•ä¸ªæ¨¡å‹çš„æ•ˆæœã€‚</p>
<ul>
<li>100ä¸‡æ•°æ®é‡ï¼š98% / 1% / 1%ï¼›</li>
<li>è¶…ç™¾ä¸‡æ•°æ®é‡ï¼š99.5% / 0.25% / 0.25%ï¼ˆæˆ–è€…99.5% / 0.4% / 0.1%ï¼‰</li>
</ul>
<p><strong>Notation</strong></p>
<ul>
<li>å»ºè®®éªŒè¯é›†è¦å’Œè®­ç»ƒé›†æ¥è‡ªäºåŒä¸€ä¸ªåˆ†å¸ƒï¼Œå¯ä»¥ä½¿å¾—æœºå™¨å­¦ä¹ ç®—æ³•å˜å¾—æ›´å¿«ï¼›</li>
<li>å¦‚æœä¸éœ€è¦ç”¨æ— åä¼°è®¡æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œåˆ™å¯ä»¥ä¸éœ€è¦æµ‹è¯•é›†ã€‚</li>
</ul>
<h2 id="åå·®ã€æ–¹å·®">4.2. åå·®ã€æ–¹å·®</h2><p>å¯¹äºä¸‹å›¾ä¸­ä¸¤ä¸ªç±»åˆ«åˆ†ç±»è¾¹ç•Œçš„åˆ†å‰²ï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-16-41-05.png" alt=""> </p>
<p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>æ¬ æ‹Ÿåˆï¼ˆunderfittingï¼‰çš„æƒ…å†µä¸‹ï¼Œå‡ºç°é«˜åå·®ï¼ˆhigh biasï¼‰çš„æƒ…å†µï¼›</li>
<li>è¿‡æ‹Ÿåˆï¼ˆoverfittingï¼‰çš„æƒ…å†µä¸‹ï¼Œå‡ºç°é«˜æ–¹å·®ï¼ˆhigh varianceï¼‰çš„æƒ…å†µã€‚</li>
</ul>
<p>åœ¨bias-variance tradeoff çš„è§’åº¦æ¥è®²ï¼Œæˆ‘ä»¬åˆ©ç”¨è®­ç»ƒé›†å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒå°±æ˜¯ä¸ºäº†ä½¿å¾—æ¨¡å‹åœ¨trainé›†ä¸Šä½¿ biasï¼ˆåå·®ï¼‰ æœ€å°åŒ–ï¼Œé¿å…å‡ºç°underfittingçš„æƒ…å†µï¼›</p>
<p>ä½†æ˜¯å¦‚æœæ¨¡å‹è®¾ç½®çš„å¤ªå¤æ‚ï¼Œè™½ç„¶åœ¨trainé›†ä¸Š bias çš„å€¼éå¸¸å°ï¼Œæ¨¡å‹ç”šè‡³å¯ä»¥å°†æ‰€æœ‰çš„æ•°æ®ç‚¹æ­£ç¡®åˆ†ç±»ï¼Œä½†æ˜¯å½“å°†è®­ç»ƒå¥½çš„æ¨¡å‹åº”ç”¨åœ¨dev é›†ä¸Šçš„æ—¶å€™ï¼Œå´å‡ºç°äº†è¾ƒé«˜çš„é”™è¯¯ç‡ã€‚è¿™æ˜¯å› ä¸ºæ¨¡å‹è®¾ç½®çš„å¤ªå¤æ‚åˆ™æ²¡æœ‰æ’é™¤ä¸€äº›trainé›†æ•°æ®ä¸­çš„å™ªå£°ï¼Œä½¿å¾—æ¨¡å‹å‡ºç°overfittingçš„æƒ…å†µï¼Œåœ¨dev é›†ä¸Šå‡ºç°é«˜æ–¹å·®çš„ç°è±¡ã€‚</p>
<p>æ‰€ä»¥å¯¹äºbiaså’Œvarianceçš„æƒè¡¡é—®é¢˜ï¼Œå¯¹äºæ¨¡å‹æ¥è¯´æ˜¯ä¸€ä¸ªååˆ†é‡è¦çš„é—®é¢˜ã€‚</p>
<p>å‡å¦‚å¯¹äºä¸€ä¸ªæ•°æ®é›†ï¼Œä»¥ä¸‹å‡ ç§æ¨¡å‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>è®­ç»ƒé›†è¯¯å·®</td>
<td>1%</td>
<td>15%</td>
<td>15%</td>
<td>0.5%</td>
</tr>
<tr>
<td>éªŒè¯é›†è¯¯å·®</td>
<td>11%</td>
<td>16%</td>
<td>30%</td>
<td>1%</td>
</tr>
<tr>
<td></td>
<td>é«˜æ–¹å·®</td>
<td>é«˜åå·®</td>
<td>é«˜åå·®ã€é«˜æ–¹å·®</td>
<td>ä½åå·®ã€ä½æ–¹å·®</td>
</tr>
<tr>
<td></td>
<td>è¿‡æ‹Ÿåˆ</td>
<td>æ¬ æ‹Ÿåˆ</td>
<td>æ¬ æ‹Ÿåˆ</td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢çš„æ¨¡å‹3å‡ºç°çš„åŸå› å¯èƒ½å¦‚ä¸‹ï¼š</p>
<p>æ²¡æœ‰æ‰¾åˆ°è¾¹ç•Œçº¿ï¼ˆè“è‰²éƒ¨åˆ†ï¼‰ï¼Œä½†å´åœ¨éƒ¨åˆ†æ•°æ®ç‚¹ä¸Šå‡ºç°äº†è¿‡æ‹Ÿåˆï¼ˆç´«è‰²ï¼‰ï¼Œåˆ™ä¼šå¯¼è‡´è¿™ç§é«˜åå·®å’Œé«˜æ–¹å·®çš„æƒ…å†µã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-16-48-33.png" alt=""> </p>
<p>è™½ç„¶åœ¨è¿™é‡ŒäºŒç»´çš„æƒ…å†µä¸‹å¯èƒ½çœ‹èµ·æ¥è¾ƒä¸ºå¥‡æ€ªï¼Œå‡ºç°çš„å¯èƒ½æ€§æ¯”è¾ƒä½ï¼›ä½†æ˜¯åœ¨é«˜ç»´çš„æƒ…å†µä¸‹ï¼Œå‡ºç°è¿™ç§æƒ…å†µå°±æˆä¸ºå¯èƒ½ã€‚</p>
<p><strong>è§£å†³é«˜åå·®å’Œé«˜æ–¹å·®</strong></p>
<p>åœ¨è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œè§£å†³é«˜åå·®ï¼ˆHigh biasï¼‰å’Œé«˜æ–¹å·®ï¼ˆHigh varianceï¼‰çš„è¿‡ç¨‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-16-51-45.png" alt=""> </p>
<ul>
<li>å­˜åœ¨é«˜åå·®ï¼Ÿ<ul>
<li>å¢åŠ ç½‘ç»œç»“æ„ï¼Œå¦‚å¢åŠ éšè—å±‚æ•°ç›®ï¼›</li>
<li>è®­ç»ƒæ›´é•¿æ—¶é—´ï¼›</li>
<li>å¯»æ‰¾åˆé€‚çš„ç½‘ç»œæ¶æ„ï¼Œä½¿ç”¨æ›´å¤§çš„NNç»“æ„ï¼›</li>
</ul>
</li>
<li>å­˜åœ¨é«˜æ–¹å·®ï¼Ÿ<ul>
<li>è·å–æ›´å¤šçš„æ•°æ®ï¼›</li>
<li>æ­£åˆ™åŒ–ï¼ˆ regularizationï¼‰ï¼›</li>
<li>å¯»æ‰¾åˆé€‚çš„ç½‘ç»œç»“æ„ï¼›</li>
</ul>
</li>
</ul>
<p>åœ¨å¤§æ•°æ®æ—¶ä»£ï¼Œæ·±åº¦å­¦ä¹ å¯¹ç›‘ç£å¼å­¦ä¹ å¤§æœ‰è£¨ç›Šï¼Œä½¿å¾—æˆ‘ä»¬ä¸ç”¨åƒä»¥å‰ä¸€æ ·å¤ªè¿‡å…³æ³¨å¦‚ä½•å¹³è¡¡åå·®å’Œæ–¹å·®çš„æƒè¡¡é—®é¢˜ï¼Œé€šè¿‡ä»¥ä¸Šæ–¹æ³•å¯ä»¥ä½¿å¾—å†ä¸å¢åŠ å¦ä¸€æ–¹çš„æƒ…å†µä¸‹å‡å°‘ä¸€æ–¹çš„å€¼ã€‚</p>
<h1 id="æ­£åˆ™åŒ–">5. æ­£åˆ™åŒ–</h1><p>åˆ©ç”¨æ­£åˆ™åŒ–æ¥è§£å†³é«˜æ–¹å·®çš„é—®é¢˜ï¼Œæ­£åˆ™åŒ–æ˜¯åœ¨ Cost function ä¸­åŠ å…¥ä¸€é¡¹æ­£åˆ™åŒ–é¡¹ï¼Œæƒ©ç½šæ¨¡å‹çš„å¤æ‚åº¦ã€‚</p>
<h2 id="é€»è¾‘å›å½’çš„æ­£åˆ™åŒ–">5.1. é€»è¾‘å›å½’çš„æ­£åˆ™åŒ–</h2><p>åŠ å…¥æ­£åˆ™åŒ–é¡¹çš„ä»£ä»·å‡½æ•°ï¼š </p>
<p>$$J(w,b)=\dfrac{1}{m}\sum\limits_{i=1}^{m}l(\hat y^{(i)},y^{(i)})+æ­£åˆ™åŒ–é¡¹$$</p>
<p>å…¶ä¸­ï¼Œæ­£åˆ™åŒ–é¡¹æœ‰ï¼š</p>
<ul>
<li>L2æ­£åˆ™åŒ–ï¼š$\dfrac{\lambda}{2m}||w||_{2}^{2} = \dfrac{\lambda}{2m}\sum\limits_{j=1}^{n_{x}} w_{j}^{2}=\dfrac{\lambda}{2m}w^{T}w$</li>
<li>L1æ­£åˆ™åŒ–ï¼š$\dfrac{\lambda}{2m}||w||_{1}=\dfrac{\lambda}{2m}\sum\limits_{j=1}^{n_{x}}|w_{j}|$</li>
</ul>
<p>å…¶ä¸­ï¼Œ$\lambda$æ˜¯æ­£åˆ™åŒ–å› å­</p>
<h2 id="ç¥ç»ç½‘ç»œçš„æ­£åˆ™åŒ–">5.2. ç¥ç»ç½‘ç»œçš„æ­£åˆ™åŒ–</h2><p>åŠ å…¥æ­£åˆ™åŒ–é¡¹çš„ä»£ä»·å‡½æ•°ï¼š </p>
<p>$$J(w^{[1]},b^{[1]},\cdots,w^{[L]},b^{[L]})=\dfrac{1}{m}\sum\limits_{i=1}^{m}l(\hat y^{(i)},y^{(i)})+\dfrac{\lambda}{2m}\sum\limits_{l=1}^{L}||w^{[l]}||_{F}^{2}$$</p>
<p>å…¶ä¸­ï¼Œ$||w^{[l]}||_{F}^{2}=\sum\limits_{i=1}^{n^{[l-1]}}\sum\limits_{j=1}^{n^{[l]}}(w_{ij}^{[l]})^{2}$ã€‚è€Œå› ä¸º$w$çš„å¤§å°ä¸º$(n^{[l-1]},n^{[l]})$ï¼Œå› æ­¤è¯¥çŸ©é˜µèŒƒæ•°è¢«ç§°ä¸ºâ€œFrobenus normâ€ã€‚</p>
<p><strong>æƒé‡è¡°å‡</strong></p>
<p>åœ¨åŠ å…¥æ­£åˆ™åŒ–é¡¹åï¼Œæ¢¯åº¦å˜ä¸ºï¼š</p>
<p>$$\frac{dL}{dW^{[l]}} = dW^{[l]} = (form_backprop)+\dfrac{\lambda}{m}W^{[l]}$$</p>
<p>å› æ­¤æ¢¯åº¦æ›´æ–°å…¬å¼å˜ä¸ºï¼š</p>
<p>$$W^{[l]}:= W^{[l]}-\alpha dW^{[l]}\\= W^{[l]}-\alpha [ (form_backprop)+\dfrac{\lambda}{m}W^{[l]}]\ = W^{[l]}-\alpha\dfrac{\lambda}{m}W^{[l]} -\alpha(form_backprop)\\=(1-\dfrac{\alpha\lambda}{m})W^{[l]}-\alpha(form_backprop)$$</p>
<p>å…¶ä¸­ï¼Œ$(1-\dfrac{\alpha\lambda}{m}) &lt; 1$ï¼Œå› æ­¤ä¼šç»™åŸæ¥çš„$W^{[l]}$å¸¦æ¥ä¸€ä¸ªè¡°å‡çš„å‚æ•°ã€‚å› æ­¤L2èŒƒæ•°æ­£åˆ™åŒ–åˆè¢«ç§°ä¸ºâ€œæƒé‡è¡°å‡(weight decay)â€ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–å¯ä»¥å‡å°è¿‡æ‹Ÿåˆ">5.3. ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–å¯ä»¥å‡å°è¿‡æ‹Ÿåˆ</h2><p>å‡è®¾ä¸‹å›¾çš„ç¥ç»ç½‘ç»œç»“æ„å±äºè¿‡æ‹ŸåˆçŠ¶æ€ï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-10-25.png" alt=""> </p>
<p>å¯¹äºç¥ç»ç½‘ç»œçš„Cost functionï¼š </p>
<p>$$J(w^{[1]},b^{[1]},\cdots,w^{[L]},b^{[L]})=\dfrac{1}{m}\sum\limits_{i=1}^{m}l(\hat y^{(i)},y^{(i)})+\dfrac{\lambda}{2m}\sum\limits_{l=1}^{L}||w^{[l]}||_{F}^{2}$$</p>
<p><strong>ç›´è§‚è§£é‡Š</strong></p>
<p>åŠ å…¥æ­£åˆ™åŒ–é¡¹ï¼Œç›´è§‚ä¸Šç†è§£ï¼Œæ­£åˆ™åŒ–å› å­Î»è®¾ç½®çš„è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä½¿ä»£ä»·å‡½æ•°æœ€å°åŒ–ï¼Œæƒé‡çŸ©é˜µWå°±ä¼šè¢«è®¾ç½®ä¸ºæ¥è¿‘äº0çš„å€¼ã€‚åˆ™ç›¸å½“äºæ¶ˆé™¤äº†å¾ˆå¤šç¥ç»å…ƒçš„å½±å“ï¼Œé‚£ä¹ˆå›¾ä¸­çš„å¤§çš„ç¥ç»ç½‘ç»œå°±ä¼šå˜æˆä¸€ä¸ªè¾ƒå°çš„ç½‘ç»œã€‚</p>
<p>å½“ç„¶ä¸Šé¢è¿™ç§è§£é‡Šæ˜¯ä¸€ç§ç›´è§‚ä¸Šçš„ç†è§£ï¼Œä½†æ˜¯å®é™…ä¸Šéšè—å±‚çš„ç¥ç»å…ƒä¾ç„¶å­˜åœ¨ï¼Œä½†æ˜¯ä»–ä»¬çš„å½±å“å˜å°äº†ï¼Œä¾¿ä¸ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚</p>
<p><strong>æ•°å­¦è§£é‡Š</strong></p>
<p>å‡è®¾ç¥ç»å…ƒä¸­ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ä¸º$g(z)=tanh(z)$ï¼Œåœ¨åŠ å…¥æ­£åˆ™åŒ–é¡¹åï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-11-56.png" alt=""> </p>
<p>å½“$Î»$å¢å¤§ï¼Œå¯¼è‡´$W[l]$å‡å°ï¼Œ$Z^{[l]}=W^{[l]}a^{[l-1]}+b^{[l]}$ä¾¿ä¼šå‡å°ï¼Œç”±ä¸Šå›¾å¯çŸ¥ï¼Œåœ¨zè¾ƒå°çš„åŒºåŸŸé‡Œï¼Œ$tanh(z)$å‡½æ•°è¿‘ä¼¼çº¿æ€§ï¼Œæ‰€ä»¥æ¯å±‚çš„å‡½æ•°å°±è¿‘ä¼¼çº¿æ€§å‡½æ•°ï¼Œæ•´ä¸ªç½‘ç»œå°±æˆä¸ºä¸€ä¸ªç®€å•çš„è¿‘ä¼¼çº¿æ€§çš„ç½‘ç»œï¼Œä»è€Œä¸ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆã€‚</p>
<h2 id="Dropoutæ­£åˆ™åŒ–">5.4. Dropoutæ­£åˆ™åŒ–</h2><p>Dropoutï¼ˆéšæœºå¤±æ´»ï¼‰å°±æ˜¯åœ¨ç¥ç»ç½‘ç»œçš„Dropoutå±‚ï¼Œä¸ºæ¯ä¸ªç¥ç»å…ƒç»“ç‚¹è®¾ç½®ä¸€ä¸ªéšæœºæ¶ˆé™¤çš„æ¦‚ç‡ï¼Œå¯¹äºä¿ç•™ä¸‹æ¥çš„ç¥ç»å…ƒï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªèŠ‚ç‚¹è¾ƒå°‘ï¼Œè§„æ¨¡è¾ƒå°çš„ç½‘ç»œè¿›è¡Œè®­ç»ƒã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-14-04.png" alt=""> </p>
<p><strong>å®ç°æ–¹æ³•ï¼šåå‘éšæœºæ¿€æ´»ï¼ˆinverted dropoutï¼‰</strong></p>
<p>å‡è®¾å¯¹ layer 3 è¿›è¡Œdropoutï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">keep_prob = <span class="number">0.8</span>  <span class="comment"># è®¾ç½®ç¥ç»å…ƒä¿ç•™æ¦‚ç‡</span></div><div class="line">d3 = np.random.rand(a3.shape[<span class="number">0</span>], a3.shape[<span class="number">1</span>]) &lt; keep_prob</div><div class="line">a3 = np.multiply(a3, d3)</div><div class="line">a3 /= keep_prob</div></pre></td></tr></table></figure>
<p>ä¾ç…§ä¾‹å­ä¸­çš„<code>keep_prob = 0.8</code> ï¼Œé‚£ä¹ˆå°±æœ‰å¤§çº¦20%çš„ç¥ç»å…ƒè¢«åˆ é™¤äº†ï¼Œä¹Ÿå°±æ˜¯è¯´$a[3]$ä¸­æœ‰20%çš„å…ƒç´ è¢«å½’é›¶äº†ï¼Œåœ¨ä¸‹ä¸€å±‚çš„è®¡ç®—ä¸­æœ‰$Z^{[4]}=W^{[4]}\cdot a^{[3]}+b^{[4]}$ï¼Œæ‰€ä»¥ä¸ºäº†ä¸å½±å“Z[4]çš„æœŸæœ›å€¼ï¼Œæ‰€ä»¥éœ€è¦$W^{[4]}\cdot a^{[3]}$çš„éƒ¨åˆ†é™¤ä»¥ä¸€ä¸ªkeep_probã€‚</p>
<p>Notationï¼šåœ¨æµ‹è¯•é˜¶æ®µä¸è¦ç”¨dropoutï¼Œå› ä¸ºé‚£æ ·ä¼šä½¿å¾—é¢„æµ‹ç»“æœå˜å¾—éšæœºã€‚</p>
<p><strong>ç¼ºç‚¹</strong></p>
<p>dropoutçš„ä¸€å¤§ç¼ºç‚¹å°±æ˜¯å…¶ä½¿å¾— Cost functionä¸èƒ½å†è¢«æ˜ç¡®çš„å®šä¹‰ï¼Œå› ä¸ºæ¯æ¬¡è¿­ä»£éƒ½ä¼šéšæœºæ¶ˆé™¤ä¸€äº›ç¥ç»å…ƒç»“ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç»˜åˆ¶å‡ºæ¯æ¬¡è¿­ä»£J(W,b)ä¸‹é™çš„å›¾ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-21-05.png" alt=""> </p>
<p><strong>ä½¿ç”¨Dropoutï¼š</strong></p>
<ul>
<li>å…³é—­dropoutåŠŸèƒ½ï¼Œå³è®¾ç½® keep_prob = 1.0ï¼›</li>
<li>è¿è¡Œä»£ç ï¼Œç¡®ä¿$J(Wï¼Œb)$å‡½æ•°å•è°ƒé€’å‡ï¼›</li>
<li>å†æ‰“å¼€dropoutå‡½æ•°ã€‚</li>
</ul>
<h2 id="å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•">5.5. å…¶å®ƒæ­£åˆ™åŒ–æ–¹æ³•</h2><ul>
<li><p>æ•°æ®æ‰©å¢ï¼ˆData augmentationï¼‰ï¼šé€šè¿‡å›¾ç‰‡çš„ä¸€äº›å˜æ¢ï¼Œå¾—åˆ°æ›´å¤šçš„è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼› </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-22-46.png" alt=""> </p>
</li>
<li><p>Early stoppingï¼šåœ¨äº¤å‰éªŒè¯é›†çš„è¯¯å·®ä¸Šå‡ä¹‹å‰çš„ç‚¹åœæ­¢è¿­ä»£ï¼Œé¿å…è¿‡æ‹Ÿåˆã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯æ— æ³•åŒæ—¶è§£å†³biaså’Œvarianceä¹‹é—´çš„æœ€ä¼˜ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-23-08.png" alt="">  </p>
</li>
</ul>
<h1 id="å½’ä¸€åŒ–è¾“å…¥">6. å½’ä¸€åŒ–è¾“å…¥</h1><p>å¯¹æ•°æ®é›†ç‰¹å¾x1,x2å½’ä¸€åŒ–çš„è¿‡ç¨‹ï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-26-15.png" alt=""> </p>
<ul>
<li>è®¡ç®—æ¯ä¸ªç‰¹å¾æ‰€æœ‰æ ·æœ¬æ•°æ®çš„å‡å€¼ï¼š$\mu = \dfrac{1}{m}\sum\limits_{i=1}^{m}x^{(i)}$</li>
<li>å‡å»å‡å€¼å¾—åˆ°å¯¹ç§°çš„åˆ†å¸ƒ$x : =x-\mu$</li>
<li>å½’ä¸€åŒ–æ–¹å·® : $\sigma^{2} = \dfrac{1}{m}\sum\limits_{i=1}^{m}x^{(i)^{2}},x = x/\sigma^{2}$</li>
</ul>
<p><strong>ä½¿ç”¨å½’ä¸€åŒ–çš„åŸå› </strong>ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-33-01.png" alt=""> </p>
<p>ç”±å›¾å¯ä»¥çœ‹å‡ºä¸ä½¿ç”¨å½’ä¸€åŒ–å’Œä½¿ç”¨å½’ä¸€åŒ–å‰åCost function çš„å‡½æ•°å½¢çŠ¶ä¼šæœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚</p>
<p>åœ¨ä¸ä½¿ç”¨å½’ä¸€åŒ–çš„ä»£ä»·å‡½æ•°ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æˆ‘ä»¬éœ€è¦å¾ˆå¤šæ¬¡è¿­ä»£æ‰èƒ½åˆ°è¾¾ä»£ä»·å‡½æ•°å…¨å±€æœ€ä¼˜è§£ï¼›å¦‚æœä½¿ç”¨äº†å½’ä¸€åŒ–ï¼Œé‚£ä¹ˆæ— è®ºä»å“ªä¸ªä½ç½®å¼€å§‹è¿­ä»£ï¼Œæˆ‘ä»¬éƒ½èƒ½ä»¥ç›¸å¯¹å¾ˆå°‘çš„è¿­ä»£æ¬¡æ•°æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚</p>
<h1 id="æ¢¯åº¦ç›¸å…³">7. æ¢¯åº¦ç›¸å…³</h1><h2 id="æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸">7.1. æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸</h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œä»¥ä¸¤ä¸ªè¾“å…¥ä¸ºä¾‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-17-56-17.png" alt=""> </p>
<p>æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å…ˆå‡å®šæ¿€æ´»å‡½æ•°$g(z) = z$ï¼Œåç½®$b = 0$ã€‚é‚£ä¹ˆç›®æ ‡è¾“å‡ºæ˜¯ï¼š</p>
<p>$\hat y = W^{[L]}W^{[L-1]}\cdots W^{[2]}W^{[1]}X$</p>
<ul>
<li>å¦‚æœ$W^{[l]}$å¤§äº1ï¼š<br>$W^{[l]}=\left[ \begin{array}{l}  1.5 &amp; 0 \ 0 &amp; 1.5\end{array} \right]$ï¼Œéšç€ä¸€å±‚å±‚çš„é€’è¿›ï¼Œæ¿€æ´»å‡½æ•°çš„å€¼å°†ä»¥æŒ‡æ•°é€’å¢ï¼›</li>
<li>å¦‚æœ$W^{[l]}$å°äº1ï¼š<br>$W^{[l]}=\left[ \begin{array}{l}  0.5 &amp; 0 \ 0 &amp; 0.5\end{array} \right]$ï¼Œéšç€ä¸€å±‚å±‚çš„é€’è¿›ï¼Œæ¿€æ´»å‡½æ•°çš„å€¼å°†ä»¥æŒ‡æ•°é€’å‡ï¼›</li>
</ul>
<p>è€Œå¯¹äºæ¢¯åº¦æ¥è¯´ï¼Œæ¢¯åº¦å‡½æ•°ä¹Ÿä¼šä»¥æŒ‡æ•°çº§é€’å¢æˆ–é€’å‡ï¼Œä¹Ÿå«åšæ¢¯åº¦çˆ†ç‚¸æˆ–æ¢¯åº¦æ¶ˆå¤±ã€‚é‚£ä¹ˆå°±ä¼šå‡ºç°å¦‚ä¸‹çš„å›¾æ‰€ç¤ºçš„æƒ…å†µï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-19-49-59.png" alt=""> </p>
<p>å½“å‚æ•°æ¥è¿‘è¿™æ ·çš„æ‚¬å´–åŒºåŸŸæ—¶ï¼Œæ¢¯åº¦ä¸‹é™æ›´æ–°ä¼šä½¿å‚æ•°å¼¹å¾—éå¸¸è¿œï¼Œå¯èƒ½ä¼šè®©å¤§é‡å·²å®Œæˆçš„ä¼˜åŒ–å·¥ä½œæˆä¸ºæ— ç”¨åŠŸã€‚</p>
<p><strong>è§£å†³æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸</strong></p>
<p><strong>åˆ©ç”¨åˆå§‹åŒ–ç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸</strong></p>
<p>ä»¥ä¸€ä¸ªå•ä¸ªç¥ç»å…ƒä¸ºä¾‹å­ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-19-55-25.png" alt="">  </p>
<p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œå½“è¾“å…¥çš„æ•°é‡$n$è¾ƒå¤§æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ª$w_i$çš„å€¼éƒ½å°ä¸€äº›ï¼Œè¿™æ ·å®ƒä»¬çš„å’Œå¾—åˆ°çš„$z$ä¹Ÿè¾ƒå°ã€‚è¿™é‡Œä¸ºäº†å¾—åˆ°è¾ƒå°çš„$w_i$ï¼Œå°†å®ƒåˆå§‹åŒ–ä¸º$Var(w_i)=\frac{1}{n}$ï¼Œè¿™é‡Œç§°ä¸ºXavier initializationã€‚ å³ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">WL = np.random.randn(WL.shape[<span class="number">0</span>],WL.shape[<span class="number">1</span>])* np.sqrt(<span class="number">1</span>/n)</div></pre></td></tr></table></figure>
<p>è¿™ä¹ˆåšæ˜¯å› ä¸ºï¼Œå¦‚æœæ¿€æ´»å‡½æ•°çš„è¾“å…¥$x$è¿‘ä¼¼è®¾ç½®æˆå‡å€¼ä¸º0ï¼Œæ ‡å‡†æ–¹å·®1çš„æƒ…å†µï¼Œè¾“å‡º$z$ä¹Ÿä¼šè°ƒæ•´åˆ°ç›¸ä¼¼çš„èŒƒå›´å†…ã€‚è™½ç„¶æ²¡æœ‰è§£å†³æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸çš„é—®é¢˜ï¼Œä½†å…¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¡®å®å‡ç¼“äº†æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸çš„é€Ÿåº¦ã€‚</p>
<p>ä¸åŒæ¿€æ´»å‡½æ•°ä¸‹ï¼Œä¹Ÿæœ‰ä¸åŒçš„Xavier initializationï¼š</p>
<ul>
<li>æ¿€æ´»å‡½æ•°ä¸ºReluæ—¶ï¼Œ$Var(w_{i})=\dfrac{2}{n}$</li>
<li>æ¿€æ´»å‡½æ•°ä¸ºtanhæ—¶ï¼Œ$Var(w_{i})=\dfrac{1}{n}$</li>
</ul>
<p>å…¶ä¸­næ˜¯è¾“å…¥ç¥ç»å…ƒä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯$n^{[l-1]}$</p>
<p><strong>å¯å‘å¼æ¢¯åº¦æˆªæ–­ç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸</strong></p>
<p>ä¼ ç»Ÿçš„æ¢¯åº¦ä¸‹é™çš„æ¢¯åº¦åªæŒ‡æ˜äº†æ–¹å‘ï¼Œè€Œæ­¥é•¿æ˜¯å®šå€¼ã€‚è€Œå¯å‘å¼æ¢¯åº¦æˆªæ–­çš„æ€è·¯æ˜¯ï¼šå½“ä¼ ç»Ÿçš„æ¢¯åº¦å»ºè®®æ›´æ–°å¾ˆå¤§ä¸€æ­¥æ—¶ï¼Œå¯å‘å¼æ¢¯åº¦æˆªæ–­ä¼šå¹²æ¶‰æ¥ç¼©å‡æ­¥é•¿ï¼Œä»è€Œä½¿å…¶ä¸å¤ªå¯èƒ½èµ°å‡ºæ¢¯åº¦è¿‘ä¼¼ä¸ºæœ€é™¡æ–¹å‘çš„æ‚¬å´–åŒºåŸŸã€‚</p>
<h2 id="æ¢¯åº¦çš„æ•°å€¼é€¼è¿‘">7.2. æ¢¯åº¦çš„æ•°å€¼é€¼è¿‘</h2><p>ä½¿ç”¨åŒè¾¹è¯¯å·®çš„æ–¹æ³•å»é€¼è¿‘å¯¼æ•°ï¼š </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-20-11-28.png" alt=""> </p>
<p>ç”±å›¾å¯ä»¥çœ‹å‡ºï¼ŒåŒè¾¹è¯¯å·®é€¼è¿‘çš„è¯¯å·®æ˜¯0.0001ï¼Œå…ˆæ¯”å•è¾¹é€¼è¿‘çš„è¯¯å·®0.03ï¼Œå…¶ç²¾åº¦è¦é«˜äº†å¾ˆå¤šã€‚</p>
<p>æ¶‰åŠçš„å…¬å¼ï¼š</p>
<ul>
<li><p>åŒè¾¹å¯¼æ•°ï¼š<br>$$fâ€™(\theta) = \lim\limits_{\varepsilon  \to 0}=\dfrac{f(\theta+\varepsilon)-(\theta-\varepsilon)}{2\varepsilon}$$<br>è¯¯å·®ï¼š$O(\varepsilon^{2})$</p>
</li>
<li><p>å•è¾¹å¯¼æ•°ï¼š</p>
<p>$$fâ€™(\theta) = \lim\limits_{\varepsilon  \to 0}=\dfrac{f(\theta+\varepsilon)-(\theta)}{\varepsilon}$$</p>
<p>è¯¯å·®ï¼š$O(\varepsilon)$</p>
</li>
</ul>
<h2 id="æ¢¯åº¦æ£€éªŒ">7.3. æ¢¯åº¦æ£€éªŒ</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåå‘ä¼ æ’­ç®—æ³•å¾ˆéš¾è°ƒè¯•å¾—åˆ°æ­£ç¡®ç»“æœï¼Œå°¤å…¶æ˜¯å½“å®ç°ç¨‹åºå­˜åœ¨å¾ˆå¤šéš¾äºå‘ç°çš„bugæ—¶ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç´¢å¼•çš„ç¼ºä½é”™è¯¯ï¼ˆoff-by-one errorï¼‰ä¼šå¯¼è‡´åªæœ‰éƒ¨åˆ†å±‚çš„æƒé‡å¾—åˆ°è®­ç»ƒï¼Œå†æ¯”å¦‚å¿˜è®°è®¡ç®—åç½®é¡¹ã€‚è¿™äº›é”™è¯¯ä¼šä½¿ä½ å¾—åˆ°ä¸€ä¸ªçœ‹ä¼¼ååˆ†åˆç†çš„ç»“æœï¼ˆä½†å®é™…ä¸Šæ¯”æ­£ç¡®ä»£ç çš„ç»“æœè¦å·®ï¼‰ã€‚å› æ­¤ï¼Œä½†ä»è®¡ç®—ç»“æœä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬å¾ˆéš¾å‘ç°ä»£ç ä¸­æœ‰ä»€ä¹ˆä¸œè¥¿é—æ¼äº†ã€‚æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ç§å¯¹æ±‚å¯¼ç»“æœè¿›è¡Œæ•°å€¼æ£€éªŒçš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥éªŒè¯æ±‚å¯¼ä»£ç æ˜¯å¦æ­£ç¡®ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å·²ç»ç”¨ä»£ç å®ç°äº†è®¡ç®—$\frac{dL}{dw}$ çš„å‡½æ•°$g(w)$ ï¼Œæ¥ç€æˆ‘ä»¬ä½¿ç”¨$w:=w - \lambda g(w)$æ¥å®ç°æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ£€éªŒ$g$çš„å®ç°æ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿ</p>
<p>å›å¿†å¯¼æ•°çš„æ•°å­¦å®šä¹‰ï¼š</p>
<p><img src="http://ufldl.stanford.edu/wiki/images/math/a/2/3/a23bea0ab48ded7b9a979b68f6356613.png" alt="\begin{align}\frac{d}{d\theta}J(\theta) = \lim_{\epsilon \rightarrow 0}\frac{J(\theta+ \epsilon) - J(\theta-\epsilon)}{2 \epsilon}.\end{align}"></p>
<p>é‚£ä¹ˆå¯¹äºä»»æ„ <img src="http://ufldl.stanford.edu/wiki/images/math/6/9/d/69d920fe8e1da0543eb63d1097f21754.png" alt="\textstyle \theta"> å€¼ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¯¹ç­‰å¼å·¦è¾¹çš„å¯¼æ•°ç”¨ï¼š</p>
<p><img src="http://ufldl.stanford.edu/wiki/images/math/4/8/a/48a000aed96c8595fcca2a45f48343ce.png" alt="\begin{align}\frac{J(\theta+{\rm EPSILON}) - J(\theta-{\rm EPSILON})}{2 \times {\rm EPSILON}}\end{align}"></p>
<p>æ¥è¿‘ä¼¼ã€‚</p>
<p>å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å°† <img src="http://ufldl.stanford.edu/wiki/images/math/8/5/c/85c12e90fcb870ff439cb037d805e09c.png" alt="\textstyle EPSILON"> è®¾ä¸ºä¸€ä¸ªå¾ˆå°çš„å¸¸é‡ï¼Œæ¯”å¦‚åœ¨<img src="http://ufldl.stanford.edu/wiki/images/math/c/f/d/cfd7bf1257600c6c7706c5597af1b94d.png" alt="\textstyle 10^{-4}"> æ•°é‡çº§ï¼ˆè™½ç„¶ <img src="http://ufldl.stanford.edu/wiki/images/math/8/5/c/85c12e90fcb870ff439cb037d805e09c.png" alt="\textstyle EPSILON"> çš„å–å€¼èŒƒå›´å¯ä»¥å¾ˆå¤§ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ä¼šå°†å®ƒè®¾å¾—å¤ªå°ï¼Œæ¯”å¦‚ <img src="http://ufldl.stanford.edu/wiki/images/math/f/a/b/fab2be95b827b3db4ea4d2e27a3d5f99.png" alt="\textstyle 10^{-20}">ï¼Œå› ä¸ºé‚£å°†å¯¼è‡´æ•°å€¼èˆå…¥è¯¯å·®ã€‚ï¼‰</p>
<p>ç»™å®šä¸€ä¸ªè¢«è®¤ä¸ºèƒ½è®¡ç®— <img src="http://ufldl.stanford.edu/wiki/images/math/0/9/6/09643c7c4bb96e039caf25737d835201.png" alt="\textstyle \frac{d}{d\theta}J(\theta)"> çš„å‡½æ•°<img src="http://ufldl.stanford.edu/wiki/images/math/e/9/f/e9fed70b38b2cfac3b42d1d21d46e449.png" alt="\textstyle g(\theta)">ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ•°å€¼æ£€éªŒå…¬å¼</p>
<p><img src="http://ufldl.stanford.edu/wiki/images/math/c/6/d/c6d06b4a25dab5ef468c72900872eda0.png" alt="\begin{align}g(\theta) \approx\frac{J(\theta+{\rm EPSILON}) - J(\theta-{\rm EPSILON})}{2 \times {\rm EPSILON}}.\end{align}"></p>
<p>è®¡ç®—ä¸¤ç«¯æ˜¯å¦ä¸€æ ·æ¥æ£€éªŒå‡½æ•°æ˜¯å¦æ­£ç¡®ã€‚</p>
<p>è€Œåœ¨å¤šç»´æƒ…å†µä¸‹ï¼Œå³å¯è®¡ç®—ï¼š</p>
<p>$$\dfrac {||d\theta_{approx}-d\theta||_{2}}{||d\theta_{approx}||_{2}+||d\theta||_{2}}$$</p>
<p>å°†å®ƒä¸ä»£ç è®¡ç®—å‡ºæ¥çš„$g(\theta)$è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¿‘ä¼¼ï¼Œåˆ™è¯´æ˜è®¡ç®—æ²¡æœ‰å‡ºé”™ã€‚</p>
<p>ä¹Ÿå°±æ˜¯ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-12-20-20-57.png" alt=""> </p>
<p>å†åˆ¤æ–­$d\theta_{approx}\approx d\theta$æ˜¯å¦æˆç«‹</p>
<p>å…¶ä¸­ï¼Œâ€œ$||â‹…||2$â€è¡¨ç¤ºæ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼Œå®ƒæ˜¯è¯¯å·®å¹³æ–¹ä¹‹å’Œï¼Œç„¶åæ±‚å¹³æ–¹æ ¹ï¼Œå¾—åˆ°çš„æ¬§æ°è·ç¦»ã€‚</p>
<p><strong>notes</strong></p>
<ul>
<li>ä¸è¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨æ¢¯åº¦æ£€éªŒï¼Œåªåœ¨debugçš„æ—¶å€™ä½¿ç”¨ï¼Œä½¿ç”¨å®Œæ¯•å…³é—­æ¢¯åº¦æ£€éªŒçš„åŠŸèƒ½ï¼›</li>
<li>å¦‚æœç®—æ³•çš„æ¢¯åº¦æ£€éªŒå‡ºç°äº†é”™è¯¯ï¼Œè¦æ£€æŸ¥æ¯ä¸€é¡¹ï¼Œæ‰¾å‡ºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¦æ‰¾å‡ºå“ªä¸ª$d\theta_{approx}[i]$ä¸dÎ¸çš„å€¼ç›¸å·®æ¯”è¾ƒå¤§ï¼›</li>
<li>ä¸è¦å¿˜è®°äº†æ­£åˆ™åŒ–é¡¹ï¼›</li>
<li>æ¢¯åº¦æ£€éªŒä¸èƒ½ä¸dropoutåŒæ—¶ä½¿ç”¨ã€‚å› ä¸ºæ¯æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œdropoutä¼šéšæœºæ¶ˆé™¤éšå±‚å•å…ƒçš„ä¸åŒç¥ç»å…ƒï¼Œè¿™æ—¶æ˜¯éš¾ä»¥è®¡ç®—dropoutåœ¨æ¢¯åº¦ä¸‹é™ä¸Šçš„ä»£ä»·å‡½æ•°Jï¼›</li>
<li>åœ¨éšæœºåˆå§‹åŒ–çš„æ—¶å€™è¿è¡Œæ¢¯åº¦æ£€éªŒï¼Œä¹Ÿå¯ä»¥åœ¨è®­ç»ƒå‡ æ¬¡åå†è¿›è¡Œã€‚</li>
</ul>
<h1 id="ä¼˜åŒ–ç®—æ³•">8. ä¼˜åŒ–ç®—æ³•</h1><h2 id="Mini-batch-æ¢¯åº¦ä¸‹é™æ³•">8.1. Mini-batch æ¢¯åº¦ä¸‹é™æ³•</h2><p>å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»å¤„ç†æ•´ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œç„¶åæ‰èƒ½è¿›è¡Œä¸€æ­¥æ¢¯åº¦ä¸‹é™ï¼Œå³æ¯ä¸€æ­¥æ¢¯åº¦ä¸‹é™æ³•éœ€è¦å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œä¸€æ¬¡å¤„ç†ï¼Œå¦‚æœè®­ç»ƒæ•°æ®é›†å¾ˆå¤§çš„æ—¶å€™ï¼Œå¦‚æœ‰500ä¸‡æˆ–5000ä¸‡çš„è®­ç»ƒæ•°æ®ï¼Œå¤„ç†é€Ÿåº¦å°±ä¼šæ¯”è¾ƒæ…¢ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ¯æ¬¡å¤„ç†è®­ç»ƒæ•°æ®çš„ä¸€éƒ¨åˆ†å³è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•ï¼Œåˆ™æˆ‘ä»¬çš„ç®—æ³•é€Ÿåº¦ä¼šæ‰§è¡Œçš„æ›´å¿«ã€‚è€Œå¤„ç†çš„è¿™äº›ä¸€å°éƒ¨åˆ†è®­ç»ƒå­é›†å³ç§°ä¸ºMini-batchã€‚</p>
<p>è¯¦ç»†åœ°è¯´ï¼Œå°±æ˜¯åœ¨åšæ¢¯åº¦ä¸‹é™çš„æ—¶å€™ï¼Œä¸é€‰å–è®­ç»ƒé›†çš„æ‰€æœ‰æ ·æœ¬è®¡ç®—æŸå¤±å‡½æ•°ï¼Œè€Œæ˜¯åˆ‡åˆ†æˆå¾ˆå¤šä¸ªç›¸ç­‰çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ç§°ä¸ºä¸€ä¸ªmini-batchï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªmini-batchçš„æ•°æ®è®¡ç®—ä»£ä»·ï¼Œåšå®Œæ¢¯åº¦ä¸‹é™ï¼Œå†å¯¹ä¸‹ä¸€ä¸ªmini-batchåšæ¢¯åº¦ä¸‹é™ã€‚æ¯”å¦‚500wä¸ªæ•°æ®ï¼Œä¸€ä¸ªmini-batchè®¾ä¸º1000çš„è¯ï¼Œæˆ‘ä»¬å°±åš5000æ¬¡æ¢¯åº¦ä¸‹é™ï¼ˆ5000ä¸ªmini-batchï¼Œæ¯ä¸ªmini-batchæ ·æœ¬æ•°ä¸º1000ï¼Œæ€»å…±500wä¸ªæ ·æœ¬ï¼‰ã€‚</p>
<p>å¯¹äºbatchæ¢¯åº¦ä¸‹é™ï¼ˆæ¯æ¬¡è®¡ç®—æ‰€æœ‰çš„æ ·æœ¬ï¼‰ï¼Œéšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œä»£ä»·ä¸æ–­å‡å°‘ã€‚å¯¹äºmini-batchæ¢¯åº¦ä¸‹é™ï¼Œmini-batchçš„è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œä»£ä»·æ˜¯éœ‡è¡ä¸‹é™çš„ï¼ˆæœ‰æ—¶ä¸Šå‡æœ‰æ—¶ä¸‹é™ï¼‰ï¼Œå› ä¸ºæ¯æ¬¡ä¸‹é™æ—¶åªè€ƒè™‘äº†éƒ¨åˆ†æ ·æœ¬ï¼Œä¸‹é™æ–¹å‘å¯èƒ½ä¸æ­£ç¡®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-22-33-03.png" alt=""> </p>
<p>mini-batchçš„sizeä¸ºmæ—¶å°±æ˜¯batchæ¢¯åº¦ä¸‹é™ï¼Œå®ƒçš„å¼Šç«¯æ˜¯må¾ˆå¤§çš„æ—¶å€™å•æ¬¡è®­ç»ƒéœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚</p>
<p>sizeä¸º1æ—¶å°±æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆæ¯æ¬¡åªè®¡ç®—ä¸€ä¸ªæ ·æœ¬ï¼‰ï¼Œéšæœºæ¢¯åº¦ä¸‹é™åœ¨æ¯æ¬¡æ¢¯åº¦ä¸‹é™å¯èƒ½ä¼šè¿œç¦»æœ€ä¼˜ç‚¹ï¼Œå¯èƒ½ä¼šæ¥è¿‘æœ€ä¼˜ç‚¹ï¼Œå¹³å‡æ¥çœ‹ä¼šä¸æ–­é è¿‘æœ€ä¼˜ç‚¹ï¼Œä½†æœ‰æ—¶ä¹Ÿä¼šæ–¹å‘é”™è¯¯ã€‚éšæœºæ¢¯åº¦ä¸‹é™æœ€ç»ˆä¸ä¼šæ”¶æ•›ï¼Œè€Œæ˜¯ä¼šåœ¨æœ€ä¼˜ç‚¹é™„è¿‘æ³¢åŠ¨ã€‚å®ƒçš„å¼Šç«¯å°±æ˜¯å¤±å»äº†å‘é‡åŒ–å¸¦æ¥çš„åŠ é€Ÿä¼˜åŠ¿ï¼Œå› ä¸ºæ¯æ¬¡åªè®­ç»ƒä¸€ä¸ªæ ·æœ¬ï¼Œè¦ç”¨mæ¬¡å¾ªç¯å»è¿­ä»£ã€‚</p>
<p>æ‰€ä»¥å®è·µä¸­é€‰å–ä¸å¤§ä¸å°çš„mini-batch sizeï¼Œè¿™æ ·æ—¢åˆ©ç”¨äº†å‘é‡åŒ–çš„ä¼˜åŠ¿ï¼Œä¹Ÿé¿å…äº†må¤ªå¤§å¸¦æ¥çš„è®­ç»ƒæ—¶é—´å¤ªé•¿çš„å¼Šç«¯ã€‚å®ƒä¹Ÿä¼šéœ‡è¡å¼åœ°é è¿‘æœ€ä¼˜ç‚¹ï¼Œä½†æ˜¯ç›¸æ¯”äºéšæœºæ¢¯åº¦ä¸‹é™è¦å¥½å¾ˆå¥½ï¼Œæœ€ç»ˆå¯èƒ½ä¼šåœ¨æœ€ä¼˜ç‚¹é™„è¿‘æ³¢åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è°ƒæ•´å­¦ä¹ ç‡æ¥æ”¹å–„è¯¥é—®é¢˜ã€‚</p>
<p>æ•°æ®é›†å°çš„æ—¶å€™ï¼Œæ¯”å¦‚må°äº2000ï¼Œä¸€èˆ¬ç›´æ¥ç”¨batchæ¢¯åº¦ä¸‹é™ï¼›ä¸€èˆ¬mini-batchçš„sizeåœ¨64ï¼Œ128ï¼Œ256ï¼Œ512è¿™äº›å€¼ä¹‹é—´è€ƒè™‘ï¼ˆè€ƒè™‘åˆ°ç”µè„‘çš„å†…å­˜è®¾ç½®æ–¹å¼ï¼Œè®¾å®šä¸º2çš„æ¬¡æ–¹è®­ç»ƒæ¯”è¾ƒå¿«ï¼‰ï¼›è®°å¾—è¦ç¡®ä¿mini-batchçš„å¤§å°è¦ç¬¦åˆä½ çš„CPU/GPUå¤§å°ã€‚</p>
<h2 id="æŒ‡æ•°åŠ æƒå¹³å‡">8.2. æŒ‡æ•°åŠ æƒå¹³å‡</h2><p>æŒ‡æ•°åŠ æƒå¹³å‡çš„å…³é”®å‡½æ•°ï¼š </p>
<p>$$v_{t} = \beta v_{t-1}+(1-\beta)\theta_{t}$$</p>
<p>ä»¥æ—¶é—´-æ¸©åº¦ä¸ºä¾‹ã€‚æˆ‘ä»¬å·²çŸ¥æ¯å¤©çš„æ¸©åº¦ä¸ºÎ˜1, Î˜2,..ã€‚é‚£ä¹ˆæ—¶é—´-æ¸©åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡å‡½æ•°ä¸ºï¼šV, æœ‰V0 = 0ï¼ŒV(t) = 0.9 <em> V(t-1) + 0.1 </em> Î˜tã€‚å³ç”¨ï¼ˆå‰ä¸€å¤©çš„Vä¹˜ä»¥0.9ï¼‰åŠ ä¸Šï¼ˆå½“å¤©çš„æ¸©åº¦ä¹˜ä»¥0.1ï¼‰ã€‚</p>
<p>å¯¹Vç»˜åˆ¶å›¾ï¼Œå¦‚ä¸‹å›¾ä¸­çš„çº¢çº¿æ‰€ç¤ºï¼Œå®ƒå¤§è‡´è¡¨ç¤ºäº†å¹³å‡10å¤©çš„æ¸©åº¦</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-22-37-50.png" alt=""> </p>
<p>å¦‚æœæˆ‘ä»¬æŠŠå®ƒå±•å¼€ï¼š</p>
<p>$$v_{100}=0.1\theta_{100}+0.9(0.1\theta_{99}+0.9(0.1\theta_{98}+0.9v_{97}))\\=0.1\theta_{100}+0.1\times0.9\theta_{99}+0.1\times(0.9)^{2}\theta_{98}+0.1\times(0.9)^{3}\theta_{97}+\cdots$$</p>
<p>æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šVå°±æ˜¯æŒ‡æ•°åŠ æƒäº† xå¤©çš„æ¸©åº¦ã€‚è¿™ä¸ªxæ˜¯å¤šå°‘å‘¢ï¼Œæœ‰ä¸ªè®¡ç®—æ–¹æ³•å°±æ˜¯Î²çš„xæ¬¡æ–¹çº¦ç­‰äº1/eï¼Œä»¥æ­¤æ±‚å‡ºxï¼Œé‚£å…¶å®è¿™ä¸ªxå°±æ˜¯1/(1-Î²)ã€‚</p>
<ul>
<li>å½“Î²=0.9æ—¶ï¼ŒåŠ æƒäº†10å¤©ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚å›¾ä¸­çº¢è‰²çº¿æ‰€ç¤ºï¼›</li>
<li>å½“Î²=0.98æ—¶ï¼ŒåŠ æƒäº†50å¤©ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚å›¾ä¸­ç»¿è‰²çº¿æ‰€ç¤ºï¼›</li>
<li>å½“Î²=0.5æ—¶ï¼ŒåŠ æƒäº†2å¤©ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­é»„è‰²çº¿æ‰€ç¤ºï¼›</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-22-38-26.png" alt=""> </p>
<p><strong>æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£</strong></p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒÎ²=0.98æ—¶ï¼Œå®é™…æ‰§è¡Œä¸Šé¢çš„è®¡ç®—æ­¥éª¤æˆ‘ä»¬ä¼šå¾—åˆ°ç´«è‰²çš„æ›²çº¿ï¼Œè€Œä¸æ˜¯ç»¿è‰²æ›²çº¿ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-23-05-02.png" alt=""> </p>
<p>åŸå› å¦‚ä¸‹ï¼šä¸€å¼€å§‹çš„æ—¶å€™v0 = 0ï¼Œç„¶å</p>
<p>$$v_{0}=0\\v_{1}=0.98v_{0}+0.02\theta_{1}=0.02\theta_{1}\\v_{2}=0.98v_{1}+0.02\theta_{2}=0.98\times0.02\theta_{1}+0.02\theta_{2}=0.0196\theta_{1}+0.02\theta_{2}$$</p>
<p>å¦‚æœç¬¬ä¸€å¤©çš„å€¼ä¸ºå¦‚40ï¼Œåˆ™å¾—åˆ°çš„$v_{1}=0.02\times40=8$ï¼Œåˆ™å¾—åˆ°çš„å€¼è¦è¿œå°äºå®é™…å€¼ï¼Œåé¢å‡ å¤©çš„æƒ…å†µä¹Ÿä¼šç”±äºåˆå€¼å¼•èµ·çš„å½±å“ï¼Œå‡ä½äºå®é™…å‡å€¼ã€‚</p>
<p>æ‰€ä»¥åˆšå¼€å§‹çš„å‡ ä¸ªç‚¹éƒ½ä¼šåä½ï¼Œä¸èƒ½åšå‡ºå¾ˆå¥½çš„ä¼°è®¡ï¼Œæ‰€ä»¥éœ€è¦åšä¸€å®šçš„åå·®ä¿®æ­£ï¼Œä¿®æ­£æ–¹æ³•ä¸ºï¼š</p>
<p>$$\dfrac{v_{t}}{1-\beta^{t}}$$</p>
<p>å½“t = 2 æ—¶ï¼Œ$1-\beta^{t}=1-(0.98)^{2}=0.0396$ï¼Œåˆ™$\dfrac{v_{2}}{0.0396}=\dfrac{0.0196\theta_{1}+0.02\theta_{2}}{0.0396}$</p>
<p>åå·®ä¿®æ­£å¾—åˆ°äº†ç»¿è‰²çš„æ›²çº¿ï¼Œåœ¨å¼€å§‹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå¾—åˆ°æ¯”ç´«è‰²æ›²çº¿æ›´å¥½çš„è®¡ç®—å¹³å‡çš„æ•ˆæœã€‚åˆ°åé¢tå¢å¤§ï¼Œä½œä¸ºåˆ†æ¯çš„( 1 - Î²^t ) è¶‹è¿‘äº0ï¼Œæ‰€ä»¥åé¢ç»¿è‰²çš„æ›²çº¿å’Œç´«è‰²çš„æ›²çº¿é€æ¸é‡åˆäº†ã€‚</p>
<p>è™½ç„¶å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä¼šå¿½ç•¥å‰æœŸå‡å€¼åå·®çš„å½±å“ã€‚</p>
<h2 id="åŠ¨é‡æ¢¯åº¦ä¸‹é™ï¼ˆGradient-descent-with-momentum">8.3. åŠ¨é‡æ¢¯åº¦ä¸‹é™ï¼ˆGradient descent with momentum )</h2><p>æˆ‘ä»¬æŠŠä¹‹å‰å­¦çš„æŒ‡æ•°åŠ æƒå¹³å‡åº”ç”¨åˆ°æ¢¯åº¦ä¸‹é™ä¸­å¯ä»¥æ”¹å–„é—®é¢˜ã€‚</p>
<p>è€ƒè™‘ä»£ä»·å‡½æ•°çš„ç­‰é«˜çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½¿ç”¨mini-batchæ—¶å› ä¸ºæ–¹å‘ä¸ä¸€å®šæ˜¯æœ€ä¼˜æ–¹å‘ï¼Œæ‰€ä»¥å¯èƒ½åœ¨ä¸æ–­é è¿‘æœ€ä¼˜ç‚¹æ—¶å€™ä¼šä¸Šä¸‹æ³¢åŠ¨ï¼ˆä¸‹å›¾è“çº¿ï¼‰ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ä¸Šä¸‹æ–¹å‘ä¸Šç”¨è¾ƒå°çš„å­¦ä¹ æ­¥é•¿ï¼Œåœ¨å¾€å³æ–¹å‘ä¸Šä½¿ç”¨è¾ƒå¤§çš„å­¦ä¹ æ­¥é•¿ï¼Œé‚£ä¹ˆå¯ä»¥å¯¹æ±‚å¾—çš„æ¢¯åº¦åšæŒ‡æ•°åŠ æƒå¹³å‡çš„è¿ç®—å¾—åˆ°ä¸€ä¸ªå¹³å‡å€¼ï¼Œè¿™æ—¶ä¸Šä¸‹æ³¢åŠ¨æ±‚å¹³å‡ï¼Œä¸€æ­£ä¸€è´Ÿå¹³å‡ä¸º0ï¼Œå¾€å³å‰è¿›å¹³å‡è¿˜æ˜¯å¾€å³ï¼Œåœ¨æŠµè¾¾æœ€ä¼˜ç‚¹çš„è·¯ä¸Šæˆ‘ä»¬å‡å°‘äº†åŠ¨è¡ï¼Œèƒ½å¤Ÿä»¥ç†æƒ³çš„æ­¥é•¿å»é è¿‘æœ€ä¼˜ç‚¹ï¼ˆä¸‹å›¾çº¢çº¿ï¼‰ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-23-09-14.png" alt=""> </p>
<p>å…·ä½“åšæ³•ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-14-23-09-58.png" alt=""> </p>
<p>å³ï¼Œæ¯æ¬¡åšæ¢¯åº¦ä¸‹é™æ—¶ï¼Œæ±‚ä¸€ä¸‹æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œç”¨è¿™ä¸ªå¹³å‡å€¼æ¥åšæ¢¯åº¦ä¸‹é™ã€‚</p>
<p>è¿™å°±æ˜¯åŠ äº†åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™æ³•ï¼Œå®ƒä¸åƒä¹‹å‰çš„æ¢¯åº¦ä¸‹é™ï¼ˆæ¯æ¬¡ä¸‹é™éƒ½æ˜¯ç‹¬ç«‹äºä¹‹å‰çš„æ­¥éª¤ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰ä¸¤ä¸ªè¶…å‚æ•°ï¼ŒÎ±å’ŒÎ²ï¼ŒÎ²ä¸€èˆ¬è®¾ä¸º0.9ï¼Œè¡¨ç¤ºå¹³å‡äº†æœ€è¿‘10æ¬¡çš„è¿­ä»£é€Ÿåº¦ã€‚</p>
<p>å¯¹äºåŠ¨é‡çš„ç†è§£ï¼šæŠŠå¾®åˆ†dWç†è§£æˆçƒå¾€å±±ä¸‹æ»šçš„åŠ é€Ÿåº¦ï¼Œmomentumé¡¹vç†è§£æˆé€Ÿåº¦ï¼Œçƒå› ä¸ºåŠ é€Ÿåº¦è¶Šæ»šè¶Šå¿«ï¼ŒÎ²ç¨å°äº1å¯ä»¥ç†è§£ä¸ºæ‘©æ“¦åŠ›çš„é˜»ç¢ï¼Œæ‰€ä»¥çƒä¸ä¼šæ— é™åŠ é€Ÿä¸‹å»ã€‚</p>
<p>å…³äºåå·®ä¿®æ­£ï¼Œå®é™…ä¸Šä¸€èˆ¬ä¸ç”¨ï¼Œå› ä¸º10æ¬¡è¿­ä»£åå°±ä¸éœ€è¦ä¿®æ­£äº†ï¼Œæˆ‘ä»¬å¹³æ—¶çš„å­¦ä¹ ä¸€èˆ¬éƒ½ä¸ä¼šå°‘äº10æ¬¡ã€‚</p>
<h2 id="RMSPropï¼ˆroot-mean-square">8.4. RMSPropï¼ˆroot mean square )</h2><p>è¿˜æœ‰ä¸€ç§ç®—æ³•å«RMSPropä¹Ÿå¯ä»¥ç”¨æ¥åŠ é€Ÿmini-batchæ¢¯åº¦ä¸‹é™ï¼Œå®ƒæ˜¯åœ¨momentumçš„åŸºç¡€ä¸Šåšäº†ä¿®æ”¹ã€‚å…¬å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒdWå˜æˆdWçš„å¹³æ–¹ï¼Œåœ¨ä¸‹é™çš„æ—¶å€™å¤šé™¤ä»¥äº†ä¸€ä¸ªæ ¹å·é¡¹ã€‚å¯ä»¥ç†è§£æˆç«–ç›´æ–¹å‘çš„å¾®åˆ†é¡¹æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥é™¤ä»¥ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ•°ï¼Œæ°´å¹³æ–¹å‘çš„å¾®åˆ†é¡¹æ¯”è¾ƒå°ï¼Œæ‰€ä»¥é™¤ä»¥ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°ï¼Œè¿™æ ·å°±å¯ä»¥æ¶ˆé™¤ä¸‹é™ä¸­çš„æ‘†åŠ¨ï¼Œå¯ä»¥é‡‡ç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡å¿«é€Ÿå­¦ä¹ ã€‚ä¸ºäº†ç¡®ä¿é™¤ä»¥çš„åˆ†æ¯ä¸ä¼šä¸º0ï¼Œåœ¨å®æ“ä¸Šä¼šåŠ ä¸Šä¸€ä¸ªå¾ˆå°çš„æ•°Îµã€‚</p>
<p><img src="http://images2017.cnblogs.com/blog/1160281/201711/1160281-20171121162838852-1473232431.png" alt="img"></p>
<h2 id="Adam">8.5. Adam</h2><p>åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œç»å¸¸æœ‰å¾ˆå¤šæ–°çš„ä¼˜åŒ–ç®—æ³•è¢«æåˆ°ç„¶ååˆé­åˆ°è´¨ç–‘ã€‚adamå’ŒRMSPropæ˜¯å°‘æœ‰çš„ç»å¾—èµ·è€ƒéªŒçš„ä¸¤ç§ä¼˜åŒ–ç®—æ³•ï¼Œå·²ç»è¢«è¯æ˜é€‚ç”¨äºä¸åŒçš„æ·±åº¦å­¦ä¹ ç»“æ„ï¼Œè¢«ç”¨æ¥å¾ˆå¥½åœ°è§£å†³äº†å¾ˆå¤šé—®é¢˜ã€‚</p>
<p>adamç®—æ³•åŸºæœ¬å°±æ˜¯ç»“åˆäº†momentumå’ŒRMSPropã€‚</p>
<p><strong>ç®—æ³•å®ç°</strong></p>
<ul>
<li>åˆå§‹åŒ–$V_{dw} = 0ï¼ŒS_{dw}=0ï¼ŒV_{db}=0ï¼ŒS_{db} = 0$</li>
<li>ç¬¬tæ¬¡è¿­ä»£ï¼š<ul>
<li>åœ¨å½“å‰çš„mini-batchä¸Šè®¡ç®—$dw,db$</li>
<li>$V_{dw}=\beta_{1}V_{dw}+(1-\beta_{1})dwï¼ŒV_{db}=\beta_{1}V_{db}+(1-\beta_{1})db$ â€”â€”çš„Vå°±æ˜¯åŠ¨é‡ï¼ˆmomentumï¼‰ï¼Œä¸åŸæ¥çš„è®¡ç®—æ–¹å¼ä¸€æ ·</li>
<li>$S_{dw}=\beta_{2}S_{dw}+(1-\beta_{2})(dw)^{2}ï¼ŒS_{db}=\beta_{2}S_{db}+(1-\beta_{2})(db)^{2}$ â€”â€”SæŒ‰ç…§RMSpropçš„æ–¹å¼è®¡ç®—</li>
<li>$V_{dw}^{corrected} = V_{dw}/(1-\beta_{1}^{t})ï¼ŒV_{db}^{corrected} = V_{db}/(1-\beta_{1}^{t})$ â€”â€”å†åšä¸€ç‚¹åå·®ä¿®æ­£</li>
<li>$S_{dw}^{corrected} = S_{dw}/(1-\beta_{2}^{t})ï¼ŒS_{db}^{corrected} = S_{db}/(1-\beta_{2}^{t})$</li>
<li>$w:=w-\alpha\dfrac{V_{dw}^{corrected}}{\sqrt{S_{dw}^{corrected}}+\varepsilon}ï¼Œb:=b-\alpha\dfrac{V_{db}^{corrected}}{\sqrt{S_{db}^{corrected}}+\varepsilon}$ â€”â€” æŒ‰ç…§RMSpropçš„æ–¹å¼æ›´æ–°</li>
</ul>
</li>
</ul>
<p>è¿™ä¸ªæ–¹æ³•æœ‰æ¯”è¾ƒå¤šçš„è¶…å‚æ•°ï¼Œæ¯”å¦‚å­¦ä¹ ç‡Î±éœ€è¦è‡ªå·±è°ƒæ•´ï¼ŒÎ²1ä¸€èˆ¬ä¸º0.9ï¼ŒÎ²2çš„è¯adamçš„è®ºæ–‡ä½œè€…æ¨è0.999ï¼ŒÎµçš„è¯adamçš„è®ºæ–‡ä½œè€…æ¨è10çš„-8æ¬¡æ–¹ã€‚åœ¨ä½¿ç”¨adamçš„æ—¶å€™ä¸€èˆ¬Î²å’ŒÎµä½¿ç”¨ç¼ºçœå€¼å°±å¯ä»¥äº†ã€‚</p>
<p>adamè¡¨ç¤ºadaptive moment estimateï¼ŒÎ²1ç”¨äºè®¡ç®—dwå¾®åˆ†çš„å¹³å‡ï¼Œç§°ä¸ºfirst momentï¼ŒÎ²2ç”¨äºè®¡ç®—dwçš„å¹³æ–¹çš„å¹³å‡ï¼Œç§°ä¸ºsecond momentï¼Œadamç”±æ­¤è€Œæ¥ã€‚</p>
<h2 id="å­¦ä¹ ç‡è¡°å‡">8.6. å­¦ä¹ ç‡è¡°å‡</h2><p>åšå­¦ä¹ ç‡è¡°å‡çš„åŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯æ¢¯åº¦ä¸‹é™æ—©æœŸç¦»æœ€ä¼˜ç‚¹å¾ˆè¿œï¼Œå¯ä»¥ç”¨è¾ƒå¤§çš„æ­¥é•¿é è¿‘ï¼Œåˆ°äº†åæœŸï¼Œç¦»æœ€ä¼˜ç‚¹å¾ˆè¿‘çš„æ—¶å€™å°±è¦å°å¿ƒäº†ï¼Œå› ä¸ºä½ è·¨ä¸€å¤§æ­¥å¯èƒ½ä¼šè·¨è¿‡å¤´ï¼Œè¿œç¦»æœ€ä¼˜ç‚¹ã€‚å¦‚ä¸‹å›¾è“è‰²çº¿æ‰€ç¤ºã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-15-10-49-15.png" alt=""> </p>
<p>æ‰€ä»¥åˆ°åé¢æ­¥é•¿è¦å˜å°ï¼Œä¹Ÿå°±æ˜¯å­¦ä¹ ç‡è¦è¿›è¡Œè¡°å‡ã€‚å˜æˆç»¿è‰²çº¿ã€‚</p>
<p>å­¦ä¹ ç‡è¡°å‡å¸¸ç”¨çš„æ–¹æ³•ä¸ºï¼š</p>
<ul>
<li><p>å¸¸ç”¨<br>$$\alpha = \dfrac{1}{1+decay_rate*epoch_num}\alpha_{0}$$</p>
<p>1 / ( 1+ decay rate * epoch_num ) ä¹˜ä¸Šåˆå§‹å­¦ä¹ ç‡Î±ï¼Œè¡°å‡ç‡ä½œä¸ºæ–°çš„è¶…å‚ï¼Œepoch_numè¡¨ç¤ºè¿­ä»£äº†ç¬¬å‡ è½®ã€‚</p>
</li>
<li><p>æŒ‡æ•°è¡°å‡<br>$$\alpha = 0.95^{epoch_num}\alpha_{0}$$</p>
</li>
<li><p>å…¶å®ƒ<br>$$\alpha = \dfrac{k}{epoch_num}\cdot\alpha_{0}$$</p>
</li>
<li><p>ç¦»æ•£ä¸‹é™ï¼ˆä¸åŒé˜¶æ®µä½¿ç”¨ä¸åŒçš„å­¦ä¹ é€Ÿç‡ï¼‰</p>
</li>
</ul>
<h2 id="å±€éƒ¨æœ€ä¼˜é—®é¢˜">8.7. å±€éƒ¨æœ€ä¼˜é—®é¢˜</h2><p>åœ¨æ·±åº¦å­¦ä¹ çš„æ—©æœŸï¼Œäººä»¬æ€»æ˜¯æ‹…å¿ƒä¼˜åŒ–é—®é¢˜ä¼šé™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚éšç€æ·±åº¦å­¦ä¹ ç†è®ºçš„å‘å±•ï¼Œæˆ‘ä»¬å¯¹å±€éƒ¨æœ€ä¼˜çš„ç†è§£ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ‘ä»¬å¯¹å®ƒçš„ç†è§£ä¹Ÿè¿˜åœ¨ä¸æ–­å‘å±•ä¸­ã€‚</p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šæƒ³è±¡åˆ°ä¸€ä¸ªCost function å¦‚å·¦å›¾æ‰€ç¤ºï¼Œå­˜åœ¨ä¸€äº›å±€éƒ¨æœ€å°å€¼ç‚¹ï¼Œåœ¨åˆå§‹åŒ–å‚æ•°çš„æ—¶å€™ï¼Œå¦‚æœåˆå§‹å€¼é€‰å–çš„ä¸å¾—å½“ï¼Œä¼šå­˜åœ¨é™·å…¥å±€éƒ¨æœ€ä¼˜ç‚¹çš„å¯èƒ½æ€§ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-15-10-53-43.png" alt=""> </p>
<p>ä½†è¿™äº›ç†è§£å¹¶ä¸æ­£ç¡®ï¼Œäº‹å®ä¸Šï¼Œå¦‚æœä½ è¦åˆ›å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œé€šå¸¸æ¢¯åº¦ä¸º0çš„ç‚¹å¹¶ä¸æ˜¯å·¦å›¾é‚£äº›å±€éƒ¨æœ€ä¼˜ç‚¹ï¼Œè€Œæ˜¯å³å›¾çš„è¿™ä¸ªéç‚¹ã€‚éç‚¹å¯ä»¥ç†è§£ä¸ºåœ¨æŸä¸€æ–¹å‘ä¸Šæ˜¯æå¤§å€¼ç‚¹ï¼Œåœ¨å¦ä¸€æ–¹å‘ä¸Šæ˜¯æå°å€¼ç‚¹ï¼Œå¯ä»¥æƒ³è±¡æˆé©¬èƒŒä¸Šçš„é©¬éã€‚</p>
<p>åœ¨é«˜ç»´ç©ºé—´ä¸­æ¢¯åº¦ä¸º0çš„ç‚¹ï¼Œåœ¨æ¯ä¸ªæ–¹å‘ä¸Šå¯èƒ½æ˜¯å‡¸å‡½æ•°ï¼Œä¹Ÿå¯èƒ½æ˜¯å‡¹å‡½æ•°ã€‚æ¯”å¦‚ä½ åœ¨2wç»´ç©ºé—´ä¸­ä½ æƒ³å¾—åˆ°å±€éƒ¨æœ€ä¼˜ï¼Œæ‰€æœ‰çš„2wä¸ªæ–¹å‘éƒ½éœ€è¦æ˜¯è¿™æ ·çš„,è¿™æ ·çš„æ¦‚ç‡å¤§æ¦‚æ˜¯$2^{-20000}$ ï¼Œå®åœ¨æ˜¯å¤ªå°äº†ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ›´æœ‰å¯èƒ½é‡åˆ°çš„æ˜¯æœ‰äº›æ–¹å‘å‘ä¸Šå¼¯æ›²ï¼Œè€Œå¦ä¸€äº›æ–¹å‘å‘ä¸‹å¼¯æ›²ï¼Œå¦‚å³å›¾æ‰€ç¤ºï¼Œå› æ­¤åœ¨é«˜ç»´ç©ºé—´æˆ‘ä»¬æ›´æœ‰å¯èƒ½ç¢°åˆ°çš„æ˜¯éç‚¹ã€‚</p>
<p>æ‰€ä»¥åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼ˆå‡è®¾ä½ æœ‰å¤§é‡å‚æ•°ï¼Œä»£ä»·å‡½æ•°è¢«å®šä¹‰åœ¨é«˜ç»´ç©ºé—´ï¼‰ä½ ä¸å¤ªå¯èƒ½é™·å…¥å±€éƒ¨æå€¼ç‚¹ï¼Œä½†æ˜¯ä½äºéç‚¹è¿™æ ·çš„å¹³ç¨³åœ°æ®µä½ å¯èƒ½å­¦ä¹ çš„éå¸¸æ…¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ‰€ä»¥æ‰æœ‰äº†momentumï¼ŒRMSPropï¼Œadamè¿™æ ·çš„ç®—æ³•æ¥åŠ å¿«è¿ç®—ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-12-15-11-00-22.png" alt=""> </p>
<p>æ€»ä¹‹ï¼Œåœ¨é«˜çº¬åº¦çš„æƒ…å†µä¸‹ï¼š </p>
<ul>
<li>å‡ ä¹ä¸å¯èƒ½é™·å…¥å±€éƒ¨æœ€å°å€¼ç‚¹ï¼› </li>
<li>å¤„äºéç‚¹çš„åœæ»åŒºä¼šå‡ç¼“å­¦ä¹ è¿‡ç¨‹ï¼Œåˆ©ç”¨å¦‚Adamç­‰ç®—æ³•è¿›è¡Œæ”¹å–„ã€‚</li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">9. å‚è€ƒæ–‡çŒ®</h1><ol>
<li>[å´æ©è¾¾ï¼ŒdeepLearning.ai]</li>
<li><a href="http://ufldl.stanford.edu/wiki/index.php/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="external">ç¥ç»ç½‘ç»œ</a></li>
<li><a href="http://www.jianshu.com/p/d161a22a0292" target="_blank" rel="external">ä¸ä¼šåœçš„èœ—ç‰›ï¼Œä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œ</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/29738823" target="_blank" rel="external">å¤§æ ‘å…ˆç”Ÿï¼Œå´æ©è¾¾ DeepLearning.ai è¯¾ç¨‹æç‚¼ç¬”è®°ï¼ˆ1-4ï¼‰ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹  â€” æ·±å±‚ç¥ç»ç½‘ç»œ</a></li>
<li><a href="http://ufldl.stanford.edu/wiki/index.php/%E6%A2%AF%E5%BA%A6%E6%A3%80%E9%AA%8C%E4%B8%8E%E9%AB%98%E7%BA%A7%E4%BC%98%E5%8C%96" target="_blank" rel="external">æ¢¯åº¦æ£€éªŒä¸é«˜çº§ä¼˜åŒ–</a></li>
<li><a href="http://www.bijishequ.com/detail/563266" target="_blank" rel="external">å´æ©è¾¾-æ·±åº¦å­¦ä¹ -è¯¾ç¨‹ç¬”è®°-7: ä¼˜åŒ–ç®—æ³•( Week 2 )</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> ç¥ç»ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaå­¦ä¹ ç¬”è®°4-æ³›å‹æ•°ç»„åˆ—è¡¨(ArrayList)]]></title>
      <url>/2017/09/04/Java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04-%E6%B3%9B%E5%9E%8B%E6%95%B0%E7%BB%84%E5%88%97%E8%A1%A8/</url>
      <content type="html"><![CDATA[<p>ArrayList : æ˜¯ä¸€ä¸ªé‡‡ç”¨ç±»å‹å‚æ•°(type parameter)çš„æ³›å‹ç±»(generic class)ï¼ˆæ³›å‹ç±»æŒ‡æ•°ç»„å†…çš„å…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼‰ã€‚</p>
<p>æ–°å»ºï¼š</p>
<pre><code>ArrayList&lt;Employee&gt; staff = new ArrayList&lt;Employee&gt;();
</code></pre><p>å¢ï¼š</p>
<pre><code>add();
</code></pre><p>è‹¥è°ƒç”¨addä¸”å†…éƒ¨æ•°ç»„å·²ç»æ»¡äº†ï¼Œæ•°ç»„åˆ—è¡¨å°±è‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰çš„å¯¹è±¡ä»è¾ƒå°çš„æ•°ç»„ä¸­æ‹·è´åˆ°è¾ƒå¤§çš„æ•°ç»„ä¸­ã€‚</p>
<p>æŒ‡å®šæ•°ç»„å¤§å°ï¼š</p>
<pre><code>test.ensureCapacity(100);
</code></pre><p>æˆ–</p>
<pre><code>ArrayList&lt;Employee&gt; staff = new ArrayList&lt;&gt;(100);
</code></pre><p>ä¸€æ—¦ç¡®å®šæ•°ç»„å¤§å°ä¸å†å‘ç”Ÿå˜åŒ–ï¼Œå³å¯è°ƒç”¨<code>trimeToSize</code>æ–¹æ³•ï¼Œä½¿å¾—å­˜å‚¨åŒºåŸŸçš„å¤§å°è°ƒæ•´ä¸ºå½“å‰å…ƒç´ æ•°é‡æ‰€éœ€çš„å­˜å‚¨ç©ºé—´æ•°ç›®ã€‚åƒåœ¾å›æ”¶å™¨å°†å›æ”¶å¤šä½™çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>å…¶å®ƒæ“ä½œï¼š</p>
<pre><code>get(index);
set(index,element);
add(index,element);
remove(index);
</code></pre>]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ·±åº¦å­¦ä¹ ç®—æ³•-å¼•è¨€-LRçš„æ¢¯åº¦ä¸‹é™æ³•]]></title>
      <url>/2017/09/04/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E5%BC%95%E8%A8%80-LR%E7%9A%84%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>æœ¬èŠ‚æ˜¯å´æ©è¾¾è€å¸ˆåœ¨deepLearning.aiç¬¬äºŒå‘¨è¯¾ç¨‹çš„ç¬”è®°ã€‚</p>
<p>æœ¬èŠ‚ä»¥é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™æ³•ä¸ºä¾‹ï¼Œè®²äº†æˆ‘ä»¬ç©¶ç«Ÿå¦‚ä½•ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚</p>
<h1 id="LRçš„æ¢¯åº¦ä¸‹é™">1. LRçš„æ¢¯åº¦ä¸‹é™</h1><p>åœ¨LRä¸­ï¼Œæˆ‘ä»¬æƒ³è¦å¾—åˆ°z=wx+bï¼Œå¹¶ä¸”è¿™ä¸ªzåœ¨æ ·æœ¬ä¸Šï¼ŒæŸå¤±å‡½æ•°L(a,y)æœ€å°ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­åœ°æ”¹å˜wå’Œbï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„wå’Œbï¼Œè¾¾åˆ°æˆ‘ä»¬ä¸Šè¿°çš„ç›®çš„ã€‚</p>
<p><img src="https://i.loli.net/2017/09/04/59acd4eac78da.png" alt=""> </p>
<p>å¦‚ä½•æ”¹å˜wå’Œbï¼Œèƒ½æ›´å¿«åœ°å¾—åˆ°æœ€ä¼˜çš„wå’Œbå‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±è¦ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚<br><img src="https://i.loli.net/2017/09/04/59acd39e1a9ea.png" alt=""> </p>
<p>ä¸Šå›¾ä¸­ï¼Œä»å·¦åˆ°å³çš„è®¡ç®—è¿‡ç¨‹å°±æ˜¯å‰å‘ä¼ æ’­æ³•ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬éƒ½ç”¨åå‘ä¼ æ’­æ³•æ¥è®¡ç®—è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p>åœ¨å•ä¸ªæ ·æœ¬ä¸­ï¼Œ<br>æƒ³è¦è®¡ç®—$L(a,y)$çš„å¯¼æ•°:</p>
<ol>
<li>å…ˆå‘å‰ä¸€æ­¥ï¼Œè®¡ç®—æŸå¤±å‡½æ•°$L(a,y)$å…³äº$a$çš„å¯¼æ•°$da = \frac{dL(a,y)}{da} = -\frac{y}{a} + \frac{1-y}{1-a}$ã€‚</li>
<li>å†å‘å‰ä¸€æ­¥ï¼Œè®¡ç®—$dz = \frac{dL}{dz} = a - y$</li>
<li>å†å‘å‰ä¸€æ­¥ï¼Œè®¡ç®—$dw = \frac{dL}{dw} = â€¦=x(a-y), db = â€¦=a-y$</li>
<li>ç”¨ $ w = w - \lambda dw,b = b - \lambda db$</li>
</ol>
<p>åœ¨mä¸ªè®­ç»ƒé›†ä¸­ï¼Œ<br>$J(w,b) = \frac{1}{m} \sum{_i^m L(a^{(i)},y^{(i)})}$<br>é‚£ä¹ˆï¼š<br>$\frac{d(J(w,b))}{w1} = \frac{1}{m}\sum_i^m\frac{d(L(w^{(i)},y^{(i)}))}{w_i}$</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œmä¸ªè®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°çš„å¯¼æ•° = æ¯ä¸ªè®­ç»ƒæ ·æœ¬æŸå¤±å‡½æ•°å¯¼æ•°çš„å‡å€¼</p>
<p>ä¼ªä»£ç ï¼š</p>
<pre><code>J = 0; dw1 = 0; dw2 = 0 ; db = 0;
for i = 1 to m :
    z = w1x1[i] + w2x2[i] + b ;
    y = sigmod(z) ;
    a = get(i) ;
    J += ylog(a) + (1-y)log(1-a);
    dz = a - y; # å…ˆç®—dz
    dw1+= x1dz; # åç®—dw,db
    dw2 += x2dz;
    db+= dz;
J/= m;
dw1 /= m;
dw2 /= m;
db /= m; 
</code></pre><p>æ­¤æ—¶å°±å·²ç»å¾—åˆ°äº†å…¨éƒ¨æ ·æœ¬çš„dw1,dw2,db,J</p>
<p>ç„¶ååº”ç”¨æ¢¯åº¦ä¸‹é™ï¼š</p>
<pre><code>w1 = w1 - sdw1
w2 = w2 - sdw2
b = b - sb
</code></pre><p>å…¶ä¸­ï¼Œsæ˜¯æ­¥é•¿ã€‚</p>
<h1 id="å‘é‡åŒ–">2. å‘é‡åŒ–</h1><p>ä¸€èˆ¬æ¥è¯´ï¼Œforå¾ªç¯æ˜¯å¾ˆä¸å¥½çš„ã€‚å¯ä»¥ä½¿ç”¨å‘é‡åŒ–æ¥æ‘†è„±forå¾ªç¯ï¼ŒåŠ é€Ÿè¿ç®—ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è®²ä¸€è®²å‘é‡åŒ–ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®¡ç®—$z = w^T x + b$,å…¶ä¸­ï¼Œwå’Œxéƒ½æ˜¯ä¸€ä¸ªnç»´çš„åˆ—å‘é‡ã€‚åœ¨éå‘é‡åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨ï¼š</p>
<pre><code>z = 0;
for i in range(n):
    z += w[i]*x[i];
z += b ;
</code></pre><p>åœ¨å‘é‡åŒ–ï¼ˆä¾‹å¦‚numpyä¸­ï¼‰ï¼Œæˆ‘ä»¬ç”¨ï¼š</p>
<pre><code>z = np.dot(w,x) + b
</code></pre><p>å‘é‡è¿ç®—éå¸¸å¿«ï¼ˆä¸»è¦åŸå› æ˜¯å¹¶è¡Œè¿ç®—ï¼‰ã€‚å› æ­¤æˆ‘ä»¬å°½é‡å°†loopè¿ç®—è½¬æ¢ä¸ºå‘é‡è¿ç®—ã€‚</p>
<h1 id="å‘é‡åŒ–çš„LR">3. å‘é‡åŒ–çš„LR</h1><p>xæ˜¯mç»´å‘é‡</p>
<pre><code>import numpy as np
J = 0; dw1 = 0; dw2 = 0 ; db = 0;
z = np.dot(w.T,x) + b; # mç»´åˆ—å‘é‡
y = sigmod(z) ;# mç»´åˆ—å‘é‡
a = label;# mç»´åˆ—å‘é‡
J = np.dot(y.T,log(a)) + np.dot((1-y).T,log(1-a));
J/= m;
dz = a - y; # å…ˆç®—dz
dw1 = np.dot(x1.T,dz) /m ; # åç®—dw,db
dw2 = np.dot(x2.T,dz) /m ;
db= np.sum(dz) /m ;
</code></pre><p>ç„¶ååº”ç”¨æ¢¯åº¦ä¸‹é™ï¼š</p>
<pre><code>w1 = w1 - sdw1
w2 = w2 - sdw2
b = b - sb
</code></pre><h1 id="æ€»ç»“">4. æ€»ç»“</h1><p>è¿™ä¸€èŠ‚ä¸»è¦è®²äº†æˆ‘ä»¬å¦‚ä½•å°†æ¢¯åº¦ä¸‹é™æ³•åº”ç”¨åˆ°LRä¸­ï¼Œä»¥åŠå¼ºè°ƒäº†Nuppyã€‚åº”è¯¥åªæ˜¯ä¸ºäº†åç»­çš„å­¦ä¹ åšä¸€äº›å‡†å¤‡ã€‚</p>
<p>ä¸€å®šä¸€å®šè¦çœ‹è¿™ä¸ªä½œä¸š<a href="http://kakack.github.io/2017/09/Logistic-Regression-with-a-Neural-Network-mindset/" target="_blank" rel="external">é€šè¿‡ç¥ç»ç½‘ç»œmindsetå®ç°ç®€å•çš„Logistic Regression</a></p>
]]></content>
      
        <categories>
            
            <category> æ·±åº¦å­¦ä¹ ç®—æ³• </category>
            
            <category> ç¥ç»ç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-åˆè¯†Learning to Rank]]></title>
      <url>/2017/08/30/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E5%88%9D%E8%AF%86Learning-to-Rank/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦å¯¹æ’åºæ¨¡å‹åšä¸€ä¸ªç®€è¦çš„æ•´ç†ã€‚é¦–å…ˆä»‹ç»äº†ä¸€äº›ä¼ ç»Ÿçš„æ’åºæ¨¡å‹ï¼Œç„¶åä»‹ç»æ¯”è¾ƒæ–°çš„learning to rank.</p>
<p>è¦æƒ³äº†è§£L2Rï¼Œé¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ä¼ ç»Ÿçš„æ’åºæ¨¡å‹ã€‚</p>
<h1 id="ä¼ ç»Ÿçš„æ’åºæ¨¡å‹">1. ä¼ ç»Ÿçš„æ’åºæ¨¡å‹</h1><p>ä¼ ç»Ÿçš„æ’åºæ¨¡å‹ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šç›¸å…³åº¦æ’åºæ¨¡å‹å’Œé‡è¦æ€§æ’åºæ¨¡å‹ã€‚</p>
<h2 id="ç›¸å…³åº¦æ’åºæ¨¡å‹-Relevance-Ranking-Model">1.1. ç›¸å…³åº¦æ’åºæ¨¡å‹(Relevance Ranking Model)</h2><p>ç›¸å…³åº¦æ’åºæ¨¡å‹æ ¹æ®æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥å¯¹æ–‡æ¡£è¿›è¡Œæ’åºã€‚å¸¸ç”¨çš„æ¨¡å‹åŒ…æ‹¬ï¼šå¸ƒå°”æ¨¡å‹(Boolean Model)ï¼Œå‘é‡ç©ºé—´æ¨¡å‹(Vector Space Model)ï¼Œéšè¯­ä¹‰åˆ†æ(Latent Semantic Analysis)ï¼ŒBM25ï¼ŒLMIRæ¨¡å‹ç­‰ç­‰ã€‚</p>
<p>ç›¸å…³åº¦æ’åºæ¨¡å‹ä¸»è¦ç”¨åœ¨æŸ¥è¯¢ï¼ˆä¾‹å¦‚æœç´¢å¼•æ“ï¼‰ä¸Šï¼Œå®ƒä¸»è¦æ˜¯è¦è®¡ç®—ã€å…³é”®å­—ã€‘ä¸ã€æ–‡æ¡£ã€‘ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œç»™å‡ºã€å…³äºå…³é”®å­—ã€‘çš„æ’åºã€‚</p>
<h2 id="é‡è¦æ€§æ’åºæ¨¡å‹-Importance-Ranking-Model">1.2. é‡è¦æ€§æ’åºæ¨¡å‹(Importance Ranking Model)</h2><p>é‡è¦æ€§æ’åºæ¨¡å‹å°±ä¸è€ƒè™‘ä¸Šè¿°æåˆ°çš„ã€æŸ¥è¯¢ã€‘ï¼Œè€Œä»…ä»…æ ¹æ®ç½‘é¡µ(äº¦å³æ–‡æ¡£)ä¹‹é—´çš„å›¾ç»“æ„æ¥åˆ¤æ–­æ–‡æ¡£çš„æƒå¨ç¨‹åº¦ï¼Œå…¸å‹çš„æƒå¨ç½‘ç«™åŒ…æ‹¬Googleï¼ŒYahoo!ç­‰ã€‚å¸¸ç”¨çš„æ¨¡å‹åŒ…æ‹¬PageRankï¼ŒHITSï¼ŒHillTopï¼ŒTrustRankç­‰ç­‰ã€‚</p>
<h2 id="ä¼ ç»Ÿæ’åºæ¨¡å‹çš„ç¼ºé™·">1.3. ä¼ ç»Ÿæ’åºæ¨¡å‹çš„ç¼ºé™·</h2><p>ä»¥ä¸Šçš„è¿™äº›ä¼ ç»Ÿçš„æ’åºæ¨¡å‹ï¼Œå•ä¸ªæ¨¡å‹å¾€å¾€åªèƒ½è€ƒè™‘æŸä¸€ä¸ªæ–¹é¢(ç›¸å…³åº¦æˆ–è€…é‡è¦æ€§)ï¼Œæ‰€ä»¥åªæ˜¯ç”¨å•ä¸ªæ¨¡å‹è¾¾ä¸åˆ°è¦æ±‚ã€‚æœç´¢å¼•æ“é€šå¸¸ä¼šç»„åˆå¤šç§æ’åºæ¨¡å‹æ¥è¿›è¡Œæ’åºï¼Œä½†æ˜¯ï¼Œå¦‚ä½•ç»„åˆå¤šä¸ªæ’åºæ¨¡å‹æ¥å½¢æˆä¸€ä¸ªæ–°çš„æ’åºæ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•è°ƒèŠ‚è¿™äº›å‚æ•°ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚</p>
<p>å› æ­¤ï¼Œä¼Ÿå¤§çš„ç§‘å­¦å®¶ä»¬æå‡ºäº†Learning to Rankï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
<h1 id="Learning-to-Rank">2. Learning to Rank</h1><p>Learning to Rankæ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚å®ƒä½¿ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå„ä¸ªç°æœ‰æ’åºæ¨¡å‹çš„ã€è¾“å‡ºä½œä¸ºç‰¹å¾ã€‘ï¼Œç„¶åè®­ç»ƒä¸€ä¸ªæ–°çš„æ¨¡å‹ï¼Œå¹¶è‡ªåŠ¨å­¦å¾—è¿™ä¸ªæ–°çš„æ¨¡å‹çš„å‚æ•°ï¼Œä»è€Œå¾ˆæ–¹ä¾¿çš„å¯ä»¥ç»„åˆå¤šä¸ªç°æœ‰çš„æ’åºæ¨¡å‹æ¥ç”Ÿæˆæ–°çš„æ’åºæ¨¡å‹ã€‚</p>
<h1 id="L2Rç‰¹å¾çš„é€‰å–">3. L2Rç‰¹å¾çš„é€‰å–</h1><p>ä¸æ–‡æœ¬åˆ†ç±»ä¸åŒï¼ŒL2Rè€ƒè™‘çš„æ˜¯ã€ç»™å®šæŸ¥è¯¢çš„æ–‡æ¡£é›†åˆçš„æ’åºã€‘ã€‚æ‰€ä»¥ï¼ŒL2Rç”¨åˆ°çš„ç‰¹å¾ä¸ä»…ä»…åŒ…å«æ–‡æ¡£dæœ¬èº«çš„ä¸€äº›ç‰¹å¾(æ¯”å¦‚æ˜¯å¦æ˜¯Spam)ç­‰ï¼Œä¹ŸåŒ…æ‹¬æ–‡æ¡£då’Œç»™å®šæŸ¥è¯¢qä¹‹é—´çš„ç›¸å…³åº¦ï¼Œä»¥åŠæ–‡æ¡£åœ¨æ•´ä¸ªç½‘ç»œä¸Šçš„é‡è¦æ€§(æ¯”å¦‚PageRankå€¼ç­‰)ï¼Œäº¦å³æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸å…³æ€§æ’åºæ¨¡å‹å’Œé‡è¦æ€§æ’åºæ¨¡å‹çš„è¾“å‡ºæ¥ä½œä¸ºL2Rçš„ç‰¹å¾ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼ŒL2Rçš„ç‰¹å¾æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ol>
<li>ä¼ ç»Ÿæ’åºæ¨¡å‹çš„è¾“å‡ºï¼Œæ—¢åŒ…æ‹¬ç›¸å…³æ€§æ’åºæ¨¡å‹çš„è¾“å‡ºf(q,d)ï¼Œä¹ŸåŒ…æ‹¬é‡è¦æ€§æ’åºæ¨¡å‹çš„è¾“å‡ºã€‚</li>
<li>æ–‡æ¡£æœ¬èº«çš„ä¸€äº›ç‰¹å¾ï¼Œæ¯”å¦‚æ˜¯å¦æ˜¯Spamç­‰ã€‚</li>
</ol>
<h1 id="L2Rè®­ç»ƒæ•°æ®çš„æ„é€ ">4. L2Rè®­ç»ƒæ•°æ®çš„æ„é€ </h1><p>L2Rçš„è®­ç»ƒæ•°æ®å¯ä»¥æœ‰ä¸‰ç§å½¢å¼ï¼š</p>
<ol>
<li>å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œå„ä¸ªæ–‡æ¡£çš„ç»å¯¹ç›¸å…³å€¼(éå¸¸ç›¸å…³ï¼Œæ¯”è¾ƒç›¸å…³ï¼Œä¸ç›¸å…³ï¼Œç­‰ç­‰)ï¼›</li>
<li>å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œä¸¤ä¸¤æ–‡æ¡£ä¹‹é—´çš„ç›¸å¯¹ç›¸å…³å€¼(æ–‡æ¡£1æ¯”æ–‡æ¡£2ç›¸å…³ï¼Œæ–‡æ¡£4æ¯”æ–‡æ¡£3ç›¸å…³ï¼Œç­‰ç­‰)ï¼›</li>
<li>å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œæ‰€æœ‰æ–‡æ¡£çš„æŒ‰ç›¸å…³åº¦æ’åºçš„åˆ—è¡¨(æ–‡æ¡£1&gt;æ–‡æ¡£2&gt;æ–‡æ¡£3)ã€‚</li>
</ol>
<p>è¿™ä¸‰ç§å½¢å¼çš„è®­ç»ƒæ•°æ®ä¹‹é—´å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œè¯¦è§[1]ã€‚</p>
<p>è®­ç»ƒæ•°æ®çš„è·å–æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼šäººå·¥æ ‡æ³¨[3]å’Œä»æ—¥å¿—æ–‡ä»¶ä¸­æŒ–æ˜[4]:</p>
<p>äººå·¥æ ‡æ³¨ï¼šé¦–å…ˆä»æœç´¢å¼•æ“çš„æœç´¢è®°å½•ä¸­éšæœºæŠ½å–ä¸€äº›æŸ¥è¯¢ï¼Œå°†è¿™äº›æŸ¥è¯¢æäº¤ç»™å¤šä¸ªä¸åŒçš„æœç´¢å¼•æ“ï¼Œç„¶åé€‰å–å„ä¸ªæœç´¢å¼•æ“è¿”å›ç»“æœçš„å‰Kä¸ªï¼Œæœ€åç”±ä¸“ä¸šäººå‘˜æ¥å¯¹è¿™äº›æ–‡æ¡£æŒ‰ç…§å’ŒæŸ¥è¯¢çš„ç›¸å…³åº¦è¿›è¡Œæ ‡æ³¨ã€‚</p>
<p>ä»æ—¥å¿—ä¸­æŒ–æ˜ï¼šæœç´¢å¼•æ“éƒ½æœ‰å¤§é‡çš„æ—¥å¿—è®°å½•ç”¨æˆ·çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­æå–å‡ºL2Rçš„è®­ç»ƒæ•°æ®ã€‚Joachimsæå‡ºäº†ä¸€ç§å¾ˆæœ‰æ„æ€çš„æ–¹æ³•[4]ï¼šç»™å®šä¸€ä¸ªæŸ¥è¯¢ï¼Œæœç´¢å¼•æ“è¿”å›çš„ç»“æœåˆ—è¡¨ä¸ºLï¼Œç”¨æˆ·ç‚¹å‡»çš„æ–‡æ¡£çš„é›†åˆä¸ºCï¼Œå¦‚æœä¸€ä¸ªæ–‡æ¡£diè¢«ç‚¹å‡»è¿‡ï¼Œå¦å¤–ä¸€ä¸ªæ–‡æ¡£djæ²¡æœ‰è¢«ç‚¹å‡»è¿‡ï¼Œå¹¶ä¸”djåœ¨ç»“æœåˆ—è¡¨ä¸­æ’åœ¨diä¹‹å‰ï¼Œåˆ™di&gt;djå°±æ˜¯ä¸€æ¡è®­ç»ƒè®°å½•ã€‚äº¦å³è®­ç»ƒæ•°æ®ä¸ºï¼š{di&gt;dj|diå±äºCï¼Œdjå±äºL-Cï¼Œp(dj) &lt; p(di)}ï¼Œå…¶ä¸­p(d)è¡¨ç¤ºæ–‡æ¡£dåœ¨æŸ¥è¯¢ç»“æœåˆ—è¡¨ä¸­çš„ä½ç½®ï¼Œè¶Šå°è¡¨ç¤ºè¶Šé å‰ã€‚</p>
<h1 id="L2Ræ¨¡å‹è®­ç»ƒ">5. L2Ræ¨¡å‹è®­ç»ƒ</h1><p>L2Ræ˜¯ä¸€ä¸ªæœ‰ç›‘ç£å­¦ä¹ è¿‡ç¨‹ã€‚</p>
<p>å¯¹ä¸æ¯ä¸ªç»™å®šçš„æŸ¥è¯¢-æ–‡æ¡£å¯¹(query document pair)ï¼ŒæŠ½å–ç›¸åº”çš„ç‰¹å¾(æ—¢åŒ…æ‹¬æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„å„ç§ç›¸å…³åº¦ï¼Œä¹ŸåŒ…æ‹¬æ–‡æ¡£æœ¬èº«çš„ç‰¹å¾ä»¥åŠé‡è¦æ€§ç­‰)ï¼Œå¦å¤–é€šè¿‡æˆ–è€…äººå·¥æ ‡æ³¨æˆ–è€…ä»æ—¥å¿—ä¸­æŒ–æ˜çš„æ–¹æ³•æ¥å¾—åˆ°ç»™å®šæŸ¥è¯¢ä¸‹æ–‡æ¡£é›†åˆçš„çœŸå®åºåˆ—ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨L2Rçš„å„ç§ç®—æ³•æ¥å­¦åˆ°ä¸€ä¸ªæ’åºæ¨¡å‹ï¼Œä½¿å…¶è¾“å‡ºçš„æ–‡æ¡£åºåˆ—å’ŒçœŸå®åºåˆ—å°½å¯èƒ½ç›¸ä¼¼ã€‚</p>
<h1 id="L2Rç®—æ³•åˆ†ç±»å’Œç®€ä»‹">6. L2Rç®—æ³•åˆ†ç±»å’Œç®€ä»‹</h1><p>L2Rç®—æ³•ä¸»è¦åŒ…æ‹¬ä¸‰ç§ç±»åˆ«ï¼šPointWiseï¼ŒPairWiseï¼ŒListWiseã€‚</p>
<h2 id="PointWise-L2R">6.1. PointWise L2R</h2><p><strong>pointwiseç®€ä»‹</strong><br>PointWiseæ–¹æ³•åªè€ƒè™‘ã€ç»™å®šæŸ¥è¯¢ä¸‹ã€‘ï¼Œå•ä¸ªæ–‡æ¡£çš„ç»å¯¹ç›¸å…³åº¦ï¼Œè€Œä¸è€ƒè™‘å…¶ä»–æ–‡æ¡£å’Œç»™å®šæŸ¥è¯¢çš„ç›¸å…³åº¦ã€‚äº¦å³ç»™å®šæŸ¥è¯¢qçš„ä¸€ä¸ªçœŸå®æ–‡æ¡£åºåˆ—ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘ã€å•ä¸ªæ–‡æ¡£diå’Œè¯¥æŸ¥è¯¢çš„ç›¸å…³ç¨‹åº¦ciã€‘ï¼Œäº¦å³è¾“å…¥æ•°æ®åº”è¯¥æ˜¯å¦‚ä¸‹çš„å½¢å¼ï¼š<br><img src="https://i.loli.net/2017/08/30/59a69397eeec7.png" alt=""> </p>
<p>ä¸€ç§æ€æƒ³æ˜¯å°†queryä¸docä¹‹é—´çš„ç›¸å…³ç¨‹åº¦ä½œä¸ºæ ‡ç­¾ï¼Œæ¯”å¦‚æ ‡ç­¾æœ‰ä¸‰æ¡£ï¼Œé—®é¢˜å°±å˜ä¸ºå¤šç±»åˆ†ç±»é—®é¢˜,æ¨¡å‹æœ‰McRank,svmï¼Œæœ€å¤§ç†µç­‰ã€‚å¦ä¸€ç§æ€æƒ³æ˜¯å°†queryä¸docä¹‹é—´çš„ç›¸å…³ç¨‹åº¦ä½œä¸ºåˆ†æ•°åˆ©ç”¨å›å½’æ¨¡å‹æ‹Ÿåˆï¼Œç»å…¸å›å½’æ¨¡å‹æœ‰çº¿æ€§å›å½’ï¼Œdnnï¼Œmartç­‰ã€‚</p>
<p><strong>pointwiseå½¢å¼</strong><br>è¾“å…¥ï¼šdoc çš„ç‰¹å¾å‘é‡<br>è¾“å‡ºï¼šæ¯ä¸ªdocçš„ç›¸å…³æ€§åˆ†æ•°<br>æŸå¤±å‡½æ•°: å›å½’lossï¼Œåˆ†ç±»lossï¼Œæœ‰åºå›å½’loss</p>
<p><strong>pointwiseå¸¸ç”¨ç®—æ³•</strong><br>Pointwiseæ–¹æ³•ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ç®—æ³•ï¼šPranking (NIPS 2002), OAP-BPM (EMCL 2003), Ranking with Large Margin Principles (NIPS 2002), Constraint Ordinal Regression (ICML 2005)ã€‚</p>
<p><strong>pointwiseç‰¹ç‚¹</strong><br>Pointwiseæ–¹æ³•ä»…ä»…ä½¿ç”¨ä¼ ç»Ÿçš„åˆ†ç±»ï¼Œå›å½’æˆ–è€…Ordinal Regressionæ–¹æ³•æ¥å¯¹ç»™å®šæŸ¥è¯¢ä¸‹å•ä¸ªæ–‡æ¡£çš„ç›¸å…³åº¦è¿›è¡Œå»ºæ¨¡ã€‚è¿™ç§æ–¹æ³•æ²¡æœ‰è€ƒè™‘åˆ°æ’åºçš„ä¸€äº›ç‰¹å¾ï¼Œæ¯”å¦‚æ–‡æ¡£ä¹‹é—´çš„æ’åºç»“æœé’ˆå¯¹çš„æ˜¯ç»™å®šæŸ¥è¯¢ä¸‹çš„æ–‡æ¡£é›†åˆï¼Œè€ŒPointwiseæ–¹æ³•ä»…ä»…è€ƒè™‘å•ä¸ªæ–‡æ¡£çš„ç»å¯¹ç›¸å…³åº¦ï¼›å¦å¤–ï¼Œåœ¨æ’åºä¸­ï¼Œæ’åœ¨æœ€å‰çš„å‡ ä¸ªæ–‡æ¡£å¯¹æ’åºæ•ˆæœçš„å½±å“éå¸¸é‡è¦ï¼ŒPointwiseæ²¡æœ‰è€ƒè™‘è¿™æ–¹é¢çš„å½±å“ã€‚</p>
<h2 id="PairWise">6.2. PairWise</h2><p><strong>pairwiseç®€ä»‹</strong><br>Pairwiseæ–¹æ³•è€ƒè™‘ç»™å®šæŸ¥è¯¢ä¸‹ï¼Œã€ä¸¤ä¸ªæ–‡æ¡£ä¹‹é—´ã€‘çš„ç›¸å¯¹ç›¸å…³åº¦ã€‚äº¦å³ç»™å®šæŸ¥è¯¢qçš„ä¸€ä¸ªçœŸå®æ–‡æ¡£åºåˆ—ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘ä»»æ„ä¸¤ä¸ªç›¸å…³åº¦ä¸åŒçš„æ–‡æ¡£ä¹‹é—´çš„ç›¸å¯¹ç›¸å…³åº¦ï¼šdi&gt;djï¼Œæˆ–è€…di &lt; dj ã€‚</p>
<p><strong>pairwiseåŸç†</strong><br>Pairwiseçš„æ–¹æ³•æ˜¯å°†æ–‡æ¡£ç»„æˆæ–‡æ¡£å¯¹ï¼Œä¸å•è€ƒè™‘å•ä¸ªæ–‡æ¡£ï¼Œè€Œæ˜¯è€ƒè™‘æ–‡æ¡£ç»„å¯¹æ˜¯å¦åˆç†ï¼Œæ¯”å¦‚å¯¹äºquery 1è¿”å›çš„ä¸‰ä¸ªæ–‡æ¡£ doc1ï¼Œdoc2ï¼Œdoc3, æœ‰ä¸‰ç§ç»„å¯¹æ–¹å¼ï¼Œ<doc1,doc2>,<doc2,doc3>,<doc1,doc3>ã€‚å½“ä¸‰ä¸ªæ–‡æ¡£åŸæ¥çš„labelä¸º3,4,2æ—¶ï¼Œè¿™æ ·ç»„å¯¹ä¹‹åçš„ä¸‰ä¸ªä¾‹å­å°±æœ‰äº†æ–°çš„åˆ†æ•°ï¼ˆè¡¨è¾¾è¿™ç§é¡ºåºæ˜¯å¦åˆç†ï¼‰ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç§æ•°æ®è¿›è¡Œåˆ†ç±»å­¦ä¹ ï¼Œæ¨¡å‹å¦‚SVM Rank, è¿˜æœ‰RankNet(C. Burges, et al. ICML 2005)ï¼Œ FRank(M.Tsai, T.Liu, et al. SIGIR 2007)ï¼ŒRankBoost(Y. Freund, et al. JMLR 2003)ã€‚</doc1,doc3></doc2,doc3></doc1,doc2></p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://www.javashuo.com/content/p-5980716.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ æ’åºä¹‹Learning to Rankç®€å•ä»‹ç»</a>å¯¹pairwiseæ–¹æ³•åšå‡ºäº†æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ä»‹ç»ï¼š<br>æ–‡æ¡£å¯¹æ–¹æ³•ï¼ˆparwiseï¼‰åˆ™å°†é‡ç‚¹è½¬å‘é‡å¯¹æ–‡æ¡£é¡ºåºå…³ç³»æ˜¯å¦åˆç†è¿›è¡Œåˆ¤æ–­ã€‚<br>ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºæ–‡æ¡£å¯¹æ–¹æ³•ï¼Œæ˜¯å› ä¸ºè¿™ç§æœºå™¨å­¦ä¹ æ–¹æ³•çš„è®­ç»ƒè¿‡ç¨‹å’Œè®­ç»ƒç›®æ ‡ï¼Œæ˜¯åˆ¤æ–­ä»»æ„ä¸¤ä¸ªæ–‡æ¡£ç»„æˆçš„æ–‡æ¡£å¯¹<d0c1ï¼Œd0c2>æ˜¯å¦æ»¡è¶³é¡ºåºå…³ç³»ï¼Œå³åˆ¤æ–­æ˜¯å¦D0C1åº”è¯¥æ’åœ¨DOC2çš„å‰é¢ã€‚å›¾3å±•ç¤ºäº†ä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼šæŸ»è¯¢Q1å¯¹åº”çš„æœç´¢ç»“æœåˆ—è¡¨å¦‚ä½•è½¬æ¢ä¸ºæ–‡æ¡£å¯¹çš„å½¢å¼ï¼Œå› ä¸ºä»äººå·¥æ ‡æ³¨çš„ç›¸å…³æ€§å¾—åˆ†å¯ä»¥çœ‹å‡ºï¼ŒD0C2å¾—åˆ†æœ€é«˜ï¼ŒD0C3æ¬¡ä¹‹ï¼ŒD0C1å¾—åˆ†æœ€ä½ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¾—åˆ†å¤§å°é¡ºåºå…³ç³»å¾—åˆ°3ä¸ªå¦‚å›¾3æ‰€ç¤ºçš„æ–‡æ¡£å¯¹ï¼Œå°†æ¯ä¸ªæ–‡æ¡£å¯¹çš„æ–‡æ¡£è½¬æ¢ä¸ºç‰¹å¾å‘é‡åï¼Œå°±å½¢æˆäº†ä¸€ä¸ªå…·ä½“çš„è®­ç»ƒå®ä¾‹ã€‚ã€å¤‡æ³¨ï¼šæ ¹æ®æˆ‘çš„ç†è§£ï¼Œä¸‹å›¾æœ‰äº†ä¸€äº›é”™è¯¯ã€‚doc1åˆ†æ•°åº”è¯¥ä¸º3ï¼Œdoc2åˆ†æ•°åº”è¯¥ä¸º5ã€‘ã€‚<br><img src="https://ooo.0o0.ooo/2017/08/30/59a69437ecc6a.png" alt=""><br>                         å›¾3  æ–‡æ¡£å¯¹çš„æ–¹æ³•è®­ç»ƒå®ä¾‹</d0c1ï¼Œd0c2></p>
<p>æ ¹æ®è½¬æ¢åçš„è®­ç»ƒå®ä¾‹ï¼Œå°±å¯ä»¥åˆ©ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•è¿›è¡Œåˆ†ç±»å‡½æ•°çš„å­¦ä¹ ï¼Œå…·ä½“çš„å­¦ä¹ æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚SVM. Boostsã€ç¥ç»ç½‘ç»œç­‰éƒ½å¯ä»¥ä½œä¸ºå…·ä½“çš„å­¦ä¹ æ–¹æ³•ï¼Œä½†æ˜¯ä¸è®ºå…·ä½“æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œå…¶å­¦ä¹ ç›®æ ‡éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå³è¾“å…¥- ä¸ªæŸ»è¯¢å’Œæ–‡æ¡£å¯¹<doclï¼Œdoc2>, æœºå™¨å­¦ä¹ æ’åºèƒ½å¤Ÿåˆ¤æ–­è¿™ç§é¡ºåºå…³ç³»æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œé‚£ä¹ˆåœ¨æœç´¢ç»“æœä¸­D0C1åº”è¯¥æ’åœ¨D0C2 å‰é¢ï¼Œå¦åˆ™Doe2åº”è¯¥æ‘”åœ¨Doclå‰é¢ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±å®Œæˆæœç´¢ç»“æœçš„æ’åºä»»åŠ¡ã€‚</doclï¼Œdoc2></p>
<p>é‚£ä¹ˆï¼Œ<strong>å¦‚ä½•å°†æ’åºé—®é¢˜è½¬åŒ–ä¸ºæœºå™¨å­¦ä¹ èƒ½å¤Ÿå­¦ä¹ çš„åˆ†ç±»é—®é¢˜å‘¢ï¼Ÿ</strong></p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://www.cnblogs.com/kemaswill/p/3241963.html" target="_blank" rel="external">Learning to Rankä¹‹Ranking SVM ç®€ä»‹</a>ç»™å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­è§£é‡Šè¿™ä¸ªé—®é¢˜ï¼šç»™å®šæŸ¥è¯¢q, æ–‡æ¡£d1&gt;d2&gt;d3(äº¦å³æ–‡æ¡£d1æ¯”æ–‡æ¡£d2ç›¸å…³, æ–‡æ¡£d2æ¯”æ–‡æ¡£d3ç›¸å…³, x1, x2, x3åˆ†åˆ«æ˜¯d1, d2, d3çš„ç‰¹å¾)ã€‚ä¸ºäº†ä½¿ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•è¿›è¡Œæ’åºï¼Œæˆ‘ä»¬å°†æ’åºè½¬åŒ–ä¸ºä¸€ä¸ªåˆ†ç±»é—®é¢˜ã€‚æˆ‘ä»¬å®šä¹‰æ–°çš„è®­ç»ƒæ ·æœ¬, ä»¤x1-x2, x1-x3, x2-x3ä¸ºæ­£æ ·æœ¬,ä»¤x2-x1, x3-x1, x3-x2ä¸ºè´Ÿæ ·æœ¬, ç„¶åè®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»å™¨(æ”¯æŒå‘é‡æœº)æ¥å¯¹è¿™äº›æ–°çš„è®­ç»ƒæ ·æœ¬è¿›è¡Œåˆ†ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="https://i.loli.net/2017/08/30/59a694b19797c.png" alt=""><br>å·¦å›¾ä¸­æ¯ä¸ªæ¤­åœ†ä»£è¡¨ä¸€ä¸ªæŸ¥è¯¢, æ¤­åœ†å†…çš„ç‚¹ä»£è¡¨é‚£äº›è¦è®¡ç®—å’Œè¯¥æŸ¥è¯¢çš„ç›¸å…³åº¦çš„æ–‡æ¡£, ä¸‰è§’ä»£è¡¨å¾ˆç›¸å…³, åœ†åœˆä»£è¡¨ä¸€èˆ¬ç›¸å…³, å‰å·ä»£è¡¨ä¸ç›¸å…³ã€‚æˆ‘ä»¬æŠŠå·¦å›¾ä¸­çš„å•ä¸ªçš„æ–‡æ¡£è½¬æ¢æˆå³å›¾ä¸­çš„æ–‡æ¡£å¯¹(di, dj), å®å¿ƒæ–¹å—ä»£è¡¨æ­£æ ·æœ¬, äº¦å³di&gt;dj, ç©ºå¿ƒæ–¹å—ä»£è¡¨è´Ÿæ ·æœ¬, äº¦å³di &lt; djã€‚å°†ã€æ’åºé—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ã€‘ä¹‹å, æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¸¸ç”¨çš„æœºå™¨å­¦ä¹ æ–¹æ³•è§£å†³è¯¥é—®é¢˜ã€‚</p>
<p><strong>pairwiseå­˜åœ¨çš„é—®é¢˜</strong></p>
<p>å°½ç®¡æ–‡æ¡£å¯¹æ–¹æ³•ç›¸å¯¹å•æ–‡æ¡£æ–¹æ³•åšå‡ºäº†æ”¹è¿›ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•ä¹Ÿå­˜åœ¨ä¸¤ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼š</p>
<p>ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šæ–‡æ¡£å¯¹æ–¹æ³•åªè€ƒè™‘äº†ä¸¤ä¸ªæ–‡æ¡£å¯¹çš„ç›¸å¯¹å…ˆåé¡ºåºï¼Œå´æ²¡æœ‰è€ƒè™‘æ–‡æ¡£å‡ºç°åœ¨æœç´¢åˆ—è¡¨ä¸­çš„ä½ç½®ï¼Œæ’åœ¨æœç´¢ç«™æœå‰åˆ—çš„æ–‡æ¡£æ›´ä¸ºé‡è¦ï¼Œå¦‚æœå‰åˆ—æ–‡æ¡£å‡ºç°åˆ¤æ–­é”™è¯¯ï¼Œä»£ä»·æ˜æ˜¾é«˜äºæ’åœ¨åé¢çš„æ–‡æ¡£ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜çš„æ”¹è¿›æ€è·¯æ˜¯å¼•å…¥ä»£ä»·æ•æ„Ÿå› ç´ ï¼Œå³æ¯ä¸ªæ–‡æ¡£å¯¹æ ¹æ®å…¶åœ¨åˆ—è¡¨ä¸­çš„é¡ºåºå…·æœ‰ä¸åŒçš„æƒé‡ï¼Œè¶Šæ˜¯æ’åœ¨å‰åˆ—çš„æƒé‡è¶Šå¤§ï¼Œå³åœ¨æœç´¢åˆ—è¡¨å‰åˆ—å¦‚ æœæ’é”™é¡ºåºçš„è¯å…¶ä»˜å‡ºçš„ä»£ä»·æ›´é«˜?</p>
<p>å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šä¸åŒçš„æŸ»è¯¢ï¼Œå…¶ç›¸å…³æ–‡æ¡£æ•°é‡å·®å¼‚å¾ˆå¤§ï¼Œæ‰€ä»¥è½¬æ¢ä¸ºæ–‡æ¡£å¯¹ä¹‹åï¼Œ æœ‰çš„æŸ¥è¯¢å¯¹èƒ½æœ‰å‡ ç™¾ä¸ªå¯¹åº”çš„æ–‡æ¡£å¯¹ï¼Œè€Œæœ‰çš„æŸ¥è¯¢åªæœ‰åå‡ ä¸ªå¯¹åº”çš„æ–‡æ¡£å¯¹ï¼Œè¿™å¯¹æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„æ•ˆæœè¯„ä»·é€ æˆå›°éš¾ ?æˆ‘ä»¬è®¾æƒ³æœ‰ä¸¤ä¸ªæŸ¥è¯¢ï¼ŒæŸ»è¯¢Q1å¯¹åº”500ä¸ªæ–‡æ–‡æ¡£å¯¹ï¼ŒæŸ¥è¯¢Q2 å¯¹åº”10ä¸ªæ–‡æ¡£å¯¹ï¼Œå‡è®¾å­¦ä¹ ç³»ç»Ÿå¯¹äºæŸ»è¯¢Qlçš„æ–‡æ¡£å¯¹èƒ½å¤Ÿåˆ¤æ–­æ­£ç¡®480ä¸ªï¼Œå¯¹äºæŸ»è¯¢ Q2çš„ä¹‰æ ¼å¯¹èƒ½å¤Ÿåˆ¤æ–°æ­£ç¡®2ä¸ªï¼Œå¦‚æœä»æ€»çš„æ–‡æ¡£å¯¹æ•°é‡æ¥çœ‹ï¼Œè¿™ä¸ªå­¦ä¹ ç³»ç»Ÿçš„å‡†ç¡®ç‡æ˜¯ (480+2)/ï¼ˆ500+10ï¼‰=0.95.å³95%çš„å‡†ç¡®ç‡ï¼Œä½†æ˜¯ä»æŸ»è¯¢çš„è§’åº¦ï¼Œä¸¤ä¸ªæŸ»è¯¢å¯¹åº”çš„å‡†ç¡®ç‡ åˆ†åˆ«ä¸ºï¼š96%å’Œ20%,ä¸¤è€…å¹³å‡ä¸º58%,ä¸çº¯ç²¹ä»æ–‡æ¡£å¯¹åˆ¤æ–­çš„å‡†ç¡®ç‡ç›¸å·®ç”šè¿œï¼Œè¿™å¯¹å¦‚ä½•ç»§ç»­è°ƒä¼˜æœºå™¨å­¦ä¹ ç³»ç»Ÿä¼šå¸¦æ¥å›°æ‰°ã€‚</p>
<h2 id="ListWiseï¼ˆæ–‡æ¡£åˆ—è¡¨æ–¹æ³•ï¼‰">6.3. ListWiseï¼ˆæ–‡æ¡£åˆ—è¡¨æ–¹æ³•ï¼‰</h2><p><strong>listwiseç®€ä»‹</strong><br>å•æ–‡æ¡£æ–¹æ³•å°†è®­ç»ƒé›†é‡Œæ¯ä¸€ä¸ªæ–‡æ¡£å½“åšä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ–‡æ¡£å¯¹æ–¹æ³•å°†åŒä¸€ä¸ªæŸ»è¯¢çš„æœç´¢ç»“æœé‡Œä»»æ„ä¸¤ä¸ªæ–‡æ¡£å¯¹ä½œä¸ºä¸€ä¸ªè®­ç»ƒå®ä¾‹ã€‚ä¸Pointwiseå’ŒPairwiseæ–¹æ³•ä¸åŒï¼Œæ–‡æ¡£åˆ—è¡¨æ–¹æ³•ä¸ä¸Šè¿°ä¸¤ç§è¡¨ç¤ºæ–¹å¼ä¸åŒï¼Œæ˜¯å°†æ¯ä¸€ä¸ªæŸ¥è¯¢å¯¹åº”çš„ã€æ‰€æœ‰æœç´¢ç»“æœåˆ—è¡¨æ•´ä½“ã€‘ä½œä¸ºä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•ç§°ä¹‹ä¸ºæ–‡æ¡£åˆ—è¡¨æ–¹æ³•çš„åŸå› ã€‚</p>
<p><strong>listwiseåŸç†</strong><br>æ–‡æ¡£åˆ—è¡¨æ–¹æ³•æ ¹æ®Kä¸ªè®­ç»ƒå®ä¾‹ï¼ˆä¸€ä¸ªæŸ»è¯¢åŠå…¶å¯¹åº”çš„æ‰€æœ‰æœç´¢ç»“æœè¯„åˆ†ä½œä¸ºä¸€ä¸ªå® ä¾‹ï¼‰è®­ç»ƒå¾—åˆ°æœ€ä¼˜è¯„åˆ†å‡½æ•°Fï¼Œ å¯¹äºä¸€ä¸ªæ–°çš„ç”¨æˆ·æŸ»è¯¢ï¼Œå‡½æ•°F å¯¹æ¯ä¸€ä¸ªæ–‡æ¡£æ‰“åˆ†ï¼Œä¹‹åæŒ‰ç…§å¾—åˆ†é¡ºåºç”±é«˜åˆ°ä½æ’åºï¼Œå°±æ˜¯å¯¹åº”çš„æœç´¢ç»“æœã€‚ </p>
<p>æ‰€ä»¥å…³é”®é—®é¢˜æ˜¯ï¼š<strong>æ‹¿åˆ°è®­ç»ƒæ•°æ®ï¼Œå¦‚ä½•æ‰èƒ½è®­ç»ƒå¾—åˆ°æœ€ä¼˜çš„æ‰“åˆ†å‡½æ•°ï¼Ÿ</strong></p>
<p>è¿™é‡Œä»‹ç»ä¸€ç§è®­ç»ƒæ–¹æ³•ï¼Œå®ƒæ˜¯åŸºäºæœç´¢ç»“æœæ’åˆ—ç»„åˆçš„æ¦‚ç‡åˆ†å¸ƒæƒ…å†µæ¥è®­ç»ƒçš„ï¼Œå›¾4æ˜¯è¿™ç§æ–¹å¼è®­ç»ƒè¿‡ç¨‹çš„å›¾è§£ç¤ºæ„ã€‚<br><img src="https://i.loli.net/2017/08/30/59a6951348a74.png" alt=""><br>            å›¾4 ä¸åŒè¯„åˆ†å‡½æ•°çš„KLè·ç¦»</p>
<p>é¦–å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯æœç´¢ç»“æœæ’åˆ—ç»„åˆçš„æ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºæœç´¢å¼•æ“æ¥è¯´ï¼Œç”¨æˆ·è¾“å…¥æŸ»è¯¢Qï¼Œ æœç´¢å¼•æ“è¿”å›æœç´¢ç»“æœï¼Œæˆ‘ä»¬å‡è®¾æœç´¢ç»“æœé›†åˆåŒ…å«Aã€Bå’ŒC 3ä¸ªæ–‡æ¡£ï¼Œæœç´¢å¼•æ“è¦å¯¹æœç´¢ç»“æœæ’åºï¼Œè€Œè¿™3ä¸ªæ–‡æ¡£çš„é¡ºåºå…±æœ‰6ç§æ’åˆ—ç»„åˆæ–¹å¼:</p>
<p>ABC, ACB, BAG, BCA, CABå’ŒCBA,</p>
<p>è€Œæ¯ç§æ’åˆ—ç»„åˆéƒ½æ˜¯ä¸€ç§å¯èƒ½çš„æœç´¢ç»“æœæ’åºæ–¹æ³•ã€‚</p>
<p>å¯¹äºæŸä¸ªè¯„åˆ†å‡½æ•°Fæ¥è¯´ï¼Œå¯¹3ä¸ªæœç´¢ç»“æœæ–‡æ¡£çš„ç›¸å…³æ€§æ‰“åˆ†ï¼Œå¾—åˆ°3ä¸ªä¸åŒçš„ç›¸å…³åº¦å¾—åˆ†F(A)ã€F(B)å’ŒF(C)ï¼Œæ ¹æ®è¿™3ä¸ªå¾—åˆ†å°±å¯ä»¥è®¡ç®—6ç§æ’åˆ—ç»„åˆæƒ…å†µå„è‡ªçš„æ¦‚ç‡å€¼ã€‚</p>
<p>ä¸åŒçš„è¯„åˆ†å‡½æ•°ï¼Œå…¶6ç§æœç´¢ç»“æœæ’åˆ—ç»„åˆçš„æ¦‚ç‡åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>äº†è§£äº†ä»€ä¹ˆæ˜¯æœç´¢ç»“æœæ’åˆ—ç»„åˆçš„æ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬ä»‹ç»å¦‚ä½•æ ¹æ®è®­ç»ƒå®ä¾‹æ‰¾åˆ°æœ€ä¼˜çš„è¯„åˆ†å‡½æ•°ã€‚å›¾4å±•ç¤ºäº†ä¸€ä¸ªå…·ä½“çš„è®­ç»ƒå®ä¾‹ï¼Œå³æŸ»è¯¢Q1åŠå…¶å¯¹åº”çš„3ä¸ªæ–‡æ¡£çš„å¾—åˆ†æƒ…å†µï¼Œè¿™ä¸ªå¾—åˆ†æ˜¯ç”±äººå·¥æ‰“ä¸Šå»çš„ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åšæ˜¯æ ‡å‡†ç­”æ¡ˆã€‚</p>
<p>å¯ä»¥è®¾æƒ³å­˜åœ¨ä¸€ä¸ªæœ€ä¼˜çš„è¯„åˆ†å‡½æ•°gï¼Œå¯¹æŸ¥è¯¢Q1æ¥è¯´ï¼Œå…¶æ‰“åˆ†ç»“æœæ˜¯ï¼šAæ–‡æ¡£å¾—6åˆ†ï¼ŒBæ–‡æ¡£å¾—4åˆ†ï¼ŒCæ–‡æ¡£å¾—3åˆ†ï¼Œ </p>
<p>å› ä¸ºå¾—åˆ†æ˜¯äººå·¥æ‰“çš„ï¼Œæ‰€ä»¥å…·ä½“è¿™ä¸ªå‡½æ•°gæ˜¯æ€æ ·çš„æˆ‘ä»¬ä¸æ¸…æ¥šï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°ä¸€ ä¸ªå‡½æ•°ï¼Œä½¿å¾—å‡½æ•°å¯¹Qlçš„æœç´¢ç»“æœæ‰“åˆ†é¡ºåºå’Œäººå·¥æ‰“åˆ†é¡ºåºå°½å¯èƒ½ç›¸åŒã€‚æ—¢ç„¶äººå·¥æ‰“åˆ† (è™šæ‹Ÿçš„å‡½æ•°g) å·²çŸ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡½æ•°gå¯¹åº”çš„æœç´¢ç»“æœæ’åˆ—ç»„åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå…¶å…·ä½“åˆ†å¸ƒæƒ…å†µå¦‚å›¾4ä¸­é—´çš„æ¦‚ç‡åˆ†å¸ƒæ‰€ç¤ºã€‚</p>
<p>å‡è®¾å­˜åœ¨ä¸¤ä¸ªå…¶ä»–å‡½æ•°hå’Œfï¼Œå®ƒä»¬çš„è®¡ç®—æ–¹æ³•å·²çŸ¥ï¼Œå¯¹åº”çš„å¯¹3ä¸ªæœç´¢ç»“æœçš„æ‰“åˆ†åœ¨å›¾ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œç”±æ‰“åˆ†ç»“æœä¹Ÿå¯ä»¥æ¨å‡ºæ¯ä¸ªå‡½æ•°å¯¹åº”çš„æœç´¢ç»“æœæ’åˆ—ç»„åˆæ¦‚ç‡åˆ†å¸ƒï¼Œé‚£ä¹ˆhä¸få“ªä¸ªä¸è™šæ‹Ÿçš„æœ€ä¼˜è¯„åˆ†å‡½æ•°gæ›´æ¥è¿‘å‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬å¯ä»¥ç”¨ä¸¤ä¸ªåˆ†å¸ƒæ¦‚ç‡ä¹‹é—´çš„è·ç¦»è¿œè¿‘æ¥åº¦é‡ç›¸ä¼¼æ€§ï¼ŒKLè·ç¦»å°±æ˜¯ä¸€ç§è¡¡é‡æ¦‚ç‡åˆ†å¸ƒå·®å¼‚å¤§å°çš„è®¡ç®—å·¥å…·ï¼Œé€šè¿‡åˆ†åˆ«è®¡ç®—hä¸gçš„å·®å¼‚å¤§å°åŠfä¸gçš„å·®å¼‚å¤§å°ï¼Œå¯ä»¥çœ‹å‡ºfæ¯”hæ›´æ¥è¿‘çš„æœ€ä¼˜å‡½æ•°gï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä¼˜å…ˆé€‰fä½œä¸ºå°†æ¥æœç´¢å¯ç”¨çš„è¯„åˆ†å‡½æ•°ï¼Œè®­ç»ƒè¿‡ç¨‹å°±æ˜¯åœ¨å¯èƒ½çš„å‡½æ•°ä¸­å¯»æ‰¾æœ€æ¥è¿‘è™šæ‹Ÿæœ€ä¼˜å‡½æ•°gçš„é‚£ä¸ªå‡½æ•°ä½œä¸ºè®­ç»ƒç»“æœï¼Œå°†æ¥ä½œä¸ºåœ¨æœç´¢æ—¶çš„è¯„åˆ†å‡½æ•°ã€‚</p>
<p>ä¸Šè¿°ä¾‹å­åªæ˜¯æè¿°äº†å¯¹äºå•ä¸ªè®­ç»ƒå®ä¾‹å¦‚ä½•é€šè¿‡è®­ç»ƒæ‰¾åˆ°æœ€ä¼˜å‡½æ•°ï¼Œäº‹å®ä¸Šæˆ‘ä»¬æœ‰K ä¸ªè®­ç»ƒå®ä¾‹ï¼Œè™½ç„¶å¦‚æ­¤ï¼Œå…¶è®­ç»ƒè¿‡ç¨‹ä¸ä¸Šè¿°è¯´æ˜æ˜¯ç±»ä¼¼çš„ï¼Œå¯ä»¥è®¤ä¸ºå­˜åœ¨ä¸€ä¸ªè™šæ‹Ÿçš„æœ€ä¼˜ è¯„åˆ†å‡½æ•°g(å®é™…ä¸Šæ˜¯äººå·¥æ‰“åˆ†ï¼‰ï¼Œè®­ç»ƒè¿‡ç¨‹å°±æ˜¯åœ¨æ‰€æœ‰è®­ç»ƒå®ä¾‹åŸºç¡€ä¸Šï¼Œæ¢å¯»æ‰€æœ‰å¯èƒ½çš„ å€™é€‰å‡½æ•°ï¼Œä»ä¸­é€‰æ‹©é‚£ä¸ªKLè·ç¦»æœ€æ¥è¿‘äºå‡½æ•°gçš„ï¼Œä»¥æ­¤ä½œä¸ºå®é™…ä½¿ç”¨çš„è¯„åˆ†å‡½æ•°ã€‚ ç»éªŒç»“æœè¡¨æ˜ï¼ŒåŸºäºæ–‡æ¡£åˆ—è¡¨æ–¹æ³•çš„æœºå™¨å­¦ä¹ æ’åºæ•ˆæœè¦å¥½äºå‰è¿°ä¸¤ç§æ–¹æ³•ã€‚</p>
<p><strong>å¸¸ç”¨ç®—æ³•</strong><br>Listwiseç®—æ³•ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ç®—æ³•ï¼šLambdaRank (NIPS 2006), AdaRank (SIGIR 2007), SVM-MAP (SIGIR 2007), SoftRank (LR4IR 2007), GPRank (LR4IR 2007), CCA (SIGIR 2007), RankCosine (IP&amp;M 2007), ListNet (ICML 2007), ListMLE (ICML 2008) ã€‚</p>
<p>ç›¸æ¯”äºPointwiseå’ŒPairwiseæ–¹æ³•ï¼ŒListwiseæ–¹æ³•ç›´æ¥ä¼˜åŒ–ç»™å®šæŸ¥è¯¢ä¸‹ï¼Œæ•´ä¸ªæ–‡æ¡£é›†åˆçš„åºåˆ—ï¼Œæ‰€ä»¥æ¯”è¾ƒå¥½çš„è§£å†³äº†å…‹æœäº†ä»¥ä¸Šç®—æ³•çš„ç¼ºé™·ã€‚Listwiseæ–¹æ³•ä¸­çš„LambdaMART(æ˜¯å¯¹RankNetå’ŒLambdaRankçš„æ”¹è¿›)åœ¨Yahoo Learning to Rank Challengeè¡¨ç°å‡ºæœ€å¥½çš„æ€§èƒ½ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">7. å‚è€ƒæ–‡çŒ®</h1><p>[1]. Learning to Rank for Information Retrieval. Tie-yan Liu.<br>[2]. Learning to Rank for Information Retrieval and Natural Language Processing. Hang Li.<br>[3]. A Short Introduction to Learning to Rank. Hang Li.<br>[4]. Optimizing Search Engines using Clickthrough Data. Thorsten Joachims. SIGKDD,2002.<br>[5]. Learning to Rankå°ç»“</p>
<ol>
<li><a href="http://www.cnblogs.com/kemaswill/archive/2013/06/01/3109497.html" target="_blank" rel="external">Learning to Rank ç®€ä»‹</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/26221188" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26221188</a></li>
<li><a href="http://www.javashuo.com/content/p-5980716.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ æ’åºä¹‹Learning to Rankç®€å•ä»‹ç»</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> L2R </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ•°æ®åº“å¸¸ç”¨è¯­å¥]]></title>
      <url>/2017/07/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5/</url>
      <content type="html"><![CDATA[<h1 id="å¯åŠ¨-å…³é—­">1. å¯åŠ¨/å…³é—­</h1><ul>
<li>å¯åŠ¨ï¼š<code>sudo systemctl start mysqld</code>æˆ–<code>mysql -u root -p</code></li>
<li>æŸ¥çœ‹çŠ¶æ€ï¼š<code>sudo systemctl status mysqld</code></li>
</ul>
<h1 id="linuxä¸‹æ‰§è¡Œsqlè„šæœ¬">2. linuxä¸‹æ‰§è¡Œsqlè„šæœ¬</h1><p>è¿›å…¥åˆ°mysqlåï¼Œæ‰§è¡Œ<code>source /è·¯å¾„/tester.sql;</code>å³å¯</p>
<h1 id="databasesæ“ä½œ">3. databasesæ“ä½œ</h1><ul>
<li>åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“ï¼š<code>SHOW DATABASES;</code></li>
<li>åˆ›å»ºæ•°æ®åº“ï¼š<code>CREATE DATABASE database_name;</code></li>
<li>è¿›å…¥æŸæ•°æ®åº“ï¼š<code>USE database_name;</code></li>
</ul>
<h1 id="tablesæ“ä½œ">4. tablesæ“ä½œ</h1><ul>
<li>åˆ—å‡ºæ‰€æœ‰è¡¨ï¼š<code>SHOW TABLES;</code></li>
<li><p>åˆ›å»ºè¡¨ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE è¡¨åç§°</div><div class="line">(</div><div class="line">åˆ—åç§°1 æ•°æ®ç±»å‹,</div><div class="line">åˆ—åç§°2 æ•°æ®ç±»å‹,</div><div class="line">åˆ—åç§°3 æ•°æ®ç±»å‹,</div><div class="line">....</div><div class="line">)</div></pre></td></tr></table></figure>
</li>
<li><p>è¾“å‡ºè¡¨å¤´ï¼š<code>SHOW COLUMNS FROM Table_name;</code></p>
</li>
</ul>
<h1 id="MYSQLæ•°æ®ç±»å‹">5. MYSQLæ•°æ®ç±»å‹</h1><p><a href="http://www.runoob.com/mysql/mysql-data-types.html" target="_blank" rel="external">MySQL æ•°æ®ç±»å‹</a></p>
<h1 id="ç›¸å…³Leetcodeé¢˜">6. ç›¸å…³Leetcodeé¢˜</h1><h2 id="Left-Join">6.1. Left Join</h2><p>æ•™ç¨‹ï¼š<a href="http://www.w3school.com.cn/sql/sql_join_left.asp" target="_blank" rel="external">SQL LEFT JOIN å…³é”®å­—</a></p>
<p>LEFT JOIN å…³é”®å­—ä»å·¦è¡¨ï¼ˆtable1ï¼‰è¿”å›æ‰€æœ‰çš„è¡Œï¼Œå³ä½¿å³è¡¨ï¼ˆtable2ï¼‰ä¸­æ²¡æœ‰åŒ¹é…ã€‚å¦‚æœå³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œåˆ™ç»“æœä¸º NULLã€‚</p>
<h2 id="Combine-Two-Tables">6.2. Combine Two Tables</h2><p>Personè¡¨æœ‰PersonId, FirstName, LastName. Adressè¡¨æœ‰AdressId, PersonId, City, State. è·å¾—æ•°æ®ï¼šFirstName, LastName, City, Stateã€‚ä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Person :</div><div class="line">PersonId, FirstName, LastName</div><div class="line">1,        Wang,      Allen</div><div class="line"></div><div class="line"></div><div class="line">Adress:</div><div class="line">AdressId, PersonId, City,           State</div><div class="line">1,        2,        New York City,  New York</div><div class="line">2,        1,        BJ,             BJ</div><div class="line"></div><div class="line"></div><div class="line">è¿”å›ï¼š</div><div class="line">FirstName, LastName, City, State</div><div class="line">Wang,      Allen,    BJ,   BJ</div><div class="line"></div><div class="line"></div><div class="line">æŸ¥è¯¢è¯­å¥ï¼š</div><div class="line"></div><div class="line">SELECT Person.FirstName, Person.LastName, Address.City, Address.State FROM Person LEFT JOIN Address ON Person.PersonId=Address.PersonId;</div></pre></td></tr></table></figure>
<h1 id="å‚è€ƒæ–‡çŒ®">7. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.centoscn.com/mysql/2016/0315/6844.html" target="_blank" rel="external">CentOS 7 å®‰è£… MySQL</a></li>
<li><a href="http://www.2cto.com/database/201210/164243.html" target="_blank" rel="external">linuxä¸‹æ‰§è¡Œmysqlçš„sqlæ–‡ä»¶</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ•°æ®åº“ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ¨èç³»ç»Ÿåˆæ¢]]></title>
      <url>/2017/07/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%88%9D%E6%8E%A2/</url>
      <content type="html"><![CDATA[<p>æ¨èç³»ç»Ÿæ ¹æ®ç”¨æˆ·è¿‡å»çš„è´­ä¹°å’Œæœç´¢å†å²ï¼Œä»¥åŠå…¶ä»–ç”¨æˆ·çš„è¡Œä¸ºï¼Œè‡ªä¸»åœ°ä¸ºå„ä¸ªç”¨æˆ·è¯†åˆ«æ¨èå†…å®¹ã€‚</p>
<p>å¸¸è§çš„æ¨èç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ç±»ï¼š</p>
<ul>
<li>ååŒè¿‡æ»¤æ¨è</li>
<li>åŸºäºå†…å®¹çš„æ¨è</li>
<li>æ··åˆæ¨è</li>
</ul>
<p>å‚è€ƒæ–‡çŒ®<a href="https://www.zhihu.com/question/19971859" target="_blank" rel="external">ååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹æ¨èæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a>ç»™å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œæ¥åŒºåˆ†ååŒè¿‡æ»¤å’Œå†…å®¹æ¨èï¼š<br>ä¸¾ä¸ªç®€å•çš„å°ä¾‹å­ï¼Œæˆ‘ä»¬å·²çŸ¥é“ï¼š<br>ç”¨æˆ·u1å–œæ¬¢çš„ç”µå½±æ˜¯Aï¼ŒBï¼ŒC<br>ç”¨æˆ·u2å–œæ¬¢çš„ç”µå½±æ˜¯A, C, E, F<br>ç”¨æˆ·u3å–œæ¬¢çš„ç”µå½±æ˜¯Bï¼ŒD</p>
<p>æˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼šå†³å®šå¯¹u1æ˜¯ä¸æ˜¯åº”è¯¥æ¨èFè¿™éƒ¨ç”µå½±</p>
<p>åŸºäºå†…å®¹çš„åšæ³•ï¼šè¦åˆ†æFçš„ç‰¹å¾å’Œu1æ‰€å–œæ¬¢çš„Aã€Bã€Cçš„ç‰¹å¾ï¼Œéœ€è¦çŸ¥é“çš„ä¿¡æ¯æ˜¯Aï¼ˆæˆ˜äº‰ç‰‡ï¼‰ï¼ŒBï¼ˆæˆ˜äº‰ç‰‡ï¼‰ï¼ŒCï¼ˆå‰§æƒ…ç‰‡ï¼‰ï¼Œå¦‚æœFï¼ˆæˆ˜äº‰ç‰‡ï¼‰ï¼Œé‚£ä¹ˆFå¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥æ¨èç»™u1ï¼Œè¿™æ˜¯åŸºäºå†…å®¹çš„åšæ³•ï¼Œä½ éœ€è¦å¯¹itemè¿›è¡Œç‰¹å¾å»ºç«‹å’Œå»ºæ¨¡ã€‚</p>
<p>ååŒè¿‡æ»¤çš„åŠæ³•ï¼šé‚£ä¹ˆä½ å®Œå…¨å¯ä»¥å¿½ç•¥itemçš„å»ºæ¨¡ï¼Œå› ä¸ºè¿™ç§åŠæ³•çš„å†³ç­–æ˜¯ä¾èµ–userå’Œitemä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ç”¨æˆ·å’Œç”µå½±ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬ä¸å†éœ€è¦çŸ¥é“ABCFå“ªäº›æ˜¯æˆ˜äº‰ç‰‡ï¼Œå“ªäº›æ˜¯å‰§æƒ…ç‰‡ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ç”¨æˆ·u1å’Œu2æŒ‰ç…§itemå‘é‡è¡¨ç¤ºï¼Œä»–ä»¬çš„ç›¸ä¼¼åº¦æ¯”è¾ƒé«˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠu2æ‰€å–œæ¬¢çš„Fè¿™éƒ¨å½±ç‰‡æ¨èç»™u1</p>
<p>ä¸‹é¢æˆ‘ä»¬å¯¹è¿™å‡ ç§æ¨èç®—æ³•è¿›è¡Œç®€ä»‹ã€‚</p>
<h1 id="ååŒè¿‡æ»¤æ¨èç®—æ³•">1. ååŒè¿‡æ»¤æ¨èç®—æ³•</h1><h2 id="ç®€ä»‹">1.1. ç®€ä»‹</h2><p><strong>ç®€ä»‹</strong>ï¼šé€šè¿‡åœ¨ç”¨æˆ·çš„ä¸€ç³»åˆ—è¡Œä¸ºä¸­å¯»æ‰¾ç‰¹å®šæ¨¡å¼æ¥äº§ç”Ÿç”¨æˆ·ç‰¹æ®Šæ¨èã€‚<br><strong>è¾“å…¥</strong>ï¼šä»…ä»…ä¾èµ–äºæƒ¯ç”¨æ•°æ®ï¼ˆä¾‹å¦‚è¯„ä»·ã€è´­ä¹°ã€ä¸‹è½½ç­‰ç”¨æˆ·åå¥½è¡Œä¸ºï¼‰ã€‚<br><strong>æ–¹å¼</strong>ï¼šå¯é€šè¿‡å•ä¸ªç”¨æˆ·è¡Œä¸ºå•ç‹¬æ„é€ æ¨¡å‹ï¼›ä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–ç”¨æˆ·è¡Œä¸ºï¼Œä½¿ç”¨ç¾¤ç»„çŸ¥è¯†å¹¶åŸºäºç›¸ä¼¼ç”¨æˆ·æ¥å½¢æˆæ¨èå†…å®¹ã€‚<br><strong>ç±»å‹</strong>ï¼š</p>
<ul>
<li>åŸºäºé¢†åŸŸçš„ååŒè¿‡æ»¤ï¼ˆuser-basedæˆ–item-basedï¼‰</li>
<li>åŸºäºæ¨¡å‹çš„ååŒè¿‡æ»¤ï¼ˆçŸ©é˜µå› å­åˆ†è§£ã€å—é™ç»å°”å…¹æ›¼æœºã€è´å¶æ–¯ç½‘ç»œç­‰ç­‰ï¼‰</li>
</ul>
<h2 id="å®ä¾‹">1.2. å®ä¾‹</h2><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä»¬ä»¥åšå®¢æ¨èä¸ºä¾‹ã€‚<br>å·²çŸ¥ç”¨æˆ·å·²è®¢é˜…å¹¶é˜…è¯»åšå®¢çš„ä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·åå¥½æ¥å¯¹ä»–ä»¬è¿›è¡Œåˆ†ç»„ã€‚ä¾‹å¦‚å¯ä»¥å°†é˜…è¯»å¤šç¯‡ç›¸åŒåšå®¢çš„ç”¨æˆ·åˆ†åˆ°ä¸€ä¸ªç»„ã€‚åŸºäºç»„ä¿¡æ¯ï¼Œå¯è¯†åˆ«å‡ºè¯¥ç»„é˜…è¯»äº†å“ªäº›æœ€æµè¡Œçš„åšå®¢ï¼Œç„¶åå¯¹äºç¾¤ç»„ä¸­çš„æŸä¸ªç”¨æˆ·ï¼Œå¯ä»¥å‘ä»–æ¨èä»–è¿˜æœªé˜…è¯»ä¹Ÿæœªè®¢é˜…çš„æœ€æµè¡Œçš„åšå®¢ã€‚</p>
<ol>
<li>åœ¨ä¸‹å›¾çš„è¡¨ä¸­ï¼Œè¡Œæ˜¯ä¸€ç»„åšå®¢ï¼Œåˆ—æ˜¯ç”¨æˆ·ï¼Œè¡¨æ˜¯è¯¥ç”¨æˆ·é˜…è¯»è¯¥æ–‡ç« çš„æ•°é‡ã€‚</li>
<li>é€šè¿‡æ ¹æ®ç”¨æˆ·çš„é˜…è¯»ä¹ æƒ¯æ¥ä¸ºç”¨æˆ·åˆ’åˆ†é›†ç¾¤ã€‚æ¯”å¦‚ä½¿ç”¨ä¸€ä¸ª nearest-neighbor ç®—æ³•ï¼šæ‰¾åˆ°ä¸å½“å‰ç”¨æˆ·userå£å‘³ç›¸è¿‘çš„kå„ç”¨æˆ·ï¼›å¯¹ç”¨æˆ·uæ²¡æœ‰è§è¿‡çš„åšå®¢pï¼Œåˆ©ç”¨kä¸ªè¿‘é‚»å¯¹pè¿›è¡Œé¢„æµ‹è¯„åˆ†ã€‚</li>
<li>ç”¨ä»¥ä¸Šç®—æ³•æˆ‘ä»¬å¾—åˆ°ä¸¤ä¸ªåˆ†åˆ«åŒ…å«ä¸¤ä¸ªç”¨æˆ·çš„clusterï¼Œæ¯ä¸ªclusterä¸­çš„æˆå‘˜éƒ½æœ‰ç›¸ä¼¼çš„é˜…è¯»ä¹ æƒ¯ï¼šMarc å’Œ Eliseï¼ˆä»–ä»¬éƒ½é˜…è¯»äº†å¤šç¯‡å…³äº LinuxÂ® å’Œäº‘è®¡ç®—çš„æ–‡ç« ï¼‰å½¢æˆ Cluster 1ã€‚Cluster 2 ä¸­åŒ…å« Megan å’Œ Jillï¼Œä»–ä»¬éƒ½é˜…è¯»äº†å¤šç¯‡å…³äº Javaâ„¢ å’Œæ•æ·æ€§çš„æ–‡ç« ã€‚</li>
</ol>
<p><img src="https://i.loli.net/2017/07/16/596ae56897d11.png" alt=""> </p>
<h2 id="nearest-nerghborç®—æ³•">1.3. nearest-nerghborç®—æ³•</h2><p>åˆšæ‰è¯´åˆ°äº†ç”¨nearest-nerghborç®—æ³•æ¥è®¡ç®—user-basedçš„userç›¸ä¼¼åº¦ï¼Œç„¶åå†è¿›è¡Œæ¨èï¼Œé‚£ä¹ˆå°±å¸¦æ¥äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•åº¦é‡userä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Ÿ</li>
<li><p>å¦‚ä½•æ¨èåšå®¢ï¼Ÿ</p>
</li>
<li><p>é¦–å…ˆè§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œ<strong>å¦‚ä½•åº¦é‡ç›¸ä¼¼æ€§ï¼Ÿ</strong></p>
</li>
</ul>
<p>å…ˆè¯´<strong>ç»“è®ºï¼šé‡‡ç”¨æ”¹è¿›çš„ä½™å¼¦ç›¸ä¼¼åº¦æ¥è¿›è¡Œåº¦é‡ã€‚</strong></p>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹Pearsonç›¸å…³ç³»æ•°å’Œä½™å¼¦ç›¸ä¼¼åº¦ã€‚<br>pearsonç›¸å…³ç³»æ•°ç”¨æ¥æè¯‰ä¸¤ç»„å‘é‡ä¸€åŒå˜åŒ–çš„è¶‹åŠ¿ï¼Œå–å€¼ä»+1ï¼ˆå¼ºæ­£ç›¸å…³ï¼‰åˆ°-1ï¼ˆå¼ºè´Ÿç›¸å…³ï¼‰ã€‚ç”¨æˆ·aå’Œç”¨æˆ·bçš„ç›¸ä¼¼åº¦ï¼š<br><img src="https://i.loli.net/2017/07/16/596af2f5cba54.png" alt=""><br>å…¶ä¸­ï¼š</p>
<ul>
<li>$r_{a,p}$è¡¨ç¤ºç”¨æˆ·aå¯¹åšå®¢pçš„é˜…è¯»é‡ï¼›</li>
<li>$\overline{r_a}$è¡¨ç¤ºç”¨æˆ·açš„å¹³å‡é˜…è¯»é‡ï¼›</li>
<li>pearsonç›¸å…³ç³»æ•°è¶Šæ¥è¿‘äº1ï¼Œé‚£ä¹ˆç”¨æˆ·aã€bæœˆç›¸ä¼¼ã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œè¿™å¹¶ä¸å®Œç¾ï¼Œpearsonç›¸å…³ç³»æ•°å­˜åœ¨ä»¥ä¸‹ç¼ºé™·ï¼š</p>
<ul>
<li>æœªè€ƒè™‘åšå®¢çš„æ•°é‡å¯¹ç›¸ä¼¼åº¦çš„å½±å“ï¼›<br>ä¾‹å¦‚ï¼šç”¨æˆ·aä¸bæœ‰ä¸¤ä¸ªé‡å é¡¹ï¼Œç”¨æˆ·aä¸cæœ‰10ä¸ªé‡å é¡¹ï¼›ä½†æœ‰å¯èƒ½å‡ºç°$sim(a,c)&lt; sim(a,b)$çš„æƒ…å†µï¼Œå› ä¸ºè®¡ç®—pearsonç³»æ•°æ—¶ï¼Œé‡å é¡¹çš„ä¸ªæ•°æ²¡æœ‰å½±å“ã€‚ä½†è¿™å¹¶ä¸èƒ½è¯´æ˜ç”¨æˆ·bæ›´ä¸aç›¸ä¼¼ã€‚</li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªé‡å é¡¹ï¼Œæˆ–æ‰€æœ‰é‡å é¡¹çš„è¯„åˆ†éƒ½ç›¸ç­‰ï¼Œå°±æ— æ³•è®¡ç®—pearsonç›¸å…³ç³»æ•°ï¼ˆåˆ†å­æˆ–åˆ†æ¯ä¸º0ï¼‰ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ç§ç›¸ä¼¼åº¦åº¦é‡æ–¹å¼â€”â€”<strong>ä½™å¼¦ç›¸ä¼¼åº¦</strong>ã€‚<br><img src="https://i.loli.net/2017/07/16/596b1d46cc650.png" alt=""><br>è¿™ä»£è¡¨ä¸¤ä¸ªuserå‘é‡çš„å¤¹è§’ã€‚ä½†è¿™ä¸å‘é‡çš„å¤§å°æ— å…³ï¼Œå› æ­¤ä¼Ÿå¤§çš„ç§‘å­¦å®¶ä»¬æå‡ºäº†<strong>æ”¹è¿›çš„ä½™å¼¦ç›¸ä¼¼åº¦</strong>ï¼š<br><img src="https://i.loli.net/2017/07/16/596b1d9a7a066.png" alt=""><br>å®ƒçš„å–å€¼èŒƒå›´åœ¨$[-1,1]$ã€‚</p>
<ul>
<li>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼Œ<strong>å¦‚ä½•æ¨èåšå®¢ï¼Ÿ</strong></li>
</ul>
<p>å…ˆé€‰å–kä¸ªç”¨æˆ·çš„è¿‘é‚»ï¼Œåˆ©ç”¨è¿™kä¸ªè¿‘é‚»çš„é˜…è¯»æ’è¡Œæ¥åšæ¨èã€‚</p>
<p>å…¶å®ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºuser-basedçš„ã€‚å®ƒå¹¶ä¸æ˜¯å®Œç¾çš„ã€‚æœ‰ä¸¤ä¸ªé—®é¢˜ï¼šæ•°æ®ç¨€ç–ï¼ˆç”¨æˆ·çœ‹è¿‡çš„åšå®¢éå¸¸å°‘ï¼‰å’Œç®—æ³•å¤æ‚åº¦é«˜ã€‚è€Œè¿™ä¸¤ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡item-basedæ–¹æ³•æ¥è§£å†³ã€‚å…·ä½“å†…å®¹è§å‚è€ƒæ–‡çŒ®<a href="http://www.chongchonggou.com/g_60592064.html" target="_blank" rel="external">åŸºäºç‰©å“çš„ååŒè¿‡æ»¤æ¨èç®—æ³•â€”â€”è¯»â€œItem-Based Collaborative Filtering Recommendation Algorithmsâ€</a></p>
<h2 id="ååŒè¿‡æ»¤çš„æ–¹æ³•">1.4. ååŒè¿‡æ»¤çš„æ–¹æ³•</h2><p>ä¸Šé¢æåˆ°çš„æ–¹æ³•æ˜¯<strong>åŸºäºé¢†åŸŸï¼ˆè®°å¿†ï¼‰çš„æ–¹æ³•</strong>ï¼Œè€Œè¿˜æœ‰ä¸€ç±»å«<strong>åŸºäºæ¨¡å‹çš„æ–¹æ³•â€”â€”å³éšè¯­ä¹‰æ¨¡å‹</strong>ã€‚çŸ©é˜µåˆ†è§£å°±æ˜¯å®ç°éšè¯­ä¹‰æ¨¡å‹çš„æˆæœå®ç°ã€‚å‚è€ƒæ–‡çŒ®<a href="http://baogege.info/2014/10/19/matrix-factorization-in-recommender-systems/" target="_blank" rel="external">ä¸ªæ€§åŒ–æ¨èä¸­çš„çŸ©é˜µåˆ†è§£æŠ€æœ¯</a>ç»™å‡ºäº†çŸ©é˜µåˆ†è§£çš„æ–¹æ³•ã€‚<br>çŸ©é˜µåˆ†è§£çš„æ ¸å¿ƒæ€æƒ³è®¤ä¸ºç”¨æˆ·çš„å…´è¶£åªå—å°‘æ•°å‡ ä¸ªå› ç´ çš„å½±å“ï¼Œå› æ­¤å°†ç¨€ç–ä¸”é«˜ç»´çš„User-Itemè¯„åˆ†çŸ©é˜µåˆ†è§£ä¸ºä¸¤ä¸ªä½ç»´çŸ©é˜µï¼Œå³é€šè¿‡Userã€Itemè¯„åˆ†ä¿¡æ¯æ¥å­¦ä¹ åˆ°çš„ç”¨æˆ·ç‰¹å¾çŸ©é˜µPå’Œç‰©å“ç‰¹å¾çŸ©é˜µQï¼Œé€šè¿‡é‡æ„çš„ä½ç»´çŸ©é˜µé¢„æµ‹ç”¨æˆ·å¯¹äº§å“çš„è¯„åˆ†ã€‚</p>
<h1 id="åŸºäºå†…å®¹çš„æ¨è">2. åŸºäºå†…å®¹çš„æ¨è</h1><p>åŸºäºå†…å®¹çš„æ¨èæ˜¯æŒ‡æ ¹æ®ç”¨æˆ·çš„è¡Œä¸ºæ¥æ¨èå†…å®¹ã€‚</p>
<p><strong>åŸºäºå†…å®¹æ¨èçš„è¿‡ç¨‹ï¼š</strong></p>
<ul>
<li>item Representation:ä¸ºæ¯ä¸ªitemæŠ½å–ç‰¹å¾ï¼ˆä¹Ÿå°±æ˜¯itemçš„å†…å®¹ï¼‰æ¥è¡¨ç¤ºitem;</li>
<li>Profile Learning:åˆ©ç”¨ç”¨æˆ·è¿‡å»å–œæ¬¢ï¼ˆåŠä¸å–œæ¬¢ï¼‰çš„itemçš„ç‰¹å¾æ•°æ®ï¼Œæ¥å­¦ä¹ å‡ºæ­¤ç”¨æˆ·çš„å–œå¥½ç‰¹å¾(profile)ï¼›</li>
<li>Recommendation Generation:é€šè¿‡æ¯”è¾ƒä¸Šä¸€æ­¥å¾—åˆ°çš„ç”¨æˆ·profileä¸å€™é€‰itemçš„ç‰¹å¾ï¼Œä¸ºæ­¤ç”¨æˆ·æ¨èä¸€ç»„ç›¸å…³æ€§æœ€å¤§çš„itemã€‚</li>
</ul>
<p>ä¸Šé¢ä¸‰ä¸ªæ­¥éª¤æœ‰ä¸€å¼ å¾ˆç»†è‡´çš„æµç¨‹å›¾ï¼ˆç¬¬ä¸€æ­¥å¯¹åº”ç€Content Analyzerï¼Œç¬¬äºŒæ­¥å¯¹åº”ç€Profile Learnerï¼Œç¬¬ä¸‰æ­¥å¯¹åº”ç€Filtering Componentï¼‰ï¼š<br><img src="https://i.loli.net/2017/07/16/596b2b6a02c0e.png" alt=""><br>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºåšå®¢æ¨èæ¥è¯´ï¼Œä¸€ä¸ªitemå°±æ˜¯ä¸€ç¯‡åšå®¢ï¼›</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆä»æ–‡ç« å†…å®¹ä¸­æŠ½å–æ–‡ç« çš„ç‰¹å¾ã€‚å¸¸ç”¨ç®—æ³•å°±æ˜¯åˆ©ç”¨è¿™ç¯‡æ–‡ç« çš„å…³é”®è¯æ¥ä»£è¡¨è¿™ç¯‡æ–‡ç« ï¼Œè€Œæ¯ä¸ªè¯å¯¹åº”çš„æƒé‡å¾€å¾€ä½¿ç”¨tf-idfæ¥è®¡ç®—ã€‚åˆ©ç”¨è¿™ç§æ–¹æ³•ï¼Œå°†ä¸€ç¯‡æ–‡ç« ç”¨ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºå³å¯ï¼›</li>
<li>ç¬¬äºŒæ­¥ï¼Œæ ¹æ®ç”¨æˆ·è¿‡å»å–œå¥½æ¥åˆ»ç”»ç”¨æˆ·profileã€‚æœ€ç®€å•çš„æ–¹æ³•å¯ä»¥æŠŠç”¨æˆ·æ‰€æœ‰å–œæ¬¢çš„æ–‡ç« å¯¹åº”çš„å‘é‡çš„å¹³å‡å€¼ä½œä¸ºæ­¤ç”¨æˆ·çš„profileã€‚æ¯”å¦‚æŸä¸ªç”¨æˆ·ç»å¸¸å…³æ³¨ä¸æ¨èç³»ç»Ÿæœ‰å…³çš„æ–‡ç« ï¼Œé‚£ä¹ˆä»–çš„profileä¸­â€œCBâ€ã€â€œCFâ€å’Œâ€œæ¨èâ€å¯¹åº”çš„æƒé‡å€¼å°±ä¼šè¾ƒé«˜ã€‚</li>
<li>ç¬¬ä¸‰æ­¥ï¼Œåˆ©ç”¨æ‰€æœ‰itemä¸ç”¨æˆ·profileçš„ç›¸å…³åº¦è¿›è¡Œæ¨èã€‚ä¸€ä¸ªå¸¸ç”¨çš„ç›¸å…³åº¦è®¡ç®—æ–¹æ³•æ˜¯å‘é‡çš„coså¤¹è§’ã€‚æœ€ç»ˆæŠŠå€™é€‰itemé‡Œä¸æ­¤ç”¨æˆ·æœ€ç›¸å…³ï¼ˆcosineå€¼æœ€å¤§ï¼‰çš„Nä¸ªitemä½œä¸ºæ¨èè¿”å›ç»™æ­¤ç”¨æˆ·ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ä»¥ä¸Šä¸‰ä¸ªæ­¥éª¤ã€‚</p>
<h2 id="item-representation">2.1. item representation</h2><p>æƒ³ç”¨å±æ€§æ¥æè¿°itemæ—¶ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ä¸¤ç§å±æ€§ï¼š</p>
<ul>
<li>ç»“æ„åŒ–(structured)å±æ€§ï¼šå–å€¼å›ºå®šï¼Œä¾‹å¦‚èº«é«˜ã€å­¦å†ã€ç±è´¯ç­‰ï¼›</li>
<li>éç»“æ„åŒ–(unstructured)å±æ€§ï¼šå¦‚æ–‡ç« ï¼›</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é’ˆå¯¹å¦‚ä½•å°†éç»“æ„åŒ–çš„å±æ€§è½¬åŒ–ä¸ºç»“æ„åŒ–å±æ€§ã€‚æˆ‘ä»¬é‡‡ç”¨æœ€å¸¸ç”¨çš„<strong>å‘é‡ç©ºé—´æ¨¡å‹</strong>ï¼ˆVector Space Model,ç®€ç§°VSMï¼‰ï¼š<br>å·²çŸ¥ï¼š</p>
<ul>
<li>æ‰€æœ‰æ–‡ç« é›†åˆ$D={d_1,d_2,â€¦,d_N}$</li>
<li>æ‰€æœ‰æ–‡ç« ä¸­å‡ºç°çš„è¯çš„é›†åˆ$T={t_1,t_2,â€¦,t_n}$</li>
</ul>
<p>ç›®æ ‡ï¼šç”¨å‘é‡è¡¨ç¤ºæ–‡ç« ï¼š</p>
<ul>
<li>ç¬¬jç¯‡æ–‡ç« è¢«è¡¨ç¤ºä¸º$d_j={w_{1j},w_{2j},â€¦,w_{nj}}$,å…¶ä¸­$w_{nj}$è¡¨ç¤ºç¬¬$n$ä¸ªè¯åœ¨æ–‡ç« $j$ä¸­çš„æƒé‡ã€‚</li>
</ul>
<p>æœ€ç®€å•çš„è¡¨ç¤ºæƒé‡$w_{nj}$çš„æ–¹å¼æ˜¯ç›´æ¥ç»Ÿè®¡å‡ºç°æ¬¡æ•°ã€‚ä½†ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨tf-idfï¼š<br>$$TFIDF(t_k,d_j)=TF(t_k,d_j)log \frac{N}{n_k}$$<br>å…¶ä¸­ï¼š</p>
<ul>
<li>$TF(t_k,d_j)$æ˜¯è¯é¢‘ï¼Œè¡¨ç¤ºç¬¬$k$ä¸ªè¯åœ¨æ–‡ç« $j$ä¸­å‡ºç°çš„æ¬¡æ•°ï¼›</li>
<li>$log \frac{N}{n_k}$æ˜¯é€†æ–‡æ¡£è¯é¢‘ï¼Œå…¶ä¸­$n_k$æ˜¯æ‰€æœ‰æ–‡ç« ä¸­åŒ…æ‹¬ç¬¬$k$ä¸ªè¯çš„æ–‡ç« æ•°é‡ï¼›$N$æ˜¯æ–‡ç« æ•°é‡ã€‚</li>
</ul>
<p>æœ€ç»ˆç¬¬$k$ä¸ªè¯åœ¨æ–‡ç« $j$ä¸­çš„æƒé‡ç”±ä¸‹é¢å…¬å¼è·å¾—ï¼š<br>$$w_{k,j}=\frac{TFIDF(t_k,d_j)}{\sqrt{\sum_{s=1}^{|T|}TFIDF(t_k,d_j)^2}}$$<br>åšå½’ä¸€åŒ–çš„å¥½å¤„æ˜¯ä¸åŒæ–‡ç« ä¹‹é—´çš„è¡¨ç¤ºå‘é‡è¢«å½’ä¸€åˆ°ä¸€ä¸ªé‡çº§ä¸Šï¼Œä¾¿äºä¸‹é¢æ­¥éª¤çš„æ“ä½œã€‚ </p>
<h2 id="Profile-Learning">2.2. Profile Learning</h2><p>å‡è®¾ç”¨æˆ·uå·²ç»å¯¹ä¸€äº›itemç»™å‡ºäº†ä»–çš„å–œå¥½åˆ¤æ–­ï¼Œå–œæ¬¢å…¶ä¸­çš„ä¸€éƒ¨åˆ†itemï¼Œä¸å–œæ¬¢å…¶ä¸­çš„å¦ä¸€éƒ¨åˆ†ã€‚<br>é‚£ä¹ˆï¼Œè¿™ä¸€æ­¥è¦åšçš„å°±æ˜¯é€šè¿‡ç”¨æˆ·uè¿‡å»çš„è¿™äº›å–œå¥½åˆ¤æ–­ï¼Œä¸ºä»–äº§ç”Ÿä¸€ä¸ªæ¨¡å‹ã€‚æœ‰äº†è¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®æ­¤æ¨¡å‹æ¥åˆ¤æ–­ç”¨æˆ·uæ˜¯å¦ä¼šå–œæ¬¢ä¸€ä¸ªæ–°çš„itemã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦è§£å†³çš„æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ‰ç›‘ç£åˆ†ç±»é—®é¢˜ï¼Œç†è®ºä¸Šæœºå™¨å­¦ä¹ é‡Œçš„åˆ†ç±»ç®—æ³•éƒ½å¯ä»¥ç…§æ¬è¿›è¿™é‡Œã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ç®€å•ä»‹ç»ä¸‹CBé‡Œå¸¸ç”¨çš„ä¸€äº›å­¦ä¹ ç®—æ³•ï¼š</p>
<ol>
<li>KNN</li>
<li>Rocchio</li>
<li>å†³ç­–æ ‘ï¼ˆDTï¼‰</li>
<li>çº¿æ€§åˆ†ç±»ï¼ˆLCï¼‰</li>
<li>æœ´ç´ è´å¶æ–¯ï¼ˆNBï¼‰</li>
</ol>
<h2 id="Recommendation-Generation">2.3. Recommendation Generation</h2><p>å¦‚æœä¸Šä¸€æ­¥Profile Learningä¸­ä½¿ç”¨çš„æ˜¯åˆ†ç±»æ¨¡å‹ï¼ˆå¦‚DTã€LCå’ŒNBï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æŠŠæ¨¡å‹é¢„æµ‹çš„ç”¨æˆ·æœ€å¯èƒ½æ„Ÿå…´è¶£çš„nä¸ªitemä½œä¸ºæ¨èè¿”å›ç»™ç”¨æˆ·å³å¯ã€‚è€Œå¦‚æœProfile Learningä¸­ä½¿ç”¨çš„ç›´æ¥å­¦ä¹ ç”¨æˆ·å±æ€§çš„æ–¹æ³•ï¼ˆå¦‚Rocchioç®—æ³•ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æŠŠä¸ç”¨æˆ·å±æ€§æœ€ç›¸å…³çš„nä¸ªitemä½œä¸ºæ¨èè¿”å›ç»™ç”¨æˆ·å³å¯ã€‚å…¶ä¸­çš„ç”¨æˆ·å±æ€§ä¸itemå±æ€§çš„ç›¸å…³æ€§å¯ä»¥ä½¿ç”¨å¦‚cosineç­‰ç›¸ä¼¼åº¦åº¦é‡è·å¾—ã€‚</p>
<h2 id="åŸºäºå†…å®¹çš„æ¨èçš„ä¼˜ç¼ºç‚¹">2.4. åŸºäºå†…å®¹çš„æ¨èçš„ä¼˜ç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹</strong></p>
<ol>
<li>ç”¨æˆ·ä¹‹é—´çš„ç‹¬ç«‹æ€§ï¼ˆUser Independenceï¼‰ï¼šæ—¢ç„¶æ¯ä¸ªç”¨æˆ·çš„profileéƒ½æ˜¯ä¾æ®ä»–æœ¬èº«å¯¹itemçš„å–œå¥½è·å¾—çš„ï¼Œè‡ªç„¶å°±ä¸ä»–äººçš„è¡Œä¸ºæ— å…³ã€‚è€ŒååŒè¿‡æ»¤å°±éœ€è¦åˆ©ç”¨å¾ˆå¤šå…¶ä»–äººçš„æ•°æ®ã€‚å› æ­¤è¿™ç§ç”¨æˆ·ç‹¬ç«‹æ€§å¸¦æ¥çš„ä¸€ä¸ªæ˜¾è‘—å¥½å¤„æ˜¯åˆ«äººä¸ç®¡å¯¹itemå¦‚ä½•ä½œå¼Šï¼ˆæ¯”å¦‚åˆ©ç”¨å¤šä¸ªè´¦å·æŠŠæŸä¸ªäº§å“çš„æ’ååˆ·ä¸Šå»ï¼‰éƒ½ä¸ä¼šå½±å“åˆ°è‡ªå·±ã€‚</li>
<li>å¥½çš„å¯è§£é‡Šæ€§ï¼ˆTransparencyï¼‰ï¼šå¦‚æœéœ€è¦å‘ç”¨æˆ·è§£é‡Šä¸ºä»€ä¹ˆæ¨èäº†è¿™äº›äº§å“ç»™ä»–ï¼Œä½ åªè¦å‘Šè¯‰ä»–è¿™äº›äº§å“æœ‰æŸæŸå±æ€§ï¼Œè¿™äº›å±æ€§è·Ÿä½ çš„å“å‘³å¾ˆåŒ¹é…ç­‰ç­‰ã€‚</li>
<li>æ–°çš„itemå¯ä»¥ç«‹åˆ»å¾—åˆ°æ¨èï¼ˆNew Item Problemï¼‰ï¼šåªè¦ä¸€ä¸ªæ–°itemåŠ è¿›itemåº“ï¼Œå®ƒå°±é©¬ä¸Šå¯ä»¥è¢«æ¨èï¼Œè¢«æ¨èçš„æœºä¼šå’Œè€çš„itemæ˜¯ä¸€è‡´çš„ã€‚è€ŒååŒè¿‡æ»¤å¯¹äºæ–°itemå°±å¾ˆæ— å¥ˆï¼Œåªæœ‰å½“æ­¤æ–°itemè¢«æŸäº›ç”¨æˆ·å–œæ¬¢è¿‡ï¼ˆæˆ–æ‰“è¿‡åˆ†ï¼‰ï¼Œå®ƒæ‰å¯èƒ½è¢«æ¨èç»™å…¶ä»–ç”¨æˆ·ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªçº¯CFçš„æ¨èç³»ç»Ÿï¼Œæ–°åŠ è¿›æ¥çš„itemå°±æ°¸è¿œä¸ä¼šè¢«æ¨è:( ã€‚è¿™ä¹Ÿå°±æ˜¯å¸¸è¯´çš„itemå†·å¯åŠ¨é—®é¢˜ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹</strong></p>
<ol>
<li>itemçš„ç‰¹å¾æŠ½å–ä¸€èˆ¬å¾ˆéš¾ï¼ˆLimited Content Analysisï¼‰ï¼šå¦‚æœç³»ç»Ÿä¸­çš„itemæ˜¯æ–‡æ¡£ï¼ˆå¦‚ä¸ªæ€§åŒ–é˜…è¯»ä¸­ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°ä½¿ç”¨ä¿¡æ¯æ£€ç´¢é‡Œçš„æ–¹æ³•æ¥â€œæ¯”è¾ƒç²¾ç¡®åœ°â€æŠ½å–å‡ºitemçš„ç‰¹å¾ã€‚ä½†å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬å¾ˆéš¾ä»itemä¸­æŠ½å–å‡ºå‡†ç¡®åˆ»ç”»itemçš„ç‰¹å¾ï¼Œæ¯”å¦‚ç”µå½±æ¨èä¸­itemæ˜¯ç”µå½±ï¼Œç¤¾ä¼šåŒ–ç½‘ç»œæ¨èä¸­itemæ˜¯äººï¼Œè¿™äº›itemå±æ€§éƒ½ä¸å¥½æŠ½ã€‚å…¶å®ï¼Œå‡ ä¹åœ¨æ‰€æœ‰å®é™…æƒ…å†µä¸­æˆ‘ä»¬æŠ½å–çš„itemç‰¹å¾éƒ½ä»…èƒ½ä»£è¡¨itemçš„ä¸€äº›æ–¹é¢ï¼Œä¸å¯èƒ½ä»£è¡¨itemçš„æ‰€æœ‰æ–¹é¢ã€‚è¿™æ ·å¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¯èƒ½ä»ä¸¤ä¸ªitemæŠ½å–å‡ºæ¥çš„ç‰¹å¾å®Œå…¨ç›¸åŒï¼Œè¿™ç§æƒ…å†µä¸‹åŸºäºå†…å®¹çš„æ¨èå°±å®Œå…¨æ— æ³•åŒºåˆ†è¿™ä¸¤ä¸ªitemäº†ã€‚æ¯”å¦‚å¦‚æœåªèƒ½ä»ç”µå½±é‡ŒæŠ½å–å‡ºæ¼”å‘˜ã€å¯¼æ¼”ï¼Œé‚£ä¹ˆä¸¤éƒ¨æœ‰ç›¸åŒæ¼”å‘˜å’Œå¯¼æ¼”çš„ç”µå½±å¯¹äºåŸºäºå†…å®¹çš„æ¨èæ¥è¯´å°±å®Œå…¨ä¸å¯åŒºåˆ†äº†ã€‚</li>
<li>æ— æ³•æŒ–æ˜å‡ºç”¨æˆ·çš„æ½œåœ¨å…´è¶£ï¼ˆOver-specializationï¼‰ï¼šæ—¢ç„¶CBçš„æ¨èåªä¾èµ–äºç”¨æˆ·è¿‡å»å¯¹æŸäº›itemçš„å–œå¥½ï¼Œå®ƒäº§ç”Ÿçš„æ¨èä¹Ÿéƒ½ä¼šå’Œç”¨æˆ·è¿‡å»å–œæ¬¢çš„itemç›¸ä¼¼ã€‚å¦‚æœä¸€ä¸ªäººä»¥å‰åªçœ‹ä¸æ¨èæœ‰å…³çš„æ–‡ç« ï¼Œé‚£åŸºäºå†…å®¹çš„æ¨èåªä¼šç»™ä»–æ¨èæ›´å¤šä¸æ¨èç›¸å…³çš„æ–‡ç« ï¼Œå®ƒä¸ä¼šçŸ¥é“ç”¨æˆ·å¯èƒ½è¿˜å–œæ¬¢æ•°ç ã€‚</li>
<li>æ— æ³•ä¸ºæ–°ç”¨æˆ·äº§ç”Ÿæ¨èï¼ˆNew User Problemï¼‰ï¼šæ–°ç”¨æˆ·æ²¡æœ‰å–œå¥½å†å²ï¼Œè‡ªç„¶æ— æ³•è·å¾—ä»–çš„profileï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•ä¸ºä»–äº§ç”Ÿæ¨èäº†ã€‚å½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜ååŒè¿‡æ»¤ä¹Ÿæœ‰ã€‚</li>
</ol>
<h1 id="å‚è€ƒæ–‡çŒ®">3. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://www.ibm.com/developerworks/cn/opensource/os-recommender1/index.html" target="_blank" rel="external">æ¨èç³»ç»Ÿ,IBM</a></li>
<li><a href="http://www.infoq.com/cn/articles/recommendation-algorithm-overview-part01" target="_blank" rel="external">æ¨èç®—æ³•ç»¼è¿°ï¼ˆä¸€ï¼‰</a></li>
<li><a href="http://blog.csdn.net/keyboardlabourer/article/details/26692177" target="_blank" rel="external">ååŒè¿‡æ»¤ä¹‹åŸºäºç”¨æˆ·çš„æœ€è¿‘é‚»æ¨è</a></li>
<li><a href="http://www.chongchonggou.com/g_60592064.html" target="_blank" rel="external">åŸºäºç‰©å“çš„ååŒè¿‡æ»¤æ¨èç®—æ³•â€”â€”è¯»â€œItem-Based Collaborative Filtering Recommendation Algorithmsâ€</a></li>
<li><a href="https://www.zhihu.com/question/19971859" target="_blank" rel="external">ååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹æ¨èæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li>
<li><a href="https://read.douban.com/reader/column/3346397/chapter/18909999/" target="_blank" rel="external">åŸºäºå†…å®¹çš„æ¨è</a></li>
<li><a href="http://baogege.info/2014/10/19/matrix-factorization-in-recommender-systems/" target="_blank" rel="external">ä¸ªæ€§åŒ–æ¨èä¸­çš„çŸ©é˜µåˆ†è§£æŠ€æœ¯</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ å®è·µ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœ´ç´ è´å¶æ–¯çš„ç†è§£]]></title>
      <url>/2017/07/15/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h1 id="æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„æ€æƒ³åŸºç¡€">1. æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„æ€æƒ³åŸºç¡€</h1><p>å‚è€ƒæ–‡çŒ®<a href="http://www.cnblogs.com/leoo2sk/archive/2010/09/17/naive-bayesian-classifier.html" target="_blank" rel="external">ç®—æ³•æ‚è´§é“ºâ€”â€”åˆ†ç±»ç®—æ³•ä¹‹æœ´ç´ è´å¶æ–¯åˆ†ç±»</a>æŒ‡å‡ºï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»æ˜¯ä¸€ç§ååˆ†ç®€å•çš„åˆ†ç±»ç®—æ³•ï¼Œå«å®ƒæœ´ç´ è´å¶æ–¯åˆ†ç±»æ˜¯å› ä¸ºè¿™ç§æ–¹æ³•çš„æ€æƒ³çœŸçš„å¾ˆæœ´ç´ ï¼Œæœ´ç´ è´å¶æ–¯çš„<strong>æ€æƒ³åŸºç¡€</strong>æ˜¯è¿™æ ·çš„ï¼šå¯¹äºç»™å‡ºçš„å¾…åˆ†ç±»é¡¹ï¼Œæ±‚è§£åœ¨æ­¤é¡¹å‡ºç°çš„æ¡ä»¶ä¸‹å„ä¸ªç±»åˆ«å‡ºç°çš„æ¦‚ç‡ï¼Œå“ªä¸ªæœ€å¤§ï¼Œå°±è®¤ä¸ºæ­¤å¾…åˆ†ç±»é¡¹å±äºå“ªä¸ªç±»åˆ«ã€‚é€šä¿—æ¥è¯´ï¼Œå°±å¥½æ¯”è¿™ä¹ˆä¸ªé“ç†ï¼Œä½ åœ¨è¡—ä¸Šçœ‹åˆ°ä¸€ä¸ªé»‘äººï¼Œæˆ‘é—®ä½ ä½ çŒœè¿™å“¥ä»¬å“ªé‡Œæ¥çš„ï¼Œä½ åæœ‰å…«ä¹çŒœéæ´²ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºé»‘äººä¸­éæ´²äººçš„æ¯”ç‡æœ€é«˜ï¼Œå½“ç„¶äººå®¶ä¹Ÿå¯èƒ½æ˜¯ç¾æ´²äººæˆ–äºšæ´²äººï¼Œä½†åœ¨æ²¡æœ‰å…¶å®ƒå¯ç”¨ä¿¡æ¯ä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ¡ä»¶æ¦‚ç‡æœ€å¤§çš„ç±»åˆ«ï¼Œè¿™å°±æ˜¯æœ´ç´ è´å¶æ–¯çš„æ€æƒ³åŸºç¡€ã€‚</p>
<p>å°†ä¸Šé¢çš„æè¿°å½¢å¼åŒ–æè¿°ï¼Œå°±æ˜¯ä¸‹é¢çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„å®šä¹‰ã€‚</p>
<h1 id="æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„å®šä¹‰å’Œæ±‚è§£">2. æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„å®šä¹‰å’Œæ±‚è§£</h1><ol>
<li>è®¾$x={a_1,a_2,â€¦,a_m}$ä¸ºä¸€ä¸ªå¾…åˆ†ç±»é¡¹ï¼Œå…¶ä¸­æ¯ä¸ª$a$æ˜¯$x$çš„ä¸€ä¸ªç‰¹å¾å±æ€§ã€‚</li>
<li>æœ‰ç±»åˆ«é›†åˆ$C={y_1,y_2,â€¦,y_n}$</li>
<li>è®¡ç®—$P(y_1|x),P(y_2|x),â€¦,P(y_n|x)$ã€‚(ä¹Ÿå°±æ˜¯è¿™ä¸ªç‰¹å¾æˆä¸ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡)</li>
<li>å¦‚æœ$P(y_k|x)=max[P(y_1|x),P(y_2|x),â€¦,P(y_n|x)],åˆ™x\in y_k$ã€‚(é€‰å‡ºä¸€ä¸ªæœ€å¯èƒ½çš„ç±»åˆ«ï¼Œå°†è¿™ä¸ªç±»åˆ«è®¾ä¸ºxçš„ç±»åˆ«)</li>
</ol>
<h2 id="å¦‚ä½•è®¡ç®—-P-y-i-x">2.1. å¦‚ä½•è®¡ç®—$P(y_i|x)$?</h2><p>é—®é¢˜æ¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•è®¡ç®—ç¬¬3æ­¥å½“ä¸­çš„$P(y_i|x)$å‘¢ï¼Ÿ</p>
<p>$P(y_i|x)$ä»£è¡¨åœ¨è¿™ä¸ª$x$çš„æƒ…å†µä¸‹çš„ç±»åˆ«æˆä¸º$y_i$çš„æ¦‚ç‡ï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡å»ºæ¨¡$p(y|x)$æ¥é¢„æµ‹$y$çš„æ¨¡å‹å«â€œ<strong>åˆ¤åˆ«å¼æ¨¡å‹</strong>â€ã€‚<br>ä½†é—®é¢˜åœ¨äºå¦‚æœç‰¹å¾æ•°é‡nè¾ƒå¤§æˆ–è€…æ¯ä¸ªç‰¹å¾èƒ½å–å¤§é‡å€¼æ—¶ï¼ŒåŸºäºæ¦‚ç‡æ¨¡å‹åˆ—å‡ºæ¦‚ç‡è¡¨å˜å¾—ä¸ç°å®ã€‚æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªæ¨¡å‹ä½¿ä¹‹å˜å¾—å¯è¡Œã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå¯¹è”åˆæ¦‚ç‡åˆ†å¸ƒ$p(x,y)$å»ºæ¨¡ï¼Œç„¶åå†ç”±æ­¤å¾—å‡º$P(y_i|x)$ï¼Œè¿™æ ·çš„æ˜¯â€œ<strong>ç”Ÿæˆå¼æ¨¡å‹</strong>â€ã€‚è´å¶æ–¯å®šç†ä¸ºï¼š<br>$$P(y|x)=\frac{p(x,y)}{p(x)}=\frac{p(y)p(x|y)}{p(x)}\tag{å…¬å¼0}$$</p>
<h2 id="å› æ­¤å°†é—®é¢˜è½¬åŒ–æˆäº†ï¼šå¦‚ä½•åŸºäºè®­ç»ƒæ•°æ®Dæ¥ä¼°è®¡å…ˆéªŒ-p-y-å’Œä¼¼ç„¶-p-x-y-ï¼Ÿ">2.2. å› æ­¤å°†é—®é¢˜è½¬åŒ–æˆäº†ï¼šå¦‚ä½•åŸºäºè®­ç»ƒæ•°æ®Dæ¥ä¼°è®¡å…ˆéªŒ$p(y)$å’Œä¼¼ç„¶$p(x|y)$ï¼Ÿ</h2><ul>
<li>$p(y)$æ˜¯å…ˆéªŒæ¦‚ç‡ï¼Œè¡¨ç¤ºæ ·æœ¬ç©ºé—´ä¸­å„ç±»æ ·æœ¬æ‰€å æ¯”ä¾‹ï¼›å¯ä»¥é€šè¿‡ç»Ÿè®¡è¿‘ä¼¼å¾—å‡ºï¼›</li>
<li>$p(x|y)$æ˜¯å„ç±»æ ·æœ¬æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰$x$ç‰¹å¾åˆ†å¸ƒçš„æ¦‚ç‡ã€‚å‡è®¾ç‰¹å¾ç©ºé—´$x$æœ‰$d$ç»´ï¼Œä¸”æ¯ä¸€ç»´éƒ½æœ‰2ä¸ªå–å€¼ï¼Œé‚£ä¹ˆ$x$çš„å–å€¼å°±æœ‰$2^d$ç§ã€‚ä¸€èˆ¬æ¥è¯´è¿™è¿œå¤§äºè®­ç»ƒæ ·æœ¬æ•°mã€‚ä¹Ÿå°±æ˜¯å¾ˆå¤šå–å€¼æ˜¯è¦†ç›–ä¸åˆ°çš„ã€‚æ‰€ä»¥ç”¨é¢‘ç‡æ¥ä¼°è®¡å®ƒä¸å¯è¡Œï¼Œå› ä¸ºâ€œæœªè¢«è§‚æµ‹åˆ°â€å’Œâ€œä¸å‡ºç°æ¦‚ç‡ä¸º0â€é€šå¸¸æ˜¯ä¸åŒçš„ã€‚</li>
</ul>
<h2 id="ç°åœ¨é—®é¢˜åˆæ¥äº†ï¼Œå¦‚ä½•å»ä¼°è®¡-p-x-y-ï¼Ÿ">2.3. ç°åœ¨é—®é¢˜åˆæ¥äº†ï¼Œå¦‚ä½•å»ä¼°è®¡$p(x|y)$ï¼Ÿ</h2><p>ä¼°è®¡ç±»æ¡ä»¶æ¦‚ç‡çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼šå…ˆå‡å®šå…¶å…·æœ‰æŸç§ç¡®å®šçš„æ¦‚ç‡åˆ†å¸ƒå½¢å¼ï¼Œå†åŸºäºè®­ç»ƒæ ·æœ¬å¯¹æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°è¿›è¡Œä¼°è®¡ã€‚</p>
<h2 id="é—®é¢˜åˆè½¬åŒ–æˆäº†-å¦‚ä½•è¿›è¡Œå‚æ•°ä¼°è®¡ï¼Ÿ">2.4. é—®é¢˜åˆè½¬åŒ–æˆäº†:å¦‚ä½•è¿›è¡Œå‚æ•°ä¼°è®¡ï¼Ÿ</h2><p>ä¸ºæ˜ç¡®èµ·è§ï¼Œæˆ‘ä»¬å°†$p(x|y)$è®°ä½œ$p(x|Î¸_y)$ã€‚</p>
<p>æ ¹æ®é¢‘ç‡å­¦æ´¾çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æå¤§ä¼¼ç„¶æ³•æ¥ä¼°è®¡å‚æ•°Î¸ã€‚</p>
<p>æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæˆ‘ä»¬å·²çŸ¥$x$å·²å‘ç”Ÿï¼Œæˆ‘ä»¬å†æ ¹æ®å®é™…æƒ…å†µå†™å‡º$x$å‘ç”Ÿçš„æ¦‚ç‡$p(x_Î¸)$ã€‚ç›®æ ‡å‡½æ•°æ˜¯ä½¿å¾—è¿™ä¸ªæ¦‚ç‡$p(x_Î¸)$æœ€å¤§ï¼Œç„¶åæ±‚å¾—$Î¸$ã€‚</p>
<p>åœ¨æœ¬é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬æœ‰è®­ç»ƒæ ·æœ¬é›†$X$ï¼Œä»¤$X_y$è¡¨ç¤ºè®­ç»ƒæ ·æœ¬é›†$X$ä¸­ç¬¬$y$ç±»æ ·æœ¬ç»„æˆçš„é›†åˆï¼Œå‡è®¾è¿™äº›æ ·æœ¬ç‹¬ç«‹åŒåˆ†å¸ƒã€‚ä¼¼ç„¶å‡½æ•°æ˜¯æŸäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯$P(X_y|Î¸_y)$:<br>$$P(X_y|Î¸_y)=âˆ_{x\in X_y}P(x|Î¸_y) \tag{å…¬å¼1}$$<br><em>å°æ³¨ï¼Œä¸Šå¼è¡¨è¾¾çš„æ„æ€æ˜¯ï¼š</em>$åœ¨å‚æ•°Î¸_yæ—¶ï¼Œç¬¬yç±»æ ·æœ¬é›†X_yå‘ç”Ÿçš„æ¦‚ç‡ = X_yä¸­æ¯ä¸ªæ ·æœ¬xå‘ç”Ÿçš„æ¦‚ç‡çš„ä¹˜ç§¯$</p>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“$X_y|Î¸_y$è¿™ä¸ªäº‹ä»¶å‘ç”Ÿäº†ï¼ˆå› ä¸ºæˆ‘ä»¬è§‚æµ‹åˆ°äº†ï¼‰ï¼Œé‚£å°±è®©è¿™ä¸ªæ¦‚ç‡$P(X_y|Î¸_y)$æœ€å¤§åŒ–ï¼Œå»æ±‚å¾—ä¸€ä¸ª$Î¸_y$ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡â€”â€”å¾—åˆ°$Î¸_y$ã€‚</p>
<h2 id="å¦‚ä½•è§£å‡ºå‚æ•°ï¼Ÿ">2.5. å¦‚ä½•è§£å‡ºå‚æ•°ï¼Ÿ</h2><p>å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡æ˜¯æ±‚å¾—ä¸€ä¸ª$Î¸_y$æ˜¯çš„å…¬å¼1æœ€å¤§ã€‚è€Œå…¬å¼1çš„è¿ä¹˜æ“ä½œå®¹æ˜“é€ æˆä¸‹æº¢ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸ä½¿ç”¨å¯¹æ•°ä¼¼ç„¶ï¼š<br>$$LL(Î¸_y)=log P(X_y|Î¸_y)$$<br>$$=\sum_{x\in X_y}log P(x|Î¸_y)\tag{å…¬å¼2.1}$$<br>æ­¤æ—¶æˆ‘ä»¬æ±‚å¾—ä¸€ä¸ª$Î¸_y$ï¼Œä½¿å¾—å…¬å¼2.1æœ€å¤§:</p>
<p>$$Î¸_y=arg_{Î¸_y} max LL(Î¸_y)\tag{å…¬å¼2.2}$$</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“$p(x|Î¸)$,å°±å¯ä»¥æ±‚å¾—å„$y$ç±»æ ‡ç­¾å–å€¼ä¸‹çš„$Î¸$ï¼Œå°±å¾—åˆ°äº†$x$ä¸‹å„labelçš„æ¦‚ç‡:$P(x|Î¸_y)$ï¼Œä¹Ÿå°±æ˜¯$P(x|y)$ã€‚ä»£å…¥<em>å…¬å¼0</em>ï¼Œæˆ‘ä»¬å¾—åˆ°äº†$P(y|x)$ã€‚æ­¤æ—¶æˆ‘ä»¬å°±<strong>è§£å†³äº†æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„å®šä¹‰çš„ç¬¬3æ­¥</strong>ï¼Œè¿™æ ·å°±èƒ½è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</p>
<h2 id="å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•">2.6. å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•</h2><p>ç„¶è€Œï¼Œ<strong>è¿™ä¸ªé—®é¢˜å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚</strong>åœ¨å…¬å¼2ä¸­æˆ‘ä»¬è¦æ±‚å¾—$Î¸$ã€‚å‡è®¾$x^{(j)}$æœ‰$S_j$ä¸ªå–å€¼ï¼Œé‚£ä¹ˆæ¯ä¸ªç±»åˆ«ä¸‹çš„$Î¸_y$å°±æœ‰$âˆ_{j=1}^nS_j$ç»´ã€‚ä¸”$y$çš„å–å€¼æœ‰$k$ä¸ªï¼Œé‚£å°±æ˜¯$kâˆ_{j=1}^nS_j$ï¼Œè¿™æ ·å°±å¾ˆéš¾ç®—ï¼Œå‡ ä¹ç®—ä¸å‡ºæ¥ã€‚</p>
<h2 id="å‚æ•°å¤ªå¤šï¼Œç»´åº¦çˆ†ç‚¸äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ">2.7. å‚æ•°å¤ªå¤šï¼Œç»´åº¦çˆ†ç‚¸äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ</h2><p>å› æ­¤ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ç”¨äº†<strong>å±æ€§æ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾</strong>:å¯¹äºå·²çŸ¥ç±»åˆ«ï¼Œå‡è®¾æ‰€æœ‰å±æ€§ç›¸äº’ç‹¬ç«‹ã€‚</p>
<p>æ­¤æ—¶ï¼Œ<em>å…¬å¼0</em>å¯ä»¥æ”¹å†™æˆï¼š<br>$$P(y|x)=\frac{p(y)p(x|y)}{p(x)}=\frac{p(y)}{p(x)}âˆ_{i=1}^dP(x_i|y)\tag{å…¬å¼4}$$</p>
<p>è€Œ$p(x)$æ˜¯æ ·æœ¬åˆ†å¸ƒï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥å¿½ç•¥ã€‚<br>æŒ‰ç…§æˆ‘ä»¬åˆšåˆšæ¨å¯¼çš„æ­¥éª¤ï¼Œæƒ³æ±‚å¾—$P(y|x)$ï¼Œæˆ‘ä»¬å°±å›åˆ°äº†æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„å®šä¹‰çš„ç¬¬3æ­¥ï¼Œç®—å‡ºå…¬å¼2.2:</p>
<p>$$Î¸_y=arg_{Î¸_y} max LL(Î¸_y)=arg max_{y\in Y}P(y)âˆ_{i=1}^dP(x_i|y)\tag{å…¬å¼5}$$</p>
<p>ä¹‹åè¿˜æœ‰åŠæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ã€‚æˆ‘ä»¬æ¥æ—¥å†è¯´ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">3. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/leoo2sk/archive/2010/09/17/naive-bayesian-classifier.html" target="_blank" rel="external">ç®—æ³•æ‚è´§é“ºâ€”â€”åˆ†ç±»ç®—æ³•ä¹‹æœ´ç´ è´å¶æ–¯åˆ†ç±»</a></li>
<li><a href="https://github.com/endymecy/spark-ml-source-analysis/blob/master/%E5%88%86%E7%B1%BB%E5%92%8C%E5%9B%9E%E5%BD%92/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/nb.md" target="_blank" rel="external">æœ´ç´ è´å¶æ–¯</a></li>
<li><a href="">æœºå™¨å­¦ä¹ ï¼Œå‘¨å¿—å</a></li>
<li><a href="">æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ï¼Œåå¸ˆå¤§å‡ºç‰ˆç¤¾</a></li>
</ol>
<p>é‚£æˆ‘ä»¬å›å¤´çœ‹çœ‹æˆ‘ä»¬çš„è®­ç»ƒé›†ã€‚è®­ç»ƒé›†æ˜¯ç”±ä¸€ä¸ªå·²çŸ¥åˆ†ç±»çš„é›†åˆæ„æˆï¼Œä¹Ÿå°±æ˜¯é›†åˆ$X$å’Œå¯¹åº”çš„$y$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»Ÿè®¡æ¥è·å¾—å„ç±»åˆ«ä¸‹å„ç‰¹å¾å±æ€§çš„æ¡ä»¶æ¦‚ç‡ä¼°è®¡ï¼š<br>$P(a_1|y_1),P(a_2|y_1),â€¦,P(a_m|y_1);$<br>$P(a_1|y_2),P(a_2|y_2),â€¦,P(a_m|y_2);$<br>$â€¦,$<br>$P(a_1|y_n),P(a_2|y_n),â€¦,P(a_m|y_n)$</p>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> è´å¶æ–¯ç†è®º </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-æ€»ç»“]]></title>
      <url>/2017/07/11/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>æˆ‘ä¸€æƒ³åˆ°æ˜å¤©è¦é¢è¯•ï¼Œæˆ‘å°±è´¼ç´§å¼ ã€‚èµ¶ç´§å¥½å¥½å¤ä¹ ä¸€ä¸‹å§ã€‚</p>
<h1 id="ç‰¹å¾é™ç»´">1. ç‰¹å¾é™ç»´</h1><p>ä¸»æˆåˆ†åˆ†æPCA<br>çº¿æ€§åˆ¤åˆ«åˆ†æLDA<br>çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£SVD<br>æ·±åº¦å­¦ä¹ SparseAutoEncoder<br>LASSO<br>å°æ³¢åˆ†ææ³•<br>æ‹‰æ™®æ‹‰æ–¯ç‰¹å¾æ˜ å°„</p>
<h1 id="ç»Ÿè®¡æ¨¡å¼åˆ†ç±»é—®é¢˜ä¸­ï¼Œå½“å…ˆéªŒæ¦‚ç‡æœªçŸ¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨">2. ç»Ÿè®¡æ¨¡å¼åˆ†ç±»é—®é¢˜ä¸­ï¼Œå½“å…ˆéªŒæ¦‚ç‡æœªçŸ¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨</h1><p>æœ€å°è¯¯åˆ¤æ¦‚ç‡å‡†åˆ™<br>æœ€å°æŸå¤±å‡†åˆ™</p>
<h1 id="å„ç§å†³ç­–æ ‘">3. å„ç§å†³ç­–æ ‘</h1><table>
<thead>
<tr>
<th>å†³ç­–æ ‘</th>
<th>ID3/C4.5</th>
<th>CART</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›¸åŒ</td>
<td>éƒ½æ˜¯åŸºäºä¿¡æ¯è®ºçš„å†³ç­–æ ‘ç®—æ³•</td>
<td></td>
</tr>
<tr>
<td>ä¸åŒ1</td>
<td>ID3æ˜¯ä¿¡æ¯å¢ç›Šï¼ŒC4.5æ˜¯ä¿¡æ¯å¢ç›Šæ¯”</td>
<td>CARTä¸­ç”¨äºé€‰æ‹©å˜é‡çš„ä¸çº¯æ€§åº¦é‡æ˜¯GiniæŒ‡æ•°</td>
</tr>
<tr>
<td>ä¸åŒ2</td>
<td>C4.5/ID3ä¸ä¸€å®šæ˜¯äºŒå‰æ ‘</td>
<td>CARTä¸€å®šæ˜¯äºŒå‰æ ‘</td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[SVDåˆ†è§£]]></title>
      <url>/2017/07/10/%E6%95%B0%E5%AD%A6-SVD%E5%88%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p><strong>ç®€ä»‹</strong></p>
<ul>
<li>SVD(Singular Value Decompositionï¼Œå¥‡å¼‚å€¼åˆ†è§£)æ˜¯å¯¹å®æ•°çŸ©é˜µ(ç”šè‡³å¤æ•°çŸ©é˜µ)çš„ä¸€ç§å› å¼åˆ†è§£ã€‚</li>
<li>ä»»æ„çš„ä¸€ä¸ªçŸ©é˜µéƒ½å¯ä»¥åšSVDåˆ†è§£ã€‚ç›¸æ¯”SVDåˆ†è§£ï¼Œå’ŒSVDç›¸è¿‘çš„ç‰¹å¾å€¼åˆ†è§£åªèƒ½åº”ç”¨äºæ–¹é˜µã€‚</li>
<li>SVDåˆ†è§£å¯ç”¨æ¥è§£å†³éæ–¹é˜µä¸èƒ½è®¡ç®—é€†çŸ©é˜µçš„é—®é¢˜ã€‚</li>
</ul>
<h1 id="SVDå®šä¹‰">1. SVDå®šä¹‰</h1><p>è®¾ä¸€ä¸ª$m\times n$çš„çŸ©é˜µ$M$,å®ƒçš„SVDåˆ†è§£æ˜¯ï¼š<br>$$M=UÎ£V^*$$<br>å…¶ä¸­ï¼š</p>
<ul>
<li>$U$æ˜¯ä¸€ä¸ª$m\times m$çš„é…‰çŸ©é˜µã€‚(æˆ‘çš„ç†è§£ï¼šé…‰çŸ©é˜µæ˜¯åœ¨å¤æ•°ç©ºé—´ä¸Šï¼Œç±»ä¼¼æ­£äº¤çŸ©é˜µçš„çŸ©é˜µã€‚å®ƒæœ‰å¾ˆå¤šä¸é”™çš„æ€§è´¨ã€‚å¯ä»¥åœ¨æˆ‘ä¸Šä¸€ç¯‡åšå®¢é‡Œçœ‹åˆ°)</li>
<li>$Î£$æ˜¯$m\times n$çš„çŸ©å½¢å¯¹è§’çŸ©é˜µï¼Œå¹¶ä¸”åœ¨å¯¹è§’çº¿ä¸Šçš„å…ƒç´ éƒ½æ˜¯éè´Ÿå®æ•°$Ïƒ_i$ï¼Œç§°ä¸º$M$çš„å¥‡å¼‚å€¼</li>
<li>$V^*$æ˜¯ä¸€ä¸ª$n\times n$çš„é…‰çŸ©é˜µï¼Œä¹Ÿæ˜¯$V$çš„å…±è½­è½¬ç½®çŸ©é˜µã€‚</li>
</ul>
<h1 id="SVDçš„åŸç†">2. SVDçš„åŸç†</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹æ­£äº¤çŸ©é˜µè¿›è¡Œä¸€äº›å›é¡¾ã€‚</p>
<p><strong>æ­£äº¤çŸ©é˜µå›é¡¾</strong></p>
<p>ä»ä¸Šä¸€èŠ‚æˆ‘ä»¬çŸ¥é“ï¼Œæ­£äº¤çŸ©é˜µå¯¹åº”çš„å˜æ¢æ˜¯ä¸ä¼šæ”¹å˜å‘é‡é•¿åº¦çš„ã€‚å³ï¼Œå¯¹äºå‘é‡$(a,b)$ï¼Œæ­£äº¤çŸ©é˜µ$U$ï¼Œå˜æ¢åçš„å‘é‡$U(a,b)$çš„é•¿åº¦ä¸$(a,b)$æ˜¯ç›¸ç­‰çš„ã€‚è¿™ä¸ªæ­£äº¤å˜æ¢åªæ˜¯å¯¹$(a,b)$åšäº†æ—‹è½¬æˆ–è€…é•œå°„ç­‰æ“ä½œã€‚</p>
<h2 id="ç‰¹å¾å€¼åˆ†è§£â€”â€”EVD">2.1. ç‰¹å¾å€¼åˆ†è§£â€”â€”EVD</h2><p>åœ¨è®¨è®ºSVDä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè®¨è®ºçŸ©é˜µçš„ç‰¹å¾å€¼åˆ†è§£ï¼ˆEVDï¼‰ã€‚</p>
<p>å›é¡¾ç‰¹å¾å€¼åˆ†è§£ï¼Œç‰¹å¾å€¼åˆ†è§£æ˜¯æŠŠä¸€ä¸ªné˜¶å®å¯¹ç§°çŸ©é˜µåˆ†è§£ä¸ºä¸‹é¢çš„å½¢å¼ï¼š<br>$$A=QÎ£Q^{-1}$$<br>å…¶ä¸­ï¼š</p>
<ul>
<li>$Q$æ˜¯è¿™ä¸ªçŸ©é˜µ$A$çš„ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µ</li>
<li>$Î£$æ˜¯ä¸€ä¸ªå¯¹è§’é˜µï¼Œæ¯ä¸ªå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å°±æ˜¯ä¸€ä¸ªç‰¹å¾å€¼</li>
</ul>
<p>æ­¤æ—¶å‡è®¾æœ‰ä¸€ä¸ª$x$å‘é‡ï¼Œç”¨$A$å°†è¿™ä¸ªå‘é‡$x$å˜æ¢åˆ°$A$çš„åˆ—ç©ºé—´ä¸­ï¼Œå³ï¼š<br>$$Ax=QÎ£Q^{-1}x=QÎ£Q^Tx=QÎ£(Q^Tx)$$</p>
<ol>
<li>é¦–å…ˆè¿›è¡Œ$Q^Tx$æ“ä½œã€‚$Q$å’Œ$T^T$éƒ½æ˜¯æ­£äº¤é˜µï¼Œé‚£ä¹ˆ$Q^T$å¯¹$x$çš„å˜æ¢æ˜¯æ­£äº¤å˜æ¢ï¼Œå®ƒå°†$x$ç”¨æ–°çš„åæ ‡ç³»ï¼Œè¿™ä¸ªåæ ‡ç³»å°±æ˜¯$A$çš„æ‰€æœ‰æ­£äº¤çš„ç‰¹å¾å‘é‡æ„æˆçš„åæ ‡ç³»ã€‚<br>æˆ‘ä»¬å¦‚æœå°†$x$ç”¨$A$çš„æ‰€æœ‰ç‰¹å¾å‘é‡æ¥è¡¨ç¤ºçš„è¯ï¼Œå³è¡¨ç¤ºä¸º$x=a_1x_1+a_2x_2+â€¦+a_mx_m$ï¼Œåˆ™é€šè¿‡ç¬¬ä¸€ä¸ªå˜æ¢ï¼Œ$(Q^Tx)=[a_1,a_2,â€¦,a_m]â€™$,å³<img src="https://ooo.0o0.ooo/2017/07/10/596382b7bdde7.png" alt=""> </li>
<li>ç´§æ¥ç€ï¼Œåœ¨æ–°çš„åæ ‡ç³»è¡¨ç¤ºä¸‹ï¼Œç”±ä¸­é—´é‚£ä¸ªå¯¹è§’çŸ©é˜µå¯¹æ–°çš„å‘é‡åæ ‡æ¢ï¼Œå…¶ç»“æœå°±æ˜¯å°†å‘é‡å¾€å„ä¸ªè½´æ–¹å‘æ‹‰ä¼¸æˆ–å‹ç¼©ï¼š<img src="https://ooo.0o0.ooo/2017/07/10/596382f4d62b4.png" alt=""><br>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœAä¸æ˜¯æ»¡ç§©çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯è¯´å¯¹è§’é˜µçš„å¯¹è§’çº¿ä¸Šå…ƒç´ å­˜åœ¨0ï¼Œè¿™æ—¶å€™å°±ä¼šå¯¼è‡´ç»´åº¦é€€åŒ–ï¼Œè¿™æ ·å°±ä¼šä½¿æ˜ å°„åçš„å‘é‡è½å…¥mç»´ç©ºé—´çš„å­ç©ºé—´ä¸­ã€‚</li>
<li>æœ€åä¸€ä¸ªå˜æ¢å°±æ˜¯Uå¯¹æ‹‰ä¼¸æˆ–å‹ç¼©åçš„å‘é‡åšå˜æ¢ï¼Œç”±äºUå’ŒUâ€™æ˜¯äº’ä¸ºé€†çŸ©é˜µï¼Œæ‰€ä»¥Uå˜æ¢æ˜¯Uâ€™å˜æ¢çš„é€†å˜æ¢ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œä»å¯¹ç§°é˜µçš„åˆ†è§£å¯¹åº”çš„æ˜ å°„åˆ†è§£æ¥åˆ†æä¸€ä¸ªçŸ©é˜µçš„å˜æ¢ç‰¹ç‚¹æ˜¯éå¸¸ç›´è§‚çš„ã€‚å‡è®¾å¯¹ç§°é˜µç‰¹å¾å€¼å…¨ä¸º1é‚£ä¹ˆæ˜¾ç„¶å®ƒå°±æ˜¯å•ä½é˜µï¼Œå¦‚æœå¯¹ç§°é˜µçš„ç‰¹å¾å€¼æœ‰ä¸ªåˆ«æ˜¯0å…¶ä»–å…¨æ˜¯1ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªæ­£äº¤æŠ•å½±çŸ©é˜µï¼Œå®ƒå°†mç»´å‘é‡æŠ•å½±åˆ°å®ƒçš„åˆ—ç©ºé—´ä¸­ã€‚</p>
<h2 id="å¥‡å¼‚å€¼åˆ†è§£â€“SVD">2.2. å¥‡å¼‚å€¼åˆ†è§£â€“SVD</h2><p>ä¸Šé¢çš„çŸ©é˜µ$A$è¦æ±‚å¿…é¡»æ˜¯né˜¶å®å¯¹ç§°çš„ã€‚é‚£ä¹ˆå¯¹äºä»»æ„çš„$M\times N$çŸ©é˜µï¼Œèƒ½å¦æ‰¾åˆ°ä¸€ä¸ªç›¸ä¼¼çš„å˜æ¢å‘¢ï¼Ÿè¿™å°±æ˜¯SVDåˆ†è§£çš„ç²¾é«“æ‰€åœ¨ã€‚</p>
<p>åœ¨ä¸Šé¢çš„ç‰¹å¾å€¼åˆ†è§£ä¸­ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸ªå˜æ¢$A$ï¼Œå°†ä¸€ç»„æ­£äº¤åŸºæ˜ å°„åˆ°å¦ä¸€ç»„æ­£äº¤åŸºã€‚</p>
<ul>
<li>æˆ‘ä»¬å‡è®¾å­˜åœ¨$M \times N$çš„çŸ©é˜µ$A$ã€‚ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œåœ¨nç»´ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ç»„æ­£äº¤åŸº$${v_1,v_2,â€¦,v_n}$$ï¼Œä½¿å¾—ç»è¿‡Aå˜æ¢åè¿˜æ˜¯æ­£äº¤çš„ã€‚</li>
<li>é‚£ä¹ˆ$A$çŸ©é˜µå°±å°†è¿™ç»„åŸºæ˜ å°„ä¸ºï¼š$${Av_1,Av_2,â€¦,Av_n}$$</li>
<li>å¦‚æœè¦ä½¿å¾—å®ƒä»¬ä¸¤ä¸¤æ­£äº¤ï¼Œå³ï¼š$$Av_i\cdot Av_j = (Av_i)^TAv_j=v_i^TA^TAv_j=0$$</li>
<li>æ ¹æ®å‡è®¾ï¼Œå­˜åœ¨$$v_i^Tv_j=v_i\cdot v_j = 0$$</li>
<li>æ‰€ä»¥å¦‚æœæ­£äº¤åŸºvé€‰æ‹©ä¸ºAâ€™Açš„ç‰¹å¾å‘é‡çš„è¯ï¼Œç”±äºAâ€™Aæ˜¯å¯¹ç§°é˜µï¼Œvä¹‹é—´ä¸¤ä¸¤æ­£äº¤ï¼Œé‚£ä¹ˆ$$v_i^TA^TAv_j=v_i^T\lambda _jv_j=0$$ï¼Œè¿™æ ·å°±æ‰¾åˆ°äº†æ­£äº¤åŸºæ˜ å°„åè¿˜æ˜¯æ­£äº¤åŸºäº†ã€‚</li>
<li>å°†æ˜ å°„åçš„æ­£äº¤åŸºå•ä½åŒ–ï¼Œ$$u_i = \frac{Av_i}{|Av_i|}=\frac{1}{\sqrt{\lambda_i}}Av_i$$<br>å…¶ä¸­$u_i$æ˜¯æ˜ å°„åçš„æ­£äº¤åŸºï¼Œ$v_i$æ˜¯æ˜ å°„å‰çš„æ­£äº¤åŸºã€‚</li>
<li>ç”±æ­¤å¯å¾—ï¼Œ$$Av_i=u_i\alpha_i(å¥‡å¼‚å€¼)=\sqrt{\lambda_i},0\leq i \leq k,k=Rank(A)$$</li>
</ul>
<p>è¿™æ ·æˆ‘ä»¬å°±è¯æ˜äº†ï¼Œè¿™ä¸ªå˜æ¢æ˜¯å­˜åœ¨çš„ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å‘é‡ç»„${u_1,u_2,â€¦,u_k}$æ‰©å……ä¸º$R^m$ä¸­çš„æ ‡å‡†æ­£äº¤åŸº$u_1,u_2,â€¦,u_r,â€¦,u_m$ï¼Œåˆ™ï¼š<br>$$AV=A(v_1,v_2,â€¦,v_n)=(Av_1,Av_2,â€¦,Av_k,0,0,â€¦,0)$$<br>è€Œç”±ä¹‹å‰çš„æ¨å¯¼æˆ‘ä»¬çŸ¥é“ï¼Œ$Av_i=u_i\alpha_i(å¥‡å¼‚å€¼)$ï¼Œå› æ­¤ä¸Šå¼å˜ä¸º<br>$$AV=(u_1\alpha_1,u_2\alpha_2,â€¦,u_k\alpha_k,0,0,â€¦,0)=UÎ£$$</p>
<p>å³ï¼š<br>$$A=UÎ£V^T$$</p>
<p>è¿™å°±<strong>è¡¨æ˜</strong>ä»»æ„çš„çŸ©é˜µ$A$æ˜¯å¯ä»¥åˆ†è§£æˆä¸‰ä¸ªçŸ©é˜µã€‚$V$è¡¨ç¤ºäº†åŸå§‹åŸŸçš„æ ‡å‡†æ­£äº¤åŸºï¼Œ$U$è¡¨ç¤ºç»è¿‡$A$å˜æ¢åçš„co-domainçš„æ ‡å‡†æ­£äº¤åŸºï¼Œ$Î£$è¡¨ç¤ºäº†$V$ä¸­çš„å‘é‡ä¸$U$ä¸­ç›¸å¯¹åº”å‘é‡ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>$Aæ˜¯m\times nç»´åº¦$</li>
<li>$Uå«å·¦å¥‡å¼‚å‘é‡ï¼Œæ˜¯m\times mç»´çš„æ­£äº¤çŸ©é˜µ$</li>
<li>$Î£å«å³å¥‡å¼‚å‘é‡ï¼Œæ˜¯n\times nç»´çš„å¯¹è§’çŸ©é˜µï¼Œä½†å®é™…ä¸Šåªæœ‰å·¦ä¸Šè§’çš„ké˜¶éé›¶$,å³:<img src="https://ooo.0o0.ooo/2017/07/10/5963960b257f5.png" alt=""> </li>
</ul>
<p>ä»å¤§å°ä¸Šæ¥çœ‹ï¼š<img src="https://ooo.0o0.ooo/2017/07/10/59639293b5bc5.png" alt=""> </p>
<p>å³ï¼š<img src="https://ooo.0o0.ooo/2017/07/10/59639634df34d.png" alt=""> </p>
<h2 id="ç‰¹å¾å€¼åˆ†è§£ä¸å¥‡å¼‚å€¼åˆ†è§£">2.3. ç‰¹å¾å€¼åˆ†è§£ä¸å¥‡å¼‚å€¼åˆ†è§£</h2><p>å‚è€ƒæ–‡çŒ®<a href="https://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦(5)-å¼ºå¤§çš„çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£(SVD)åŠå…¶åº”ç”¨</a>æåˆ°ï¼Œå¥‡å¼‚å€¼å’Œç‰¹å¾å€¼å¯ä»¥å¯¹åº”èµ·æ¥ã€‚</p>
<h2 id="éƒ¨åˆ†å¥‡å¼‚å€¼åˆ†è§£">2.4. éƒ¨åˆ†å¥‡å¼‚å€¼åˆ†è§£</h2><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå‰10%ç”šè‡³1%çš„å¥‡å¼‚å€¼çš„å’Œå°±å äº†å…¨éƒ¨çš„å¥‡å¼‚å€¼ä¹‹å’Œçš„99%ä»¥ä¸Šäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å‰rå¤§çš„å¥‡å¼‚å€¼æ¥è¿‘ä¼¼æè¿°çŸ©é˜µï¼Œè¿™é‡Œå®šä¹‰ä¸€ä¸‹éƒ¨åˆ†å¥‡å¼‚å€¼åˆ†è§£ï¼š<br>$$A_{m\times n}\approx U_{m\times r}Î£_{r_\times r}V^T_{r\times n}$$<br> ræ˜¯ä¸€ä¸ªè¿œå°äºmã€nçš„æ•°ï¼Œè¿™æ ·çŸ©é˜µçš„ä¹˜æ³•çœ‹èµ·æ¥åƒæ˜¯ä¸‹é¢çš„æ ·å­ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/10/596398011f9e0.png" alt=""><br>å³è¾¹çš„ä¸‰ä¸ªçŸ©é˜µç›¸ä¹˜çš„ç»“æœå°†ä¼šæ˜¯ä¸€ä¸ªæ¥è¿‘äºAçš„çŸ©é˜µï¼Œåœ¨è¿™å„¿ï¼Œrè¶Šæ¥è¿‘äºnï¼Œåˆ™ç›¸ä¹˜çš„ç»“æœè¶Šæ¥è¿‘äºAã€‚è€Œè¿™ä¸‰ä¸ªçŸ©é˜µçš„é¢ç§¯ä¹‹å’Œï¼ˆåœ¨å­˜å‚¨è§‚ç‚¹æ¥è¯´ï¼ŒçŸ©é˜µé¢ç§¯è¶Šå°ï¼Œå­˜å‚¨é‡å°±è¶Šå°ï¼‰è¦è¿œè¿œå°äºåŸå§‹çš„çŸ©é˜µAï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦å‹ç¼©ç©ºé—´æ¥è¡¨ç¤ºåŸçŸ©é˜µAï¼Œæˆ‘ä»¬å­˜ä¸‹è¿™é‡Œçš„ä¸‰ä¸ªçŸ©é˜µï¼šUã€Î£ã€Vå°±å¥½äº†ã€‚</p>
<p><strong>å°ä¾‹å­</strong></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç”¨pythonçš„SVDåˆ†è§£å°ä¾‹å­ã€‚</p>
<pre><code>&apos;&apos;&apos;Python
#coding=utf-8
# é¦–å…ˆåšä¸€äº›æ•°æ®å£°æ˜
from sklearn.decomposition import TruncatedSVD
from matplotlib import pyplot as plt
from numpy import random
import numpy as np
from mpl_toolkits.mplot3d import Axes3D
import pandas as pd
fig = plt.figure()
ax = Axes3D(fig)
ax=plt.subplot(111,projection=&apos;3d&apos;)
ax.set_zlabel(&apos;Z&apos;) #åæ ‡è½´
ax.set_ylabel(&apos;Y&apos;)
ax.set_xlabel(&apos;X&apos;)
X = np.arange(0, 4, 0.125) + 0.2 * random.randn(32)
Y = np.arange(0, 4, 0.125) + 0.2 * random.randn(32)
Z = np.arange(0, 4, 0.125) + 0.2 * random.randn(32)
# æ•°æ®æ˜¯3ç»´Ã—32ç»´
data = [[x, y, z] for x, y, z in zip(X, Y, Z)]


# åˆ†è§£ï¼Œn_componentsæ˜¯ä¸»å…ƒç´ ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯ç»´åº¦
svd = TruncatedSVD(n_components=2, algorithm=&quot;arpack&quot;, n_iter=1000)
transformed_data = svd.fit_transform(data)
# è¿˜åŸ
data_inverse = svd.inverse_transform(transformed_data)

#ç”»å›¾
X_ = [x[0] for x in data_inverse]
Y_ = [y[1] for y in data_inverse]
Z_ = [z[2] for z in data_inverse]
ax.scatter(X, Y, Z, c=&apos;r&apos;)#åŸå§‹æ•°æ®æ˜¯çº¢è‰²
ax.scatter(X_, Y_, Z_, c=&apos;b&apos;)#åˆ†è§£åçš„æ•°æ®æ˜¯è“è‰²
plt.savefig(&quot;svd.png&quot;)
plt.show()
print svd.explained_variance_ratio_
&apos;&apos;&apos;
</code></pre><p>å½“é™åˆ°äºŒç»´ï¼Œå†è¿˜åŸæ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/11/59643b2a666c7.png" alt=""><br>é™åˆ°ä¸€ç»´ï¼Œå†è¿˜åŸï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/11/59643cbeed773.png" alt=""> </p>
<h1 id="SVDä¸æ½œåœ¨è¯­ä¹‰ç´¢å¼•">3. SVDä¸æ½œåœ¨è¯­ä¹‰ç´¢å¼•</h1><p>$$A=UÎ£V^T$$</p>
<p>å´å†›è€å¸ˆåœ¨çŸ©é˜µè®¡ç®—ä¸æ–‡æœ¬å¤„ç†ä¸­çš„åˆ†ç±»é—®é¢˜ä¸­è°ˆåˆ°ï¼šä¸‰ä¸ªçŸ©é˜µæœ‰éå¸¸æ¸…æ¥šçš„ç‰©ç†å«ä¹‰ã€‚</p>
<ul>
<li>$U$ä¸­çš„æ¯ä¸€è¡Œè¡¨ç¤ºæ„æ€ç›¸å…³çš„ä¸€ç±»è¯ï¼Œå…¶ä¸­çš„æ¯ä¸ªéé›¶å…ƒç´ è¡¨ç¤ºè¿™ç±»è¯ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§ï¼ˆæˆ–è€…è¯´ç›¸å…³æ€§ï¼‰ï¼Œæ•°å€¼è¶Šå¤§è¶Šç›¸å…³ã€‚</li>
<li>$V^T$ä¸­çš„æ¯ä¸€åˆ—è¡¨ç¤ºåŒä¸€ä¸»é¢˜ä¸€ç±»æ–‡ç« ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ è¡¨ç¤ºè¿™ç±»æ–‡ç« ä¸­æ¯ç¯‡æ–‡ç« çš„ç›¸å…³æ€§ã€‚ä¸­é—´çš„çŸ©é˜µåˆ™è¡¨ç¤ºç±»è¯å’Œæ–‡ç« é›·ä¹‹é—´çš„ç›¸å…³æ€§ã€‚</li>
<li>å› æ­¤ï¼Œæˆ‘ä»¬åªè¦å¯¹å…³è”çŸ©é˜µ$A$è¿›è¡Œä¸€æ¬¡å¥‡å¼‚å€¼åˆ†è§£ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŒæ—¶å®Œæˆäº†è¿‘ä¹‰è¯åˆ†ç±»å’Œæ–‡ç« çš„åˆ†ç±»ã€‚ï¼ˆåŒæ—¶å¾—åˆ°æ¯ç±»æ–‡ç« å’Œæ¯ç±»è¯çš„ç›¸å…³æ€§ï¼‰ã€‚</li>
</ul>
<p>å‚è€ƒæ–‡çŒ®<a href="https://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦(5)-å¼ºå¤§çš„çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£(SVD)åŠå…¶åº”ç”¨</a>ç»™å‡ºäº†ä¸€ä¸ªç†è§£è¿™å¥è¯çš„ä¾‹å­ï¼Œæ­¤å¤„ä¸å†é˜è¿°ã€‚</p>
<p>æˆ‘åœ¨åšæ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæ›¾å°è¯•è¿‡ç”¨SVDåˆ†è§£åšAPPç‰¹å¾ï¼Œæ¥æè¿°APPä¹‹é—´çš„ç›¸ä¼¼æ€§ç‰¹å¾ã€‚ä½†æ•ˆæœä¸ä½³ã€‚æ¨æµ‹åŸå› æ˜¯ç»´åº¦è¿‡ä½ï¼ˆå‡ ç™¾ä¸‡ç»´å‹åˆ°äº†20ç»´ï¼‰ã€‚é¡¹ç›®<a href="https://github.com/jiayi797/svd_app_recommend" target="_blank" rel="external">åœ¨è¿™é‡Œ</a></p>
<p>ä½†è¿™é‡Œæˆ‘è¿˜æ˜¯æ‰“ç®—å¥½å¥½çœ‹çœ‹ã€‚ä¸‡ä¸€ä»¥åç”¨åˆ°å‘¢ï¼Ÿ</p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://charleshm.github.io/2016/03/SVD-Recommendation-System/" target="_blank" rel="external">SVDåœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a>ä»¥ç»å…¸çš„ç”µå½±è¯„åˆ†é—®é¢˜ä¸ºä¾‹ï¼Œè®²è¿°äº†æ•´ä¸ªè¿‡ç¨‹ã€‚å‚è€ƒæ–‡çŒ®<a href="http://www.jscon.co/multiarray/rs_used_svd.html" target="_blank" rel="external">SVDåœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a>ç”¨matlabè¿›è¡Œäº†è¯¦ç»†çš„è¿‡ç¨‹å¤ç°ã€‚</p>
<p>æˆ‘çš„ç†è§£ï¼š<br><strong>SVDåˆ†è§£</strong><br>SVDåˆ†è§£æ˜¯ï¼š$$A_{m\times n}=U_{m\times m}Î£_{m\times n}V^T_{n\times n}$$<br>å…¶ä¸­ï¼š</p>
<ul>
<li>$Î£_{m\times n}$æ˜¯ä¸€ä¸ªå¯¹è§’é˜µã€‚</li>
<li>U_{m\times m}è¡¨ç¤ºè¡Œé—´å…ƒç´ ï¼ˆä¸€èˆ¬æ˜¯ç”¨æˆ·ï¼‰çš„ç›¸ä¼¼åº¦</li>
<li>V^T_{n\times n}è¡¨ç¤ºåˆ—é—´å…ƒç´ ï¼ˆä¸€èˆ¬æ˜¯å•†å“ï¼‰çš„ç›¸ä¼¼åº¦<br>æ ¹æ®å¥½å‹å¼ æ€é¥çš„ç†è§£ï¼Œæ˜¯é€šè¿‡æ•°å­¦çš„æ–¹æ³•ï¼Œæ¥å°†è¡Œå’Œåˆ—çš„æ‹†å¼€ï¼Œæ”¾åœ¨ä¸¤ä¸ªçŸ©é˜µé‡Œã€‚<br><strong>é™ç»´</strong><br>æ ¹æ®PCAç†è®ºï¼ˆå¼ºçƒˆå»ºè®®çœ‹æ–¯å¦ç¦å¤§å­¦å®‰å¾·é²è€å¸ˆçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ï¼Œè¿™é‡Œæœ‰å‰è¾ˆçš„ç¬”è®°<a href="http://blog.csdn.net/stdcoutzyx/article/details/37568225" target="_blank" rel="external">æ–¯å¦ç¦MLå…¬å¼€è¯¾ç¬”è®°14â€”â€”ä¸»æˆåˆ†åˆ†æ</a>ï¼Œæˆ‘ä»¬å¯ä»¥å–å‰$r$ç»´æ¥å¯¹çŸ©é˜µè¿›è¡Œè¿‘ä¼¼è¡¨ç¤ºï¼š<br>$$A_{m\times n}\approx U_{m\times r}Î£_{m\times n}V^T_{r\times n}$$</li>
</ul>
<h1 id="é¡¹ç›®ä»£ç ">4. é¡¹ç›®ä»£ç </h1><p><a href="https://github.com/jiayi797/svd_app_recommend" target="_blank" rel="external">SVDé¡¹ç›®ä»£ç </a></p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.qiujiawei.com/linear-algebra-9/" target="_blank" rel="external">çº¿æ€§ä»£æ•°ä¹‹å¥‡å¼‚å€¼(SVD)åˆ†è§£</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_3f738ee00102val0.html" target="_blank" rel="external">å¥‡å¼‚å€¼åˆ†è§£(SVD)åŸç†è¯¦è§£åŠæ¨å¯¼</a></li>
<li><a href="http://charleshm.github.io/2016/03/Singularly-Valuable-Decomposition/" target="_blank" rel="external">æ¼«è°ˆå¥‡å¼‚å€¼åˆ†è§£</a></li>
<li><a href="http://www.sohu.com/a/127149396_464826" target="_blank" rel="external">æœºå™¨å­¦ä¹ ç³»åˆ—-SVDç¯‡</a></li>
<li><a href="https://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦(5)-å¼ºå¤§çš„çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£(SVD)åŠå…¶åº”ç”¨</a></li>
<li><a href="http://charleshm.github.io/2016/03/SVD-Recommendation-System/" target="_blank" rel="external">SVDåœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a></li>
<li><a href="http://www.jscon.co/multiarray/rs_used_svd.html" target="_blank" rel="external">SVDåœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a></li>
<li><a href="http://blog.csdn.net/stdcoutzyx/article/details/37568225" target="_blank" rel="external">æ–¯å¦ç¦MLå…¬å¼€è¯¾ç¬”è®°14â€”â€”ä¸»æˆåˆ†åˆ†æ</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çŸ©é˜µåˆ†è§£ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[çŸ©é˜µç›¸å…³çŸ¥è¯†å¤ä¹ ]]></title>
      <url>/2017/07/10/%E6%95%B0%E5%AD%A6-%E7%9F%A9%E9%98%B5%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E5%A4%8D%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h1 id="ç‰¹å¾å€¼ä¸å¥‡å¼‚å€¼">1. ç‰¹å¾å€¼ä¸å¥‡å¼‚å€¼</h1><p><strong>ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡</strong></p>
<p>å¦‚æœä¸€ä¸ªå‘é‡$v$æ˜¯æ–¹é˜µ$A$çš„ç‰¹å¾å‘é‡ï¼Œé‚£ä¹ˆï¼š<br>$$Av=\lambda v$$</p>
<ul>
<li>$\lambda$:ç‰¹å¾å€¼</li>
<li>$v$:ç‰¹å¾å‘é‡<br>æŠŠ$A$ä¹˜åˆ°$v$ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ª$\lambda v$ï¼Œä¹Ÿå°±æ˜¯æ„å‘³ç€æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ–¹å‘æœªå˜ä½†åœ¨é•¿åº¦ä¸Šæœ‰ä¼¸ç¼©æ”¹å˜çš„å‘é‡ï¼ˆæ–¹å‘æœªå˜ä¸å‡†ç¡®ï¼Œæœ‰å¯èƒ½å˜åå‘ï¼‰ã€‚è¿™æ˜¯è®©$A$ä¹˜ä»¥ä»–çš„ç‰¹å¾å‘é‡è¡¨ç°å‡ºæ¥çš„æ€§è´¨ã€‚</li>
</ul>
<p>å› æ­¤ï¼š</p>
<ul>
<li>ç‰¹å¾å‘é‡æ‰€åœ¨ç›´çº¿ä¸Šçš„å‘é‡éƒ½æ˜¯ç‰¹å¾å‘é‡ï¼›</li>
<li>ç‰¹å¾å‘é‡æ‰€åœ¨çš„ç›´çº¿ï¼Œå«ç‰¹å¾ç©ºé—´ï¼›</li>
</ul>
<p><strong>ç‰¹å¾å€¼åˆ†è§£</strong></p>
<p>ç‰¹å¾å€¼åˆ†è§£æ˜¯æŠŠä¸€ä¸ªné˜¶å®å¯¹ç§°çŸ©é˜µåˆ†è§£ä¸ºä¸‹é¢çš„å½¢å¼ï¼š<br>$$A=QÎ£Q^{-1}$$<br>å…¶ä¸­ï¼š</p>
<ul>
<li>$Q$æ˜¯è¿™ä¸ªçŸ©é˜µ$A$çš„ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µ</li>
<li>$Î£$æ˜¯ä¸€ä¸ªå¯¹è§’é˜µï¼Œæ¯ä¸ªå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å°±æ˜¯ä¸€ä¸ªç‰¹å¾å€¼</li>
</ul>
<h1 id="æ­£äº¤å˜æ¢ä¸æ­£äº¤å†›é˜µ">2. æ­£äº¤å˜æ¢ä¸æ­£äº¤å†›é˜µ</h1><h2 id="æ­£äº¤å˜æ¢">2.1. æ­£äº¤å˜æ¢</h2><p><strong>ä»€ä¹ˆæ˜¯æ­£äº¤å˜æ¢ï¼Ÿ</strong><br>æ­£äº¤å˜æ¢ï¼šåœ¨çº¿æ€§ç©ºé—´ä¸­ï¼Œä¿æŒå‘é‡é•¿åº¦ä¸å˜çš„çº¿æ€§å˜æ¢ã€‚<br><strong>æ­£äº¤å˜æ¢çš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>è®¾$V$ä¸ºæ¬§å¼ç©ºé—´ï¼Œ$T$æ˜¯$V$çš„ä¸€ä¸ªçº¿æ€§å˜æ¢ã€‚å¦‚æœ$T$ä¿æŒ$V$ä¸­ä»»ä¸€å‘é‡$x$çš„é•¿åº¦ä¸å˜ï¼Œå³æœ‰ï¼š<br>$$(x,x)=(Tx,Tx)$$<br>é‚£ä¹ˆç§°$T$æ˜¯$V$çš„ä¸€ä¸ªæ­£äº¤å˜æ¢ã€‚ï¼ˆå³å†…ç§¯ä¸å˜ï¼‰</p>
<p>æ³¨ï¼š<br>$(x,x)$æ˜¯å‘é‡å†…ç§¯<br><strong>æ€æ ·çš„å˜æ¢ç®—æ˜¯æ­£äº¤å˜æ¢ï¼Ÿ</strong><br>çº¿æ€§å˜æ¢$T$ä¸ºæ­£äº¤å˜æ¢çš„å……è¦æ¡ä»¶æ˜¯ï¼Œå¯¹äºæ¬§å¼ç©ºé—´$V$ä¸­ä»»äºŒå‘é‡$x,y$éƒ½æœ‰ï¼š<br>$$(x,y)=(Tx,Ty)$$</p>
<h2 id="æ­£äº¤çŸ©é˜µ">2.2. æ­£äº¤çŸ©é˜µ</h2><p><strong>æ­£äº¤çŸ©é˜µçš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>å¦‚æœå®æ–¹é˜µ$Q$æ»¡è¶³ï¼š<br>$$T^TQ=I,æˆ– Q^{-1}=Q^T$$<br>åˆ™ç§°$Q$ä¸ºæ­£äº¤çŸ©é˜µ</p>
<p>å…¶ä¸­ï¼Œ$I$æ˜¯å•ä½çŸ©é˜µã€‚<br><strong>æ­£äº¤çŸ©é˜µæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ</strong></p>
<ul>
<li>æ­£äº¤çŸ©é˜µçš„è¡Œåˆ—å¼å¿…å®šä¸º$+-1$</li>
<li>è¡Œåˆ—å¼å€¼ä¸º+1çš„æ­£äº¤çŸ©é˜µï¼Œç§°ä¸ºç‰¹æ®Šæ­£äº¤çŸ©é˜µï¼Œå®ƒæ˜¯ä¸€ä¸ªæ—‹è½¬çŸ©é˜µã€‚</li>
<li>è¡Œåˆ—å¼å€¼ä¸º-1çš„æ­£äº¤çŸ©é˜µï¼Œç§°ä¸ºç‘•æ—‹è½¬çŸ©é˜µã€‚ç‘•æ—‹è½¬æ˜¯æ—‹è½¬åŠ ä¸Šé•œå°„ã€‚é•œå°„ä¹Ÿæ˜¯ä¸€ç§ç‘•æ—‹è½¬ã€‚</li>
<li>æ­£äº¤çŸ©é˜µçš„é€†çŸ©é˜µä¾ç„¶æ˜¯æ­£äº¤çŸ©é˜µ</li>
<li>ä¸¤ä¸ªæ­£äº¤çŸ©é˜µçš„ä¹˜ç§¯ä¾ç„¶æ˜¯æ­£äº¤çŸ©é˜µ</li>
<li>ä¸‹é¢æ˜¯ä¸€äº›å°çš„æ­£äº¤çŸ©é˜µå’Œå¯èƒ½çš„è§£é‡Šï¼š<br><img src="https://ooo.0o0.ooo/2017/07/10/59632337a1cdf.png" alt=""> </li>
</ul>
<p><strong>æ€æ ·çš„çŸ©é˜µèƒ½å¤Ÿæˆä¸ºæ­£äº¤çŸ©é˜µï¼Ÿ</strong><br>$Q$æ˜¯æ­£äº¤çŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯ï¼Œå®ƒçš„åˆ—å‘é‡æ˜¯ä¸¤ä¸¤æ­£äº¤çš„å•ä½å‘é‡ã€‚</p>
<h2 id="æ­£äº¤å˜æ¢ä¸æ­£äº¤çŸ©é˜µçš„å…³ç³»">2.3. æ­£äº¤å˜æ¢ä¸æ­£äº¤çŸ©é˜µçš„å…³ç³»</h2><p>æ¬§å¼ç©ºé—´çš„çº¿æ€§å˜æ¢æ˜¯æ­£äº¤å˜æ¢çš„å……è¦æ¡ä»¶æ˜¯ï¼Œå®ƒå¯¹äºæ ‡å‡†æ­£äº¤åŸºçš„çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µã€‚</p>
<h1 id="é…‰ç©ºé—´">3. é…‰ç©ºé—´</h1><p>æ¬§å¼ç©ºé—´æ˜¯é’ˆå¯¹å®æ•°åŸŸ$R$ä¸Šçš„çº¿æ€§ç©ºé—´ï¼›<br>é…‰ç©ºé—´æ˜¯ç‰¹æ®Šçš„å¤çº¿æ€§ç©ºé—´ã€‚</p>
<p><strong>é…‰å˜æ¢</strong><br>é…‰ç©ºé—´$V$ä¸­çš„çº¿æ€§å˜æ¢$T$ï¼Œå¦‚æœæ»¡è¶³<br>$$(x,x)=(Tx,Tx),x\in V$$<br>åˆ™ç§°$T$ä¸º$V$çš„é…‰å˜æ¢ã€‚<br><strong>é…‰çŸ©é˜µ</strong><br>é…‰å˜æ¢åœ¨é…‰ç©ºé—´çš„æ ‡å‡†æ­£äº¤åŸºä¸‹çš„çŸ©é˜µ$A$æ˜¯é…‰çŸ©é˜µï¼Œå³$A$æ»¡è¶³ä¸‹å¼ï¼š<br>$$A^HA=AA^H=I$$</p>
<ul>
<li>é…‰çŸ©é˜µçš„é€†çŸ©é˜µä¹Ÿæ˜¯é…‰çŸ©é˜µ</li>
<li>ä¸¤ä¸ªé…‰çŸ©é˜µçš„ä¹˜ç§¯è¿˜æ˜¯é…‰çŸ©é˜µ</li>
</ul>
<h2 id="Schurå®šç†">3.1. Schurå®šç†</h2><p><strong>é…‰ç©ºé—´ä¸Šçš„Schurå®šç†ï¼ˆå®šç†1.41ï¼‰</strong><br>è®¾$A\in C^{n\times n}$çš„ç‰¹å¾å€¼ä¸º$\lambda _1,\lambda _2,â€¦,\lambda _n$ï¼Œåˆ™å­˜åœ¨é…‰çŸ©é˜µ$P$,ä½¿å¾—ï¼š<br>$$P^{-1}AP=P^HAP=\left[<br>\begin{matrix}<br>\lambda _1 &amp; .          &amp; â€¦&amp; . \\<br>           &amp; \lambda _2 &amp; â€¦&amp; . \\<br>           &amp;            &amp; â€¦&amp; . \\<br>           &amp;            &amp;    &amp;\lambda _n<br>\end{matrix}<br>\right]$$</p>
<p><strong>å®æ•°ç©ºé—´ä¸Šçš„Schurå®šç†</strong><br>è®¾$A\in R^{n\times n}$çš„ç‰¹å¾å€¼ä¸º$\lambda _1,\lambda _2,â€¦,\lambda _n$ï¼Œä¸”$\lambda _n \in R(i=1,2,â€¦,n)$,åˆ™å­˜åœ¨æ­£äº¤çŸ©é˜µ$Q$,ä½¿å¾—ï¼š<br>$$Q^{-1}AQ=Q^HAQ=\left[<br>\begin{matrix}<br>\lambda _1 &amp; .          &amp; â€¦&amp; . \\<br>           &amp; \lambda _2 &amp; â€¦&amp; . \\<br>           &amp;            &amp; â€¦&amp; . \\<br>           &amp;            &amp;    &amp;\lambda _n<br>\end{matrix}<br>\right]$$</p>
<p><strong>æ­£è§„çŸ©é˜µ</strong></p>
<p>è®¾$A \in C^{n \times n}$ï¼Œä¸”ç­‰å¼<br>$$A^HA=AA^H$$<br>æˆç«‹ï¼Œåˆ™ç§°$A$ä¸ºæ­£è§„çŸ©é˜µã€‚</p>
<p><strong>æ­£è§„çŸ©é˜µä¸å¯¹è§’çŸ©é˜µçš„å®šç†ï¼ˆå®šç†1.42ï¼‰</strong></p>
<ul>
<li>ï¼ˆé…‰ç©ºé—´ï¼‰è®¾$A \in C^{n \times n}$ï¼Œåˆ™$A$é…‰ç›¸ä¼¼äºå¯¹è§’çŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯$A$ä¸ºæ­£è§„çŸ©é˜µï¼›</li>
<li>ï¼ˆå®æ•°ç©ºé—´ï¼‰$A \in R^{n \times n}$ï¼Œä¸”$A$çš„ç‰¹å¾å€¼éƒ½æ˜¯å®æ•°ï¼Œåˆ™$A$æ­£äº¤ç›¸ä¼¼äºå¯¹è§’çŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯$A$ä¸ºæ­£è§„çŸ©é˜µã€‚</li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">4. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://zh.wikipedia.org/wiki/%E6%AD%A3%E4%BA%A4%E7%9F%A9%E9%98%B5" target="_blank" rel="external">ç»´åŸºç™¾ç§‘ï¼Œæ­£äº¤çŸ©é˜µ</a></li>
<li><a href="">çŸ©é˜µè®ºï¼Œç¨‹äº‘é¹</a></li>
<li><a href="http://zisong.me/post/wo-dui-te-zheng-zhi-yu-te-zheng-xiang-liang-de-li-jie" target="_blank" rel="external">æˆ‘å¯¹ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„ç†è§£</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çŸ©é˜µè®º </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®€å•æœç´¢å¼•æ“çš„å®ç°]]></title>
      <url>/2017/07/09/Python-%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p>è¿™æ˜¯å¾ˆä¹…ä»¥å‰çš„IRIEçš„æœŸæœ«å¤§ä½œä¸šã€‚ç°åœ¨è´´åœ¨è‡ªå·±çš„åšå®¢ä¸Šã€‚</p>
<p>å®éªŒè¦æ±‚ï¼š</p>
<ol>
<li>ç”¨çˆ¬è™«é‡‡é›†ç‰¹å®šç½‘ç«™çš„ä¿¡æ¯ï¼›</li>
<li>è®¾è®¡å®ç°ä¿¡æ¯æ£€ç´¢ä¸æå–ç³»ç»Ÿï¼Œå¯¹é‡‡é›†çš„ä¿¡æ¯è¿›è¡Œæ£€ç´¢æå–ï¼›</li>
<li>ç»“åˆwebpyä¸htmlå®ç°ç•Œé¢å±•ç¤ºã€‚</li>
</ol>
<h1 id="ç›¸å…³çŸ¥è¯†">1. ç›¸å…³çŸ¥è¯†</h1><h2 id="çˆ¬è™«">1.1. çˆ¬è™«</h2><p>ç½‘ç»œçˆ¬è™«æ˜¯æœç´¢å¼•æ“æŠ“å–ç³»ç»Ÿä¸­é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯å°†äº’è”ç½‘ä¸Šçš„ç½‘é¡µä¸‹è½½åˆ°æœ¬åœ°å½¢æˆä¸€ä¸ªæ–‡ä»¶æˆ–äº’è”ç½‘å†…å®¹çš„é•œåƒå¤‡ä»½ã€‚æµç¨‹å¦‚ä¸‹ï¼š<br>a.  ä»ç»™å®šçš„å…¥å£ç½‘å€æŠŠç¬¬ä¸€ä¸ªç½‘é¡µä¸‹è½½ä¸‹æ¥<br>b.  ä»ç¬¬ä¸€ä¸ªç½‘é¡µä¸­æå–å‡ºæ‰€æœ‰æ–°çš„ç½‘é¡µåœ°å€ï¼Œæ”¾å…¥ä¸‹è½½åˆ—è¡¨ä¸­<br>c.  æŒ‰ä¸‹è½½åˆ—è¡¨ä¸­çš„åœ°å€ï¼Œä¸‹è½½æ‰€æœ‰æ–°çš„ç½‘é¡µ<br>d.  ä»æ‰€æœ‰æ–°çš„ç½‘é¡µä¸­æ‰¾å‡ºæ²¡æœ‰ä¸‹è½½è¿‡çš„ç½‘é¡µåœ°å€ï¼Œæ›´æ–°ä¸‹è½½åˆ—è¡¨<br>e.  é‡å¤3ã€4ä¸¤æ­¥ï¼Œç›´åˆ°æ›´æ–°åçš„ä¸‹è½½åˆ—è¡¨ä¸ºç©ºè¡¨æ—¶åœæ­¢<br>å…¶å®å°±æ˜¯ç®€åŒ–æˆä¸‹é¢çš„æ­¥éª¤ï¼š<br>a.  æŒ‰ä¸‹è½½åˆ—è¡¨è¿›è¡Œä¸‹è½½<br>b.  æ›´æ–°ä¸‹è½½åˆ—è¡¨<br>c.  å¾ªç¯æ“ä½œaï¼Œbï¼Œç›´åˆ°åˆ—è¡¨ä¸ºç©ºç»“æŸ<br>åœ¨æœ¬æ¬¡ä½œä¸šä¸­æˆ‘ä»¬ä½¿ç”¨pythonç¼–ç å®ç°çˆ¬è™«çš„åŠŸèƒ½ï¼Œå…¶ä¸­ç”¨åˆ°çš„pythonç»„ä»¶æœ‰ï¼š<br>urllib2ï¼šç”¨äºè·å–URLsï¼ˆUniform Resource Locatorsï¼‰çš„ç»„ä»¶ï¼Œä»¥urlopenå‡½æ•°çš„å½¢å¼æä¾›ä¸€ä¸ªéå¸¸ç®€å•çš„æ¥å£ï¼Œå…·æœ‰åˆ©ç”¨ä¸åŒåè®®è·å–URLsçš„èƒ½åŠ›ï¼ŒåŒæ—¶æä¾›äº†ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ¥å£æ¥å¤„ç†ä¸€èˆ¬æƒ…å†µï¼Œå¦‚ï¼šåŸºç¡€éªŒè¯ï¼Œcookiesä»£ç†å’Œå…¶ä»–ã€‚é€šè¿‡handlerså’Œopenersçš„å¯¹è±¡æä¾›ã€‚urllib2æ”¯æŒè·å–ä¸åŒæ ¼å¼çš„URLså¹¶åˆ©ç”¨å®ƒä»¬ç›¸å…³ç½‘ç»œåè®®ï¼ˆä¾‹å¦‚FTPï¼ŒHTTPï¼‰è¿›è¡Œè·å–ã€‚<br>BeautifulSoupï¼šæ˜¯pythonçš„ä¸€ä¸ªåº“ï¼Œæœ€ä¸»è¦çš„åŠŸèƒ½æ˜¯ä»ç½‘é¡µæŠ“å–æ•°æ®ã€‚å®ƒæä¾›ç®€å•çš„ã€pythonå¼çš„å‡½æ•°ç”¨æ¥å¤„ç†å¯¼èˆªã€æœç´¢ã€ä¿®æ”¹åˆ†ææ ‘ç­‰åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡è§£ææ–‡æ¡£ä¸ºç”¨æˆ·æä¾›éœ€è¦æŠ“å–çš„æ•°æ®ã€‚åœ¨bs4åº“ä¸­å¯¼å…¥ã€‚<br>Htmlparserï¼šæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæä¾›äº†çº¿æ€§å’ŒåµŒå¥—ä¸¤ç§æ–¹å¼æ¥è§£æç½‘é¡µï¼Œä¸»è¦ç”¨äº html ç½‘é¡µçš„è½¬æ¢ï¼ˆTransformationï¼‰ä»¥åŠç½‘é¡µå†…å®¹çš„æŠ½å–ï¼ˆExtractionï¼‰ã€‚HtmlParser æœ‰å¦‚ä¸‹ä¸€äº›æ˜“äºä½¿ç”¨çš„ç‰¹æ€§ï¼šè¿‡æ»¤å™¨ï¼ˆFiltersï¼‰ï¼Œè®¿é—®è€…æ¨¡å¼ï¼ˆVisitorsï¼‰ï¼Œå¤„ç†è‡ªå®šä¹‰æ ‡ç­¾ä»¥åŠæ˜“äºä½¿ç”¨çš„ JavaBeansã€‚<br>selenium ï¼šæ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œè¿›è¡Œwebçš„è‡ªåŠ¨åŒ–æµ‹è¯•çš„å·¥å…·ï¼Œå®ƒæä¾›ä¸€ç»„APIå¯ä»¥ä¸çœŸå®çš„æµè§ˆå™¨å†…æ ¸äº¤äº’ã€‚ç”¨äºæŠ“å–jsåŠ¨æ€ç”Ÿæˆçš„é¡µé¢ã€‚</p>
<h2 id="ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿæ¨¡å‹">1.2. ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿæ¨¡å‹</h2><p>ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿçš„æ¨¡å‹ä¸»è¦æœ‰å¸ƒå°”æ¨¡å‹ã€å‘é‡æ¨¡å‹å’Œæ¦‚ç‡æ¨¡å‹ã€‚å…¶ä¸­å¸ƒå°”æ¨¡å‹<br>æ˜¯æœ€æ—©çš„IRæ¨¡å‹ï¼Œä¹Ÿæ˜¯åº”ç”¨æœ€å¹¿æ³›çš„æ¨¡å‹ï¼Œç›®å‰ä»ç„¶åº”ç”¨äºå•†ä¸šç³»ç»Ÿä¸­ï¼Œå¸ƒå°”æ¨¡å‹æŸ¥è¯¢ç®€å•ä½†ä¸æ”¯æŒéƒ¨åˆ†åŒ¹é…ï¼Œå¾ˆéš¾æ§åˆ¶è¢«æ£€ç´¢çš„æ–‡æ¡£æ•°é‡ï¼›å‘é‡æ¨¡å‹ï¼ˆVSMï¼šVector Space Modelï¼‰æ˜¯Saltonåœ¨ä¸Šä¸–çºª60å¹´ä»£æå‡ºçš„ï¼ŒæˆåŠŸåº”ç”¨äºSMARTï¼ˆSystem for the Manipulation and Retrieval of Textï¼‰æ–‡æœ¬æ£€ç´¢ç³»ç»Ÿï¼Œå…¶åŸºäºå…³é”®è¯ï¼Œå¹¶æ ¹æ®å…³é”®è¯çš„å‡ºç°é¢‘ç‡è®¡ç®—ç›¸ä¼¼åº¦ï¼Œå‘é‡æ¨¡å‹ä¸­æœ¯è¯­æƒé‡çš„ç®—æ³•æé«˜äº†æ£€ç´¢çš„æ€§èƒ½ï¼Œéƒ¨åˆ†åŒ¹é…çš„ç­–ç•¥ä½¿å¾—æ£€ç´¢çš„ç»“æœæ–‡æ¡£é›†æ›´æ¥è¿‘ç”¨æˆ·çš„æ£€ç´¢éœ€æ±‚ï¼ŒåŒæ—¶å¯ä»¥æ ¹æ®ç»“æœæ–‡æ¡£å¯¹äºæŸ¥è¯¢ä¸²çš„ç›¸å…³åº¦ä½¿ç”¨Cosine Rankingç­‰å…¬å¼å¯¹ç»“æœæ–‡æ¡£è¿›è¡Œæ’åºã€‚<br>åœ¨æœ¬æ¬¡ä½œä¸šä¸­ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿé‡‡ç”¨å‘é‡æ¨¡å‹ï¼Œæ ¹æ®ç›¸ä¼¼åº¦è¿”å›ç»“æœã€‚</p>
<h2 id="ç»“å·´ï¼ˆJiebaï¼‰åˆ†è¯">1.3. ç»“å·´ï¼ˆJiebaï¼‰åˆ†è¯</h2><p>ç»“å·´ï¼ˆjiebaï¼‰æ˜¯ä¸€ä¸ªå¯ä»¥å¯¹ä¸€æ®µä¸­æ–‡è¿›è¡Œåˆ†è¯çš„æ’ä»¶ï¼Œæ”¯æŒç²¾ç¡®æ¨¡å¼ã€å…¨æ¨¡å¼åŠæœç´¢å¼•æ“æ¨¡å¼ä¸‰ç§åˆ†è¯æ¨¡å¼ï¼Œå¯ä»¥é€‚åº”ä¸åŒéœ€æ±‚ã€‚å…¶åŸºæœ¬å®ç°åŸç†æœ‰ï¼šï¼ˆ1ï¼‰åŸºäºTrieæ ‘ç»“æ„å®ç°é«˜æ•ˆçš„è¯å›¾æ‰«æï¼Œç”Ÿæˆå¥å­ä¸­æ±‰å­—æ‰€æœ‰å¯èƒ½æˆè¯æƒ…å†µæ‰€æ„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼›ï¼ˆ2ï¼‰é‡‡ç”¨äº†åŠ¨æ€è§„åˆ’æŸ¥æ‰¾æœ€å¤§æ¦‚ç‡è·¯å¾„, æ‰¾å‡ºåŸºäºè¯é¢‘çš„æœ€å¤§åˆ‡åˆ†ç»„åˆï¼›ï¼ˆ3ï¼‰å¯¹äºæœªç™»å½•è¯ï¼Œé‡‡ç”¨äº†åŸºäºæ±‰å­—æˆè¯èƒ½åŠ›çš„HMMæ¨¡å‹ï¼Œä½¿ç”¨äº†Viterbiç®—æ³•ã€‚</p>
<h2 id="åŸºäºwebpyç•Œé¢è®¾è®¡ç½‘é¡µ">1.4. åŸºäºwebpyç•Œé¢è®¾è®¡ç½‘é¡µ</h2><p>webpy æ˜¯ä¸€ä¸ªè½»é‡çº§Python webæ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿçš„å®Œæˆç®€å•çš„webé¡µé¢ã€‚åœ¨æœ¬æ¬¡å®éªŒä¸­ä½¿ç”¨webpyå»ºç«‹æœç´¢ç½‘é¡µï¼Œweb.py çš„æ¨¡æ¿è¯­è¨€å«åš Templetorï¼Œå®ƒèƒ½è´Ÿè´£å°† python çš„å¼ºå¤§åŠŸèƒ½ä¼ é€’ç»™æ¨¡æ¿ç³»ç»Ÿã€‚æœ¬å®éªŒä¸­ä½¿ç”¨templateä¸htmlç¼–å†™ç½‘é¡µã€‚</p>
<h1 id="ç³»ç»Ÿè®¾è®¡">2. ç³»ç»Ÿè®¾è®¡</h1><p>æœ¬æ¬¡å®éªŒä¸­ä¿¡æ¯æ£€ç´¢ä¸æå–ç³»ç»Ÿçš„æ•´ä½“è®¾è®¡æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸»è¦åŒ…æ‹¬æŠ“å–ä¿¡æ¯ã€åˆ†è¯ã€å»ºç«‹ç´¢å¼•ã€å»ºç«‹å‘é‡æ¨¡å‹ã€è®¡ç®—æ¯”è¾ƒç›¸ä¼¼åº¦ã€è¿”å›ç»“æœè¿™å…­ä¸ªè¿‡ç¨‹ï¼Œæ­¤å¤–ï¼Œæˆ‘ä»¬åŸºäºwebpyå»ºç«‹äº†æœç´¢çš„ç½‘é¡µç•Œé¢ï¼Œä½¿æŸ¥è¯¢è¿‡ç¨‹æ›´åŠ ç®€æ´æ˜äº†ã€‚ä¸‹é¢å…·ä½“ä»‹ç»ç›¸åº”çš„æ¨¡å—ã€‚<br><img src="https://ooo.0o0.ooo/2017/07/09/596238be1b600.png" alt=""> </p>
<p><strong>æŠ“å–ä¿¡æ¯</strong></p>
<p>ä½¿ç”¨pythonç¼–å†™çˆ¬è™«ç¨‹åºæŠ“å–æ–°æµªç½‘ï¼ˆ<a href="http://news.sina.com.cn/ï¼‰" target="_blank" rel="external">http://news.sina.com.cn/ï¼‰</a><br>ä¸Šçš„æ–°é—»ï¼Œä½¿ç”¨urllib2è·å–ç½‘é¡µæºä»£ç ï¼Œä½¿ç”¨beautifulsoupå’Œhtmlparserè§£æç½‘é¡µè·å–ç½‘é¡µä¸­çš„æ–°é—»ï¼ˆæ ‡é¢˜ã€å…³é”®å­—ã€å†…å®¹ã€æ—¥æœŸï¼‰ï¼Œç”¨seleniumè·å–jsåŠ¨æ€ç”Ÿæˆçš„æ•°æ®(è¯„è®ºæ•°)ã€‚è§£æè¿‡çš„ä¸æœªè§£æçš„é“¾æ¥åˆ†å¼€æ ‡è®°ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„æŠ“å–ï¼Œå…±è·å¾—3000å¤šæ¡æ–°é—»ä¿¡æ¯ï¼Œä¿å­˜ä¸ºtxtæ–‡ä»¶ï¼Œå…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/09/596238dc23fb4.png" alt=""><br>æ¯æ¡æ–°é—»åŒ…æ‹¬æ ‡é¢˜ã€å…³é”®å­—ã€æ—¶é—´ã€ç½‘å€ã€è¯„è®ºæ•°ï¼ˆçƒ­åº¦ï¼‰ç­‰ä¿¡æ¯ã€‚</p>
<p><strong>åˆ†è¯</strong><br>å¯¼å…¥jiebaåˆ†è¯æ¨¡å—ï¼Œé¦–å…ˆæŒ‰æ˜¯å¦ä¸ºæ±‰å­—ã€æ•°å­—ã€è‹±æ–‡å­—ç¬¦åŠæ ‡ç‚¹<br>ç¬¦å·å¯¹æ–°é—»å†…å®¹è¿›è¡Œæ¢³ç†ï¼Œå»é™¤æ‰ä¿¡æ¯ç¼ºå¤±çš„æ•°æ®ï¼Œç„¶åç”¨jiebaåˆ†è¯å¯¹titleåŠdescriptionå†…å®¹è¿›è¡Œåˆ†è¯ï¼Œå¾—åˆ°å¦‚ä¸‹txtæ–‡ä»¶ï¼›<br><img src="https://ooo.0o0.ooo/2017/07/09/596239055fe8a.png" alt=""><br><strong>å»ºç«‹ç´¢å¼•</strong><br>å¯¹äºæ‰€æœ‰çš„è¯ï¼ŒæŒ‰ç…§å…¶åœ¨å…¨éƒ¨æ–°é—»ä¸­å‡ºç°çš„æƒ…å†µå»ºç«‹å€’æ’ç´¢å¼•ï¼Œå°†æ¯ä¸ªè¯ä¸ç›¸åº”çš„æ–°é—»åºå·å»ºç«‹è”ç³»ã€‚<br><strong>å»ºç«‹å‘é‡æ¨¡å‹</strong><br>ç»“åˆå»ºç«‹çš„å€’æ’ç´¢å¼•è¡¨ï¼Œè®¡ç®—æ¯ä¸ªæ–°é—»æ¡ç›®çš„å‘é‡ï¼Œå…¶ä¸­æƒé‡é‡‡ç”¨tf-idfç®—æ³•ç”Ÿæˆï¼Œæ„å»ºå‘é‡æ¨¡å‹ã€‚<br><img src="https://ooo.0o0.ooo/2017/07/09/5962392041016.png" alt=""><br><strong>æŸ¥è¯¢è¿”å›ç»“æœ</strong><br>æ ¹æ®åœ¨queryä¸­è¾“å…¥çš„å…³é”®è¯ä¸å‘é‡æ¨¡å‹è¿›è¡Œæ•°é‡ç§¯è®¡ç®—ç›¸ä¼¼åº¦ï¼Œæ ¹æ®ç›¸ä¼¼åº¦çš„å¤§å°å°†æ£€ç´¢åˆ°çš„æ–°é—»æŒ‰åºåˆ—å‡ºã€‚å¦‚ï¼šqueryä¸­è¾“å…¥â€œå—æµ·ï¼Œè²å¾‹å®¾â€ï¼Œå¾—åˆ°çš„æ£€ç´¢ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/09/5962393a9743b.png" alt=""><br><strong>å‰åç«¯å®ç°</strong><br>åŸºäºwebpyç•Œé¢è®¾è®¡æœç´¢ç½‘é¡µï¼Œå»ºç«‹äº¤äº’çš„ç•Œé¢ã€‚åœ¨ä¹‹å‰ç³»ç»Ÿè®¾è®¡çš„åŸº<br>ç¡€ä¸Šï¼Œåœ¨webpyæ¡†æ¶ä¸‹ï¼Œåˆ©ç”¨templatesæ¨¡æ¿è¯­è¨€å°†åå°ç»“æœä¸å‰ç«¯ç•Œé¢è¿›è¡Œäº¤äº’ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨GETå’ŒPOSTå‡½æ•°ä¸å®¢æˆ·ç«¯webäº¤äº’å¹¶ä¼ é€’å‚æ•°ä¼ é€’å‚æ•°ï¼Œå°†æœç´¢æ–°é—»åœ¨ç½‘é¡µä¸Šå‘ˆç°å‡ºæ¥ã€‚å…¶ä¸»è¦æ­¥éª¤ä¸ºï¼šï¼ˆ1ï¼‰å®¢æˆ·ç«¯å‘é€getè¯·æ±‚ï¼Œè§¦å‘æœåŠ¡ç«¯get()å‡½æ•°ï¼Œè°ƒç”¨index.htmlç½‘é¡µï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ï¼ˆ2ï¼‰å®¢æˆ·ç«¯å‘é€æœç´¢å…³é”®å­—å¹¶é€šè¿‡postæ–¹å¼ç»™æœåŠ¡ç«¯ï¼Œè§¦å‘æœåŠ¡ç«¯post()å‡½æ•°ï¼Œpost()å‡½æ•°å°†æ”¶åˆ°çš„å…³é”®å­—ä¼ å…¥ä¹‹å‰è®¾è®¡çš„æœç´¢ç³»ç»Ÿä¸­ï¼Œå¾—åˆ°è¿”å›å€¼æ–°é—»æ¡ç›®ã€‚ï¼ˆ3ï¼‰é€šè¿‡webpyä¼ é€’ç»™result.htmlï¼Œå¾—åˆ°htmlç½‘é¡µåå‘ç»™å®¢æˆ·ç«¯ã€‚<br><img src="https://ooo.0o0.ooo/2017/07/09/5962395e27566.png" alt=""> </p>
<h1 id="æœ€ç»ˆæ•ˆæœ">3. æœ€ç»ˆæ•ˆæœ</h1><p>æ ¡å†…ç½‘ç½‘å€ï¼š<a href="http://10.108.112.154:8080/" target="_blank" rel="external">http://10.108.112.154:8080/</a><br>ä¾‹å¦‚æƒ³è¦æŸ¥è¯¢ä¸â€œä¹ è¿‘å¹³â€â€œå—æµ·â€ç›¸å…³çš„æ–°é—»ï¼ŒæŒ‰ä¸‹å›¾è¾“å…¥ï¼Œå…³é”®è¯ä¹‹é—´è¦æœ‰ç©ºæ ¼ã€‚<br><img src="https://ooo.0o0.ooo/2017/07/09/5962397f56a5b.png" alt=""><br>ç‚¹å‡»searchä¹‹åçš„ç½‘é¡µç•Œé¢å¦‚ä¸‹ï¼Œå°†æˆ‘ä»¬ä¹‹å‰æŠ“å–çš„ä¸â€œä¹ è¿‘å¹³â€åŠâ€œå—æµ·â€æœ‰å…³çš„æ–°é—»é“¾æ¥æŒ‰ç…§ç›¸ä¼¼åº¦å¤§å°æ’åˆ—ï¼ŒåŒæ—¶åˆ—å‡ºç›¸åº”çš„æ—¶é—´ã€å†…å®¹åŠçƒ­åº¦ã€‚<br><img src="https://ooo.0o0.ooo/2017/07/09/59623992a4464.png" alt=""><br>å¦‚æœè¾“å…¥çš„å…³é”®è¯å¹¶ä¸åœ¨ä¹‹å‰å»ºç«‹çš„ç´¢å¼•ä¸­ï¼Œåˆ™ä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/09/596239a2c7fc9.png" alt=""> </p>
<h1 id="é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ³•">4. é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ³•</h1><p>â€¢   å¯¹Pythonè¯­è¨€ä¸ç†Ÿæ‚‰ã€ç”šè‡³0åŸºç¡€ï¼š<br>é˜…è¯»ç›¸å…³ä¹¦ç±ï¼ŒæŒæ¡forå¾ªç¯ï¼Œtry\exceptå¼‚å¸¸å¤„ç†ï¼Œlist  dict ç­‰åŸºæœ¬æ•°æ®ç»“æ„çš„æ“ä½œåŠè¯­æ³•ï¼Œæ–‡ä»¶è¯»å†™æ“ä½œï¼Œæ•°å­¦è¿ç®—ç­‰ï¼Œå¿«é€Ÿä¸Šæ‰‹ã€‚<br>â€¢   Pythonç¨‹åºè¿è¡Œæ‰“å°ä¹‹åä¸è¾“å‡ºï¼š<br>import sys<br>reload(sys)<br>sys.setdefaultencoding(â€˜utf-8â€™)<br>â€¢   è·å–ç½‘é¡µé€Ÿåº¦æ…¢ï¼š<br>if response.info().get(â€˜Content-Encodingâ€™) == â€˜gzipâ€™:<br>    buf = StringIO(response.read())<br>    f = gzip.GzipFile(fileobj=buf)<br>ä¸‹è½½å‹ç¼©çš„ç½‘é¡µï¼Œé€Ÿåº¦æ›´å¿«<br>â€¢   è·å–ç½‘é¡µå¼‚å¸¸æ—¶ï¼Œç¨‹åºä¸­æ–­ï¼Œå¯¼è‡´ä¸èƒ½æºæºä¸æ–­åœ°çˆ¬å–åˆ°éœ€è¦çš„ç½‘é¡µï¼š<br>åˆ©ç”¨try/exceptå¤„ç†å¼‚å¸¸ã€‚<br>try:<br>    â€¦<br>except urllib2.HTTPError as e:  # å¤„ç†HTTPå¼‚å¸¸<br>    â€¦<br>except urllib2.URLError as e:#å¤„ç†URLå¼‚å¸¸<br>   â€¦<br>except:#å¤„ç†å…¨éƒ¨ç±»å‹å¼‚å¸¸ï¼Œä½¿ç¨‹åºä¸ä¸­æ–­<br>â€¢   beautifulsoupè§£æç½‘é¡µå†…å®¹ä¸å…¨ï¼Œæ— æ³•è·å–æ–°é—»ç½‘é¡µä¸­å…³äºè¯„è®ºæ•°ç›®çš„ä¿¡æ¯ï¼š<br>æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°è¯„è®ºæ•°æ˜¯jsåŠ¨æ€ç”Ÿæˆçš„ï¼Œbeautifulsoupä¸èƒ½ç”¨äºè·å–åŠ¨æ€ç”Ÿæˆçš„æ•°æ®ï¼Œç»æŸ¥é˜…ç½‘ä¸Šèµ„æ–™ï¼Œè¿”ç°seleniumåŒ…å¯ä»¥ç”¨äºè§£æç½‘é¡µä¸­jsåŠ¨æ€ç”Ÿæˆçš„æ•°æ®ï¼Œæˆ‘ä»¬é¦–å…ˆè·å–æ–°é—»idï¼Œè®¿é—®æ–°æµªæ–°é—»è¯„è®ºé“¾æ¥ï¼Œæ‰¾åˆ°å…¶ä¸­è¯„è®ºæ•°æ®ã€‚<br>commenturl = â€˜<a href="http://comment5.news.sina.com.cn/comment/skin/default.html?channel=gn&amp;newsid=comos-" target="_blank" rel="external">http://comment5.news.sina.com.cn/comment/skin/default.html?channel=gn&amp;newsid=comos-</a>â€˜ + newsid<br>driver = webdriver.PhantomJS()<br>driver.set_page_load_timeout(30)#è®¾ç½®å»¶æ—¶<br>driver.get(commenturl)#è·å–ç½‘é¡µ<br>comment = driver.find_element_by_class_name(â€˜f_redâ€™).text#è·å–å…ƒç´ <br>â€¢   seleniumè¿è¡ŒæŠ¥é”™ï¼š<br>éœ€è¦æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå°†PhantomJSæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹æ·»åŠ åˆ°$PATHæ–‡ä»¶ä¸‹ï¼šsudo vi /etc/paths<br>â€¢   æœç´¢æ—¶å»ºç«‹ç´¢å¼•è¿‡ç¨‹è€—è´¹æ—¶é—´<br>é¢„å…ˆå»ºç«‹å¥½ç´¢å¼•ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæœç´¢æ—¶ç›´æ¥åˆ©ç”¨å·²ç»å»ºç«‹å¥½çš„ç´¢å¼•è¿›è¡Œæœç´¢ã€‚<br>â€¢   ä¸ºæ¯æ¡æ–°é—»æ•°æ®ã€queryå»ºç«‹å‘é‡å¹¶å­˜å‚¨é€Ÿåº¦æ…¢ã€ç”±äºå­—å…¸é›†åˆå¾ˆå¤§ï¼Œå¯¼è‡´å‘é‡ç¨€ç–ã€è€—è´¹èµ„æºï¼Œå¦å¤–è¿›è¡Œå‘é‡ä¹˜æ³•è¿ç®—è®¡ç®—ç›¸ä¼¼åº¦æ—¶äº§ç”Ÿä¸å¿…è¦çš„æµªè´¹ï¼š<br>ä»…ä¸ºæ¯æ¡æ–°é—»æ•°æ®å»ºç«‹å­—å…¸ï¼Œå­˜å‚¨åŒ…å«çš„è¯å’Œtf-idfæƒé‡å€¼ï¼Œè®¡ç®—queryå’Œæ¯ä¸€ä¸ªæ–°é—»æ¡ç›®çš„ç›¸ä¼¼åº¦æ—¶ï¼Œåªéœ€è¦å¯¹queryä¸­åŒ…å«çš„å…³é”®è¯åœ¨æ–°é—»æ¡ç›®ä¸­çš„æƒå€¼è¿›è¡Œè¿ç®—å³å¯ï¼ˆå› ä¸ºå…¶å®ƒä½éƒ½æ˜¯0ï¼‰ï¼Œç®€åŒ–è¿ç®—ã€‚<br>â€¢   æ–°é—»æ¡ç›®æ•°é‡åºå¤§ï¼Œqueryä¸æ–°é—»çš„åŒ¹é…è®¡ç®—é‡å¤§ã€æ•ˆç‡ä½ï¼š<br>ç»™å®šqueryæ—¶ï¼Œæˆ‘ä»¬å…ˆè®¿é—®queryä¸­å…³é”®è¯åœ¨ç´¢å¼•ä¸­çš„å€’æ’åˆ—è¡¨ï¼Œåªå¯¹å…¶ä¸­çš„æ–°é—»ä¸queryè¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ã€æ’åºã€è¿”å›æœ€ç»ˆç»“æœï¼Œæå¤§ç¨‹åº¦ä¸Šè¿‡æ»¤æ‰ä¸queryä¸ç›¸å…³çš„æ–°é—»æ¡ç›®ã€‚<br>â€¢   å­—å…¸åˆ›å»ºæ— åºï¼Œä¸èƒ½æŒ‰åˆ›å»ºé¡ºåºè¾“å‡ºç»“æœï¼š<br>åˆ©ç”¨OrderedDictæœ‰åºå­—å…¸ï¼Œèƒ½å¤Ÿè®°å½•ä¸‹å­—å…¸çš„åˆ›å»ºé¡ºåºï¼Œæœ‰åºè¾“å‡ºç»“æœdict= collections.OrderedDict()<br>â€¢   æœç´¢ç»“æœä¼˜åŒ–ï¼šæœç´¢è¿”å›çš„ç»“æœé¢˜ç›®ä¸­ä¸åŒ…å«å…³é”®è¯ï¼š<br>å¯¹åœ¨æ–°é—»é¢˜ç›®ä¸­å‡ºç°çš„å…³é”®è¯å¢åŠ æƒé‡ï¼Œä½¿å¾—é¢˜ç›®ä¸å…³é”®è¯åŒ¹é…åº¦è¶Šé«˜çš„æ–°é—»æ’åè¶Šé å‰ï¼Œç¬¦åˆçœŸå®éœ€æ±‚ã€‚<br>â€¢   webpyä¸èƒ½ç›´æ¥è°ƒç”¨Pythonä¸­çš„å‡½æ•°ï¼š<br>åœ¨webpyæ¨¡æ¿é¦–è¡Œå®šä¹‰ä¸€ä¸ªå˜é‡$def with (posts) åœ¨Pythonä¸­è®¡ç®—ååˆ©ç”¨å°†å‚æ•°ä¼ å…¥ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚<br>â€¢   webpyä½¿ç”¨templateæ—¶ï¼Œè·¯å¾„è®¾ç½®ï¼š<br>render = web.template.render(â€˜templates/â€˜)<br>æ‰“å¼€renderä¸‹çš„index.htmlï¼š<br>render.index() </p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è½¬åŒ–ç‡é¢„ä¼°ä¹‹è´å¶æ–¯å¹³æ»‘]]></title>
      <url>/2017/07/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-%E8%BD%AC%E5%8C%96%E7%8E%87%E9%A2%84%E4%BC%B0%E4%B9%8B%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%B9%B3%E6%BB%91/</url>
      <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°">1. é—®é¢˜æè¿°</h1><p>åœ¨åšæ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†æœ‰è½¬åŒ–ç‡è¿™ä¸ªæŒ‡æ ‡åœ¨å¤§é‡æ•°æ®ä¸‹æ˜¯æœ‰æ•ˆçš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä¾‹å¦‚æŸä¸ªå¹¿å‘Šç‚¹å‡»é‡æ˜¯10000æ¬¡ï¼Œè½¬åŒ–é‡æ˜¯100æ¬¡ï¼Œé‚£è½¬åŒ–ç‡å°±æ˜¯1%ã€‚ä½†æœ‰æ—¶ï¼Œä¾‹å¦‚æŸä¸ªå¹¿å‘Šç‚¹å‡»é‡æ˜¯2æ¬¡ï¼Œè½¬åŒ–é‡æ˜¯1æ¬¡ï¼Œè¿™æ ·ç®—æ¥è½¬åŒ–ç‡ä¸º50%ã€‚ä½†æ­¤æ—¶è¿™ä¸ªæŒ‡æ ‡åœ¨æ•°å­¦ä¸Šæ˜¯æ— æ•ˆçš„ã€‚å› ä¸ºå¤§æ•°å®šå¾‹å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨è¯•éªŒä¸å˜çš„æ¡ä»¶ä¸‹ï¼Œé‡å¤è¯•éªŒå¤šæ¬¡ï¼Œéšæœºäº‹ä»¶çš„é¢‘ç‡è¿‘ä¼¼äºå®ƒçš„æ¦‚ç‡ã€‚åè€…ç‚¹å‡»é‡åªæœ‰2æ¬¡ï¼Œä¸æ»¡è¶³â€œé‡å¤è¯•éªŒå¤šæ¬¡â€çš„æ¡ä»¶ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<p><strong>æ•´ä½“æ€è·¯</strong>ï¼šç”¨ä¼°è®¡å€¼æ¥æ¨¡æ‹Ÿå®é™…CVRã€‚</p>
<h1 id="è§£å†³æ–¹æ¡ˆ">2. è§£å†³æ–¹æ¡ˆ</h1><p>å®é™…ä¸Šï¼Œå¹¿å‘Šå¦†åŒ–ç‡æ˜¯éšç€æ—¶é—´è¿ç§»å’Œç”¨æˆ·å–œå¥½å˜åŒ–è€Œå˜åŒ–çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…ˆéªŒçŸ¥è¯†æ¥æŒç»­æ€§åœ°è°ƒæ•´CVRã€‚<a href="https://zhuanlan.zhihu.com/p/21724759" target="_blank" rel="external">è®¡ç®—å¹¿å‘Šè®­ç»ƒä¸å¹³æ»‘æ€æƒ³</a>ç»™å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼šè´å¶æ–¯å¹³æ»‘ã€‚</p>
<p>è€ƒè™‘åˆ°æ—¶åºåºåˆ—æ¨¡å‹ï¼Œæˆ‘ä»¬æŠŠä»ç¬¬ä¸€å¤©åˆ°ç¬¬nå¤©çš„æ‰€æœ‰å…ˆéªŒçŸ¥è¯†æ±‡æ€»åˆ°ç¬¬nå¤©çš„ç»“æœï¼Œå¹¶ä»¥æ­¤æ¥å¯¹ç¬¬n+1å¤©çš„CTRè¿›è¡Œå¹³æ»‘ã€‚åœ¨å¹¿å‘Šå¹³æ»‘ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆæ–¹æ³•æ¯”è´å¶æ–¯å¹³æ»‘èƒ½å¤Ÿæ›´å¥½çš„åˆ©ç”¨å…ˆéªŒçŸ¥è¯†äº†ï¼Œè€Œå¸®åŠ©è´å¶æ–¯å¹³æ»‘æ–¹æ³•å®ç°ç›®æ ‡çš„å°±æ˜¯Betaåˆ†å¸ƒã€‚Betaåˆ†å¸ƒçš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œé€šè¿‡æ”¹å˜å…¶ä¸­çš„ä¸¤ä¸ªå‚æ•°Î±å’ŒÎ²ï¼Œä½ å¯ä»¥è®©Betaåˆ†å¸ƒçš„å›¾å½¢å˜æˆä»»æ„å½¢çŠ¶ï¼Œè€Œä¸”åœ¨åŠ å…¥å…ˆéªŒçŸ¥è¯†å‰åï¼Œé€šè¿‡è´å¶æ–¯å˜æ¢ï¼Œå¯¹CTRçš„é¢„ä¼°éƒ½å¯ä»¥è¡¨ç¤ºä¸ºBetaåˆ†å¸ƒã€‚</p>
<p>Betaåˆ†å¸ƒä¸­å‚æ•°Î±å’ŒÎ²çš„æœ¬è´¨å«ä¹‰ï¼Œå³ï¼šÎ±è¡¨ç¤ºç‚¹å‡»æ•°ï¼ŒÎ²è¡¨ç¤ºæ›å…‰æ•°ã€‚å› ä¸ºè´å¶æ–¯å¹³æ»‘çš„å…·ä½“å…¬å¼å°±æ˜¯ï¼š</p>
<p>$$SmoothCTR = \frac{(Î± + CurrentC - 1)}{( Î± + Î² + CurrentI -2)}$$</p>
<p>èƒ½ä¸èƒ½ç›´æ¥æŠŠå†å²ç‚¹å‡»å’Œå†å²æ›å…‰åˆ†åˆ«èµ‹å€¼ç»™Î±å’ŒÎ²æ¥è¿›è¡Œè®¡ç®—å‘¢ï¼Ÿæ˜¾ç„¶ä¸è¡Œï¼Œå› ä¸ºè¿™ä¹ˆåšå°±ä¼šçŠ¯ä¹‹å‰æˆ‘ä»¬æåˆ°çš„é‚£äº›é—®é¢˜ï¼Œæ¯”å¦‚ä¸åŒæ—¥æœŸçš„æ›å…‰ã€ç‚¹å‡»æƒé‡åº”è¯¥ä¸ä¸€æ ·ã€‚æ‰€ä»¥åŸºç¡€çš„è´å¶æ–¯å¹³æ»‘æ˜¯ä¸èƒ½è§£å†³æˆ‘ä»¬åˆšæ‰æåˆ°çš„é—®é¢˜çš„ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥ç ”ç©¶Betaåˆ†å¸ƒçš„ç‰¹æ€§ï¼Œç”¨ä¸€ç§æ–°çš„æ–¹æ³•é€šè¿‡å…ˆéªŒçŸ¥è¯†æ±‚è§£Î±å’ŒÎ²ï¼Œä»è€Œè®¡ç®—SmoothCTRã€‚</p>
<p>Betaåˆ†å¸ƒé™¤äº†ä¸¤ä¸ªæ˜¾æ€§çš„é‡è¦å‚æ•°Î±å’ŒÎ²å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªç›¸å¯¹éšå½¢ä½†åŒæ ·é‡è¦çš„å‚æ•°ï¼Œå¹³å‡å€¼å’Œä¸­ä½æ•°ï¼Œé€šè¿‡å¹³å‡å€¼å’Œä¼—æ•°å¯ä»¥å”¯ä¸€ç¡®å®šÎ±å’ŒÎ²çš„å€¼ï¼Œå®ƒä»¬çš„æ•°å­¦å…³ç³»å¦‚ä¸‹ï¼š</p>
<p>$$å‡å€¼=\frac{\alpha}{\alpha+\beta}$$<br>$$ä¼—æ•°=\frac{\alpha-1}{\alpha+\beta-2}$$</p>
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ç¡®å®šäº†å¹³å‡å€¼å’Œä¸­ä½æ•°ï¼Œé‚£ä¹ˆÎ±å’ŒÎ²çš„å€¼ä¹Ÿå°±ç¡®å®šäº†ï¼ˆæ ¹æ®å‡å€¼å’Œä¸­ä½æ•°æ±‚è§£Î±å’ŒÎ²çš„è¿‡ç¨‹è¯·è¯»è€…è‡ªè¡Œæ¨å¯¼ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥è¯•ç€ä»å¹³å‡å€¼å’Œä¸­ä½æ•°å…¥æ‰‹åˆ†æã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹betaåˆ†å¸ƒçš„å¯†åº¦å‡½æ•°ï¼š<br><img src="https://ooo.0o0.ooo/2017/07/09/596235ef428c7.png" alt=""> </p>
<p>2017.7.9 å¥½å›°ï¼Œå…ˆå›å»ä¼‘æ¯ã€‚æ˜æ—¥ç»§ç»­ã€‚</p>
<h1 id="ä»£ç ">3. ä»£ç </h1><pre><code>&apos;&apos;&apos;Python
#!/usr/bin/python
# coding=utf-8

import numpy
import random
import scipy.special as special
import pandas as pd
import time
import math
from math import log

class HyperParam(object):
    def __init__(self, alpha, beta):
        self.alpha = alpha
        self.beta = beta
    def sample_from_beta(self, alpha, beta, num, imp_upperbound):
        sample = numpy.random.beta(alpha, beta, num)
        I = []
        C = []
        for click_ratio in sample:
            imp = random.random() * imp_upperbound
            #imp = imp_upperbound
            click = imp * click_ratio
            I.append(imp)
            C.append(click)
        return I, C
    def update_from_data_by_FPI(self, tries, success, iter_num, epsilon):
        &apos;&apos;&apos;estimate alpha, beta using fixed point iteration&apos;&apos;&apos;
        for i in range(iter_num):
            new_alpha, new_beta = self.__fixed_point_iteration(tries, success, self.alpha, self.beta)
            if abs(new_alpha-self.alpha)&lt;epsilon and abs(new_beta-self.beta)&lt;epsilon:
                break
            self.alpha = new_alpha
            self.beta = new_beta
    def __fixed_point_iteration(self, tries, success, alpha, beta):
        &apos;&apos;&apos;fixed point iteration&apos;&apos;&apos;
        sumfenzialpha = 0.0
        sumfenzibeta = 0.0
        sumfenmu = 0.0
        sumfenzialpha = special.digamma(success+alpha) - special.digamma(alpha)
        print sumfenzialpha
        # for i in range(len(tries)):
        #     sumfenzialpha += (special.digamma(success[i]+alpha) - special.digamma(alpha))
        #     sumfenzibeta += (special.digamma(tries[i]-success[i]+beta) - special.digamma(beta))
        #     sumfenmu += (special.digamma(tries[i]+alpha+beta) - special.digamma(alpha+beta))
        return alpha*(sumfenzialpha/sumfenmu), beta*(sumfenzibeta/sumfenmu)
    def update_from_data_by_moment(self, tries, success):
        &apos;&apos;&apos;estimate alpha, beta using moment estimation&apos;&apos;&apos;
        mean, var = self.__compute_moment(tries, success)
        #print &apos;mean and variance: &apos;, mean, var
        #self.alpha = mean*(mean*(1-mean)/(var+0.000001)-1)
        self.alpha = (mean+0.000001) * ((mean+0.000001) * (1.000001 - mean) / (var+0.000001) - 1)
        #self.beta = (1-mean)*(mean*(1-mean)/(var+0.000001)-1)
        self.beta = (1.000001 - mean) * ((mean+0.000001) * (1.000001 - mean) / (var+0.000001) - 1)
    def __compute_moment(self, tries, success):
        &apos;&apos;&apos;moment estimation&apos;&apos;&apos;
        ctr_list = []
        # var = 0.0
        mean = (success / tries).mean()
        if len(tries) == 1:
            var = 0
        else:
            var = (success / tries).var()
        # for i in range(len(tries)):
        #     ctr_list.append(float(success[i])/tries[i])
        # mean = sum(ctr_list)/len(ctr_list)
        # for ctr in ctr_list:
        #     var += pow(ctr-mean, 2)
        return mean, var

def test():
    #è®¾å®šåˆå§‹å€¼
    hyper = HyperParam(1, 1)
    #--------sample training data--------
    # I, C = hyper.sample_from_beta(10, 1000, 10000, 1000)
    # print I, C
    train_data = pd.read_csv(&apos;data.csv&apos;,nrows=10000)
    print &apos;read finish&apos;
    # ç»Ÿè®¡ç‚¹å‡»æ¬¡æ•°å’Œè½¬åŒ–æ¬¡æ•°
    key = [&apos;creativeID&apos;]
    train_data[&apos;count&apos;] = 1
    train_data = train_data.groupby(key).agg(&apos;sum&apos;).reset_index()
    # æ­¤æ—¶ï¼Œtrain_data[&apos;count&apos;]æ˜¯ç‚¹å‡»æ¬¡æ•°
    # train_data[&apos;label&apos;]æ˜¯ç‚¹å‡»æ¬¡æ•°
    print &apos;cal finish&apos;
    I = train_data[&apos;count&apos;]
    C = train_data[&apos;label&apos;]
    print key
    start = time.clock()
    #--------estimate parameter using fixed-point iteration--------
    # è®¡ç®—å¹³æ»‘
    hyper.update_from_data_by_FPI(I, C, 1000, 0.00000001)
    end = time.clock()
    print hyper.alpha, hyper.beta
    print &apos;run time: &apos;,end - start

    start1 = time.clock()
    #--------estimate parameter using moment estimation--------
    hyper.update_from_data_by_moment(I, C)
    end1 = time.clock()
    print hyper.alpha, hyper.beta
    print &apos;EM run time: &apos;, end1 - start1

if __name__ == &apos;__main__&apos;:
    test()
&apos;&apos;&apos;
</code></pre><h1 id="å‚è€ƒæ–‡çŒ®">4. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/21724759" target="_blank" rel="external">è®¡ç®—å¹¿å‘Šè®­ç»ƒä¸å¹³æ»‘æ€æƒ³</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> è…¾è®¯ç®—æ³•å¤§èµ›-CVRé¢„ä¼° </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CVR,è´å¶æ–¯å¹³æ»‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[word embedding]]></title>
      <url>/2017/06/21/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-CVR-word-embedding/</url>
      <content type="html"><![CDATA[<p>åœ¨åšæ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ›¾ç”¨è¿‡word embeddingç”Ÿæˆappç‰¹å¾ï¼Œå¯¹ç»“æœæå‡äº†æœ‰å‡ ä¸ªä¸‡åˆ†ç‚¹ã€‚</p>
<p>è®ºæ–‡ï¼štem2vec: Neural Item Embedding for Collaborative Filtering</p>
<h1 id="æ€æƒ³">1. æ€æƒ³</h1><p>è¿™ç¯‡æ–‡ç« æ¯”è¾ƒæœ´ç´ ï¼Œåˆ›æ–°æ€§ä¸é«˜ï¼ŒåŸºæœ¬æ˜¯å‚ç…§äº†googleçš„word2vecæ–¹æ³•ï¼Œåº”ç”¨åˆ°æ¨èåœºæ™¯çš„i2iç›¸ä¼¼åº¦è®¡ç®—ä¸­ï¼Œä½†å®é™…æ•ˆæœçœ‹è¿˜æœ‰æœ‰æå‡çš„ã€‚ä¸»è¦åšæ³•æ˜¯æŠŠitemè§†ä¸ºwordï¼Œç”¨æˆ·çš„è¡Œä¸ºåºåˆ—è§†ä¸ºä¸€ä¸ªé›†åˆï¼Œitemé—´çš„å…±ç°ä¸ºæ­£æ ·æœ¬ï¼Œå¹¶æŒ‰ç…§itemçš„é¢‘ç‡åˆ†å¸ƒè¿›è¡Œè´Ÿæ ·æœ¬é‡‡æ ·ï¼Œç¼ºç‚¹æ˜¯ç›¸ä¼¼åº¦çš„è®¡ç®—è¿˜åªæ˜¯åˆ©ç”¨åˆ°äº†itemå…±ç°ä¿¡æ¯ï¼Œ1).å¿½ç•¥äº†userè¡Œä¸ºåºåˆ—ä¿¡æ¯; 2).æ²¡æœ‰å»ºæ¨¡ç”¨æˆ·å¯¹ä¸åŒitemçš„å–œæ¬¢ç¨‹åº¦é«˜ä½ã€‚</p>
<h1 id="å®ç°">2. å®ç°</h1><p>ä¸»è¦ä»£ç æ¥è‡ªäºå†™è®ºæ–‡çš„ä½œè€…åˆ†äº«çš„<a href="https://github.com/Bereket123/Recommendation-based-on-sequence-" target="_blank" rel="external">ä»£ç </a></p>
<h1 id="å‚è€ƒæ–‡çŒ®">3. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/24339183" target="_blank" rel="external">DNNè®ºæ–‡åˆ†äº« - Item2vec: Neural Item Embedding for Collaborative Filtering</a></li>
<li><a href="https://view.inews.qq.com/a/20170428A07XNU00" target="_blank" rel="external">è¾¾è§‚æ•°æ®æ¨èç®—æ³•å®ç°ï¼šååŒè¿‡æ»¤ä¹‹item embedding</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> è…¾è®¯ç®—æ³•å¤§èµ›-CVRé¢„ä¼° </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ¨è </tag>
            
            <tag> è…¾è®¯ç®—æ³•å¤§èµ› </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸å¹³è¡¡ç±»çš„å¤„ç†]]></title>
      <url>/2017/06/10/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-CVR-%E4%B8%8D%E5%B9%B3%E8%A1%A1%E7%B1%BB%E7%9A%84%E5%A4%84%E7%90%86/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšæ¯”èµ›ï¼Œå‘ç°åœ¨å·¥ä¸šä¸Šï¼Œå¾ˆå¤šåˆ†ç±»é—®é¢˜çš„æ ‡ç­¾åˆ†å¸ƒéƒ½æ˜¯ä¸å¹³è¡¡çš„ã€‚å¦‚å‚è€ƒæ–‡çŒ®<a href="http://bourneli.github.io/machine-learning/prml/2016/12/19/compensating-for-class-priors.html" target="_blank" rel="external">æ ‡ç­¾å€¾æ–œä¿®æ­£æ–¹æ³•è®°è¦</a>æ‰€å±ï¼Œæ¯”å¦‚ç”¨åˆ†ç±»å™¨å»åˆ¤æ–­xå…‰ç‰‡ä¸­çš„ç™Œç—‡ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œç”±äºç™Œç—‡çš„æ¯”ä¾‹æ˜¯éå¸¸å°çš„ï¼Œæ¯”å¦‚0.001ã€‚é‚£ä¹ˆï¼Œå°†è¿™äº›æ ·æœ¬æ”¾åˆ°å¤§å¤šæ•°åˆ†ç±»æ¨¡å‹ä¸­è®­ç»ƒï¼Œæ¨¡å‹çš„è¡¨ç°ä¼šéå¸¸ç›¸ä¼¼ï¼Œå°†æ‰€æœ‰æ•°æ®éƒ½é¢„æµ‹ä¸ºæ²¡æœ‰ç™Œç—‡ï¼Œå› ä¸ºè¿™æ ·ä¹Ÿå¯ä»¥å¾—åˆ°99.999%çš„å‡†ç¡®ç‡ã€‚</p>
<h1 id="å¸¸è§çš„è§£å†³åŠæ³•">1. å¸¸è§çš„è§£å†³åŠæ³•</h1><p>å‚è€ƒæ–‡çŒ®<a href="https://www.jiqizhixin.com/articles/1dd8da6e-ae24-4fc5-ab90-ee39020bc5ff" target="_blank" rel="external">è§£å†³çœŸå®ä¸–ç•Œé—®é¢˜ï¼šå¦‚ä½•åœ¨ä¸å¹³è¡¡ç±»ä¸Šä½¿ç”¨æœºå™¨å­¦ä¹ ï¼Ÿ</a>è¯´ï¼Œä»ä¸å¹³è¡¡æ•°æ®ä¸­å­¦ä¹ ï¼Œæ˜¯ä¸€é¡¹å·²è¢«ç ”ç©¶äº† 20 å¹´ä¹‹ä¹…çš„é—®é¢˜ã€‚å®ƒæ›¾æ˜¯è®¸å¤šè®ºæ–‡ã€ç ”è®¨ä¼šã€ç‰¹åˆ«è®®ç¨‹çš„ä¸»é¢˜ï¼ˆä¸€é¡¹æœ€è¿‘çš„è°ƒæŸ¥å°±æœ‰å¤§çº¦ 220 ä¸ªå¼•ç”¨ï¼‰ã€‚äººä»¬å°è¯•äº†è®¸å¤šæ–¹æ³•ï¼Œä½†ç»“æœå„ä¸ç›¸åŒï¼Œæ‰€ä»¥è‡³ä»Šæ²¡æœ‰å¾—åˆ°æ˜æ™°çš„ç­”æ¡ˆã€‚å½“æ•°æ®ç§‘å­¦å®¶ä»¬ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä»–ä»¬å¾€å¾€ä¼šé—®ï¼šã€Œå¦‚æœæˆ‘çš„æ•°æ®æ˜¯ä¸å¹³è¡¡çš„ï¼Œæˆ‘è¯¥æ€ä¹ˆåšï¼Ÿã€è€Œè¿™ä¸€é—®é¢˜æ˜¯æ²¡æœ‰å›ºå®šç­”æ¡ˆçš„ï¼Œå°±åƒä½ é—®ã€Œå“ªä¸ªå­¦ä¹ ç®—æ³•æ˜¯æœ€å¥½çš„ã€ä¸€æ ·ï¼š<strong>ç­”æ¡ˆå–å†³äºæ•°æ®ã€‚</strong></p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸‹é¢å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li><p>ä»€ä¹ˆä¹Ÿä¸åš</p>
</li>
<li><p>é€šè¿‡æŸäº›æ–¹æ³•ä½¿å¾—æ•°æ®æ›´åŠ å¹³è¡¡ï¼š</p>
</li>
<li><ul>
<li>å¯¹å°‘æ•°ç±»è¿›è¡Œè¿‡é‡‡æ ·</li>
</ul>
</li>
<li><ul>
<li>å¯¹å¤šæ•°ç±»è¿›è¡Œæ¬ é‡‡æ ·</li>
</ul>
</li>
<li><ul>
<li>åˆæˆæ–°çš„å°‘æ•°ç±»</li>
</ul>
</li>
<li><ul>
<li>èˆå¼ƒæ‰€æœ‰å°‘æ•°ç±»ï¼Œåˆ‡æ¢æˆä¸€ä¸ªå¼‚å¸¸æ£€æµ‹æ¡†æ¶ã€‚</li>
</ul>
</li>
<li><p>åœ¨ç®—æ³•å±‚é¢ä¹‹ä¸Šï¼ˆæˆ–ä¹‹åï¼‰ï¼š</p>
</li>
<li><ul>
<li>è°ƒæ•´ç±»çš„æƒé‡ï¼ˆé”™è¯¯åˆ†ç±»æˆæœ¬ï¼‰</li>
</ul>
</li>
<li><ul>
<li>è°ƒæ•´å†³ç­–é˜ˆå€¼</li>
</ul>
</li>
<li><ul>
<li>ä½¿å·²æœ‰çš„ç®—æ³•å¯¹å°‘æ•°ç±»æ›´åŠ æ•æ„Ÿ</li>
</ul>
</li>
<li><ul>
<li>æ„é€ ä¸€ä¸ªåœ¨ä¸å¹³è¡¡æ•°æ®ä¸Šè¡¨ç°æ›´å¥½çš„å…¨æ–°ç®—æ³•ã€‚</li>
</ul>
</li>
</ul>
<h1 id="ä¸€ç§æ ‡ç­¾å€¾æ–œä¿®æ­£æ–¹æ³•">2. ä¸€ç§æ ‡ç­¾å€¾æ–œä¿®æ­£æ–¹æ³•</h1><p>å‚è€ƒæ–‡çŒ®<a href="">Practical Lessons from Predicting Clicks on Ads at<br>Facebook</a>6.3æŒ‡å‡ºï¼Œæ¬ é‡‡æ ·å¯ä»¥åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼Œæå‡æ¨¡å‹è¡¨ç°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°±ç®—æ•°æ®è¢«æ¬ é‡‡æ ·ï¼Œå…¶å®ä¹Ÿå¯ä»¥é€šè¿‡åœ¨æ¬ é‡‡æ ·ç©ºé—´ä¸­å¯¹é¢„æµ‹ç»“æœè¿›è¡Œä¿®æ­£ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡‡æ ·ä¹‹å‰CTRåªæœ‰0.1%ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹è´Ÿæ ·æœ¬æ¬ é‡‡æ ·0.01ï¼Œé‚£ä¹ˆCTRå°±ä¼šå˜ä¸º10%ã€‚ä¸ºäº†ä¿®æ­£ç»“æœï¼Œä½¿å¾—CTRæ¢å¤åˆ°0.1%,æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¬å¼ï¼š<br>$$q=\frac{p}{p+(1-p)/w}$$<br>å…¶ä¸­ï¼Œ$p$æ˜¯æ¬ é‡‡æ ·ç©ºé—´ä¸‹é¢„æµ‹çš„æ¦‚ç‡ï¼Œ<br>$w$æ˜¯å¯¹è´Ÿæ ·æœ¬çš„é‡‡æ ·ç‡ã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘å†³å®šå…ˆå¤ä¹ ä¸€ä¸‹å…ˆéªŒæ¦‚ç‡ã€åéªŒæ¦‚ç‡</p>
<h2 id="å…ˆéªŒæ¦‚ç‡ã€åéªŒæ¦‚ç‡">2.1. å…ˆéªŒæ¦‚ç‡ã€åéªŒæ¦‚ç‡</h2><p><strong>å…ˆéªŒæ¦‚ç‡</strong>æ˜¯æŒ‡äº‹ä»¶å°šæœªå‘ç”Ÿï¼Œå¯¹è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡çš„ä¼°è®¡ï¼Œæ˜¯åœ¨ç¼ºä¹æŸä¸ªäº‹æƒ…çš„æƒ…å†µä¸‹æè¿°ä¸€ä¸ªå˜é‡ã€‚<br>å…ˆéªŒæ¦‚ç‡å¯ä»¥é€šè¿‡å·²çŸ¥çš„å…³äºäº‹ä»¶æœ¬èº«çš„å…ˆéªŒçŸ¥è¯†å¾—åˆ°ï¼Œè’™ç‰¹å¡æ´›æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºè®¡ç®—å…ˆéªŒæ¦‚ç‡ã€‚<br><strong>åéªŒæ¦‚ç‡</strong>æ˜¯æŒ‡åœ¨äº‹ä»¶å·²ç»å‘ç”Ÿçš„æ¡ä»¶ä¸‹ï¼Œæ±‚è¯¥äº‹ä»¶å‘ç”ŸåŸå› æ˜¯ç”±æŸä¸ªå› ç´ å¼•èµ·çš„å¯èƒ½æ€§çš„å¤§å°ï¼Œæ˜¯è€ƒè™‘ä¸€ä¸ªäº‹ä»¶ä¹‹åçš„æ¡ä»¶æ¦‚ç‡ã€‚<br>åéªŒæ¦‚ç‡å¯ä»¥åŸºäº è´å¶æ–¯å®šç†ï¼Œé€šè¿‡å…ˆéªŒæ¦‚ç‡ä¹˜ä»¥ä¼¼ç„¶åº¦ï¼Œå†å½’ä¸€åŒ–å¾—åˆ°ã€‚å…·ä½“æ¥è¯´ï¼Œè´å¶æ–¯å…¬å¼ï¼š<br>$$P(h|D)=\frac{P(D|h)P(h)}{p(D)}$$<br>å…¶ä¸­ï¼Œ$P(h)$ä¸º$h$çš„å…ˆéªŒæ¦‚ç‡ï¼Œ$P(h|D)$ä¸º$h$çš„åéªŒæ¦‚ç‡ã€‚<br>é€šå¸¸ï¼Œäº‹ä»¶Aåœ¨äº‹ä»¶Bï¼ˆå‘ç”Ÿï¼‰çš„æ¡ä»¶ä¸‹çš„æ¦‚ç‡ï¼Œä¸äº‹ä»¶Båœ¨äº‹ä»¶Aï¼ˆå‘ç”Ÿï¼‰çš„æ¡ä»¶ä¸‹çš„æ¦‚ç‡æ˜¯ä¸ä¸€æ ·çš„ï¼›ç„¶è€Œï¼Œè¿™ä¸¤è€…æ˜¯æœ‰ç¡®å®šçš„å…³ç³»çš„ï¼Œè´å¶æ–¯å®šç†å°±æ˜¯è¿™ç§å…³ç³»çš„é™ˆè¿°ã€‚è´å¶æ–¯å…¬å¼çš„ä¸€ä¸ªç”¨é€”åœ¨äºé€šè¿‡å·²çŸ¥çš„ä¸‰ä¸ªæ¦‚ç‡å‡½æ•°æ¨å‡ºç¬¬å››ä¸ªã€‚</p>
<h2 id="æ ‡ç­¾å€¾æ–œä¿®æ­£">2.2. æ ‡ç­¾å€¾æ–œä¿®æ­£</h2><p>å‚è€ƒæ–‡çŒ®<a href="http://bourneli.github.io/machine-learning/prml/2016/12/19/compensating-for-class-priors.html" target="_blank" rel="external">æ ‡ç­¾å€¾æ–œä¿®æ­£æ–¹æ³•è®°è¦</a>é€šè¿‡ç†è®ºæ¨å¯¼æ¥éªŒè¯è¿™ä¸ªç»“è®ºã€‚<br>ä¸Šå‚è€ƒæ–‡çŒ®ä½œè€…æåˆ°ï¼ŒPRMLçš„1.5.4èŠ‚ä¸­ä»‹ç»äº†ä¸€ç§æ ‡ç­¾å€¾æ–œä¿®æ­£çš„æ–¹æ³•ã€‚</p>
<p>é¦–å…ˆï¼Œä½ çš„æ¨¡å‹å¿…é¡»æ˜¯ä¸€ä¸ªè½¯åˆ†ç±»å™¨ï¼Œå³é¢„æµ‹å€¼ä¸º0åˆ°1ä¹‹é—´çš„æ¦‚ç‡ã€‚å‡è®¾è¾“å…¥å‘é‡xï¼Œé¢„æµ‹æ ‡ç­¾$C_k$ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨æ¡ä»¶æ¦‚ç‡è¡¨ç¤ºï¼Œå³è®¡ç®—$p(C_k|x)$çš„æ¦‚ç‡ã€‚æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œæ¡ä»¶æ¦‚ç‡å¯ä»¥å¦‚ä¸‹å˜åŒ–ï¼š<br>$$p(C_k|x)=\frac{p(x|C_k)p(C_k)}{p(x)}$$</p>
<p>ä¸Šé¢æ˜¯æ²¡æœ‰åšé‡é‡‡æ ·æ—¶ï¼Œå¾—åˆ°æ¦‚ç‡ã€‚å½“åšé‡é‡‡æ ·æ—¶ï¼Œåªæ˜¯æ”¹å˜äº†æ ‡ç­¾$C_k$çš„å…ˆéªŒæ¦‚ç‡$p(C_k)$ï¼Œå³å°†$p(C_k)$å˜ä¸º$pâ€™(C_k)$ï¼ˆå…¶å®å°±æ˜¯æ ‡ç­¾$C_k$çš„å…ˆéªŒåˆ†å¸ƒè€Œå·²ï¼‰ã€‚è€Œ$p(x)$æ˜¯æ¡ä»¶$x$å‘ç”Ÿçš„æ¦‚ç‡ï¼Œä¸ä¼šå˜åŒ–ã€‚$p(x|C_k)$æ˜¯åéªŒæ¦‚ç‡ï¼Œä¹Ÿä¸ä¼šå˜åŒ–ã€‚ã€é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¸å˜ï¼Ÿæˆ‘æ„Ÿè§‰æ˜¯å› ä¸ºç‰¹å¾æ˜¯é‡‡æ ·å‰çš„ç‰¹å¾ï¼Œå› æ­¤è¿™ä¸ªæ²¡å˜ã€‘</p>
<p>å› ä¸ºæ˜¯å¯¹è´Ÿæ ·æœ¬è¿›è¡Œäº†æŠ½æ ·ï¼Œå‡è®¾å¯¹è´Ÿæ ·æœ¬æŠ½æ ·æ¯”ä¾‹ä¸º$w$ï¼ŒæŠ½æ ·åï¼š</p>
<p>$$nâ€™(0)=n(0)\times w,nâ€™(1)=n(1)$$</p>
<p>æ˜“çŸ¥ï¼š<br>$$p(1)=\frac{n(1)}{n(1)+n(0)}=\frac{nâ€™(1)}{nâ€™(1)+nâ€™(0)/ w}$$<br>$$=\frac{pâ€™}{pâ€™+(1-pâ€™)/w}$$<br>å…¶ä¸­ï¼Œ$n(C_k)$è¡¨ç¤º$C_k$çš„ä¸ªæ•°</p>
<p>æˆ‘ä»¬æ¨å¯¼å‡ºäº†å…ˆéªŒæ¦‚ç‡$pâ€™(C_k)$ä¸$p(C_k)$çš„å…³ç³»ã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä¿®æ­£$p(C_k|x)$ï¼Œåˆ™ï¼š</p>
<p>$$p(1|x) = \frac{p(x|1)p(1)}{p(x)} = \frac{p(x|1)pâ€™(1)p(1)}{p(x)pâ€™(1)}$$<br>$$=pâ€™(1|x)\frac{p(1)}{pâ€™(1)}=pâ€™(1|x)\frac{p}{pâ€™}$$</p>
<p>è€Œç”±ä¹‹å‰çš„æ¨å¯¼æˆ‘ä»¬å¯çŸ¥$p=\frac{pâ€™}{pâ€™+(1-pâ€™)/w}$ï¼Œä»£å…¥å¾—ï¼š<br>$$p(1|x)=pâ€™(1|x)\frac{p}{pâ€™}=pâ€™(1|x)\frac{\frac{pâ€™}{pâ€™+(1-pâ€™)/w}}{pâ€™}$$<br>$$=pâ€™(1|x)\frac{1}{pâ€™+(1-pâ€™)/w}$$</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ$pâ€™(1|x)$æ˜¯é¢„æµ‹å‡ºæ¥çš„æ¦‚ç‡ï¼Œ$pâ€™$æ˜¯æŠ½æ ·ä¹‹åæ­£æ ·æœ¬çš„æ¯”ä¾‹ï¼Œè€Œåœ¨facebookçš„è®ºæ–‡ä¸­ï¼Œå‡è®¾$pâ€™\approx pâ€™(1|x)$ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å‡è®¾äº†é¢„æµ‹é›†ä¸­ï¼Œ1å‡ºç°çš„æ¦‚ç‡=é¢„æµ‹å‡ºæ¥çš„ä¸º1çš„æ¦‚ç‡ã€‚æˆ‘çš„ç†è§£å°±æ˜¯ï¼Œæˆ‘ä»¬å®Œå…¨ä¿¡ä»»äº†é¢„æµ‹çš„ç»“æœï¼‰ï¼Œå¹¶è®°$q=pâ€™(1|x)$åˆ™ä»¥ä¸Šå…¬å¼å˜ä¸ºï¼š</p>
<p>$$p(1|x)=\frac{q}{q+(1-q)/w}$$</p>
<p>ã€é—®é¢˜ï¼šåœ¨é¢„æµ‹æ—¶ï¼Œ$pâ€™$å¯ä¸å¯ä»¥å˜ä¸ºé¢„æµ‹é›†çš„æ­£æ ·æœ¬æ¯”ä¾‹$pâ€™$ã€‘</p>
<h2 id="ç»“è®º">2.3. ç»“è®º</h2><p>åœ¨æ¬ é‡‡æ ·ä¸­ï¼Œå‡è®¾å¯¹è´Ÿæ ·æœ¬é‡‡æ ·ç‡ä¸º$w$ï¼Œåˆ™ç›´æ¥å°†ç»“æœæŒ‰ç…§å¦‚ä¸‹å…¬å¼ä¿®æ­£å³å¯ï¼š</p>
<p>$$p=\frac{q}{q+(1-q)/w}$$</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>$q$æ˜¯åœ¨æ¬ é‡‡æ ·ä¹‹åï¼Œæ¨¡å‹é¢„æµ‹å‡ºæ¥çš„æ¦‚ç‡ã€‚</li>
<li>$p$æ˜¯ä¿®æ­£åçš„æ¦‚ç‡ã€‚</li>
</ul>
<p>å½“w=0.1æ—¶ï¼Œå˜æ¢å…¶å®ä¸ºï¼š</p>
<p><img src="https://ooo.0o0.ooo/2017/06/10/593c0b680d2b7.png" alt=""> </p>
<p>ä¸Šé¢æ˜¯y1=q(ä¸åšå˜æ¢)ï¼Œä¸‹é¢æ˜¯æœ¬å˜æ¢y2ã€‚</p>
<p>è€Œå¦‚æœæˆ‘ä»¬å°†y3=y1-y2ç»˜å‡ºï¼š<br><img src="https://ooo.0o0.ooo/2017/06/10/593c0bc5aa670.png" alt=""> </p>
<p>æˆ‘ä»¬å‘ç°ï¼Œæ¦‚ç‡å¤§çš„å‹ç¼©çš„å°ã€‚<br>å› ä¸ºä½ è´Ÿæ ·æœ¬é‡‡æ ·äº†ä¹‹åï¼Œå°±æ˜¯ä¼šé¢„æµ‹çš„æ¯”å®é™…çš„é«˜ä¸€ç‚¹ï¼Œæ‰€ä»¥è¦ç»™å®ƒå‹ä¸‹å»ã€‚</p>
<p>é™„ä¸Šmatlabä»£ç ï¼š<br>    q=0.001:0.01:1;<br>    y1=1./(1+(1./q-1)./0.1);<br>    y2 = q;<br>    plot(q,y1);<br>    hold on;<br>    plot(q,y2);<br>    hold on;<br>    y3 = y2-y1;<br>    plot(q,y3)</p>
<h2 id="å°trickï¼ˆæœ‰é”™ï¼Œåˆ æ‰ï¼‰">2.4. å°trickï¼ˆæœ‰é”™ï¼Œåˆ æ‰ï¼‰</h2><p>å¦‚æœåœ¨å·²çŸ¥æ ·æœ¬ä¸­ï¼Œæ­£æ ·æœ¬çš„æ¦‚ç‡$p$,é‚£ä¹ˆï¼š</p>
<p>$$pâ€™(1)=\frac{nâ€™(1)}{nâ€™(1)+nâ€™(0)}=\frac{n(1)}{n(1)+n(0)\times w}$$<br>$$=\frac{1}{1+\frac{n(0)\times w}{n(1)}}=\frac{1}{1+\frac{p(0)\times w}{p(1)}}$$<br>$$=\frac{p(1)}{p(1)+p(0)\times w}=\frac{p}{p+(1-p)\times w}$$</p>
<p>è€Œå› ä¸ºï¼š<br>$$p(1|x)=pâ€™(1|x)\frac{p}{pâ€™}$$</p>
<p>ä»£å…¥å¾—ï¼š</p>
<p>$$p(1|x)=pâ€™(1|x)\frac{p}{\frac{p}{p+(1-p)\times w}}$$<br>$$=pâ€™(1|x)(p+(1-p)\times w)$$</p>
<p>è¿™é‡Œçš„pæ˜¯æ ·æœ¬ä¸­ï¼Œæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">3. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://bourneli.github.io/machine-learning/prml/2016/12/19/compensating-for-class-priors.html" target="_blank" rel="external">æ ‡ç­¾å€¾æ–œä¿®æ­£æ–¹æ³•è®°è¦</a></li>
<li><a href="https://www.jiqizhixin.com/articles/1dd8da6e-ae24-4fc5-ab90-ee39020bc5ff" target="_blank" rel="external">è§£å†³çœŸå®ä¸–ç•Œé—®é¢˜ï¼šå¦‚ä½•åœ¨ä¸å¹³è¡¡ç±»ä¸Šä½¿ç”¨æœºå™¨å­¦ä¹ ï¼Ÿ</a></li>
<li><a href="https://mqshen.gitbooks.io/prml/content/" target="_blank" rel="external">PRML(ã€Šæ¨¡å¼è¯†åˆ«å’Œæœºå™¨å­¦ä¹ ã€‹)ç¿»è¯‘</a></li>
<li><a href="http://bourneli.github.io/ml/2017/05/25/gdbt-lr-facebook-paper.html?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="external">GBDTç‰¹å¾è½¬æ¢+LRæ€»ç»“</a></li>
<li><a href="http://sighingnow.github.io/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/prior_posterior_probability_and_estimation.html" target="_blank" rel="external">å…ˆéªŒå’ŒåéªŒæ¦‚ç‡ä»¥åŠä¼°è®¡</a></li>
<li><a href="">Practical Lessons from Predicting Clicks on Ads at<br>Facebook</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> è…¾è®¯ç®—æ³•å¤§èµ›-CVRé¢„ä¼° </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç‰¹å¾å·¥ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è…¾è®¯ç¤¾äº¤å¹¿å‘ŠAPPè½¬åŒ–ç‡é¢„ä¼°é¢„ä¼°åˆèµ›&å¤èµ›æ€è·¯æ€»ç»“]]></title>
      <url>/2017/06/07/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-CVR-Tencent_CVR%E9%A2%84%E4%BC%B0%E5%88%9D%E8%B5%9B%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>â€œè¿™ä¸€æ®µå¥”æ³¢å¤ªè¿‡åŒ†å¿™ï¼Œæœ‰æ—¶æ¥ä¸åŠå›å¤´å¼ æœ›ã€‚â€</p>
<p>è…¾è®¯â€œäººå·¥å¯»æ‰¾trickâ€å¤§èµ›åˆèµ›ä»Šå¤©ç»“æŸäº†ã€‚æœ€ç»ˆåˆèµ›çº¿ä¸Šloglossä¸º0.099104ï¼Œæ’åä¸º64åï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-06-07-15-22-48.png" alt=""> </p>
<p>å¤èµ›æˆç»©0.101941ï¼Œæ’å26åï¼š<img src="https://ooo.0o0.ooo/2017/07/11/59646ce45d3e0.png" alt=""> </p>
<p>è™½ç„¶ä¸å‰æ’å¤§ç¥çš„åˆ†ç›¸å·®ç”šè¿œï¼Œè™½ç»“æœä¸é‚£ä¹ˆå¦‚äººæ„ï¼Œä¹Ÿæ˜¯å¯¹è¿™ä¸ªé¢†åŸŸå…¥äº†ä¸ªé—¨ã€‚</p>
<h1 id="èµ›é¢˜">1. èµ›é¢˜</h1><p>è¯¦ç»†èµ›é¢˜è§<a href="http://algo.tpai.qq.com/home/information/index.html" target="_blank" rel="external">å®˜æ–¹ç½‘ç«™</a></p>
<p><strong>å·²çŸ¥</strong>ï¼š17-30å¤©ç§»åŠ¨APPçš„å¹¿å‘Šã€ç”¨æˆ·çš„è½¬åŒ–æƒ…å†µï¼ŒåŠç›¸å…³ä¸Šä¸‹æ–‡ã€‚<br><strong>é¢„æµ‹</strong>ï¼šç¬¬31å¤©æŒ‡å®šç”¨æˆ·å’Œå¯¹åº”å¹¿å‘Šçš„è½¬åŒ–ç‡ã€‚</p>
<p><strong>è¯„ä¼°æ–¹å¼</strong>ï¼š<br>$$logloss=-\frac{1}{N}\sum_{i=1}^N(y_ilog(p_i)+(1-y_i)log(1-p_i))$$</p>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li>Næ˜¯æµ‹è¯•æ ·æœ¬æ€»æ•°</li>
<li>$y_i$æ˜¯äºŒå€¼å˜é‡ï¼Œå–å€¼ä¸º0æˆ–1ï¼Œè¡¨ç¤ºç¬¬iä¸ªæ ·æœ¬çš„label</li>
<li>$p_i$æ˜¯æ¨¡å‹é¢„æµ‹ç¬¬iä¸ªæ ·æœ¬labelä¸º1çš„æ¦‚ç‡</li>
</ul>
<p>æ€»ä¹‹ï¼Œå°±æ˜¯é¢„æµ‹çš„è¶Šå‡†è¶Šå¥½ï¼ˆè¿™ä¸åºŸè¯ä¹ˆ2333ï¼‰</p>
<h1 id="ä¸»è¦æµç¨‹">2. ä¸»è¦æµç¨‹</h1><p>è¿™æ˜¯Kaggleä¸Šæ•°æ®æŒ–æ˜æ¯”èµ›çš„é»„é‡‘æµç¨‹å›¾ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-06-07-15-44-01.png" alt=""> </p>
<p>å…¶å®å¯¹äºè¿™ä¸ªæ¯”èµ›çš„åˆèµ›è€Œè¨€ï¼Œçº¿ä¸Šæ˜¯å®¹æ˜“è¿‡æ‹Ÿåˆçš„ã€‚å› ä¸ºçº¿ä¸Šåªæœ‰ä¸€ä¸ªé›†ï¼Œå¯åå¤æäº¤å¤šæ¬¡æ¥ä½¿å¾—çº¿ä¸Šå¾—åˆ†å¾ˆé«˜ï¼Œä½†å®é™…ä¸Šæ¨¡å‹æ˜¯æœ‰äº›è¿‡æ‹Ÿåˆçš„ã€‚ä¸è¿‡è¿™ä¸æ˜¯é‡ç‚¹ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸€æ­¥æ­¥åšè¯´æ˜</p>
<h1 id="æ•°æ®åˆ†æä¸æ¸…æ´—">3. æ•°æ®åˆ†æä¸æ¸…æ´—</h1><p>è®­ç»ƒé›†train.csvæ²¡æœ‰å¤§é—®é¢˜ï¼Œæˆ‘æ³¨æ„çš„åªæ˜¯åå‡ å¤©çš„ä¸€äº›æ•°æ®æ²¡æœ‰å›æµçš„é—®é¢˜ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ¬æ¬¡ç«èµ›çš„è®­ç»ƒæ•°æ®æä¾›çš„æˆªæ­¢ç¬¬31å¤©0ç‚¹çš„å¹¿å‘Šæ—¥å¿—ï¼Œå› æ­¤ï¼Œå¯¹äºæœ€åå‡ å¤©çš„è®­ç»ƒæ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´åäº”å¤©éƒ¨åˆ†ç”¨æˆ·å®é™…ä¸Šæ˜¯è½¬åŒ–äº†ï¼Œä½†å¹¿å‘Šä¸»è¿˜æ²¡æœ‰æ¥å¾—åŠå°†è¿™æ¡è½¬åŒ–æ±‡æŠ¥ç»™å¹¿å‘Šç³»ç»Ÿï¼Œå¯¼è‡´æ•°æ®é›†ä¸­çš„labelè¢«è¯¯æ ‡è®°ä¸ºäº†0ï¼ˆå®é™…ä¸Šæ˜¯1ï¼‰ã€‚ï¼ˆå¦‚æœæˆ‘è¿˜æ²¡æœ‰æè¿°æ¸…æ¥šï¼Œè¿™é‡Œå…·ä½“å¯ä»¥çœ‹å®˜ç½‘èµ›é¢˜FAQ.1ï¼‰</p>
<p>è¿™é‡Œæˆ‘é‡‡å–äº†ä¸€ç§å¾ˆæš´åŠ›çš„æ–¹æ³•ï¼Œå³å»æ‰æ¯ä¸ªå¹¿å‘Šä¸»æœ€åä¸€æ¬¡å›æµä¹‹åçš„æ•°æ®ã€‚</p>
<p>é€šè¿‡åˆ†ææˆ‘ä»¬å‘ç°ï¼Œå…¶å®æœ‰è¿‘ä¸€åŠçš„å¹¿å‘Šä¸»è¿˜æ˜¯å°½èŒå°½è´£çš„ï¼Œç›´åˆ°30å·23ç‚¹è¿˜åœ¨åé¦ˆå›æµã€‚åªæœ‰æœ‰ä¸€éƒ¨åˆ†å¹¿å‘Šä¸»åœ¨30å·ä¸‹ç­åï¼Œæˆ–29å·ä¸‹ç­åå°±ä¸å›æµäº†ã€‚æ‰€ä»¥æˆ‘ä»¬å°†è¿™äº›å¹¿å‘Šä¸»æœ€åä¸€æ¬¡å›æµä¹‹åçš„æ•°æ®éƒ½åˆ é™¤ï¼ˆå…¶å®è¿™äº›éƒ½æ˜¯è´Ÿæ ·æœ¬ï¼‰ï¼Œè¿™æ ·å°±åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†ä¸å‡†çš„è´Ÿæ ·æœ¬ã€‚</p>
<p>è¿™æ ·ç­›å»äº†å¤§æ¦‚æœ‰3ä¸‡æ¡ï¼Œä¹Ÿä¸ç®—å¤šã€‚</p>
<h1 id="ç‰¹å¾å·¥ç¨‹">4. ç‰¹å¾å·¥ç¨‹</h1><p>ä¸€å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬é‡‡ç”¨äº†å¾ˆå¤šåŸºæœ¬ç‰¹å¾ï¼Œå³å„ç§IDï¼ˆAppID,UserID,creativeID,pisitionIDç­‰ï¼‰çš„onehotç¼–ç ï¼Œåˆå¯¹å•ç‰¹å¾è¿›è¡Œäº†ä¸€å®šçš„ç»Ÿè®¡ã€‚åæ¥çœ‹äº†å¤§ç¥â€œä¸ºæƒ…æ‰€å›°çš„å°‘å¹´â€çš„åˆ†äº«ï¼Œæ‰ååº”è¿‡æ¥å…¶å®æ— è®ºæ˜¯onehotè¿˜æ˜¯å¯¹IDå•ç»´åº¦çš„ç»Ÿè®¡ç‰¹å¾ï¼Œå…¶å®éƒ½æ˜¯å¯¹äºä¸€ä¸ªç‰¹å¾çš„ä¸€ç§è¡¨è¾¾ï¼Œä»ä¸€å®šæ„ä¹‰ä¸Šæ˜¯é‡å¤çš„ã€‚æˆ‘ä¸ªäººæ„Ÿè§‰onehotä¹‹åçš„ç¨€ç–ç‰¹å¾æ›´é€‚åˆäºçº¿æ€§æ¨¡å‹ï¼Œå¦‚LRï¼›è€Œç»Ÿè®¡é‡çš„è¿ç»­ç‰¹å¾æ›´é€‚åˆäºæ ‘æ¨¡å‹ï¼Œå¦‚GBDTã€‚</p>
<p>å›å¤´æ¥çœ‹ï¼Œå…¶å®ç‰¹å¾å·¥ç¨‹éœ€è¦æ ¹æ®æ¨¡å‹é¢„å…ˆé€‰æ‹©æ–¹å‘ã€‚ææ²è¯´è¿‡ï¼Œæ¨¡å‹æ˜¯ä½¿ç”¨ç¦»æ•£ç‰¹å¾è¿˜æ˜¯è¿ç»­ç‰¹å¾ï¼Œå…¶å®æ˜¯ä¸€ä¸ªâ€œæµ·é‡ç¦»æ•£ç‰¹å¾+ç®€å•æ¨¡å‹â€ åŒ â€œå°‘é‡è¿ç»­ç‰¹å¾+å¤æ‚æ¨¡å‹â€çš„æƒè¡¡ã€‚æ—¢å¯ä»¥ç¦»æ•£åŒ–ç”¨çº¿æ€§æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ç”¨è¿ç»­ç‰¹å¾åŠ æ·±åº¦å­¦ä¹ ã€‚å°±çœ‹æ˜¯å–œæ¬¢æŠ˜è…¾ç‰¹å¾è¿˜æ˜¯æŠ˜è…¾æ¨¡å‹äº†ã€‚é€šå¸¸æ¥è¯´ï¼Œå‰è€…å®¹æ˜“ï¼Œè€Œä¸”å¯ä»¥nä¸ªäººä¸€èµ·å¹¶è¡Œåšï¼Œæœ‰æˆåŠŸç»éªŒï¼›åè€…ç›®å‰çœ‹å¾ˆèµï¼Œèƒ½èµ°å¤šè¿œè¿˜é¡»æ‹­ç›®ä»¥å¾…ã€‚</p>
<p>å°±æ­¤é¢˜æ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªæ–¹å‘ï¼š</p>
<h2 id="æµ·é‡ç¦»æ•£ç‰¹å¾-ç®€å•æ¨¡å‹">4.1. æµ·é‡ç¦»æ•£ç‰¹å¾+ç®€å•æ¨¡å‹</h2><p>å¦‚æœæˆ‘ä»¬æ‡’å¾—åˆ†ææ•°æ®ï¼ˆåˆæœŸæˆ‘ä»¬å°±æ˜¯è¿™æ ·ï¼‰ï¼Œå¹¶ä¸”æœ‰è¿˜ä¸é”™çš„è®¾å¤‡ï¼ˆè‡ªä»¥ä¸º64Gå†…å­˜å¾ˆæœ‰ä¼˜åŠ¿ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰æ‹©è¿™ä¸ªæ–¹å‘ã€‚</p>
<p>åˆæœŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯é€‰æ‹©çš„è¿™æ¡è·¯ã€‚<br>å½“æ—¶åªæœ‰ç®€å•çš„IDç±»ç‰¹å¾ï¼Œä»¥åŠIDç±»ç‰¹å¾çš„äº¤å‰ç»„åˆï¼Œå°†è¿™äº›ç‰¹å¾onehotä¹‹åè¾“å…¥äº†LRæ¨¡å‹ã€‚</p>
<p>å…³äºç‰¹å¾ç»„åˆï¼Œæˆ‘åœ¨åé¢ä¼šä»‹ç»åˆ°ã€‚</p>
<p>åšå®Œç‰¹å¾å’Œç‰¹å¾ç»„åˆï¼Œå°†å®ƒonehotä¹‹åè¾“å…¥æ¨¡å‹å°±å¯ä»¥äº†ã€‚</p>
<p>å¯¹äºLRè¿™ç§çº¿æ€§æ¨¡å‹æ¥è¯´ï¼Œå®ƒæ›´é€‚åˆäºonehotç±»å‹çš„ç‰¹å¾ï¼Œé¦–å…ˆå®ƒå¯¹äºç¨€ç–é«˜ç»´ç‰¹å¾å¤„ç†æ˜¯æ— å‹åŠ›çš„ï¼Œå…¶æ¬¡ç¦»æ•£åŒ–åçš„ç‰¹å¾å¯¹å¼‚å¸¸æ•°æ®æœ‰å¾ˆå¼ºçš„é²æ£’æ€§ï¼Œè¿™äº›åœ¨å‚è€ƒæ–‡çŒ®2<a href="http://blog.csdn.net/yang090510118/article/details/39478033" target="_blank" rel="external">é€»è¾‘å›å½’LRçš„ç‰¹å¾ä¸ºä»€ä¹ˆè¦å…ˆç¦»æ•£åŒ–</a>ä¸­å¯ä»¥çœ‹åˆ°ã€‚</p>
<p>ä½†ç”±äºIDç±»ç‰¹å¾éå¸¸å¤šï¼Œä¾‹å¦‚æœ¬é¢˜çš„UserIDæœ‰å¥½å‡ ç™¾ä¸‡ä¸ªã€‚è¿™æ—¶å°±ä¼šå¸¦æ¥ç»´åº¦ç¾éš¾é—®é¢˜ï¼Œè§å‚è€ƒæ–‡çŒ®4<a href="https://zhuanlan.zhihu.com/p/26945814" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¸­çš„ç»´åº¦ç¾éš¾</a>ã€‚ä¸ä»…å¦‚æ­¤ï¼Œè¿™æ—¶åŸºæœ¬ä¸Šä¹Ÿå°±è¢«è®¾å¤‡é—®é¢˜é™åˆ¶æ­»äº†ã€‚è¿™å¾ˆçƒ¦ã€‚äºæ˜¯æˆ‘ä»¬å°±æ¢æ¨¡å‹äº†ã€‚</p>
<h2 id="å°‘é‡è¿ç»­ç‰¹å¾-å¤æ‚æ¨¡å‹">4.2. å°‘é‡è¿ç»­ç‰¹å¾+å¤æ‚æ¨¡å‹</h2><p>è¿™æ˜¯æˆ‘ä»¬æš‚å®šçš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°±æ˜¯é‡‡ç”¨å°‘é‡ã€ä½†è¡¨ç°å¾ˆä¸é”™çš„ç»„åˆç‰¹å¾ç»Ÿè®¡é‡ï¼Œä»¥åŠä¸€äº›æ‰‹å·¥æå–çš„ç‰¹å¾ï¼ˆå¦‚ç”¨æˆ·å†å²å®‰è£…æ¬¡æ•°ã€APPå†å²è¢«å®‰è£…æ¬¡æ•°ï¼‰ï¼Œè¿™äº›ç‰¹å¾ä¸»è¦æ¥æºäºç¾¤å†…â€œä¸ºæƒ…æ‰€å›°â€å¤§ç¥åˆ†äº«çš„ä¸€å¼ è¡¨ã€‚</p>
<p>æ¨¡å‹æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯GBDTï¼Œç›´æ¥ä½¿ç”¨äº†é™ˆå¤©å¥‡å¤§ç‰›çš„xgboostæ¡†æ¶ã€‚æ¨¡å‹æˆ‘æš‚æ—¶è¿˜æ²¡æœ‰å¾ˆè®¤çœŸåœ°ç ”ç©¶ï¼Œåªæ˜¯ç†Ÿæ‚‰äº†ä¸€äº›å‚æ•°ï¼Œä¸ºå†³èµ›åšäº†ä¸€äº›å‡†å¤‡ã€‚</p>
<h1 id="ç‰¹å¾ç»„åˆ">5. ç‰¹å¾ç»„åˆ</h1><p>ç‰¹å¾ç»„åˆçœŸæ˜¯æˆ‘é‡åˆ°çš„ä¸€ä¸ªå¤§éš¾é¢˜ã€‚</p>
<h2 id="æ€ä¹ˆè¡¨è¾¾ç»„åˆç‰¹å¾ï¼Ÿ">5.1. æ€ä¹ˆè¡¨è¾¾ç»„åˆç‰¹å¾ï¼Ÿ</h2><p>è¯´åˆ°ç‰¹å¾ç»„åˆï¼Œä»ç»Ÿè®¡çš„è§’åº¦è§£é‡Šï¼ŒåŸºæœ¬ç‰¹å¾ä»…ä»…æ˜¯çœŸå®ç‰¹å¾åˆ†å¸ƒåœ¨ä½ç»´ç©ºé—´çš„æ˜ å°„ï¼Œä¸è¶³ä»¥æè¿°çœŸå®åˆ†å¸ƒï¼ŒåŠ å…¥ç»„åˆç‰¹å¾æ˜¯ä¸ºäº†åœ¨æ›´é«˜ç»´ç©ºé—´æ‹ŸåˆçœŸå®åˆ†å¸ƒï¼Œä½¿å¾—é¢„æµ‹æ›´å‡†ç¡®ã€‚<br>ç»„åˆç‰¹å¾æˆ‘ç°åœ¨ç”¨è¿‡çš„æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<p><strong>å¯¹ç¦»æ•£IDè¿›è¡Œhashç”Ÿæˆæ–°ç‰¹å¾</strong></p>
<p>åœ¨åˆæœŸç”¨LRçš„æ—¶å€™ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ–¹å¼æ˜¯hashã€‚å³å¯¹ä¸¤ä¸ªIDåšhashè¿ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°ç‰¹å¾ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå·§å¦™çš„æ–¹æ³•ã€‚ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªè¡¨ï¼Œæˆ‘ä»¬åšå“ˆå¸Œï¼š</p>
<p>$$age\times 10 + gendar$$</p>
<p>å¾—åˆ°ç¬¬ä¸‰åˆ—ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">age</th>
<th style="text-align:center">gendar</th>
<th style="text-align:center">hash</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">1</td>
<td style="text-align:center">21</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">2</td>
<td style="text-align:center">32</td>
</tr>
</tbody>
</table>
<p>ç¬¬ä¸‰åˆ—çš„çš„ç‰¹å¾çš„å–å€¼æœ‰ä¸¤ä½ï¼Œåä½æ˜¯age,ä¸ªä½æ˜¯gendarã€‚æ–°ç‰¹å¾æ˜¯ä¸€ç§æ–°çš„äº¤å‰ç‰¹å¾çš„ä½“ç°ã€‚</p>
<p><strong>å¯¹ç»„åˆè¿›è¡Œç»Ÿè®¡ç”Ÿæˆæ–°ç‰¹å¾</strong></p>
<p>åƒä¹‹å‰â€œä¸ºæƒ…æ‰€å›°â€å¤§ç¥è¯´è¿‡çš„é‚£æ ·ï¼Œå…¶å®æ— è®ºonehotè¿˜æ˜¯ç»Ÿè®¡ç‰¹å¾ï¼Œå…¶å®éƒ½æ˜¯å¯¹äºä¸€ä¸ªç‰¹å¾çš„ä¸€ç§è¡¨è¾¾ã€‚å› ä¸ºåæœŸæˆ‘ä»¬é‡‡ç”¨äº†GBDTï¼Œå› æ­¤æˆ‘ä»¬å¼ƒç”¨äº†ä¹‹å‰çš„hashç»„åˆæ–¹å¼ï¼Œè€Œé€‰ç”¨ç»Ÿè®¡é‡ï¼ˆå³ç‚¹å‡»é‡ã€è½¬åŒ–é‡å’Œè½¬åŒ–ç‡ï¼‰ã€‚è¿™æ ·å°±åœ¨ä¸€ä¸ªç»´åº¦ä¸Šè¡¨è¾¾äº†è¿™ä¸¤ä¸ªç‰¹å¾çš„ç»„åˆï¼Œè€Œä¸”éå¸¸ä¾¿äºè®¡ç®—ã€‚</p>
<h2 id="é€‰è°åšç‰¹å¾ç»„åˆï¼Ÿ">5.2. é€‰è°åšç‰¹å¾ç»„åˆï¼Ÿ</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç‰¹å¾ç»„åˆä¹Ÿä¸æ˜¯éšä¾¿ä»åŸæ¥çš„ç‰¹å¾é‡Œæ‘˜å‡ºæ¥ä¸¤åˆ—å°±åšç»„åˆã€‚è¿™ç§éšæ„åœ°å¯¹ç‰¹å¾å †å å…¶å®ä¼šå¢åŠ æ¨¡å‹çš„è´Ÿæ‹…ï¼Œè€Œä¸”è¿™äº›å…¶å®å°±åƒæ˜¯â€œéšæœºæ•°ä¸€èˆ¬çš„ï¼Œæ¯«æ— ä½œç”¨çš„ç‰¹å¾â€ï¼Œå¯èƒ½ä¼šä½¿å¾—æ•ˆæœå˜å·®ã€‚</p>
<p>ç©¶ç«Ÿå¯¹è°åšç»„åˆï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç›´å›°æ‰°æˆ‘ä»¬çš„é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯æˆ‘æœé›†åˆ°çš„å‡ ç§æ–¹æ¡ˆï¼š</p>
<p><strong>è¿­ä»£é€‰å–æ–¹å¼</strong></p>
<p>Jerrylinå¤§ç¥æ›¾ç»è¯´è¿‡ï¼Œå¯ä»¥å…ˆå¯¹ä¸€ä¸ªç»„åˆåšgroupbyåˆ†æï¼Œçœ‹çœ‹è½¬åŒ–ç‡çš„åˆ†å¸ƒã€‚å¯æ˜¯æˆ‘é‡åˆ°äº†ä¸€ä¸ªç“¶é¢ˆâ€”â€”å¤§å¤šæ•°ç‰¹å¾çš„è½¬åŒ–ç‡åˆ†å¸ƒéƒ½æ˜¯ä¸å‡åŒ€çš„ï¼Œç»„åˆèµ·æ¥å°±æ›´ä¸å‡åŒ€äº†ã€‚ä¸çŸ¥é“å¤§ç¥æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Œä¹Ÿè®¸æ˜¯è®¡ç®—è¿™ä¸ªåˆ†å¸ƒçš„æ–¹å·®ï¼Ÿã€è¿™æ˜¯ä¸ªé—®é¢˜ï¼Œç­‰æ¥æ—¥è§£å†³ï¼Œæˆ‘å†å›æ¥å¡«å‘ã€‘<br>å¤§ç¥åˆšæ‰å›æˆ‘äº†ï¼Œä»–è¯´ä»–æ˜¯æŒ‰ç…§gbdtç»™çš„ä¸€ä¸ªè¯„åˆ†ï¼Œé€‰å–è¯„åˆ†è¾ƒé«˜çš„å‡ ä¸ªè¿›è¡Œç»„åˆï¼Œç„¶åå†æ¬¡è¾“å…¥æ¨¡å‹è¿›è¡Œè¿­ä»£ç­›é€‰ã€‚<br>åœ¨æ­¤æˆ‘è¦å†æ¬¡å·å·æ„Ÿè°¢ä¸€ä¸‹è¿™ä½å¤§ç¥ã€‚è¦æ˜¯æ²¡æœ‰ä»–ï¼Œæˆ‘å¯èƒ½è¿˜ä¼šåœ¨äºŒç™¾åå¤–æŒ£æ‰ã€‚</p>
<p>åˆšæ‰é£ï¼Œé£æ‰¬ã€‚ã€‚å¤§ç¥å‘Šè¯‰æˆ‘ï¼Œå…¶å®xgbç»™çš„è¯„åˆ†ä¹Ÿæ˜¯åªèƒ½ä½œä¸ºä¸€ä¸ªå‚è€ƒï¼Œå› ä¸ºä¸ä¸€å®šç»„åˆä¹‹åç»™ä¼šæ›´é«˜ã€‚</p>
<p>å¿†ã€å‡Œã€æ®‡å¤§ç¥è¯´ï¼Œæ„é€ çš„ç‰¹å¾å¾ˆå¯èƒ½ç›¸å…³æ€§å¾ˆé«˜ï¼Œç„¶åè¿™ä¸¤ä¸ªç‰¹å¾çš„é‡è¦æ€§è‚¯å®šéƒ½ä¸ä½ã€‚ä½†æ˜¯å› ä¸ºç›¸å…³æ€§é«˜åè€Œä¼šå½±å“æ€§èƒ½ã€‚è¿™ä¸ªç›¸å…³æ€§å¯ä»¥è®¡ç®—è¿™ä¸¤ä¸ªç‰¹å¾çš„ç›¸å…³ç³»æ•°corrcoefæ¥å¾—åˆ°ã€‚</p>
<p><strong>ç©·ä¸¾åç”¨å¡æ–¹æ£€éªŒç­›ç‰¹å¾</strong></p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://202.197.191.206:8080/30/text/chapter04/4_8.htm" target="_blank" rel="external">æè¿°é‡é€‰æ‹©åŠç‰¹å¾çš„ç»„åˆä¼˜åŒ–</a>æåˆ°ï¼Œç”±äºä»»ä½•éç©·ä¸¾çš„ç®—æ³•éƒ½ä¸èƒ½ç¡®ä¿æ‰€å¾—ç»“æœæ˜¯æœ€ä¼˜çš„ï¼Œå› æ­¤è¦å¾—æœ€ä¼˜è§£ï¼Œå°±å¿…éœ€é‡‡ç”¨ç©·ä¸¾æ³•ï¼Œåªæ˜¯åœ¨æœç´¢æŠ€æœ¯ä¸Šé‡‡ç”¨ä¸€äº›æŠ€å·§ï¼Œä½¿è®¡ç®—é‡æœ‰å¯èƒ½é™ä½ã€‚</p>
<p>æˆ‘çš„å­¦é•¿â€œé…±ç´«â€å¯¹æ­¤æœ‰ä¸€ç§å»ºè®®å°±æ˜¯ç›´æ¥å¯¹æ‰€æœ‰åŸºæœ¬ç‰¹å¾è¿›è¡Œéå†ä¸¤ä¸¤ç»„åˆï¼Œç„¶åç”¨å¡æ–¹æ£€éªŒç­›å‡ºæ¥ä¸€äº›æ¯”è¾ƒå¥½çš„ç‰¹å¾ã€‚è¿™ç§æ–¹å¼å¾ˆç®€å•ï¼Œå¤§å¤šæ•°å·¥ä½œåªéœ€è¦äº¤ç»™æ¨¡å‹æ¥å®Œæˆã€‚</p>
<p><strong>å¾ªç¯ç‰¹å¾æ¶ˆå‡å’Œç‰¹å¾é‡è¦æ€§è¯„çº§</strong></p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://www.jianshu.com/p/8f6f94f1d275" target="_blank" rel="external">scikit-learnç³»åˆ—ä¹‹ç‰¹å¾é€‰æ‹©</a>ä¸­æåˆ°ï¼Œåœ¨scikit-learnä¸­æœ‰ä¸¤ç§ç‰¹å¾é€‰æ‹©çš„æ–¹æ³•ï¼Œä¸€ç§å«åšå¾ªç¯ç‰¹å¾æ¶ˆå‡(Recursive Feature Elimination)å’Œç‰¹å¾é‡è¦æ€§è¯„çº§ (feature importance ranking)ã€‚</p>
<ul>
<li>å¾ªç¯ç‰¹å¾æ¶ˆå‡ï¼šå…¶å®å°±æ˜¯å¾ªç¯åœ°ç§»é™¤å˜é‡å’Œå»ºç«‹æ¨¡å‹ï¼Œé€šè¿‡æ¨¡å‹çš„å‡†ç¡®ç‡æ¥è¯„ä¼°å˜é‡å¯¹æ¨¡å‹çš„è´¡çŒ®ã€‚è¿™ç§æ–¹å¼å¾ˆæš´åŠ›ï¼Œä½†ä¹Ÿå¾ˆå‡†ç¡®ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬æ²¡æœ‰é‚£ä¹ˆå¤šçš„æ—¶é—´æ¥ç­‰å¾…æ¨¡å‹è®­ç»ƒè¿™ä¹ˆå¤šæ¬¡ã€‚</li>
<li>ç‰¹å¾é‡è¦æ€§è¯„çº§ï¼šâ€œç»„åˆå†³ç­–æ ‘ç®—æ³•â€ï¼ˆä¾‹å¦‚Random Forest or Extra Treesï¼‰å¯ä»¥è®¡ç®—æ¯ä¸€ä¸ªå±æ€§çš„é‡è¦æ€§ã€‚é‡è¦æ€§çš„å€¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©å‡ºé‡è¦çš„ç‰¹å¾ã€‚</li>
</ul>
<p><strong>ç”¨GBDTç­›ç‰¹å¾</strong></p>
<p><em>ä¸»è¦æ€æƒ³</em>ï¼š<br>GBDTæ¯æ£µæ ‘çš„è·¯å¾„ç›´æ¥ä½œä¸ºLRè¾“å…¥ç‰¹å¾ä½¿ç”¨ã€‚</p>
<p><em>åŸç†</em>ï¼š<br>ç”¨å·²æœ‰ç‰¹å¾è®­ç»ƒGBDTæ¨¡å‹ï¼Œç„¶ååˆ©ç”¨GBDTæ¨¡å‹å­¦ä¹ åˆ°çš„æ ‘æ¥æ„é€ æ–°ç‰¹å¾ï¼Œæœ€åæŠŠè¿™äº›æ–°ç‰¹å¾åŠ å…¥åŸæœ‰ç‰¹å¾ä¸€èµ·è®­ç»ƒæ¨¡å‹ã€‚æ„é€ çš„æ–°ç‰¹å¾å‘é‡æ˜¯å–å€¼0/1çš„ï¼Œå‘é‡çš„æ¯ä¸ªå…ƒç´ å¯¹åº”äºGBDTæ¨¡å‹ä¸­æ ‘çš„å¶å­ç»“ç‚¹ã€‚å½“ä¸€ä¸ªæ ·æœ¬ç‚¹é€šè¿‡æŸæ£µæ ‘æœ€ç»ˆè½åœ¨è¿™æ£µæ ‘çš„ä¸€ä¸ªå¶å­ç»“ç‚¹ä¸Šï¼Œé‚£ä¹ˆåœ¨æ–°ç‰¹å¾å‘é‡ä¸­è¿™ä¸ªå¶å­ç»“ç‚¹å¯¹åº”çš„å…ƒç´ å€¼ä¸º1ï¼Œè€Œè¿™æ£µæ ‘çš„å…¶ä»–å¶å­ç»“ç‚¹å¯¹åº”çš„å…ƒç´ å€¼ä¸º0ã€‚æ–°ç‰¹å¾å‘é‡çš„é•¿åº¦ç­‰äºGBDTæ¨¡å‹é‡Œæ‰€æœ‰æ ‘åŒ…å«çš„å¶å­ç»“ç‚¹æ•°ä¹‹å’Œã€‚</p>
<p>ã€è¿™é‡Œå…¶å®ä¸å¤ªæ‡‚ï¼Œä¸€ä¼šé—®é—®å¼ æ€é¥ã€‘</p>
<p><em>æ­¥éª¤</em>ï¼š</p>
<ol>
<li>é¦–å…ˆè¦åˆ‡åˆ†æ•°æ®é›†ï¼Œä¸€éƒ¨åˆ†ç”¨äºè®­ç»ƒGBDTï¼Œå¦ä¸€éƒ¨åˆ†ä½¿ç”¨è®­ç»ƒå¥½çš„GBDTæ¨¡å‹</li>
<li>GBDTæ¨¡å‹çš„applyæ–¹æ³•ç”Ÿæˆxåœ¨GBDTæ¯ä¸ªæ ‘ä¸­çš„indexï¼Œç„¶åé€šè¿‡onehotç¼–ç åšæˆç‰¹å¾ã€‚</li>
<li>æ–°çš„ç‰¹å¾è¾“å…¥åˆ°åˆ†ç±»ï¼ˆå¦‚LRï¼‰æ¨¡å‹ä¸­è®­ç»ƒåˆ†ç±»å™¨ã€‚</li>
</ol>
<p><em>å®ç°</em>ï¼š<br>å‚è€ƒæ–‡çŒ®<a href="http://blog.csdn.net/shine19930820/article/details/71713680" target="_blank" rel="external">GBDTåŸç†åŠåˆ©ç”¨GBDTæ„é€ æ–°çš„ç‰¹å¾-Pythonå®ç°</a>çš„æœ«å°¾æœ‰ä¸€ä¸ªè°ƒç”¨GBDTè®­ç»ƒæ¨¡å‹æ„å»ºæ ‘ï¼Œè°ƒç”¨<a href="http://blog.csdn.net/shine19930820/article/details/71713680" target="_blank" rel="external">apply()</a>æ–¹æ³•å¾—åˆ°ç‰¹å¾ï¼Œç„¶åå°†ç‰¹å¾é€šè¿‡one-hotç¼–ç åä½œä¸ºæ–°çš„æ¨¡å‹è¾“å…¥LRè¿›è¡Œè®­ç»ƒã€‚<a href="http://scikit-learn.org/stable/auto_examples/ensemble/plot_feature_transformation.html#example-ensemble-plot-feature-transformation-py" target="_blank" rel="external">feature trainsformation with ensembles of treeå®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="æœ¬èµ›é¢˜ç‰¹å¾æ„é€ ">5.3. æœ¬èµ›é¢˜ç‰¹å¾æ„é€ </h2><p><a href="https://github.com/z564808896/Tencent_Social_Ads" target="_blank" rel="external">ç«Ÿç„¶æœ‰è¿™ç§æ“ä½œé˜Ÿåˆ†äº«</a>æ€»ç»“å¾—éå¸¸å¥½ï¼Œä¸»è¦ç‰¹å¾æ˜¯åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p>
<ul>
<li>Trickç‰¹å¾ï¼š<br>é€šè¿‡è§‚å¯ŸåŸå§‹æ•°æ®æ˜¯ä¸éš¾å‘ç°çš„,æœ‰å¾ˆå¤šåªæœ‰clickTimeå’Œlabelä¸ä¸€æ ·çš„é‡å¤æ•°æ®ï¼ŒæŒ‰æ—¶é—´æ’åºå‘ç°é‡å¤æ•°æ®å¦‚æœè½¬åŒ–ï¼Œlabelä¸€èˆ¬æ ‡åœ¨å¤´æˆ–å°¾ï¼Œå°‘éƒ¨åˆ†åœ¨ä¸­é—´ï¼Œåœ¨è®­ç»ƒé›†ä¸Šå‡ºç°çš„æƒ…å†µåœ¨æµ‹è¯•é›†ä¸Šä¹Ÿä¼šå‡ºç°ï¼Œæ‰€ä»¥æ ‡è®°è¿™äº›ä½ç½®åonehotï¼Œè®©æ¨¡å‹å»å­¦ä¹ ï¼Œå†å°±æ˜¯æ—¶é—´å·®ç‰¹å¾ï¼Œå…³äºtrickæˆ‘æ¯”èµ›åˆ†äº«çš„è¿™ç¯‡æ–‡ç« æœ‰è¾ƒè¯¦ç»†çš„è¯´æ˜ã€‚æ¯”èµ›åæœŸå‘ç°äº†å‡ ä¸ªå’Œè¿™ä¸ªtrickç›¸ç±»ä¼¼çš„æ–‡ç« 1å’Œæ–‡ç« 2ï¼Œå¯ä»¥å‚è€ƒã€‚</li>
<li><p>ç»Ÿè®¡ç‰¹å¾ï¼š<br>åŸå§‹ç‰¹å¾ä¸»è¦ä¸‰å¤§ç±»ï¼šå¹¿å‘Šç‰¹å¾ã€ç”¨æˆ·ç‰¹å¾ã€ä½ç½®ç‰¹å¾ï¼Œé€šè¿‡äº¤å‰ç»„åˆç®—ç»Ÿè®¡æ„é€ ç‰¹å¾ï¼Œç”±äºæœºå™¨é™åˆ¶ï¼Œç»Ÿè®¡ç‰¹å¾ä¸»è¦ä½¿ç”¨äº†è½¬åŒ–ç‡ï¼Œä¸¢æ‰äº†ç‚¹å‡»æ¬¡æ•°å’Œè½¬åŒ–æ¬¡æ•°ã€‚åˆèµ›åˆ©ç”¨äº†7å¤©æ»‘çª—æ„é€ ï¼Œå†³èµ›é‡‡ç”¨äº†å‘¨å† å†›åˆ†äº«çš„clickTimeä¹‹å‰æ‰€æœ‰å¤©ç®—ç»Ÿè®¡ã€‚ä¸‰ç»„åˆç‰¹å¾ä¹Ÿæ¥è‡ªå‘¨å† å†›åˆ†äº«çš„ä¸‹è½½è¡Œä¸ºå’Œç½‘ç»œæ¡ä»¶é™åˆ¶ï¼Œä»¥åŠç”¨æˆ·å±æ€§å¯¹appéœ€æ±‚æŒ–æ˜å‡ºã€‚è´å¶æ–¯å¹³æ»‘userç›¸å…³çš„ç‰¹å¾ç‰¹åˆ«åºŸæ—¶é—´ï¼Œåˆèµ›åšè¿‡æ ¹æ®ç‚¹å‡»æ¬¡æ•°é˜ˆå€¼æ¥æ“ä½œè½¬åŒ–ç‡ï¼Œæ•ˆæœå’Œå¹³æ»‘å·®ä¸å¤šä½†æ˜¯é˜ˆå€¼é€‰æ‹©ä¸å¤ªå‡†ã€‚</p>
</li>
<li><p>æ´»è·ƒæ•°ç‰¹å¾ï¼š</p>
</li>
<li><p>ç‰¹å¾æ„é€ çµæ„Ÿæ¥è‡ªè¿™é‡Œ,æ¯”å¦‚æŸä¸ªå¹¿å‘Šä½çš„appç§æ•°ã€‚</p>
</li>
<li><p>å‡å€¼ç‰¹å¾ï¼š</p>
</li>
<li><p>æ¯”å¦‚ç‚¹å‡»æŸå¹¿å‘Šçš„ç”¨æˆ·å¹³å‡å¹´é¾„</p>
</li>
<li><p>å¹³å‡å›æµæ—¶é—´ç‰¹å¾ï¼š<br>åˆ©ç”¨å›æµæ—¶é—´æ–¹å¼ä¸å¯¹çš„è¯å¾ˆå®¹æ˜“é€ æˆleackageï¼Œè¿™é‡Œå‚è€ƒäº†å®˜æ–¹ç¾¤é‡Œçš„åˆ†äº«ï¼Œè®¡ç®—äº†æ¯ä¸ªappIDçš„å¹³å‡å›æµæ—¶é—´ï¼Œæ²¡æœ‰å›æµçš„appç”¨å…¶æ‰€åœ¨ç±»çš„å¹³å‡å›æµæ—¶é—´ä»£æ›¿</p>
</li>
<li><p>ç”¨æˆ·æµæ°´å’Œå†å²ç‰¹å¾ï¼š<br>åˆ©ç”¨installedæ–‡ä»¶å…³è”userå’Œappè·å¾—å†å²ç»Ÿè®¡ç‰¹å¾ï¼Œåˆ©ç”¨actionsè¿›è¡Œ7å¤©æ»‘åŠ¨çª—å£è·å¾—ç”¨æˆ·å’Œappæµæ°´ç‰¹å¾ã€‚</p>
</li>
</ul>
<h2 id="ä¸€äº›ç‰¹æ®Šçš„ä¸œè¥¿">5.4. ä¸€äº›ç‰¹æ®Šçš„ä¸œè¥¿</h2><p><strong>å¤šçº¿ç¨‹æŠ½ç‰¹å¾</strong></p>
<p>å†³èµ›æ•°æ®é›†å¤ªå¤§ï¼Œè€Œæˆ‘ä»¬ç»„åˆç‰¹å¾éå¸¸å¤šã€‚å› æ­¤æˆ‘ä»¬é‡‡ç”¨äº†å¤šçº¿ç¨‹æŠ½ç‰¹å¾çš„æ–¹å¼ã€‚<br>ä»£ç è§<a href="https://github.com/zsyandjyhouse/TencentAD_contest" target="_blank" rel="external">TencentAD_contest</a>ï¼Œextra_rate_thread_0623.py<br><strong>è´å¶æ–¯å¹³æ»‘</strong><br>åœ¨å†³èµ›æ—¶ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†è´å¶æ–¯å¹³æ»‘ã€‚é’ˆå¯¹Pandasï¼Œæˆ‘ä»¬å¯¹ç½‘ä¸Šå·²æœ‰çš„ä»£ç è¿›è¡Œäº†æ”¹è¿›ã€‚<br><a href="https://jiayi797.github.io/2017/07/09/%E8%BD%AC%E5%8C%96%E7%8E%87%E9%A2%84%E4%BC%B0%E4%B9%8B%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%B9%B3%E6%BB%91/">è´å¶æ–¯å¹³æ»‘ç¬”è®°</a><br><strong>word embedding</strong><br>è¿™ä¸ªæˆ‘æ²¡æœ‰åšè¿‡å¤šç ”ç©¶ï¼Œè¿™é‡Œæ˜¯<a href="https://jiayi797.github.io/2017/06/21/word-embedding/">word embeddingç¬”è®°</a><br><strong>SVDåˆ†è§£</strong><br>æ€è·¯å’Œä»£ç ä¸»è¦çœ‹æˆ‘è¿™ç¯‡åšå®¢<a href="https://jiayi797.github.io/2017/07/10/SVD%E5%88%86%E8%A7%A3/">SVDåˆ†è§£</a></p>
<h1 id="è®­ç»ƒé›†æ„é€ ">6. è®­ç»ƒé›†æ„é€ </h1><p>è®­ç»ƒé›†ç‰¹å¾åšä¸å¥½ï¼Œå°±å¾ˆå®¹æ˜“é€ æˆæ³„éœ²ã€‚è¿™æ˜¯æˆ‘è¯•è¿‡çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>ç”¨æ»‘åŠ¨çª—å£ï¼Œå³æ¯å¤©çš„å‰ä¸ƒå¤©çš„ç»Ÿè®¡ï¼ˆç»Ÿè®¡æŒ‡ç»Ÿè®¡è½¬åŒ–é‡ã€ç‚¹å‡»é‡ã€è½¬åŒ–ç‡ï¼Œä¸‹åŒï¼‰æ¥ä½œä¸ºç¬¬æœ¬å¤©çš„ç‰¹å¾ã€‚å¹¶æ‹¿30å·æ¥åšçº¿ä¸‹æµ‹è¯•é›†ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-06-07-21-49-53.png" alt=""><br>ç»æµ‹è¯•æˆ‘ä»¬å‘ç°ï¼Œå³ä½¿æˆ‘ä»¬å»æ‰äº†30å·çš„éƒ¨åˆ†è´Ÿæ ·æœ¬ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ã€‚å› æ­¤æˆ‘ä»¬å°†æ—¶é—´åŒºé—´æ”¹äº†ä¸€ä¸‹ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-06-07-21-53-21.png" alt=""><br>è¿™æ ·åšå‡ºäºä¸¤ç§ç›®çš„ï¼šä¸€æ˜¯å°½é‡åšåˆ°äº†çº¿ä¸Šçº¿ä¸‹ç»Ÿä¸€ï¼ŒäºŒæ˜¯ä¸è®©æ¨¡å‹å­¦ä¹ 30å·çš„æ ·æœ¬æ•°æ®ï¼Œé˜²æ­¢ä¸€äº›é”™è¯¯æ ·æœ¬è¢«æ¨¡å‹å­¦åˆ°ã€‚</li>
<li>ç”¨ç¬¬ä¸€å‘¨ç»Ÿè®¡ï¼Œç¬¬äºŒå‘¨åšäº¤å‰éªŒè¯å¹¶è®­ç»ƒæ¨¡å‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-06-07-21-59-59.png" alt=""> </li>
</ol>
<p>ç›¸ä¿¡å¾ˆå¤šäººéƒ½ç”¨çš„æ˜¯è¿™ä¸¤ç§å…¶ä¸­çš„ä¸€ç§ã€‚æˆ‘æ˜¯ä¸€ä¸ªå¯¹è‡ªå·±æåº¦ä¸è‡ªä¿¡çš„äººï¼Œæ¥æ¥å›å›æ¢äº†å¥½å‡ æ¬¡ã€‚æœ€ç»ˆè§‰å¾—ç¬¬2ç§æ–¹å¼å¾ˆç¨³å®šï¼Œçº¿ä¸Šçº¿ä¸‹è¾ƒç»Ÿä¸€ã€‚ç¬¬1ç§æ–¹å¼ç‰¹å¾æ›´æ–°è¾ƒå¿«ï¼Œæ¨¡å‹æ›´å‡†ç¡®ï¼Œä½†å¸¦æ¥çš„é—®é¢˜å°±æ˜¯çº¿ä¸Šçº¿ä¸‹ä¸å¤ªç»Ÿä¸€ã€‚</p>
<h1 id="æ¨¡å‹è®­ç»ƒå’ŒéªŒè¯">7. æ¨¡å‹è®­ç»ƒå’ŒéªŒè¯</h1><p>è‡³æ­¤ç‰¹å¾å·¥ç¨‹å·²ç»å®Œæ¯•ï¼Œå¼€å§‹è®­ç»ƒã€‚</p>
<p>è®­ç»ƒå…¶å®æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåªè¦æ³¨æ„ä¸€ä¸‹åˆ«è¿‡æ‹Ÿåˆå°±å¯ä»¥ã€‚</p>
<p>åˆèµ›æˆ‘ä»¬é‡‡ç”¨çš„xgboostï¼Œå†³èµ›ç”¨çš„lightgbmã€‚å…¶å®éƒ½æ˜¯å¯¹GBDTçš„å®ç°ï¼Œä¸¤è€…éƒ½å¾ˆå¥½ï¼Œä½†lightGBMæ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå®ƒåªå¯¹éƒ¨åˆ†èŠ‚ç‚¹è¿›è¡Œç”Ÿé•¿ã€‚</p>
<h2 id="stacking">7.1. stacking</h2><p>åœ¨åˆèµ›çš„æ—¶å€™å¬åˆ°æœ€å¤šçš„å°±æ˜¯stackingé­”æ³•äº†ã€‚æ–‡ç« <a href="https://www.qcloud.com/community/article/895055" target="_blank" rel="external">ã€SPAå¤§èµ›ã€‘è…¾è®¯å¹¿å‘Šç‚¹å‡»å¤§èµ›ï¼šå¯¹stackingçš„ä¸€äº›åŸºæœ¬ä»‹ç»</a>éå¸¸è¯¦ç»†åœ°ä»‹ç»äº†stackingå¤§æ³•ã€‚æˆ‘è§‰å¾—è¿™å¥è¯å¾ˆå¥½ï¼šâ€œåœ¨æˆ‘çœ‹æ¥stackingä¸¥æ ¼æ¥è¯´ä¸èƒ½ç§°ä¸ºä¸€ç§ç®—æ³•ï¼Œæˆ‘ç†è§£çš„æ˜¯ä¸€ç§éå¸¸ç²¾ç¾è€Œå¤æ‚çš„å¯¹æ¨¡å‹çš„é›†æˆç­–ç•¥ã€‚â€</p>
<h1 id="æ€»ç»“">8. æ€»ç»“</h1><p>å¹³æ—¶åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œè¿‡äºæ³¨é‡ç†è®ºçš„æ¨å¯¼ï¼Œåªæ˜¯åœ¨ä¸€ééåœ°çœ‹é‚£äº›å…¬å¼ã€‚ä½†æ²¡æœ‰åˆ‡èº«å®è·µè¿‡ï¼Œæ„Ÿå—ä¸åˆ°æ¨¡å‹çœŸæ­£çš„å¨åŠ›å’Œç¼ºæ†¾ã€‚é€šè¿‡è¿™æ¬¡æ¯”èµ›ï¼Œè¿˜æ˜¯æ”¶è·æ¯”è¾ƒå¤šçš„ã€‚æ³¨æ„åˆ°äº†å¹³æ—¶å­¦ä¹ è¿‡ç¨‹ä¸­è‡ªä»¥ä¸ºä¸é‡è¦çš„ã€å¾ˆå®¹æ˜“è¢«å¿½ç•¥çš„ç»†èŠ‚ã€‚</p>
<p>åœ¨åˆèµ›ä¸­ï¼Œæˆ‘ä»¬å…¶å®å¹¶æ²¡æœ‰æ³¨é‡æ¨¡å‹çš„è°ƒå‚ç­‰ï¼Œè€Œæ˜¯ä¸€ç›´åœ¨åšç‰¹å¾å·¥ç¨‹ã€‚å…¶å®æˆ‘åˆæœŸä¹Ÿä¸çŸ¥é“ç©¶ç«Ÿè¯¥æ€ä¹ˆåŠã€‚ä½†JerryLinå¤§ç¥ç”¨ä»–çš„è¨€è¡Œæ•™ä¼šæˆ‘ï¼Œç‰¹å¾å†³å®šäº†ç»“æœçš„ä¸Šé™ï¼Œè€Œæ¨¡å‹åªæ˜¯åœ¨ä¸æ–­åœ°é€¼è¿‘è¿™ä¸ªä¸Šé™è€Œå·²ã€‚åªæœ‰å¾—åˆ°äº†å¥½çš„ç‰¹å¾ï¼Œæ‰ä¼šæ‹¿åˆ°å¥½çš„æ¨¡å‹ã€‚</p>
<p>åšäº†è¿™ä¹ˆä¹…çš„ç‰¹å¾å·¥ç¨‹ï¼Œæœ€å¤§çš„æ„Ÿæƒ³å°±æ˜¯ï¼Œåªæœ‰è®¤è®¤çœŸçœŸã€è¸è¸å®å®åˆ†ææ•°æ®ï¼Œæ‰èƒ½å¾—åˆ°å¥½çš„ç‰¹å¾ã€‚è¿‡åº¦ä¾èµ–ç®—æ³•åœ¨å·¥ä¸šä¸Šæ˜¯ä¸å¯é çš„ã€‚</p>
<p>è¶Šæ¥è¶Šå‘ç°åŠ¡å®åŸºç¡€çš„å¿…è¦æ€§ã€‚æ¯”å¦‚LRä¸­ä¸ºä»€ä¹ˆè¦é‡‡ç”¨æ­£åˆ™åŒ–é¡¹ï¼Œä¸ºä»€ä¹ˆGBDTèƒ½æœ‰ç­›ç‰¹å¾çš„åŠŸæ•ˆï¼Œä¸ºä»€ä¹ˆæ ‘æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆâ€¦â€¦è¿™äº›ä¸ºä»€ä¹ˆç›´æ¥å†³å®šäº†åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™èƒ½ä¸èƒ½ç‹¬ç«‹è§£å†³ã€‚è€Œä¸èƒ½åƒæˆ‘ç°åœ¨ä¸€æ ·ï¼Œåˆ†åˆ†é’Ÿå¿ƒæ€çˆ†ç‚¸ï¼Œå®›å¦‚ä¸€åªæ— å¤´çš„è‹è‡ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯ï¼Œå†™ä»£ç ä¸€å®šè¦è®¤è®¤çœŸçœŸåœ°å†™ã€‚ä¸èƒ½ç›´æ¥æŠŠåˆ«äººçš„ç›´æ¥ç²˜è¿‡æ¥ç”¨ï¼Œè¿™æ ·æ˜¯æå…¶ä¸è´Ÿè´£çš„ï¼Œä¹Ÿéå¸¸å®¹æ˜“å‡ºé”™ã€‚åœ¨æ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘çš„xgboosté¢„æµ‹çš„ä»£ç æ˜¯ç›´æ¥ç²˜è´´çš„O2Oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹çš„å† å†›çš„ä»£ç ï¼Œä½†ä»–é‚£ä¸ªçš„ç›®æ ‡æ˜¯aucï¼Œå› æ­¤ä»–å°†ç»“æœæ˜ å°„åˆ°äº†ï¼ˆ0,1ï¼‰åŒºé—´ä¸Šã€‚è¿™å¥è¯è®©æˆ‘ç™½ç™½æµªè´¹äº†å¾ˆä¹…å¾ˆä¹…çš„æ—¶é—´å»è¯•ç‰¹å¾ï¼Œç»“æœå‘ç°çº¿ä¸Šçº¿ä¸‹ä¸ç»Ÿä¸€ï¼Œæ•´ä¸ªäººç›´æ¥å´©æºƒã€‚</p>
<p>å¸Œæœ›è‡ªå·±åœ¨æœªæ¥çš„æ—¥å­é‡Œï¼Œèƒ½å°†å‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹å’Œæèˆªè€å¸ˆçš„ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹è¿™ä¸¤æœ¬ä¹¦åƒé€ï¼Œè€Œä¸æ˜¯åƒç°åœ¨è¿™æ ·ï¼Œç‹—ç†Šæ°æ£’å­ã€‚</p>
<p>å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ã€‚</p>
<p>å¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯ã€‚</p>
<h1 id="é¡¹ç›®ä»£ç ">9. é¡¹ç›®ä»£ç </h1><p><a href="https://github.com/zsyandjyhouse/TencentAD_contest" target="_blank" rel="external">TencentAD_contest</a></p>
<h1 id="å‚è€ƒæ–‡çŒ®">10. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/26820998" target="_blank" rel="external">Kaggle æ•°æ®æŒ–æ˜æ¯”èµ›ç»éªŒåˆ†äº«</a></li>
<li><a href="http://blog.csdn.net/yang090510118/article/details/39478033" target="_blank" rel="external">é€»è¾‘å›å½’LRçš„ç‰¹å¾ä¸ºä»€ä¹ˆè¦å…ˆç¦»æ•£åŒ–</a></li>
<li><a href="http://breezedeus.github.io/2014/11/20/breezedeus-feature-hashing.html" target="_blank" rel="external">ç‰¹å¾å“ˆå¸Œï¼ˆFeature Hashingï¼‰</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/26945814" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¸­çš„ç»´åº¦ç¾éš¾</a></li>
<li><a href="http://blog.jasonding.top/2015/11/12/Feature%20Engineering/%E3%80%90%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%E3%80%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9%E4%B8%8E%E7%89%B9%E5%BE%81%E5%AD%A6%E4%B9%A0/" target="_blank" rel="external">ã€ç‰¹å¾å·¥ç¨‹ã€‘ç‰¹å¾é€‰æ‹©ä¸ç‰¹å¾å­¦ä¹ </a></li>
<li><a href="http://202.197.191.206:8080/30/text/chapter04/4_8.htm" target="_blank" rel="external">æè¿°é‡é€‰æ‹©åŠç‰¹å¾çš„ç»„åˆä¼˜åŒ–</a></li>
<li><a href="http://www.jianshu.com/p/8f6f94f1d275" target="_blank" rel="external">scikit-learnç³»åˆ—ä¹‹ç‰¹å¾é€‰æ‹©</a></li>
<li><a href="http://blog.csdn.net/shine19930820/article/details/71713680" target="_blank" rel="external">GBDTåŸç†åŠåˆ©ç”¨GBDTæ„é€ æ–°çš„ç‰¹å¾-Pythonå®ç°</a></li>
<li><a href="http://www.bigbear2017.com/blog/2016/11/02/facebook-ctr-paper/" target="_blank" rel="external">å¾ˆå¥½çš„æ–‡çŒ®èµ„æ–™Facebook CTR Paper</a></li>
<li><a href="https://github.com/z564808896/Tencent_Social_Ads" target="_blank" rel="external">ç«Ÿç„¶æœ‰è¿™ç§æ“ä½œé˜Ÿåˆ†äº«</a></li>
<li><a href="https://www.qcloud.com/community/article/895055" target="_blank" rel="external">ã€SPAå¤§èµ›ã€‘è…¾è®¯å¹¿å‘Šç‚¹å‡»å¤§èµ›ï¼šå¯¹stackingçš„ä¸€äº›åŸºæœ¬ä»‹ç»</a></li>
<li><a href="http://blog.csdn.net/ben3ben/article/details/74838338" target="_blank" rel="external">ç¬¬ä¸ƒå</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> è…¾è®¯ç®—æ³•å¤§èµ›-CVRé¢„ä¼° </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç‰¹å¾é€‰æ‹©ä¸æ­£åˆ™åŒ–]]></title>
      <url>/2017/05/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9%E4%B8%8E%E6%AD%A3%E5%88%99%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>ç‰¹å¾é€‰æ‹©ï¼šå¾ˆé‡è¦</p>
<p><strong>tip:å†—ä½™ç‰¹å¾(redundant feature)</strong>ï¼š</p>
<ul>
<li>æœ¬ç‰¹å¾èƒ½è¢«å…¶å®ƒç‰¹å¾ä¸­æ¨æ¼”å‡ºæ¥ã€‚å®ƒä¸ä¸€å®šæœ‰åå¤„ï¼Œä½†ä¹Ÿä¸ä¸€å®šæœ‰å¥½å¤„ã€‚ä¾‹å¦‚ï¼šè€ƒè™‘ç«‹æ–¹ä½“å¯¹è±¡ï¼Œè‹¥å·²æœ‰ç‰¹å¾â€œé•¿â€ã€â€œå®½â€ï¼Œåˆ™â€œåº•é¢ç§¯â€æ˜¯å†—ä½™ç‰¹å¾ã€‚</li>
<li>å†—ä½™ç‰¹å¾åœ¨å¾ˆå¤šæ—¶å€™ä¸èµ·ä½œç”¨ï¼Œä¼šå¢åŠ å­¦ä¹ è¿‡ç¨‹çš„è´Ÿæ‹…ã€‚</li>
<li>ä½†å¦‚æœå­¦ä¹ ç›®æ ‡æ˜¯ä¼°ç®—ç«‹æ–¹ä½“ä½“ç§¯ï¼Œåˆ™â€œåº•é¢ç§¯â€ç‰¹å¾ä¼šå¯¹å­¦ä¹ æ›´å¥½ã€‚</li>
</ul>
<p>ç»“è®ºï¼šå¦‚æœæŸå†—ä½™ç‰¹å¾æ°å¥½å¯¹åº”å®Œæˆå­¦ä¹ ä»»åŠ¡æ‰€éœ€çš„â€œä¸­é—´æ¦‚å¿µâ€ï¼Œåˆ™è¯¥å†—ä½™ç‰¹å¾æ˜¯æœ‰ç›Šçš„ã€‚</p>
<h1 id="å­é›†æœç´¢ä¸è¯„ä»·">1. å­é›†æœç´¢ä¸è¯„ä»·</h1><p>ç‰¹å¾é€‰å–æ—¶ï¼Œè‹¥æ²¡æœ‰ä»»ä½•é¢†åŸŸçŸ¥è¯†è¿›è¡Œå…ˆéªŒå‡è®¾ï¼Œåªèƒ½éå†æ‰€æœ‰å¯èƒ½å­é›†ã€‚â€“&gt;ä¸å¯å–ï¼</p>
<p><strong>å¯è¡Œåšæ³•</strong>:<br>äº§ç”Ÿä¸ªâ€œå€™é€‰å­é›†â€ï¼Œè¯„ä»·å®ƒçš„å¥½åï¼ŒåŸºäºè¯„ä»·ç»“æœäº§ç”Ÿä¸‹ä¸€ä¸ªå€™é€‰å­é›†ã€‚</p>
<h2 id="é—®é¢˜ä¸€ï¼Œå¦‚ä½•è¯„ä»·ç»“æœè·å–ä¸‹ä¸€ä¸ªå€™é€‰ç‰¹å¾å­é›†ï¼Ÿ">1.1. é—®é¢˜ä¸€ï¼Œå¦‚ä½•è¯„ä»·ç»“æœè·å–ä¸‹ä¸€ä¸ªå€™é€‰ç‰¹å¾å­é›†ï¼Ÿ</h2><p><strong>å­é›†æœç´¢</strong></p>
<ol>
<li>å‰å‘æœç´¢</li>
</ol>
<ul>
<li>ç»™å®šç‰¹å¾é›†åˆ${a_1,a_2,â€¦,a_d}$,å°†æ¯ä¸ªç‰¹å¾çœ‹åšä¸€ä¸ªå€™é€‰å­é›†ã€‚å¯¹dä¸ªå€™é€‰å•ç‰¹å¾å­é›†è¿›è¡Œè¯„ä»·ï¼Œå‡å®š${a_2}$æœ€ä¼˜ï¼Œå°†${a_2}$åšä¸ºç¬¬ä¸€è½®é€‰å®šé›†ï¼›</li>
<li>åŠ å…¥ä¸€ä¸ªæ–°ç‰¹å¾ï¼Œæ„æˆåŒ…å«ä¸¤ä¸ªç‰¹å¾çš„å€™é€‰å­é›†ï¼Œå‡å®šåœ¨è¿™$d-1$ä¸ªå€™é€‰ä¸¤ç‰¹å¾å­é›†ä¸­${a_2,a_4}$æœ€ä¼˜ï¼Œåˆ™å°†${a_2,a_4}$ä½œä¸ºæœ¬è½®é€‰å®šé›†ï¼›</li>
<li>â€¦</li>
<li>k+1è½®æ—¶ï¼Œä¸å†æ›´å¥½ï¼Œåœæ­¢è¿­ä»£</li>
</ul>
<ol>
<li>åå‘æœç´¢<br>æ¯æ¬¡éƒ½åˆ é™¤æ‰ä¸€ä¸ªç‰¹å¾</li>
</ol>
<h2 id="é—®é¢˜äºŒï¼Œå¦‚ä½•è¯„ä»·å€™é€‰ç‰¹å¾å­é›†ï¼Ÿ">1.2. é—®é¢˜äºŒï¼Œå¦‚ä½•è¯„ä»·å€™é€‰ç‰¹å¾å­é›†ï¼Ÿ</h2><p><strong>ä¿¡æ¯å¢ç›Š</strong></p>
<ul>
<li>ç»™å®šæ•°æ®é›†$D$,å‡å®š$D$ä¸­ç¬¬$i$ç±»æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ä¸º$p_i(i=1,2,â€¦,|Y|)$.</li>
<li>å‡å®šæ‰€æœ‰æ ·æœ¬å±æ€§å‡ä¸ºç¦»æ•£å‹</li>
<li>å¯¹å±æ€§å­é›†$A$,å‡å®šæ ¹æ®å…¶å–å€¼å°†$D$åˆ†æˆäº†$V$ä¸ªå­é›†${D^1,D^2,â€¦,D^V}$,æ¯ä¸ªå­é›†ä¸­çš„æ ·æœ¬åœ¨Aä¸Šå–å€¼ç›¸åŒï¼Œåˆ™å±æ€§å­é›†$A$çš„ä¿¡æ¯å¢ç›Šä¸ºï¼š</li>
</ul>
<p>$$Gain(A)=Ent(D)-\sum_{v=1}^V\frac{|D^v|}{|D|}Ent(D^v)$$</p>
<p>å…¶ä¸­ä¿¡æ¯ç†µå®šä¹‰ä¸ºï¼š</p>
<p>$$Ent(D)=-\sum_{k=1}^{|y|}p_klog_2p_k$$</p>
<p>ä¿¡æ¯å¢ç›Š$Gain(A)$è¶Šå¤§ï¼Œç‰¹å¾å­é›†AåŒ…å«çš„æœ‰åŠ©äºåˆ†ç±»çš„ä¿¡æ¯è¶Šå¤šã€‚</p>
<h2 id="æ€»ç»“">1.3. æ€»ç»“</h2><p>ç‰¹å¾é€‰æ‹©æ–¹æ³•=å­é›†æœç´¢+å­é›†è¯„ä»·</p>
<p>å¸¸è§ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼š</p>
<ul>
<li>è¿‡æ»¤å¼(filter)</li>
<li>åŒ…è£¹å¼(wrapper)</li>
<li>åµŒå…¥å¼(embedding)</li>
</ul>
<h1 id="è¿‡æ»¤å¼é€‰æ‹©-filter">2. è¿‡æ»¤å¼é€‰æ‹©(filter)</h1><p>æ¦‚å¿µï¼šå…ˆç‰¹å¾é€‰æ‹©ï¼Œå†è®­ç»ƒæ¨¡å‹</p>
<p>ç‰¹ç‚¹ï¼šç‰¹å¾é€‰æ‹©ä¸æ¨¡å‹å­¦ä¹ æ— å…³</p>
<p>===æ¥æ—¥å¡«å‘===</p>
<h1 id="åŒ…è£¹å¼é€‰æ‹©">3. åŒ…è£¹å¼é€‰æ‹©</h1><p>æ¦‚å¿µï¼šæŠŠæœ€ç»ˆå°†è¦ä½¿ç”¨çš„å­¦ä¹ å™¨çš„æ€§èƒ½ä½œä¸ºç‰¹å¾å­é›†çš„è¯„ä»·å‡†åˆ™</p>
<p>ç‰¹ç‚¹ï¼šéœ€è¦å¤šæ¬¡è®­ç»ƒå­¦ä¹ å™¨</p>
<p>===æ¥æ—¥å¡«å‘===</p>
<h1 id="åµŒå…¥å¼é€‰æ‹©ä¸L1æ­£åˆ™åŒ–">4. åµŒå…¥å¼é€‰æ‹©ä¸L1æ­£åˆ™åŒ–</h1><p>æ¦‚å¿µï¼šå°†ç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸å­¦ä¹ å™¨è®­ç»ƒè¿‡ç¨‹èä¸ºä¸€ä½“ï¼Œä¸¤è€…åœ¨åŒä¸€ä¸ªä¼˜åŒ–è¿‡ç¨‹ä¸­å®Œæˆ</p>
<p>ç»™å®šæ•°æ®é›†$D={(x_1,y_1),(x_2,y_2),â€¦(x_m,y_m)}$,å…¶ä¸­$x\in R^d,y\in R$.</p>
<p>è€ƒè™‘æœ€ç®€å•çš„çº¿æ€§å›å½’ï¼Œä»¥å¹³æ–¹è¯¯å·®ä¸ºæŸå¤±å‡½æ•°ï¼Œåˆ™ä¼˜åŒ–ç›®æ ‡ä¸ºï¼š</p>
<p>$$min_w\sum_{i=1}^m(y_i-w^Tx_i)^2$$</p>
<p>å½“æ ·æœ¬ç‰¹å¾å¾ˆå¤šï¼Œè€Œæ ·æœ¬æ•°è¾ƒå°‘æ—¶ï¼Œä¸Šå¼å¾ˆå®¹æ˜“é™·å…¥è¿‡æ‹Ÿåˆã€‚è§£å†³æ–¹æ¡ˆï¼Œæ­£åˆ™åŒ–é¡¹ã€‚</p>
<p>$L_2$èŒƒæ•°æ­£åˆ™åŒ–ï¼ˆâ€œå²­å›å½’â€(redge regression)ï¼‰ï¼š</p>
<p>$$min_w\sum_{i=1}^m(y_i-w^Tx_i)^2+\lambda ||w||_2^2$$</p>
<p>$L_1$èŒƒæ•°æ­£åˆ™åŒ–ï¼š</p>
<p>$$min_w\sum_{i=1}^m(y_i-w^Tx_i)^2+\lambda ||w||_1$$</p>
<p>åŒºåˆ«ï¼š$L_2$æ¯”$L_1$æ›´å®¹æ˜“è·å¾—â€œç¨€ç–â€(sparse)è§£ï¼Œå³å®ƒæ±‚å¾—çš„$w$ä¼šæœ‰æ›´å°‘çš„éé›¶åˆ†é‡ã€‚<br>ï¼ˆè¿™é‡Œä¸€å®šè¦çœ‹ä¸€ä¸‹è¥¿ç“œä¹¦-253é¡µçš„è§£é‡Šï¼‰</p>
<h2 id="æ­£åˆ™åŒ–çš„ç†è§£">4.1. æ­£åˆ™åŒ–çš„ç†è§£</h2><p>ä»¥ä»¥ä¸‹çš„æ‹Ÿåˆä¸ºä¾‹ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-30-18-21-29.png" alt=""> </p>
<p>åœ¨å›¾äºŒä¸­ï¼Œæ˜æ˜¾æ˜¯å› ä¸ºé«˜æ¬¡é¡¹çš„ç³»æ•°$\theta_3,\theta_4$è¿‡å¤§é€ æˆçš„ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬åŠ å…¥æ­£åˆ™åŒ–é¡¹ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-30-18-24-26.png" alt=""> </p>
<p>å³ç»™ç›®æ ‡å‡½æ•°åŠ ä¸€ç‚¹ä¸œè¥¿ã€‚</p>
<p>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬è¦æœ€å°åŒ–è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆä¸ºäº†æœ€å°åŒ–è¿™ä¸ªæ–°çš„ä»£ä»·å‡½æ•°ï¼Œæˆ‘ä»¬è¦è®©$Î¸3$å’Œ$Î¸4$å°½å¯èƒ½å°ã€‚å› ä¸ºï¼Œå¦‚æœä½ åœ¨åŸæœ‰ä»£ä»·å‡½æ•°çš„åŸºç¡€ä¸ŠåŠ ä¸Š1000ä¹˜ä»¥$Î¸3$è¿™ä¸€é¡¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°çš„ä»£ä»·å‡½æ•°å°†å˜å¾—å¾ˆå¤§ï¼Œ<strong>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬æœ€å°åŒ–è¿™ä¸ªæ–°çš„ä»£ä»·å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿$Î¸3$çš„å€¼æ¥è¿‘äº0ï¼ŒåŒæ ·$Î¸4$çš„å€¼ä¹Ÿæ¥è¿‘äº0ï¼Œ</strong>å°±åƒæˆ‘ä»¬å¿½ç•¥äº†è¿™ä¸¤ä¸ªå€¼ä¸€æ ·ã€‚å¦‚æœæˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ï¼ˆ$Î¸3$å’Œ$Î¸4$æ¥è¿‘0ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼çš„äºŒæ¬¡å‡½æ•°ã€‚</p>
<p>æ›´ä¸€èˆ¬åœ°ï¼š</p>
<p>$L_2$èŒƒæ•°æ­£åˆ™åŒ–ï¼š</p>
<p>$$min_w\sum_{i=1}^m(y_i-w^Tx_i)^2+\lambda ||w||_2^2 $$<br>$$= min_w\sum_{i=1}^m(y_i-w^Tx_i)^2+\lambda\sqrt{\sum_{n=1}^nw_i^2}$$</p>
<p>(å…¶ä¸­,mæ˜¯æ•°æ®ä¸ªæ•°ï¼Œnæ˜¯ç‰¹å¾ç»´åº¦)<br>å› æ­¤åœ¨æ­£åˆ™åŒ–é‡Œï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯æŠŠå‡å°æˆ‘ä»¬çš„ä»£ä»·å‡½æ•°ï¼ˆä¾‹å­ä¸­æ˜¯çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ï¼‰æ‰€æœ‰çš„å‚æ•°å€¼ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶ä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªæˆ–å“ªå‡ ä¸ªè¦å»ç¼©å°ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä»£ä»·å‡½æ•°ï¼Œåœ¨è¿™åé¢æ·»åŠ ä¸€é¡¹ï¼Œå°±åƒæˆ‘ä»¬åœ¨æ–¹æ‹¬å·é‡Œçš„è¿™é¡¹ã€‚å½“æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªé¢å¤–çš„æ­£åˆ™åŒ–é¡¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ”¶ç¼©äº†æ¯ä¸ªå‚æ•°ã€‚</p>
<p>$$ min_w\frac{1}{2m}[\sum_{i=1}^m(y_i-w^Tx_i)^2+\lambda\sqrt{\sum_{n=1}^nw_i^2}]$$</p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/jianxinzhou/p/4083921.html" target="_blank" rel="external">æœºå™¨å­¦ä¹ ä¹‹æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç‰¹å¾å·¥ç¨‹ </tag>
            
            <tag> æ­£åˆ™åŒ– </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java-Buffer]]></title>
      <url>/2017/05/22/Java-Buffer/</url>
      <content type="html"><![CDATA[<p><strong>å¼•è¨€</strong></p>
<p>è¯´åˆ°ç¼“å†²åŒºï¼Œä¸å¾—ä¸æJava NIOã€‚</p>
<p>Java NIO(New IO)æ˜¯ä¸€ä¸ªå¯ä»¥æ›¿ä»£æ ‡å‡†Java IO APIçš„IO APIï¼ˆä»Java 1.4å¼€å§‹)ï¼ŒJava NIOæä¾›äº†ä¸æ ‡å‡†IOä¸åŒçš„IOå·¥ä½œæ–¹å¼ã€‚</p>
<p>Java NIO: Channels and Buffersï¼ˆé€šé“å’Œç¼“å†²åŒºï¼‰</p>
<h1 id="ä»€ä¹ˆæ˜¯ç¼“å†²åŒº">1. ä»€ä¹ˆæ˜¯ç¼“å†²åŒº</h1><p><strong>Bufferå®šä¹‰</strong></p>
<p>ä»£ç çš„è§’åº¦æ¥è®²ï¼ˆå¯ä»¥æŸ¥çœ‹JDKä¸­Bufferã€ByteBufferã€DoubleBufferç­‰çš„æºç ï¼‰ï¼ŒBufferç±»å†…éƒ¨å…¶å®å°±æ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„æ•°ç»„ï¼Œä»¥åŠå¯¹è¿™ä¸ªç¼“å†²æ•°ç»„çš„å„ç§æ“ä½œï¼›</p>
<p>å¸¸è§çš„ç¼“å†²åŒºå¦‚ByteBufferã€IntBufferã€DoubleBufferâ€¦å†…éƒ¨å¯¹åº”çš„æ•°ç»„ä¾æ¬¡æ˜¯byteã€intã€doubleâ€¦</p>
<p><strong>Bufferä¸é€šé“çš„å…³ç³»</strong></p>
<p>æ ‡å‡†çš„IOåŸºäºå­—èŠ‚æµå’Œå­—ç¬¦æµè¿›è¡Œæ“ä½œçš„ï¼Œè€ŒNIOæ˜¯åŸºäºé€šé“ï¼ˆChannelï¼‰å’Œç¼“å†²åŒºï¼ˆBufferï¼‰è¿›è¡Œæ“ä½œï¼Œæ•°æ®æ€»æ˜¯<em>ä»é€šé“è¯»å–åˆ°ç¼“å†²åŒºä¸­</em>ï¼Œæˆ–è€…<em>ä»ç¼“å†²åŒºå†™å…¥åˆ°é€šé“ä¸­</em>ã€‚</p>
<p><strong>ç»§æ‰¿ç»“æ„</strong></p>
<p>ä»¥ByteBufferä¸ºä¾‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-22-20-31-24.png" alt=""> </p>
<p>Bufferæ˜¯é¡¶å±‚æŠ½è±¡ç±»ï¼ŒByteBufferç»§æ‰¿Bufferï¼Œä¹Ÿæ˜¯æŠ½è±¡ç±»ï¼ŒByteBufferæœ€å¸¸è§çš„ä¸¤ä¸ªå…·ä½“å®ç°ç±»å¦‚ä¸‹ï¼š</p>
<p>DirectByteBufferï¼ˆJVMå †å¤–éƒ¨ã€é€šè¿‡unsafe.allocateMemoryå®ç°ï¼‰ã€HeapByteBufferï¼ˆJVMå †ï¼‰</p>
<p><strong>ç¼“å†²åŒºç”¨é€”</strong></p>
<p>å†™ï¼Œç„¶åè¯»å‡º</p>
<h1 id="ç¼“å†²åŒºçš„å››ä¸ªå±æ€§">2. ç¼“å†²åŒºçš„å››ä¸ªå±æ€§</h1><ul>
<li><p>å®¹é‡(capacity)<br>capacityæŒ‡çš„æ˜¯ç¼“å†²åŒºèƒ½å¤Ÿå®¹çº³å…ƒç´ çš„æœ€å¤§æ•°é‡ï¼Œè¿™ä¸ªå€¼åœ¨ç¼“å†²åŒºåˆ›å»ºæ—¶è¢«è®¾å®šï¼Œè€Œä¸”ä¸èƒ½å¤Ÿæ”¹å˜ï¼Œå¦‚ä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæœ€å¤§å®¹é‡ä¸º10çš„å­—èŠ‚ç¼“å†²åŒºï¼›</p>
<pre><code>ByteBuffer bf = ByteBuffer.allocate(10);
</code></pre></li>
<li><p>ä¸Šç•Œï¼ˆlimitï¼‰<br>limitæŒ‡çš„æ˜¯ç¼“å†²åŒºä¸­ç¬¬ä¸€ä¸ªä¸èƒ½è¯»å†™çš„å…ƒç´ çš„æ•°ç»„ä¸‹æ ‡ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ç¼“å†²åŒºä¸­å®é™…å…ƒç´ çš„æ•°é‡ï¼›</p>
</li>
<li><p>ä½ç½®ï¼ˆpositionï¼‰<br>positionæŒ‡çš„æ˜¯ä¸‹ä¸€ä¸ªè¦è¢«è¯»å†™çš„å…ƒç´ çš„æ•°ç»„ä¸‹æ ‡ç´¢å¼•ï¼Œè¯¥å€¼ä¼šéšget()å’Œput()çš„è°ƒç”¨è‡ªåŠ¨æ›´æ–°ï¼›</p>
</li>
<li><p>æ ‡è®°ï¼ˆmarkï¼‰<br>ä¸€ä¸ªå¤‡å¿˜ä½ç½®ï¼Œè°ƒç”¨mark()æ–¹æ³•çš„è¯ï¼Œmarkå€¼å°†å­˜å‚¨å½“å‰positionçš„å€¼ï¼Œç­‰ä¸‹æ¬¡è°ƒç”¨reset()æ–¹æ³•æ—¶ï¼Œä¼šè®¾å®špositionçš„å€¼ä¸ºä¹‹å‰çš„æ ‡è®°å€¼ï¼›</p>
</li>
<li><p>å››ä¸ªå±æ€§å€¼ä¹‹é—´çš„å…³ç³»<br>æ ¹æ®ä»¥ä¸Šå››ä¸ªå±æ€§çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š<br>0 &lt;= mark &lt;= position &lt;= limit &lt;= capacity</p>
</li>
</ul>
<h1 id="ç¼“å†²åŒºè°ƒç”¨ä¸€èˆ¬æ­¥éª¤">3. ç¼“å†²åŒºè°ƒç”¨ä¸€èˆ¬æ­¥éª¤</h1><ol>
<li>å†™å…¥æ•°æ®åˆ° Buffer</li>
<li>è°ƒç”¨flip()æ–¹æ³•</li>
<li>ä» Buffer ä¸­get()æ•°æ®</li>
<li>è°ƒç”¨clear()æ–¹æ³•æˆ–è€…compact()æ–¹æ³•</li>
</ol>
<h1 id="å‚è€ƒæ–‡çŒ®">4. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/chenpi/p/6475510.html" target="_blank" rel="external">Java NIOä¸­çš„ç¼“å†²åŒºBufferï¼ˆä¸€ï¼‰ç¼“å†²åŒºåŸºç¡€</a></li>
<li>[Javaç¼–ç¨‹æ€æƒ³2]</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Buffer </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å†…å­˜æ˜ å°„æ–‡ä»¶]]></title>
      <url>/2017/05/21/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>å†…å­˜æ˜ å°„æ–‡ä»¶ï¼šåˆ©ç”¨è™šæ‹Ÿå†…å­˜å®ç°å°†æ–‡ä»¶â€œæ˜ å°„â€åˆ°å†…å­˜ä¸­ã€‚æ–‡ä»¶å¯¹åº”äºå†…å­˜ä¸­çš„ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œå¯¹æ–‡ä»¶çš„æ“ä½œå˜ä¸ºå¯¹è¿™ä¸ªå­—èŠ‚æ•°ç»„çš„æ“ä½œï¼Œè€Œå­—èŠ‚æ•°ç»„çš„æ“ä½œç›´æ¥æ˜ å°„åˆ°æ–‡ä»¶ä¸Šã€‚è¿™æ ·è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥å½“åšæ˜¯ä¸€ä¸ªå†…å­˜æ•°ç»„ä¸€æ ·çš„è®¿é—®ï¼Œè¿™æ¯”ä¼ ç»Ÿçš„æ–‡ä»¶æ“ä½œè¦å¿«å¾—å¤šã€‚</p>
<p>æ˜ å°„ï¼š<strong>ç¡¬ç›˜ä¸Šæ–‡ä»¶</strong>çš„ä½ç½®ä¸è¿›ç¨‹<strong>é€»è¾‘åœ°å€ç©ºé—´</strong>ä¸­ä¸€å—å¤§å°ç›¸åŒçš„åŒºåŸŸä¹‹é—´çš„ä¸€ä¸€å¯¹åº”</p>
<p>ä¸è¿‡ï¼Œè¿™ç§æ˜ å°„æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ä¸€ç§å‡è±¡ï¼Œæ–‡ä»¶ä¸€èˆ¬ä¸ä¼šé©¬ä¸ŠåŠ è½½åˆ°å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿåªæ˜¯è®°å½•ä¸‹äº†è¿™å›äº‹ï¼Œå½“å®é™…å‘ç”Ÿè¯»å†™æ—¶ï¼Œæ‰ä¼šæŒ‰éœ€åŠ è½½ã€‚</p>
<p>è¿™ç§æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œä½¿å¾—å†…å­˜æ˜ å°„æ–‡ä»¶å¯ä»¥æ–¹ä¾¿å¤„ç†éå¸¸å¤§çš„æ–‡ä»¶ï¼Œå†…å­˜æ”¾ä¸ä¸‹æ•´ä¸ªæ–‡ä»¶ä¹Ÿä¸è¦ç´§ï¼Œæ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ï¼Œå°†éœ€è¦çš„å†…å®¹è¯»åˆ°å†…å­˜ï¼Œå°†ä¿®æ”¹çš„å†…å®¹ä¿å­˜åˆ°ç¡¬ç›˜ï¼Œå°†ä¸å†ä½¿ç”¨çš„å†…å­˜é‡Šæ”¾ã€‚</p>
<p>å†…å­˜æ˜ å°„æ–‡ä»¶ä¹Ÿæœ‰å±€é™æ€§ï¼Œæ¯”å¦‚ï¼Œå®ƒä¸å¤ªé€‚åˆå¤„ç†å°æ–‡ä»¶ï¼Œå®ƒæ˜¯æŒ‰é¡µåˆ†é…å†…å­˜çš„ï¼Œå¯¹äºå°æ–‡ä»¶ï¼Œä¼šæµªè´¹ç©ºé—´ï¼Œå¦å¤–ï¼Œæ˜ å°„æ–‡ä»¶è¦æ¶ˆè€—ä¸€å®šçš„æ“ä½œç³»ç»Ÿèµ„æºï¼Œåˆå§‹åŒ–æ¯”è¾ƒæ…¢ã€‚</p>
<h1 id="javaä½¿ç”¨å†…å­˜æ˜ å°„">1. javaä½¿ç”¨å†…å­˜æ˜ å°„</h1><h2 id="æ­¥éª¤">1.1. æ­¥éª¤</h2><ul>
<li>å¼•å…¥java.nioåŒ…</li>
<li><p>ä»æ–‡ä»¶ä¸­è·å¾—ä¸€ä¸ªé€šé“(channel)ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FileChannel channel = FileChanne.open(path,options)</div></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡è°ƒç”¨FileChannelç±»çš„mapæ–¹æ³•ä»è¿™ä¸ªé€šé“ä¸­è·å¾—ä¸€ä¸ªByteBuffer,å®ƒä»£è¡¨å†…å­˜ä¸­çš„å­—èŠ‚æ•°ç»„ã€‚å…¶ä¸­ï¼Œæ˜ å°„æ–‡ä»¶åŒºåŸŸä¸æ˜ å°„æ¨¡å¼æ”¯æŒä¸‰ç§æ–¹å¼ï¼š</p>
<h2 id="â€“-FileChannel-MapMode-READ-ONLY-ç¼“å†²åŒºåªè¯»">1.2. â€“ FileChannel.MapMode.READ_ONLY:ç¼“å†²åŒºåªè¯»</h2><p>FileChannel.MapMode.READ_WRITEï¼šå¯è¯»å†™ã€‚ä»»ä½•ç¼“å†²åŒºçš„ä¿®æ”¹éƒ½ä¼šå†™å›æ–‡ä»¶ï¼ˆéç«‹å³ï¼‰<br>â€“ FileChannel.MapMode.PRIVATEï¼šç¼“å†²åŒºå¯å†™ï¼Œä½†ä¿®æ”¹ä¸ä¼šä¼ æ’­åˆ°æ–‡ä»¶ä¸­</p>
</li>
</ul>
<p>æ˜ å°„å®Œæˆåï¼Œæ–‡ä»¶å°±å¯ä»¥å…³é—­äº†ï¼Œåç»­å¯¹æ–‡ä»¶çš„è¯»å†™å¯ä»¥é€šè¿‡MappedByteBufferã€‚</p>
<p>ä¾‹ï¼šä»¥è¯»å†™æ¨¡å¼æ˜ å°„æ–‡ä»¶â€abc.datâ€ï¼Œä»£ç å¯ä»¥ä¸ºï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">RandomAccessFile file = <span class="keyword">new</span> RandomAccessFile(<span class="string">"abc.dat"</span>,<span class="string">"rw"</span>);</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    MappedByteBuffer buf = file.getChannel().map(MapMode.READ_WRITE, <span class="number">0</span>, file.length());</div><div class="line">    <span class="comment">//ä½¿ç”¨buf...</span></div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">&#125;<span class="keyword">finally</span>&#123;</div><div class="line">    file.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>##ã€€</p>
<h1 id="å‚è€ƒæ–‡çŒ®">2. å‚è€ƒæ–‡çŒ®</h1><p>1.<a href="https://juejin.im/post/58626ac361ff4b006cf14faf" target="_blank" rel="external">è®¡ç®—æœºç¨‹åºçš„æ€ç»´é€»è¾‘ (61) - å†…å­˜æ˜ å°„æ–‡ä»¶åŠå…¶åº”ç”¨ - å®ç°ä¸€ä¸ªç®€å•çš„æ¶ˆæ¯é˜Ÿåˆ—</a><br>2.<a href="http://blog.csdn.net/king_is_everyone/article/details/28096583" target="_blank" rel="external">javaæµçš„æ€§èƒ½ä¼˜åŒ–2-å†…å­˜æ˜ å°„æ–‡ä»¶</a></p>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OpenMessagingæºç é˜…è¯»2-demo]]></title>
      <url>/2017/05/19/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-OpenMessaging%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB2-demo/</url>
      <content type="html"><![CDATA[<h1 id="produceræ“ä½œ">1. produceræ“ä½œ</h1><p>tips:ä»¥ä¸‹æ¶‰åŠåˆ°çš„ä»£ç æ˜¯å…³é”®æ­¥éª¤ä»£ç ã€‚</p>
<ol>
<li><p>====================æ„é€ nä¸ª<strong>Topic</strong>å’Œnä¸ª<strong>Queue</strong>====================</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String topic1 = <span class="string">"TOPIC1"</span>; <span class="comment">//å®é™…æµ‹è¯•æ—¶å¤§æ¦‚ä¼šæœ‰100ä¸ªTopicå·¦å³</span></div><div class="line">String queue2 = <span class="string">"QUEUE2"</span>; <span class="comment">//å®é™…æµ‹è¯•æ—¶ï¼Œqueueæ•°ç›®ä¸æ¶ˆè´¹çº¿ç¨‹æ•°ç›®ç›¸åŒ</span></div><div class="line">List&lt;Message&gt; messagesForTopic1 = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">1024</span>);</div><div class="line">List&lt;Message&gt; messagesForQueue1 = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">1024</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>====================å‘Topicå’ŒQueueä¸­<strong>create</strong>æ•°æ®====================</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">messagesForTopic1.add(producer.createBytesMessageToTopic(topic1,  (topic1 + i).getBytes()));</div></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>è°ƒç”¨<code>producer</code>çš„<code>producer.createBytesMessageToTopic()</code>æ–¹æ³•æ¥åˆ›å»º<code>BytesMessage</code></li>
<li>å°†ä¸Šä¸€æ­¥äº§ç”Ÿçš„æ ‡å‡†æ¶ˆæ¯æ‰”è¿›messagesForTopic1ä¸­ï¼Œå³è°ƒç”¨äº†æ¯ä¸ª<code>messagesForTopic1.add()</code>æ¥å‘è¿™ä¸ª<code>Topic</code>ä¸­æ·»åŠ æ¶ˆæ¯</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>messageFactory,è€ŒcreateBytesMessageToTopic()æ­£æ˜¯é€šè¿‡messageFactory.createBytesMessageToTopic(topic, body);æ¥åˆ›å»ºæ¶ˆæ¯ï¼›</li>
<li>messageFactory.createBytesMessageToTopic(topic, body);ä»…ä»…åªæ˜¯å°†æ¶ˆæ¯çš„bodyå’Œheaderæ”¾å…¥äº†ä¸€ä¸ªdefaultBytesMessageç±»å‹çš„æ¶ˆæ¯ä¸­ï¼Œå¹¶è¿”å›</li>
<li>æ¯ä¸ªproducerå¯¹åº”ä¸€ä¸ªmessageStore<br><strong>æ€»ç»“ï¼šè¿™ä¸€æ­¥å°†produceräº§ç”Ÿçš„æ•°æ®æ”¾å…¥æ¶ˆæ¯åˆ—è¡¨messagesForTopic/Queueä¸­</strong></li>
</ul>
<p>3.====================<strong>send</strong>æ•°æ®====================</p>
<p>æ–¹å¼ï¼š</p>
<pre><code>producer.send(messagesForTopic1.get(i));
</code></pre><p>ç„¶å<code>send()</code>å†…éƒ¨æ˜¯ï¼š</p>
<pre><code>String topic = message.headers().getString(MessageHeader.TOPIC);
messageStore.putMessage(topicæˆ–queue, message);
</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>æ¯ä¸ªproduceræœ‰ä¸€ä¸ªmessageStoreï¼Œé€šè¿‡è°ƒç”¨å®ƒçš„putMessage()æ¥è¿›è¡Œå‘é€æ¶ˆæ¯ï¼ˆå°†æ¶ˆæ¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­ï¼‰</li>
<li>MessageStoreç±»æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡<code>Map &lt;String, ArrayList&lt;Message&gt;&gt; messageBuckets</code>ç”¨æ¥è£…æ¶ˆæ¯ï¼Œå…¶ä¸­é”®æ˜¯topicæˆ–queueçš„åå­—ï¼Œå€¼æ˜¯new ArrayList&lt;&gt;(1024)(è¿™é‡Œæœ‰ä¸€ç‚¹ç–‘é—®ï¼Ÿ)</li>
</ul>
<p>è€ŒputMessageï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">putMessage</span><span class="params">(String bucket, Message message)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!messageBuckets.containsKey(bucket)) &#123;</div><div class="line">        messageBuckets.put(bucket, <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">1024</span>));</div><div class="line">    &#125;</div><div class="line">    ArrayList&lt;Message&gt; bucketList = messageBuckets.get(bucket);</div><div class="line">    bucketList.add(message);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>å¦‚æœæœ¬messageStoreçš„messageBucketsæ²¡æœ‰æœ¬bucket(Topicæˆ–Queue)ï¼Œåˆ™å°†è¿™ä¸ªbuketåŠ å…¥åˆ°messageBucketsä¸­,å¹¶ä½¿å¾—å…¶é”®å€¼ä¸ºnew ArrayList&lt;&gt;(1024)</li>
<li>ä»æœ¬messageBucketsæ‹¿å‡º(get)æœ¬bucketï¼Œæ”¾å…¥æ¶ˆæ¯åˆ—è¡¨bucketListä¸­</li>
<li>å†å°†æœ¬messageåŠ å…¥æ¶ˆæ¯åˆ—è¡¨bucketList</li>
</ul>
<p><strong>æ€»ç»“ï¼šå°†Topicæˆ–Queueæ”¾å…¥MessageStoreçš„messageBucketsä¸­ï¼Œå°†æ¶ˆæ¯ä½“æ”¾å…¥bMessageStoreçš„ucketListä¸­</strong></p>
<h1 id="consumeræ“ä½œ">2. consumeræ“ä½œ</h1><ol>
<li>====================è¿›è¡Œæ¶ˆæ¯è®¢é˜…<strong>attach</strong>====================</li>
</ol>
<p>æ“ä½œï¼š</p>
<pre><code>consumer1.attachQueue(queue1, Collections.singletonList(topic1));
</code></pre><p>å¤‡æ³¨ï¼š</p>
<ul>
<li>singletonList(T) æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ªåªåŒ…å«æŒ‡å®šå¯¹è±¡çš„ä¸å¯å˜åˆ—è¡¨</li>
</ul>
<p>ç„¶åDefaultPullConsumerçš„attachQueueå¦‚ä¸‹ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">attachQueue</span><span class="params">(String queueName, Collection&lt;String&gt; topics)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (queue != <span class="keyword">null</span> &amp;&amp; !queue.equals(queueName)) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ClientOMSException(<span class="string">"You have alreadly attached to a queue "</span> + queue);</div><div class="line">    &#125;</div><div class="line">    queue = queueName;</div><div class="line">    buckets.add(queueName);</div><div class="line">    buckets.addAll(topics);</div><div class="line">    bucketList.clear();</div><div class="line">    bucketList.addAll(buckets);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>bucketsæ˜¯DefaultPullConsumerçš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šprivate Set<string> buckets = new HashSet&lt;&gt;();</string></li>
<li>bucketListæ˜¯DefaultPullConsumerçš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šprivate List<string> bucketList = new ArrayList&lt;&gt;();</string></li>
<li>å°†æœ¬queueä»¥åŠå…¶ä¸‹çš„æ‰€æœ‰topicéƒ½åŠ å…¥åˆ°bucketsä¸­</li>
<li>å°†buketséƒ½åŠ å…¥åˆ°bucketListä¸­</li>
</ul>
<p>2.====================è¿›è¡Œæ¶ˆæ¯æ‹‰å–<strong>pull</strong>====================</p>
<p>æ“ä½œï¼š</p>
<p>Message message = consumer1.poll();</p>
<p>å…¶ä¸­ï¼Œpollä¸ºï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Message <span class="title">poll</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (buckets.size() == <span class="number">0</span> || queue == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//use Round Robin</span></div><div class="line">    <span class="keyword">int</span> checkNum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (++checkNum &lt;= bucketList.size()) &#123;</div><div class="line">        String bucket = bucketList.get((++lastIndex) % (bucketList.size()));</div><div class="line">        Message message = messageStore.pullMessage(queue, bucket);</div><div class="line">        <span class="keyword">if</span> (message != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> message;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>éå†æ¯ä¸ªbucketListï¼ˆbucketListè£…çš„æ˜¯æœ¬consumerè®¢é˜…çš„topicsä»¥åŠå¯¹åº”çš„queueï¼‰</li>
<li>å¯¹éå†åˆ°çš„æ¯ä¸ªbucketï¼Œä»messageStoreæ‹‰å–æ¶ˆæ¯</li>
</ul>
<p>è€Œ messageStore.pullMessageä¸ºï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Message <span class="title">pullMessage</span><span class="params">(String queue, String bucket)</span> </span>&#123;</div><div class="line">    ArrayList&lt;Message&gt; bucketList = messageBuckets.get(bucket);</div><div class="line">    <span class="keyword">if</span> (bucketList == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    HashMap&lt;String, Integer&gt; offsetMap = queueOffsets.get(queue);</div><div class="line">    <span class="keyword">if</span> (offsetMap == <span class="keyword">null</span>) &#123;</div><div class="line">        offsetMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        queueOffsets.put(queue, offsetMap);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> offset = offsetMap.getOrDefault(bucket, <span class="number">0</span>);</div><div class="line">    <span class="keyword">if</span> (offset &gt;= bucketList.size()) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    Message message = bucketList.get(offset);</div><div class="line">    offsetMap.put(bucket, ++offset);</div><div class="line">    <span class="keyword">return</span> message;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>å…ˆä»messageStoreçš„messageBucketsä¸­getåˆ°æœ¬bucketçš„bucketList</li>
<li>å°†è¿™ä¸ªconsumerç»‘å®šçš„queueæ”¾å…¥æœ¬messageStoreçš„queueOffsetsä¸­</li>
<li>ç„¶åæˆ‘å°±æœ‰ç‚¹ç–‘æƒ‘äº†ï¼Ÿï¼Ÿ</li>
</ul>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RocketMQç®€ä»‹]]></title>
      <url>/2017/05/17/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-RocketMQ%E7%AE%80%E4%BB%8B/</url>
      <content type="html"><![CDATA[<p>RocketMQ:åˆ†å¸ƒå¼å¼€æ”¾æ¶ˆæ¯ç³»ç»Ÿ</p>
<h1 id="æ¶ˆæ¯ä¸­é—´ä»¶éœ€è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿ">1. æ¶ˆæ¯ä¸­é—´ä»¶éœ€è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿ</h1><h2 id="å‘å¸ƒè®¢é˜…ï¼ˆPublish-Subscribeï¼‰">1.1. å‘å¸ƒè®¢é˜…ï¼ˆPublish/Subscribeï¼‰</h2><p>å‘å¸ƒè®¢é˜…æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„æœ€åŸºæœ¬åŠŸèƒ½ï¼Œä¹Ÿæ˜¯ç›¸å¯¹äºä¼ ç»ŸRPCé€šä¿¡è€Œè¨€ã€‚åœ¨æ­¤ä¸å†è¯¦è¿°ã€‚</p>
<h2 id="æ¶ˆæ¯ä¼˜å…ˆçº§ï¼ˆMessage-Priorityï¼‰">1.2. æ¶ˆæ¯ä¼˜å…ˆçº§ï¼ˆMessage Priorityï¼‰</h2><p>ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>ä¸¥æ ¼ä¼˜å…ˆçº§ï¼Œä¾‹å¦‚0-65535ã€‚å¼€é”€å¤§ï¼Œç²¾å‡†ï¼Œä½†å¯èƒ½æ²¡æœ‰å¿…è¦ã€‚</li>
<li>æ¡£ä½ä¼˜å…ˆçº§ã€‚é«˜ã€ä¸­ã€ä½ï¼Œæˆ–å…¶ä»–ã€‚æ¯ä¸ªä¼˜å…ˆçº§å¯ä»¥ç”¨ä¸åŒçš„topicè¡¨ç¤ºï¼Œå‘æ¶ˆæ¯æ—¶ï¼ŒæŒ‡å®šä¸åŒçš„topicæ¥è¡¨ç¤ºä¼˜å…ˆçº§ã€‚ç²¾ç¡®æ€§ä½ã€‚</li>
</ol>
<h2 id="æ¶ˆæ¯æœ‰åºæ€§ï¼ˆMessage-Orderï¼‰">1.3. æ¶ˆæ¯æœ‰åºæ€§ï¼ˆMessage Orderï¼‰</h2><ol>
<li>ä¸€ä¸ªè®¢å•çš„å‘å‡ºçš„æ¶ˆæ¯é¡ºåºä¸èƒ½å˜</li>
<li>è®¢å•ä¹‹é—´æ˜¯å¯ä»¥å¹¶è¡Œæ¶ˆè´¹</li>
</ol>
<h2 id="æ¶ˆæ¯è¿‡æ»¤ï¼ˆMessage-Filterï¼‰">1.4. æ¶ˆæ¯è¿‡æ»¤ï¼ˆMessage Filterï¼‰</h2><h3 id="æ¶ˆæ¯åå•†å™¨ï¼ˆBrokerç«¯ï¼‰æ¶ˆæ¯è¿‡æ»¤">1.4.1. æ¶ˆæ¯åå•†å™¨ï¼ˆBrokerç«¯ï¼‰æ¶ˆæ¯è¿‡æ»¤</h3><p>åœ¨Brokerä¸­ï¼ŒæŒ‰ç…§Consumerçš„è¦æ±‚åšè¿‡æ»¤</p>
<ol>
<li>ä¼˜ç‚¹æ˜¯å‡å°‘äº†å¯¹äºConsumeræ— ç”¨æ¶ˆæ¯çš„ç½‘ç»œä¼ è¾“ã€‚</li>
<li>ç¼ºç‚¹æ˜¯å¢åŠ äº†Brokerçš„è´Ÿæ‹…ï¼Œå®ç°ç›¸å¯¹å¤æ‚ã€‚</li>
</ol>
<p>æ·˜å®Notifyæ”¯æŒå¤šç§è¿‡æ»¤æ–¹å¼ï¼š<br>åŒ…å«ç›´æ¥æŒ‰ç…§æ¶ˆæ¯ç±»å‹è¿‡æ»¤ï¼Œçµæ´»çš„è¯­æ³•è¡¨è¾¾å¼è¿‡æ»¤ï¼Œå‡ ä¹å¯ä»¥æ»¡è¶³æœ€è‹›åˆ»çš„è¿‡æ»¤éœ€æ±‚ã€‚</p>
<p>æ·˜å®RocketMQæ”¯æŒæŒ‰ç…§ç®€å•çš„Message Tagè¿‡æ»¤ï¼Œä¹Ÿæ”¯æŒæŒ‰ç…§Message Headerã€bodyè¿›è¡Œè¿‡æ»¤ã€‚</p>
<p>CORBA Notificationè§„èŒƒä¸­ä¹Ÿæ”¯æŒçµæ´»çš„è¯­æ³•è¡¨è¾¾å¼è¿‡æ»¤ã€‚</p>
<h3 id="Consumerç«¯æ¶ˆæ¯è¿‡æ»¤">1.4.2. Consumerç«¯æ¶ˆæ¯è¿‡æ»¤</h3><p>è¿™ç§è¿‡æ»¤æ–¹å¼å¯ç”±åº”ç”¨å®Œå…¨è‡ªå®šä¹‰å®ç°ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯å¾ˆå¤šæ— ç”¨çš„æ¶ˆæ¯è¦ä¼ è¾“åˆ°Consumerç«¯ã€‚</p>
<h3 id="æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆMessage-Persistenceï¼‰">1.4.3. æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆMessage Persistenceï¼‰</h3><p>æŒä¹…åŒ–ï¼ˆPersistenceï¼‰ï¼šå³æŠŠæ•°æ®ï¼ˆå¦‚å†…å­˜ä¸­çš„å¯¹è±¡ï¼‰ä¿å­˜åˆ°å¯æ°¸ä¹…ä¿å­˜çš„å­˜å‚¨è®¾å¤‡ä¸­ï¼ˆå¦‚ç£ç›˜ï¼‰ã€‚æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„å¯¹è±¡å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæˆ–è€…å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ã€XMLæ•°æ®æ–‡ä»¶ä¸­ç­‰ç­‰ã€‚</p>
<p>æ¶ˆæ¯ä¸­é—´ä»¶é€šå¸¸é‡‡ç”¨çš„å‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼š</p>
<ol>
<li>æŒä¹…åŒ–åˆ°æ•°æ®åº“ï¼Œä¾‹å¦‚Mysqlã€‚</li>
<li>æŒä¹…åŒ–åˆ°KVå­˜å‚¨ï¼Œä¾‹å¦‚levelDBã€ä¼¯å…‹åˆ©DBç­‰KVå­˜å‚¨ç³»ç»Ÿã€‚</li>
<li>æ–‡ä»¶è®°å½•å½¢å¼æŒä¹…åŒ–ï¼Œä¾‹å¦‚Kafkaï¼ŒRocketMQ</li>
<li>å¯¹å†…å­˜æ•°æ®åšä¸€ä¸ªæŒä¹…åŒ–é•œåƒï¼Œä¾‹å¦‚beanstalkdï¼ŒVisiNotify</li>
<li>(1)ã€(2)ã€(3)ä¸‰ç§æŒä¹…åŒ–æ–¹å¼éƒ½å…·æœ‰å°†å†…å­˜é˜Ÿåˆ—Bufferè¿›è¡Œæ‰©å±•çš„èƒ½åŠ›ï¼Œ(4)åªæ˜¯ä¸€ä¸ªå†…å­˜çš„é•œåƒï¼Œä½œç”¨æ˜¯å½“BrokeræŒ‚æ‰é‡å¯åä»ç„¶èƒ½å°†ä¹‹å‰å†…å­˜çš„æ•°æ®æ¢å¤å‡ºæ¥ã€‚</li>
</ol>
<p>JMSä¸CORBA Notificationè§„èŒƒæ²¡æœ‰æ˜ç¡®è¯´æ˜å¦‚ä½•æŒä¹…åŒ–ï¼Œä½†æ˜¯æŒä¹…åŒ–éƒ¨åˆ†çš„æ€§èƒ½ç›´æ¥å†³å®šäº†æ•´ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶çš„æ€§èƒ½ã€‚</p>
<p>RocketMQå……åˆ†åˆ©ç”¨Linuxæ–‡ä»¶ç³»ç»Ÿå†…å­˜cacheæ¥æé«˜æ€§èƒ½ã€‚</p>
<h3 id="æ¶ˆæ¯å¯é æ€§ï¼ˆMessage-Reliablityï¼‰">1.4.4. æ¶ˆæ¯å¯é æ€§ï¼ˆMessage Reliablityï¼‰</h3><p>å“æ¶ˆæ¯å¯é æ€§çš„å‡ ç§æƒ…å†µï¼š</p>
<ol>
<li>Brokeræ­£å¸¸å…³é—­</li>
<li>Brokerå¼‚å¸¸Crash</li>
<li>OS Crash</li>
<li>æœºå™¨æ‰ç”µï¼Œä½†æ˜¯èƒ½ç«‹å³æ¢å¤ä¾›ç”µæƒ…å†µã€‚</li>
<li>æœºå™¨æ— æ³•å¼€æœºï¼ˆå¯èƒ½æ˜¯cpuã€ä¸»æ¿ã€å†…å­˜ç­‰å…³é”®è®¾å¤‡æŸåï¼‰</li>
<li>ç£ç›˜è®¾å¤‡æŸå</li>
</ol>
<p>(1)ã€(2)ã€(3)ã€(4)å››ç§æƒ…å†µéƒ½å±äºç¡¬ä»¶èµ„æºå¯ç«‹å³æ¢å¤æƒ…å†µï¼ŒRocketMQåœ¨è¿™å››ç§æƒ…å†µä¸‹èƒ½ä¿è¯æ¶ˆæ¯ä¸ä¸¢ï¼Œæˆ–è€…ä¸¢å¤±å°‘é‡æ•°æ®ï¼ˆä¾èµ–åˆ·ç›˜æ–¹å¼æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼‰ã€‚</p>
<p>(5)ã€(6)å±äºå•ç‚¹æ•…éšœï¼Œä¸”æ— æ³•æ¢å¤ï¼Œä¸€æ—¦å‘ç”Ÿï¼Œåœ¨æ­¤å•ç‚¹ä¸Šçš„æ¶ˆæ¯å…¨éƒ¨ä¸¢å¤±ã€‚RocketMQåœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡å¼‚æ­¥å¤åˆ¶ï¼Œå¯ä¿è¯99%çš„æ¶ˆæ¯ä¸ä¸¢ï¼Œä½†æ˜¯ä»ç„¶ä¼šæœ‰æå°‘é‡çš„æ¶ˆæ¯å¯èƒ½ä¸¢å¤±ã€‚é€šè¿‡åŒæ­¥åŒå†™æŠ€æœ¯å¯ä»¥å®Œå…¨é¿å…å•ç‚¹ï¼ŒåŒæ­¥åŒå†™åŠ¿å¿…ä¼šå½±å“æ€§èƒ½ï¼Œé€‚åˆå¯¹æ¶ˆæ¯å¯é æ€§è¦æ±‚æé«˜çš„åœºåˆï¼Œä¾‹å¦‚ä¸Moneyç›¸å…³çš„åº”ç”¨ã€‚</p>
<p>RocketMQä»3.0ç‰ˆæœ¬å¼€å§‹æ”¯æŒåŒæ­¥åŒå†™ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">2. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://jm.taobao.org/2017/01/12/rocketmq-quick-start-in-10-minutes/" target="_blank" rel="external">ååˆ†é’Ÿå…¥é—¨RocketMQ</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> openMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è½¬åŒ–ç‡é¢„ä¼°èµ„æ–™]]></title>
      <url>/2017/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-CVR-%E8%BD%AC%E5%8C%96%E7%8E%87%E9%A2%84%E4%BC%B0%E8%B5%84%E6%96%99/</url>
      <content type="html"><![CDATA[<ol>
<li><a href="http://www.flickering.cn/category/ads/" target="_blank" rel="external">ç«å…‰æ‘‡æ›³</a></li>
<li><a href="http://tech.meituan.com/tag/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" target="_blank" rel="external">ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿ</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> è…¾è®¯ç®—æ³•å¤§èµ›-CVRé¢„ä¼° </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CVRé¢„ä¼° </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é˜¿é‡Œä¸­é—´ä»¶åˆèµ›-æå¥èƒœè§£å†³æ–¹æ¡ˆ]]></title>
      <url>/2017/05/14/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-%E6%9D%8E%E5%81%A5%E8%83%9C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      <content type="html"><![CDATA[<h1 id="å‚è€ƒèµ„æ–™">1. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="http://blog.jesonlee.me/19/" target="_blank" rel="external">æå¥èƒœï¼Œé˜¿é‡Œä¸­é—´ä»¶å¤§èµ›åˆèµ›è§£é¢˜æ€è·¯</a></li>
<li><a href="https://github.com/Jesonlee1997/open-message" target="_blank" rel="external">1å¯¹åº”çš„ä»£ç </a></li>
</ol>
<h1 id="é¢˜ç›®è¦æ±‚">2. é¢˜ç›®è¦æ±‚</h1><p><strong>ä¸»è§’</strong>ï¼šæ¶ˆæ¯ä¸­é—´ä»¶<br><strong>ç›®çš„</strong>ï¼šå®ç°æ¶ˆæ¯ä¸­é—´ä»¶çš„æ¨æ‹‰æ¨¡å¼ã€‚å³ç”Ÿäº§è€…åˆ¶é€ æ¶ˆæ¯ï¼Œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å‚¨å­˜æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä»æ¶ˆæ¯é˜Ÿåˆ—æ‹‰å–æ¶ˆæ¯ã€‚<br><strong>è¦ç‚¹</strong>ï¼šæŒä¹…åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—</p>
<h2 id="Produceréœ€è¦å®ç°">2.1. Produceréœ€è¦å®ç°</h2><ul>
<li><p>åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯ï¼Œç»™æ¶ˆæ¯æŒ‡å®šTopicï¼ˆå¯ä»¥ç”±å¤šä¸ªConsumeræ¶ˆè´¹ï¼‰<br><code>BytesMessage createBytesMessageToTopic(String topic, byte[] body);</code></p>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯ï¼Œç»™æ¶ˆæ¯æŒ‡å®šQueueï¼ˆåªèƒ½ç”±ä¸€ä¸ªConsumeræ¶ˆè´¹ï¼‰<br><code>BytesMessage createBytesMessageToQueue(String queue, byte[] body);</code></p>
</li>
<li><p>å‘é€æ¶ˆæ¯ï¼Œmessageä¸­åº”å½“åŒ…å«ç›®çš„åœ°ï¼ˆQueueï¼ŒTopicåªèƒ½é€‰å…¶ä¸€ï¼‰ï¼Œå¯¹äºå‘å¾€åŒä¸€ä¸ªTopicå’ŒQueueçš„messageé¡ºåºè¦ä¿æŒä¸€è‡´ã€‚<br><code>void send(Message message);</code></p>
</li>
</ul>
<h2 id="PullConsumeréœ€è¦å®ç°">2.2. PullConsumeréœ€è¦å®ç°</h2><ul>
<li>ç»‘å®šåˆ°ä¸€ä¸ªQueueï¼Œå¹¶è®¢é˜…topicsï¼Œå³ä»è¿™äº›topicå’ŒQueueè¯»å–æ¶ˆæ¯ã€‚<br><code>void attachQueue(String queueName, Collection topics);</code></li>
<li>è§„èŒƒè¦æ±‚å®ç°é˜»å¡çš„æ¥å£ï¼Œç”±propertiesæ¥è®¾ç½®é˜»å¡æ—¶é—´ï¼Œä½†æœ¬èµ›é¢˜ä¸éœ€è¦ç”¨åˆ°è¯¥ç‰¹æ€§ï¼Œ è¯·å®ç°ä¸€ä¸ªéé˜»å¡(ä¹Ÿå³é˜»å¡æ—¶é—´ä¸º0)è°ƒç”¨, ä¹Ÿå³æ²¡æœ‰æ¶ˆæ¯åˆ™è¿”å›null<br><code>Message poll();</code></li>
</ul>
<h2 id="æµ‹è¯•æµç¨‹">2.3. æµ‹è¯•æµç¨‹</h2><ul>
<li>åˆ›å»º<code>Topic</code>ï¼Œåˆ›å»º<code>Queue</code> åˆ›å»º<code>Producer</code>ï¼Œå¤šä¸ª<code>Producer</code>åˆ›å»ºæŒ‡å®š<code>Topic</code>å’ŒæŒ‡å®š<code>Queue</code>çš„Messageï¼Œè°ƒç”¨<code>send</code>æ–¹æ³•å‘é€</li>
<li>å°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­</li>
<li><code>kill Producer</code>è¿›ç¨‹ï¼Œå¦å–è¿›ç¨‹è¿›è¡Œæ¶ˆè´¹<br>åˆ›å»º<code>PullConsumer</code>çº¿ç¨‹è¿›è¡Œæ¶ˆè´¹ï¼Œä¸€ä¸ª<code>Consumer</code>å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œ<code>Consumer</code>è¿æ¥åˆ°ä¸€ä¸ª<code>Queue</code>ï¼Œå¯ä»¥è®¢é˜…å¤šä¸ª<code>Topic</code>ã€‚ </li>
<li>ä¸æ–­çš„è°ƒç”¨pollæ‹‰å–é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œç›´åˆ°å®Œå…¨è¯»å®Œï¼Œè¯»å–çš„æ¶ˆæ¯è¦ç›¸å¯¹æœ‰åºã€‚</li>
</ul>
<p>è¡¥å……ï¼š<br>ä¸€ä¸ª<code>Producer</code>å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…ˆåˆ›å»ºå¯¹åº”çš„Messageï¼Œå†å°†Message å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—æˆ–<code>topic</code>ä¸­ï¼Œå®é™…æƒ…å†µä¸­ä¼šæœ‰å¤šä¸ª<code>Producer</code>ã€‚ ä¸€ä¸ª<code>Consumer</code>å¯¹åº”ä¸€ä¸ª<code>Queue</code>ï¼Œå¤šä¸ª<code>Consumer</code>åŒæ—¶ä»é˜Ÿåˆ—ä¸­æ‹‰å–æ¶ˆæ¯ã€‚</p>
<h2 id="æŠ€æœ¯éš¾ç‚¹">2.4. æŠ€æœ¯éš¾ç‚¹</h2><ol>
<li>å¤§é‡çš„æ¶ˆæ¯äº§ç”Ÿ </li>
<li>å¹¶å‘å†™ </li>
<li>å¹¶å‘è¯» </li>
<li>åºåˆ—åŒ–&amp;ååºåˆ—åŒ–</li>
</ol>
<ol>
<li>å¤§é‡æ¶ˆæ¯<br>é¦–å…ˆæ ¹æ®é¢˜ç›®æè¿°ï¼ŒProduceè¿‡ç¨‹ä¼šè¿è¡Œ5åˆ†é’Ÿï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¤šçº¿ç¨‹è¿›è¡Œæ¶ˆæ¯çš„å‘é€ï¼Œç„¶åå†è€ƒè™‘å°†æ¶ˆæ¯æŒä¹…åŒ–ã€‚æˆ‘ç”¨è‡ªå·±çš„ç¨‹åºæµ‹è¯•äº†ä¸€ä¸‹ï¼Œï¼ˆä¸æ˜¯å…¸å‹å€¼ï¼Œåªä½œä¸ºå‚è€ƒï¼Œåœ¨æ–‡ç« çš„æœ€åæˆ‘ä¼šè´´ä¸Šæˆ‘çš„ä¸€ç³»åˆ—æµ‹è¯•ç»“æœï¼‰ï¼Œå¤šçº¿ç¨‹å‘é€ä¸€äº¿æ¡æ¶ˆæ¯çš„æ—¶é—´ä¸º27sï¼Œè€Œè¿™ä¸€äº¿æ¡æ¶ˆæ¯å æ®ç£ç›˜çš„å¤§å°ä¸ºå°†è¿‘4Gï¼å¯ä»¥æƒ³è±¡åœ¨5åˆ†é’Ÿå†…ä¼šäº§ç”Ÿå¤šå°‘çš„æ¶ˆæ¯é‡ï¼Œå¦‚ä½•å°†æ¶ˆæ¯å­˜å‚¨ï¼Œå¦‚ä½•è¯»å–æ¶ˆæ¯éƒ½å°†æˆä¸ºä¸€ä¸ªéå¸¸æ£˜æ‰‹çš„é—®é¢˜ã€‚</li>
<li>å¹¶å‘å†™<br>å¹¶å‘å†™çš„é—®é¢˜ä¹Ÿéå¸¸æ˜¾è€Œæ˜“è§ã€‚æˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹ä¸ºäº†å®ç°æ¶ˆæ¯é˜Ÿåˆ—ä¼šé€‰æ‹©ä½¿ç”¨ä¸€ä¸ªListæˆ–æ•°ç»„æ¥å­˜å‚¨Produceräº§ç”Ÿçš„æ¶ˆæ¯ã€‚è¿™å°±å¼•å‘äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ€æ ·ä¿è¯å‘åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­å‘é€æ¶ˆæ¯çš„çº¿ç¨‹ä¸äº§ç”Ÿç«äº‰æ¡ä»¶ã€‚</li>
<li>å¹¶å‘è¯»<br>æœ€éº»çƒ¦çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½éœ€è¦è¯»å–ç£ç›˜ä¸Šçš„æ¶ˆæ¯å†…å®¹ï¼Œæ¯ä¸ªçº¿ç¨‹è¯»å–çš„ä½ç½®åˆä¸å°½ç›¸åŒï¼Œæ¶ˆæ¯æ•°åˆé‚£ä¹ˆå¤šä¸å¯èƒ½å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™ä¸ªé—®é¢˜æ›¾è®©æˆ‘ä¼¤é€äº†è„‘ç­‹ï¼Œç›´åˆ°æˆ‘é‡åˆ°äº†mmap(åé¢è¯¦ç»†ä»‹ç»)ã€‚</li>
<li>åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é—®é¢˜<br>å¤§èµ›åˆšå¼€å§‹æ—¶ï¼Œæˆ‘å†™äº†ä¸€ä¸ªä½¿ç”¨Javaè‡ªèº«åºåˆ—åŒ–æ¥å®ç°æŒä¹…åŒ–çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„ç¼ºç‚¹éå¸¸æ˜¾è€Œæ˜“è§ï¼Œå°±æ˜¯æ…¢ï¼Œè€Œè¿™ä¸ªç¼ºç‚¹åˆæ˜¯æä¸ºè‡´å‘½çš„ã€‚æˆ‘æ„è¯†åˆ°æˆ‘éœ€è¦è‡ªå·±å®šåˆ¶ä¸€ä¸ªåºåˆ—åŒ–åè®®æ¥å°†æ¶ˆæ¯è½¬åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼Œå†é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå¦‚FileOutputStreamï¼‰å†™å…¥ç£ç›˜ï¼ŒåŒæ—¶å†ä½¿ç”¨è¿™ä¸ªåè®®å°†å…¶ä»ç£ç›˜ä¸­æ¢å¤ã€‚</li>
</ol>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OpenMessagingæºç é˜…è¯»1]]></title>
      <url>/2017/05/13/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-OpenMessaging%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB1/</url>
      <content type="html"><![CDATA[<p>è€ƒè™‘åˆ°è‡ªå·±è®°æ€§å®åœ¨å¤ªå·®ï¼Œè¿˜æ˜¯å¥½å¥½è®°ç¬”è®°å§ã€‚<br>æœ¬èŠ‚ä¸»è¦çœ‹ä»¥ä¸‹å‡ ä¸ªæ¥å£ï¼š</p>
<ul>
<li>Meaasage</li>
<li>Producer</li>
<li>PullConsumer</li>
</ul>
<h1 id="Message-java">1. Message.java</h1><p>Messageæ¥å£æ˜¯æ‰€æœ‰OMSæ¶ˆæ¯ä¸­çš„æ ¹æ¥å£ã€‚æœ€å¸¸ç”¨çš„æ¶ˆæ¯å°±æ˜¯BytesMessageã€‚</p>
<p><strong>æ ‡å‡†Message</strong><br>å¤§å¤šæ¶ˆæ¯å¯¼å‘ï¼ˆmessage-orientedï¼‰çš„ä¸­é—´ä»¶ï¼ˆMOMï¼‰äº§å“æ›´è¶‹å‘äºå°†æ¶ˆæ¯è®¤åšè½»å®ä½“ï¼Œè¿™ä¸ªè½»å®ä½“åŒ…å«ä¸€ä¸ªheaderå’Œä¸€ä¸ªbodyï¼š</p>
<ul>
<li>header:åŒ…å«ç”¨æ¥è·¯ç”±å’Œè¯†åˆ«çš„ä¿¡æ¯åŸŸï¼›</li>
<li>body:åŒ…å«å°†ä¼šè¢«å‘é€çš„åº”ç”¨ä¿¡æ¯ï¼›</li>
</ul>
<p><strong>æœ¬Message</strong><br>æœ¬æ¶ˆæ¯æ˜¯ä¸€ä¸ªä»…åŒ…å«ä¸å…·ä½“æ¶ˆæ¯å¯¹è±¡ç›¸å…³çš„property(è´¢äº§)çš„è½»é‡çº§å®ä½“ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>Header:æ‰€æœ‰æ¶ˆæ¯éƒ½æœ‰åŒæ ·çš„headeråŸŸã€‚headeråŸŸçš„å€¼ç”¨æ¥ç»™å®¢æˆ·ç«¯(clients)å’Œæä¾›å•†ï¼ˆprovidersï¼‰å”¯ä¸€æ ‡ç¤ºæ¶ˆæ¯ï¼Œä»¥åŠè·¯ç”±æ¶ˆæ¯ã€‚</li>
<li>Properties(è´¢äº§ï¼Œç‰¹æ€§)ï¼šæ¯ä¸ªæ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªæ¶ˆæ¯è‡ªæœ‰çš„éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†ç”¨æ¥æä¾›â€œåº”ç”¨å®šä¹‰(application-defined)â€çš„property(è´¢äº§)å€¼ã€‚è¿™ä¸€éƒ¨åˆ†ä¸ºæ”¯æŒâ€œåº”ç”¨å®šä¹‰â€æ¶ˆæ¯çš„è¿‡æ»¤æä¾›äº†å¾ˆæœ‰æ•ˆçš„æœºåˆ¶ã€‚</li>
</ul>
<p><strong>æºç è§£è¯»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Message</span> </span>&#123;</div><div class="line">     <span class="comment">/*headers()è¿”å›Messageå¯¹è±¡çš„headeråŸŸï¼Œè¿”å›å€¼ç±»å‹æ˜¯keyValueã€‚*/</span></div><div class="line">    <span class="function">KeyValue <span class="title">headers</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/*properties()è¿”å›æ¶ˆæ¯è‡ªæœ‰çš„propertyåŸŸã€‚è¿”å›å€¼ç±»å‹æ˜¯keyValueã€‚*/</span></div><div class="line">    <span class="function">KeyValue <span class="title">properties</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="comment">/*putHeaders(String key, int value)å°†è¾“å…¥(String key, int value)å…¨éƒ¨ä¼ å…¥header*/</span></div><div class="line">    <span class="comment">/*å‚æ•°key:headersçš„å…³é”®å­—*/</span></div><div class="line">    <span class="comment">/*å‚æ•°values:ä¸keyå¯¹åº”çš„å€¼*/</span></div><div class="line">    <span class="function">Message <span class="title">putHeaders</span><span class="params">(String key, <span class="keyword">int</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putHeaders</span><span class="params">(String key, <span class="keyword">long</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putHeaders</span><span class="params">(String key, <span class="keyword">double</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putHeaders</span><span class="params">(String key, String value)</span></span>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/*å°†keyå’Œvalueå…¨éƒ¨å­˜å…¥header*/</span></div><div class="line">    <span class="comment">/*å‚æ•°key:headersçš„å…³é”®å­—*/</span></div><div class="line">    <span class="comment">/*å‚æ•°values:ä¸keyå¯¹åº”çš„å€¼*/</span></div><div class="line">    <span class="function">Message <span class="title">putProperties</span><span class="params">(String key, <span class="keyword">int</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putProperties</span><span class="params">(String key, <span class="keyword">long</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putProperties</span><span class="params">(String key, <span class="keyword">double</span> value)</span></span>;</div><div class="line">    <span class="function">Message <span class="title">putProperties</span><span class="params">(String key, String value)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Producer-java">2. Producer.java</h1><p>Produceræ˜¯ä¸€ä¸ªç”¨æ¥å‘é€æ¶ˆæ¯çš„ç®€å•å¯¹è±¡ï¼Œå®ƒæ˜¯<code>MessagingAccessPoint</code>çš„ä¸€ä¸ªå…·ä½“å®ç°ã€‚<br><strong>åˆ›å»ºProducerå¯¹è±¡</strong>ï¼š<br><code>Producer</code>çš„å…·ä½“å®ä¾‹æ˜¯é€šè¿‡<code>MessagingAccessPoint#createProducer()</code>æ–¹æ³•åˆ›å»ºçš„ã€‚<br>è¿™ä¸ªæ–¹æ³•æä¾›äº†å¤šç§å®šç‚¹å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼Œå…¶ä¸­ï¼Œç›®çš„åœ°å¯ä»¥æ˜¯<code>MessageHeader#TOPIC</code>æˆ–<code>MessageHeader#QUEUE</code>ã€‚</p>
<p><strong>Producer#send(Message)</strong><br>åŒæ­¥å®šç‚¹å‘é€æ¶ˆæ¯æ–¹æ³•ã€‚<br>å½“å‘é€è¯·æ±‚å®Œæˆæ—¶ï¼Œçº¿ç¨‹å°†ä¼šå…³é—­(block)ã€‚</p>
<p><strong>Producer#sendAsync(Message)</strong><br>å¼‚æ­¥å®šç‚¹å‘é€æ¶ˆæ¯æ–¹æ³•ã€‚<br>å½“å‘é€è¯·æ±‚å®Œæˆæ—¶ï¼Œçº¿ç¨‹ä¸ä¼šå¾ˆå¿«å…³é—­ï¼Œè€Œä¼šç«‹å³è¿”å›ä¸€ä¸ª<code>Promise</code>ä½œä¸ºå‘é€ç»“æœã€‚</p>
<p><strong>Producer#sendOneway(Message)</strong><br>one wayå®šç‚¹å‘é€æ¶ˆæ¯æ–¹æ³•ã€‚<br>å½“å‘é€è¯·æ±‚å®Œæˆæ—¶ï¼Œçº¿ç¨‹ä¸ä¼šå¾ˆå¿«å…³é—­ï¼Œè€Œæ˜¯ç«‹å³è¿”å›ã€‚çº¿ç¨‹å‘èµ·è€…ä¸å…³å¿ƒå‘é€ç»“æœï¼ŒåŒæ—¶serverä¹Ÿå¯¹è¿”å›å€¼æ²¡æœ‰è´£ä»»ã€‚</p>
<p><strong>æºç è§£è¯»</strong></p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">MessageFactory</span>, <span class="title">ServiceLifecycle</span> </span>&#123;</div><div class="line">     <span class="comment">/*è¿”å›æœ¬å®ä¾‹çš„properties*/</span></div><div class="line">     <span class="comment">/*è¿”å›å€¼çš„å˜åŒ–ä¸ä¼šååº”åœ¨Produceræœ¬èº«ä¸Šï¼Œå¹¶ä¸”è¿™ä¸ªå˜åŒ–å¯ä»¥ç”¨ResourceManager#setProducerProperties(String, KeyValue)æ¥ä¿®æ”¹ã€‚ï¼ˆChanges to the return &#123;@code KeyValue&#125; are not reflected in physical &#123;@code Producer&#125;,and use &#123;@link ResourceManager#setProducerProperties(String, KeyValue)&#125; to modify.ï¼‰*/</span></div><div class="line">    <span class="function">KeyValue <span class="title">properties</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/*åŒæ­¥å®šç‚¹å‘é€messageæ–¹æ³•*/</span></div><div class="line">    <span class="comment">/*å‘é€ç›®çš„åœ°åº”è¯¥é¢„ç½®åœ¨MessageHeaderä¸­ã€‚å½“ç„¶å…¶å®ƒç±»å‹çš„headeråŸŸä¹Ÿå¯ä»¥*/</span></div><div class="line">    <span class="comment">/*å¼‚å¸¸OMSRuntimeExceptionï¼šå½“ç”±äºå†…éƒ¨åŸå› å‘é€å¤±è´¥æ—¶*/</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">send</span><span class="params">(Message message)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">send</span><span class="params">(Message message, KeyValue properties)</span></span>;<span class="comment">/*propertiesæ˜¯å±æ€§å€¼*/</span></div><div class="line"></div><div class="line">    <span class="comment">/*å¼‚æ­¥å®šç‚¹å‘é€æ¶ˆæ¯æ–¹æ³•*/</span></div><div class="line">    <span class="comment">/*è¿”å›å€¼æ˜¯Promiseç±»å‹ã€‚åŒæ—¶ï¼Œç™»è®°è¿‡çš„PromiseListenerå°†ä¼šè¢«é€šçŸ¥*/</span></div><div class="line">    <span class="function">Promise&lt;Void&gt; <span class="title">sendAsync</span><span class="params">(Message message)</span></span>;</div><div class="line">    <span class="function">Promise&lt;Void&gt; <span class="title">sendAsync</span><span class="params">(Message message, KeyValue properties)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/*onewayå®šç‚¹å‘é€æ¶ˆæ¯æ–¹æ³•*/</span></div><div class="line">    <span class="comment">/*æ— è¿”å›å€¼ï¼Œä¹Ÿæ²¡æœ‰thrownã€‚å› ä¸ºonewayå‘é€ä¸åœ¨ä¹å‘é€ç»“æœ*/</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendOneway</span><span class="params">(Message message)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sendOneway</span><span class="params">(Message message, KeyValue properties)</span></span>;</div><div class="line"></div><div class="line">    <span class="function">BatchToPartition <span class="title">createBatchToPartition</span><span class="params">(String partitionName)</span></span>;</div><div class="line"></div><div class="line">    <span class="function">BatchToPartition <span class="title">createBatchToPartition</span><span class="params">(String partitionName, KeyValue properties)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><h1 id="PullConsumer-java">3. PullConsumer.java</h1><p><code>PullConsumer</code>å¯¹è±¡èƒ½ä»ç‰¹å®šçš„é˜Ÿåˆ—ä¸­pollæ¶ˆæ¯ã€‚è€Œä¸”æ”¯æŒé€šè¿‡â€˜ackâ€™æ–¹å¼æäº¤æ¶ˆè´¹ç»“æœã€‚</p>
<p><strong>æºç åˆ†æ</strong></p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PullConsumer</span> </span>&#123;</div><div class="line">    <span class="comment">/*è¿”å›æœ¬PullConsumerå®ä¾‹çš„properties*/</span></div><div class="line">    <span class="comment">/* Changes to the return &#123;@code KeyValue&#125; are not reflected in physical &#123;@code PullConsumer&#125;,and use &#123;@link ResourceManager#setConsumerProperties(String, KeyValue)&#125; to modify.*/</span></div><div class="line">    <span class="function">KeyValue <span class="title">properties</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è§„èŒƒè¦æ±‚å®ç°é˜»å¡çš„æ¥å£ï¼Œç”±propertiesæ¥è®¾ç½®é˜»å¡æ—¶é—´ï¼Œä½†æœ¬èµ›é¢˜ä¸éœ€è¦ç”¨åˆ°è¯¥ç‰¹æ€§ï¼Œè¯·å®ç°ä¸€ä¸ªéé˜»å¡(ä¹Ÿå³é˜»å¡æ—¶é—´ä¸º0)è°ƒç”¨, ä¹Ÿå³æ²¡æœ‰æ¶ˆæ¯åˆ™è¿”å›null</div><div class="line">     */</div><div class="line"></div><div class="line">    <span class="comment">/*æŠ½å–ä¸‹ä¸€æ¡ä¸ºæœ¬pullconsumerç”Ÿäº§çš„æ¶ˆæ¯*/</span></div><div class="line">    <span class="comment">/*é™¤éä¸€æ¡æ¶ˆæ¯è¢«äº§ç”Ÿäº†ï¼Œæˆ–è€…æœ¬pullConsumerè¢«å…³é—­äº†ï¼Œæœ¬è°ƒç”¨ä¼šä¸€ç›´block*/</span></div><div class="line">    <span class="comment">/*è¿”å›ä¸ºæœ¬PullConsumerç”Ÿäº§çš„ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼›å½“æœ¬PullConsumerè¢«åŒæ—¶å…³é—­æ—¶è¿”å›null*/</span></div><div class="line">    <span class="comment">/*å½“æœ¬PullConsumerç”±äºä¸€äº›å†…éƒ¨åŸå› è€ŒæŠ½å–ä¸‹ä¸€æ¡æ¶ˆæ¯å¤±è´¥æ—¶ï¼Œthrow OMSRuntimeException*/</span></div><div class="line">    <span class="function">Message <span class="title">poll</span><span class="params">()</span></span>;</div><div class="line">    <span class="function">Message <span class="title">poll</span><span class="params">(<span class="keyword">final</span> KeyValue properties)</span></span>;<span class="comment">/*propertiesæ˜¯ä¸€äº›å‚æ•°*/</span></div><div class="line"></div><div class="line">    <span class="comment">/*ç”¨æ¶ˆæ¯idå›ç¡®è®¤æŒ‡å®šçš„å·²æ¶ˆè´¹çš„æ¶ˆæ¯*/</span></div><div class="line">    <span class="comment">/*è‹¥æŸæ¶ˆæ¯å·²è¢«æ¥æ”¶ï¼Œä½†è¿˜æœªè¢«å›ç¡®è®¤ï¼Œé‚£å®ƒå¯èƒ½ä¼šè¢«é‡æ–°æŠ•é€’*/</span></div><div class="line">    <span class="comment">/*æœ‰OMSRuntimeException*/</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ack</span><span class="params">(String messageId)</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ack</span><span class="params">(String messageId, <span class="keyword">final</span> KeyValue properties)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/* ç»‘å®šåˆ°ä¸€ä¸ªQueueï¼Œå¹¶è®¢é˜…topicsï¼Œå³ä»è¿™äº›topicè¯»å–æ¶ˆæ¯*/</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">attachQueue</span><span class="params">(String queueName, Collection&lt;String&gt; topics)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre>]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¤šçº¿ç¨‹]]></title>
      <url>/2017/05/12/Java-%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p><strong>çº¿ç¨‹(thread)</strong>ï¼šæ¯ä¸ªä»»åŠ¡ç§°ä¸ºä¸€ä¸ªçº¿ç¨‹<br><strong>çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«</strong>ï¼š</p>
<ol>
<li>æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„å˜é‡ï¼Œè€Œçº¿ç¨‹åˆ™å…±äº«æ•°æ®ã€‚</li>
<li>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„æ‰§è¡Œå•å…ƒ</li>
<li>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ç»„æˆéƒ¨åˆ†ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¿…é¡»æœ‰ä¸€ä¸ªçˆ¶è¿›ç¨‹ã€‚</li>
<li>çº¿ç¨‹å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„å †æ ˆã€è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨å’Œè‡ªå·±çš„å±€éƒ¨å˜é‡ï¼Œä½†ä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼ˆä¸çˆ¶è¿›ç¨‹å…¶å®ƒçº¿ç¨‹å…±äº«è¯¥è¿›ç¨‹åˆ™èµ„æºï¼‰</li>
</ol>
<h1 id="çº¿ç¨‹çš„åˆ›å»º">1. çº¿ç¨‹çš„åˆ›å»º</h1><p>æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>é€šè¿‡ç»§æ‰¿Threadæ¥åˆ›å»ºçº¿ç¨‹</li>
<li>é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹</li>
</ol>
<h2 id="é€šè¿‡ç»§æ‰¿Threadæ¥åˆ›å»ºçº¿ç¨‹">1.1. é€šè¿‡ç»§æ‰¿Threadæ¥åˆ›å»ºçº¿ç¨‹</h2><p>è¦ç‚¹ï¼šé€šè¿‡ç»§æ‰¿<code>Thread</code>ç±»åˆ›å»ºå¹¶å¯åŠ¨å¤šçº¿ç¨‹<br>æ­¥éª¤ï¼š</p>
<ol>
<li>å®šä¹‰Threadç±»çš„å­ç±»ï¼Œå¹¶é‡å†™<code>run()</code>æ–¹æ³•ï¼ˆçº¿ç¨‹æ‰§è¡Œä½“ï¼‰</li>
<li>åˆ›å»º<code>Thread</code>å­ç±»çš„å®ä¾‹(åˆ›å»ºçº¿ç¨‹å¯¹è±¡)</li>
<li><p>è°ƒç”¨<code>start()</code>ï¼ˆå¯ç”¨è¯¥çº¿ç¨‹ï¼‰</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"run\t"</span>+getName()+<span class="string">"\t"</span>);<span class="comment">//getName()è¿”å›thread name</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="keyword">new</span> FirstThread().start();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>ä»¥ä¸Šä»£ç è¾“å‡ºï¼š</p>
<pre><code>run  Thread-0
</code></pre><p><strong>ä¸€ä¸ªæœ‰æ„æ€çš„ç°è±¡</strong></p>
<p>è¿è¡Œå¦‚ä¸‹ä»£ç æ—¶ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"run\t"</span>+getName()+<span class="string">"\t"</span>);<span class="comment">//getName()è¿”å›thread name</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        <span class="comment">//è°ƒç”¨currentThread()è·å–å½“å‰çº¿ç¨‹</span></div><div class="line">        System.out.println(<span class="string">"currentThread : "</span>+Thread.currentThread().getName());</div><div class="line">        <span class="keyword">new</span> FirstThread().start();</div><div class="line">        System.out.println(<span class="string">"currentThread : "</span>+Thread.currentThread().getName());</div><div class="line">        <span class="keyword">new</span> FirstThread().start();</div><div class="line">        System.out.println(<span class="string">"currentThread : "</span>+Thread.currentThread().getName());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>æŒ‰ç…§ä»¥å‰çš„ç†è§£ï¼Œåº”è¯¥æ˜¯ï¼š</p>
<pre><code>currentThread : main
run Thread-0 
currentThread : main 
run Thread-1    
currentThread : main
</code></pre><p>å®é™…è¾“å‡ºï¼šï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯å…¶å®ƒé¡ºåºï¼‰</p>
<pre><code>currentThread : main
currentThread : main
run Thread-0    
run Thread-1    
currentThread : main
</code></pre><p>æ–°å‘ç°ï¼šå…¶å®<code>start</code>ä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œ<code>main</code>çº¿ç¨‹åœ¨ç»§ç»­è¿è¡Œã€‚<code>main</code>çº¿ç¨‹ä¸ä¼šç­‰<code>start</code>å®Œäº‹å„¿ä¹‹åå†è¿è¡Œä¸‹ä¸€å¥ï¼</p>
<h2 id="é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹">1.2. é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹</h2><pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"run\t"</span>+Thread.currentThread().getName()+<span class="string">"\t"</span>);<span class="comment">//getName()è¿”å›thread name</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        SecondThread st = <span class="keyword">new</span> SecondThread();</div><div class="line">        <span class="keyword">new</span> Thread(st,<span class="string">"new_thread_1"</span>).start();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>åŒºåˆ«ï¼š<br>éœ€è¦é€šè¿‡<code>Thread.currentThread().getName()</code>æ¥è·å–getName()<br>mainä¸åŒ</p>
<p><strong>å¤šçº¿ç¨‹å…±äº«å˜é‡</strong></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹å…±äº«å˜é‡<code>i</code>çš„æƒ…å†µï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> i;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">while</span>(i&lt;<span class="number">5</span>)&#123;</div><div class="line">            System.out.println(<span class="string">"run\t"</span>+Thread.currentThread().getName()+<span class="string">"\t"</span>+i);<span class="comment">//getName()è¿”å›thread name</span></div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        SecondThread st = <span class="keyword">new</span> SecondThread();</div><div class="line">        <span class="keyword">new</span> Thread(st,<span class="string">"thread_name_1"</span>).start();</div><div class="line">        <span class="keyword">new</span> Thread(st,<span class="string">"thread_name_2"</span>).start();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>ä¸¤æ¬¡è¿è¡Œç»“æœï¼š</p>
<pre><code>run thread_name_1    0
run thread_name_1    1
run thread_name_1    2
run thread_name_1    3
run thread_name_2    3
run thread_name_1    4

run thread_name_1    0
run thread_name_2    0
run thread_name_1    1
run thread_name_2    2
run thread_name_1    3
run thread_name_2    4
</code></pre><p><strong>å‘ç°</strong>ï¼š</p>
<ol>
<li>ä¸¤ä¸ªçº¿ç¨‹å…±æœ‰å˜é‡<code>i</code></li>
<li>çº¿ç¨‹é—´æŠ¢å èµ„æº</li>
</ol>
<h2 id="ä½¿ç”¨Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹">1.3. ä½¿ç”¨Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹</h2>]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OpenMessagingç®€ä»‹]]></title>
      <url>/2017/05/11/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-OpenMessaging%E7%AE%80%E4%BB%8B/</url>
      <content type="html"><![CDATA[<p>OpenMessagingçš„ä¸»è¦å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-12-16-24-52.png" alt=""> </p>
<p>å…¶ä¸­ï¼Œå„éƒ¨åˆ†çš„å†…å®¹å’Œå…³ç³»è§ä¸‹è¿°ã€‚</p>
<h1 id="Namespace">1. Namespace</h1><p>Namespaceå°±åƒä¸€ä¸ªcgroup namespace,æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªæœ‰å®‰å…¨ä¿éšœçš„ç‹¬ç«‹çš„ç©ºé—´ã€‚æ¯ä¸ªnamespaceéƒ½æœ‰è‡ªå·±çš„producer,consumer,topic,queueç­‰ç­‰ã€‚OpenMessagingç”¨ â€‹<strong>MessagingAccessPoint</strong>â€‹ï¼ˆæ¶ˆæ¯è®¿é—®ç‚¹ï¼‰æ¥è®¿é—®/è¯»/å†™æŒ‡å®šnamespaceçš„<strong>â€‹èµ„æº</strong>â€‹ã€‚</p>
<h1 id="Producer">2. Producer</h1><p>Openmessagingå®šä¹‰äº†ä¸¤ç§Producer:<strong>â€‹Producer</strong>â€‹å’Œ <strong>â€‹SequenceProducer</strong>â€‹</p>
<ul>
<li><strong>â€‹Producer</strong>â€‹:æä¾›å„ç§sendæ–¹æ³•ï¼Œç”¨æ¥å°†ä¸€ä¸ªæ¶ˆæ¯é€å¾€æŒ‡å®šçš„destination,<strong>Topic</strong>æˆ–è€…<strong>Queue</strong>ã€‚æ”¯æŒä¸‰ç§æ–¹å¼ï¼šåŒæ­¥ã€å¼‚æ­¥ã€å•å‘(oneway)</li>
<li><strong>SequenceProducer</strong>:é‡ç‚¹åœ¨äºé€Ÿåº¦ï¼Œä¸”æ”¯æŒæ‰¹å¤„ç†ã€‚èƒ½å‘é€å¤šä¸ªæ•°æ®å¹¶ä¸€æ¬¡æäº¤ã€‚</li>
</ul>
<h1 id="Consumer">3. Consumer</h1><p>Openmessagingå®šä¹‰äº†ä¸¤ç§Consumer::<strong>PullConsumer</strong>ã€<strong>PushConsumer</strong>å’Œ<strong>StreamConsumer</strong>.æ¯ç§Consumerä»…æ”¯æŒæ¥è‡ªäº<strong>Queue</strong>çš„consumeæ¶ˆæ¯ã€‚</p>
<ul>
<li><strong>PullConsumer</strong>:ä»æŒ‡å®šé˜Ÿåˆ—ä¸­pullsæ¶ˆæ¯ã€‚æ”¯æŒâ€œsubmit the consume<br>result by acknowledgement at any timeâ€ã€‚æ¯ä¸ªPullConsumerä»…èƒ½ä»å›ºå®šçš„é˜Ÿåˆ—ä¸­pullæ¶ˆæ¯ã€‚</li>
<li><strong>PushConsumer</strong>:å¯ä»å¤šä¸ªé˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ï¼Œä¸”è¿™ä¸ªæ¶ˆæ¯æ˜¯ç”±MOM server pushä¸Šå»çš„ã€‚PushConsumerå¯ä¾é™„äºå¤šä¸ªç‹¬ç«‹çš„ã€å…·æœ‰ä¸åŒçš„MessageListenerçš„é˜Ÿåˆ—ï¼Œå¹¶ä¸”å¯ä»¥éšæ—¶é€šè¿‡<strong>ReceivedMessageContext</strong>æäº¤ç»“æœã€‚</li>
<li><strong>StreamingConsumer</strong>:ä¸€ç§å´­æ–°çš„consumerç±»å‹ï¼Œæ˜¯ä¸€ç§é¢å‘æµçš„consumer,é¢å‘ç•™ä¿¡æ¯çš„ä¸€ä½“åŒ–ä¿¡æ¯ç³»ç»Ÿã€‚</li>
</ul>
<h1 id="Topic-Queue-and-Routing">4. Topic Queue and Routing</h1><p>è¿™ä¸‰ä¸ªæ¦‚å¿µéå¸¸ç›¸è¿‘ã€‚è™½ç„¶Topicå’ŒQueueæœ‰ä¸åŒçš„ç”¨é€”ï¼Œä½†å®ƒä»¬æ€»è®©äººè¿·æƒ‘ã€‚</p>
<h2 id="Topic">4.1. Topic</h2><p>Topicæ˜¯åŸå§‹ä¿¡æ¯çš„è½½ä½“ï¼Œç”¨æ¥holdingæ¶ˆæ¯ã€‚æ¶ˆæ¯çš„åˆ†å‘æ–¹å¼å’Œæœ‰åºæ€§æ˜¯æ²¡æœ‰å®šä¹‰çš„ã€‚</p>
<h2 id="Routing">4.2. Routing</h2><p>Topicä¸­çš„æ¶ˆæ¯æ˜¯åŸå§‹çš„ï¼Œæ˜¯å¾…å¤„ç†çš„ï¼Œä¸€èˆ¬ä¸æ˜“å¼•èµ·consumersçš„æ³¨æ„ã€‚æ€»ä¹‹ï¼ŒTopicä¸­çš„æ•°æ®æ˜¯producer-orentedï¼ˆå¯¼å‘ï¼‰çš„ï¼Œè€Œä¸æ˜¯consumer-orientedã€‚</p>
<p>å› æ­¤Routingè´Ÿè´£åŠ å·¥Topicä¸­çš„åŸå§‹æ¶ˆæ¯ï¼Œå¹¶routingå»Queueä¸­ã€‚æ¯ä¸ªRoutingæœ‰ä¸€ä¸ª<strong>æ“ä½œç®¡çº¿ï¼ˆoperator pipelineï¼‰</strong>ï¼ŒåŒ…å«ç€ä¸€ç³»åˆ—çš„æ“ä½œã€‚æ¶ˆæ¯ä¼šé€šè¿‡æ“ä½œç®¡çº¿ä»Topicæµå‘Queueã€‚</p>
<p><strong>æ“ä½œï¼ˆoperatorï¼‰</strong>æ˜¯ç”¨æ¥å¤„ç†åœ¨Routingæµé€šçš„æ¶ˆæ¯çš„ã€‚æœ‰å¾ˆå¤šæ“ä½œï¼Œä¾‹å¦‚expression operator, deduplicator operator, joiner operator, filter operator, rpc<br>operatorç­‰ç­‰ã€‚</p>
<h2 id="Queue-é˜Ÿåˆ—">4.3. Queue(é˜Ÿåˆ—)</h2><p>ç°åœ¨æ¶ˆæ¯å·²ç»è¢«routedåˆ°Queueä¸­äº†ã€‚ç°åœ¨æ¶ˆæ¯å°±å¯ä»¥è¢«consumersä½¿ç”¨äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ªQueueå¯èƒ½ä¼šè¢«åˆ†ä¸ºå‡ éƒ¨åˆ†ï¼Œæ¶ˆæ¯å¯èƒ½é€šè¿‡MessageHeader#SHARDING_KEYè¢«routedåˆ°æŸä¸ªç‰¹æ®Šçš„éƒ¨åˆ†ä¸­ã€‚</p>
<h2 id="Topicä¸Queueæ¯”è¾ƒ">4.4. Topicä¸Queueæ¯”è¾ƒ</h2><ul>
<li>éƒ½æ˜¯æ¶ˆæ¯çš„è½½ä½“</li>
<li>Topicæ˜¯preducer-orientedçš„ï¼Œè€ŒQueueæ˜¯consumer-orientedçš„</li>
<li>Topicä¸­çš„æ¶ˆæ¯æ¥è‡ªäºProducer,è€ŒQueueä¸­çš„æ¶ˆæ¯æ¥è‡ªäºTopicæˆ–è€…Producer</li>
<li>QueueåŒ…å«å‡ ä¸ªéƒ¨åˆ†ï¼Œè€ŒTopicå½¢çŠ¶æœªå®šä¹‰</li>
<li>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒQueueæ˜¯Topicçš„ä¸€ä¸ªå­é›†</li>
<li>Queueçš„åˆ›å»ºã€é”€æ¯éƒ½å¾ˆå®¹æ˜“ï¼Œä¸”ä¸produceræ— å…³</li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="openmessaging.github.io">åŸå§‹æ–‡æ¡£</a></li>
<li><a href="https://github.com/pugwoo/c/blob/master/linux_ipc/shm/shmqueue.h" target="_blank" rel="external">pugwooç”¨cå†™çš„</a></li>
<li><a href="https://github.com/openmessaging/openmessaging" target="_blank" rel="external">åŸå§‹æ–‡æ¡£æ‰’çš„API</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸­é—´ä»¶å…¥é—¨]]></title>
      <url>/2017/05/11/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%AF%94%E8%B5%9B-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%85%A5%E9%97%A8/</url>
      <content type="html"><![CDATA[<h1 id="ä¸­é—´ä»¶æ¦‚å¿µ">1. ä¸­é—´ä»¶æ¦‚å¿µ</h1><p><strong>ä¸­é—´ä»¶</strong>ï¼šå¤„äºæ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„è½¯ä»¶ã€‚</p>
<p>ä¸­é—´ä»¶ç®€å•è§£é‡Šï¼Œå¯ä»¥ç†è§£ä¸ºé¢å‘ä¿¡æ¯ç³»ç»Ÿäº¤äº’ï¼Œé›†æˆè¿‡ç¨‹ä¸­çš„é€šç”¨éƒ¨åˆ†çš„é›†åˆï¼Œå±è”½äº†åº•å±‚çš„é€šè®¯ï¼Œäº¤äº’ï¼Œè¿æ¥ç­‰å¤æ‚åˆé€šç”¨åŒ–çš„åŠŸèƒ½ï¼Œä»¥äº§å“çš„å½¢å¼æä¾›å‡ºæ¥ï¼Œç³»ç»Ÿåœ¨äº¤äº’æ—¶ï¼Œç›´æ¥é‡‡ç”¨ä¸­é—´ä»¶è¿›è¡Œè¿æ¥å’Œäº¤äº’å³å¯ï¼Œé¿å…äº†å¤§é‡çš„ä»£ç å¼€å‘å’Œäººå·¥æˆæœ¬ã€‚</p>
<p>å…¶å®ï¼Œç†è®ºä¸Šæ¥è®²ï¼Œä¸­é—´ä»¶æ‰€æä¾›çš„åŠŸèƒ½é€šè¿‡ä»£ç ç¼–å†™éƒ½å¯ä»¥å®ç°ï¼Œåªä¸è¿‡å¼€å‘çš„å‘¨æœŸå’Œéœ€è¦è€ƒè™‘çš„é—®é¢˜å¤ªå¤šï¼Œé€æ¸çš„ï¼Œè¿™äº›éƒ¨åˆ†ï¼Œä»¥ä¸­é—´ä»¶äº§å“çš„å½¢å¼è¿›è¡Œäº†æ›¿ä»£ã€‚</p>
<p>æ¯”å¦‚å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå³ç³»ç»Ÿä¹‹é—´çš„é€šè®¯ä¸äº¤äº’çš„ä¸“ç”¨é€šé“ï¼Œç±»ä¼¼äºé‚®å±€ï¼Œç³»ç»Ÿåªéœ€è¦æŠŠä¼ è¾“çš„æ¶ˆæ¯äº¤ç»™ä¸­é—´ä»¶ï¼Œç”±ä¸­é—´ä»¶è´Ÿè´£ä¼ é€’ï¼Œå¹¶ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„å„ç±»é—®é¢˜ï¼Œå¦‚ç½‘ç»œé—®é¢˜ï¼Œåè®®é—®é¢˜ï¼Œä¸¤ç«¯çš„å¼€å‘æ¥å£é—®é¢˜ç­‰å‡ç”±æ¶ˆæ¯ä¸­é—´ä»¶å±è”½äº†ï¼Œå‡ºç°äº†ç½‘ç»œæ•…éšœæ—¶ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ä¼šè´Ÿè´£ç¼“å­˜æ¶ˆæ¯ï¼Œä»¥é¿å…ä¿¡æ¯ä¸¢å¤±ã€‚ç›¸å½“äºä½ æƒ³ç»™ç¾å›½å‘ä¸€ä¸ªé‚®åŒ…ï¼Œåªéœ€è¦æŠŠé‚®åŒ…äº¤ç»™é‚®å±€ï¼Œå¡«å†™åœ°å€å’Œæ”¶ä»¶äººï¼Œè‡³äºè¿é€è¿‡ç¨‹ä¸­çš„ä¸€ç³»åˆ—é—®é¢˜ä½ éƒ½ä¸éœ€è¦å…³å¿ƒäº†ã€‚</p>
<h1 id="ä¸­é—´ä»¶åˆ†ç±»">2. ä¸­é—´ä»¶åˆ†ç±»</h1><ol>
<li>æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMOMï¼šMessage-Oriented Middlewareï¼‰</li>
<li>æ•°æ®ä¸­é—´ä»¶ï¼ˆDatabase Middlewareï¼‰</li>
<li>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ä¸­é—´ä»¶ï¼ˆRPCï¼šRemote Process Callï¼‰</li>
<li>å¯¹è±¡è¯·æ±‚ä»£ç†ä¸­é—´ä»¶ï¼ˆORBï¼šObject Request Brokerï¼‰</li>
<li>äº‹åŠ¡å¤„ç†ä¸­é—´ä»¶ï¼ˆTP Monitorï¼šTransaction Process Monitorï¼‰</li>
<li>J2EEä¸­é—´ä»¶</li>
</ol>
<h1 id="Open-Messaging">3. Open-Messaging</h1><p>æ˜¯ä¸€ä¸ªå»ºç«‹è¡Œä¸šå†…çš„æŒ‡å¼•å’Œæ¶ˆæ¯çš„åè®®ï¼ˆcharterï¼‰ã€‚å®ƒçš„streamingè§„èŒƒæä¾›äº†ä¸€ä¸ªå¯ç”¨äºç”µå­å•†åŠ¡ã€ç‰©è”ç½‘å’Œå¤§æ•°æ®çš„åŸºç¡€æ¡†æ¶ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªåœ¨åˆ†å¸ƒå¼å¼‚æ„ç¯å¢ƒä¸­é¢å‘äº‘ã€ç®€å•ã€çµæ´»å’Œç‹¬ç«‹äºè¯­è¨€çš„ç¯å¢ƒã€‚åè®®çš„ä¸€è‡´æ€§ä¼¼çš„å®ƒå¯ä»¥è·¨å¹³å°å¼€å‘å¼‚æ„æ¶ˆæ¯åº”ç”¨ç¨‹åºã€‚</p>
<p><strong>åŸŸç»“æ„</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-11-17-16-52.png" alt=""> </p>
<h1 id="æ¶ˆæ¯ä¸­é—´ä»¶-Message-Queue">4. æ¶ˆæ¯ä¸­é—´ä»¶ Message Queue</h1><p>Message Queueæ˜¯ä¸€ç§åº”ç”¨ç¨‹åºå¯¹åº”ç”¨ç¨‹åºçš„é€šä¿¡æ–¹æ³•ã€‚ç¨‹åºä¹‹é—´é€šè¿‡åœ¨æ¶ˆæ¯ä¸­å‘é€æ•°æ®è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ç›´æ¥è°ƒç”¨å½¼æ­¤æ¥é€šä¿¡ï¼Œç›´æ¥è°ƒç”¨é€šå¸¸æ˜¯ç”¨äºè¯¸å¦‚è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„æŠ€æœ¯ã€‚æ’é˜ŸæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºé€šè¿‡é˜Ÿåˆ—æ¥é€šä¿¡ã€‚é˜Ÿåˆ—çš„ä½¿ç”¨é™¤å»äº†æ¥æ”¶å’Œå‘é€åº”ç”¨ç¨‹åºåŒæ—¶æ‰§è¡Œçš„è¦æ±‚ã€‚</p>
<p>æåŠæ¶ˆæ¯ä¸­é—´ä»¶çš„æ—¶å€™ï¼Œè¿˜ä¼šæ¶‰åŠç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸¤ä¸ªæ¦‚å¿µã€‚æ¶ˆæ¯ä¸­é—´ä»¶æ˜¯è´Ÿè´£æ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¹¶å­˜å‚¨å¹¶è½¬å‘ç»™å¯¹åº”çš„æ¶ˆè´¹è€…ï¼Œç”Ÿäº§è€…å¯ä»¥æŒ‰ topic å‘å¸ƒå„æ ·æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä¹Ÿå¯ä»¥æŒ‰ topic è®¢é˜…å„æ ·æ¶ˆæ¯ã€‚ç”Ÿäº§è€…åªç®¡å¾€æ¶ˆæ¯é˜Ÿåˆ—é‡Œæ¨é€æ¶ˆæ¯ï¼Œä¸ç”¨ç­‰å¾…æ¶ˆè´¹è€…çš„å›åº”ï¼›æ¶ˆè´¹è€…åªç®¡ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®å¹¶å¤„ç†ï¼Œå¯ç”¨å¯é æ€§ç­‰é—®é¢˜éƒ½äº¤ç”±æ¶ˆæ¯ä¸­é—´ä»¶æ¥è´Ÿè´£ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-05-12-15-43-09.png" alt=""><br>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é€šå¸¸æœ‰ä¸¤ç§å¯¹åº”å…³ç³»ï¼Œä¸€ä¸ªç”Ÿäº§è€…å¯¹åº”ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä»¥åŠä¸€ä¸ªç”Ÿäº§è€…å¯¹åº”å¤šä¸ªæ¶ˆè´¹è€…ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><p>1.<a href="https://www.zhihu.com/question/19730582/answer/16390709" target="_blank" rel="external">çŸ¥ä¹FireJonesçš„å›ç­”</a><br>2.<a href="http://wiki.jikexueyuan.com/project/redis/middleware.html" target="_blank" rel="external">æå®¢å­¦é™¢ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶</a></p>
]]></content>
      
        <categories>
            
            <category> ä¸­é—´ä»¶æ¯”èµ› </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenMessaging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[pandasç›¸å…³æŠ€å·§]]></title>
      <url>/2017/05/04/Python-pandas%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="ç”¨pandasæ±‚å·®é›†">1. ç”¨pandasæ±‚å·®é›†</h1><p>ä»df1ä¸­å»é™¤æ‰df2çš„å†…å®¹</p>
<p>data={â€˜idâ€™:[1,2,3]}<br>data2={â€˜idâ€™:[3,1,4]}<br>df1=pd.DataFrame(data)<br>df2=pd.DataFrame(data2)<br>print df1<br>print df2<br>df3=df1[~df1[â€˜idâ€™].isin(df2[â€˜idâ€™])]<br>print df3</p>
<h1 id="æ±‚æŸä¸ªæ—¶é—´åŒºé—´çš„æ•°æ®é›†">2. æ±‚æŸä¸ªæ—¶é—´åŒºé—´çš„æ•°æ®é›†</h1><p>tart_t=â€™2016-04-05 00:00:00â€™<br>end_t=â€™2016-04-16 00:00:00â€™<br>action.time=pd.to_datetime(action.time,format=â€™%Y-%m-%d %H:%M:%Sâ€™)<br>starttime=pd.to_datetime(start_t,format=â€™%Y-%m-%d %H:%M:%Sâ€™)<br>endtime=pd.to_datetime(end_t,format=â€™%Y-%m-%d %H:%M:%Sâ€™)<br>action=action[(action.time<endtime)&(action.time>=starttime)]</endtime)&(action.time></p>
<h1 id="dummies">3. dummies</h1><p>æˆ‘ç†è§£get_dummiesæ˜¯å°†æ‹¥æœ‰ä¸åŒå€¼çš„å˜é‡è½¬æ¢ä¸º0/1æ•°å€¼ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œå°æ˜æœ‰é»„ã€çº¢ã€è“ä¸‰ç§é¢œè‰²çš„å¸½å­ï¼Œå°æ˜ä»Šå¤©æˆ´é»„è‰²å¸½å­ç”¨1è¡¨ç¤ºï¼Œçº¢è‰²å¸½å­ç”¨2è¡¨ç¤ºï¼Œè“è‰²å¸½å­ç”¨3è¡¨ç¤ºã€‚ä½†1ã€2ã€3æ•°å€¼å¤§å°æœ¬èº«æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œåªæ˜¯ç”¨äºåŒºåˆ†å¸½å­çš„é¢œè‰²ï¼Œå› æ­¤åœ¨å®é™…åˆ†ææ—¶ï¼Œéœ€è¦å°†1ã€2ã€3è½¬åŒ–ä¸º0ã€1ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<pre><code>import pandas as pd
xiaoming=pd.DataFrame([1,2,3],index=[&apos;yellow&apos;,&apos;red&apos;,&apos;blue&apos;],columns=[&apos;hat&apos;])
print(xiaoming)
hat_ranks=pd.get_dummies(xiaoming[&apos;hat&apos;],prefix=&apos;hat&apos;)
print(hat_ranks.head())

            hat
yellow    1
red       2
blue      3
        hat_1  hat_2  hat_3
yellow      1      0      0
red         0      1      0
blue        0      0      1
</code></pre><h1 id="å…¶å®ƒto-DataFrame">4. å…¶å®ƒto DataFrame</h1><h2 id="dict-to-DataFrame">4.1. dict to DataFrame</h2><pre><code>pd.DataFrame(d.items())
</code></pre><h1 id="fillna">5. fillna</h1><h2 id="ç”¨åŒç»„çš„å‡å€¼å¡«è¡¥">5.1. ç”¨åŒç»„çš„å‡å€¼å¡«è¡¥</h2><pre><code>&gt;&gt;&gt; df
  name  value
0    A      1
1    A    NaN
2    B    NaN
3    B      2
4    B      3
5    B      1
6    C      3
7    C    NaN
8    C      3
&gt;&gt;&gt; df[&quot;value&quot;] = df.groupby(&quot;name&quot;).transform(lambda x: x.fillna(x.mean()))
&gt;&gt;&gt; df
  name  value
0    A      1
1    A      1
2    B      2
3    B      2
4    B      3
5    B      1
6    C      3
7    C      3
8    C      3
</code></pre><h1 id="ipythonè¿è¡Œpython">6. ipythonè¿è¡Œpython</h1><p>å¯åŠ¨æ–°çš„namespaceè¿è¡Œï¼š %run main.py</p>
<p>åœ¨åŸæœ‰çš„namespaceè¿è¡Œï¼š%run -i main.py</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[pythonâ€”â€”osæ¨¡å—]]></title>
      <url>/2017/05/04/Python-os%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<h1 id="osæ¨¡å—">1. osæ¨¡å—</h1><p>osæ¨¡å—çš„ä½œç”¨ï¼š</p>
<p>ã€€ã€€osï¼Œè¯­ä¹‰ä¸ºæ“ä½œç³»ç»Ÿï¼Œæ‰€ä»¥è‚¯å®šå°±æ˜¯æ“ä½œç³»ç»Ÿç›¸å…³çš„åŠŸèƒ½äº†ï¼Œå¯ä»¥å¤„ç†æ–‡ä»¶å’Œç›®å½•è¿™äº›æˆ‘ä»¬æ—¥å¸¸æ‰‹åŠ¨éœ€è¦åšçš„æ“ä½œï¼Œå°±æ¯”å¦‚è¯´ï¼šæ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶/åˆ é™¤æŸä¸ªæ–‡ä»¶/è·å–æ–‡ä»¶å¤§å°â€¦â€¦</p>
<p>ã€€ã€€å¦å¤–ï¼Œosæ¨¡å—ä¸å—å¹³å°é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šå½“æˆ‘ä»¬è¦åœ¨linuxä¸­æ˜¾ç¤ºå½“å‰å‘½ä»¤æ—¶å°±è¦ç”¨åˆ°pwdå‘½ä»¤ï¼Œè€ŒWindowsä¸­cmdå‘½ä»¤è¡Œä¸‹å°±è¦ç”¨åˆ°è¿™ä¸ªï¼Œé¢â€¦æˆ‘æ“¦ï¼Œæˆ‘è¿˜çœŸä¸çŸ¥é“ï¼Œï¼ˆç”­ç®¡æ€ä¹ˆç€ï¼Œè‚¯å®šä¸æ˜¯pwdï¼‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä½¿ç”¨pythonä¸­osæ¨¡å—çš„os.path.abspath(name)åŠŸèƒ½ï¼Œç”­ç®¡æ˜¯linuxæˆ–è€…Windowséƒ½å¯ä»¥è·å–å½“å‰çš„ç»å¯¹è·¯å¾„ã€‚</p>
<h1 id="æ–‡ä»¶å¤¹æ“ä½œ">2. æ–‡ä»¶å¤¹æ“ä½œ</h1><h2 id="æ£€éªŒæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨">2.1. æ£€éªŒæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨</h2><pre><code>os.path.exists(directory)
</code></pre><h2 id="åˆ›å»ºæ–‡ä»¶å¤¹">2.2. åˆ›å»ºæ–‡ä»¶å¤¹</h2><pre><code>os.makedirs(directory)
</code></pre><p>å®ä¾‹ï¼š<br>æ£€éªŒæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¹‹</p>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_dir</span><span class="params">(directory)</span>:</span></div><div class="line">    flag=os.path.exists(directory)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flag:</div><div class="line">        os.makedirs(directory)</div></pre></td></tr></table></figure>
</code></pre><h2 id="éå†æŒ‡å®šç›®å½•åï¼Œæ˜¾ç¤ºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶">2.3. éå†æŒ‡å®šç›®å½•åï¼Œæ˜¾ç¤ºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</h2><pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pathDir =  os.listdir(filepath)</div><div class="line">    <span class="keyword">for</span> allDir <span class="keyword">in</span> pathDir:</div><div class="line">        <span class="keyword">print</span> allDir</div></pre></td></tr></table></figure>
</code></pre><h1 id="å‚è€ƒæ–‡çŒ®">3. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://www.cnblogs.com/MnCu8261/p/5483657.html" target="_blank" rel="external">pythonåŸºç¡€ä¹‹æ¨¡å—ä¹‹osæ¨¡å—</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[javaå­¦ä¹ ç¬”è®°3-Objectï¼ˆequal/hashCode/toStringï¼‰]]></title>
      <url>/2017/05/04/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-3-Object/</url>
      <content type="html"><![CDATA[<h1 id="Objectç‰¹æ€§">1. Objectç‰¹æ€§</h1><ul>
<li>æ‰€æœ‰ç±»çš„è¶…ç±»</li>
<li>å¯ä»¥å¼•ç”¨ä»»ä½•å¯¹è±¡</li>
</ul>
<h1 id="equalsæ–¹æ³•">2. equalsæ–¹æ³•</h1><p><code>Object</code>ç±»ä¸­çš„<code>equals</code>æ–¹æ³•åˆ¤æ–­ä¸¤å¯¹è±¡æ˜¯å¦æœ‰ç›¸åŒçš„<strong>å¼•ç”¨</strong></p>
<h2 id="equalsçš„é‡å†™">2.1. equalsçš„é‡å†™</h2><p>åœ¨å®é™…codingä¸­ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¯¹<code>equals</code>æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œä¾‹:</p>
<ol>
<li><p>å¯¹äºè¶…ç±»<code>Employee</code>ï¼š</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object otherObject)</span></span>&#123;</div><div class="line">        <span class="comment">//å¦‚æœotherObjectä¸thisæ˜¯åŒä¸€ä¸ªå¼•ç”¨</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">this</span> == therObject) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line"></div><div class="line">        <span class="comment">//å¦‚æœtherObjectä¸ºç©º</span></div><div class="line">        <span class="keyword">if</span>(therObject == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="comment">//å¦‚æœç±»å‹ä¸åŒ</span></div><div class="line">        <span class="keyword">if</span>(getClass() != otherObject.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="comment">//ç°åœ¨æˆ‘ä»¬å·²ç»ç¡®è®¤äº†otherObjectæ˜¯ä¸€ä¸ªéç©ºçš„Employeeå¯¹è±¡</span></div><div class="line">        <span class="comment">//ä¸ºäº†æ¯”è¾ƒå®ä¾‹åŸŸï¼Œæˆ‘ä»¬å°†otherObjectè½¬æ¢ä¸ºEmployeeç±»å‹</span></div><div class="line">        Employee other = (Employee) otherObject</div><div class="line"></div><div class="line">        <span class="comment">//æ£€æµ‹å®ä¾‹åŸŸæ˜¯å¦ç›¸ç­‰</span></div><div class="line">        <span class="keyword">return</span> name.equals(other.name)</div><div class="line">            &amp;&amp; salary == other.salary</div><div class="line">            &amp;&amp; hireDay.equals(other.hireDay);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> ä¸ºäº†é˜²æ­¢<code>this.name</code>æˆ–<code>this.hireDay</code>å¯èƒ½ä¸º<code>null</code>çš„æƒ…å†µï¼Œå°†æœ€åä¸€å¥æ”¹ä¸ºï¼š</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> Obejcts.equals(name,other.name)</div><div class="line">    &amp;&amp; salary == other.salary</div><div class="line">    &amp;&amp; Objects.equals(hireDay,other.hireDay);</div></pre></td></tr></table></figure>
<p> <strong><code>Obejcts.equals(a,b)</code>è¿è¡Œè¿‡ç¨‹</strong>ï¼š</p>
<ul>
<li>å¦‚æœ<code>a</code>å’Œ<code>b</code>éƒ½ä¸º<code>null</code>ï¼Œåˆ™è¿”å›true</li>
<li>å¦‚æœå…¶ä¸­ä¸€ä¸ªä¸º<code>null</code>ï¼Œè¿”å›false</li>
<li>å¦‚æœéƒ½ä¸ä¸º<code>null</code>ï¼Œåˆ™è°ƒç”¨<code>a.equals(b)</code></li>
</ul>
</li>
<li><p>å¯¹äº<code>Employee</code>çš„å­ç±»<code>Manager</code></p>
</li>
</ol>
<p>åœ¨å­ç±»ä¸­å®šä¹‰<code>euqals</code>æ–¹æ³•æ—¶ï¼Œè¦é¦–å…ˆè°ƒç”¨è¶…ç±»çš„euqalsï¼Œç„¶åæ¯”è¾ƒå­ç±»ä¸­çš„å®ä¾‹åŸŸã€‚</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object otherObject)</span></span>&#123;</div><div class="line">        <span class="comment">//å…ˆè°ƒç”¨è¶…ç±»çš„equalsæ–¹æ³•ï¼Œæ£€éªŒthisä¸otherObjectæ˜¯å¦å±äºåŒä¸€class</span></div><div class="line">        <span class="keyword">if</span>(!<span class="keyword">super</span>.equals(otherObject)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        Manager other = (Manager) otherObejct;</div><div class="line">        <span class="keyword">return</span> bonus == other.bonus</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><h2 id="equalsæ–¹æ³•çš„ç‰¹æ€§">2.2. equalsæ–¹æ³•çš„ç‰¹æ€§</h2><ul>
<li>è‡ªåæ€§ï¼šè‹¥<code>x!=null</code>,åˆ™<code>x.equals(x)</code>åº”è¿”å›<code>true</code></li>
<li>å¯¹ç§°æ€§ï¼š<code>y.equals(x)</code>ä¸<code>x.euqals(y)</code>åº”è¿”å›åŒæ ·ç»“æœ</li>
<li>ä¼ é€’æ€§ï¼šè‹¥<code>x.equals(y)</code>è¿”å›<code>true</code>,ä¸”<code>y.equals(z)</code>è¿”å›<code>true</code>ï¼Œåˆ™<code>x.equals(z)</code>ä¹Ÿå¿…é¡»è¿”å›<code>true</code></li>
<li>ä¸€è‡´æ€§ï¼šè‹¥xä¸yçš„å¼•ç”¨å¯¹è±¡æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™åå¤è°ƒç”¨<code>x.equals(y)</code>åº”è¿”å›åŒæ ·ç»“æœ</li>
<li>å¯¹ä»»æ„éç©ºå¼•ç”¨xï¼Œåˆ™<code>x.equals(null)</code>åº”è¯¥è¿”å›false</li>
</ul>
<h2 id="ç›¸ç­‰æµ‹è¯•">2.3. ç›¸ç­‰æµ‹è¯•</h2><p><strong>é—®é¢˜</strong><br>å¦‚æœéšå¼ï¼ˆthisï¼‰å’Œæ˜¾å¼ï¼ˆä¼ å…¥çš„ï¼‰çš„å‚æ•°ä¸å±äºåŒä¸€ç±»ï¼Œequalsæ–¹æ³•å¦‚ä½•å¤„ç†ï¼Ÿ</p>
<p><strong>è§£å†³æ–¹æ³•ä¸€</strong><br>åœ¨ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†<code>getClass()</code>ï¼š</p>
<pre><code>//å¦‚æœç±»å‹ä¸åŒ
      if(getClass() != otherObject.getClass()) return false;
</code></pre><p><strong>è§£å†³æ–¹æ³•äºŒ</strong><br>æœ‰çš„ç¨‹åºå‘˜å–œæ¬¢ç”¨<code>instanceof</code>æ£€æµ‹ï¼š<br>(instanceof è¿ç®—ç¬¦æ˜¯ç”¨æ¥åœ¨è¿è¡Œæ—¶æŒ‡å‡ºå¯¹è±¡æ˜¯å¦æ˜¯ç‰¹å®šç±»çš„ä¸€ä¸ªå®ä¾‹)</p>
<pre><code>if(!(otherObeject instanceof Employee)) return false;
</code></pre><p><strong>æ–¹æ³•ä¸€å­˜åœ¨çš„é—®é¢˜</strong><br>è‹¥<code>e</code>æ˜¯ä¸€ä¸ª<code>Employee</code>å¯¹è±¡ï¼Œ<code>m</code>æ˜¯ä¸€ä¸ª<code>Manager</code>å¯¹è±¡ï¼Œä¸”ä¸¤è€…å…·æœ‰ç›¸åŒå§“åã€è–ªæ°´å’Œé›‡ç”¨æ—¥æœŸã€‚</p>
<p>å¦‚æœ<code>Manager</code>æ²¡æœ‰é‡æ–°å®ç°<code>equals</code>æ–¹æ³•ï¼Œé‚£ä¹ˆå½“<code>m1.equals(m2)</code>æ¯”è¾ƒæ—¶ï¼Œå°±ä¼šä½¿ç”¨åˆ°<code>e.getClass() != m2.getClass()</code>æ¥è¿›è¡Œæ¯”è¾ƒï¼Œæ˜¾ç„¶ç»“æœè¿”å›<code>false</code>ï¼Œå› æ­¤è¿™ä¸æ˜¯æ­£ç¡®çš„æ¯”è¾ƒã€‚</p>
<p><strong>æ–¹æ³•äºŒå­˜åœ¨çš„é—®é¢˜</strong><br>é‚£ä¹ˆå¯¹äº<code>e.equals(m)</code>æ¥è¯´ï¼Œ<code>instanceof</code>è¿”å›<code>true</code>.ï¼ˆ<code>Manager</code>æ˜¯<code>Employee</code>çš„ä¸€ä¸ªå®ä¾‹ï¼‰<br>ä½†å¯¹äº<code>m.equals(e)</code>æ¥è¯´ï¼Œ<code>instanceof</code>è¿”å›<code>false</code></p>
<p>ï¼ï¼ï¼ï¼ï¼è¿åäº†å¯¹ç§°æ€§ï¼</p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li>å¦‚æœå­ç±»æ‹¥æœ‰è‡ªå·±çš„ç›¸ç­‰æ¦‚å¿µï¼Œä¾‹å¦‚è‹¥ä¸¤ä¸ª<code>Manager</code>å¯¹è±¡çš„å§“åã€è–ªæ°´å’Œé›‡ç”¨æ—¥æœŸï¼ˆçˆ¶ç±»Employeeçš„åŸŸï¼‰å‡ç›¸ç­‰ï¼Œè€Œå¥–é‡‘ï¼ˆå­ç±»Managerçš„åŸŸï¼‰ä¸ç›¸ç­‰ï¼Œå°±è®¤ä¸ºä¸¤ä¸ª<code>Manager</code>ä¸ç›¸ç­‰ã€‚æ­¤æ—¶å¯ä»¥ç”¨<code>getClass</code>æ£€æµ‹</li>
<li>å¦‚æœä½¿ç”¨é›‡å‘˜ID(çˆ¶ç±»Employeeçš„åŸŸ)æ¥ä½œä¸ºç›¸ç­‰æ£€æµ‹æ ‡å‡†ï¼Œå¹¶è¿™ä¸ªæ ‡å‡†é€‚åˆæ‰€æœ‰çš„å­ç±»ï¼Œå°±å¯ä»¥ç”¨<code>instanceof</code>æ£€æµ‹ï¼Œå¹¶å°†<code>Employee</code>çš„<code>equals</code>ç”³æ˜ä¸º<code>final</code></li>
</ul>
<p><strong>å®Œç¾çš„equals</strong>ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object otherObject)</span></span>&#123;</div><div class="line">    <span class="comment">//æ£€æµ‹thisä¸otherObjectæ˜¯å¦å¼•ç”¨åŒä¸€å¯¹è±¡</span></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>==otherObject)<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    <span class="comment">//æ£€æµ‹otherObjectæ˜¯å¦ä¸ºnull</span></div><div class="line">    <span class="keyword">if</span>(otherObject == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="comment">//æ¯”è¾ƒthisä¸Objectæ˜¯å¦å±äºåŒä¸€ä¸ªç±»ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆï¼š</span></div><div class="line">    <span class="comment">//å¦‚æœequalsçš„è¯­ä¹‰åœ¨æ¯ä¸ªå­ç±»ä¸­éƒ½æœ‰æ”¹å˜ï¼Œå°±ç”¨getClass:</span></div><div class="line">    <span class="keyword">if</span>(getClass() != otherObject.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="comment">//å¦‚æœæ‰€æœ‰å­ç±»éƒ½æœ‰ç»Ÿä¸€equalsè¯­ä¹‰ï¼Œåˆ™ç”¨instanceofæ£€æµ‹ï¼š</span></div><div class="line">    <span class="keyword">if</span>(!(otherObject <span class="keyword">instanceof</span> ClassName)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="comment">//å°†otherObjectè½¬æ¢ä¸ºç›¸åº”çš„ç±»ç±»å‹</span></div><div class="line">    ClassName other = (ClassName) otherObject</div><div class="line">    <span class="comment">//å¯¹æ‰€éœ€è¦çš„åŸŸè¿›è¡Œæ¯”è¾ƒ</span></div><div class="line">    <span class="keyword">return</span> field1 == other.field1 </div><div class="line">        &amp;&amp; field2 == other.field2</div><div class="line">        &amp;&amp; Objects.equals(field3,other field3)</div><div class="line">        &amp;&amp; ...;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœåœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰<code>equals</code>ï¼Œåˆ™è¦åœ¨å…¶ä¸­åŒ…å«è°ƒç”¨<code>super.equals(other)</code></p>
<h1 id="hashCodeæ–¹æ³•">3. hashCodeæ–¹æ³•</h1><p>hashCode : æ•£åˆ—ç </p>
<p>ä½¿ç”¨ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> hash = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; lenth() ; i++ )&#123;</div><div class="line">    hash = <span class="number">31</span> * hash + charAt(i)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p><strong>æ³¨æ„</strong></p>
<ul>
<li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<em>é»˜è®¤çš„æ•£åˆ—ç </em>ï¼Œå€¼ä¸ºå¯¹è±¡çš„<em>å­˜å‚¨åœ°å€</em></li>
<li>å­—ç¬¦ä¸²çš„æ•£åˆ—ç æ˜¯ç”±å†…å®¹å¯¼å‡ºçš„ï¼Œå› æ­¤<code>s</code>å’Œ<code>t</code>æœ‰ç›¸åŒhashcode</li>
<li>å¦‚æœé‡æ–°å®šä¹‰äº†equalsæ–¹æ³•ï¼Œå°±å¿…é¡»é‡æ–°å®šä¹‰hashCodeæ–¹æ³•ï¼Œä¸”é€šè¿‡equalæµ‹è¯•çš„ä¸¤ä¸ªå¯¹è±¡çš„hashCodeåº”è¯¥ä¹Ÿæ˜¯ç›¸ç­‰çš„ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥å°†å¯¹è±¡æ’å…¥åˆ°æ•£åˆ—è¡¨ä¸­</li>
<li>hashCodeæ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªæ•´å‹æ•°å€¼ï¼Œå¹¶ä½¿å¾—ä¸åŒå¯¹è±¡çš„hashCodeæ›´å‡åŒ€ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">7</span> * name.hashCode()</div><div class="line">            + <span class="number">11</span> * <span class="keyword">new</span> Double(salary).hashCode()</div><div class="line">            + <span class="number">13</span> * hireDay.hashCode();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> Objects.hash(name,salary,hireDay);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><h1 id="toStringæ–¹æ³•">4. toStringæ–¹æ³•</h1><p>ç”¨é€”ï¼šè¿”å›è¡¨ç¤ºå¯¹è±¡å€¼çš„å­—ç¬¦ä¸²</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> getClass().getName()</div><div class="line">        + <span class="string">"[name="</span> + name</div><div class="line">        + <span class="string">",salary="</span> + salary</div><div class="line">        + <span class="string">",hireDay="</span> + hireDay</div><div class="line">        +<span class="string">"]"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>ç‰¹åˆ«åœ°ï¼š</p>
<ol>
<li>åªè¦å¯¹è±¡ä¸ä¸€ä¸ªå­—ç¬¦ä¸²é€šè¿‡æ“ä½œç¬¦â€œ+â€è¿æ¥èµ·æ¥ï¼Œæˆ–ä½¿ç”¨System.out.println(x)ï¼ŒJavaç¼–è¯‘å°±ä¼šè‡ªåŠ¨è°ƒç”¨toStringæ–¹æ³•ã€‚</li>
<li>Objectç±»å®šä¹‰äº†toStringæ–¹æ³•ï¼Œç”¨æ¥æ‰“å°è¾“å‡ºå¯¹è±¡æ‰€å±çš„ç±»åå’Œæ•£åˆ—ç ã€‚</li>
<li>æœ‰è¶£çš„æ˜¯ï¼Œæ•°ç»„ç»§æ‰¿äº†objectç±»çš„toStringæ–¹æ³•ã€‚ä¿®æ­£çš„æ–¹æ³•æ˜¯é‡‡ç”¨Array.toString.ä¾‹å¦‚<code>String s = Array.toString(luckyNumbers)</code>ã€‚å¤šç»´æ•°ç»„éœ€è¦è°ƒç”¨<code>Array.deepToString</code>æ–¹æ³•ã€‚</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[xgboostå‚æ•°è°ƒèŠ‚å®Œå…¨æŒ‡å—ï¼ˆPythonç‰ˆï¼‰]]></title>
      <url>/2017/04/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A1%86%E6%9E%B6-xgboost%E5%8F%82%E6%95%B0/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡å¤§å¤šæ¥è‡ªäºå‚è€ƒæ–‡çŒ®2.çš„ç¿»è¯‘ã€‚</p>
<h1 id="Xgboostå‚æ•°">1. Xgboostå‚æ•°</h1><p>XGBoostä½œè€…å°†å‚æ•°åˆ†ä¸º3ç±»ï¼š</p>
<ol>
<li>åŸºæœ¬(General)å‚æ•°ï¼šæŒ‡å¯¼æ•´ä½“å‡½æ•°</li>
<li>æå‡(Booster)å‚æ•°ï¼šåœ¨æ¯ä¸€æ­¥æŒ‡å¯¼æ¯ä¸ªæå‡ï¼ˆæ ‘æˆ–å›å½’ï¼‰</li>
<li>å­¦ä¹ ä»»åŠ¡(Learning Task Parameters)å‚æ•°ï¼šæŒ‡å¯¼ä¼˜åŒ–æ¨¡å‹è¡¨ç°</li>
</ol>
<h2 id="åŸºæœ¬å‚æ•°">1.1. åŸºæœ¬å‚æ•°</h2><h3 id="booster">1.1.1. booster</h3><ol>
<li>é»˜è®¤å€¼ï¼šgbtree</li>
<li>å«ä¹‰ï¼šåœ¨æ¯æ¬¡è¿­ä»£ä¸­çš„æ¨¡å‹ç±»å‹ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š</li>
</ol>
<ul>
<li>gbtree:æ ‘æ¨¡å‹</li>
<li>gblinear:çº¿æ€§æ¨¡å‹</li>
</ul>
<h3 id="silent">1.1.2. silent</h3><ol>
<li>é»˜è®¤å€¼ï¼š0</li>
<li>å«ä¹‰</li>
</ol>
<ul>
<li>0=è¿è¡Œæ—¶æ‰“å°running messages</li>
<li>1=ä¸æ‰“running messages</li>
</ul>
<h3 id="nthread">1.1.3. nthread</h3><ol>
<li>è¿è¡Œæ—¶çš„æœ€å¤§çº¿ç¨‹æ•°</li>
<li>é»˜è®¤å€¼ï¼šå å½“å‰è®¡ç®—æœºçš„æœ€å¤§çº¿ç¨‹</li>
</ol>
<h2 id="æå‡å‚æ•°">1.2. æå‡å‚æ•°</h2><p>è¿™é‡Œä»…ä»…ä»‹ç»æ ‘æ¨¡å‹ï¼ˆgbtreeï¼‰çš„ç›¸å…³å‚æ•°ã€‚</p>
<h3 id="eta">1.2.1. eta</h3><ol>
<li>å­¦ä¹ æ­¥é•¿</li>
<li>default=0.3</li>
<li>ä¸€èˆ¬è°ƒæ•´ä¸‹é™ä¸º0.01-0.2</li>
</ol>
<h3 id="min-child-weight">1.2.2. min_child_weight</h3><ol>
<li>è¡¨ç¤ºæ‰€æœ‰å­©å­èŠ‚ç‚¹(all observations required in a child)çš„æœ€å°æƒé‡å’Œ</li>
<li>ä¸€èˆ¬éƒ½ç”¨æ¥æ§åˆ¶è¿‡æ‹Ÿåˆã€‚</li>
<li>ä½†å¦‚æœè°ƒå¾—å¤ªé«˜å°±ä¼šå¯¼è‡´æ¬ æ‹Ÿåˆã€‚</li>
<li>default=1</li>
</ol>
<h3 id="max-depth">1.2.3. max_depth</h3><ol>
<li>default=6</li>
<li>ç”¨æ¥æ§åˆ¶è¿‡æ‹Ÿåˆ</li>
<li>ä¸€èˆ¬åœ¨3-10ä¹‹é—´</li>
</ol>
<h3 id="gamma">1.2.4. gamma</h3><ol>
<li>default=0</li>
<li>range: [0,âˆ]</li>
<li>æ¨¡å‹åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹çš„åˆ’åˆ†åªæœ‰åœ¨å…¶æŸå¤±å‡½æ•°å¾—åˆ°ç»“æœå¤§äº0çš„æƒ…å†µä¸‹æ‰è¿›è¡Œï¼Œè€Œgammaç»™å®šäº†æ‰€éœ€çš„æœ€ä½æŸå¤±å‡½æ•°çš„å€¼</li>
<li>gammaå€¼ä½¿å¾—ç®—æ³•æ›´conservationï¼Œä¸”å…¶å€¼ä¾èµ–äºæŸå¤±å‡½æ•°ï¼Œåœ¨æ¨¡å‹ä¸­åº”è¯¥è¿›è¡Œè°ƒå‚ã€‚</li>
</ol>
<h3 id="max-delta-step">1.2.5. max_delta_step</h3><ol>
<li>default=0</li>
<li>åœ¨æœ€å¤§åŒ–æ­¥é•¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…è®¸æ¯ä¸ªæ ‘çš„æƒé‡å»ä¼°ç®—å®ƒã€‚</li>
<li>å½“max_delta_step=0æ—¶ï¼Œæ„å‘³ç€æ²¡æœ‰è¯¯å·®</li>
<li>å½“max_delta_step&gt;0æ—¶ï¼Œæ„å‘³ç€ç»“æœæ›´ä¿å®ˆ</li>
<li>ä¸€èˆ¬ä¸éœ€è¦è°ƒå‚ã€‚ä½†å½“ç±»åˆ«åŠä¸å¹³è¡¡çš„é€»è¾‘å›å½’æ—¶å¯èƒ½ä¼šç”¨åˆ°ã€‚</li>
</ol>
<h3 id="subsample-default-1">1.2.6. subsample [default=1]</h3><p>Same as the subsample of GBM. Denotes the fraction of observations to be randomly samples for each tree.<br>Lower values make the algorithm more conservative and prevents overfitting but too small values might lead to under-fitting.<br>Typical values: 0.5-1</p>
<h3 id="colsample-bytree-default-1">1.2.7. colsample_bytree [default=1]</h3><p>Similar to max_features in GBM. Denotes the fraction of columns to be randomly samples for each tree.</p>
<p>Typical values: 0.5-1</p>
<h3 id="colsample-bylevel-default-1">1.2.8. colsample_bylevel [default=1]</h3><p>Denotes the subsample ratio of columns for each split, in each level.<br>I donâ€™t use this often because subsample and colsample_bytree will do the job<br>for you. but you can explore further if you feel so.</p>
<h3 id="lambda-default-1">1.2.9. lambda [default=1]</h3><p>L2 regularization term on weights (analogous to Ridge regression)<br>This used to handle the regularization part of XGBoost. Though many data scientists donâ€™t use it often, it should be explored to reduce overfitting.</p>
<h3 id="alpha-default-0">1.2.10. alpha [default=0]</h3><p>L1 regularization term on weight (analogous to Lasso regression)<br>Can be used in case of very high dimensionality so that the algorithm runs faster when implemented</p>
<h3 id="scale-pos-weight-default-1">1.2.11. scale_pos_weight [default=1]</h3><p>A value greater than 0 should be used in case of high class imbalance as it helps in faster convergence.<br>Control the balance of positive and negative weights, useful for unbalanced classes. A typical value to consider: sum(negative cases) / sum(positive cases) See Parameters Tuning for more discussion. Also see Higgs Kaggle competition demo for examples: R, py1, py2, py3</p>
<p>æ§åˆ¶æ­£è´Ÿæ ·æœ¬æƒé‡çš„å¹³è¡¡ã€‚ä¸€èˆ¬å¯¹éå¹³è¡¡çš„å¾ˆæœ‰ç”¨ã€‚ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„å–å€¼æ˜¯ï¼šè´Ÿæ ·æœ¬ä¸ªæ•°/æ­£æ ·æœ¬ä¸ªæ•°ã€‚</p>
<h3 id="ä¸å‡è¡¡æ•°æ®åœ¨xgboostä¸­çš„å¤„ç†">1.2.12. ä¸å‡è¡¡æ•°æ®åœ¨xgboostä¸­çš„å¤„ç†</h3><p><a href="https://github.com/dmlc/xgboost/blob/master/doc/how_to/param_tuning.md" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>:</p>
<p>å¯¹äºä¸€äº›caseï¼Œæ¯”å¦‚ï¼šå¹¿å‘Šç‚¹å‡»æ—¥å¿—ï¼Œæ•°æ®é›†æä¸å¹³è¡¡ã€‚è¿™ä¼šå½±å“xgboostæ¨¡å‹çš„è®­ç»ƒï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•æ¥æ”¹è¿›å®ƒã€‚</p>
<p>å¦‚æœä½ å…³å¿ƒçš„é¢„æµ‹çš„ranking orderï¼ˆAUC)ï¼š â€“ é€šè¿‡scale_pos_weightæ¥å¹³è¡¡æ­£è´Ÿç±»çš„æƒé‡ â€“ ä½¿ç”¨AUCè¿›è¡Œè¯„ä¼°</p>
<p>å¦‚æœä½ å…³å¿ƒçš„æ˜¯é¢„æµ‹çš„æ­£ç¡®ç‡ï¼š â€“ ä¸èƒ½å†å¹³è¡¡ï¼ˆre-balanceï¼‰æ•°æ®é›† â€“ å°†å‚æ•°max_delta_stepè®¾ç½®åˆ°ä¸€ä¸ªæœ‰é™çš„æ•°ï¼ˆæ¯”å¦‚ï¼š1ï¼‰å¯ä»¥è·å¾—æ•ˆæœæå‡.</p>
<h2 id="å­¦ä¹ ä»»åŠ¡å‚æ•°">1.3. å­¦ä¹ ä»»åŠ¡å‚æ•°</h2><h3 id="objective-default-reg-linear">1.3.1. objective [default=reg:linear]</h3><ol>
<li>default=reg:linear</li>
<li>å®šä¹‰å­¦ä¹ ä»»åŠ¡åŠç›¸åº”çš„å­¦ä¹ ç›®æ ‡ï¼Œå¯é€‰çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š</li>
</ol>
<ul>
<li>â€œreg:linearâ€ â€“çº¿æ€§å›å½’ã€‚</li>
<li>â€œreg:logisticâ€ â€“é€»è¾‘å›å½’ã€‚</li>
<li>â€œbinary:logisticâ€ â€“äºŒåˆ†ç±»çš„é€»è¾‘å›å½’é—®é¢˜ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡ã€‚</li>
<li>â€œbinary:logitrawâ€ â€“äºŒåˆ†ç±»çš„é€»è¾‘å›å½’é—®é¢˜ï¼Œè¾“å‡ºçš„ç»“æœä¸ºwTxã€‚</li>
<li>â€œcount:poissonâ€ â€“è®¡æ•°é—®é¢˜çš„poissonå›å½’ï¼Œè¾“å‡ºç»“æœä¸ºpoissonåˆ†å¸ƒã€‚åœ¨poissonå›å½’ä¸­ï¼Œmax_delta_stepçš„ç¼ºçœå€¼ä¸º0.7ã€‚(used to safeguard optimization)</li>
<li>â€œmulti:softmaxâ€ â€“è®©XGBoosté‡‡ç”¨softmaxç›®æ ‡å‡½æ•°å¤„ç†å¤šåˆ†ç±»é—®é¢˜ï¼ŒåŒæ—¶éœ€è¦è®¾ç½®å‚æ•°num_classï¼ˆç±»åˆ«ä¸ªæ•°ï¼‰</li>
<li>â€œmulti:softprobâ€ â€“å’Œsoftmaxä¸€æ ·ï¼Œä½†æ˜¯è¾“å‡ºçš„æ˜¯ndata * nclassçš„å‘é‡ï¼Œå¯ä»¥å°†è¯¥å‘é‡reshapeæˆndataè¡Œnclassåˆ—çš„çŸ©é˜µã€‚æ²¡è¡Œæ•°æ®è¡¨ç¤ºæ ·æœ¬æ‰€å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚</li>
<li>â€œrank:pairwiseâ€ â€“set XGBoost to do ranking task by minimizing the pairwise loss</li>
<li></li>
</ul>
<h3 id="eval-metric">1.3.2. eval_metric</h3><ol>
<li>é»˜è®¤å€¼æ ¹æ®objectiveå‚æ•°è°ƒæ•´</li>
<li>ç”¨æ¥éªŒè¯æ•°æ®çš„å‚æ•°</li>
<li>å‡ ä¸ªå…¸å‹å€¼ï¼š</li>
</ol>
<ul>
<li>rmse â€“ root mean square error</li>
<li>mae â€“ mean absolute error</li>
<li>logloss â€“ negative log-likelihood</li>
<li>error â€“ Binary classification error rate (0.5 threshold)</li>
<li>merror â€“ Multiclass classification error rate</li>
<li>mlogloss â€“ Multiclass logloss</li>
<li>auc: Area under the curve</li>
</ul>
<h3 id="seed-default-0">1.3.3. seed [default=0]</h3><p>The random number seed.<br>Can be used for generating reproducible results and also for parameter tuning.</p>
<h1 id="ä¾‹ï¼šCTRé—®é¢˜çš„æ­£æ ·æœ¬è¿‡å°‘">2. ä¾‹ï¼šCTRé—®é¢˜çš„æ­£æ ·æœ¬è¿‡å°‘</h1><p>å‚è€ƒæ–‡çŒ®[xgboostå¯¼è¯»å’Œå®æˆ˜]</p>
<p>ã€Šxgboostå¯¼è¯»å’Œå®æˆ˜ã€‹ä¸­æåˆ°ï¼ŒCTRé—®é¢˜çš„æ­£æ ·æœ¬å¾ˆç¨€ç–ï¼Œæ ¹æ®ç†è®ºæ¨å¯¼ï¼Œä¼šå¯¼è‡´å¶å­èŠ‚ç‚¹æƒé‡å˜å¤§ï¼Œè¿›è€Œå¯¼è‡´æ¯ä¸€æ­¥çš„ä¼°è®¡stepè¿‡å¤§ã€‚</p>
<p>è¿™æ—¶å¯ä»¥è°ƒèŠ‚ä»¥ä¸‹å‚æ•°ï¼š</p>
<p><code>min_child_weight</code></p>
<p>é»˜è®¤ä¸º1.æ˜¯æ¯ä¸ªå¶å­é‡Œhçš„å’Œè‡³å°‘æ˜¯å¤šå°‘ã€‚å¯¹æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡æ—¶çš„0-1åˆ†ç±»è€Œè¨€ï¼Œå‡è®¾håœ¨0.01é™„è¿‘ï¼Œmin_child_weightä¸º1æ„å‘³ç€å¶å­èŠ‚ç‚¹ä¸­æœ€å°‘éœ€è¦åŒ…å«100 ä¸ªæ ·æœ¬ã€‚è¿™ä¸ªå‚æ•°éå¸¸å½±å“ç»“æœï¼Œæ§åˆ¶å¶å­èŠ‚ç‚¹ä¸­äºŒé˜¶å¯¼çš„å’Œçš„æœ€å°å€¼ï¼Œè¯¥å‚æ•°å€¼è¶Šå°ï¼Œè¶Šå®¹æ˜“ overfittingã€‚</p>
<p><code>eta</code><br>shrinkage å‚æ•°ï¼Œç”¨äºæ›´æ–°å¶å­èŠ‚ç‚¹æƒé‡æ—¶ï¼Œä¹˜ä»¥è¯¥ç³»æ•°ï¼Œé¿å…æ­¥é•¿è¿‡å¤§ã€‚å‚æ•°å€¼è¶Šå¤§ï¼Œè¶Šå¯èƒ½æ— æ³•æ”¶æ•›ã€‚æŠŠå­¦ä¹ ç‡etaè®¾ç½®çš„å°ä¸€äº›ï¼Œå°å­¦ä¹ ç‡å¯ä»¥ä½¿å¾—åé¢çš„å­¦ä¹ æ›´åŠ ä»”ç»†ã€‚</p>
<p><code>scale_pos_weight</code><br>å¦‚æœä¼˜åŒ–çš„æ˜¯ä»…ä»…å±•ç¤ºæ’åºï¼Œå°±æ˜¯AUCçš„è¯ï¼Œå¯ä»¥é‡‡ç”¨å¹³è¡¡æ­£è´Ÿæ ·æœ¬æƒé‡çš„<br>åŠæ³•è°ƒå¤§æ­£æ ·æœ¬æƒé‡ã€‚è®¾ç½® scale_pos_weightå°±å¯ä»¥æŠŠæ­£æ ·æœ¬æƒé‡ä¹˜è¿™ä¸ªç³»æ•°ã€‚å¦‚æœè¿˜éœ€è¦ä¼˜åŒ–å›å½’çš„æ€§èƒ½ï¼Œè¿˜éœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šåšä¸‹ recalibrationã€‚</p>
<p><code>max_delta_step</code><br>å¦‚æœè®¾ç«‹äº†è¯¥å€¼ï¼Œå¯¹å¶å­èŠ‚ç‚¹çš„æƒé‡å€¼åšäº†çº¦æŸåœ¨ [max_delta_step,max_delta_step]ã€‚ä»¥é˜²åœ¨æŸäº› loss ä¸‹æƒé‡å€¼è¿‡å¤§ï¼Œé»˜è®¤æ˜¯ 0ï¼ˆå…¶å®ä»£è¡¨ inf)ã€‚å¯ä»¥è¯•è¯•æŠŠè¿™ä¸ªå‚æ•°è®¾ç½®åˆ° 1-10 ä¹‹é—´çš„ä¸€ä¸ªå€¼ã€‚è¿™æ ·ä¼šé˜²æ­¢åšå¤ªå¤§çš„æ›´æ–°æ­¥å­ï¼Œ<br>ä½¿å¾—æ›´æ–°æ›´åŠ å¹³ç¼“ã€‚</p>
<h1 id="äº¤å‰éªŒè¯">3. äº¤å‰éªŒè¯</h1><p>xgboostè‡ªå¸¦çš„äº¤å‰éªŒè¯æ®è¯´å¾ˆå¥½ç”¨ã€‚</p>
<p>ä¸‹é¢æ˜¯å‚è€ƒæ–‡çŒ®3ç»™å‡ºçš„ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹ï¼š</p>
<pre><code>cvresult = xgb.cv(xgb_param, 
                    xgtrain, num_boost_round=alg.get_params()[&apos;n_estimators&apos;],
                    nfold=cv_folds,
                    metrics=&apos;auc&apos;, early_stopping_rounds=early_stopping_rounds, show_progress=False)
</code></pre><p>å…¶ä¸­ï¼š</p>
<ul>
<li>xgb_paramsï¼šå‚æ•°</li>
<li>xgtrain:è®­ç»ƒé›†</li>
<li>num_boost_roundï¼šæ ‘ä¸ªæ•°ï¼ˆè¿­ä»£æ¬¡æ•°ï¼‰</li>
<li>nfold:kfoldçš„k</li>
<li>metrics:åœ¨CVä¸­çš„è¯„ä»·åº¦é‡æŒ‡æ ‡</li>
<li>early_stopping_roundsï¼šActivates early stopping. CV error needs to decrease at least every <early_stopping_rounds> round(s) to continue. Last entry in evaluation history is the one from best iteration.</early_stopping_rounds></li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">4. å‚è€ƒæ–‡çŒ®</h1><ol>
<li>ã€Šxgboostå¯¼è¯»å’Œå®æˆ˜ã€‹</li>
<li><a href="http://wepon.me/2016/05/07/XGBoost%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA/" target="_blank" rel="external">Xgboostæ·±å…¥æµ…å‡º</a></li>
<li><a href="https://www.analyticsvidhya.com/blog/2016/03/complete-guide-parameter-tuning-xgboost-with-codes-python/" target="_blank" rel="external">Complete Guide to Parameter Tuning in XGBoost (with codes in Python)</a></li>
<li><a href="http://xgboost.readthedocs.io/en/latest/parameter.html" target="_blank" rel="external">xgboostå‚æ•°å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="http://blog.csdn.net/u010657489/article/details/51952785" target="_blank" rel="external">XGBoostå‚æ•°è°ƒä¼˜å®Œå…¨æŒ‡å—ï¼ˆé™„Pythonä»£ç ï¼‰</a></li>
<li><a href="http://d0evi1.com/sklearn/imbalanced_classes/" target="_blank" rel="external">å¦‚ä½•å¤„ç†åæ–œç±»(imbalanced classes)</a></li>
<li><a href="https://github.com/dmlc/xgboost/blob/master/doc/parameter.md" target="_blank" rel="external">XGBoost Parameters</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ æ¡†æ¶ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç‰¹å¾å·¥ç¨‹]]></title>
      <url>/2017/04/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-O2O%E4%BC%98%E6%83%A0%E5%88%B8%E9%A2%84%E6%B5%8B-%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h1 id="ç‰¹å¾å·¥ç¨‹">1. ç‰¹å¾å·¥ç¨‹</h1><h2 id="åˆ«äººçš„ä¾‹å­">1.1. åˆ«äººçš„ä¾‹å­</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-25-16-54-35.png" alt=""><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-25-16-54-53.png" alt=""> </p>
<h2 id="ç‰¹å¾é€‰æ‹©">1.2. ç‰¹å¾é€‰æ‹©</h2><p>ç‰¹å¾é€‰æ‹©ï¼Œå°±æ˜¯ä»å¤šä¸ªç‰¹å¾ä¸­ï¼ŒæŒ‘é€‰å‡ºä¸€äº›å¯¹ç»“æœé¢„æµ‹æœ€æœ‰ç”¨çš„ç‰¹å¾ã€‚å› ä¸ºåŸå§‹çš„ç‰¹å¾ä¸­å¯èƒ½ä¼šæœ‰å†—ä½™å’Œå™ªå£°ã€‚<br>ç‰¹å¾é€‰æ‹©å’Œé™ç»´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå‰è€…åªè¸¢æ‰åŸæœ¬ç‰¹å¾é‡Œå’Œç»“æœé¢„æµ‹å…³ç³»ä¸å¤§çš„ï¼Œ åè€…åšç‰¹å¾çš„è®¡ç®—ç»„åˆæ„æˆæ–°ç‰¹å¾ã€‚</p>
<h3 id="è¿‡æ»¤å‹">1.2.1. è¿‡æ»¤å‹</h3><ul>
<li>æ–¹æ³•ï¼šâ€¯ è¯„ä¼°å•ä¸ªç‰¹å¾å’Œç»“æœå€¼ä¹‹é—´çš„ç›¸å…³ç¨‹åº¦ï¼Œ æ’åºç•™ä¸‹Topç›¸å…³çš„ç‰¹å¾éƒ¨åˆ†ã€‚ </li>
<li>è¯„ä»·æ–¹å¼ï¼šPearsonç›¸å…³ç³»æ•°ï¼Œ äº’ä¿¡æ¯ï¼Œ è·ç¦»ç›¸å…³åº¦ã€‚ </li>
<li>ç¼ºç‚¹ï¼šåªè¯„ä¼°äº†å•ä¸ªç‰¹å¾å¯¹ç»“æœçš„å½±å“ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°ç‰¹å¾ä¹‹é—´çš„å…³è”ä½œç”¨ï¼Œ å¯èƒ½æŠŠæœ‰ç”¨çš„å…³è”ç‰¹å¾è¯¯è¸¢æ‰ã€‚å› æ­¤å·¥ä¸šç•Œä½¿ç”¨æ¯”è¾ƒå°‘ã€‚ </li>
<li>pythonåŒ…ï¼šSelectKBestæŒ‡å®šè¿‡æ»¤ä¸ªæ•°ã€SelectPercentileæŒ‡å®šè¿‡æ»¤ç™¾åˆ†æ¯”ã€‚</li>
</ul>
<h3 id="åŒ…è£¹å‹">1.2.2. åŒ…è£¹å‹</h3><ul>
<li>æ–¹æ³•ï¼šæŠŠç‰¹å¾é€‰æ‹©çœ‹åšä¸€ä¸ªç‰¹å¾å­é›†æœç´¢é—®é¢˜ï¼Œ ç­›é€‰å„ç§ç‰¹<br>å¾å­é›†ï¼Œ ç”¨æ¨¡å‹è¯„ä¼°æ•ˆæœã€‚ </li>
<li>å…¸å‹ç®—æ³•ï¼šâ€œé€’å½’ç‰¹å¾åˆ é™¤ç®—æ³•â€ã€‚ </li>
<li>åº”ç”¨åœ¨é€»è¾‘å›å½’çš„è¿‡ç¨‹ï¼šç”¨å…¨é‡ç‰¹å¾è·‘ä¸€ä¸ªæ¨¡å‹ï¼›æ ¹æ®çº¿æ€§æ¨¡å‹çš„ç³»æ•°(ä½“ç°ç›¸å…³æ€§)ï¼Œåˆ æ‰5-10%çš„å¼±ç‰¹å¾ï¼Œè§‚å¯Ÿå‡†ç¡®ç‡/aucçš„å˜åŒ–ï¼›é€æ­¥è¿›è¡Œï¼Œ ç›´è‡³å‡†ç¡®ç‡/aucå‡ºç°å¤§çš„ä¸‹æ»‘åœæ­¢ã€‚ </li>
<li>pythonåŒ…ï¼šRFE 
ã€€ã€€</li>
</ul>
<h3 id="åµŒå…¥å‹">1.2.3. åµŒå…¥å‹</h3><ul>
<li>æ–¹æ³•ï¼šæ ¹æ®æ¨¡å‹æ¥åˆ†æç‰¹å¾çš„é‡è¦æ€§ï¼Œæœ€å¸¸è§çš„æ–¹å¼ä¸ºç”¨æ­£åˆ™åŒ–æ–¹å¼æ¥åšç‰¹å¾é€‰æ‹©ã€‚ </li>
<li>ä¸¾ä¾‹ï¼šæœ€æ—©åœ¨ç”µå•†ç”¨LRåšCTRé¢„ä¼°ï¼Œ åœ¨3-5äº¿ç»´çš„ç³»æ•°ç‰¹å¾ä¸Šç”¨L1æ­£åˆ™åŒ–çš„LRæ¨¡å‹ã€‚ä¸Šä¸€ç¯‡ä»‹ç»äº†L1æ­£åˆ™åŒ–æœ‰æˆªæ–­ä½œç”¨ï¼Œå‰©ä½™2-3åƒä¸‡çš„featureï¼Œ æ„å‘³ç€å…¶ä»–çš„featureé‡è¦åº¦ä¸å¤Ÿã€‚ </li>
<li>pythonåŒ…ï¼šfeature_selection.SelectFromModelé€‰å‡ºæƒé‡ä¸ä¸º0çš„ç‰¹å¾ã€‚</li>
</ul>
<h1 id="å‚è€ƒæ–‡çŒ®">2. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://ask.julyedu.com/question/7114" target="_blank" rel="external">å››æœˆæœºå™¨å­¦ä¹ ç®—æ³•ç­â€”ç‰¹å¾å·¥ç¨‹ç¬”è®°</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç‰¹å¾å·¥ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[linuxå¸¸è§å‘½ä»¤]]></title>
      <url>/2017/04/14/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<h1 id="IO">1. IO</h1><h2 id="linux-windowsäº’ä¼ ">1.1. linux/windowsäº’ä¼ </h2><p>éœ€è¦å®‰è£…ï¼šyum install -y lrzsz</p>
<p>ä»Windowsä¸Šä¼ æ–‡ä»¶<code>[root@localhost src]# rz</code><br>ä»Linuxä¸‹è½½æ–‡ä»¶<code>sz nginx-1.6.2.tar.gz</code></p>
<h2 id="linuxäº’ä¼ ">1.2. linuxäº’ä¼ </h2><ol>
<li>ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶<br> scp username@servername:/path/filename /tmp/local_destination<br> ä¾‹å¦‚scp codinglog@192.168.0.101:/home/kimi/test.txt  æŠŠ192.168.0.101ä¸Šçš„/home/kimi/test.txtçš„æ–‡ä»¶ä¸‹è½½åˆ° /tmp/local_destination</li>
<li>ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°æœåŠ¡å™¨<br> scp /path/local_filename username@servername:/path<br> ä¾‹å¦‚scp /var/www/test.php  codinglog@192.168.0.101:/var/www/  æŠŠæœ¬æœº/var/www/ç›®å½•ä¸‹çš„test.phpæ–‡ä»¶ä¸Šä¼ åˆ°192.168.0.101è¿™å°æœåŠ¡å™¨ä¸Šçš„/var/www/ç›®å½•ä¸­</li>
<li>ä»æœåŠ¡å™¨ä¸‹è½½æ•´ä¸ªç›®å½•<br> scp -r username@servername:remote_dir/ /tmp/local_dir<br> ä¾‹å¦‚:scp -r codinglog@192.168.0.101 /home/kimi/test  /tmp/local_dir</li>
<li>ä¸Šä¼ ç›®å½•åˆ°æœåŠ¡å™¨<br> scp  -r /tmp/local_dir username@servername:remote_dir<br> ä¾‹å¦‚ï¼šscp -r test      codinglog@192.168.0.101:/var/www/æŠŠå½“å‰ç›®å½•ä¸‹çš„testç›®å½•ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/var/www/ç›®å½•</li>
</ol>
<h1 id="æ–‡ä»¶å¤¹">2. æ–‡ä»¶å¤¹</h1><p>æ–°å»ºæ–‡ä»¶å¤¹<code>mkdir name</code></p>
<h1 id="æ‚çµ®">3. æ‚çµ®</h1><p>æŸ¥çœ‹ç¡¬ç›˜æƒ…å†µ<code>df -h</code><br>åˆå¹¶æ–‡ä»¶<code>cat *.csv  &gt; full.csv</code><br>æŸ¥çœ‹æ–‡ä»¶<code>$ ps -ef | grep å…³é”®å­—</code></p>
<h1 id="è§£å‹">4. è§£å‹</h1><h2 id="æ‰¹é‡è§£å‹-zip">4.1. æ‰¹é‡è§£å‹.zip</h2><p>ä¸¤ç§æ–¹å¼ï¼šï¼ˆç»æµ‹è¯•ç¬¬ä¸€ç§å¥½ç”¨ï¼‰</p>
<pre><code>ls *.zip | xargs -n1 unzip
unzip &quot;*.zip&quot;
</code></pre><h2 id="æ‰¹é‡è§£å‹-tar-gz">4.2. æ‰¹é‡è§£å‹.tar.gz</h2><pre><code>ls *.tar.gz | xargs -n1 tar xzvf    
</code></pre><h1 id="vim">5. vim</h1><p><code>i</code>â€”â€”è¿›å…¥æ’å…¥æ¨¡å¼<br><code>ESC+:wq!</code>ï¼šä¿å­˜ï¼Œé€€å‡º<br><code>ESC+:q!</code>ï¼šä¸ä¿å­˜ï¼Œé€€å‡º</p>
<h1 id="VNC-tiger">6. VNC-tiger</h1><p>å®‰è£…ï¼š<br><a href="http://www.jianshu.com/p/35640fc5672b" target="_blank" rel="external">CentOs 7å®‰è£…é…ç½®VNC Server</a><br><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-vnc-remote-access-for-the-gnome-desktop-on-centos-7" target="_blank" rel="external">digitalOcean,How to install vncserver in centos 7</a></p>
<p>ä½¿ç”¨ï¼š</p>
<p>help:<code>vncserver -help</code><br>å¼€å¯ï¼š<code>vncserver :1</code><br>æŒ‰ç…§ä¸€å®šæ¯”ä¾‹è¾“å‡ºï¼ˆå±å¹•æ—‹è½¬ï¼‰ï¼š<code>vncserver 900x1440 :1</code><br>åœæ­¢ï¼š<code>vncserver -kill: 1</code><br>ä¸´æ—¶æ–‡æ¡£ï¼š<code>/tmp/.X11-unix</code>.</p>
<h1 id="ç”¨sublimeæ­å»ºç®€å•çš„python">7. ç”¨sublimeæ­å»ºç®€å•çš„python</h1><p>å®‰è£… Pythonï¼Œå®‰è£…æ—¶é€‰æ‹©æ·»åŠ è·¯å¾„åˆ°ç³»ç»Ÿä¸­ï¼Œæˆ–è€…ç¨åè‡ªå·±æ·»åŠ ä¹Ÿå¯<br>éšä¾¿å†™ä¸ª demoï¼ŒCtrl + B å°±å¯ä»¥è¿è¡Œäº†</p>
<p><a href="http://docs.sublimetext.info/en/latest/getting_started/install.html?highlight=ln" target="_blank" rel="external">sublimeå®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.zhihu.com/question/22904994" target="_blank" rel="external">å„è·¯æ–¹æ³•</a></p>
<p>ä¸­æ–‡æ— æ³•è¾“å…¥é—®é¢˜è§£å†³<a href="http://www.jianshu.com/p/bf05fb3a4709" target="_blank" rel="external">è§£å†³Ubuntuä¸‹Sublime Text 3æ— æ³•è¾“å…¥ä¸­æ–‡</a><br><a href="http://www.brightempty.com/?p=91" target="_blank" rel="external">è£…pythonåŒ…</a></p>
<h1 id="nohup">8. nohup</h1><pre><code>nohup command &gt; nohup.out &amp;
</code></pre><p>nohupç›¸å…³ï¼š<br>å°†nohupåé¢çš„<code>command</code>è®¾ç½®æˆåå°è¿è¡Œï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å‡ºçš„æ—¥å¿—é‡å®šå‘è‡³æ–‡ä»¶nohup.outã€‚<br>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ï¼šjobs<br>æŸ¥çœ‹æ—¥å¿—å†…å®¹ï¼štail -f nohup.out (ctrl + c é€€å‡ºæŸ¥çœ‹)<br>æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ï¼š<br>ps -ef |grep java<br>ps -ef | grep rm<br>åœæ­¢è¿è¡Œ kill %n<br>å¾ˆå¥½çš„å‚è€ƒæ–‡çŒ®ï¼š<a href="http://blog.sina.com.cn/s/blog_90546d6f0101en9y.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_90546d6f0101en9y.html</a></p>
<h1 id="æ›´æ”¹æŸä¸ªç›®å½•çš„æƒé™">9. æ›´æ”¹æŸä¸ªç›®å½•çš„æƒé™</h1><pre><code>chown -R -v ubuntu:ubuntu info
</code></pre>]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[pythonå®ç°æŸç½‘ç«™è‡ªåŠ¨æ‰“å¡]]></title>
      <url>/2017/04/05/Python-python%E5%AE%9E%E7%8E%B0%E6%9F%90%E7%BD%91%E7%AB%99%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%A1/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å­¦æ ¡å‡ºäº†ä¸ªç§‘å­¦ä¸Šç½‘çš„å°ç½‘ç«™ï¼Œä½†æµé‡æœ‰é™ï¼Œå¯ä»¥é€šè¿‡æ¯å¤©æ‰“å¡æ¥è·å–å‡ åå…†æµé‡ã€‚å¥ˆä½•è‡ªå·±è®°æ€§å¾ˆå·®ï¼Œæ€»å¿˜è®°æ‰“å¡ã€‚å› æ­¤å†³å®šå†™ä¸€ä¸ªè‡ªåŠ¨æ‰“å¡çš„å°ç¨‹åºã€‚</p>
<h1 id="æ€è·¯æ€»ç»“">1. æ€è·¯æ€»ç»“</h1><ol>
<li>ç”¨æŠ“åŒ…å·¥å…·ä»”ç»†åˆ†æä¸‹ç™»é™†ä»¥åŠå›å¸–æ—¶postäº†å“ªäº›æ•°æ®ï¼Œè¿™äº›æ•°æ®ä»ä½•è€Œæ¥ï¼ˆchromeï¼‰</li>
<li>python requestsåº“ï¼Œç”¨requests.Session().postæ¥ç™»é™†å’Œå›å¸–ï¼Œç”¨getæ¥è¯»å–é¡µé¢å†…å®¹ï¼›</li>
<li>ç™»é™†ä¹‹åï¼Œæ­£åˆ™æ‰¾åˆ°â€œç­¾åˆ°â€æˆ–â€ä¸èƒ½ç­¾åˆ°â€ï¼Œæ¥è¿›è¡Œä¸‹ä¸€æ­¥</li>
<li>è‹¥èƒ½ç­¾åˆ°ï¼Œå°±å‘å‡ºç­¾åˆ°URLçš„è¯·æ±‚ï¼ˆå› ä¸ºé“¾æ¥ä»åŸæ¥ä¸Šæ¥è¯´æ˜¯ä¸€ç§URLï¼‰</li>
<li>è®°å½•æ¯æ¬¡ç­¾åˆ°çš„log</li>
<li>æœ€åçš„æœ€åï¼Œä½¿ç”¨å†™ä¸ª.shè„šæœ¬ï¼Œé‡Œé¢è¿è¡Œè¿™ä¸ªpythonç¨‹åºï¼Œé…ç½®ä¸ªç›¸åº”çš„plistï¼Œæ¯å¤©è‡ªåŠ¨æ‰§è¡Œï¼ˆMAC OSï¼‰</li>
</ol>
<h1 id="æ¨¡æ‹Ÿç™»é™†åŸç†">2. æ¨¡æ‹Ÿç™»é™†åŸç†</h1><h2 id="æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„è¿‡ç¨‹">2.1. æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„è¿‡ç¨‹</h2><p>ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚è¿‡ç¨‹ä»TCPä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥æˆåŠŸåå¼€å§‹ã€‚</p>
<ol>
<li>ç”¨æˆ·å‘èµ·è¯·æ±‚ï¼ˆç‚¹å‡»ç­‰ï¼‰</li>
<li>æµè§ˆå™¨å‘WEBæœåŠ¡å™¨å‘å‡ºä¸€ä¸ªè¯·æ±‚<strong>Http Requestï¼ˆè¯·æ±‚ï¼‰</strong></li>
<li>WebæœåŠ¡å™¨å‘ç›¸åº”<strong>Http Response</strong></li>
<li>æµè§ˆå™¨è§£æ</li>
</ol>
<h2 id="HTTPæ¶ˆæ¯">2.2. HTTPæ¶ˆæ¯</h2><p>æ›´å¤šå…³äºHTTPè¯·æ±‚è¿‡ç¨‹ï¼Œè§å‚è€ƒèµ„æ–™<a href="https://foofish.net/http-request-process.html" target="_blank" rel="external">ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚è¿‡ç¨‹</a></p>
<p>HTTP æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®,åè®®æœ¬èº«ä¸ä¿ç•™ä¹‹å‰çš„ä¸€åˆ‡è¯·æ±‚ä¿¡æ¯å’Œå“åº”ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªåˆšåˆšå‘é€äº† HTTP è¯·æ±‚çš„å®¢æˆ·ç«¯å†æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯å¹¶ä¸çŸ¥é“ä¹‹å‰è®¿é—®è¿‡ã€‚è¿™æ ·è®¾è®¡çš„ç†ç”±æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠ HTTP åè®®è®¾è®¡å¦‚æ­¤ç®€å•ã€‚<br>ä½†æ˜¯ï¼Œæ— çŠ¶æ€å¯¼è‡´ä¸šåŠ¡å¤„ç†å°±å˜å¾—æ£˜æ‰‹äº†ï¼Œä¸€ä¸ªç®€å•çš„ä¾‹å­å°±æ˜¯ç½‘ä¸Šè´­ç‰©çš„æ—¶å€™ï¼Œå½“æˆ‘åœ¨ä¸€ä¸ªé¡µé¢æŠŠå•†å“åŠ å…¥è´­ç‰©è½¦çš„æ—¶å€™ï¼Œæ­£å½“æˆ‘è¦è·³è½¬åˆ°æ”¯ä»˜é¡µé¢æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¸€ç§æœºåˆ¶æ¥ä¿æŒæˆ‘çš„ç™»å½•çŠ¶æ€ï¼Œé‚£ä¹ˆä¹‹å‰é€‰çš„å•†å“å…¨éƒ¨ä¸¢å¤±äº†ã€‚<br>å› æ­¤ï¼Œä¸ºäº†åœ¨æ— çŠ¶æ€çš„HTTPåè®®ä¹‹ä¸Šç»´æŠ¤ä¼šè¯çŠ¶æ€ï¼Œä½¿æœåŠ¡ï¨¸å¯ä»¥çŸ¥é“å½“å‰æ˜¯å’Œå“ªä¸ªå®¢æˆ·ç«¯æ‰“äº¤é“ï¼Œäºæ˜¯CookieæŠ€æœ¯åº”è¿è€Œç”Ÿï¼ŒCookieé€šä¿—çš„ç†è§£å°±æ˜¯æœåŠ¡ç«¯åˆ†é…ç»™å®¢æˆ·ç«¯çš„ä¸€ä¸ªæ ‡è¯†ã€‚</p>
<h2 id="CookieåŸç†">2.3. CookieåŸç†</h2><p>CookieåŸç†å…¶å®ä¹Ÿéå¸¸ç®€å•ï¼Œæ€»å…±4ä¸ªæ­¥éª¤ç»´æŠ¤HTTPä¼šè¯ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-05-15-55-17.png" alt=""> </p>
<ol>
<li>æµè§ˆå™¨ç¬¬ä¸€æ¬¡å‘èµ·HTTPè¯·æ±‚æ—¶ï¼Œæ²¡æœ‰æºå¸¦ä»»ä½•Cookieä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¹¶è¿”å›ç»™æµè§ˆï¨¸çš„HTTPå“åº”ï¼ŒåŒæ—¶HTTPå“åº”åŒ…æ‹¬äº†ä¸€ä¸ªå“åº”å¤´Set-Cookieå­—æ®µï¼Œå®ƒçš„å€¼æ˜¯è¦è®¾ç½®çš„Cookieã€‚ </li>
<li>æµè§ˆå™¨æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨çš„HTTPå“åº”ï¼Œå“åº”å¤´ä¸­å‘ç°æœ‰Set-Cookieå­—æ®µï¼Œå°±ä¼šå°†è¯¥å­—æ®µçš„å€¼ä¿å­˜åœ¨å†…å­˜æˆ–è€…ç¡¬ç›˜ä¸­ã€‚ </li>
<li>æµè§ˆå™¨ä¸‹æ¬¡ç»™è¯¥æœåŠ¡å™¨å‘é€HTTPè¯·æ±‚æ—¶ï¼Œä¼šå°†Cookieä¿¡æ¯é™„åŠ åœ¨HTTPè¯·æ±‚çš„å¤´å­—æ®µCookieä¸­ã€‚ </li>
<li>æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªHTTPè¯·æ±‚ï¼Œå‘ç°è¯·æ±‚å¤´ä¸­æœ‰Cookieå­—æ®µï¼Œä¾¿çŸ¥é“ä¹‹å‰å°±å’Œè¿™ä¸ªç”¨æˆ·æ‰“è¿‡äº¤é“äº†ã€‚ </li>
</ol>
<p>ç†è§£äº†Cookieçš„åŸºæœ¬åŸç†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ç”¨Pythonæ¥å®ç°æ¨¡æ‹Ÿç™»å½•ã€‚ </p>
<h1 id="ç‚¹å‡»ç™»é™†åï¼Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ">3. ç‚¹å‡»ç™»é™†åï¼Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h1><p>ä¸ºäº†çœ‹çœ‹æµè§ˆå™¨ç©¶ç«Ÿåšäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬é¦–å…ˆè¿›å…¥ç™»å½•ç•Œé¢ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œç‚¹å‡»ç™»å½•ã€‚æ‰“å¼€Chromeå¼€å‘è€…å·¥å…·æ¡(F12)ã€‚é€‰æ‹©Networkä¸‹çš„Headersï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-05-16-12-54.png" alt=""> </p>
<p>ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š</p>
<ol>
<li>ç™»é™†çš„URLåœ°å€æ˜¯Generalä¸‹é¢çš„Request URLçš„é‚£ä¸ªã€‚</li>
<li>ç™»å½•éœ€è¦æä¾›çš„è¡¨å•ï¼ˆForm Dataï¼‰æœ‰ä¸‰ä¸ªï¼Œemail(ç”¨æˆ·å),passwdï¼ˆå¯†ç ï¼‰,remember_me(å°±æ˜¯é‚£ä¸ªâ€œè®°ä½æˆ‘â€çš„é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»å®ƒçš„htmlä¸­æœç´¢å¾—å‡ºï¼Œå¦‚ä¸‹å›¾)ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-05-16-20-21.png" alt=""> </li>
</ol>
<p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šæ‘¸æ¸…äº†æµè§ˆï¨¸ç™»å½•æ—¶æ‰€éœ€è¦çš„æ•°æ®æ˜¯å¦‚ä½•è·å–çš„äº†ï¼Œé‚£ä¹ˆç°åœ¨å°±å¯ä»¥å¼€å§‹æ’¸ä»£ç ç”¨Pythonæ¨¡æ‹Ÿæµè§ˆå™¨æ¥ç™»å½•ã€‚</p>
<p>ç”±äºæˆ‘ä»Šå¤©ç™»é™†çš„ç½‘ç«™å®åœ¨æ˜¯å¤ªç®€æ˜“äº†ï¼Œä¹Ÿä¸éœ€è¦åˆ†æheaderå°±å¯ä»¥ç™»é™†ã€‚æ‰€ä»¥æ­¤å¤„çœç•¥headerçš„åˆ†æã€‚</p>
<p>æˆ‘æ‰“ç®—åŸºäºpythonçš„requestsåº“æ¥å®Œæˆè¿™ä¸€è¿‡ç¨‹ã€‚</p>
<h1 id="pythonå®ç°æ¨¡æ‹Ÿç™»é™†">4. pythonå®ç°æ¨¡æ‹Ÿç™»é™†</h1><pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">email=<span class="string">'jiayi797@163.com'</span></div><div class="line">password=<span class="string">'è¿™é‡ŒåŠ å¯†äº†'</span></div><div class="line">loginurl = <span class="string">'https://ssr.0v0.loan/auth/login'</span></div><div class="line"><span class="comment"># è¿™è¡Œä»£ç ï¼Œæ˜¯ç”¨æ¥ç»´æŒcookieçš„ï¼Œä½ åç»­çš„æ“ä½œéƒ½ä¸ç”¨æ‹…å¿ƒcookieï¼Œä»–ä¼šè‡ªåŠ¨å¸¦ä¸Šç›¸åº”çš„cookie</span></div><div class="line">s = requests.Session()</div><div class="line"><span class="comment"># æˆ‘ä»¬éœ€è¦å¸¦è¡¨å•çš„å‚æ•°</span></div><div class="line">loginparams=&#123;<span class="string">'email'</span>:email,<span class="string">'passwd'</span>:password,<span class="string">'remember_me'</span>:<span class="string">'ture'</span>&#125;</div><div class="line"><span class="comment"># post æ•°æ®å®ç°ç™»å½•</span></div><div class="line">r = s.post(loginurl,data=loginparams)</div><div class="line"><span class="comment"># éªŒè¯æ˜¯å¦ç™»é™†æˆåŠŸï¼ŒæŠ“å–é¦–é¡µçœ‹çœ‹å†…å®¹</span></div><div class="line">r = s.get(loginurl)</div></pre></td></tr></table></figure>
</code></pre><p>è¿è¡Œå®Œè¿™äº›åï¼Œæˆ‘ä»¬å‘ç°rå·²ç»æœ‰å†…å®¹äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œè‡ªåŠ¨ç­¾åˆ°ã€‚</p>
<h1 id="ç­¾åˆ°">5. ç­¾åˆ°</h1><p>æˆ‘ä»¬æŸ¥çœ‹r._contentçš„å†…å®¹ï¼Œæ˜¯ä¸»é¡µçš„htmlå†…å®¹ã€‚å¾ˆé•¿ã€‚ä¸ºäº†æ–¹ä¾¿åˆ†æï¼Œæˆ‘åªæ‹¿å‡ºâ€œç­¾åˆ°â€æ ‡ç­¾ä¸‹çš„å†…å®¹ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box box-primary"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box-header"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-pencil"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"box-title"</span>&gt;</span>ç­¾åˆ°è·å–æµé‡<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- /.box-header --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box-body"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span> æ¯24å°æ—¶å¯ä»¥ç­¾åˆ°ä¸€æ¬¡ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šæ¬¡ç­¾åˆ°æ—¶é—´ï¼š<span class="tag">&lt;<span class="name">code</span>&gt;</span>2017-04-04 17:11:22<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"checkin-btn"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"checkin"</span> <span class="attr">class</span>=<span class="string">"btn btn-success  btn-flat"</span>&gt;</span>ç­¾åˆ°<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"checkin-msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- /.box-body --&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- /.box --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- /.col (right) --&gt;</span></div></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„è¿˜æœ‰ä»¥ä¸‹è¿™ä¸ªè„šæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">    $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        $(<span class="string">"#checkin"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            $.ajax(&#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">"POST"</span>,</div><div class="line">                <span class="attr">url</span>: <span class="string">"/user/checkin"</span>,</div><div class="line">                <span class="attr">dataType</span>: <span class="string">"json"</span>,</div><div class="line">                <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">                    $(<span class="string">"#checkin-msg"</span>).html(data.msg);</div><div class="line">                    $(<span class="string">"#checkin-btn"</span>).hide();</div><div class="line">                &#125;,</div><div class="line">                <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">jqXHR</span>) </span>&#123;</div><div class="line">                    alert(<span class="string">"å‘ç”Ÿé”™è¯¯ï¼š"</span> + jqXHR.status);</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p>ä»è„šæœ¬ä¸­æˆ‘ä»¬è¯»åˆ°ï¼Œç­¾åˆ°çš„ç±»å‹æ˜¯postï¼Œurlæ˜¯/user/checkinï¼Œ<br>å› æ­¤æˆ‘ä»¬è¯•ä¸€ä¸‹postä¸€ä¸ªè¿™æ ·çš„urlä¼šæœ‰ä»€ä¹ˆåæœã€‚</p>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">checkinUrl=<span class="string">"https://ssr.0v0.loan/user/checkin"</span></div><div class="line">r=s.post(checkinUrl)<span class="comment">#æ‰§è¡Œç­¾åˆ°</span></div><div class="line">r = s.get(loginurl)<span class="comment">#æŸ¥çœ‹ç­¾åˆ°ç»“æœ</span></div></pre></td></tr></table></figure>
</code></pre><p>æˆ‘ä»¬å‘ç°ï¼Œç­¾åˆ°æ çš„HTMLå·²ç»å˜æˆäº†ï¼›</p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box box-primary"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box-header"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-pencil"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"box-title"</span>&gt;</span>ç­¾åˆ°è·å–æµé‡<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- /.box-header --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box-body"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span> æ¯24å°æ—¶å¯ä»¥ç­¾åˆ°ä¸€æ¬¡ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šæ¬¡ç­¾åˆ°æ—¶é—´ï¼š<span class="tag">&lt;<span class="name">code</span>&gt;</span>2017-04-05 14:08:02<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-success btn-flat disabled"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>ä¸èƒ½ç­¾åˆ°<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"checkin-msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- /.box-body --&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- /.box --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- /.col (right) --&gt;</span></div></pre></td></tr></table></figure>
</code></pre><p>å³ï¼š</p>
<pre><code>&lt;button id=&quot;checkin&quot; class=&quot;btn btn-success  btn-flat&quot;&gt;ç­¾åˆ°&lt;/button&gt;
</code></pre><p>å˜æˆäº†ï¼š</p>
<pre><code>&lt;a class=&quot;btn btn-success btn-flat disabled&quot; href=&quot;#&quot;&gt;ä¸èƒ½ç­¾åˆ°&lt;/a&gt;
</code></pre><p>å¤§é¢˜æ¡†æ¶æ­å®Œäº†ã€‚æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯ä¸€äº›ç»†èŠ‚ã€‚</p>
<h1 id="åˆ¤æ–­æ˜¯å¦å·²ç­¾åˆ°">6. åˆ¤æ–­æ˜¯å¦å·²ç­¾åˆ°</h1><p>æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯ç”¨æ­£åˆ™ï¼Œæ‰¾åˆ°â€œç­¾åˆ°â€æˆ–è€…â€œä¸èƒ½ç­¾åˆ°â€çš„å¯¹åº”æ ‡ç­¾ï¼Œæ¥è·å¾—ä¸€ä¸ªå½“å‰çŠ¶æ€ã€‚</p>
<p>é¦–å…ˆæˆ‘æƒ³åˆ°çš„æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œç”¨pythonè‡ªå¸¦çš„<code>re.search()</code>ã€‚</p>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(str)</span>:</span></div><div class="line">    hasCheckIn=<span class="string">'&lt;button id="checkin" class="btn btn-success  btn-flat"&gt;'</span></div><div class="line">    noChecked=<span class="string">'&lt;a class="btn btn-success btn-flat disabled" href="#"&gt;'</span></div><div class="line">    yes=re.search(hasCheckIn,str)</div><div class="line">    <span class="keyword">if</span> yes==<span class="keyword">None</span>:</div><div class="line">        no=re.search(noChecked,str)</div><div class="line">        <span class="keyword">if</span> no==<span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">-1</span> <span class="comment">#ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span><span class="comment">#æ‰¾åˆ°äº†â€œä¸èƒ½ç­¾åˆ°â€</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span><span class="comment">#æ‰¾åˆ°äº†â€œç­¾åˆ°â€</span></div></pre></td></tr></table></figure>
</code></pre><h1 id="è·å–å½“å‰æµé‡">7. è·å–å½“å‰æµé‡</h1><p>å…ˆæ‰¾åˆ°æµé‡çš„å¯¹åº”æ ‡ç­¾ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">class</span>=<span class="string">"dl-horizontal"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>æ€»æµé‡<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>1.53GB<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>å·²ç”¨æµé‡<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>253.36MB<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>å‰©ä½™æµé‡<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>1.29GB<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></div></pre></td></tr></table></figure>
<p>æƒ³è¦è·å–æ ‡ç­¾å†…çš„å†…å®¹ï¼ˆè€Œä¸æ˜¯æš´åŠ›åœ°åŒ¹é…å­—ç¬¦ä¸²ï¼‰ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°å¦ä¸€ç§åŒ¹é…æ–¹å¼â€”â€”æ­£åˆ™è¡¨è¾¾å¼</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æƒ³è¦è·å–<a href=""></a>ä¹‹é—´çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#æ­£åˆ™è¡¨è¾¾å¼è·å–&lt;tr&gt;&lt;/tr&gt;ä¹‹é—´å†…å®¹  </span></div><div class="line">res_tr = <span class="string">r'&lt;tr&gt;(.*?)&lt;/tr&gt;'</span>  </div><div class="line">m_tr =  re.findall(res_tr,language,re.S|re.M)  </div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> m_tr:  </div><div class="line">    <span class="keyword">print</span> line  </div><div class="line">    <span class="comment">#è·å–è¡¨æ ¼ç¬¬ä¸€åˆ—th å±æ€§  </span></div><div class="line">    res_th = <span class="string">r'&lt;th&gt;(.*?)&lt;/th&gt;'</span>    </div><div class="line">    m_th = re.findall(res_th,line,re.S|re.M)  </div><div class="line">    <span class="keyword">for</span> mm <span class="keyword">in</span> m_th:  </div><div class="line">        <span class="keyword">print</span> unicode(mm,<span class="string">'utf-8'</span>),  <span class="comment">#unicodeé˜²æ­¢ä¹±  </span></div><div class="line">    <span class="comment">#è·å–è¡¨æ ¼ç¬¬äºŒåˆ—td å±æ€§å€¼  </span></div><div class="line">    res_td = <span class="string">r'&lt;td&gt;(.*?)&lt;/td&gt;'</span>  </div><div class="line">    m_td = re.findall(res_td,line,re.S|re.M)  </div><div class="line">    <span class="keyword">for</span> nn <span class="keyword">in</span> m_td:  </div><div class="line">        <span class="keyword">print</span> unicode(nn,<span class="string">'utf-8'</span>)</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œresæ˜¯åŒ¹é…æ¨¡å¼ã€‚<br><code>râ€™</code>æ˜¯åŒ¹é…æ¨¡å¼çš„å¼€å¤´ï¼Œ<br><code>&lt;tr</code>æ˜¯å…ˆåŒ¹é…å­—ç¬¦ä¸²<code>&lt;tr</code><br><code>.</code>æ˜¯åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œé™¤äº†æ¢è¡Œç¬¦<br><code>*</code>æ˜¯åŒ¹é…0ä¸ªæˆ–å¤šä¸ªçš„è¡¨è¾¾å¼<br><code>?</code>æ˜¯åŒ¹é…0ä¸ªæˆ–1ä¸ªç”±å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„ç‰‡æ®µï¼Œéè´ªå©ªæ–¹å¼<br>ä¾æ¬¡ç±»æ¨</p>
<p><code>re.S</code>ä½¿<code>.</code>åŒ¹é…åŒ…æ‹¬æ¢è¡Œåœ¨å†…çš„æ‰€æœ‰å­—ç¬¦<br><code>re.M</code>:å¤šè¡ŒåŒ¹é…ï¼Œå½±å“ ^ å’Œ $</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼ŒåŒ¹é…<code>&lt;dt&gt;æ€»æµé‡&lt;/dt&gt;</code>åˆ°<code>&lt;/dd&gt;&lt;/dl&gt;</code>ä¹‹é—´çš„å†…å®¹ã€‚</p>
<p>æ”¹å†™ä»¥ä¸ŠåŒ¹é…å¼å­ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">match_flows</span><span class="params">(str)</span>:</span></div><div class="line">    res = <span class="string">r'&lt;dl class="dl-horizontal"&gt;(.*?)&lt;/dl&gt;'</span></div><div class="line">    mm = re.findall(</div><div class="line">        res, str, re.S | re.M)</div><div class="line">    res=<span class="string">r'&lt;dd&gt;(.*?)&lt;/dd&gt;'</span></div><div class="line">    mm= re.findall(</div><div class="line">        res, mm[<span class="number">0</span>], re.S | re.M)</div><div class="line">    <span class="keyword">return</span> mm</div></pre></td></tr></table></figure>
<h1 id="è®°å½•å½“å‰æ“ä½œ">8. è®°å½•å½“å‰æ“ä½œ</h1><p>é¦–å…ˆ</p>
<pre><code>import logging
</code></pre><p>ç„¶åï¼š</p>
<pre><code># é…ç½®æ—¥å¿—æ–‡ä»¶å’Œæ—¥å¿—çº§åˆ«
logging.basicConfig(filename=&apos;logger.log&apos;, level=logging.INFO)

nowtime=time.strftime(&apos;%Y-%m-%d&apos;,time.localtime(time.time()))#è·å–å½“å‰æ—¶é—´
str= nowtime+&apos;,\tæ€»æµé‡ï¼š&apos;+lastFlows[0]+&apos;,\tå·²ç”¨æµé‡ï¼š&apos;+lastFlows[1]+&apos;,\tå‰©ä½™æµé‡ï¼š&apos;+lastFlows[2]
logging.info(str)#å†™å…¥æ—¥å¿—
</code></pre><h1 id="æ“ä½œç³»ç»Ÿå®šæœŸæ‰§è¡ŒPythonè„šæœ¬">9. æ“ä½œç³»ç»Ÿå®šæœŸæ‰§è¡ŒPythonè„šæœ¬</h1><p>è§å‚è€ƒæ–‡çŒ®4.</p>
<h1 id="å…¨éƒ¨ä»£ç ">10. å…¨éƒ¨ä»£ç </h1><pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! /usr/bin/env python</span></div><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="comment"># é…ç½®æ—¥å¿—æ–‡ä»¶å’Œæ—¥å¿—çº§åˆ«</span></div><div class="line">logging.basicConfig(filename=<span class="string">'logger.log'</span>, level=logging.INFO)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(str)</span>:</span></div><div class="line">    hasCheckIn=<span class="string">'&lt;button id="checkin" class="btn btn-success  btn-flat"&gt;'</span></div><div class="line">    noChecked=<span class="string">'&lt;a class="btn btn-success btn-flat disabled" href="#"&gt;'</span></div><div class="line">    yes=re.search(hasCheckIn,str)</div><div class="line">    <span class="keyword">if</span> yes==<span class="keyword">None</span>:</div><div class="line">        no=re.search(noChecked,str)</div><div class="line">        <span class="keyword">if</span> no==<span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">-1</span> <span class="comment">#ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span><span class="comment">#æ‰¾åˆ°äº†â€œä¸èƒ½ç­¾åˆ°â€</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span><span class="comment">#æ‰¾åˆ°äº†â€œç­¾åˆ°â€</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">match_flows</span><span class="params">(str)</span>:</span></div><div class="line">    res = <span class="string">r'&lt;dl class="dl-horizontal"&gt;(.*?)&lt;/dl&gt;'</span></div><div class="line">    mm = re.findall(</div><div class="line">        res, str, re.S | re.M)</div><div class="line">    res=<span class="string">r'&lt;dd&gt;(.*?)&lt;/dd&gt;'</span></div><div class="line">    mm= re.findall(</div><div class="line">        res, mm[<span class="number">0</span>], re.S | re.M)</div><div class="line">    <span class="keyword">return</span> mm</div><div class="line">    <span class="comment">## è¿™æ®µä»£ç æ˜¯ç”¨äºè§£å†³ä¸­æ–‡æŠ¥é”™çš„é—®é¢˜</span></div><div class="line">reload(sys)</div><div class="line">sys.setdefaultencoding(<span class="string">"utf8"</span>)</div><div class="line">email=<span class="string">'ä½ çš„è´¦å·'</span></div><div class="line">password=<span class="string">'ä½ çš„å¯†ç '</span></div><div class="line">loginurl = <span class="string">'https://ssr.0v0.loan/auth/login'</span></div><div class="line"><span class="comment"># è¿™è¡Œä»£ç ï¼Œæ˜¯ç”¨æ¥ç»´æŒcookieçš„ï¼Œä½ åç»­çš„æ“ä½œéƒ½ä¸ç”¨æ‹…å¿ƒcookieï¼Œä»–ä¼šè‡ªåŠ¨å¸¦ä¸Šç›¸åº”çš„cookie</span></div><div class="line">s = requests.Session()</div><div class="line"><span class="comment"># æˆ‘ä»¬éœ€è¦å¸¦è¡¨å•çš„å‚æ•°</span></div><div class="line">loginparams=&#123;<span class="string">'email'</span>:email,<span class="string">'passwd'</span>:password,<span class="string">'remember_me'</span>:<span class="string">'ture'</span>&#125;</div><div class="line"><span class="comment"># post æ•°æ®å®ç°ç™»å½•</span></div><div class="line">r = s.post(loginurl,data=loginparams)</div><div class="line"><span class="comment"># éªŒè¯æ˜¯å¦ç™»é™†æˆåŠŸï¼ŒæŠ“å–é¦–é¡µçœ‹çœ‹å†…å®¹</span></div><div class="line">r = s.get(loginurl)</div><div class="line">res=check(r.content)<span class="comment">#0=ä¸èƒ½ç­¾åˆ°;1=å¯ä»¥ç­¾åˆ°;-1=ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°;</span></div><div class="line"><span class="keyword">if</span>(res==<span class="number">1</span>):<span class="comment">#å¯ä»¥ç­¾åˆ°</span></div><div class="line">    checkinUrl=<span class="string">"https://ssr.0v0.loan/user/checkin"</span></div><div class="line">    r=s.post(checkinUrl)</div><div class="line">    r = s.get(loginurl)</div><div class="line">lastFlows=match_flows(r.content)</div><div class="line">nowtime=time.strftime(<span class="string">'%Y-%m-%d'</span>,time.localtime(time.time()))<span class="comment">#è·å–å½“å‰æ—¶é—´</span></div><div class="line">str= nowtime+<span class="string">',\tæ€»æµé‡ï¼š'</span>+lastFlows[<span class="number">0</span>]+<span class="string">',\tå·²ç”¨æµé‡ï¼š'</span>+lastFlows[<span class="number">1</span>]+<span class="string">',\tå‰©ä½™æµé‡ï¼š'</span>+lastFlows[<span class="number">2</span>]</div><div class="line"><span class="keyword">print</span> str</div><div class="line">logging.info(str)</div></pre></td></tr></table></figure>
</code></pre><h1 id="å‚è€ƒæ–‡çŒ®">11. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://geek.csdn.net/news/detail/189850" target="_blank" rel="external">å¾®ä¿¡ç¾¤åˆ†äº«ï¼šç”¨Pythonæ¨¡æ‹ŸçŸ¥ä¹è‡ªåŠ¨ç™»å½•</a></li>
<li><a href="http://www.runoob.com/python/python-reg-expressions.html" target="_blank" rel="external">Pythonæ­£åˆ™è¡¨è¾¾å¼</a></li>
<li><a href="http://blog.csdn.net/eastmount/article/details/51082253" target="_blank" rel="external">å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼çˆ¬å–ç½‘é¡µä¿¡æ¯åŠåˆ†æHTMLæ ‡ç­¾æ€»ç»“</a></li>
<li><a href="http://www.cnblogs.com/thingk/p/4309122.html" target="_blank" rel="external">æ“ä½œç³»ç»Ÿå®šæœŸå®šæ—¶æ‰§è¡ŒPYTHONè„šæœ¬</a></li>
</ol>
<p>ç­¾åˆ°æˆåŠŸåï¼š</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŠImproving Regressors Using Boosting Techniquesã€‹è®ºæ–‡ç¬”è®°]]></title>
      <url>/2017/04/04/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%BF%9B%E9%98%B6-%E3%80%8AImproving-Regressors-Using-Boosting-Techniques%E3%80%8B%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="introductionéƒ¨åˆ†">1. introductionéƒ¨åˆ†</h1><p><strong>Baggingå’Œboostingç”¨é€”</strong></p>
<p>Baggingå’Œboostingä¸»è¦æ˜¯ç”¨å¤šé‡é¢„æµ‹æ¥è§£å†³ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>åœ¨å›å½’é—®é¢˜ä¸­è·å–æœ€å°è¯¯å·®ï¼›</li>
<li>åœ¨åˆ†ç±»é—®é¢˜ä¸­è·å–æœ€å°é”™è¯¯ç‡ã€‚</li>
</ol>
<p><strong>Baggingå’ŒBoostingå…±æ€§</strong><br>éƒ½æ˜¯é€šè¿‡è®­ç»ƒä¸åŒçš„æ•°æ®é›†æ¥å¾—åˆ°å›å½’æ¨¡å‹ã€‚</p>
<p><strong>ä¸åŒç‚¹</strong></p>
<p><strong>bagging</strong></p>
<ol>
<li>ä»$N_1$ä¸ªåŸå§‹æ ·æœ¬ä¸­ï¼Œæœ‰æ”¾å›åœ°æŠ½æ ·(å¯èƒ½overlap)å¾—åˆ°$N_1$ä¸ªæ ·æœ¬</li>
<li>ç‹¬ç«‹è®­ç»ƒæ¨¡å‹</li>
<li>å¾—åˆ°ä¸åŒçš„é¢„æµ‹</li>
<li>æ±‚æ‰€æœ‰é¢„æµ‹çš„å¹³å‡å¾—åˆ°æœ€ç»ˆç»“æœ</li>
</ol>
<p>ç”±äºæ¨¡å‹ä¹‹é—´ç‹¬ç«‹ï¼Œå› æ­¤å¯ä»¥å¯¹è®­ç»ƒè¿‡ç¨‹é‡‡å–åˆ†å¸ƒå¼æˆ–å¹¶è¡Œçš„æ–¹å¼ã€‚</p>
<p><strong>boosting</strong></p>
<p>æ¨¡å‹æ˜¯ä¾æ¬¡è®­ç»ƒå‡ºæ¥çš„ã€‚</p>
<ol>
<li>ä»è®­ç»ƒé›†ä¸­æŒ‘å‡º$N_1$ä¸ªæ ·æœ¬ï¼Œè®­ç»ƒå‡ºç¬¬ä¸€ä¸ªæ¨¡å‹</li>
<li>æŒ‘å‡ºè¯¯å·®æœ€å¤§çš„æ ·æœ¬</li>
<li>å¢å¤§è¿™äº›æ ·æœ¬åœ¨ä¸‹æ¬¡è¢«æŠ½åˆ°çš„æ¦‚ç‡</li>
<li>å†æ¬¡è¿›è¡Œè®­ç»ƒï¼Œæœ€ç»ˆå¾—åˆ°å¤šä¸ªæ¨¡å‹</li>
<li>æœ€ç»ˆå¯¹æ¨¡å‹è¿›è¡Œä¸åŒæƒé‡çš„åŠ æƒï¼Œæƒé‡å…¬å¼å¦‚ä¸‹å®šä¹‰ï¼š</li>
</ol>
<p>è®¾å·²çŸ¥è®­ç»ƒé›†$(y_i,x_i),i=1,â€¦,N_1$ã€‚å…¶ä¸­ï¼Œ$x$æ˜¯$M$ç»´çš„å‘é‡ï¼Œä¸”$(y_i,x_i)$å”¯ä¸€ä½†æœªçŸ¥(fixed but unknown)<br>æˆ‘ä»¬å°†é¢„æµ‹å‡½æ•°è¡¨ç¤ºä¸º$y^{(p)}(x)$ï¼Œåˆ™ï¼š</p>
<p><strong>sample modeling error</strong>:<br> $$PE=\frac{1}{N_2}\sum_{i=1}^{N_2}[y_i-y_i^{(p)}(x_i)]^2$$<br><strong>prediction error</strong>:<br> $$ME=\frac{1}{N_2}\sum_{i=1}^{N_2}[y_i^{(t)}-y_i^{(p)}(x_i)]^2$$</p>
<p>å…¶ä¸­ï¼Œ<br>$y_i^{(p)}(x_i)$è¡¨ç¤ºç¬¬$i$ä¸ªæµ‹è¯•é›†çš„é¢„æµ‹å€¼<br>$y_i$è¡¨ç¤ºç¬¬$i$ä¸ªæµ‹è¯•é›†çš„è§‚æµ‹å€¼<br>$y^{(t)}_i$æ˜¯å®é™…å€¼<br>$y^{(p)}(x)$çš„å‚æ•°pæ˜¯ä»$N_2$ä¸ªæµ‹è¯•é›†çš„è§‚æµ‹å€¼ä¸­è·å¾—çš„ï¼Œä½†æ˜¯ä¸Šé¢çš„ç´¯åŠ çš„å¼å­ä¸­çš„$y_i$å’Œ$x_i$æ˜¯ä»ä»æœªè¢«seenè¿‡çš„æµ‹è¯•é›†çš„è§‚æµ‹å€¼$N_2$è·å¾—çš„ã€‚</p>
<ol>
<li><p>çœ‹åˆ°è¿™é‡Œçªç„¶å‘ç°æœ‰ç‚¹è·‘åäº†ã€‚å†³å®šå…ˆæš‚åœè¿™ç¯‡è®ºæ–‡çš„ç ”ç©¶ã€‚</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ è¿›é˜¶ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Boosting </tag>
            
            <tag> Bagging </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2017è…¾è®¯é¢˜â€”â€”å­—ç¬¦åå…­è¿›åˆ¶è¾“å‡º]]></title>
      <url>/2017/04/03/ACM-2017%E8%85%BE%E8%AE%AF%E9%A2%98%E2%80%94%E2%80%94%E5%AD%97%E7%AC%A6%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E8%BE%93%E5%87%BA/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®">1. é¢˜ç›®</h1><p>ç¼–å†™ä»£ç ï¼Œæ¥æ”¶ä»å±å¹•è¾“å…¥çš„é•¿åº¦ä¸º16å­—èŠ‚æ•´æ•°å€çš„å­—ç¬¦ä¸²ã€‚å›è½¦åï¼ŒæŒ‰å®ä¾‹æ ¼å¼æ’ç‰ˆè¾“å‡ºã€‚</p>
<p>å®ä¾‹ï¼š</p>
<p>å±å¹•è¾“å…¥ï¼ˆå‡ä¸ºå¯è§å­—ç¬¦ï¼‰ï¼š<br>abcdefghigklmnopqrstuvwxyzabcdefghigklmnopqrstuvwxyzabcdefghigkl</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-03-21-24-41.png" alt=""> </p>
<h1 id="ä»£ç ">2. ä»£ç </h1><pre><code>#include &lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
using namespace std;
int main()
{
    //freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    char c[16];
    int count=0;
    int level=0;
    int temp=0;
    char in;
    while(true){
        c[count]=getchar();
        if(c[count]==-1){
            break;
        }
        if(count==16){
            printf(&quot;%08d&quot;,level*10);
            printf(&quot;  &quot;);
            for(int i=0;i&lt;16;i++){
                if(i==8){
                    printf(&quot; &quot;);
                }
                temp=c[i]+16*level;
                printf(&quot;%02X&quot;,c[i]);
                printf(&quot; &quot;);
            }
            printf(&quot; &quot;);
            for(int i=0;i&lt;16;i++){
                std::cout&lt;&lt;c[i];
            }
            printf(&quot;\n&quot;);
            ++level;
            count=0;
        }
        ++count;
    }
    return 0;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> ACM </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[BUPT_ACM_2017_F_Simple_recursion]]></title>
      <url>/2017/04/03/ACM-BUPT-2017-F-Simple-recursion/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯2017å¹´åŒ—äº¬é‚®ç”µå¤§å­¦ç¬¬åä¸€å±Šç¨‹åºè®¾è®¡ç«èµ›ç½‘ç»œçƒ­èº«èµ›çš„F. Simple recursioné¢˜è§£ã€‚</p>
<h1 id="é¢˜ç›®">1. é¢˜ç›®</h1><p>é¢˜ç›®æè¿°<br>r_clover shows you a BIIIIIIIIIIG water problem:<br>if $f(0)=1,f(1)=1$,$f(n)=2f(n-1)+3f(n-2)$, what is $f(n)mod1000000007$?</p>
<p>è¾“å…¥æ ¼å¼<br>A single integer n(0â‰¤nâ‰¤10000000000).</p>
<p>è¾“å‡ºæ ¼å¼<br>A single integer, which is the answer for f(n)mod1000000007.</p>
<p>è¾“å…¥æ ·ä¾‹<br>10<br>è¾“å‡ºæ ·ä¾‹<br>29525</p>
<h1 id="æ€è·¯">2. æ€è·¯</h1><p>ä¸€å¼€å§‹æƒ³çš„æ˜¯ç”¨é€’å½’ã€‚ä½†ç»æµ‹è¯•å‘ç°é€’å½’çš„æ—¶é—´ã€ç©ºé—´å¤æ‚åº¦éƒ½å¤ªé«˜ï¼Œå¯¼è‡´è¶…æ—¶ã€‚</p>
<p>æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šæ±‚å‡ºé€’æ¨å…³ç³»ï¼Œå¹¶ç”¨å¿«é€Ÿå¹‚å–æ¨¡æ–¹æ³•è®¡ç®—ç»“æœã€‚</p>
<h1 id="é€’æ¨å…³ç³»æ±‚è§£">3. é€’æ¨å…³ç³»æ±‚è§£</h1><p>ã€Šç»„åˆæ•°å­¦ã€‹å†…å®¹â€”â€”â€”â€”å¸¸ç³»æ•°çº¿æ€§é½æ¬¡é€’æ¨å…³ç³»çš„æ±‚è§£ã€‚å…¬å¼è§åé¢çš„é™„1ã€‚<br>æ±‚è§£é¢˜ç›®ä¸­æ‰€ç»™çš„é€’æ¨å…³ç³»ï¼š<br>$$f(n)=2f(n-1)+3f(n-2)$$<br>$$f(0)=1,f(1)=1$$<br>å®ƒçš„ç‰¹å¾æ–¹ç¨‹ä¸ºï¼š<br>$$x^2-2x-3=0$$<br>è§£æ–¹ç¨‹å¾—ï¼š<br>$$x_1=3,x_2=-1$$<br>æ‰€ä»¥é€’æ¨å…³ç³»çš„é€šè§£ä¸ºï¼š<br>$$f(n)=c_13^n+c_2(-1)^n$$<br>ä»£å…¥åˆå€¼$f(0)=1,f(1)=1$ï¼Œå¾—åˆ°ï¼š<br>$$f(0)=c_1+c_2=1$$<br>$$f(1)=3c_1-c_2=1$$<br>è§£å¾—:$c_1=c_2=0.5$<br>å› æ­¤è¯¥é€’æ¨å…³ç³»çš„è§£ä¸º$$f(n)=0.5(3)^n+0.5(-1)^n$$</p>
<p>ä»£ç å®ç°ï¼š</p>
<pre><code><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">long</span> <span class="title">f</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n,<span class="keyword">int</span> modNum)</span></span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a=<span class="number">3</span>;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> b=<span class="number">1</span>;</div><div class="line">    a= quick_algorithm(a,n,modNum);<span class="comment">//(açš„næ¬¡æ–¹)mod(modNum),æ˜¯å¿«é€Ÿæ±‚å¹‚å–æ¨¡çš„æ–¹æ³•ï¼Œè¯¦ç»†è§åé¢çš„æ¨å¯¼</span></div><div class="line">    <span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">1</span>)&#123;</div><div class="line">        b=<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    a=<span class="number">0.5</span>*a+<span class="number">0.5</span>*b;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><h1 id="å¸¸ç³»æ•°çº¿æ€§é½æ¬¡é€’å½’å…³ç³»çš„æ±‚è§£">4. å¸¸ç³»æ•°çº¿æ€§é½æ¬¡é€’å½’å…³ç³»çš„æ±‚è§£</h1><p><strong>é€’æ¨å…³ç³»ï¼š</strong></p>
<p>$$f(n)=c_1f(n-1)+c_2f(n-2)+â€¦+c_kf(n-k)$$</p>
<p><strong>é€’æ¨å…³ç³»çš„ç‰¹å¾æ–¹ç¨‹</strong>ï¼š</p>
<p>$$x^k-c_1x^{k-1}-c_2x^{k-2}-â€¦-c_k=0$$</p>
<p><strong>é€’å½’å…³ç³»çš„ç‰¹å¾æ ¹ï¼š</strong></p>
<p>ç‰¹å¾æ–¹ç¨‹çš„kä¸ªæ ¹ï¼ˆå¯èƒ½é‡æ ¹ï¼‰ï¼š$$q_1,q_2,â€¦,q_k$$</p>
<p><strong>é€’å½’å…³ç³»çš„ç‰¹è§£ï¼š</strong></p>
<p>è®¾qæ˜¯éé›¶å¤æ•°ï¼Œåˆ™$f(n)=q^n$æ˜¯é€’æ¨å…³ç³»çš„è§£ï¼Œå½“ä¸”ä»…å½“qæ˜¯å®ƒçš„ç‰¹å¾æ ¹ã€‚</p>
<p><strong>é€’å½’å…³ç³»çš„é€šè§£ï¼š</strong></p>
<p>è®¾$q_1,q_2,â€¦,q_k$æ˜¯é€’æ¨å…³ç³»çš„kä¸ªäº’ä¸ç›¸ç­‰çš„ç‰¹å¾æ ¹ï¼Œåˆ™<br>$$f(n)=b_1q_1^n+b_2q_2^n+b_3q_3^n+â€¦+b_kq_k^n$$æ˜¯é€’æ¨å…³ç³»çš„é€šè§£ã€‚</p>
<h1 id="å¿«é€Ÿå¤§æ•°å¹‚è¿ç®—">5. å¿«é€Ÿå¤§æ•°å¹‚è¿ç®—</h1><p>è¿™æ˜¯ä¸€ç§å¾ˆç¥å¥‡çš„æ–¹æ³•ã€‚</p>
<p>é¦–å…ˆå¼•å…¥ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚</p>
<p><strong>å¹‚å–æ¨¡è¿ç®—çš„ä¸€ä¸ªæ€§è´¨</strong></p>
<p>$$(a\times b)mod(c)=(((a)mod(c))\times ((b) mod(c)))mod(c)$$</p>
<p><strong>å¤§æ•°å¹‚è¿ç®—</strong><br>æ ¸å¿ƒæ€æƒ³ï¼šå°†å¤§æ•°çš„å¹‚è¿ç®—æ‹†è§£æˆäº†ç›¸å¯¹åº”çš„ä¹˜æ³•è¿ç®—ï¼Œåˆ©ç”¨ä¸Šé¢çš„å¼å­ï¼Œå§‹ç»ˆå°†æˆ‘ä»¬çš„è¿ç®—çš„æ•°æ®é‡æ§åˆ¶åœ¨cçš„èŒƒå›´ä»¥ä¸‹ã€‚</p>
<p>å¯¹äºç›®æ ‡ï¼š<br>$$a^bmodc$$<br>æˆ‘ä»¬å°†bè¡¨ç¤ºä¸ºäºŒè¿›åˆ¶ï¼š<br>$$b=b_0+b_12+b_22^2+â€¦+b_n2^n$$<br>é‚£ä¹ˆï¼Œ<br>$$a^b=a^b_1\times a^{b_22^2} \times a^{b_32^3} \times â€¦ \times a^{b_n2^n}$$<br>å…¶ä¸­$b_k$è¦ä¹ˆä¸º0ï¼Œè¦ä¹ˆä¸º1<br>å»æ‰æ‰€æœ‰çš„0åï¼Œæˆ‘ä»¬å¾—åˆ°<br>$$a^b=a^{b_k2^k} \times â€¦ \times a^{b_n2^n}$$<br>ä¸Šå¼çš„æ¨¡å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>$$a^b mod c =a^{b_k2^k} mod c\times â€¦ \times a^{b_n2^n}mod c$$<br>æ˜“å‘ç°ï¼š<br>$$A_k=a^{b_k2^k} mod c$$<br>$$â€¦$$<br>$$A_n=a^{b_n2^n} mod c$$</p>
<p>å³ï¼š$A(n)$æ˜¯$A(n-1)$çš„å¹³æ–¹å€ï¼</p>
<p>å®ç°ï¼š</p>
<pre><code><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">quick</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">1</span>;   <span class="comment">//è®°å½•ç»“æœ</span></div><div class="line">    a=a%c;   <span class="comment">//é¢„å¤„ç†ï¼Œä½¿å¾—aå¤„äºcçš„æ•°æ®èŒƒå›´ä¹‹ä¸‹</span></div><div class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=(ans*a)%c;   <span class="comment">//å¦‚æœbçš„äºŒè¿›åˆ¶ä½ä¸æ˜¯0ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç»“æœæ˜¯è¦å‚ä¸è¿ç®—çš„</span></div><div class="line">        b&gt;&gt;=<span class="number">1</span>;    <span class="comment">//äºŒè¿›åˆ¶çš„ç§»ä½æ“ä½œï¼Œç›¸å½“äºæ¯æ¬¡é™¤ä»¥2ï¼Œç”¨äºŒè¿›åˆ¶çœ‹ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸æ–­çš„éå†bçš„äºŒè¿›åˆ¶ä½</span></div><div class="line">        a=(a*a)%c;   <span class="comment">//ä¸æ–­çš„åŠ å€</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><h1 id="ä»£ç ">6. ä»£ç </h1><pre><code>#include &lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cmath&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;string&gt;
#include&lt;algorithm&gt;
#include &lt;math.h&gt;
using namespace std;
long quick_algorithm(long long a,long long n,int modNum){
    a=a%modNum ;
    long long ans=1 ;
    //è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘b&lt;0ï¼Œå› ä¸ºåˆ†æ•°æ²¡æœ‰å–æ¨¡è¿ç®—
    while(n!=0){
        if(n&amp;1)
            ans=(ans*a)%modNum ;
        n&gt;&gt;=1  ;
        a=(a*a)%modNum;
    }
    return ans;
}
long set2(long long n,int modNum){
    long long a=3;
    long long b=1;
    /*for(long long i=0;i&lt;n;i++){
        a=a*3;
        a=a%modNum;
    }*/
    a= quick_algorithm(a,n,modNum);
    if(n%2==1){
        b=-1;
    }
    //a=a;
    a=0.5*a+0.5*b;
    return a;
}

int main()
{
    int modNum=1000000007;
    long long input=999999999;
    scanf(&quot;%lld&quot;,&amp;input);
    if(input==0||input==1){
        printf(&quot;%lld\n&quot;,1);
    }else{
        long long out=set2(input,modNum);
        printf(&quot;%lld\n&quot;,out);
    }
    return 0;
}
</code></pre><h1 id="å‚è€ƒæ–‡çŒ®">7. å‚è€ƒæ–‡çŒ®</h1><ol>
<li>ã€Šç»„åˆæ•°å­¦å¼•è®ºã€‹</li>
</ol>
<p>é™„ä¸Šæœ¬é¢˜çš„è‰°è¾›å²ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-03-13-55-57.png" alt=""> </p>
]]></content>
      
        <categories>
            
            <category> ACM </category>
            
        </categories>
        
        
        <tags>
            
            <tag> é€’æ¨å…³ç³» </tag>
            
            <tag> å¿«é€Ÿå¹‚å–æ¨¡ </tag>
            
            <tag> é•¿æ•´å‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[QRåˆ†è§£]]></title>
      <url>/2017/03/31/%E6%95%B0%E5%AD%A6-QR%E5%88%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h1 id="QRåˆ†è§£">1. QRåˆ†è§£</h1><p><strong>å¼•ç†</strong>ï¼š</p>
<ol>
<li>å¯¹äºä»»æ„çš„$A\in C^{n\times n}$,è‹¥å­˜åœ¨$n$é˜¶æ­£äº¤çŸ©é˜µ$Q$å’Œ$n$é˜¶ä¸Šä¸‰è§’çŸ©é˜µ$R$ï¼Œä½¿å¾—$A=QR$ï¼Œåˆ™ç§°$QR$ä¸º$A$çš„$QR$åˆ†è§£ã€‚</li>
<li>è‹¥$A\in C^{n\times n}$å¯é€†ï¼Œåˆ™å­˜åœ¨æ­£äº¤çŸ©é˜µ$Q$å’Œæ­£å¯¹è§’å…ƒçš„ä¸Šä¸‰è§’çŸ©é˜µ$R$ï¼Œä½¿å¾—$A=QR$ï¼Œä¸”è¡¨ç¤ºå¼å”¯ä¸€ã€‚</li>
</ol>
<p>å¤‡æ³¨ï¼šæ­£äº¤çŸ©é˜µï¼š$A^{-1}=A^T$<br><strong>QRåˆ†è§£å®šç†</strong>ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-12-06-04.png" alt=""><br>ï¼Œåˆ™Aæœ‰QRåˆ†è§£ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-12-06-23.png" alt=""><br>Qæ˜¯m<em>mçš„æ­£äº¤çŸ©é˜µ<br>Ræ˜¯n</em>nçš„æœ‰éè´Ÿå¯¹è§’å…ƒçš„ä¸Šä¸‰è§’é˜µ</p>
<p>å½“m=nï¼Œä¸”Aéå¥‡å¼‚æ—¶ï¼Œä¸Šè¿°åˆ†è§£å”¯ä¸€ã€‚</p>
<p><strong>è®¡ç®—QRåˆ†è§£çš„æ–¹æ³•</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-28-42.png" alt=""> </p>
<p>å¤‡æ³¨ï¼š<br>è®¡ç®—A(j:m,j:n)=(I(m-j+1)-bvvT)A(j:m,j:n)æ—¶ï¼Œ<br>I(m-j+1)-bvvTå¯ä»¥è¡¨ç¤ºä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-01-21-24-25.png" alt=""> </p>
<p><strong>QRåˆ†è§£çš„å­˜å‚¨æ–¹æ³•</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-01-21-54-20.png" alt=""> </p>
<p><strong>ç”¨QRåˆ†è§£è§£çº¿æ€§æ–¹ç¨‹ç»„</strong><br>$Ax=b$<br>$QRx=b$<br>$Rx=Q^{-1}b$<br>$x=R^{-1}Q^{-1}b$<br>$x=R^{-1}Q^Tb$</p>
<h1 id="householderæ–¹æ³•">2. householderæ–¹æ³•</h1><p>åˆ©ç”¨Householderå˜æ¢é€æ­¥å°†AåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µã€‚</p>
<p>ä½¿ç”¨Gausså˜æ¢å°†çŸ©é˜µåŒ–ä¸ºä¸Šä¸‰è§’çš„ç†è®ºä¾æ®â€”â€”â€”â€”å¯¹äºä¸€ä¸ªç»™å®šçš„å‘é‡xï¼Œå¯æ„é€ ä¸€ä¸ªåˆç­‰ä¸‹ä¸‰è§’é˜µLï¼Œä½¿å¾—$Lx=ae_1$ï¼Œå…¶ä¸­$e_1$æ˜¯Içš„ç¬¬ä¸€åˆ—ï¼Œaæ˜¯å®æ•°ã€‚ï¼ˆIæ˜¯å•ä½çŸ©é˜µï¼‰</p>
<p>householderå˜æ¢ç›®çš„ï¼š<br>æ±‚ä¸€ä¸ªåˆç­‰æ­£äº¤çŸ©é˜µï¼Œä½¿å…¶å…·æœ‰çŸ©é˜µLçš„åŠŸèƒ½ã€‚</p>
<p>ä½¿å¾—ï¼š<br>å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—åˆç­‰æ­£äº¤å˜æ¢æ¥å®ŒæˆçŸ©é˜µçš„ä¸Šä¸‰è§’åŒ–ä»»åŠ¡ã€‚</p>
<p><strong>Householderå˜æ¢</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-03-16.png" alt=""> </p>
<p>å…¶ä¸­ï¼š<br>Iæ˜¯å•ä½çŸ©é˜µ<br>wæ˜¯å®çš„å•ä½åˆ—å‘é‡ï¼ˆå•ä½æ­£äº¤çŸ©é˜µï¼‰ï¼Œ$ww^T=I$</p>
<p>HouseHolderå˜æ¢å¯ä»¥å°†ä¸€ä¸ªå‘é‡æ˜ å°„åˆ°ä¸€ä¸ªè¶…å¹³é¢ä¸Šã€‚ </p>
<p><strong>Householderå˜æ¢çš„æ€§è´¨</strong></p>
<ol>
<li>å¯¹ç§°æ€§ã€‚$H^T=H$</li>
<li>æ­£äº¤æ€§ã€‚$H^TH=I$</li>
<li>å¯¹åˆæ€§ã€‚$H^2=I$</li>
<li>åå°„æ€§(householderå˜æ¢çš„ç‰©ç†æ„ä¹‰)ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-09-23.png" alt=""><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-10-12.png" alt=""> </li>
</ol>
<p><strong>Householderå˜æ¢çš„ç”¨é€”</strong></p>
<p>å®ƒèƒ½å¦‚Gausså˜æ¢ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡é€‚å½“é€‰å–å•ä½å‘é‡wï¼ŒæŠŠä¸€ä¸ªç»™å®šå‘é‡çš„è‹¥å¹²æŒ‡å®šçš„åˆ†é‡å˜ä¸ºé›¶ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-12-23.png" alt=""><br>ç”±ä»¥ä¸Šå®šç†å¯çŸ¥ï¼Œå¯¹äºä»»æ„çš„xï¼Œéƒ½å¯ä»¥æ„é€ å‡ºHouseholderçŸ©é˜µHï¼Œä½¿å¾—Hxçš„ån-1ä¸ªåˆ†é‡ä¸ºé›¶ã€‚</p>
<p><strong>Householderå˜æ¢æ–¹æ³•</strong><br>è®¡ç®—æŸä¸€è¡Œå‘é‡çš„houserå˜æ¢ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-24-15.png" alt=""><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-24-37.png" alt=""><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-22-24-58.png" alt=""> </p>
]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ±‚çº¿ä»£æ–¹ç¨‹çš„è§£]]></title>
      <url>/2017/03/30/%E6%95%B0%E5%AD%A6-%E6%B1%82%E7%BA%BF%E4%BB%A3%E6%96%B9%E7%A8%8B%E7%9A%84%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h1 id="LUåˆ†è§£æ¡ä»¶">1. LUåˆ†è§£æ¡ä»¶</h1><p>å¦‚æœné˜¶æ–¹é˜µAçš„å„é˜¶é¡ºåºä¸»å­å¼<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-19-34-31.png" alt=""> ï¼Œå³Açš„å„é˜¶é¡ºåºä¸»å­çŸ©é˜µAkéƒ½å¯é€†ï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„å•ä½ä¸‹ä¸‰è§’çŸ©é˜µLä¸å”¯ä¸€çš„éå¥‡å¼‚ä¸Šä¸‰è§’çŸ©é˜µUï¼Œä½¿å¾—A=LU</p>
<p>å…¶ä¸­ké˜¶é¡ºåºä¸»å­å¼æŒ‡<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-19-36-08.png" alt=""> </p>
<h1 id="LUåˆ†è§£æ–¹æ³•">2. LUåˆ†è§£æ–¹æ³•</h1><p>ç”±äºLå­˜åœ¨å¯é€†çŸ©é˜µLâ€™ï¼Œå³LLâ€™=E<br>åˆ™Lâ€™A=LLâ€™U=U<br>å› æ­¤å¾—å‡ºä¸€èˆ¬çš„åˆ†è§£æ–¹æ³•ï¼š<br>é€šè¿‡å¯¹(A,E)åšåˆç­‰è¡Œå˜æ¢å¾—åˆ°(U,Lâ€™),å†ç”±Lâ€™å¾—åˆ°L.</p>
<p>å…¶ä¸­ï¼š</p>
<ol>
<li>Læ˜¯å•ä½ä¸‹ä¸‰è§’çŸ©é˜µï¼ˆå¯¹è§’çº¿ä¸Šçš„ç³»æ•°éƒ½ä¸º1çš„ä¸‹ä¸‰è§’çŸ©é˜µï¼‰ï¼›Lâ€™ä¹Ÿæ˜¯å•ä½ä¸Šä¸‰è§’çŸ©é˜µï¼›</li>
<li>Uæ˜¯éå¥‡å¼‚ä¸Šä¸‰è§’çŸ©é˜µï¼›</li>
</ol>
<h1 id="æ±‚è§£æ–¹æ³•">3. æ±‚è§£æ–¹æ³•</h1><p>å¯¹äºä¸€èˆ¬çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š<br>$$Ax=b$$<br>å¦‚æœæˆ‘ä»¬èƒ½å°†Aåˆ†è§£æˆ$A=LU$,å³ä¸€ä¸ªä¸‹ä¸‰è§’é˜µå’Œä¸€ä¸ªä¸Šä¸‰è§’é˜µUçš„ä¹˜ç§¯ï¼Œé‚£åŸæ–¹ç¨‹ç»„çš„è§£xä¾¿å¯ç”±ä¸‹é¢ä¸¤æ­¥å¾—åˆ°ï¼š</p>
<ol>
<li>ç”¨å‰ä»£æ³•è§£$Ly=b$çš„yï¼›<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-16-20-29.png" alt=""> </li>
<li>ç”¨å›ä»£æ³•è§£$Ux=y$çš„x.<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-16-31-08.png" alt=""> </li>
</ol>
<p>å¯¹äºåˆ—ä¸»å…ƒæ¶ˆå»æ³•ï¼Œæ±‚çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„è®¡ç®—è¿‡ç¨‹å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š</p>
<ol>
<li>æ±‚Açš„åˆ—ä¸»å…ƒLUåˆ†è§£$PA=LU$</li>
<li>è§£ä¸‹ä¸‰è§’å½¢æ–¹ç¨‹ç»„$Ly=Pb$</li>
<li>è§£ä¸Šä¸‰è§’å½¢æ–¹ç¨‹ç»„$Ux=y$</li>
</ol>
<h1 id="å®ç°">4. å®ç°</h1><p>å‰ä»£æ³•ï¼š<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå›ä»£æ³•åœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘åˆ°ä¸»å…ƒä½ç½®åºåˆ—ï¼Œå¹¶åŒæ—¶å¯¹bè¿›è¡Œè°ƒæ•´ã€‚</p>
<pre><code>double * forwardSub(double *lu,int n,double *b,int *p){
    //double *y=new double[n];
    double temp;
      //æŒ‰qivotå¯¹bè¡Œå˜æ¢ï¼Œä¸LUåŒ¹é…
      for(int i=0; i&lt;n-1; i++)  
      {
            temp = b[p[i]];
            b[p[i]] = b[i];
            b[i]=temp;
      }
    for(int i=0; i&lt;n; i++)
            for(int j=0; j&lt;i; j++)
                b[i]=b[i]-lu[n*i+j]*b[j];
    b[n-1]=b[n-1];
    return b;
}
</code></pre><p>å›ä»£æ³•ï¼š<br>ç”±äºUæ˜¯ä¸Šä¸‰è§’çŸ©é˜µï¼Œæ‰€ä»¥è¦ä»x[n-1]å¼€å§‹è®¡ç®—ã€‚</p>
<pre><code>double * backSub(double *b,double *lu,int n){
     for(int i=n-1; i&gt;=0; i--)
      {
            for(int j=n-1; j&gt;i; j--)
                b[i]=b[i]-lu[n*i+j]*b[j];
            b[i]=b[i]/lu[n*i+i];
      }
    return b;
}
</code></pre><p>è®¡ç®—ï¼š</p>
<pre><code>bool guass(double *lu,int *p,double*b,int n){
    double * y = forwardSub(lu,n,b,p);
    double * x = backSub(y,lu,n);
    std::cout&lt;&lt;endl&lt;&lt;&quot;the sulution is ; &quot;&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        std::cout&lt;&lt;x[i]&lt;&lt;&quot;\t&quot;;
    }
    std::cout&lt;&lt;endl;
}
</code></pre><p>è¾“å‡ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-11-02-01.png" alt=""> </p>
<p>ä»£ç ï¼š</p>
<pre><code>#include &lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;iomanip&gt;
#define LIM -100000000
using namespace std;
double *luReult;
void printmat(double *mat,int n,string s){
    std::cout&lt;&lt;endl&lt;&lt;endl&lt;&lt;s&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        for(int j=0;j&lt;n;j++){
            printf(&quot;%.5f\t&quot;,mat[i*n+j]);
        }
        std::cout&lt;&lt;endl;
    }
}
void printarr(int *mat,int n,string s){
    std::cout&lt;&lt;endl&lt;&lt;endl&lt;&lt;s&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        std::cout&lt;&lt;mat[i]&lt;&lt;&quot;\t&quot;;
        //printf(&quot;%s\t&quot;,mat[i]);
    }
}
int findMainNumber(double *a,int n,int r){
    float maxa=-99999;
    int maxaIdx=-1;
    //printmat(a,n,&quot;a is now :&quot;);
    for(int i=r;i&lt;n;i++){
        if(a[i*n+r]&gt;maxa){
            maxa=a[i*n+r];
            maxaIdx=i;
        }
    }
    return maxaIdx;
}
void exchange(double *a,int n,int e,int r){
    float temp=0;
    for(int i=0;i&lt;n;i++){
        temp = a[r*n+i];
        a[r*n+i]=a[e*n+i];
        a[e*n+i]=temp;
    }
}
bool lu(double* a, int* pivot, int n)//çŸ©é˜µLUåˆ†è§£
{
      for(int k=0;k&lt;n;k++){
        //å¯»æ‰¾ç¬¬kåˆ—çš„ä¸»å…ƒ
        int p = findMainNumber(a,n,k);
        exchange(a,n,p,k);//äº¤æ¢kè¡Œå’Œpè¡Œ
        pivot[k]=p;//è®°å½•ç½®æ¢çŸ©é˜µp
        if(a[k*n+k]!=0){
                for(int i=k+1;i&lt;n;i++){//éƒ¨åˆ†ä¸‹ä¸‰è§’L
                    a[i*n+k]=a[i*n+k]/a[k*n+k];
                }
                for(int i=k+1;i&lt;n;i++){//è®¡ç®—ä¸Šä¸‰è§’U
                    for(int j=k+1;j&lt;n;j++){
                        a[i*n+j]=a[i*n+j]-a[i*n+k]*a[k*n+j];
                    }
                }
        }else{
            return true;//çŸ©é˜µå¥‡å¼‚
        }
      }
      /*
      //è®¡ç®—ä¸‹ä¸‰è§’L
      double temp=0;
       for(int i=0; i&lt;n-2; i++)//iè¡Œkåˆ—
            for(int k=i+1; k&lt;n-1;k++)
            {
                    temp=a[n*pivot[k] + i];
                    a[n*pivot[k] + i]=a[k*n + i];
                    a[k*n + i]=temp;
            }
        */
      luReult=a;
      printmat(a,n,&quot;lu&quot;);
      return false ;
}
double radio(int a,int b){
    return (double)(a)/(double)(b);
}
void buildHilbert(double *a,double *b,int n){
    for(int r=0;r&lt;n;r++){
        for(int j=0;j&lt;n;j++){
            a[r*n+j]=radio(1,j+r+1);
            b[r]=b[r]+a[r*n+j];
        }
    }
}
void exchangeb(double *b,int n,int r,int e){
    double temp=0;
    temp=b[e];
    b[e]=b[r];
    b[r]=temp;
    /*r(int i=0;i&lt;n;i++){
        temp=b[r*n+i];
        b[r*n+i]=b[e*n+i];
        b[e*n+i]=temp;
    }*/
}
double * forwardSub(double *lu,int n,double *b,int *p){
    //double *y=new double[n];
    double temp;
      //æŒ‰qivotå¯¹bè¡Œå˜æ¢ï¼Œä¸LUåŒ¹é…
      for(int i=0; i&lt;n-1; i++)
      {
            temp = b[p[i]];
            b[p[i]] = b[i];
            b[i]=temp;
      }
    for(int i=0; i&lt;n; i++)
            for(int j=0; j&lt;i; j++)
                b[i]=b[i]-lu[n*i+j]*b[j];
    b[n-1]=b[n-1];
    return b;
}

double * backSub(double *b,double *lu,int n){
     for(int i=n-1; i&gt;=0; i--)
      {
            for(int j=n-1; j&gt;i; j--)
                b[i]=b[i]-lu[n*i+j]*b[j];
            b[i]=b[i]/lu[n*i+i];
      }
    return b;
}

bool guass(double *lu,int *p,double*b,int n){
    double * y = forwardSub(lu,n,b,p);
    double * x = backSub(y,lu,n);
    std::cout&lt;&lt;endl&lt;&lt;&quot;the sulution is ; &quot;&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        std::cout&lt;&lt;x[i]&lt;&lt;&quot;\t&quot;;
    }
    std::cout&lt;&lt;endl;
}
int main()
{
    int n=6;//çŸ©é˜µæ˜¯n*nçš„
    double *b=new double[n];
    double *a=new double[n*n];
    /*double input[n*n]={0.001,1.00,1.00,2.00};
    a=input;
    double inputb[n]={1.00,3.00};
    b=inputb;*/
    buildHilbert(a,b,n);
    printmat(a,n,&quot;a:&quot;);
    int *pivot=new int[n*n];
    luReult=new double[n*n];
    lu(a,pivot,n);
    printarr(pivot,n,&quot;p:&quot;);
     guass(luReult,pivot,b,n);
    //cout &lt;&lt; &quot;Hello world!&quot; &lt;&lt; endl;
    return 0;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çŸ©é˜µåˆ†è§£ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[çŸ©é˜µLUåˆ†è§£åŠå…¶å®ç°]]></title>
      <url>/2017/03/29/%E6%95%B0%E5%AD%A6-%E7%9F%A9%E9%98%B5LU%E5%88%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>LUåˆ†è§£:å¯ä»¥å°†ä¸€ä¸ªçŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ª<strong>å•ä½ä¸‹ä¸‰è§’çŸ©é˜µ</strong>å’Œä¸€ä¸ª<strong>ä¸Šä¸‰è§’çŸ©é˜µ</strong>çš„<strong>ä¹˜ç§¯</strong>ï¼ˆæœ‰æ—¶æ˜¯å®ƒä»¬å’Œä¸€ä¸ªç½®æ¢çŸ©é˜µçš„ä¹˜ç§¯ï¼‰ã€‚LUåˆ†è§£ä¸»è¦åº”ç”¨åœ¨æ•°å€¼åˆ†æä¸­ï¼Œç”¨æ¥è§£çº¿æ€§æ–¹ç¨‹ã€æ±‚åçŸ©é˜µæˆ–è®¡ç®—è¡Œåˆ—å¼ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-19-31-33.png" alt=""> </p>
<h1 id="LUåˆ†è§£æ¡ä»¶">1. LUåˆ†è§£æ¡ä»¶</h1><p>å¦‚æœné˜¶æ–¹é˜µAçš„å„é˜¶é¡ºåºä¸»å­å¼<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-19-34-31.png" alt=""> ï¼Œå³Açš„å„é˜¶é¡ºåºä¸»å­çŸ©é˜µAkéƒ½å¯é€†ï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„å•ä½ä¸‹ä¸‰è§’çŸ©é˜µLä¸å”¯ä¸€çš„éå¥‡å¼‚ä¸Šä¸‰è§’çŸ©é˜µUï¼Œä½¿å¾—A=LU</p>
<p>å…¶ä¸­ké˜¶é¡ºåºä¸»å­å¼æŒ‡<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-19-36-08.png" alt=""> </p>
<h1 id="LUåˆ†è§£æ–¹æ³•">2. LUåˆ†è§£æ–¹æ³•</h1><p>ç”±äºLå­˜åœ¨å¯é€†çŸ©é˜µLâ€™ï¼Œå³LLâ€™=E<br>åˆ™Lâ€™A=LLâ€™U=U<br>å› æ­¤å¾—å‡ºä¸€èˆ¬çš„åˆ†è§£æ–¹æ³•ï¼š<br>é€šè¿‡å¯¹(A,E)åšåˆç­‰è¡Œå˜æ¢å¾—åˆ°(U,Lâ€™),å†ç”±Lâ€™å¾—åˆ°L.</p>
<p>å…¶ä¸­ï¼š</p>
<ol>
<li>Læ˜¯å•ä½ä¸‹ä¸‰è§’çŸ©é˜µï¼ˆå¯¹è§’çº¿ä¸Šçš„ç³»æ•°éƒ½ä¸º1çš„ä¸‹ä¸‰è§’çŸ©é˜µï¼‰ï¼›Lâ€™ä¹Ÿæ˜¯å•ä½ä¸Šä¸‰è§’çŸ©é˜µï¼›</li>
<li>Uæ˜¯éå¥‡å¼‚ä¸Šä¸‰è§’çŸ©é˜µï¼›</li>
</ol>
<h1 id="ç›´æ¥æ¶ˆå»æ³•çš„çŸ©é˜µè§£é‡Š">3. ç›´æ¥æ¶ˆå»æ³•çš„çŸ©é˜µè§£é‡Š</h1><p>è®¡ç®—è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-13-15.png" alt=""> </p>
<p><strong>ç›®çš„</strong>ï¼šå°†[A|E]â€“&gt;[U|L]å½¢å¼ï¼Œå…¶ä¸­Uæ˜¯ä¸Šä¸‰è§’çŸ©é˜µ</p>
<p><strong>è¿‡ç¨‹</strong>ï¼šæ¯è½®å°†ä¸€åˆ—çš„ä¸‹ä¸‰è§’æ¶ˆä¸º0ï¼Œå°±ç›¸å½“äºç»™Aå·¦ä¹˜ä¸€ä¸ªä¸‹ä¸‰è§’å•ä½çŸ©é˜µLkï¼ˆå¯¹è§’çº¿ä¸º1ï¼Œä¿è¯å˜æ¢åå¯¹è§’çº¿å…ƒç´ ä¸å˜ï¼‰ã€‚</p>
<p><strong>ç¬¬ä¸€è½®æ¶ˆå…ƒ</strong>ï¼šå°†ç¬¬ä¸€åˆ—çš„ä¸‹ä¸‰è§’æ¶ˆä¸º0ï¼Œç›¸å½“äºå¯¹A1å·¦ä¹˜çŸ©é˜µL1ï¼Œå³ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-54-39.png" alt=""><br>å…¶ä¸­ï¼Œ<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-55-24.png" alt=""><br>æˆ‘ä»¬æ³¨æ„åˆ°li1æ°å¥½ä½¿å¾—ç¬¬iè¡Œçš„ç¬¬ä¸€åˆ—å…ƒç´ å˜ä¸ºé›¶ï¼Œå³ai1-li1*a11=0ã€‚</p>
<p><strong>ç¬¬äºŒè½®æ¶ˆå…ƒ</strong>ï¼šå°†ç¬¬äºŒåˆ—çš„ä¸‹ä¸‰è§’æ¶ˆä¸º0ï¼Œå¯¹åº”äº<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-57-24.png" alt=""> </p>
<p><strong>ç¬¬kè½®æ¶ˆå…ƒ</strong>:<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-57-48.png" alt=""><br>å…¶ä¸­ï¼Œ<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-58-09.png" alt=""> </p>
<p>æŠŠkè½®æ¶ˆå…ƒç›¸ä¹˜ï¼Œå³ï¼š<br><strong>æ•´ä¸ªæ¶ˆå…ƒè¿‡ç¨‹ä¸º</strong>ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-20-59-09.png" alt=""> </p>
<p><strong>æ€»ç»“</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-21-05-36.png" alt=""><br>åˆå§‹ï¼ˆç¬¬ä¸€æ­¥ï¼‰ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-21-00-46.png" alt=""> </p>
<p>è¿­ä»£ç¬¬ræ­¥ï¼š<br>å³<br>ur=f(u1,u2,â€¦,u(r-1),l1,l2,â€¦,l(r-1)),ç¬¬ré¡¹ç”±å‰r-1é¡¹è®¡ç®—å¾—åˆ°<br>lr=g(u1,u2,â€¦,u(r-1),l1,l2,â€¦,l(r-1))<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-29-21-02-44.png" alt=""> </p>
<p>è®¡ç®—é¡ºåºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-10-36-28.png" alt=""> </p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—æ—¶éœ€è¦åˆ¤æ–­æœ¬é˜¶çš„é¡ºåºä¸»å­å¼æ˜¯å¦ä¸ºé›¶ã€‚</p>
<p><strong>ä»£ç å®ç°</strong><br>å¤‡æ³¨ï¼šå…¶ä¸­çš„piovtæš‚æ—¶æ²¡æœ‰åµç”¨ã€‚</p>
<p>è¾“å…¥çŸ©é˜µï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-14-16-46.png" alt=""> </p>
<pre><code>bool lu(double *a,int *pivot,int n){//çŸ©é˜µæ˜¯n*nçš„
double test = det(a,r,n);//æ£€éªŒæœ¬é˜¶é¡ºåºä¸»å­å¼æ˜¯å¦ä¸º0
 if(test==0){
    return true;
 }
//æ•°ç»„aåœ¨å†…å­˜ä¸­æŒ‰è¡Œä¼˜å…ˆæ¬¡åºå­˜æ”¾
//pivot:è¾“å‡ºå‚æ•°
//pivot[0,n)ä¸­å­˜æ”¾ä¸»å…ƒçš„ä½ç½®æ’åˆ—
//æˆåŠŸæ—¶è¿”å›falseï¼Œå¦åˆ™è¿”å›ture
//int len = sizeof(a)/sizeof(a[0]);
double *U,*L;
U = new double[n*n];
L = new double[n*n];
set0(U,n);
set0(L,n);
//å…ˆç®—urj(å›ºå®šrï¼Œè®¡ç®—å®Œæ‰€æœ‰çš„urj)ï¼Œå†ç®—ljr(å›ºå®šiï¼Œè®¡ç®—å®Œæ‰€æœ‰çš„ljr)
for(int r=0;r&lt;n;r++){
    //è®¡ç®—urj(å›ºå®šrï¼Œè®¡ç®—å®Œæ‰€æœ‰çš„urj)
    //è®¡ç®—ljr(å›ºå®šiï¼Œè®¡ç®—å®Œæ‰€æœ‰çš„ljr)
    for(int j=r;j&lt;n;j++){
        double sum_lu1=0;
        double sum_lu2=0;
        for(int k=0;k&lt;r;k++){
            sum_lu1 = sum_lu1+L[r*n+k]*U[k*n+j];
            sum_lu2 = sum_lu2+L[j*n+k]*U[k*n+r];
        }
        U[r*n+j]=a[r*n+j]-sum_lu1;
        if(j==r){
            L[j*n+r]=1;
        }else{
            L[j*n+r]=a[j*n+r]-sum_lu2;
            L[j*n+r]=L[j*n+r]/U[r*n+r];
        }
    }
}
return false;
}
</code></pre><p>ç»“æœï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-14-22-05.png" alt=""> </p>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘çš„ç­”æ¡ˆä¸ç½‘ä¸Šçš„ä¹‹å‰å­¦é•¿åšè¿‡çš„è¿™é“é¢˜çš„ç­”æ¡ˆç»Ÿç»Ÿä¸ä¸€æ ·ã€‚ä»”ç»†æ£€æŸ¥åè¿˜æ˜¯æŸ¥ä¸å‡ºæ¥ã€‚åˆç”¨MatlabéªŒè¯äº†ä¸€ä¸‹LUåˆ†è§£ï¼ŒMATLABè·‘çš„ç»“æœä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-30-14-39-25.png" alt=""><br>ä¸æˆ‘è‡ªå·±çš„LçŸ©é˜µä¸€è‡´ã€‚å†³å®šè¿˜æ˜¯ç›¸ä¿¡è‡ªå·±ã€‚</p>
<h1 id="åˆ—ä¸»å…ƒé«˜æ–¯æ¶ˆå»æ³•">4. åˆ—ä¸»å…ƒé«˜æ–¯æ¶ˆå»æ³•</h1><p>ä¸»è¦æ€æƒ³æ˜¯åœ¨æ¯æ¬¡è®¡ç®—ç¬¬rè¡Œæ—¶ï¼Œé€‰å–å½“å‰ç¬¬råˆ—ä¸‹çš„æœ€å¤§çš„a[i,r]çš„æ‰€åœ¨çš„ç¬¬iè¡Œä½œä¸ºä¸»å…ƒï¼Œå³å°†ç¬¬iè¡Œä¸ç¬¬rè¡Œäº¤æ¢ï¼Œå†è¿›è¡Œè®¡ç®—ã€‚</p>
<p>ä¸»è¦ç†è®ºè§å‚è€ƒæ–‡çŒ®-åŒ—é‚®ç†å­¦é™¢æ•°å€¼åˆ†æè¯¾ä»¶chapter5.</p>
<p>ä»£ç ï¼š</p>
<pre><code>#include &lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;iomanip&gt;
#define LIM -100000000
using namespace std;
double *luReult;
void printmat(double *mat,int n,string s){
    std::cout&lt;&lt;endl&lt;&lt;endl&lt;&lt;s&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        for(int j=0;j&lt;n;j++){
            printf(&quot;%.5f\t&quot;,mat[i*n+j]);
        }
        std::cout&lt;&lt;endl;
    }
}
void printarr(int *mat,int n,string s){
    std::cout&lt;&lt;endl&lt;&lt;endl&lt;&lt;s&lt;&lt;endl;
    for(int i=0;i&lt;n;i++){
        std::cout&lt;&lt;mat[i]&lt;&lt;&quot;\t&quot;;
        //printf(&quot;%s\t&quot;,mat[i]);
    }
}
int findMainNumber(double *a,int n,int r){
    float maxa=-99999;
    int maxaIdx=-1;
    //printmat(a,n,&quot;a is now :&quot;);
    for(int i=r;i&lt;n;i++){
        if(a[i*n+r]&gt;maxa){
            maxa=a[i*n+r];
            maxaIdx=i;
        }
    }
    return maxaIdx;
}
void exchange(double *a,int n,int e,int r){
    float temp=0;
    for(int i=0;i&lt;n;i++){
        temp = a[r*n+i];
        a[r*n+i]=a[e*n+i];
        a[e*n+i]=temp;
    }
}
bool lu(double* a, int* pivot, int n)//çŸ©é˜µLUåˆ†è§£
{
      for(int k=0;k&lt;n;k++){
        //å¯»æ‰¾ç¬¬kåˆ—çš„ä¸»å…ƒ
        int p = findMainNumber(a,n,k);
        exchange(a,n,p,k);//äº¤æ¢kè¡Œå’Œpè¡Œ
        pivot[k]=p;//è®°å½•ç½®æ¢çŸ©é˜µp
        if(a[k*n+k]!=0){
                for(int i=k+1;i&lt;n;i++){//éƒ¨åˆ†ä¸‹ä¸‰è§’L
                    a[i*n+k]=a[i*n+k]/a[k*n+k];
                }
                for(int i=k+1;i&lt;n;i++){//è®¡ç®—ä¸Šä¸‰è§’U
                    for(int j=k+1;j&lt;n;j++){
                        a[i*n+j]=a[i*n+j]-a[i*n+k]*a[k*n+j];
                    }
                }
        }else{
            return true;//çŸ©é˜µå¥‡å¼‚
        }
      }
      /*
      //è®¡ç®—ä¸‹ä¸‰è§’L
      double temp=0;
       for(int i=0; i&lt;n-2; i++)//iè¡Œkåˆ—
            for(int k=i+1; k&lt;n-1;k++)
            {
                    temp=a[n*pivot[k] + i];
                    a[n*pivot[k] + i]=a[k*n + i];
                    a[k*n + i]=temp;
            }
        */
      luReult=a;
      printmat(a,n,&quot;lu&quot;);
      return false ;
}
double radio(int a,int b){
    return (double)(a)/(double)(b);
}
void buildHilbert(double *a,double *b,int n){
    for(int r=0;r&lt;n;r++){
        for(int j=0;j&lt;n;j++){
            a[r*n+j]=radio(1,j+r+1);
            b[r]=b[r]+a[r*n+j];
        }
    }
}
void exchangeb(double *b,int n,int r,int e){
    double temp=0;
    temp=b[e];
    b[e]=b[r];
    b[r]=temp;
    /*r(int i=0;i&lt;n;i++){
        temp=b[r*n+i];
        b[r*n+i]=b[e*n+i];
        b[e*n+i]=temp;
    }*/
}

int main()
{
    int n=6;//çŸ©é˜µæ˜¯n*nçš„
    double *b=new double[n];
    double *a=new double[n*n];
    /*double input[n*n]={0.001,1.00,1.00,2.00};
    a=input;
    double inputb[n]={1.00,3.00};
    b=inputb;*/
    buildHilbert(a,b,n);
    printmat(a,n,&quot;a:&quot;);
    int *pivot=new int[n*n];
    luReult=new double[n*n];
    lu(a,pivot,n);
    printarr(pivot,n,&quot;p:&quot;);
    //cout &lt;&lt; &quot;Hello world!&quot; &lt;&lt; endl;
    return 0;
}
</code></pre><p>è¾“å‡ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-31-11-02-01.png" alt=""> </p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://ccjou.wordpress.com/2010/09/01/lu-%E5%88%86%E8%A7%A3/" target="_blank" rel="external">LU åˆ†è§£</a></li>
<li><a href="http://blog.csdn.net/u010945683/article/details/45803141" target="_blank" rel="external">çŸ©é˜µåˆ†æâ€”â€”LUåˆ†è§£</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æ•°å­¦ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çŸ©é˜µåˆ†è§£ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœ€å¤§æµ]]></title>
      <url>/2017/03/28/%E7%AE%97%E6%B3%95-%E6%9C%80%E5%A4%A7%E6%B5%81/</url>
      <content type="html"><![CDATA[<p>æœ€å¤§æµé—®é¢˜ï¼šç»™å®šæµç½‘ç»œã€æºèŠ‚ç‚¹ã€æ±‡ç‚¹ï¼Œæ‰¾åˆ°å€¼æœ€å¤§çš„ä¸€ä¸ªæµã€‚</p>
<h1 id="Ford-Fullkersonæ–¹æ³•">1. Ford-Fullkersonæ–¹æ³•</h1><p><strong>ä¸»è¦æ€æƒ³</strong>ï¼šå¾ªç¯å¢åŠ æµçš„å€¼ã€‚</p>
<h2 id="å‡ ä¸ªæ¦‚å¿µ">1.1. å‡ ä¸ªæ¦‚å¿µ</h2><h3 id="æ®‹å­˜ç½‘ç»œ-G-f">1.1.1. æ®‹å­˜ç½‘ç»œ$G_f$</h3><p>æ®‹å­˜ç½‘ç»œç®€å•å®šä¹‰ï¼š</p>
<pre><code>æ®‹å­˜ç½‘ç»œ=ç½‘ç»œå®¹é‡Capacity-æµé‡ç½‘ç»œflow
</code></pre><p>æ®‹å­˜ç½‘ç»œå½¢å¼åŒ–å®šä¹‰ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-28-19-36-03.png" alt=""> </p>
<p>è¯´æ˜ï¼š<br>ç¬¬ä¸€é¡¹å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯=ç½‘ç»œå®¹é‡Capacity-æµé‡ç½‘ç»œflow</p>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ACM-poj1789-TruckHistory]]></title>
      <url>/2017/03/27/ACM-poj1789-TruckHistory/</url>
      <content type="html"><![CDATA[<h1 id="Description">1. Description</h1><p>Advanced Cargo Movement, Ltd. uses trucks of different types. Some trucks are used for vegetable delivery, other for furniture, or for bricks. The company has its own code describing each type of a truck. The code is simply a string of exactly seven lowercase letters (each letter on each position has a very special meaning but that is unimportant for this task). At the beginning of companyâ€™s history, just a single truck type was used but later other types were derived from it, then from the new types another types were derived, and so on. </p>
<p>Movement:è¿åŠ¨<br>trucksï¼šå¡è½¦<br>exactly seven lowercase letters ï¼šæ­£å¥½ä¸ƒä¸ªå°å†™å­—æ¯<br>derivedï¼šæ´¾ç”Ÿ</p>
<p>Today, ACM is rich enough to pay historians to study its history. One thing historians tried to find out is so called derivation plan â€“ i.e. how the truck types were derived. They defined the distance of truck types as the number of positions with different letters in truck type codes. They also assumed that each truck type was derived from exactly one other truck type (except for the first truck type which was not derived from any other type). The quality of a derivation plan was then defined as<br><code>1/Î£(to,td)d(to,td)</code></p>
<p>qualityï¼šè´¨é‡</p>
<p>where the sum goes over all pairs of types in the derivation plan such that to is the original type and td the type derived from it and d(to,td) is the distance of the types.<br>Since historians failed, you are to write a program to help them. Given the codes of truck types, your program should find the highest possible quality of a derivation plan. </p>
<h1 id="Input">2. Input</h1><p>The input consists of several test cases. Each test case begins with a line containing the number of truck types, N, 2 &lt;= N &lt;= 2 000. Each of the following N lines of input contains one truck type code (a string of seven lowercase letters). You may assume that the codes uniquely describe the trucks, i.e., no two of these N lines are the same. The input is terminated with zero at the place of number of truck types.</p>
<h1 id="Output">3. Output</h1><p>For each test case, your program should output the text â€œThe highest possible quality is 1/Q.â€, where 1/Q is the quality of the best derivation plan.<br>Sample Input</p>
<p>4<br>aaaaaaa<br>baaaaaa<br>abaaaaa<br>aabaaaa<br>0</p>
<h1 id="Sample-Output">4. Sample Output</h1><p>The highest possible quality is 1/3.</p>
<h1 id="è§£å†³æ–¹æ¡ˆ">5. è§£å†³æ–¹æ¡ˆ</h1><p>t:è¡¨ç¤ºå¡è½¦çš„ä¸ƒä¸ªå­—æ¯çš„å­—ç¬¦ä¸²<br>d(t0,td)=t0å’Œtdä¸¤å¡è½¦çš„å­—ç¬¦ä¸²ä¸ç›¸åŒçš„ä¸ªæ•°</p>
<p>æ¯ä¸ªå¡è½¦éƒ½æ˜¯ç”±å¦ä¸€ä¸ªå¡è½¦æ´¾ç”Ÿè€Œæ¥ã€‚<br>ç°åœ¨ç»™å‡ºnç§ä¸åŒå‹å·çš„truckï¼Œé—®æ€æ ·ä½¿qualityçš„å€¼æœ€å°â€”â€”â€”â€”å³æ‰¾åˆ°ä¸€æ¡è¿æ¥æ‰€æœ‰truckçš„æœ€çŸ­è·¯å¾„</p>
]]></content>
      
        <categories>
            
            <category> ACM </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-æœ€å°ç”Ÿæˆæ ‘ç®—æ³•]]></title>
      <url>/2017/03/26/%E7%AE%97%E6%B3%95-%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%E7%AE%97%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>å¸¦æƒå›¾åˆ†ä¸ºæœ‰å‘å’Œæ— å‘ï¼Œæ— å‘å›¾çš„æœ€çŸ­è·¯å¾„åˆå«åšæœ€å°ç”Ÿæˆæ ‘ï¼Œæœ‰primeç®—æ³•å’Œkruskalç®—æ³•ï¼›æœ‰å‘å›¾çš„æœ€çŸ­è·¯å¾„ç®—æ³•æœ‰dijkstraç®—æ³•å’Œfloydç®—æ³•ã€‚</p>
<p>æœ€å°ç”Ÿæˆæ ‘é—®é¢˜ï¼šç»™å®šä¸€ä¸ªè¿é€šæ— å‘å›¾ï¼Œå¯»æ‰¾ä¸€é¢—æ— ç¯æ ‘ï¼Œä½¿å¾—æ ‘ä¸Šæ‰€æœ‰è¾¹æƒå€¼ä¹‹å’Œæœ€å°ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-26-20-15-02.png" alt=""> </p>
<h1 id="æœ€å°ç”Ÿæˆæ ‘çš„è´ªå¿ƒç­–ç•¥çš„é€šç”¨æ–¹æ³•">1. æœ€å°ç”Ÿæˆæ ‘çš„è´ªå¿ƒç­–ç•¥çš„é€šç”¨æ–¹æ³•</h1><h2 id="é—®é¢˜æè¿°">1.1. é—®é¢˜æè¿°</h2><p><strong>å·²çŸ¥</strong>ï¼šè¿é€šæ— å‘å›¾$G=(V,E)$ï¼Œæƒé‡å‡½æ•°$w:E \rightarrow R$<br><strong>å¾ªç¯ä¸å˜å¼</strong>ï¼šåœ¨æ¯è¾¹å¾ªç¯ä¹‹å‰ï¼ŒAæ˜¯æŸé¢—æœ€å°ç”Ÿæˆæ ‘çš„ä¸€ä¸ªå­é›†ã€‚<br><strong>ä¼ªä»£ç </strong></p>
<pre><code>GENERIC-MST(G,w)
A={}
while A does not form a spanning tree // å½“Aä¸æ˜¯ä¸€ä¸ªç”Ÿæˆæ ‘æ—¶
    find an edge(u,v) that is safe for A // æ‰¾åˆ°ä¸€æ¡Açš„å®‰å…¨è¾¹
    A = A âˆª {(u,v)}
return A
</code></pre><p>æ³¨ï¼šå®‰å…¨è¾¹æ˜¯æŒ‡åŠ å…¥Aåï¼Œä¸ä¼šä½¿å¾—Aè¿åå¾ªç¯ä¸å˜å¼ã€‚å³ A âˆª {(u,v)}ä¹Ÿæ˜¯æŸé¢—æœ€å°ç”Ÿæˆæ ‘çš„ä¸€ä¸ªå­é›†</p>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•å¯»æ‰¾å®‰å…¨è¾¹</p>
<h2 id="æ±‚å®‰å…¨è¾¹">1.2. æ±‚å®‰å…¨è¾¹</h2><p><strong>å®šç†</strong>ï¼šè®¾Aæ˜¯å›¾Gçš„æŸæœ€å°ç”Ÿæˆæ ‘çš„ä¸€ä¸ªå­é›†ã€‚è®¾ï¼ˆS,V-Sï¼‰æ˜¯å›¾Gä¸­å°Šé‡é›†åˆAçš„ä»»æ„ä¸€ä¸ªåˆ‡å‰²ï¼Œåˆè®¾(u,v)æ˜¯æ¨ªè·¨åˆ‡å‰²(S,V-S)çš„ä¸€æ¡è½»é‡çº§è¾¹ï¼Œåˆ™è¾¹(u,v)å¯¹äºé›†åˆAæ˜¯å®‰å…¨çš„ã€‚</p>
<p><strong>åˆ‡å‰²</strong>ï¼šå›¾ä¸­çš„çº¿<br><strong>åˆ‡å‰²å°Šé‡é›†åˆA</strong>ï¼šé›†åˆAä¸­ä¸å­˜åœ¨æ¨ªè·¨åˆ‡å‰²çš„è¾¹ï¼ˆå¦‚å›¾aä¸­çš„ç°ç²—çº¿æ„æˆçš„é›†åˆï¼‰<br><strong>è½»é‡çº§è¾¹</strong>ï¼šæ¨ªè·¨ä¸€ä¸ªåˆ‡å‰²çš„æ‰€æœ‰è¾¹ä¸­æƒé‡æœ€å°çš„è¾¹ï¼ˆä¸å”¯ä¸€ï¼‰ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-26-21-11-54.png" alt=""> </p>
<h1 id="Kruskalå’ŒPrimå…³ç³»">2. Kruskalå’ŒPrimå…³ç³»</h1><table>
<thead>
<tr>
<th>term</th>
<th style="text-align:right">é›†åˆA</th>
<th style="text-align:center">è¯´æ˜</th>
<th style="text-align:center">å…±æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kruskal</td>
<td style="text-align:right">æ£®æ—</td>
<td style="text-align:center">ç»“ç‚¹æ˜¯åŸå›¾ç»“ç‚¹ï¼Œå®‰å…¨è¾¹æ˜¯æƒé‡æœ€å°çš„è¿æ¥ä¸¤ä¸ªä¸åŒåˆ†é‡çš„è¾¹</td>
<td style="text-align:center">éƒ½æ˜¯ç”¨å…·ä½“çš„è§„åˆ™æ¥ç¡®å®šå®‰å…¨è¾¹çš„æ–¹æ³•</td>
</tr>
<tr>
<td>Prim</td>
<td style="text-align:right">æ ‘</td>
<td style="text-align:center">å®‰å…¨è¾¹æ˜¯è¿æ¥Aå’ŒAä¹‹å¤–æŸä¸ªèŠ‚ç‚¹çš„è¾¹ä¸­æƒé‡æœ€å°çš„è¾¹</td>
</tr>
</tbody>
</table>
<h1 id="Kruskalç®—æ³•">3. Kruskalç®—æ³•</h1><p><strong>å¯»æ‰¾å®‰å…¨è¾¹</strong>:åœ¨æ‰€æœ‰è¿æ¥ä¸¤ä¸ªä¸åŒæ ‘çš„è¾¹é‡Œï¼Œæ‰¾åˆ°æƒé‡æœ€å°çš„è¾¹(u,v)</p>
<h2 id="ä¼ªä»£ç ">3.1. ä¼ªä»£ç </h2><pre><code>MST-KRUSKAL(G,w)
A={}//Aæ˜¯æ£®æ—
for each vertex vâˆˆG.V
    MAKE-SET(v)//å°†é›†åˆAåˆå§‹åŒ–ä¸ºç©ºé›†ï¼Œå¹¶åˆ›å»ºMé¢—å­æ ‘ï¼Œæ¯æ£µæ ‘å„å«ä¸€ä¸ªç»“ç‚¹
sort the edges of G.E into nondecreasing order by weight w //å¯¹è¾¹æŒ‰ç…§æƒé‡æ’åº
for each edge(u,v)âˆˆG.E,taken in nondecreasing order by weight//æŒ‰æƒé‡é¡ºåºéå†è¾¹
    if FIND-SET(v)!=FIND-SET(u)//(u,v)ä¸åœ¨ä¸€æ£µæ ‘
        A= A âˆª {(u,v)}
        UNION(u,v)
return A
</code></pre><h2 id="æ—¶é—´å¤æ‚åº¦">3.2. æ—¶é—´å¤æ‚åº¦</h2><p>$O(ElgV)$</p>
<h2 id="ç‰¹ç‚¹">3.3. ç‰¹ç‚¹</h2><p>å›¾çš„å­˜è´®ç»“æ„é‡‡ç”¨è¾¹é›†æ•°ç»„,ä¸”æƒå€¼ç›¸ç­‰çš„è¾¹åœ¨æ•°ç»„ä¸­æ’åˆ—æ¬¡åºå¯ä»¥æ˜¯ä»»æ„çš„.è¯¥æ–¹æ³•å¯¹äºè¾¹ç›¸å¯¹æ¯”è¾ƒå¤šçš„ä¸æ˜¯å¾ˆå®ç”¨,æµªè´¹æ—¶é—´.</p>
<p>c++å®ç°ï¼ˆå†™çš„å¾ˆå¥½ï¼Œä¸€å®šè¦çœ‹ï¼‰:<a href="http://blog.csdn.net/niushuai666/article/details/6689285" target="_blank" rel="external">Kruskalç®—æ³•</a></p>
<h1 id="Primç®—æ³•">4. Primç®—æ³•</h1><p><strong>å¯»æ‰¾å®‰å…¨è¾¹</strong>:Aæ€»æ˜¯ä¸€é¢—æ ‘ã€‚ä»å•ä¸€é¡¶ç‚¹å¼€å§‹ï¼Œé€æ­¥æ‰©å¤§æ ‘ä¸­æ‰€å«é¡¶ç‚¹çš„æ•°ç›®ï¼Œç›´åˆ°éåŠè¿é€šå›¾çš„æ‰€æœ‰é¡¶ç‚¹ã€‚</p>
<p>ä¸ºäº†å¿«é€Ÿé€‰æ‹©æ–°è¾¹ï¼Œ åœ¨ç®—æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰ä¸åœ¨æ ‘Aä¸­çš„ç»“ç‚¹éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªåŸºäºkeyå±æ€§çš„<code>æœ€å°ä¼˜å…ˆé˜Ÿåˆ—Q</code>ä¸­ã€‚</p>
<p><code>u.key</code> : è¿æ¥ç»“ç‚¹uå’Œ<strong>æ ‘</strong>ä¸­ç»“ç‚¹çš„æ‰€æœ‰è¾¹ä¸­æœ€å°è¾¹çš„æƒé‡ã€‚<br><code>u.Ï€</code>ï¼šuåœ¨<strong>æ ‘</strong>ä¸­çš„çˆ¶èŠ‚ç‚¹</p>
<h2 id="æè¿°">4.1. æè¿°</h2><p><strong>è¾“å…¥</strong>:è¿é€šå›¾G,è¾¹æƒw,æœ€å°ç”Ÿæˆæ ‘çš„æ ¹èŠ‚ç‚¹r</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼šVnew = {x}ï¼Œå…¶ä¸­xä¸ºé›†åˆVä¸­çš„ä»»ä¸€èŠ‚ç‚¹ï¼ˆèµ·å§‹ç‚¹ï¼‰ï¼ŒEnew = {}</p>
<p><strong>å¾ªç¯</strong>ï¼šé‡å¤ä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°$V_{new}=V$ï¼š</p>
<ol>
<li>åœ¨é›†åˆEä¸­é€‰å–æƒå€¼æœ€å°çš„è¾¹ï¼ˆu,vï¼‰ï¼Œå…¶ä¸­uæ˜¯é›†åˆVnewä¸­çš„å…ƒç´ ï¼Œè€Œvåˆ™æ˜¯Vä¸­æ²¡æœ‰åŠ å…¥Vnewçš„é¡¶ç‚¹ï¼›</li>
<li>å°†våŠ å…¥Vnewä¸­ï¼Œå°†(u,v)åŠ å…¥Enewä¸­ï¼›</li>
</ol>
<p><strong>è¾“å‡º</strong>ï¼šä½¿ç”¨é›†åˆVnewå’ŒEnewæ¥æè¿°æ‰€å¾—åˆ°çš„æœ€å°ç”Ÿæˆæ ‘ã€‚</p>
<p>å›¾ä¾‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-27-15-47-24.png" alt=""> </p>
<h2 id="ä¼ªä»£ç -1">4.2. ä¼ªä»£ç </h2><pre><code>MST-PRIM(G,w,r)//ræ˜¯æœ€å°ç”Ÿæˆæ ‘çš„æ ¹èŠ‚ç‚¹
for each uâˆˆG.V
    u.key=âˆ 
    u.Ï€=NIL //uåœ¨æ ‘ä¸­çš„çˆ¶èŠ‚ç‚¹
r.key=0
Q=G.V
while Q!={}
    u=EXTRACT-MIN(Q)//æŸæ¡æ¨ªè·¨åˆ‡å‰²(V-Q,Q)çš„ä¸€ä¸ªè½»é‡çº§è¾¹çš„ç«¯ç‚¹
    for each vâˆˆG.Adj[u]//éå†uçš„é‚»æ¥è¡¨
    if vâˆˆQ and w(u,v)&lt;v.key
        v.Ï€=u
        v.key=w(u,v)
</code></pre><h2 id="æ—¶é—´å¤æ‚åº¦-1">4.3. æ—¶é—´å¤æ‚åº¦</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-27-15-51-25.png" alt=""> </p>
<p>é€šè¿‡é‚»æ¥çŸ©é˜µå›¾è¡¨ç¤ºçš„ç®€æ˜“å®ç°ä¸­ï¼Œæ‰¾åˆ°æ‰€æœ‰æœ€å°æƒè¾¹å…±éœ€Oï¼ˆV2ï¼‰çš„è¿è¡Œæ—¶é—´ã€‚ä½¿ç”¨ç®€å•çš„äºŒå‰å †ä¸é‚»æ¥è¡¨æ¥è¡¨ç¤ºçš„è¯ï¼Œæ™®é‡Œå§†ç®—æ³•çš„è¿è¡Œæ—¶é—´åˆ™å¯ç¼©å‡ä¸ºO(E log V)ï¼Œå…¶ä¸­Eä¸ºè¿é€šå›¾çš„è¾¹æ•°ï¼ŒVä¸ºé¡¶ç‚¹æ•°ã€‚å¦‚æœä½¿ç”¨è¾ƒä¸ºå¤æ‚çš„æ–æ³¢é‚£å¥‘å †ï¼Œåˆ™å¯å°†è¿è¡Œæ—¶é—´è¿›ä¸€æ­¥ç¼©çŸ­ä¸ºO(E + V log V)ï¼Œè¿™åœ¨è¿é€šå›¾è¶³å¤Ÿå¯†é›†æ—¶ï¼ˆå½“Eæ»¡è¶³Î©ï¼ˆV log Vï¼‰æ¡ä»¶æ—¶ï¼‰ï¼Œå¯è¾ƒæ˜¾è‘—åœ°æé«˜è¿è¡Œé€Ÿåº¦</p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://zh.wikipedia.org/wiki/%E6%99%AE%E6%9E%97%E5%A7%86%E7%AE%97%E6%B3%95" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ACM-poj1860-CurrencyExchange]]></title>
      <url>/2017/03/23/ACM-poj1860-CurrencyExchange/</url>
      <content type="html"><![CDATA[<h1 id="Description">1. Description</h1><p>Several currency exchange points are working in our city. Let us suppose that each point specializes in two particular currencies and performs exchange operations only with these currencies. There can be several points specializing in the same pair of currencies. Each point has its own exchange rates, exchange rate of A to B is the quantity of B you get for 1A. Also each exchange point has some commission, the sum you have to pay for your exchange operation. Commission is always collected in source currency.<br>For example, if you want to exchange 100 US Dollars into Russian Rubles at the exchange point, where the exchange rate is 29.75, and the commission is 0.39 you will get (100 - 0.39) * 29.75 = 2963.3975RUR.<br>You surely know that there are N different currencies you can deal with in our city. Let us assign unique integer number from 1 to N to each currency. Then each exchange point can be described with 6 numbers: integer A and B - numbers of currencies it exchanges, and real RAB, CAB, RBA and CBA - exchange rates and commissions when exchanging A to B and B to A respectively.<br>Nick has some money in currency S and wonders if he can somehow, after some exchange operations, increase his capital. Of course, he wants to have his money in currency S in the end. Help him to answer this difficult question. Nick must always have non-negative sum of money while making his operations. </p>
<p> currency exchange pointsï¼šè´§å¸å…‘æ¢ç‚¹<br> commissionï¼šä½£é‡‘<br> assign ï¼šåˆ†é…</p>
<p>æ¯ä¸ªè´§å¸å…‘æ¢ç‚¹åªèƒ½äº’æ¢ä¸¤ç§è´§å¸ã€‚å…‘æ¢ç‚¹å¯é‡å¤ã€‚æ¯ä¸ªç‚¹éƒ½æœ‰è‡ªå·±çš„å…‘æ¢ç‡ï¼ŒA to B çš„å…‘æ¢ç‡æ˜¯æŒ‡1ä¸ªAèƒ½å…‘æ¢çš„Bçš„æ•°é‡ã€‚</p>
<p>å…‘æ¢æ—¶æ”¶å–ä¸€å®šçš„ä½£é‡‘ï¼Œä½£é‡‘æ˜¯ä»¥æ¥æºè´§å¸æ¥collectçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å°†100dolarså…‘æ¢æˆRussian Bules,  å…‘æ¢ç‚¹çš„å…‘æ¢ç‡æ˜¯29.75ï¼Œè´¹ç”¨æ˜¯0.39ï¼Œï¼Œé‚£ä¹ˆä½ ä¼šå¾—åˆ°çš„é’±æ˜¯ (100 - 0.39) * 29.75 = 2963.3975RUR. </p>
<p>å‡è®¾æ¯ç§å…‘æ¢çš„ç‚¹æ•°é‡æ˜¯1-Nï¼Œé‚£ä¹ˆæ¯ä¸ªå…‘æ¢ç‚¹å¯ä»¥ç”±6ä¸ªnumæ¥æè¿°ï¼š</p>
<p>interger A and B  å…‘æ¢è´§å¸çš„åºå·<br>RAB A to Bå…‘æ¢ç‡<br>CAB A to B çš„ä½£é‡‘<br>RBA B to A å…‘æ¢ç‡<br>CBA B to A çš„ä½£é‡‘</p>
<p>Nickæœ‰äº›Sè´§å¸ï¼Œä»–å¾ˆå¥½å¥‡ä»–èƒ½å¦é€šè¿‡è´§å¸å…‘æ¢çš„æ–¹å¼å¯¹ä»–çš„èµ„é‡‘è¿›è¡Œå¢å€¼ã€‚æœ€ç»ˆä»–å¸Œæœ›ä»–æ‹¿åˆ°è¿˜æ˜¯Sè´§å¸ã€‚å¸®ä»–è§£å†³è¿™ä¸ªé—®é¢˜ã€‚Nickåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸èƒ½å€Ÿé’±ã€‚</p>
<h1 id="Input">2. Input</h1><p>The first line of the input contains four numbers: N - the number of currencies, M - the number of exchange points, S - the number of currency Nick has and V - the quantity of currency units he has. </p>
<p>The following M lines contain 6 numbers each - the description of the corresponding exchange point - in specified above order. Numbers are separated by one or more spaces. </p>
<p>1&lt;=S&lt;=N&lt;=100, 1&lt;=M&lt;=100, V is real number, 0&lt;=V&lt;=103. </p>
<p>For each point exchange rates and commissions are real, given with at most two digits after the decimal point, 10-2&lt;=rate&lt;=102, 0&lt;=commission&lt;=102. </p>
<p>Let us call some sequence of the exchange operations simple if no exchange point is used more than once in this sequence. You may assume that ratio of the numeric values of the sums at the end and at the beginning of any simple sequence of the exchange operations will be less than 104. </p>
<p>correspondingï¼šç›¸åº”çš„</p>
<p>ç¬¬ä¸€è¡ŒåŒ…å«å››ä¸ªæ•°å­—ï¼š<br>N è´§å¸çš„ç§ç±»<br>M å…‘æ¢ç‚¹çš„æ•°é‡<br>S Nickçš„è´§å¸çš„åºå·<br>V Nickæ‹¥æœ‰çš„é’±</p>
<p>æ¥ä¸‹æ¥çš„Mè¡Œï¼Œæ¯è¡ŒåŒ…å«å…­ä¸ªæ•°å­—ï¼Œæè¿°ç›¸åº”çš„å…‘æ¢ç‚¹çš„å±æ€§ã€‚<br>æ•°å­—ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼éš”å¼€</p>
<p>1&lt;=S&lt;=N&lt;=100, 1&lt;=M&lt;=100, V is real number, 0&lt;=V&lt;=103. </p>
<p>æ¯ä¸ªå…‘æ¢ç‚¹çš„å…‘æ¢ç‡å’Œæ‰‹ç»­è´¹éƒ½æ˜¯å®æ•°ï¼Œè‡³å¤šç²¾ç¡®åˆ°ä¸¤ä½å°æ•°ã€‚</p>
<p> 10-2&lt;=rate&lt;=102, 0&lt;=commission&lt;=102</p>
<p>å¦‚æœåœ¨æ“ä½œåºåˆ—ä¸­ä¸é€‚ç”¨å¤šä¸ªå…‘æ¢ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å‘èµ·ä¸€äº›ç®€å•çš„å…‘æ¢æ“ä½œã€‚ä½ å¯ä»¥å‡è®¾ï¼šï¼ˆæœ€åçš„æ€»å’Œ/ï¼‰</p>
<h1 id="è¾“å‡ºæ•°æ®">3. è¾“å‡ºæ•°æ®</h1><p>å¦‚æœnickèƒ½å¤Ÿå®ç°ä»–çš„æ„¿æœ›ï¼Œåˆ™è¾“å‡ºYESï¼Œå¦åˆ™è¾“å‡ºNOã€‚</p>
<h1 id="æ ·ä¾‹è¾“å…¥">4. æ ·ä¾‹è¾“å…¥</h1><p>3 2 1 20.0<br>1 2 1.00 1.00 1.00 1.00<br>2 3 1.10 1.00 1.10 1.00</p>
<h1 id="æ€è·¯">5. æ€è·¯</h1><p>å°†è´§å¸çœ‹åšç‚¹ï¼Œæ¯ç§å…‘æ¢è§„åˆ™ä¸ºè¾¹ï¼Œä¸¤ç‚¹çš„è·¯å¾„é•¿åº¦ä¸ºå…‘æ¢åçš„é’±æ•°ã€‚å»ºå›¾ä¹‹åå¯ä»¥çœ‹å‡ºé¢˜æ„ä¸ºæ±‚å›¾ä¸­æ˜¯å¦å­˜åœ¨æ­£ç¯ï¼Œç”¨Bellman-Fordæ±‚æœ€é•¿è·¯å¾„ï¼Œå¦‚æœå­˜åœ¨æ­£ç¯è¾“å‡ºYESï¼Œä¸å­˜åœ¨è¾“å‡ºNOã€‚</p>
]]></content>
      
        <categories>
            
            <category> ACM </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç®—æ³•-å•æºæœ€çŸ­è·¯å¾„é—®é¢˜]]></title>
      <url>/2017/03/23/%E7%AE%97%E6%B3%95-%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>å•æºæœ€çŸ­è·¯å¾„é—®é¢˜ï¼šç»™å®šä¸€ä¸ªå›¾ $G=(V,E)$ ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä»ç»™å®šæºèŠ‚ç‚¹$s\in V$åˆ°æ¯ä¸ªèŠ‚ç‚¹$v \in V$çš„æœ€çŸ­è·¯å¾„ã€‚</p>
<p>å…ˆæ€»ç»“ï¼š</p>
<p>Bellman-Fordç®—æ³•ï¼šé‡‡ç”¨åŠ¨æ€è§„åˆ’è¿›è¡Œè®¾è®¡ã€‚<strong>å¾…æ€»ç»“</strong>ã€‚ç®€å•ï¼Œè¿˜èƒ½ä¾¦æ¢å«æºèŠ‚ç‚¹çš„è´Ÿæƒé‡å›è·¯ã€‚<br>Dijkstraç®—æ³•ï¼šé‡‡ç”¨è´ªå¿ƒç®—æ³•èŒƒå¼è¿›è¡Œè®¾è®¡ã€‚å¤æ‚åº¦ä½ï¼Œä½†è¦æ±‚æƒé‡éè´Ÿã€‚</p>
<h1 id="æœ€çŸ­è·¯å¾„æ ‘">1. æœ€çŸ­è·¯å¾„æ ‘</h1><p>ä¸€é¢—æ ¹èŠ‚ç‚¹ä¸ºsçš„æœ€çŸ­è·¯å¾„æ ‘æ˜¯ä¸€ä¸ªæœ‰å‘å­å›¾$Gâ€™=(Vâ€™,Eâ€™)$ï¼Œè¿™é‡Œ$Vâ€™\in V$,$Eâ€™\in E$,æ»¡è¶³ï¼š</p>
<ol>
<li>$Vâ€™$æ˜¯å›¾Gä¸­ä»æºèŠ‚ç‚¹så¯ä»¥åˆ°è¾¾çš„æ‰€æœ‰ç»“ç‚¹çš„é›†åˆï¼›</li>
<li>$Gâ€™$å½¢æˆä¸€é¢—æ ¹èŠ‚ç‚¹ä¸ºsçš„æ ‘ï¼›</li>
<li>å¯¹äºæ‰€æœ‰ç»“ç‚¹$v\in Vâ€™$,å›¾$Gâ€™$ä¸­ä»ç»“ç‚¹såˆ°ç»“ç‚¹vçš„å”¯ä¸€ç®€å•è·¯å¾„æ˜¯å›¾Gä¸­ä»ç»“ç‚¹såˆ°ç»“ç‚¹vçš„ä¸€æ¡æœ€çŸ­è·¯å¾„ã€‚</li>
</ol>
<h1 id="æ¾å¼›æ“ä½œ">2. æ¾å¼›æ“ä½œ</h1><p>å¯¹æ¯ä¸ªèŠ‚ç‚¹vï¼Œæˆ‘ä»¬ç»´æŒä¸€ä¸ªå±æ€§v.dï¼Œè®°å½•sâ†’vçš„æœ€çŸ­è·¯å¾„ä¼°è®¡</p>
<p>æ¾å¼›æ“ä½œï¼šæ¯”è¾ƒsâ†’uâ†’vä¸sâ†’vçš„d,ç„¶åè¿›è¡Œæ›´æ–°ã€‚</p>
<pre><code>RELEAX(u,v,w)
    if v.d&gt;u.d+w(u,v)
        v.d=u.d+w(u,v)
        v.Ï€=u
</code></pre><h1 id="Bellman-Fordç®—æ³•">3. Bellman-Fordç®—æ³•</h1><p><strong>ç›®æ ‡</strong>ï¼šè§£å†³å•æºæœ€çŸ­è·¯å¾„é—®é¢˜<br><strong>æ¡ä»¶</strong>ï¼šè¾¹æƒé‡å¯è´Ÿ<br><strong>è¾“å…¥</strong>ï¼šå¸¦æƒæœ‰å‘å›¾$G=(V,E)$å’Œæƒé‡å‡½æ•°$w:Eâ†’R$<br><strong>è¾“å‡º</strong>ï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªä»æºèŠ‚ç‚¹å¯ä»¥åˆ°è¾¾çš„è´Ÿæƒé‡å›è·¯ã€‚è‹¥å­˜åœ¨ï¼Œåˆ™ç®—æ³•æ— è§£ã€‚</p>
<p><strong>æ€è·¯</strong>ï¼šBellman-Fordé€šè¿‡å¯¹è¾¹è¿›è¡Œæ¾å¼›æ“ä½œæ¥æ¸è¿›åœ°é™ä½ä»æºèŠ‚ç‚¹såˆ°æ¯ä¸ªèŠ‚ç‚¹vçš„æœ€çŸ­è·¯å¾„ä¼°è®¡å€¼v.dï¼Œç›´åˆ°è¯¥ä¼°è®¡å€¼ä¸å®é™…çš„æœ€çŸ­è·¯å¾„æƒé‡$Î´(s,v)$ç›¸åŒä¸ºæ­¢ã€‚</p>
<p>åˆå§‹å‡½æ•°ï¼š</p>
<pre><code>INITIALIZE-SINGLE-SOURCE(G,s)
    for eahc vertex vâˆˆG.V
        v.d=âˆ
        v.Ï€=null
    s.d=0
</code></pre><p><strong>ç®—æ³•</strong>ï¼š</p>
<pre><code>BELLMAN-FORD(G,w,s)
    INITIALIZE-SINGLE-SOURCE(G,s)//å¯¹æ¯ä¸ªç‚¹v.då’Œv.Ï€åˆå§‹åŒ–
    for i=1 to |G.V|-1 //å¯¹æ¯ä¸ªè¾¹å¤„ç†V-1æ¬¡
        for each edge(u,v)âˆˆG.E //éå†æ‰€æœ‰çš„è¾¹
            RELAX(u,v,w)
    for each edge(u,v)âˆˆG.E
        if v.d&gt;u.d+w(u,v)
            return False
        else
            return True
</code></pre><p><strong>å¤æ‚åº¦</strong>ï¼š$O(VE)$</p>
<p><strong>å¯¹æ¯ä¸ªè¾¹å¤„ç†V-1çš„åŸå› </strong>ï¼šè®¾pæ˜¯ä»såˆ°vçš„æœ€çŸ­è·¯å¾„ï¼Œåˆ™pæœ€å¤šåŒ…å«V-1æ¡è¾¹ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æé™æ¡ä»¶ï¼Œv0-v5è·¯å¾„åº”è¯¥ä¸º<code>&lt;v0,v1,v2,v3,v4,v5&gt;</code></p>
<p>åŸæœ¬v0-v5çš„è·¯å¾„æ˜¯ç°è‰²çš„ã€‚<br>ç¬¬ä¸€è½®æ¾å¼›åï¼Œv0-v5è·¯å¾„å˜ä¸º<code>&lt;v0,v1,v5&gt;</code>ï¼Œå³é»‘è‰²çš„<br>åŒç†ï¼Œç¬¬äºŒè½®æ¾å¼›åï¼Œv0-v5è·¯å¾„å˜ä¸º<code>&lt;v0,v1,v2,v5&gt;</code><br>å› æ­¤è¦æ¾å¼›V-1æ¬¡æ‰å¯ä»¥<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-23-17-07-49.png" alt=""> </p>
<h1 id="Dijkstraç®—æ³•">4. Dijkstraç®—æ³•</h1><p><strong>æ¡ä»¶</strong>ï¼šæ‰€æœ‰è¾¹çš„æƒé‡éè´Ÿ<br><strong>æ€æƒ³</strong>ï¼šç”±ä¸Šè¿°æ€§è´¨å¯çŸ¥ï¼Œå¦‚æœå­˜åœ¨ä¸€æ¡ä»iåˆ°jçš„æœ€çŸ­è·¯å¾„(Viâ€¦..Vk,Vj)ï¼ŒVkæ˜¯Vjå‰é¢çš„ä¸€é¡¶ç‚¹ã€‚é‚£ä¹ˆ(Viâ€¦Vk)ä¹Ÿå¿…å®šæ˜¯ä»iåˆ°kçš„æœ€çŸ­è·¯å¾„ã€‚ä¸ºäº†æ±‚å‡ºæœ€çŸ­è·¯å¾„ï¼ŒDijkstraå°±æå‡ºäº†ä»¥æœ€çŸ­è·¯å¾„é•¿åº¦é€’å¢ï¼Œé€æ¬¡ç”Ÿæˆæœ€çŸ­è·¯å¾„çš„ç®—æ³•ã€‚å³ï¼šæ¯æ¬¡æ‰¾åˆ°ç¦»æºç‚¹æœ€è¿‘çš„ä¸€ä¸ªé¡¶ç‚¹ï¼Œç„¶åä»¥è¯¥é¡¶ç‚¹ä¸ºä¸­å¿ƒè¿›è¡Œæ‰©å±•ï¼Œæœ€ç»ˆå¾—åˆ°æºç‚¹åˆ°å…¶ä½™æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</p>
<p><strong>Dijkstraç®—æ³•çš„å…³é”®</strong>ï¼šç»´æŒä¸€ç»„èŠ‚ç‚¹é›†åˆSï¼Œä»såˆ°è¯¥é›†åˆä¸­çš„æ¯ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„å·²ç»è¢«æ‰¾åˆ°ã€‚ç®—æ³•é‡å¤ä»V-Sä¸­é€‰æ‹©æœ€çŸ­è·¯å¾„ä¼°è®¡æœ€å°çš„èŠ‚ç‚¹uï¼Œå°†uåŠ å…¥ç»“åˆSï¼Œç„¶åå¯¹æ‰€æœ‰ä»uå‡ºå‘çš„è¾¹è¿›è¡Œæ¾å¼›ã€‚</p>
<pre><code>DIJKSTRA(G,w,s)
    INITIALIZE-SINGLE-SOURCE(G,s)//å¯¹v.då’Œv.Ï€åˆå§‹åŒ–
    S={}
    Q=G.V
    while Q.length != 0
        u = UXTRACT-MIN(Q)//ä»V-Sä¸­é€‰å‡ºæœ€çŸ­è·¯å¾„ä¼°è®¡æœ€å°çš„èŠ‚ç‚¹u
        S=Sâˆª{u}
        for each vertex vâˆˆG.Adj[u]
            RELAX(u,v,w)
</code></pre><p><strong>ç®—æ³•è§£é‡Š</strong><br>äºŒç»´æ•°ç»„ e æ¥å­˜å‚¨é¡¶ç‚¹ä¹‹é—´è¾¹çš„å…³ç³»ï¼Œåˆå§‹å€¼å¦‚ä¸‹ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-23-22-23-08.png" alt=""> </p>
<p>æˆ‘ä»¬è¿˜éœ€è¦ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„ dis æ¥å­˜å‚¨ 1 å·é¡¶ç‚¹åˆ°å…¶ä½™å„ä¸ªé¡¶ç‚¹çš„åˆå§‹è·¯ç¨‹ï¼Œå¦‚ä¸‹ã€‚<br>æˆ‘ä»¬å°†æ­¤æ—¶ dis æ•°ç»„ä¸­çš„å€¼ç§°ä¸ºæœ€çŸ­è·¯çš„â€œä¼°è®¡å€¼â€<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-23-22-23-38.png" alt=""> </p>
<p>å›¾çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼Œ1æ˜¯æºç‚¹<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-23-22-22-41.png" alt=""> </p>
<p>æ—¢ç„¶æ˜¯æ±‚ 1 å·é¡¶ç‚¹åˆ°å…¶ä½™å„ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯ç¨‹ï¼Œé‚£å°±å…ˆæ‰¾ä¸€ä¸ªç¦» 1 å·é¡¶ç‚¹æœ€è¿‘çš„é¡¶ç‚¹ã€‚é€šè¿‡æ•°ç»„ dis å¯çŸ¥å½“å‰ç¦» 1 å·é¡¶ç‚¹æœ€è¿‘æ˜¯ 2 å·é¡¶ç‚¹ã€‚å½“é€‰æ‹©äº† 2 å·é¡¶ç‚¹åï¼Œdis[2]çš„å€¼å°±å·²ç»ä»â€œä¼°è®¡å€¼â€å˜ä¸ºäº†â€œç¡®å®šå€¼â€ï¼Œå³ 1 å·é¡¶ç‚¹åˆ° 2 å·é¡¶ç‚¹çš„æœ€çŸ­è·¯ç¨‹å°±æ˜¯å½“å‰ dis[2]å€¼ã€‚<br>åŸå› ï¼šç›®å‰ç¦» 1 å·é¡¶ç‚¹æœ€è¿‘çš„æ˜¯ 2 å·é¡¶ç‚¹ï¼Œå¹¶ä¸”è¿™ä¸ªå›¾æ‰€æœ‰çš„è¾¹éƒ½æ˜¯æ­£æ•°ï¼Œé‚£ä¹ˆè‚¯å®šä¸å¯èƒ½é€šè¿‡ç¬¬ä¸‰ä¸ªé¡¶ç‚¹ä¸­è½¬ï¼Œä½¿å¾— 1 å·é¡¶ç‚¹åˆ° 2 å·é¡¶ç‚¹çš„è·¯ç¨‹è¿›ä¸€æ­¥ç¼©çŸ­äº†ã€‚å› ä¸º 1 å·é¡¶ç‚¹åˆ°å…¶å®ƒé¡¶ç‚¹çš„è·¯ç¨‹è‚¯å®šæ²¡æœ‰ 1 å·åˆ° 2 å·é¡¶ç‚¹çŸ­ï¼Œ</p>
<p>æ—¢ç„¶é€‰äº† 2 å·é¡¶ç‚¹ï¼Œæ¥ä¸‹æ¥å†æ¥çœ‹ 2 å·é¡¶ç‚¹æœ‰å“ªäº›å‡ºè¾¹å‘¢ã€‚æœ‰ 2-&gt;3 å’Œ 2-&gt;4 è¿™ä¸¤æ¡è¾¹ã€‚å…ˆè®¨è®ºé€šè¿‡ 2-&gt;3 è¿™æ¡è¾¹èƒ½å¦è®© 1 å·é¡¶ç‚¹åˆ° 3 å·é¡¶ç‚¹çš„è·¯ç¨‹å˜çŸ­ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨æ¥æ¯”è¾ƒ dis[3]å’Œ dis[2]+e[2][3]çš„å¤§å°ã€‚å…¶ä¸­ dis[3]è¡¨ç¤º 1 å·é¡¶ç‚¹åˆ° 3 å·é¡¶ç‚¹çš„è·¯ç¨‹ã€‚dis[2]+e[2][3]ä¸­ dis[2]è¡¨ç¤º 1 å·é¡¶ç‚¹åˆ° 2 å·é¡¶ç‚¹çš„è·¯ç¨‹ï¼Œe[2][3]è¡¨ç¤º 2-&gt;3 è¿™æ¡è¾¹ã€‚æ‰€ä»¥ dis[2]+e[2][3]å°±è¡¨ç¤ºä» 1 å·é¡¶ç‚¹å…ˆåˆ° 2 å·é¡¶ç‚¹ï¼Œå†é€šè¿‡ 2-&gt;3 è¿™æ¡è¾¹ï¼Œåˆ°è¾¾ 3 å·é¡¶ç‚¹çš„è·¯ç¨‹ã€‚</p>
<p>æˆ‘ä»¬å‘ç° dis[3]=12ï¼Œdis[2]+e[2][3]=1+9=10ï¼Œdis[3]&gt;dis[2]+e[2][3]ï¼Œå› æ­¤ dis[3]è¦æ›´æ–°ä¸º 10ã€‚è¿™ä¸ªè¿‡ç¨‹æœ‰ä¸ªä¸“ä¸šæœ¯è¯­å«åšâ€œæ¾å¼›â€ã€‚å³ 1 å·é¡¶ç‚¹åˆ° 3 å·é¡¶ç‚¹çš„è·¯ç¨‹å³ dis[3]ï¼Œé€šè¿‡ 2-&gt;3 è¿™æ¡è¾¹æ¾å¼›æˆåŠŸã€‚è¿™ä¾¿æ˜¯ Dijkstra ç®—æ³•çš„ä¸»è¦æ€æƒ³ï¼šé€šè¿‡â€œè¾¹â€æ¥æ¾å¼› 1 å·é¡¶ç‚¹åˆ°å…¶ä½™å„ä¸ªé¡¶ç‚¹çš„è·¯ç¨‹ã€‚</p>
<p>åŒç†é€šè¿‡ 2-&gt;4ï¼ˆe[2][4]ï¼‰ï¼Œå¯ä»¥å°† dis[4]çš„å€¼ä» âˆ æ¾å¼›ä¸º 4ï¼ˆdis[4]åˆå§‹ä¸º âˆï¼Œdis[2]+e[2][4]=1+3=4ï¼Œdis[4]&gt;dis[2]+e[2][4]ï¼Œå› æ­¤ dis[4]è¦æ›´æ–°ä¸º 4ï¼‰ã€‚</p>
<p>åˆšæ‰æˆ‘ä»¬å¯¹ 2 å·é¡¶ç‚¹æ‰€æœ‰çš„å‡ºè¾¹è¿›è¡Œäº†æ¾å¼›ã€‚æ¾å¼›å®Œæ¯•ä¹‹å dis æ•°ç»„ä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-23-22-31-33.png" alt=""> </p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæ­¤å¤„ä¸å†å¤šåŠ é˜è¿°ã€‚</p>
<p>å‚è€ƒæ–‡çŒ®<a href="http://wiki.jikexueyuan.com/project/easy-learn-algorithm/dijkstra.html" target="_blank" rel="external">ç®—æ³• 7ï¼šDijkstra æœ€çŸ­è·¯ç®—æ³•</a></p>
<h1 id="æœ‰å‘æ— ç¯å›¾çš„å•æºæœ€çŸ­è·¯å¾„é—®é¢˜">5. æœ‰å‘æ— ç¯å›¾çš„å•æºæœ€çŸ­è·¯å¾„é—®é¢˜</h1><p>æ¥æ—¥å†å¡«å‘ã€‚</p>
]]></content>
      
        <categories>
            
            <category> ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ACM--Radar Installation]]></title>
      <url>/2017/03/22/ACM-Radar-Installation/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®æè¿°">1. é¢˜ç›®æè¿°</h1><p>Assume the coasting is an infinite straight line. Land is in one side of coasting, sea in the other. Each small island is a point locating in the sea side. And any radar installation, locating on the coasting, can only cover d distance, so an island in the sea can be covered by a radius installation, if the distance between them is at most d. </p>
<p>We use Cartesian coordinate system, defining the coasting is the x-axis. The sea side is above x-axis, and the land side below. Given the position of each island in the sea, and given the distance of the coverage of the radar installation, your task is to write a program to find the minimal number of radar installations to cover all the islands. Note that the position of an island is represented by its x-y coordinates. </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-22-19-32-14.png" alt=""> </p>
<p>coastingï¼šæ»‘è¡Œ<br>infiniteï¼šæ— ç©·çš„<br>Cartesian coordinate systemï¼šç¬›å¡å°”åæ ‡ç³»</p>
<p>å·²çŸ¥ï¼šæµ·å²¸çº¿æ˜¯xè½´ï¼Œä»¥ä¸Šæ˜¯æµ·ï¼Œä»¥ä¸‹æ˜¯é™†åœ°ã€‚é›·è¾¾å®‰è£…åœ¨æµ·å²¸çº¿ä¸Šï¼Œè¦†ç›–åŠå¾„æ˜¯dã€‚<br>ç›®æ ‡ï¼šæ±‚èƒ½å¤Ÿè¦†ç›–æ‰€æœ‰å²›å±¿çš„é›·è¾¾å®‰è£…æ•°ç›®ã€‚<br>éœ€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæµ·å²›åæ ‡åœ¨x-yåæ ‡ç³»ä¸­ã€‚</p>
<h1 id="Input">2. Input</h1><p>The input consists of several test cases. The first line of each case contains two integers n (1&lt;=n&lt;=1000) and d, where n is the number of islands in the sea and d is the distance of coverage of the radar installation. This is followed by n lines each containing two integers representing the coordinate of the position of each island. Then a blank line follows to separate the cases. </p>
<p>The input is terminated by a line containing pair of zeros </p>
<p>è¾“å…¥ä¸€èˆ¬åŒ…å«å¥½å‡ ç»„caseæµ‹è¯•æ•°æ®ã€‚</p>
<p>æ¯ä¸ªcaseçš„ç¬¬ä¸€è¡Œæ˜¯(n,d)<br>ç„¶åæ˜¯nè¡Œå²›å±¿åæ ‡</p>
<p>æœ€åä»¥ï¼ˆ0,0ï¼‰ç»“å°¾</p>
<h1 id="Output">3. Output</h1><p>For each test case output one line consisting of the test case number followed by the minimal number of radar installations needed. â€œ-1â€ installation means no solution for that case.</p>
<h1 id="æ€è·¯">4. æ€è·¯</h1><p>è¿™é“é¢˜é—®çš„æ˜¯æ€æ ·æ”¾é›·è¾¾ä½¿å…¶æ”¾çš„é›·è¾¾æ•°ç›®æœ€å°‘è€Œèƒ½å¤Ÿæ¢æµ‹åˆ°æ‰€æœ‰çš„å²›å±¿ï¼Œè¿™é‡Œéœ€è¦è½¬æ¢ä¸ºæ±‚æ¯ä¸ªå²›å±¿çš„èƒ½æ”¾é›·è¾¾çš„åŒºé—´çš„é—®é¢˜:</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-22-21-06-38.png" alt=""> </p>
<p>æŠ½è±¡é—®é¢˜:æ¯ä¸ªå°å²›éƒ½å¯¹åº”ä¸€ä¸ªåŒºåŸŸ,è¿™ä¸ªåŒºåŸŸå†…çš„é›·è¾¾éƒ½èƒ½æ¢æµ‹åˆ°è¿™ä¸ªå°å²›,æŠŠè¿™Nä¸ªåŒºåŸŸæ±‚å‡ºæ¥,é—®é¢˜ç°åœ¨å°±å˜æˆäº†,æœ€å°‘æ”¾ç½®å‡ ä¸ªç‚¹,èƒ½ä½¿å¾—æ¯ä¸ªåŒºåŸŸå†…éƒ½è‡³å°‘æœ‰ä¸€ä¸ªç‚¹.</p>
<p>è¿™é“é¢˜ç›®çš„å…³é”®ä¹‹å¤„å°±æ˜¯æŠŠé¢çš„é—®é¢˜è½¬æ¢æˆçº¿çš„é—®é¢˜ï¼Œæ¯ä¸€ä¸ªåº§æµ·å²›åœ¨xè½´ä¸Šæœ‰ä¸€ä¸ªåŒºé—´ï¼Œåœ¨è¿™ä¸ªåŒºé—´é‡Œé¢çš„é›·è¾¾éƒ½å¯ä»¥ä¾¦æµ‹åˆ°æµ·å²›ï¼ŒåŒºé—´çš„èŒƒå›´å³æ˜¯[x-sqrt(dd â€“ yy), x+sqrt(dd+yy)]ï¼Œç„¶åå…ˆä»¥å³ç«¯ç‚¹ä¸ºåŸºè¿›è¡Œä»å°åˆ°å¤§æ’åºï¼Œç„¶åæŠŠç¬¬ä¸€ä¸ªé›·è¾¾é»˜è®¤æ”¾åœ¨æœ€å·¦ç«¯çš„xmaxï¼Œæ¥ä¸‹æ¥çš„ç‚¹åªè¦æ˜¯xminå°äºå½“å‰xmaxå°±å¯ä»¥ä¸ç”¨å¢åŠ é›·è¾¾ï¼Œå¦‚æœxmax == xminçš„è¯ä¹Ÿä¸ç”¨å¢åŠ é›·è¾¾ã€‚ç„¶åå¦‚æœxmax &lt; xminçš„è¯å°±åŠ ä¸€ä¸ªé›·è¾¾ï¼Œç„¶åä»¥xminæ‰€å±åŒºé—´çš„xmaxä¸ºåŸºè¿›è¡Œæ¯”è¾ƒã€‚</p>
<h1 id="ä»£ç ">5. ä»£ç </h1><pre><code>import java.io.PrintWriter;

import java.util.Arrays;
import java.util.Scanner;
public class Main {
    static class Range implements Comparable&lt;Range&gt;{
        double left,right;
        public Range(double left,double right){
            this.left = left;

            this.right = right;
        }
        @Override

        public int compareTo(Range range) {
            if(range.left == left){
                return ((Double)right).compareTo((Double)(range.right));
            }else{
                return ((Double)left).compareTo((Double)(range.left));
            }
        }

        @Override
        public String toString() {
            return &quot;(&quot; + left + &quot;,&quot; + right + &quot;)&quot;;
        }

    }


    public static void main(String[] args) {
        Scanner scn = new Scanner(System.in);

        PrintWriter out = new PrintWriter(System.out);
        int n ,d,x,y,num;
        double dx;
        Range[] ranges;
        int index = 0;
        while(true){
            num = 0;
            n = scn.nextInt();
            d = scn.nextInt();
            if(n == 0){
                break;
            }
            ranges = new Range[n];
            for(int i = 0; i &lt; n; i++){
                x = scn.nextInt();
                y = scn.nextInt();
                if(y &gt; d){
                    num = -1;
                }
                dx = Math.sqrt(d*d - y*y);
                ranges[i] = new Range(x - dx, x + dx);
            }
            Arrays.sort(ranges);//ï¿½ï¿½ï¿½
            if(num != -1){
                num = calute(ranges);
            }
            out.format(&quot;Case %d: %d\n&quot;,++index,num);
        }
        out.flush();

    }

    private static int calute(Range[] ranges) {
        int num = 1;
        int n = ranges.length;
        Range preRange = ranges[0],range;
        for(int i = 1; i &lt; n; i++){
            range = ranges[i];
            if(range.left &gt;= preRange.left &amp;&amp; range.left &lt;= preRange.right){
                preRange.left = range.left;
                if(range.right &lt; preRange.right){
                    preRange.right = range.right;
                }
            }else{
                num++;
                preRange = range;
            }
        }
        return num;
    }
}
</code></pre>]]></content>
      
        <categories>
            
            <category> ACM </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[numpyç¬”è®°]]></title>
      <url>/2017/03/21/Python-numpy%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="numpyç»“æ„æ•°ç»„">1. numpyç»“æ„æ•°ç»„</h1><p>åœ¨cè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…³é”®å­—structå®šä¹‰ç»“æ„ç±»å‹ã€‚å’Œcè¯­è¨€ä¸€æ ·ï¼Œnumpyä¹Ÿå¯ä»¥åˆ›å»ºç»“æ„å®šä¹‰ï¼Œè¿™æ ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¯»å–äºŒè¿›åˆ¶çš„Cè¯­è¨€ç»“æ„æ•°ç»„ï¼Œå°†å…¶è½¬æ¢ä¸ºnumpyæ•°ç»„å¯¹è±¡ï¼Œå‡è®¾æˆ‘ä»¬å®šä¹‰çš„ç»“æ„æ•°ç»„å¦‚ä¸‹(Cè¯­è¨€æè¿°)ï¼š</p>
<pre><code>struct Person{
     char name[30];
     int    age;
     float weight; 
};
</code></pre><p>æˆ‘ä»¬åœ¨pythonä¸­å¯ä»¥è‡ªå®šä¹‰ç±»å‹å¦‚ä¸‹ï¼š</p>
<pre><code>persontype = np.dtype({
&apos;names&apos;:[&apos;name&apos;,&apos;age&apos;,&apos;weight&apos;],
&apos;formats&apos;:[&apos;S30&apos;,&apos;i&apos;,&apos;f&apos;]},align = True)
</code></pre><p>å‚è€ƒæ–‡çŒ®<a href="http://www.cnblogs.com/td15980891505/p/6083083.html" target="_blank" rel="external">numpyä¸­ç»“æ„æ•°ç»„</a></p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> numpy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javaå­¦ä¹ ç¬”è®°2-ç»§æ‰¿]]></title>
      <url>/2017/03/16/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2-%E7%BB%A7%E6%89%BF/</url>
      <content type="html"><![CDATA[<h1 id="superå…³é”®å­—">1. superå…³é”®å­—</h1><h2 id="å­ç±»override-è¦†ç›–-çˆ¶ç±»çš„å‡½æ•°">1.1. å­ç±»override(è¦†ç›–)çˆ¶ç±»çš„å‡½æ•°</h2><p>overrideæ—¶ï¼Œä½¿ç”¨<code>super</code>è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¶…ç±»ï¼Œå‘˜å·¥</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> salary;<span class="comment">//è–ªæ°´</span></div><div class="line">    <span class="keyword">private</span> Date hireDay;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> salary;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//ç»ç†</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manage</span> <span class="keyword">extends</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> bonus;<span class="comment">//å¥–é‡‘</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span></span>&#123;<span class="comment">//å¯¹åŸæ¥çš„getSalaryè¿›è¡Œoverride</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.bonus + <span class="keyword">super</span>.getSalary();<span class="comment">//superè°ƒç”¨çˆ¶ç±»çš„getSalary()æ–¹æ³•</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="superåœ¨æ„é€ å™¨ä¸­çš„åº”ç”¨">1.2. superåœ¨æ„é€ å™¨ä¸­çš„åº”ç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String n, <span class="keyword">double</span> s, <span class="keyword">int</span> year, <span class="keyword">int</span> mouth, <span class="keyword">int</span> day)</span></span>&#123;</div><div class="line">    <span class="keyword">super</span>(n,s,year,mouth,day);<span class="comment">//è°ƒç”¨è¶…ç±»Employeeä¸­å¯¹åº”å‚æ•°çš„æ„é€ å™¨</span></div><div class="line">    bonus = <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="å¤šæ€">2. å¤šæ€</h1><p>ä¸€ä¸ªå¯¹è±¡å˜é‡å¯ä»¥æŒ‡ç¤ºå¤šç§å®é™…ç±»å‹çš„ç°è±¡â€”â€”â€”â€”å¤šæ€ï¼ˆpolymorphismï¼‰<br>åœ¨è¿è¡Œæ—¶è‡ªåŠ¨é€‰æ‹©è°ƒç”¨é‚£ä¸ªæ–¹æ³•çš„ç°è±¡â€”â€”â€”â€”åŠ¨æ€ç»‘å®šï¼ˆdynamic bindingï¼‰</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code>Employee e = new Employee();
e = new Manage(); // is ok
</code></pre><p>æ­¤æ—¶ï¼Œå¯¹è±¡å˜é‡<code>e</code>ä¹Ÿå¯ä»¥å¼•ç”¨<code>Manager</code>çš„å¯¹è±¡ã€‚</p>
<pre><code>Manage boss = new Manage(...);
Employee[] staff = new Employee();
</code></pre><h1 id="è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹">3. è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹</h1><ol>
<li>ç¼–è¯‘å™¨æŸ¥çœ‹å¯¹è±¡çš„å£°æ˜ç±»å‹å’Œæ–¹æ³•åã€‚å‡è®¾è°ƒç”¨<code>x.f(param)</code>ï¼Œä¸”éšå¼å‚æ•°xå£°æ˜ä¸ºCç±»çš„å¯¹è±¡ã€‚ç¼–è¯‘å™¨ä¸€ä¸€åˆ—ä¸¾æ‰€æœ‰Cç±»ä¸­åä¸ºfçš„æ–¹æ³•å’Œå…¶è¶…ç±»ä¸­è®¿é—®å±æ€§ä¸ºpublicä¸”åä¸ºfçš„æ–¹æ³•ã€‚</li>
<li>ç¼–è¯‘å™¨æŸ¥çœ‹è°ƒç”¨æ–¹æ³•æ—¶æä¾›çš„å‚æ•°ç±»å‹ã€‚è¿™ä¸ªè¿‡ç¨‹å«åš<strong>é‡è½½è§£æ</strong>ï¼ˆoverloading resolutionï¼‰</li>
<li>å¦‚æœæ˜¯privateæ–¹æ³•ã€staticæ–¹æ³•ã€finalæ–¹æ³•æˆ–è€…æ„é€ å™¨ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šå‡†ç¡®åœ°çŸ¥é“åº”è¯¥è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼ˆç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå°±å®Œæˆç»‘å®šï¼‰ï¼Œè¿™ç§è°ƒç”¨æ–¹å¼å«<strong>é™æ€ç»‘å®š</strong>(static binding)ã€‚ä¸æ­¤å¯¹åº”çš„æ˜¯ï¼Œè°ƒç”¨çš„æ–¹æ³•ä¾èµ–äºéšå¼å‚æ•°çš„å®é™…ç±»å‹ï¼ˆç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µä¸çŸ¥é“è¦è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼‰ï¼Œå¹¶åœ¨è¿è¡Œæ—¶å®ç°<strong>åŠ¨æ€ç»‘å®š</strong>ã€‚æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­è§£é‡Šè¿™ä¸¤ä¸ªæ¦‚å¿µâ€”â€”<a href="http://blog.csdn.net/lingzhm/article/details/44116091" target="_blank" rel="external">lingzhm-åŠ¨æ€ç»‘å®š</a></li>
<li>ç¨‹åºè¿è¡Œæ—¶ï¼Œè‹¥æ˜¯åŠ¨æ€ç»‘å®šè°ƒç”¨æ–¹æ³•ï¼Œé‚£å°±å…ˆä»æœ¬ç±»ä¸­å¯»æ‰¾ï¼Œå¦åˆ™ä»è¶…ç±»ä¸­å¯»æ‰¾ã€‚ï¼ˆæ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•è¡¨method tableï¼‰</li>
</ol>
<h1 id="é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•">4. é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•</h1><p>ä¸å…è®¸æ‰©å±•ï¼ˆè¢«ç»§æ‰¿ï¼‰çš„ç±»è¢«ç§°ä¸ºfinalç±»ã€‚</p>
<p>ä¾‹å¦‚ä¸‹ä¾‹å­ä¸­çš„Executiveç±»å°±ä¸èƒ½æœ‰å­ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Executive</span> <span class="keyword">extends</span> <span class="title">Manager</span></span>&#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç±»ä¸­çš„æ–¹æ³•ä¹Ÿå¯ä»¥final,é‚£ä¹ˆå­ç±»å°±ä¸èƒ½è¦†ç›–è¿™ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getName</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æŠ½è±¡ç±»ï¼Œabstract">5. æŠ½è±¡ç±»ï¼Œabstract</h1><p>ç”¨äºè¡¨ç¤ºæŸç§å¾ˆæŠ½è±¡çš„ã€ä¸Šå±‚çš„ã€æ›´é€šç”¨çš„ç±»ã€‚ä¾‹å¦‚å›¾ä¸­çš„<code>Person</code>ç±»ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-04-13-10-25-16.png" alt=""> </p>
<ul>
<li>ä¸€èˆ¬æ¥è¯´ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•çš„ç±»æœ¬èº«å¿…é¡»è¢«å£°æ˜ä¸ºæŠ½è±¡çš„ã€‚</li>
<li>æŠ½è±¡ç±»<strong>ä¸èƒ½</strong>è¢«å®ä¾‹åŒ–ï¼</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">class</span> <span class="title">Person</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="keyword">private</span> String name;<span class="comment">//äººç±»å…±æœ‰çš„å±æ€§,æ˜¯å…·ä½“çš„å±æ€§</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String n)</span></span>&#123;<span class="comment">//å…·ä½“çš„æ–¹æ³•</span></div><div class="line">        name=n;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getDescription</span><span class="params">()</span></span>;<span class="comment">//æŠ½è±¡æ–¹æ³•</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>å¯ä»¥å®šä¹‰æŠ½è±¡ç±»çš„å¯¹è±¡å˜é‡ï¼Œä½†åªèƒ½å¼•ç”¨éæŠ½è±¡å­ç±»çš„å¯¹è±¡ï¼š</p>
<p>  Person p = new Student(â€œVince Vuâ€,â€Economicsâ€);</p>
</li>
</ul>
<p>ç…§ç€ä¹¦ä¸Šå†™äº†abstractçš„<a href="https://github.com/jiayi797/Java/tree/master/abstactClasses" target="_blank" rel="external">demo</a></p>
<p>è¾“å‡ºä¸ºï¼š</p>
<pre><code>Harry Hacker,an employee with a salary of 50000.00
Maria Morris,a student majoring in computer science
</code></pre><h1 id="å—ä¿æŠ¤è®¿é—®ï¼ŒProtected">6. å—ä¿æŠ¤è®¿é—®ï¼ŒProtected</h1><p>è‹¥è¶…ç±»çš„æŸä¸ªåŸŸè¢«å£°æ˜ä¸ºprotected,é‚£ä¹ˆå­ç±»å°±å¯ä»¥ç›´æ¥è®¿é—®è¿™ä¸ªprotectedåŸŸã€‚</p>
<ul>
<li>private-ä»…æœ¬ç±»å¯è§</li>
<li>public-æ‰€æœ‰ç±»å¯è§</li>
<li>protected-å¯¹æœ¬åŒ…å’Œæ‰€æœ‰å­ç±»å¯è§</li>
<li>é»˜è®¤-å¯¹æœ¬åŒ…å¯è§</li>
</ul>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[GBDT]]></title>
      <url>/2017/03/15/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-GBDT/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰çš„AdaBoostDTreeçš„è¯¯å·®å‡½æ•°æ˜¯æŒ‡æ•°å‹çš„ã€‚GBDTçš„è¯¯å·®å‡½æ•°æ˜¯ä»»æ„æŒ‡å®šçš„ã€‚<br>GBDTçš„æ ¸å¿ƒå°±åœ¨äºï¼Œæ¯ä¸€æ£µæ ‘å­¦çš„æ˜¯ä¹‹å‰æ‰€æœ‰æ ‘ç»“è®ºå’Œçš„æ®‹å·®ï¼Œè¿™ä¸ªæ®‹å·®å°±æ˜¯ä¸€ä¸ªåŠ é¢„æµ‹å€¼åèƒ½å¾—çœŸå®å€¼çš„ç´¯åŠ é‡ã€‚</p>
<h1 id="GBDTçš„è¯¯å·®å‡½æ•°">1. GBDTçš„è¯¯å·®å‡½æ•°</h1><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-13-49-01.png" alt=""> </p>
<h1 id="ç›®æ ‡">2. ç›®æ ‡</h1><ol>
<li>æ±‚å‡½æ•°h(x)çš„å½¢å¼</li>
<li>æ±‚h(x)çš„æ­¥é•¿Î·</li>
</ol>
<h1 id="å›å½’é—®é¢˜æ±‚è§£ç›®æ ‡">3. å›å½’é—®é¢˜æ±‚è§£ç›®æ ‡</h1><p>å¯¹äºå›å½’ï¼ˆregressionï¼‰é—®é¢˜ï¼Œè¯¯å·®å‡½æ•°ä¸€èˆ¬é‡‡ç”¨å¹³æ–¹è¯¯å·®ã€‚å³ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-13-55-15.png" alt=""> </p>
<p>ä¸ºäº†è¿›ä¸€æ­¥æ±‚è§£ï¼Œæˆ‘ä»¬å¯¹ä¸Šå¼è¿›è¡Œtaylorå±•å¼€ï¼Œå³ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-13-58-42.png" alt=""> </p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>å·¦è¾¹ä¸€é¡¹$err(S_n,y_n)$æ˜¯å¸¸é‡ï¼ˆå› ä¸º$S_n$ã€$y_n$éƒ½å·²çŸ¥ï¼‰</li>
<li>å³è¾¹ä¸€é¡¹åº”è¯¥å¯¹sæ±‚å¯¼ï¼Œå¹¶åœ¨snè¿™ç‚¹å–å¯¼æ•°å€¼ï¼ˆ$error=(s-y)^2$æ±‚å¯¼ä¹‹åå¾—åˆ°$2(s-y)$ï¼‰</li>
</ul>
<p>é‚£ä¹ˆï¼Œä¸Šå¼ç­‰äºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-14-04-27.png" alt=""> </p>
<h2 id="æ±‚h-x">3.1. æ±‚h(x)</h2><p>ä¸ºäº†è®©ä¸Šå¼æœ€å°åŒ–ï¼Œé‚£ä¹ˆè²Œä¼¼$|h(x)|$æ— ç©·å¤§å³å¯å®ç°ï¼Œè¿™ä¸ç§‘å­¦ï¼äºæ˜¯æˆ‘ä»¬è¦å¯¹$h(x)$çš„å¤§å°è¿›è¡Œé™åˆ¶ï¼ˆç±»ä¼¼å½’ä¸€åŒ–ï¼‰â€”â€”â€”â€”åŠ å…¥æƒ©ç½šé¡¹$(h(x_n))^2$ï¼Œå³å°†ä¸Šå¼å˜ä¸ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-14-19-46.png" alt=""> </p>
<p>è€Œä¸Šå¼å¯å˜ä¸ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-14-20-27.png" alt=""> </p>
<p>å…¶ä¸­çš„$(s_n-y_n)^2$æ˜¯å¸¸æ•°ï¼Œè®°ä¸ºconstant</p>
<p>é‚£ä¹ˆæ–°çš„ç›®æ ‡å°±å˜ä¸ºï¼šç”¨$x_n$å’Œ$y_n-s_n$åšä¸€ä¸ªregressionå³å¯ã€‚å³ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-14-27-31.png" alt=""> </p>
<p>ç»è¿‡penalizeä¸€ç•ªæŠ˜è…¾ä¹‹åï¼Œhç»ˆäºæœ‰ä¸ªåƒæ¨¡åƒæ ·çš„å½¢å¼äº†ï¼šå³regression with residualsï¼ˆæ®‹å·®ï¼‰ã€‚</p>
<h2 id="æ±‚æ­¥é•¿Î·">3.2. æ±‚æ­¥é•¿Î·</h2><p>éœ€è¦æ±‚å¾—ä¸€ä¸ªÎ·ï¼Œä½¿å¾—ä¸‹å¼æœ€å°åŒ–ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-15-21-27.png" alt=""> </p>
<p>ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ä»¬å°†å¹³æ–¹å†…çš„é¡¹å–è´Ÿï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-15-22-55.png" alt=""> </p>
<p>ä¸Šå¼çš„$y_n-s_n$å³residualsï¼ˆæ®‹å·®ï¼‰.è¿™æ˜¯ä¸€ä¸ªå•å˜é‡çš„çº¿æ€§å›å½’é—®é¢˜ï¼Œå…¶ä¸­è¾“å…¥æ˜¯ç”¨gtè½¬æ¢åçš„æ•°æ®ï¼Œè¾“å‡ºæ˜¯æ®‹å·®(residual)ã€‚</p>
<h1 id="GBDTç®—æ³•">4. GBDTç®—æ³•</h1><p>è¾“å‡ºï¼š$\sum_t^T\alpha_t g_t(x)$ï¼Œå³ä¸€å †æƒé‡$\alpha_t$å’Œä¸€å †å†³ç­–æ ‘$g_t(x)$<br>æ­¥éª¤ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-15-32-42.png" alt=""> </p>
<p>1ï¼‰åˆ©ç”¨C&amp;RTå»å­¦{x, yn-sn}ï¼Œä¿ç•™è¿™ä¸€è½®å­¦å‡ºæ¥çš„æ ‘gt(x)</p>
<p>2ï¼‰å†æ±‚{gt(x), residual}çº¿æ€§å›å½’ï¼Œæœ€å°åŒ–ç›®æ ‡å‡½æ•°æ±‚å‡ºæ¥ita</p>
<p>3ï¼‰æ›´æ–°sn</p>
<p>å­¦ä¹ è¶³å¤Ÿå¤šæ¬¡æ•°åï¼Œè¿”å›ç»„åˆçš„GBDTã€‚</p>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> æ ‘æ¨¡å‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jacman/hexoç›®å½•æ”¹æˆæµ®åŠ¨]]></title>
      <url>/2017/03/14/blog-jacman-hexo%E7%9B%AE%E5%BD%95%E6%94%B9%E6%88%90%E6%B5%AE%E5%8A%A8/</url>
      <content type="html"><![CDATA[<h1 id="æ·»åŠ æ ·å¼æ”¯æŒ">1. æ·»åŠ æ ·å¼æ”¯æŒ</h1><p>ä¸ºäº†ä¸å§åŸå…ˆçš„åƒæ˜¯æ–‡ä»¶æå¾—å¤ªä¹±ï¼Œè¿™é‡Œï¼Œæ·»åŠ å­é›†çš„æ ·å¼æ–‡ä»¶ã€‚<br>é¦–å…ˆï¼Œåœ¨æ ·å¼æ–‡ä»¶çš„<code>source</code>æ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°<code>css</code>æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€<code>style.styl</code>æ–‡ä»¶ï¼Œåœ¨æœ€åæ·»åŠ ï¼š</p>
<p><code>@import &quot;_my/mycss&quot;;</code> </p>
<h1 id="æ–°å»ºè‡ªå®šä¹‰æ ·å¼">2. æ–°å»ºè‡ªå®šä¹‰æ ·å¼</h1><p>æ‰¾åˆ°æ ·å¼æ–‡ä»¶å¤¹<code>css</code> æ–°å»º<code>_my</code>æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­æ–°å»º<code>mycss.sty</code>læ–‡ä»¶ï¼Œä¹‹åå°±å¯ä»¥æŒ‰ç…§<code>stylus</code>çš„æ ¼å¼è‡ªå®šä¹‰æ ·å¼äº†ã€‚</p>
<h1 id="è®¾ç½®tocæµ®åŠ¨">3. è®¾ç½®tocæµ®åŠ¨</h1><p>ç»™mycss.styæ·»åŠ ï¼š</p>
<pre><code>#toc
 line-height 1.2em
 font-size 0.8em
 backgroud-color #fff
 float right
 position fixed
 right 30em
 top 20em
</code></pre><h1 id="å­˜åœ¨çš„é—®é¢˜">4. å­˜åœ¨çš„é—®é¢˜</h1><p>æš‚ä¸æ”¯æŒè‡ªç›¸åº”ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="https://segmentfault.com/a/1190000003846777" target="_blank" rel="external">Hexoåšå®¢ä¸»é¢˜NexTä½¿ç”¨è‡ªå®šä¹‰çš„CSSæ ·å¼</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> çæŠ˜è…¾ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaå­¦ä¹ ç¬”è®°1-ç±»ä¸å¯¹è±¡]]></title>
      <url>/2017/03/14/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1-%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ€»ç»“äº†ä¸€äº›è‡ªå·±ä¸å¤ªç†Ÿæ‚‰çš„æ¦‚å¿µã€‚</p>
<h1 id="å¯¹è±¡ä¸å¯¹è±¡å˜é‡">1. å¯¹è±¡ä¸å¯¹è±¡å˜é‡</h1><pre><code>Date birthday = new Date();
</code></pre><p>å¯¹è±¡å˜é‡ï¼šbirthday<br>å¯¹è±¡ï¼šå³è¾¹çš„éƒ¨åˆ†</p>
<p>ä¸€ä¸ªå¯¹è±¡å˜é‡å¹¶æ²¡æœ‰å®é™…åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼Œä»…ä»…æ˜¯å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>å¯ä»¥æ˜¾ç¤ºåœ°å°†å¯¹è±¡å˜é‡è®¾ç½®ä¸º<code>null</code>ï¼Œè¡¨æ˜è¿™ä¸ªå¯¹è±¡å˜é‡ç›®å‰æ²¡æœ‰å¼•ç”¨ä»»ä½•å¯¹è±¡ï¼š</p>
<pre><code>birthday = null;
</code></pre><h1 id="éšå¼å‚æ•°ä¸æ˜¾å¼å‚æ•°">2. éšå¼å‚æ•°ä¸æ˜¾å¼å‚æ•°</h1><p>ä¾‹ï¼ŒmethodName()æ˜¯ç±»class1çš„æ–¹æ³•ï¼Œ</p>
<pre><code>calss class1{
int a;
    public void methodName(int b){
    this.a = b ;
}
</code></pre><ul>
<li>æ˜¾å¼å‚æ•°(explicit)ï¼šæ‹¬å·é‡Œé¢çš„ï¼Œä¾‹å¦‚double pName</li>
<li>éšå¼å‚æ•°(implicit)ï¼šå‡ºç°åœ¨æ–¹æ³•åå‰çš„class1ç±»å¯¹è±¡<br>â€“ å…³é”®è¯<code>this</code>è¡¨ç¤ºéšå¼å‚æ•°ã€‚ä¾‹å¦‚<code>this.a</code></li>
</ul>
<h1 id="å°è£…">3. å°è£…</h1><p>ä¸èƒ½ç¼–å†™è¿”å›<code>å¼•ç”¨å¯å˜å¯¹è±¡</code>çš„è®¿é—®å™¨æ–¹æ³•ï¼ä¾‹å¦‚ï¼š</p>
<pre><code>class class1{
    private Date a;
    public Date get(){
        return Date a; //ä¼šç ´åå°è£…æ€§ï¼
    }
}
</code></pre><p>ä»¥ä¸Šæ“ä½œç ´åäº†<code>a</code>çš„ç§æœ‰æ€§ã€‚</p>
<p>æ”¹æ­£æ–¹æ³•ï¼šå…‹éš†ï¼ˆcloneï¼‰</p>
<pre><code>class class1{
    private Date a;
    public Date get(){
        return Date a.clone(); //ä½¿ç”¨clone()
    }
}
</code></pre><h1 id="finalå®ä¾‹åŸŸ">4. finalå®ä¾‹åŸŸ</h1><pre><code>class class1{
    private final String name;
}
</code></pre><p>finalåŸŸçš„ç‰¹å¾ï¼š</p>
<ol>
<li>æ„é€ å¯¹è±¡æ—¶ï¼Œå¿…é¡»åˆå§‹åŒ–final</li>
<li>åé¢æ“ä½œä¸­ï¼Œä¸èƒ½å†æ”¹åŠ¨</li>
<li>ä½†å¹¶ä¸ç­‰äºå¸¸é‡ï¼</li>
<li>å±äºå¯¹è±¡ï¼Œå¹¶ä¸æ˜¯ç±»ï¼</li>
</ol>
<h1 id="staticé™æ€">5. staticé™æ€</h1><h2 id="staticåŸŸ">5.1. staticåŸŸ</h2><ol>
<li>æ¯ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªstaticåŸŸ</li>
<li>åŒä¸€ç±»çš„æ‰€æœ‰å¯¹è±¡å…±äº«ä¸€ä¸ªstaticåŸŸ</li>
<li>å³ä½¿æ²¡æœ‰å¯¹è±¡ï¼ŒstaticåŸŸä¹Ÿå­˜åœ¨ã€‚å®ƒå±äºç±»ï¼Œä¸å±äºä»»ä½•ä¸€ä¸ªå¯¹è±¡</li>
</ol>
<pre><code>class Employee{
    private static int nextId = 1;
    private int id;
}
</code></pre><h2 id="staticå¸¸é‡">5.2. staticå¸¸é‡</h2><ol>
<li>å¦‚ä¸‹ä¾‹ï¼Œåœ¨ç¨‹åºä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>Math.PI</code>æ¥è·å–è¿™ä¸ªå¸¸é‡ã€‚</li>
</ol>
<pre><code>public class Math{
    public static final double PI = 3.14;
}
</code></pre><h2 id="staticæ–¹æ³•">5.3. staticæ–¹æ³•</h2><pre><code>Math.pow(x,a)
</code></pre><ol>
<li>ä¸ä½¿ç”¨ä»»ä½•å¯¹è±¡ï¼›</li>
<li>ä¸èƒ½æ“ä½œå®ä¾‹åŸŸï¼ˆå³ç±»å†…çš„éstaticæ–¹æ³•å’Œå˜é‡ï¼‰ï¼Œå› ä¸ºå®ƒä¸èƒ½æ“ä½œå¯¹è±¡ï¼›</li>
<li>å¯ä»¥è®¿é—®è‡ªèº«ç±»çš„staticåŸŸï¼›</li>
<li>å¯¹è±¡ä¹Ÿå¯ä»¥è°ƒç”¨staticæ–¹æ³•ã€‚</li>
</ol>
<p>åœ¨ä¸‹é¢ä¸¤ç§æƒ…å†µä½¿ç”¨é™æ€æ–¹æ³•ï¼š</p>
<ol>
<li>ä¸€ä¸ªæ–¹æ³•ä¸éœ€è¦è®¿é—®å¯¹è±¡ï¼›</li>
<li>ä¸€ä¸ªæ–¹æ³•åªéœ€è¦è®¿é—®ç±»çš„staticåŸŸã€‚</li>
</ol>
<h2 id="å·¥å‚æ–¹æ³•">5.4. å·¥å‚æ–¹æ³•</h2><p>å·¥å‚æ–¹æ³•æ˜¯é™æ€æ–¹æ³•çš„ä¸€ç§å¸¸è§ç”¨é€”ã€‚<br>ä¾‹å¦‚ï¼Œ<code>NumberFormat</code>ä½¿ç”¨å·¥å‚æ–¹æ³•(è€Œä¸æ˜¯æ„é€ å™¨)äº§ç”Ÿ<strong>ä¸åŒé£æ ¼</strong>çš„æ ¼å¼å¯¹è±¡ã€‚</p>
<pre><code>NumberFormat a = NumberFormat.getSytleA();
NumberFormat b = NumberFormat.getStyleB();
</code></pre><h2 id="mainæ–¹æ³•">5.5. mainæ–¹æ³•</h2><pre><code>public class Application{
    public static void main(String[] args){
        // construct objects here
    }
}
</code></pre><ol>
<li>æ¯ä¸€ä¸ªç±»å¯ä»¥æœ‰ä¸€ä¸ªmainæ–¹æ³•ï¼Œç”¨æ¥å•å…ƒæµ‹è¯•ï¼›</li>
<li>å¤šä¸ªç±»è¢«è°ƒç”¨æ—¶ï¼Œåªä¼šæ‰§è¡Œä¸€ä¸ªmainæ–¹æ³•ï¼›</li>
</ol>
<h1 id="åˆå§‹åŒ–å—">6. åˆå§‹åŒ–å—</h1><p>æ„é€ å¯¹è±¡æ—¶ï¼Œå…ˆè¿è¡Œåˆå§‹åŒ–å—ï¼Œæ‰è¿è¡Œæ„é€ å™¨ä¸»ä½“éƒ¨åˆ†ã€‚</p>
<pre><code>class Employee{
    private static int nextId;
    private int id;
    //åˆå§‹åŒ–å—
    {
        id=nextId;
    }
}
</code></pre><p>å¦‚æœå¯¹ç±»çš„é™æ€åŸŸè¿›è¡Œåˆå§‹åŒ–çš„ä»£ç æ¯”è¾ƒå¤æ‚ï¼Œå°±å¯ä»¥ä½¿ç”¨é™æ€çš„åˆå§‹åŒ–å—ï¼š</p>
<pre><code>static{
    Random generator = new Random();
    nextId = generator.nextId(10000);
}
</code></pre><p>ç±»ï¼ˆï¼ï¼ï¼ä¸æ˜¯å¯¹è±¡ï¼‰ç¬¬ä¸€æ¬¡åŠ è½½æ—¶ï¼Œå°†ä¼šè¿›è¡ŒstaticåŸŸçš„åˆå§‹åŒ–ã€‚</p>
<h1 id="åˆå§‹åŒ–æ•°æ®åŸŸçš„ä¸‰ç§æ–¹æ³•">7. åˆå§‹åŒ–æ•°æ®åŸŸçš„ä¸‰ç§æ–¹æ³•</h1><ol>
<li>åœ¨æ„é€ å™¨ä¸­è®¾ç½®å€¼</li>
<li>åœ¨å£°æ˜ä¸­èµ‹å€¼</li>
<li>åœ¨åˆå§‹åŒ–å—ä¸­èµ‹å€¼</li>
</ol>
<h1 id="ç±»çš„åˆå§‹åŒ–é¡ºåº">8. ç±»çš„åˆå§‹åŒ–é¡ºåº</h1><p>å¯¹äºé™æ€å˜é‡ã€é™æ€åˆå§‹åŒ–å—ã€å˜é‡ã€åˆå§‹åŒ–å—ã€æ„é€ å™¨ï¼Œå®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºä¾æ¬¡æ˜¯ï¼ˆé™æ€å˜é‡ã€é™æ€åˆå§‹åŒ–å—ï¼‰&gt;ï¼ˆå˜é‡ã€åˆå§‹åŒ–å—ï¼‰&gt;æ„é€ å™¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<pre><code>public class InitialOrderTest {   
    // é™æ€å˜é‡   
    public static String staticField = &quot;é™æ€å˜é‡&quot;;   
    // å˜é‡   
    public String field = &quot;å˜é‡&quot;;   
    // é™æ€åˆå§‹åŒ–å—   
    static {   
        System.out.println(staticField);   
        System.out.println(&quot;é™æ€åˆå§‹åŒ–å—&quot;);   
    }   
    // åˆå§‹åŒ–å—   
    {   
        System.out.println(field);   
        System.out.println(&quot;åˆå§‹åŒ–å—&quot;);   
    }   
    // æ„é€ å™¨   
    public InitialOrderTest() {   
        System.out.println(&quot;æ„é€ å™¨&quot;);   
    }   
    public static void main(String[] args) {   
        new InitialOrderTest();   
    }   
}  
</code></pre><p>è¿è¡Œä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹çš„è¾“å‡ºç»“æœï¼š </p>
<pre><code>é™æ€å˜é‡
é™æ€åˆå§‹åŒ–å—
å˜é‡
åˆå§‹åŒ–å—
æ„é€ å™¨
</code></pre><p>å¯¹äºç»§æ‰¿çš„æƒ…å†µï¼š</p>
<pre><code>class Parent {   
    // é™æ€å˜é‡   
    public static String p_StaticField = &quot;çˆ¶ç±»--é™æ€å˜é‡&quot;;   
    // å˜é‡   
    public String p_Field = &quot;çˆ¶ç±»--å˜é‡&quot;;   

    // é™æ€åˆå§‹åŒ–å—   
    static {   
        System.out.println(p_StaticField);   
        System.out.println(&quot;çˆ¶ç±»--é™æ€åˆå§‹åŒ–å—&quot;);   
    }   

    // åˆå§‹åŒ–å—   
    {   
        System.out.println(p_Field);   
        System.out.println(&quot;çˆ¶ç±»--åˆå§‹åŒ–å—&quot;);   
    }   

    // æ„é€ å™¨   
    public Parent() {   
        System.out.println(&quot;çˆ¶ç±»--æ„é€ å™¨&quot;);   
    }   
}   

public class SubClass extends Parent {   
    // é™æ€å˜é‡   
    public static String s_StaticField = &quot;å­ç±»--é™æ€å˜é‡&quot;;   
    // å˜é‡   
    public String s_Field = &quot;å­ç±»--å˜é‡&quot;;   
    // é™æ€åˆå§‹åŒ–å—   
    static {   
        System.out.println(s_StaticField);   
        System.out.println(&quot;å­ç±»--é™æ€åˆå§‹åŒ–å—&quot;);   
    }   
    // åˆå§‹åŒ–å—   
    {   
        System.out.println(s_Field);   
        System.out.println(&quot;å­ç±»--åˆå§‹åŒ–å—&quot;);   
    }   

    // æ„é€ å™¨   
    public SubClass() {   
        System.out.println(&quot;å­ç±»--æ„é€ å™¨&quot;);   
    }   

    // ç¨‹åºå…¥å£   
    public static void main(String[] args) {   
        new SubClass();   
    }   
}  
</code></pre><p>è¿è¡Œä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œç»“æœé©¬ä¸Šå‘ˆç°åœ¨æˆ‘ä»¬çš„çœ¼å‰ï¼š </p>
<pre><code>çˆ¶ç±»--é™æ€å˜é‡
çˆ¶ç±»--é™æ€åˆå§‹åŒ–å—
å­ç±»--é™æ€å˜é‡
å­ç±»--é™æ€åˆå§‹åŒ–å—
çˆ¶ç±»--å˜é‡
çˆ¶ç±»--åˆå§‹åŒ–å—
çˆ¶ç±»--æ„é€ å™¨
å­ç±»--å˜é‡
å­ç±»--åˆå§‹åŒ–å—
å­ç±»--æ„é€ å™¨
</code></pre><p>æ€»å¾—æ¥è¯´ï¼Œæ˜¯å…ˆé™æ€åå˜é‡ï¼Œå…ˆçˆ¶ç±»åå­ç±»</p>
<h1 id="å…¶ä»–é‡ç‚¹">9. å…¶ä»–é‡ç‚¹</h1><ol>
<li>åŸºäºç±»çš„è®¿é—®æƒé™ï¼šä¸€ä¸ªæ–¹æ³•å¯ä»¥è®¿é—®æ‰€å±ç±»çš„æ‰€æœ‰ç§æœ‰æ•°æ®ã€‚</li>
<li>javaçš„å€¼å¼•ç”¨ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨ï¼‰</li>
<li>å¦‚æœç±»ä¸­æä¾›äº†è‡³å°‘ä¸€ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œè€Œæ²¡æœ‰æ— å‚æ„é€ å™¨ï¼Œåˆ™åœ¨æ„é€ æ— å‚å¯¹è±¡æ—¶ä¼šå‡ºé”™ã€‚</li>
</ol>
<h1 id="Javaç±»åº“ä¸­çš„GregorianCalendarç±»-ï¼ˆåˆ é™¤æœ¬èŠ‚ï¼‰">10. Javaç±»åº“ä¸­çš„GregorianCalendarç±» ï¼ˆåˆ é™¤æœ¬èŠ‚ï¼‰</h1><h2 id="çºªå…ƒ">10.1. çºªå…ƒ</h2><p>æ—¶é—´æ˜¯ç”¨è·ç¦»ä¸€ä¸ªå›ºå®šæ—¶é—´ç‚¹çš„æ¯«ç§’æ•°è¡¨ç¤ºçš„ï¼Œè¿™ä¸ªç‚¹å°±æ˜¯çºªå…ƒ(epoch)ã€‚</p>
<h2 id="æ—¶é—´ä¸æ—¥å†">10.2. æ—¶é—´ä¸æ—¥å†</h2><p>ä¸ºäº†å°†<strong>æ—¶é—´</strong>ä¸<strong>æ—¥å†</strong>åˆ†å¼€ï¼Œæ ‡å‡†Javaç±»åº“åˆ†åˆ«åŒ…å«ä¸¤ä¸ªç±»ï¼š</p>
<ul>
<li>Dateç±»ï¼šç”¨æ¥è¡¨ç¤ºæ—¶é—´ç‚¹çš„ç±»ï¼›</li>
<li>GregorianCalendarç±»ï¼šç”¨æ¥è¡¨ç¤ºå…¬å†æ³•çš„ç±»ï¼›ï¼ˆé€šè¿‡å®ƒè¿˜æœ‰ä¸€ä¸ªæ‰©å±•ç±»â€”â€”Calendarç±»ï¼Œæè¿°äº†æ—¥å†çš„ä¸€èˆ¬å±æ€§ï¼‰</li>
</ul>
<h3 id="Dateç±»">10.2.1. Dateç±»</h3><p>ç”¨æ¥è¡¨ç¤ºæ—¶é—´çš„ç±»ï¼›</p>
<p>åªæœ‰å°‘é‡çš„æ–¹æ³•ï¼Œä¾‹å¦‚æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´ç‚¹before(),after()ï¼š</p>
<pre><code>doday.before(birthday)
</code></pre><h3 id="GregorianCalendarç±»">10.2.2. GregorianCalendarç±»</h3><p>å¸¸è§æ–¹æ³•ï¼š</p>
<p><code>new GregorianCalendar()</code>ï¼Œæ„é€ æ–°çš„å¯¹è±¡ï¼Œç”¨äºè¡¨ç¤ºå¯¹è±¡æ„é€ æ—¶çš„æ—¥æœŸå’Œæ—¶é—´ï¼›</p>
<p>ä¾‹å¦‚:</p>
<pre><code>GregorianCalendar g1 = new GregorianCalendar();
</code></pre><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-14-10-47-16.png" alt=""> </p>
<p><code>new GregorianCalendar(1999,11,31)</code>ï¼Œæä¾›å¹´æœˆæ—¥æ„é€ ä¸€ä¸ªè¡¨ç¤ºç‰¹å®šæ—¥æœŸåˆå¤œçš„æ—¥å†å¯¹è±¡ã€‚ï¼ˆæœˆä»½ä»0å¼€å§‹è®¡æ•°ï¼Œ11è¡¨ç¤º12æœˆï¼‰</p>
<p><code>new GregorianCalendar(1991,Calendar.DECEMBER,31)</code>,ä¸ä¸Šç­‰ä»·</p>
<p><code>new GregorianCalendar(1991,Calendar.DECEMBER,31,23,59,59)</code>,è®¾ç½®æ—¶é—´</p>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[O2Oä¼˜æƒ åˆ¸é¢„æµ‹â€”â€”å¯¹ç¬¬ä¸€åçš„æ€è·¯æºç åˆ†æï¼ˆäºŒï¼‰]]></title>
      <url>/2017/03/11/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-O2O%E4%BC%98%E6%83%A0%E5%88%B8%E9%A2%84%E6%B5%8B-%E5%AF%B9%E7%AC%AC%E4%B8%80%E5%90%8D%E7%9A%84%E6%80%9D%E8%B7%AF%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦é’ˆå¯¹å¤©æ± å¤§æ•°æ®ç«èµ›ä¹‹â€œO2Oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹â€çš„å† å†›é˜Ÿä¼çš„æ€è·¯å’Œæºç åˆ†æã€‚åœ¨æ­¤æ„Ÿè°¢æ— ç§çš„å‰è¾ˆ(è¯—äººéƒ½è—åœ¨æ°´åº•)[<a href="https://github.com/wepe/O2O-Coupon-Usage-Forecast]ã€‚" target="_blank" rel="external">https://github.com/wepe/O2O-Coupon-Usage-Forecast]ã€‚</a></p>
<p>æœ¬æ–‡ä¸»è¦å¯¹æ¨¡å‹è®­ç»ƒ<code>xgb.py</code> åšä¸€äº›è¯¦ç»†çš„åˆ†æã€‚</p>
<p>æ–‡ä»¶ï¼šO2O-Coupon-Usage-Forecast/code/wepon/season one </p>
<p><code>xgb.py</code> è®­ç»ƒxgboostæ¨¡å‹ï¼Œç”Ÿæˆç‰¹å¾é‡è¦æ€§æ–‡ä»¶ï¼Œç”Ÿæˆé¢„æµ‹ç»“æœã€‚å•æ¨¡å‹ç¬¬ä¸€èµ›å­£Aæ¦œAUCå¾—åˆ†0.798.</p>
<h1 id="importåŒ…">1. importåŒ…</h1><p>é¦–å…ˆä½œè€…import xgboost,å› æ­¤æˆ‘ä»¬éœ€è¦å®‰è£…ä¸€ä¸‹å®ƒã€‚</p>
<p>XGBoostæ˜¯æ•°æ®æŒ–æ˜ä¸­ç”¨åˆ°ä¸€ä¸ªæ–°å‹çš„æ•°æ®åˆ†æåŒ…ï¼Œç›¸å¯¹å…¶å®ƒBoostingæ¨¡å‹æ›´åŠ é«˜æ•ˆã€‚</p>
<p>å®‰è£…æ•™ç¨‹<a href="http://www.jianshu.com/p/11f9229b0ecd" target="_blank" rel="external">xgboost install on windows</a></p>
<h1 id="å¯¼å…¥æ•°æ®">2. å¯¼å…¥æ•°æ®</h1><pre><code>#å°†æ•°æ®é›†å¯¼å…¥
dataset1 = pd.read_csv(&apos;data/dataset1.csv&apos;)
dataset2 = pd.read_csv(&apos;data/dataset2.csv&apos;)
dataset3 = pd.read_csv(&apos;data/dataset3.csv&apos;)
</code></pre><p><code>dataset1ã€dataset2</code>æœ‰56ä¸ªç‰¹å¾ï¼Œå›¾æ˜¯å‰åä¸ªã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-12-22-11-30.png" alt=""> </p>
<p><code>dataset3</code>æœ‰57ä¸ªç‰¹å¾</p>
<pre><code>#å°†dataset1çš„labelåˆ—çš„-1éƒ½æ¢æˆ0
dataset1.label.replace(-1,0,inplace=True)
dataset2.label.replace(-1,0,inplace=True)

#åˆ é™¤é‡å¤é¡¹
dataset1.drop_duplicates(inplace=True)
dataset2.drop_duplicates(inplace=True)
dataset3.drop_duplicates(inplace=True)
</code></pre><p>å°†dataset1å’Œdataset2è¿èµ·æ¥</p>
<pre><code>dataset12 = pd.concat([dataset1,dataset2],axis=0)
</code></pre><p>dataset1_yèµ‹å€¼ä¸ºdataset1çš„labelåˆ—</p>
<pre><code>dataset1_y = dataset1.label
</code></pre><p>åˆ é™¤dataset1çš„â€™user_idâ€™,â€™labelâ€™,â€™day_gap_beforeâ€™,â€™day_gap_afterâ€™å­—æ®µï¼Œèµ‹å€¼ç»™dataset1_x</p>
<pre><code>dataset1_x = dataset1.drop([&apos;user_id&apos;,&apos;label&apos;,&apos;day_gap_before&apos;,&apos;day_gap_after&apos;],axis=1)  # &apos;day_gap_before&apos;,&apos;day_gap_after&apos; cause overfitting, 0.77


dataset2_y = dataset2.label
dataset2_x = dataset2.drop([&apos;user_id&apos;,&apos;label&apos;,&apos;day_gap_before&apos;,&apos;day_gap_after&apos;],axis=1)
dataset12_y = dataset12.label
dataset12_x = dataset12.drop([&apos;user_id&apos;,&apos;label&apos;,&apos;day_gap_before&apos;,&apos;day_gap_after&apos;],axis=1)
dataset3_preds = dataset3[[&apos;user_id&apos;,&apos;coupon_id&apos;,&apos;date_received&apos;]]
dataset3_x = dataset3.drop([&apos;user_id&apos;,&apos;coupon_id&apos;,&apos;date_received&apos;,&apos;day_gap_before&apos;,&apos;day_gap_after&apos;],axis=1)
</code></pre><p>ç”¨shapeå±æ€§æ¥æ˜¾ç¤ºæ•°æ®çš„æ ¼å¼</p>
<pre><code>print dataset1_x.shape,dataset2_x.shape,dataset3_x.shape
</code></pre><p>è‹¥è¾“å‡ºï¼š(8618,36) è¡¨ç¤ºè¿™ä¸ªè¡¨æ ¼æœ‰8618è¡Œå’Œ36åˆ—çš„æ•°æ®ï¼Œå…¶ä¸­dimensions[0]ä¸º8618ï¼Œdimensions[1]ä¸º36</p>
<h1 id="åŠ è½½æ•°æ®åˆ°xgboost">3. åŠ è½½æ•°æ®åˆ°xgboost</h1><p>dataset1ã€dateset2ã€dateset3 ä¸ºxgbçš„DMatrix</p>
<pre><code>dataset1 = xgb.DMatrix(dataset1_x,label=dataset1_y)
dataset2 = xgb.DMatrix(dataset2_x,label=dataset2_y)
dataset12 = xgb.DMatrix(dataset12_x,label=dataset12_y)
dataset3 = xgb.DMatrix(dataset3_x)
</code></pre><p>å‚è€ƒæ–‡çŒ®<a href="http://blog.csdn.net/sb19931201/article/details/52557382" target="_blank" rel="external">xgboostå…¥é—¨ä¸å®æˆ˜ï¼ˆåŸç†ç¯‡ï¼‰</a></p>
<h1 id="è®¾ç½®å‚æ•°">4. è®¾ç½®å‚æ•°</h1><pre><code>params={&apos;booster&apos;:&apos;gbtree&apos;,
        &apos;objective&apos;: &apos;rank:pairwise&apos;,
        &apos;eval_metric&apos;:&apos;auc&apos;,
        &apos;gamma&apos;:0.1,
        &apos;min_child_weight&apos;:1.1,
        &apos;max_depth&apos;:5,
        &apos;lambda&apos;:10,
        &apos;subsample&apos;:0.7,
        &apos;colsample_bytree&apos;:0.7,
        &apos;colsample_bylevel&apos;:0.7,
        &apos;eta&apos;: 0.01,
        &apos;tree_method&apos;:&apos;exact&apos;,
        &apos;seed&apos;:0,
        &apos;nthread&apos;:12
        }
</code></pre><h1 id="è®­ç»ƒæ¨¡å‹">5. è®­ç»ƒæ¨¡å‹</h1><pre><code>model = xgb.train(params,dataset12,num_boost_round=3500,evals=watchlist)    
</code></pre><h1 id="é¢„æµ‹æµ‹è¯•é›†">6. é¢„æµ‹æµ‹è¯•é›†</h1><pre><code>dataset3_preds[&apos;label&apos;] = model.predict(dataset3)
dataset3_preds.label = MinMaxScaler().fit_transform(dataset3_preds.label)
dataset3_preds.sort_values(by=[&apos;coupon_id&apos;,&apos;label&apos;],inplace=True)
dataset3_preds.to_csv(&quot;xgb_preds.csv&quot;,index=None,header=None)
print dataset3_preds.describe()
</code></pre><h1 id="ä¿å­˜ç‰¹å¾è¯„åˆ†">7. ä¿å­˜ç‰¹å¾è¯„åˆ†</h1><pre><code>feature_score = model.get_fscore()
feature_score = sorted(feature_score.items(), key=lambda x:x[1],reverse=True)
fs = []
for (key,value) in feature_score:
    fs.append(&quot;{0},{1}\n&quot;.format(key,value))

with open(&apos;xgb_feature_score.csv&apos;,&apos;w&apos;) as f:
    f.writelines(&quot;feature,score\n&quot;)
    f.writelines(fs)
</code></pre><h1 id="æ€»ç»“">8. æ€»ç»“</h1><p>è¿™æ¬¡ç®—æ˜¯å¯¹è‡ªå·±ä¹‹å‰çš„å„ç§ç†è®ºçŸ¥è¯†è¿›è¡Œäº†ä¸€æ¬¡æ¢³ç†ï¼Œæ„Ÿè§‰å¹³æ—¶è¿‡äºæ³¨é‡ç®—æ³•çš„ç ”ç©¶ï¼Œå¹¶æ²¡æœ‰æ³¨æ„åˆ°å®è§‚ä¸Šçš„æ“ä½œã€‚ä»¥åè¦å¤šåŠ æ³¨æ„</p>
]]></content>
      
        <categories>
            
            <category> o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[O2Oä¼˜æƒ åˆ¸é¢„æµ‹â€”â€”å¯¹ç¬¬ä¸€åçš„æ€è·¯æºç åˆ†æï¼ˆä¸€ï¼‰]]></title>
      <url>/2017/03/08/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-O2O%E4%BC%98%E6%83%A0%E5%88%B8%E9%A2%84%E6%B5%8B-%E5%AF%B9%E7%AC%AC%E4%B8%80%E5%90%8D%E7%9A%84%E6%80%9D%E8%B7%AF%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯å¤ªæ¸£ï¼Œçœ‹äº†äº›è®¸ç®—æ³•ï¼Œå¹¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆåµç”¨ã€‚å†³å®šå¥½å¥½åˆ†æåˆ†æåˆ«äººçš„æ€è·¯ï¼Œä¹Ÿè®¸èƒ½å¤Ÿå¯¹æˆ‘å¸¦æ¥äº›è®¸å¯å‘ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦é’ˆå¯¹å¤©æ± å¤§æ•°æ®ç«èµ›ä¹‹â€œO2Oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹â€çš„å† å†›é˜Ÿä¼çš„æ€è·¯å’Œæºç åˆ†æã€‚åœ¨æ­¤æ„Ÿè°¢æ— ç§çš„å‰è¾ˆ(è¯—äººéƒ½è—åœ¨æ°´åº•)[<a href="https://github.com/wepe/O2O-Coupon-Usage-Forecast]ã€‚" target="_blank" rel="external">https://github.com/wepe/O2O-Coupon-Usage-Forecast]ã€‚</a></p>
<p>æœ¬æ–‡ä¸»è¦å¯¹æ•°æ®çš„æŠ½å–<code>extract_feature.py</code>åšä¸€äº›è¯¦ç»†çš„åˆ†æã€‚</p>
<h1 id="è§£å†³æ–¹æ¡ˆæ¦‚è¿°">1. è§£å†³æ–¹æ¡ˆæ¦‚è¿°</h1><p>æœ¬èµ›é¢˜æä¾›äº†ç”¨æˆ·çº¿ä¸‹æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–æ ¸é”€è¡Œä¸ºçš„çºªå½•è¡¨ï¼Œç”¨æˆ·çº¿ä¸Šç‚¹å‡»/æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–æ ¸é”€è¡Œä¸ºçš„çºªå½•è¡¨ï¼Œè®°å½•çš„æ—¶é—´åŒºé—´æ˜¯2016.01.01è‡³2016.06.30,éœ€è¦é¢„æµ‹çš„æ˜¯2016å¹´7æœˆä»½ç”¨æˆ·é¢†å–ä¼˜æƒ åŠµåæ˜¯å¦æ ¸é”€ã€‚æ ¹æ®è¿™ä¸¤ä»½æ•°æ®è¡¨ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹æ•°æ®é›†è¿›è¡Œåˆ’åˆ†ï¼Œç„¶åæå–äº†ç”¨æˆ·ç›¸å…³çš„ç‰¹å¾ã€å•†å®¶ç›¸å…³çš„ç‰¹å¾ï¼Œä¼˜æƒ åŠµç›¸å…³çš„ç‰¹å¾ï¼Œç”¨æˆ·ä¸å•†å®¶ä¹‹é—´çš„äº¤äº’ç‰¹å¾ï¼Œä»¥åŠåˆ©ç”¨æœ¬èµ›é¢˜çš„leakageå¾—åˆ°çš„å…¶å®ƒç‰¹å¾ï¼ˆè¿™éƒ¨åˆ†ç‰¹å¾åœ¨å®é™…ä¸šåŠ¡ä¸­æ˜¯ä¸å¯èƒ½è·å–åˆ°çš„ï¼‰ã€‚æœ€åè®­ç»ƒäº†XGBoostï¼ŒGBDTï¼ŒRandomForestè¿›è¡Œæ¨¡å‹èåˆã€‚</p>
<p><strong>æºç åˆ†æ</strong></p>
<p>ç¬¬äºŒèµ›å­£æš‚æ—¶æ²¡æœ‰å¹³å°ï¼Œæ‰€ä»¥æœ¬æ–‡åªå¯¹ç¬¬ä¸€èµ›å­£çš„æºç è¿›è¡Œåˆ†æã€‚</p>
<p>æ–‡ä»¶ï¼šO2O-Coupon-Usage-Forecast/code/wepon/season one </p>
<p>è¿™ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾ç¬¬ä¸€èµ›å­£çš„ä»£ç </p>
<ul>
<li><code>extract_feature.py</code>åˆ’åˆ†æ•°æ®é›†ï¼Œæå–ç‰¹å¾ï¼Œç”Ÿæˆè®­ç»ƒé›†ï¼ˆdataset1å’Œdataset2ï¼‰å’Œé¢„æµ‹é›†ï¼ˆdataset3ï¼‰ã€‚</li>
<li><code>xgb.py</code> è®­ç»ƒxgboostæ¨¡å‹ï¼Œç”Ÿæˆç‰¹å¾é‡è¦æ€§æ–‡ä»¶ï¼Œç”Ÿæˆé¢„æµ‹ç»“æœã€‚å•æ¨¡å‹ç¬¬ä¸€èµ›å­£Aæ¦œAUCå¾—åˆ†0.798.</li>
</ul>
<h1 id="importæ¦‚è¿°">2. importæ¦‚è¿°</h1><p>åˆ†æå¯¹è±¡ï¼šextract_feature.py</p>
<h2 id="importåŒ…æ¦‚è¿°">2.1. importåŒ…æ¦‚è¿°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</div></pre></td></tr></table></figure>
<h2 id="pandas">2.2. pandas</h2><p>Pandas æ˜¯åŸºäº NumPy (å› æ­¤è¿˜è¦<code>import numpy</code>) çš„ä¸€ä¸ªéå¸¸å¥½ç”¨çš„åº“ï¼Œæ­£å¦‚åå­—ä¸€æ ·ï¼Œäººè§äººçˆ±ã€‚ä¹‹æ‰€ä»¥å¦‚æ­¤ï¼Œå°±åœ¨äºä¸è®ºæ˜¯è¯»å–ã€å¤„ç†æ•°æ®ï¼Œç”¨å®ƒéƒ½éå¸¸ç®€å•ã€‚Pandasæä¾›äº†å¾ˆå¤šå¤„ç†å¤§æ•°æ®çš„æ–¹æ³•ã€‚æˆ‘æƒ³æ˜¯å› ä¸ºæ­¤ï¼ŒåŸä½œè€…æ‰é‡‡ç”¨äº†å®ƒã€‚</p>
<p>Pandas æœ‰ä¸¤ç§è‡ªå·±ç‹¬æœ‰çš„åŸºæœ¬æ•°æ®ç»“æ„ã€‚<code>Series</code> å’Œ <code>DataFrame</code>ï¼Œå®ƒä»¬è®©æ•°æ®æ“ä½œæ›´ç®€å•äº†ã€‚</p>
<p>ä¸¤ç§ç»“æ„çš„å±æ€§å’Œæ–¹æ³•ä¸å†å¤šé˜è¿°ã€‚è§ä¸¤ä»½å¾ˆå¥½çš„å‚è€ƒæ–‡æ¡£ï¼š</p>
<ol>
<li><a href="http://wiki.jikexueyuan.com/project/start-learning-python/311.html" target="_blank" rel="external">Pandas ä½¿ç”¨</a></li>
<li><a href="http://www.cnblogs.com/chaosimple/p/4153083.html" target="_blank" rel="external">ååˆ†é’Ÿæå®špandas</a></li>
<li><a href="http://dataunion.org/14261.html" target="_blank" rel="external">åœ¨Pythonä¸­åˆ©ç”¨Pandasåº“å¤„ç†å¤§æ•°æ®çš„ç®€å•ä»‹ç»</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html" target="_blank" rel="external">pandaså®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="http://www.cnblogs.com/pengsixiong/p/5050833.html" target="_blank" rel="external">pandaså¸¸è§æ–¹æ³•ï¼Œä¸­æ–‡</a></li>
</ol>
<p>å¤§æ¦‚çŸ¥é“äº†importåŒ…çš„å†…å®¹åï¼Œæˆ‘ä»¬æ­£å¼å¼€å§‹çœ‹æºç ã€‚</p>
<h2 id="æ³¨æ„">2.3. æ³¨æ„</h2><ol>
<li>è¯»å–ä¹‹å‰ï¼Œè¯·å…ˆæŠŠæ•°æ®çš„è¡¨å¤´é¡¹åˆ é™¤ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€è¡Œçš„stringï¼‰</li>
</ol>
<h1 id="è¯»å–æ•°æ®é›†">3. è¯»å–æ•°æ®é›†</h1><p>æ€»ç»“ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:right">name</th>
<th style="text-align:right">content</th>
<th style="text-align:center">varName</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td style="text-align:right">ccf_offline_stage1_train</td>
<td style="text-align:right">ç”¨æˆ·çº¿ä¸‹æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º</td>
<td style="text-align:center">off_train</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:right">ccf_online_stage1_train</td>
<td style="text-align:right">ç”¨æˆ·çº¿ä¸Šç‚¹å‡»/æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º</td>
<td style="text-align:center">on_train</td>
</tr>
<tr>
<td>3</td>
<td style="text-align:right">offline_stage1_test_revised</td>
<td style="text-align:right">ç”¨æˆ·O2Oçº¿ä¸‹ä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹æ ·æœ¬</td>
<td style="text-align:center">off_test</td>
</tr>
</tbody>
</table>
<h2 id="æºç åˆ†æ">3.1. æºç åˆ†æ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#1754884 record,1053282 with coupon_id,9738 coupon. date_received:20160101~20160615,date:20160101~20160630, 539438 users, 8415 merchants</span></div><div class="line"></div><div class="line">off_train = pd.read_csv(<span class="string">'data/ccf_offline_stage1_train.csv'</span>,header=<span class="keyword">None</span>)</div><div class="line">off_train.columns = [<span class="string">'user_id'</span>,<span class="string">'merchant_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'discount_rate'</span>,<span class="string">'distance'</span>,<span class="string">'date_received'</span>,<span class="string">'date'</span>]</div><div class="line"></div><div class="line"><span class="comment">#2050 coupon_id. date_received:20160701~20160731, 76309 users(76307 in trainset, 35965 in online_trainset), 1559 merchants(1558 in trainset)</span></div><div class="line"></div><div class="line">off_test = pd.read_csv(<span class="string">'data/ccf_offline_stage1_test_revised.csv'</span>,header=<span class="keyword">None</span>,nrows=<span class="number">3000</span>)</div><div class="line">off_test.columns = [<span class="string">'user_id'</span>,<span class="string">'merchant_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'discount_rate'</span>,<span class="string">'distance'</span>,<span class="string">'date_received'</span>]</div><div class="line"></div><div class="line"><span class="comment">#11429826 record(872357 with coupon_id),762858 user(267448 in off_train)</span></div><div class="line"></div><div class="line">on_train = pd.read_csv(<span class="string">'data/ccf_online_stage1_train.csv'</span>,header=<span class="keyword">None</span>,nrows=<span class="number">47000</span>)</div><div class="line">on_train.columns = [<span class="string">'user_id'</span>,<span class="string">'merchant_id'</span>,<span class="string">'action'</span>,<span class="string">'coupon_id'</span>,<span class="string">'discount_rate'</span>,<span class="string">'date_received'</span>,<span class="string">'date'</span>]</div></pre></td></tr></table></figure>
<p>è¯»æ•°æ®ä¸»è¦ç”¨äº†pandasçš„read_cvsæ–¹æ³•. ä¸ºäº†å¿«æ·åˆ†æï¼Œæˆ‘ä»¬é™å®šåªè¯»å–æ•°æ®é›†çš„å‰7wã€3kã€47wè¡Œ</p>
<h1 id="é‡‡é›†ç‰¹å¾">4. é‡‡é›†ç‰¹å¾</h1><h2 id="ä¸»è¦ç‰¹å¾">4.1. ä¸»è¦ç‰¹å¾</h2><p>æ€»ç»“ï¼š</p>
<table>
<thead>
<tr>
<th>term</th>
<th style="text-align:right">æ¥æº</th>
<th style="text-align:center">å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>dataset3</td>
<td style="text-align:right">table3,off_test</td>
<td style="text-align:center">off_testæ•°æ®</td>
</tr>
<tr>
<td>dataset2</td>
<td style="text-align:right">table2,off_train</td>
<td style="text-align:center">é¢†åˆ¸æ—¶æœŸåœ¨20160515-20160615ä¹‹é—´çš„</td>
</tr>
<tr>
<td>dataset1</td>
<td style="text-align:right">table2,off_train</td>
<td style="text-align:center">é¢†åˆ¸æ—¥æœŸåœ¨20160414-20160514çš„</td>
</tr>
<tr>
<td>feature3</td>
<td style="text-align:right">table2,off_train</td>
<td style="text-align:center">æ¶ˆè´¹dataåœ¨20160315-20160630çš„ï¼Œæˆ–é¢†åˆ¸æ—¥æœŸåœ¨20160315-20160630ä½†æ²¡æœ‰æ¶ˆè´¹çš„</td>
</tr>
<tr>
<td>feature2</td>
<td style="text-align:right">table2,off_train</td>
<td style="text-align:center">æ¶ˆè´¹æ—¥æœŸåœ¨20160201-20160514çš„ï¼Œæˆ–é¢†åˆ¸æ—¥æœŸåœ¨20160201-20160514ä½†æ²¡æœ‰æ¶ˆè´¹çš„</td>
</tr>
<tr>
<td>feature1</td>
<td style="text-align:right">table2,off_train</td>
<td style="text-align:center">æ¶ˆè´¹æ—¥æœŸåœ¨20160101-20160413çš„ï¼Œæˆ–é¢†åˆ¸æ—¥æœŸåœ¨20160101-20160413ä½†æ²¡æœ‰æ¶ˆè´¹çš„</td>
</tr>
</tbody>
</table>
<p>è¿™æ˜¯æ»‘çª—çš„æ–¹æ³•å¾—åˆ°å¤šä»½è®­ç»ƒæ•°æ®é›†ï¼Œç‰¹å¾åŒºé—´è¶Šå°ï¼Œå¾—åˆ°çš„è®­ç»ƒæ•°æ®é›†è¶Šå¤šã€‚åˆ’åˆ†æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th>é¢„æµ‹åŒºé—´ï¼ˆæå–labelï¼‰</th>
<th style="text-align:center">ç‰¹å¾åŒºé—´ï¼ˆæå–featureï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>é¢†åˆ¸äº†çš„</td>
<td style="text-align:center">æ¶ˆè´¹äº†çš„+é¢†åˆ¸äº†æ²¡æ¶ˆè´¹çš„</td>
</tr>
<tr>
<td>æµ‹è¯•é›†</td>
<td>dataset3</td>
<td style="text-align:center">feature3</td>
</tr>
<tr>
<td>è®­ç»ƒé›†1</td>
<td>dataset2</td>
<td style="text-align:center">feature2</td>
</tr>
<tr>
<td>è®­ç»ƒé›†2</td>
<td>dataset1</td>
<td style="text-align:center">feature1</td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢è¿™ä¸ªè¡¨æ ¼å¾ˆæ¸…æ™°åœ°è¯´æ˜äº†åŸä½œè€…åˆ’åˆ†æ•°æ®çš„æ–¹æ³•.</p>
<h3 id="æºç åˆ†æ-1">4.1.1. æºç åˆ†æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#dataset3å­˜æ”¾table3 çš„æ•°æ®</span></div><div class="line">dataset3 = off_test </div><div class="line"></div><div class="line"><span class="comment">#feature3å­˜æ”¾ï¼šç­›å‡ºoff_trainä¸­ï¼Œä»¥ä¸‹å››ç§æƒ…å†µï¼š</span></div><div class="line"><span class="comment">#æ¶ˆè´¹æ—¥æœŸdataåœ¨20160315-20160630çš„ï¼Œ</span></div><div class="line"><span class="comment">#æˆ–æ¶ˆè´¹æ—¥æœŸä¸ºç©ºä¸”é¢†åˆ¸æ—¥æœŸåœ¨20160315-20160630çš„ï¼Œ</span></div><div class="line">feature3 = off_train[</div><div class="line">((off_train.date&gt;=<span class="string">'20160315'</span>)&amp;(off_train.date&lt;=<span class="string">'20160630'</span>))</div><div class="line">|((off_train.date==<span class="string">'null'</span>)&amp;(off_train.date_received&gt;=<span class="string">'20160315'</span>)&amp;(off_train.date_received&lt;=<span class="string">'20160630'</span>))]</div><div class="line"></div><div class="line"><span class="comment">#dataset2å­˜æ”¾ï¼šä»off_trainç­›å‡ºï¼šé¢†åˆ¸æ—¶æœŸåœ¨20160515-20160615ä¹‹é—´çš„</span></div><div class="line">dataset2 = off_train[</div><div class="line">(off_train.date_received&gt;=<span class="string">'20160515'</span>)&amp;off_train.date_received&lt;=<span class="string">'20160615'</span>)]</div><div class="line"></div><div class="line"><span class="comment">#feature2å­˜æ”¾ï¼šä»off_trainç­›å‡ºï¼š</span></div><div class="line"><span class="comment">#æ¶ˆè´¹æ—¥æœŸåœ¨20160201-20160514çš„ï¼Œ</span></div><div class="line"><span class="comment">#æˆ–é¢†åˆ¸æ—¥æœŸåœ¨20160201-20160514ä½†æ²¡æœ‰æ¶ˆè´¹çš„</span></div><div class="line">feature2 = off_train[(off_train.date&gt;=<span class="string">'20160201'</span>)&amp;(off_train.date&lt;=<span class="string">'20160514'</span>)|((off_train.date==<span class="string">'null'</span>)&amp;(off_train.date_received&gt;=<span class="string">'20160201'</span>)&amp;(off_train.date_received&lt;=<span class="string">'20160514'</span>))]</div><div class="line"></div><div class="line"><span class="comment">#dataset1å­˜æ”¾ï¼šä»off_trainç­›å‡ºï¼š é¢†åˆ¸æ—¥æœŸåœ¨20160414-20160514çš„</span></div><div class="line">dataset1 = off_train[(off_train.date_received&gt;=<span class="string">'20160414'</span>)&amp;(off_train.date_received&lt;=<span class="string">'20160514'</span>)]</div><div class="line"></div><div class="line"><span class="comment">#feature1å­˜æ”¾ï¼šä»off_trainç­›å‡ºï¼š</span></div><div class="line"><span class="comment">#æ¶ˆè´¹æ—¥æœŸåœ¨20160101-20160413çš„ï¼Œæˆ–</span></div><div class="line"><span class="comment">#é¢†åˆ¸æ—¥æœŸåœ¨20160101-20160413ä½†æ²¡æœ‰æ¶ˆè´¹çš„</span></div><div class="line">feature1 = off_train[(off_train.date&gt;=<span class="string">'20160101'</span>)&amp;(off_train.date&lt;=<span class="string">'20160413'</span>)|((off_train.date==<span class="string">'null'</span>)&amp;(off_train.date_received&gt;=<span class="string">'20160101'</span>)&amp;(off_train.date_received&lt;=<span class="string">'20160413'</span>))]</div></pre></td></tr></table></figure>
<h2 id="å…¶ä»–ç‰¹å¾">4.2. å…¶ä»–ç‰¹å¾</h2><h3 id="other-feature3">4.2.1. other_feature3</h3><table>
<thead>
<tr>
<th></th>
<th style="text-align:right">å†…å®¹ï¼ˆéƒ½æ˜¯æ¥è‡ªæµ‹è¯•é›†dataset3çš„æ•°æ®ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>t</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸çš„æ€»æ¬¡æ•°</td>
</tr>
<tr>
<td>t1</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¸åŒä¼˜æƒ åˆ¸çš„æ¬¡æ•°</td>
</tr>
<tr>
<td>t2</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·ä½¿ç”¨æŸå¼ ä¼˜æƒ åˆ¸ï¼ˆä½¿ç”¨æ¬¡æ•°å¤§äº1æ¬¡ï¼‰çš„é¦–æ¬¡å’Œæœ«æ¬¡ä½¿ç”¨æ—¶é—´</td>
</tr>
<tr>
<td>t3</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·ç”¨ä¼˜æƒ åˆ¸dateï¼›æœ¬ä¼˜æƒ åˆ¸é¦–ã€æœ«æ¬¡é—´éš”ï¼›æœ¬ä¼˜æƒ åˆ¸é¦–/æœ«æ¬¡ä½¿ç”¨date</td>
</tr>
<tr>
<td>t4</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·æ¯å¤©ä½¿ç”¨ä¼˜æƒ åˆ¸çš„æ¬¡æ•°</td>
</tr>
<tr>
<td>t5</td>
<td style="text-align:right">æ¯ä¸ªç”¨æˆ·æ¯å¤©ä½¿ç”¨æ¯å¼ ä¼˜æƒ åˆ¸çš„æ¬¡æ•°</td>
</tr>
<tr>
<td>t6</td>
<td style="text-align:right">ç”¨æˆ·ä½¿ç”¨æ¯å¼ ä¼˜æƒ åˆ¸çš„dateï¼Œä¸åŒdateç”¨å†’å·åˆ†éš”</td>
</tr>
<tr>
<td>t7</td>
<td style="text-align:right">ç”¨æˆ·ä½¿ç”¨æ¯å¼ åˆ¸çš„æ—¶é—´ï¼Œä»¥åŠå’Œå‰ã€åä¸€å¼ åˆ¸çš„æ—¶é—´é—´éš”</td>
</tr>
</tbody>
</table>
<p>æ–‡ä»¶åï¼šdata/other_feature3.csv</p>
<p>æ ¼å¼ï¼šuser_id,coupon_id,this_month_user_receive_same_coupon_count,this_month_user_receive_all_coupon_count,date_received,this_month_user_receive_same_coupon_lastone,this_month_user_receive_same_coupon_firstone,this_day_user_receive_all_coupon_count,this_day_user_receive_same_coupon_count,day_gap_before,day_gap_after</p>
<p>è§£é‡Šï¼šç”¨æˆ·id,ä¼˜æƒ åˆ¸id,æœ¬æœˆç”¨æˆ·ä½¿ç”¨æœ¬åˆ¸æ¬¡æ•°ï¼Œæœ¬æœˆç”¨æˆ·ä½¿ç”¨æ‰€æœ‰åˆ¸æ¬¡æ•°ï¼Œä½¿ç”¨æ—¶é—´ï¼Œæœ¬æœˆç”¨æˆ·ä½¿ç”¨æœ¬åˆ¸æœ«æ¬¡æ—¶é—´ã€é¦–æ¬¡æ—¶é—´ï¼Œæœ¬æ—¥ç”¨æˆ·ç”¨åˆ¸æ€»æ•°ï¼Œæœ¬æ—¥ç”¨æˆ·ç”¨æœ¬åˆ¸æ€»æ•°ï¼Œä¸Šæ¬¡ç”¨æœ¬åˆ¸é—´éš”ï¼Œä¸‹æ¬¡ç”¨æœ¬åˆ¸é—´éš”</p>
<h4 id="æºç åˆ†æ-2">4.2.1.1. æºç åˆ†æ</h4><p>t:è®¡ç®—æ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸çš„æ€»æ¬¡æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#å°†æµ‹è¯•é›†dataset3çš„useridå­˜åœ¨tä¸­</span></div><div class="line">t = dataset3[[<span class="string">'user_id'</span>]]</div><div class="line"><span class="comment">#ç»™tæ·»åŠ ä¸€ä¸ªåˆ—ï¼Œåˆ—åæ˜¯this_month_user_receive_all_coupon_countï¼Œå€¼éƒ½æ˜¯1</span></div><div class="line">t[<span class="string">'this_month_user_receive_all_coupon_count'</span>] = <span class="number">1</span></div><div class="line"><span class="comment">#æŒ‰ç…§user_idåˆ†ç»„ï¼Œå°†user_idé‡å¤çš„é¡¹ç›®çš„this_month_user_receive_all_coupon_countç›¸åŠ ï¼Œç„¶åè¿›è¡Œreset_index</span></div><div class="line"><span class="comment">#å…¶å®å°±æ˜¯ç®—å‡ºæ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸çš„æ€»æ¬¡æ•°</span></div><div class="line">t = t.groupby(<span class="string">'user_id'</span>).agg(<span class="string">'sum'</span>).reset_index()</div></pre></td></tr></table></figure>
<p>t1:ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·ï¼Œä½¿ç”¨ä¸åŒä¼˜æƒ åˆ¸çš„æ¬¡æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">t1 = dataset3[[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>]]</div><div class="line">t1[<span class="string">'this_month_user_receive_same_coupon_count'</span>] = <span class="number">1</span></div><div class="line"><span class="comment">#æŒ‰ç…§user_idå’Œcoupon_idè¿›è¡Œåˆ†ç»„</span></div><div class="line"><span class="comment">#ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·ï¼Œä½¿ç”¨ä¸åŒä¼˜æƒ åˆ¸çš„æ¬¡æ•°</span></div><div class="line">t1 = t1.groupby([<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>]).agg(<span class="string">'sum'</span>).reset_index()</div></pre></td></tr></table></figure>
<p>t2:æ‰¾å‡ºæ¯ä¸ªäººï¼Œæ¶ˆè´¹æ¯ä¸ªåˆ¸çš„æ—¶é—´ï¼Œå¹¶ç”¨å†’å·åˆ†éš”ä¾‹å¦‚ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-09-20-10-27.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">t2 = dataset3[[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'date_received'</span>]]</div><div class="line">t2.date_received = t2.date_received.astype(<span class="string">'str'</span>)</div><div class="line"><span class="comment"># æŒ‰ç…§user_id','coupon_idæ’åºåï¼Œæå‡ºæ¥date_receivedï¼Œè¿›è¡Œaggè¿ç®—</span></div><div class="line"><span class="comment"># aggè¿ç®—ï¼šç”¨å†’å·è¿æ¥èµ·æ¥</span></div><div class="line">t2 = t2.groupby([<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>])[<span class="string">'date_received'</span>].agg(<span class="keyword">lambda</span> x:<span class="string">':'</span>.join(x)).reset_index()</div></pre></td></tr></table></figure>
<p>t2:æ¯ä¸ªç”¨æˆ·ä½¿ç”¨æŸå¼ ä¼˜æƒ åˆ¸ï¼ˆä½¿ç”¨æ¬¡æ•°å¤§äº1æ¬¡ï¼‰çš„é¦–æ¬¡å’Œæœ«æ¬¡ä½¿ç”¨æ—¶é—´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#applyä¼šè¿”å›æ¯ä¸ªä¼˜æƒ åˆ¸çš„ä½¿ç”¨æ¬¡æ•°</span></div><div class="line">t2[<span class="string">'receive_number'</span>] = t2.date_received.apply(<span class="keyword">lambda</span> s:len(s.split(<span class="string">':'</span>)))</div><div class="line"><span class="comment">#ç­›å‡ºä½¿ç”¨æ¬¡æ•°å¤§äº1æ¬¡çš„æ•°æ®</span></div><div class="line">t2 = t2[t2.receive_number&gt;<span class="number">1</span>]</div><div class="line"><span class="comment">#å¯¹max_date_receivedèµ‹å€¼ä¸ºæœ€è¿‘ä¸€æ¬¡çš„ä½¿ç”¨æ—¶é—´</span></div><div class="line">t2[<span class="string">'max_date_received'</span>] = t2.date_received.apply(<span class="keyword">lambda</span> s:max([int(d) <span class="keyword">for</span> d <span class="keyword">in</span> s.split(<span class="string">':'</span>)]))</div><div class="line"><span class="comment">#å¯¹min_date_receivedèµ‹å€¼ä¸ºæœ€æ—©ä¸€æ¬¡çš„ä½¿ç”¨æ—¶é—´</span></div><div class="line">t2[<span class="string">'min_date_received'</span>] = t2.date_received.apply(<span class="keyword">lambda</span> s:min([int(d) <span class="keyword">for</span> d <span class="keyword">in</span> s.split(<span class="string">':'</span>)]))</div><div class="line"><span class="comment"># é‡æ–°å®šä¹‰t2ä¸ºä»¥ä¸‹é¡¹ç›®</span></div><div class="line">t2 = t2[[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'max_date_received'</span>,<span class="string">'min_date_received'</span>]]</div></pre></td></tr></table></figure>
<p>t3:æ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸çš„æ—¶é—´ã€æœ¬æ¬¡ä¼˜æƒ åˆ¸ä¸é¦–æ¬¡ä½¿ç”¨çš„é—´éš”ã€æœ«æ¬¡ä½¿ç”¨çš„é—´éš”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">t3 = dataset3[[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'date_received'</span>]]</div><div class="line"><span class="comment">#mergeï¼Œå°†ä¸¤ä¸ªæ•°æ®é›†åˆå¹¶</span></div><div class="line"><span class="comment">#å°†t2å’Œt3åœ¨['user_id','coupon_id']ä¸Šè¿›è¡Œå·¦å¸§åˆå¹¶ï¼Œå³æ ¹æ®t3åˆå¹¶t2çš„user_id','coupon_id</span></div><div class="line"><span class="comment">#t2[['user_id','coupon_id','max_date_received','min_date_received']]</span></div><div class="line"><span class="comment">#t3[['user_id','coupon_id','date_received']]</span></div><div class="line"><span class="comment">#å› æ­¤åˆå¹¶æ–¹å¼ä¸ºï¼šæ‰¾åˆ°æ¯ä¸ªç”¨æˆ·æ¯å¼ ä¼˜æƒ åˆ¸çš„æ¶ˆè´¹æ—¶é—´å’Œå¯¹åº”åˆ¸çš„max_date_receivedä¸min_date_received</span></div><div class="line">t3 = pd.merge(t3,t2,on=[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>],how=<span class="string">'left'</span>)</div><div class="line"><span class="comment">#t3çš„this_month_user_receive_same_coupon_lastoneé¡¹ç›®è®¾ç½®ä¸º:æ­¤ç”¨æˆ·æ¶ˆè´¹æœ¬å¼ ä¼˜æƒ åˆ¸ä¸æœ€è¿‘ä¸€æ¬¡æ¶ˆè´¹æœ¬å¼ ä¼˜æƒ åˆ¸çš„é—´éš”</span></div><div class="line"></div><div class="line">t3 = t3.apply(pd.to_numeric, args=(<span class="string">'coerce'</span>,))</div><div class="line">t3[<span class="string">'this_month_user_receive_same_coupon_lastone'</span>] = t3.max_date_received - t3.date_received</div><div class="line"><span class="comment">#æ­¤ç”¨æˆ·æ¶ˆè´¹æœ¬å¼ ä¼˜æƒ åˆ¸ä¸ç¬¬ä¸€æ¬¡æ¶ˆè´¹æœ¬å¼ ä¼˜æƒ åˆ¸çš„é—´éš”</span></div><div class="line">t3[<span class="string">'this_month_user_receive_same_coupon_firstone'</span>] = t3.date_received - t3.min_date_received</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è·‘åˆ°<code>t3[&#39;this_month_user_receive_same_coupon_lastone&#39;] = t3.max_date_received - t3.date_received</code>çš„æ—¶å€™ä¼šå‡ºç°<code>TypeError: unsupported operand type(s) for -: &#39;float&#39; and &#39;str&#39;</code>.</p>
<p>åœ¨æ‰§è¡Œè¿™å¥è¯ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹åˆ°<code>t3.date_received</code>çš„ç±»å‹ä¸º<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-09-22-39-21.png" alt=""> </p>
<p>å› æ­¤æˆ‘ä»¬éœ€è¦å°†æ•°æ®ç±»å‹å…ˆè½¬æ¢ä¸ºfloatã€‚åœ¨ç½‘ä¸ŠæŸ¥åˆ°æœ¬æ–¹æ³•å¯¹æœ¬ä»£ç æœ‰æ•ˆï¼ˆæš‚ä¸çŸ¥åŸå› ï¼‰ã€‚<a href="http://stackoverflow.com/questions/14450020/unsupported-operand-in-pandas-dataframe-operation" target="_blank" rel="external">å‚è€ƒæ–‡çŒ®</a></p>
<p><code>t3 = t3.apply(pd.anumeric, args=(&#39;coerce&#39;,))</code></p>
<p>æŠŠè¿™å¥è¯åŠ ä¸Šåï¼Œæˆ‘ä»¬çœ‹åˆ°<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-09-22-43-02.png" alt=""> </p>
<p>å®šä¹‰å‡½æ•°is_firstlastoneåˆ¤æ–­ä¼˜æƒ åˆ¸æ˜¯å¦æ˜¯æœ«æ¬¡ä½¿ç”¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_firstlastone</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">if</span> x==<span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    <span class="keyword">elif</span> x&gt;<span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span> <span class="comment">#those only receive once</span></div></pre></td></tr></table></figure>
<p>t3:åŠ ä¸Šä¸¤ä¸ªæ•°æ®ï¼Œâ€¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">t3.this_month_user_receive_same_coupon_lastone = t3.this_month_user_receive_same_coupon_lastone.apply(is_firstlastone)</div><div class="line">t3.this_month_user_receive_same_coupon_firstone = t3.this_month_user_receive_same_coupon_firstone.apply(is_firstlastone)</div><div class="line">t3 = t3[[<span class="string">'user_id'</span>,<span class="string">'coupon_id'</span>,<span class="string">'date_received'</span>,<span class="string">'this_month_user_receive_same_coupon_lastone'</span>,<span class="string">'this_month_user_receive_same_coupon_firstone'</span>]]</div></pre></td></tr></table></figure>
<p>åé¢å¥—è·¯å·®ä¸å¤šï¼Œæ­¤å¤„ä¸å†ç»§ç»­åˆ†æã€‚ä¸»è¦ç»“è®ºå·²ç»æ€»ç»“åœ¨ä¸Šè¡¨ä¸­ã€‚</p>
<h1 id="åˆå¹¶ç‰¹å¾">5. åˆå¹¶ç‰¹å¾</h1><h2 id="ç”Ÿæˆè®­ç»ƒé›†">5.1. ç”Ÿæˆè®­ç»ƒé›†</h2><pre><code>coupon2 = pd.read_csv(&apos;data/coupon2_feature.csv&apos;)
merchant2 = pd.read_csv(&apos;data/merchant2_feature.csv&apos;)
user2 = pd.read_csv(&apos;data/user2_feature.csv&apos;)
user_merchant2 = pd.read_csv(&apos;data/user_merchant2.csv&apos;)
other_feature2 = pd.read_csv(&apos;data/other_feature2.csv&apos;)
#dataset2æ˜¯æ ¹æ® ä¼˜æƒ åˆ¸ç‰¹å¾ åˆå¹¶å•†æˆ·ã€ç”¨æˆ·ã€ç”¨æˆ·-å•†æˆ·ã€å…¶ä»–ç‰¹å¾
dataset2 = pd.merge(coupon2,merchant2,on=&apos;merchant_id&apos;,how=&apos;left&apos;)
dataset2 = pd.merge(dataset2,user2,on=&apos;user_id&apos;,how=&apos;left&apos;)
dataset2 = pd.merge(dataset2,user_merchant2,on=[&apos;user_id&apos;,&apos;merchant_id&apos;],how=&apos;left&apos;)
dataset2 = pd.merge(dataset2,other_feature2,on=[&apos;user_id&apos;,&apos;coupon_id&apos;,&apos;date_received&apos;],how=&apos;left&apos;)
dataset2.drop_duplicates(inplace=True)
print dataset2.shape
dataset2.user_merchant_buy_total = dataset2.user_merchant_buy_total.replace(np.nan,0)
dataset2.user_merchant_any = dataset2.user_merchant_any.replace(np.nan,0)
dataset2.user_merchant_received = dataset2.user_merchant_received.replace(np.nan,0)
dataset2[&apos;is_weekend&apos;] = dataset2.day_of_week.apply(lambda x:1 if x in (6,7) else 0)
weekday_dummies = pd.get_dummies(dataset2.day_of_week)
weekday_dummies.columns = [&apos;weekday&apos;+str(i+1) for i in range(weekday_dummies.shape[1])]
dataset2 = pd.concat([dataset2,weekday_dummies],axis=1)
dataset2[&apos;label&apos;] = dataset2.date.astype(&apos;str&apos;) + &apos;:&apos; +  dataset2.date_received.astype(&apos;str&apos;)
dataset2.label = dataset2.label.apply(get_label)
dataset2.drop([&apos;merchant_id&apos;,&apos;day_of_week&apos;,&apos;date&apos;,&apos;date_received&apos;,&apos;coupon_id&apos;,&apos;coupon_count&apos;],axis=1,inplace=True)
dataset2 = dataset2.replace(&apos;null&apos;,np.nan)
dataset2.to_csv(&apos;data/dataset2.csv&apos;,index=None)


coupon1 = pd.read_csv(&apos;data/coupon1_feature.csv&apos;)
merchant1 = pd.read_csv(&apos;data/merchant1_feature.csv&apos;)
user1 = pd.read_csv(&apos;data/user1_feature.csv&apos;)
user_merchant1 = pd.read_csv(&apos;data/user_merchant1.csv&apos;)
other_feature1 = pd.read_csv(&apos;data/other_feature1.csv&apos;)
dataset1 = pd.merge(coupon1,merchant1,on=&apos;merchant_id&apos;,how=&apos;left&apos;)
dataset1 = pd.merge(dataset1,user1,on=&apos;user_id&apos;,how=&apos;left&apos;)
dataset1 = pd.merge(dataset1,user_merchant1,on=[&apos;user_id&apos;,&apos;merchant_id&apos;],how=&apos;left&apos;)
dataset1 = pd.merge(dataset1,other_feature1,on=[&apos;user_id&apos;,&apos;coupon_id&apos;,&apos;date_received&apos;],how=&apos;left&apos;)
dataset1.drop_duplicates(inplace=True)
print dataset1.shape

dataset1.user_merchant_buy_total = dataset1.user_merchant_buy_total.replace(np.nan,0)
dataset1.user_merchant_any = dataset1.user_merchant_any.replace(np.nan,0)
dataset1.user_merchant_received = dataset1.user_merchant_received.replace(np.nan,0)
dataset1[&apos;is_weekend&apos;] = dataset1.day_of_week.apply(lambda x:1 if x in (6,7) else 0)
weekday_dummies = pd.get_dummies(dataset1.day_of_week)
weekday_dummies.columns = [&apos;weekday&apos;+str(i+1) for i in range(weekday_dummies.shape[1])]
dataset1 = pd.concat([dataset1,weekday_dummies],axis=1)
dataset1[&apos;label&apos;] = dataset1.date.astype(&apos;str&apos;) + &apos;:&apos; +  dataset1.date_received.astype(&apos;str&apos;)
dataset1.label = dataset1.label.apply(get_label)
dataset1.drop([&apos;merchant_id&apos;,&apos;day_of_week&apos;,&apos;date&apos;,&apos;date_received&apos;,&apos;coupon_id&apos;,&apos;coupon_count&apos;],axis=1,inplace=True)
dataset1 = dataset1.replace(&apos;null&apos;,np.nan)
dataset1.to_csv(&apos;data/dataset1.csv&apos;,index=None)
</code></pre><h2 id="ç”Ÿæˆé¢„æµ‹é›†">5.2. ç”Ÿæˆé¢„æµ‹é›†</h2><pre><code>coupon3 = pd.read_csv(&apos;data/coupon3_feature.csv&apos;)
merchant3 = pd.read_csv(&apos;data/merchant3_feature.csv&apos;)
user3 = pd.read_csv(&apos;data/user3_feature.csv&apos;)
user_merchant3 = pd.read_csv(&apos;data/user_merchant3.csv&apos;)
other_feature3 = pd.read_csv(&apos;data/other_feature3.csv&apos;)
dataset3 = pd.merge(coupon3,merchant3,on=&apos;merchant_id&apos;,how=&apos;left&apos;)
dataset3 = pd.merge(dataset3,user3,on=&apos;user_id&apos;,how=&apos;left&apos;)
dataset3 = pd.merge(dataset3,user_merchant3,on=[&apos;user_id&apos;,&apos;merchant_id&apos;],how=&apos;left&apos;)
dataset3 = pd.merge(dataset3,other_feature3,on=[&apos;user_id&apos;,&apos;coupon_id&apos;,&apos;date_received&apos;],how=&apos;left&apos;)
dataset3.drop_duplicates(inplace=True)
print dataset3.shape

dataset3.user_merchant_buy_total = dataset3.user_merchant_buy_total.replace(np.nan,0)
dataset3.user_merchant_any = dataset3.user_merchant_any.replace(np.nan,0)
dataset3.user_merchant_received = dataset3.user_merchant_received.replace(np.nan,0)
dataset3[&apos;is_weekend&apos;] = dataset3.day_of_week.apply(lambda x:1 if x in (6,7) else 0)
weekday_dummies = pd.get_dummies(dataset3.day_of_week)
weekday_dummies.columns = [&apos;weekday&apos;+str(i+1) for i in range(weekday_dummies.shape[1])]
dataset3 = pd.concat([dataset3,weekday_dummies],axis=1)
dataset3.drop([&apos;merchant_id&apos;,&apos;day_of_week&apos;,&apos;coupon_count&apos;],axis=1,inplace=True)
dataset3 = dataset3.replace(&apos;null&apos;,np.nan)
dataset3.to_csv(&apos;data/dataset3.csv&apos;,index=None)
</code></pre><h1 id="é™„å½•">6. é™„å½•</h1><h2 id="æŸ¥çœ‹dataFrameç±»å‹çš„å†…å®¹">6.1. æŸ¥çœ‹dataFrameç±»å‹çš„å†…å®¹</h2><p>è§pandas æ–‡æ¡£ä¹‹ 10 minutes to pandas â€” viewing data</p>
<p>ç”¨t.values,t.columns</p>
<h2 id="lambda-functions">6.2. lambda functions</h2><p>æºä»£ç ä¸­æœ‰ä¸€è¡Œ<code>t2.groupby([&#39;user_id&#39;,&#39;coupon_id&#39;])[&#39;date_received&#39;].agg(lambda x:&#39;:&#39;.join(x)).reset_index()</code></p>
<p><a href="http://www.diveintopython.net/power_of_introspection/lambda_functions.html" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a></p>
<p><code>lambda functions</code>æ˜¯pythonçš„ä¸€ä¸ªfunction.<br>ç”¨ä¾‹ï¼š</p>
<pre><code>#å‡½æ•°f(x)
&gt;&gt;&gt; def f(x):
...     return x*2
...
&gt;&gt;&gt; f(3) #è¾“å…¥x=3     
6 #è¾“å‡º6

#f(x)ç­‰ä»·äºï¼š
&gt;&gt;&gt; g = lambda x: x*2  1
&gt;&gt;&gt; g(3)
6
#f(x)è¿˜ç­‰ä»·äºï¼š
&gt;&gt;&gt; (lambda x: x*2)(3) 2
6
</code></pre><p>ä½œè€…ä»£ç ä¸­ï¼Œæœ‰ä¸€è¡Œ<br><code>lambda x:&#39;:&#39;.join(x)</code>å³å°†å‰åå åŠ ,ç”¨<code>:</code>è¿æ¥<br><code>t2.groupby([&#39;user_id&#39;,&#39;coupon_id&#39;])[&#39;date_received&#39;].agg(lambda x:&#39;:&#39;.join(x)).reset_index()</code>æ„æ€æ˜¯å°†æ•°æ®é›†å…ˆæŒ‰ç…§user_idâ€™,â€™coupon_idæ’åºï¼Œç„¶åå¯¹date_receivedè¿›è¡Œç”¨:è¿æ¥ä¸€èµ·æ¥</p>
<p>ä¾‹å¦‚ï¼Œè¾“å…¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span> : [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>,</div><div class="line">                            <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>],</div><div class="line">                            <span class="string">'B'</span> : [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>,</div><div class="line">                             <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'three'</span>],</div><div class="line">                            <span class="string">'C'</span> : np.random.randn(<span class="number">8</span>),</div><div class="line">                            <span class="string">'D'</span> : np.random.randn(<span class="number">8</span>)&#125;)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>i</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
<th style="text-align:right">C</th>
<th style="text-align:right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">0.754147</td>
<td style="text-align:right">0.912176</td>
</tr>
<tr>
<td>1</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">one</td>
<td style="text-align:right">1.414635</td>
<td style="text-align:right">-0.760638</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.142930</td>
<td style="text-align:right">-1.290766</td>
</tr>
<tr>
<td>3</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">three</td>
<td style="text-align:right">1.196999</td>
<td style="text-align:right">1.647513</td>
</tr>
<tr>
<td>4</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">two</td>
<td style="text-align:right">-0.261663</td>
<td style="text-align:right">1.284779</td>
</tr>
<tr>
<td>5</td>
<td style="text-align:right">bar</td>
<td style="text-align:right">two</td>
<td style="text-align:right">1.622070</td>
<td style="text-align:right">1.685648</td>
</tr>
<tr>
<td>6</td>
<td style="text-align:right">foo</td>
<td style="text-align:right">one</td>
<td style="text-align:right">1.478855</td>
<td style="text-align:right">-0.229636</td>
</tr>
</tbody>
</table>
<pre><code>df3 = df.groupby([&apos;A&apos;])[&apos;B&apos;].agg(lambda x:&apos;:&apos;.join(x)).reset_index()
</code></pre><p>è¾“å‡ºï¼š</p>
<table>
<thead>
<tr>
<th>i</th>
<th style="text-align:right">A</th>
<th style="text-align:right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:right">bar</td>
<td style="text-align:right"><code>one:three:two</code></td>
</tr>
<tr>
<td>1</td>
<td style="text-align:right">foo</td>
<td style="text-align:right"><code>one:two:two:one:three</code></td>
</tr>
</tbody>
</table>
<h2 id="pandasçš„mergeçš„howå‚æ•°">6.3. pandasçš„mergeçš„howå‚æ•°</h2><p>åŸä»£ç å‡ºç°äº†<code>t3 = pd.merge(t3,t2,on=[&#39;user_id&#39;,&#39;coupon_id&#39;],how=&#39;left&#39;)</code></p>
<p>howå‚æ•°ä¸»è¦å†³å®šäº†å“ªä¸€ä¸ªkeysä¼šè¢«åŒ…å«åœ¨ç»“æœè¡¨ä¸­ã€‚å®ƒçš„å€¼æœ‰å››ç§å¯èƒ½æ€§ï¼š<code>left,right,outer,inner</code>ã€‚æˆ‘ä»¬ä¸»è¦çœ‹<code>leftå’Œright</code></p>
<p>how=â€™leftâ€™:éå†leftè¡¨ï¼Œæ‰¾ä¸rightä¸€æ ·çš„ï¼Œä¾æ¬¡æ”¾å…¥è¡Œã€‚ å¦‚æœæ²¡æœ‰ï¼Œåˆ™è®¾ä¸ºNAN</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-09-20-34-44.png" alt=""> </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-09-20-33-13.png" alt=""> </p>
<p>å› æ­¤<code>t3 = pd.merge(t3,t2,on=[&#39;user_id&#39;,&#39;coupon_id&#39;],how=&#39;left&#39;)</code>çš„æ„æ€æ˜¯ï¼š</p>
<p>æ ¹æ®t3åˆå¹¶t2çš„user_idâ€™,â€™coupon_id</p>
]]></content>
      
        <categories>
            
            <category> o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æ¢¯åº¦æå‡å†³ç­–æ ‘ AdaBoost DecisonTree]]></title>
      <url>/2017/03/06/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%A2%AF%E5%BA%A6%E6%8F%90%E5%8D%87%E5%86%B3%E7%AD%96%E6%A0%91%20AdaBoost%20DecisonTree/</url>
      <content type="html"><![CDATA[<p>ä¸Šä¸€èŠ‚ä¸­ä»‹ç»äº†ã€Šéšæœºæ£®æ—ç®—æ³•ã€‹ï¼Œè¯¥ç®—æ³•ä½¿ç”¨baggingçš„æ–¹å¼ä½œå‡ºä¸€äº›å†³ç­–æ ‘æ¥ï¼ŒåŒæ—¶åœ¨å†³ç­–æ ‘çš„å­¦ä¹ è¿‡ç¨‹ä¸­åŠ å…¥äº†æ›´å¤šçš„éšæœºå› ç´ ã€‚è¯¥æ¨¡å‹å¯ä»¥è‡ªåŠ¨åšåˆ°éªŒè¯è¿‡ç¨‹åŒæ—¶è¿˜å¯ä»¥è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚ </p>
<p>æœ¬èŠ‚ï¼Œæˆ‘ä»¬ç»“åˆ<code>AdaBoost+å†³ç­–æ ‘</code>ç®—æ³•ã€‚</p>
<h1 id="AdaBoostå†³ç­–æ ‘ç®—æ³•å¼•å…¥">1. AdaBoostå†³ç­–æ ‘ç®—æ³•å¼•å…¥</h1><p>åœ¨AdaBoostä¸­æ¯ä¸€è½®è¿­ä»£ï¼Œéƒ½ä¼šç»™æ•°æ®æ›´æ–°ä¸€ä¸ªæƒé‡ï¼Œåˆ©ç”¨è¿™ä¸ªæƒé‡ï¼Œæˆ‘ä»¬å­¦ä¹ å¾—åˆ°ä¸€ä¸ªgï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå†³ç­–æ ‘ï¼Œæœ€ç»ˆåˆ©ç”¨çº¿æ€§ç»„åˆçš„æ–¹å¼å¾—åˆ°å¤šä¸ªå†³ç­–æ ‘ç»„æˆçš„Gã€‚</p>
<p>=======================================<br><strong>AdaBoost-DTree(DD)</strong><br>å¯¹äºt=1,2,â€¦,Tï¼Œå¾ªç¯æ‰§è¡Œï¼š</p>
<ul>
<li>æ›´æ–°æ•°æ®çš„æƒé‡$u(t)$ï¼›</li>
<li>é€šè¿‡å†³ç­–æ ‘ç®—æ³•$DTree(D,u(t))$å¾—åˆ°$g_t$ï¼›</li>
<li>è®¡ç®—$g_t$çš„æŠ•ç¥¨æƒé‡$Î±_t$ã€‚</li>
</ul>
<p>è¿”å›$G=LinearHypo({(g_t,Î±_t)})$ã€‚</p>
<p>========================================</p>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•è¦åœ¨å†³ç­–æ ‘ä¸­ï¼ŒåŠ å…¥æƒé‡<code>ut</code></p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>ä¸€ç§æ˜¯é€šè¿‡ç®—æ³•åŠ æƒï¼Œåœ¨è®¡ç®—Einçš„åœ°æ–¹åµŒå…¥æƒé‡è®¡ç®—ï¼Œæ¯”å¦‚AdaBoosté‡‡ç”¨çš„æœ€å°åŒ–åŠ æƒè¯¯å·®ï¼›</li>
<li>å¦ä¸€ç§æ–¹æ³•æ˜¯å°†ç®—æ³•å½“æˆé»‘ç›’ä¸å˜æ›´ï¼Œé€šè¿‡æ•°æ®é›†åŠ æƒï¼Œæ ¹æ®æƒé‡åœ¨bootstrapæ—¶â€œå¤åˆ¶â€æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åŠ æƒçš„é‡é‡‡æ ·ã€‚</li>
</ul>
<p>AdaBoostå†³ç­–æ ‘é€šå¸¸ç”¨åä¸€ç§ï¼Œå³ï¼š$AdaBoost+samplingâˆu^{(t)}+DTree(D_t) $</p>
<h1 id="åŠ æƒçš„å†³ç­–æ ‘ç®—æ³•-Weighted-Decision-Tree-Algorithm">2. åŠ æƒçš„å†³ç­–æ ‘ç®—æ³•(Weighted Decision Tree Algorithm)</h1><p> ä¹‹å‰å«æœ‰æƒé‡çš„ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬åœ¨è¯¯å·®ä¼°è®¡ä¸­åŠ å…¥äº†æƒé‡<code>u</code>ï¼š</p>
<p> <img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-09-46-47.png" alt=""> </p>
<p>ä¸ºäº†å¯¹å†³ç­–æ ‘ä¸­åŠ å…¥æƒé‡ï¼Œä¸”ä¸æ”¹å˜åŸç®—æ³•çš„å¥å£®æ€§ï¼Œæˆ‘ä»¬è®¾æ³•å¯¹è¾“å…¥çš„<code>æ•°æ®</code>è¿›è¡Œ<code>æƒé‡åŠ æˆ</code>ã€‚è€Œæƒé‡ç­‰æ•ˆäºæ•°æ®çš„é‡å¤æ¬¡æ•°ã€‚æ ¹æ®è¿™ç§æ–¹å¼å¾—åˆ°ä¸€ç»„æ–°çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™ç»„æ–°çš„æ•°æ®ä¸­çš„æ¯”ä¾‹å¤§æ¦‚å°±æ˜¯å’Œæƒé‡çš„æ¯”ä¾‹å‘ˆæ­£æ¯”çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½å¤Ÿè¡¨è¾¾æƒé‡å¯¹äºæ•°æ®çš„æ„ä¹‰ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-09-54-14.png" alt=""> </p>
<p>åœ¨AdaBoost-DTreeä¸­ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä¸å»æ”¹å˜AdaBoostçš„æ¡†æ¶ï¼Œä¹Ÿä¸å»ä¿®æ”¹å†³ç­–æ ‘çš„å†…éƒ¨ç»†èŠ‚ï¼Œè€Œåªæ˜¯é€šè¿‡åŸºäºæƒé‡çš„è®­ç»ƒæ•°æ®çš„é‡‡æ ·æ¥å®ç°ã€‚</p>
<p>å³å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ï¼šAdaBoostæå‡å†³ç­–æ ‘=AdaBoostæå‡+å…³äºæƒé‡uçš„æ•°æ®æŠ½æ ·+å†³ç­–æ ‘</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-09-54-50.png" alt=""> </p>
<h2 id="å¼±å†³ç­–æ ‘ç®—æ³•">2.1. å¼±å†³ç­–æ ‘ç®—æ³•</h2><p>åœ¨AdaBoostç®—æ³•ä¸­ï¼Œæˆ‘ä»¬<strong>é€šè¿‡é”™è¯¯ç‡<code>Îµt</code>æ¥è®¡ç®—å•ä¸ªçš„gçš„æƒé‡Î±t</strong>ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ä½¿ç”¨å†³ç­–æ ‘ä½œä¸ºgçš„æ—¶å€™ï¼Œgæ˜¯ä¸€ä¸ªå®Œå…¨é•¿æˆçš„æ ‘ï¼Œè¯¥æ ‘å¯¹æ•´ä¸ªæ•°æ®é›†è¿›è¡Œç»†è‡´çš„åˆ‡åˆ†å¯¼è‡´Ein=0ï¼Œé‚£ä¹ˆè¿™ä½¿å¾—Îµt=0ï¼Œä½†è®¡ç®—å¾—åˆ°çš„æƒé‡Î±tä¼šå˜æˆæ— é™å¤§ã€‚</p>
<p>å…¶æ„ä¹‰æ˜¯ï¼Œå¦‚æœä½¿ç”¨ä¸€ä¸ªèƒ½åŠ›å¾ˆå¼ºçš„æ ‘ä½œä¸ºgçš„è¯ï¼Œé‚£ä¹ˆè¯¥ç®—æ³•ä¼šèµ‹äºˆè¯¥æ ‘æ— é™å¤§çš„æƒé‡æˆ–ç¥¨æ•°ï¼Œæœ€ç»ˆå¾—åˆ°äº†ä¸€æ£µâ€œç‹¬è£â€çš„æ ‘ï¼ˆå› ä¸ºAdaBoostçš„å“²å­¦æ„ä¹‰æ˜¯åº¶æ°‘æ”¿æ²»ï¼Œå°±æ˜¯é›†ä¸­å¤šæ–¹çš„æ„è§ï¼ŒåŠæ—¶æœ‰çš„æ„è§å¯èƒ½æ˜¯é”™è¯¯çš„ï¼‰ï¼Œè¿èƒŒäº†AdaBoostçš„å®—æ—¨ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-09-59-58.png" alt=""> </p>
<p>ä¸Šé¢çš„é—®é¢˜å‡ºåœ¨ä½¿ç”¨äº†æ‰€æœ‰çš„æ•°æ®å’Œè®©æ ‘å®Œå…¨é•¿æˆè¿™ä¸¤æ–¹é¢ã€‚é’ˆå¯¹è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦é€šè¿‡<code>å‰ªæ</code>å’Œ<code>éƒ¨åˆ†è®­ç»ƒæ•°æ®</code>å¾—åˆ°ä¸€ä¸ªå¼±ä¸€ç‚¹çš„æ ‘ã€‚<br>æ‰€ä»¥å®é™…ä¸Šï¼ŒAdaBoost-DTreeæ˜¯é€šè¿‡samplingçš„æ–¹å¼å¾—åˆ°éƒ¨åˆ†è®­ç»ƒæ•°æ®ï¼Œé€šè¿‡å‰ªæçš„æ–¹å¼é™åˆ¶æ ‘çš„é«˜åº¦ï¼Œå¾—åˆ°å¼±ä¸€ç‚¹çš„å†³ç­–æ ‘ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-10-19-02.png" alt=""> </p>
<p>ä¸‹é¢ä»‹ç»æœ€å¼±çš„å†³ç­–æ ‘ã€‚</p>
<h2 id="å†³ç­–æ¡©ï¼ŒAdaBoost-Stump">2.2. å†³ç­–æ¡©ï¼ŒAdaBoost-Stump</h2><p>ä»€ä¹ˆæ ·æ˜¯æ ‘æ‰æ˜¯å¼±å†³ç­–æ ‘å‘¢ï¼Ÿ<br>æˆ‘ä»¬è¿™é‡Œé™åˆ¶è¿™æ£µæ ‘åªæœ‰ä¸€å±‚ï¼ˆå³å®ƒä»…åŸºäºå•ä¸ªç‰¹å¾æ¥åšå†³ç­–ï¼‰ï¼Œå³å†³ç­–æ¡©(Decision Stump)ã€‚è¿™æ ·æˆ‘ä»¬éœ€è¦è®©CARTæ ‘çš„ä¸çº¯åº¦(impurity)å°½å¯èƒ½ä½ï¼Œå­¦ä¹ ä¸€ä¸ªå†³ç­–æ¡©ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-10-21-14.png" alt=""> </p>
<p>æ‰€ä»¥ï¼Œä½¿ç”¨å†³ç­–æ¡©ä½œä¸ºå¼±åˆ†ç±»å™¨çš„AdaBoostç§°ä¸ºAdaBoost-Stumpï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„AdaBoost-DTreeã€‚</p>
<h2 id="å†³ç­–æ¡©çš„å®ç°">2.3. å†³ç­–æ¡©çš„å®ç°</h2><p>æœ¬èŠ‚ä¸»è¦å‚è€ƒã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹p120</p>
<h3 id="å®éªŒæ•°æ®adaboost-py">2.3.1. å®éªŒæ•°æ®adaboost.py</h3><pre><code>from numpy import *
def loadSimpData():
    dataMat = matrix([[1.,2.1],[2.,1.1],[1.3,1.],[1.,1.],[2.,1.]])
    classLabels = [1.0,1.0,-1.0,-1.0,1.0]
    return dataMat,classLabels
</code></pre><h3 id="äºŒåˆ†ç±»çš„å†³ç­–æ¡©å®ç°stump-py">2.3.2. äºŒåˆ†ç±»çš„å†³ç­–æ¡©å®ç°stump.py</h3><p>å…ˆå¯¼å…¥æ•°æ®</p>
<pre><code>import adaboost
dataMat,classLabels = adaboost.loadSimpData()
</code></pre><p>å»ºç«‹ä¸€ä¸ª<code>buidStump()</code>å‡½æ•°ï¼Œæ ¹æ®æ•°æ®é›†ï¼Œå»ºç«‹æœ€ä½³å•å±‚å†³ç­–æ ‘ï¼ˆåªéœ€è¦é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„ç‰¹å¾å³å¯ï¼‰</p>
<pre><code>def buildStump(dataArr,classLabels,D):
    dataMatrix = mat(dataArr)
    labelMat = mat(classLabels).T # Tæ˜¯åšè½¬ç½®
</code></pre><p><code>dataMatrix</code>å½¢å¼ä¸º<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-16-16-29-28.png" alt=""><br><code>labelMat</code>å½¢å¼ä¸º<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-16-16-29-39.png" alt=""> </p>
<p>å…ˆä»¤ä¸€äº›å˜é‡ï¼Œä¹‹åè§£é‡Šã€‚</p>
<pre><code>m,n = shape(dataMatrix)
numSteps = 10.0#æ­¥é•¿
bestStup = {}#æœ€ä½³æ¡©
bestClasEst = mat(zeros((m,1)))#æœ€ä½³åˆ†ç±»est
minError = inf
</code></pre><p>æ¥ä¸‹æ¥éœ€è¦å¯¹æ¯ä¸ªç‰¹å¾è®¡ç®—å‡ºä¸€ä¸ªé˜ˆå€¼<code>threshVal</code>ï¼Œæ ¹æ®é˜ˆå€¼äºŒåˆ†ç±»ã€‚</p>
<pre><code>for i in range(n): # éå†ç‰¹å¾ä¸ªæ•°
    #ä¸ºäº†ç¡®å®šthreshValï¼Œæˆ‘ä»¬ä»æœ¬ç‰¹å¾ä¸‹çš„æœ€å°å€¼åˆ°æœ€å¤§å€¼åˆ†10 stepè¿›è¡Œä¾æ¬¡æµ‹è¯•
    rangeMin = dataMatrix[:,i].min();rangeMax = dataMatrix[:,i].max();
    stepSize = (rangeMax - rangeMin)/numSteps
    #ä¸‹é¢å¯¹æ¯ä¸ªthreshValå¯èƒ½çš„å€¼è¿›è¡Œä¾æ¬¡æµ‹è¯•
    for j in range(-1,int(numSteps)+1):
        #ç„¶ååº”è¯¥å¼€å§‹æ¯”è¾ƒå¤§äºé˜ˆå€¼å’Œå°äºé˜ˆå€¼æ€ä¹ˆæ€ä¹ˆæ»´ï¼Œä¸ºäº†å¢åŠ ä»£ç çš„å¤ç”¨æ€§ï¼Œæ­¤å¤„ç”¨ä¸€ä¸ªå¾ªç¯æ¥åœ¨å¤§äºå’Œå°äºä¹‹é—´åˆ‡æ¢ä¸ç­‰å¼
        for inequal in [&apos;lt&apos;,&apos;gt&apos;]:#lt=å°äºç­‰äºï¼Œgt=å¤§äº
            threshVal = (rangeMin + float(j)*stepSize)
            # å¼€å§‹æµ‹è¯•è¿™ä¸ªç‰¹å¾ä¸‹è¿™ä¸ªé˜ˆå€¼çš„äºŒåˆ†ç±»å™¨å¥½ä¸å¥½ç”¨
            predictedVals = stumpClassify(dataMatrix,i,threshVal,inequal)
            #è®¡ç®—æœ¬æ¬¡åˆ†ç±»çš„err
            errArr = mat(ones((m,1)))
            errArr[predictedVals==labelMat]=0
            #åŸºäºæƒé‡å‘é‡Dè®¡ç®—æƒé‡
            weightedError = D.T*errArr
            if weightedError &lt; minError :
                minError = weightedError
                bestClasEst = predictedVals.copy()
                bestStump[&apos;dim&apos;] = i
                bestStump[&apos;thresh&apos;] = threshVal
                bestStump[&apos;ineq&apos;] = inequal
</code></pre><p>æœ€åï¼Œè¿”å›æœ€ä½³çš„å†³ç­–æ¡©ï¼Œå’Œè¯¯å·®</p>
<pre><code>return bestStump,minError,bestClasEst
</code></pre><h1 id="æ±‚è§£AdaBoostå†³ç­–æ ‘">3. æ±‚è§£AdaBoostå†³ç­–æ ‘</h1><h2 id="AdaBoostçš„æƒé‡ä¸æŠ•ç¥¨åˆ†æ•°çš„å…³ç³»">3.1. AdaBoostçš„æƒé‡ä¸æŠ•ç¥¨åˆ†æ•°çš„å…³ç³»</h2><p>å›é¡¾AdaBoostç®—æ³•ï¼š</p>
<p>ä»æƒé‡<code>ut</code>ï¼Œé€šè¿‡<code>â—†t</code>å¯¹<code>u(t+1)</code>è¿›è¡Œä¿®æ­£ï¼Œè€Œä¸¤ä¸ªå…¬å¼å¯ä»¥åˆæˆä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-14-35-34.png" alt=""> </p>
<p>å¦‚ä¸‹å›¾ï¼Œæ¥ç€æˆ‘ä»¬å°†<code>u(t+1)</code>å±•å¼€(è¡¨è¾¾ä¸º<code>u(1)ä¹˜ä»¥ä¸€å¨</code>)ï¼Œæœ€ç»ˆå¯ä»¥å˜æˆè¿åŠ ï¼›<br>æˆ‘ä»¬å‘ç°å›¾ä¸­æ©˜è‰²éƒ¨åˆ†<code>âˆ‘Î±tÂ·gt(xn)</code>æ˜¯G(x)çš„åˆ†æ•°ï¼å®ƒç°åœ¨å‡ºç°åœ¨Adaboostçš„æƒé‡è¡¨è¾¾å¼ä¸­ï¼›<br>æˆ‘ä»¬ç§°æ©˜è‰²<code>âˆ‘Î±tÂ·gt(xn)</code>ä¸º<strong>æŠ•ç¥¨åˆ†æ•°(voting score)</strong>ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-14-38-40.png" alt=""> </p>
<p><strong>ç»“è®º</strong>ï¼šAdaBoosté‡Œé¢æ¯ä¸€ä¸ªæ•°æ®çš„æƒé‡ï¼Œå’Œ<code>exp(-yn( æŠ•ç¥¨åˆ†æ•° on xn))</code>å‘ˆæ­£æ¯”ã€‚å³ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-14-41-04.png" alt=""> </p>
<h2 id="æŠ•ç¥¨åˆ†æ•°-Voting-Score-å’Œé—´éš”-Margin-çš„å…³ç³»">3.2. æŠ•ç¥¨åˆ†æ•°(Voting Score)å’Œé—´éš”(Margin)çš„å…³ç³»</h2><p>çº¿æ€§æ··åˆ(linear blending)ç­‰ä»·äºå°†å‡è®¾çœ‹åšæ˜¯ç‰¹å¾è½¬æ¢çš„çº¿æ€§æ¨¡å‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-13-20.png" alt=""> </p>
<p>å…¶ä¸­<code>Î±tÂ·gt(xn)</code>å¦‚æœæ¢ä½œæ˜¯<code>wTÂ·Ï†(xn)</code>å¯èƒ½å°±æ›´æ¸…æ¥šäº†ï¼Œè¿™ä¸ä¸‹é¢ç»™å‡ºçš„åœ¨SVMä¸­çš„marginè¡¨è¾¾å¼å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥æ˜ç™½æŠ•ç¥¨åˆ†æ•°<code>âˆ‘Î±tÂ·gt(xn)</code>çš„ç‰©ç†æ„ä¹‰ï¼Œå³å¯ä»¥çœ‹åšæ˜¯æ²¡æœ‰æ­£è§„åŒ–çš„è¾¹ç•Œ(margin)ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-20-39.png" alt=""> </p>
<p>æ‰€ä»¥ï¼Œ<code>ynÂ·(voting score)</code>æ˜¯æœ‰ç¬¦å·çš„ã€æ²¡æœ‰æ­£è§„åŒ–çš„è¾¹ç•Œè·ç¦»ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›<code>ynÂ·(voting score)</code>è¶Šå¤§è¶Šå¥½ï¼Œå› ä¸ºè¿™æ ·çš„æ³›åŒ–èƒ½åŠ›è¶Šå¼ºã€‚äºæ˜¯ï¼Œ<code>exp(-ynÂ·(voting score))</code>è¶Šå°è¶Šå¥½ï¼Œé‚£ä¹ˆ<code>un(T+1)</code>è¶Šå°è¶Šå¥½ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-21-01.png" alt=""> </p>
<p><strong>ç»“è®º</strong>ï¼šAdaBooståœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ˜¯è®©<code>âˆ‘un(t)</code>è¶Šæ¥è¶Šå°çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé€æ¸è¾¾åˆ°SVMä¸­æœ€å¤§åˆ†ç±»é—´éš”çš„æ•ˆæœã€‚</p>
<h2 id="AdaBoostè¯¯å·®å‡½æ•°">3.3. AdaBoostè¯¯å·®å‡½æ•°</h2><p>ä¸Šé¢è§£é‡Šåˆ°äº†ï¼ŒAdaBooståœ¨è¿­ä»£å­¦ä¹ çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å¸Œæœ›è®©<code>âˆ‘un(t)</code>è¶Šæ¥è¶Šå°çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬<strong>æ–°çš„ç›®æ ‡</strong>å°±æ˜¯æœ€ä½³åŒ–æƒé‡å’Œ<code>âˆ‘un(T+1)</code>ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-58-44.png" alt=""> </p>
<p>æˆ‘ä»¬å¯ä»¥ç”»å‡º<code>0/1é”™è¯¯</code>å’Œ<code>AdaBoostè¯¯å·®å‡½æ•°err(s,y) = exp(-ys)</code>çš„å‡½æ•°æ›²çº¿ï¼Œæˆ‘ä»¬å‘ç°AdaBoostçš„è¯¯å·®å‡½æ•°ï¼ˆç§°ä¸ºexponential error measureï¼‰å®é™…ä¸Šä¹Ÿæ˜¯0/1é”™è¯¯å‡½æ•°çš„ä¸Šé™å‡½æ•°ï¼Œäºæ˜¯ï¼Œ<strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡æœ€å°åŒ–è¯¥å‡½æ•°æ¥èµ·åˆ°æœ€ä½³åŒ–çš„æ•ˆæœ</strong>ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-59-15.png" alt=""> </p>
<h2 id="AdaBoostè¯¯å·®å‡½æ•°çš„æ¢¯åº¦ä¸‹é™æ±‚è§£">3.4. AdaBoostè¯¯å·®å‡½æ•°çš„æ¢¯åº¦ä¸‹é™æ±‚è§£</h2><p>æœ¬èŠ‚ç›®çš„â€”â€”â€”â€”æœ€å°åŒ–AdaBoostçš„è¯¯å·®å‡½æ•°<code>Ein</code>ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-19-58-44.png" alt=""> </p>
<p>è¿™ä¸ªä»»åŠ¡æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºæ˜¯Î£å¥—ç€expå†å¥—ç€Î£ï¼Œå› æ­¤éœ€è¦ä¸€äº›å‰äººçš„æ™ºæ…§äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†<code>Ein</code>å‡½æ•°åœ¨æ‰€åœ¨ç‚¹çš„é™„è¿‘åšæ³°å‹’å±•å¼€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç°åœ¨è¯¥ç‚¹çš„é™„è¿‘å¯ä»¥è¢«æ¢¯åº¦æ‰€æè¿°ï¼Œæˆ‘ä»¬å¸Œæœ›æ±‚ä¸€ä¸ªæœ€å¥½çš„æ–¹å‘ï¼ˆæœ€å¤§æ¢¯åº¦ç›¸åçš„æ–¹å‘ï¼‰ï¼Œç„¶ååœ¨è¯¥æ–¹å‘ä¸Šèµ°ä¸€å°æ­¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åšåˆ°æ¯”ç°åœ¨çš„å‡½æ•°æ•ˆæœå¥½ä¸€ç‚¹ç‚¹ï¼Œä¾æ¬¡è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼Œæœ€ç»ˆè¾¾åˆ°æœ€å°åŒ–è¯¯å·®å‡½æ•°çš„æ•ˆæœã€‚</p>
<p>åŸå§‹çš„æ¢¯åº¦ä¸‹é™æ³•ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-02-45.png" alt=""> </p>
<p>ä¸ºäº†æ¨¡ä»¿æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•ï¼Œå‡è®¾å‰é¢å·²ç»AdaBoostå®Œt-1è½®äº†ï¼Œç°åœ¨è¦æ±‚çš„æ˜¯ä¸€ä¸ªå‡½æ•°gt(x)ï¼ˆæˆ–è€…ç§°ä¸ºh(x)ï¼‰ã€‚</p>
<p>åœ¨ç¬¬tè½®ï¼Œæˆ‘ä»¬æ²¿ç€å‡½æ•°h(x)çš„æ–¹å‘èµ°$Î·$çš„æ­¥é•¿ï¼Œå¯ä»¥ä½¿å¾—ç›®æ ‡å‡½æ•°è¿…é€Ÿå¾€minçš„æ–¹å‘èµ°ã€‚å¦‚ä¸‹ï¼šç°åœ¨æˆ‘ä»¬æŠŠ<code>å‡½æ•°gt</code>å½“åšå‘é‡ï¼Œå¸Œæœ›å»æ‰¾åˆ°è¿™ä¸ª<code>gt</code>ï¼ˆè¿™é‡Œå‡½æ•°æ–¹å‘gtå’Œä¸Šé¢ä»‹ç»çš„æœ€å¤§æ¢¯åº¦çš„æ–¹å‘å‘é‡æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œåªæ˜¯è¡¨ç¤ºæ–¹å¼æœ‰æ‰€ä¸åŒè€Œå·²ï¼‰ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-03-24.png" alt=""> </p>
<p>æˆ‘ä»¬è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„å…¬å¼ï¼š</p>
<ul>
<li>(1ã€2è¡Œ)ç”±äºå‰é¢å·²ç»æ‰§è¡Œå®Œäº†<code>t-1</code>è½®ï¼Œå› æ­¤å¯ä»¥æŠŠå¼å­åŒ–ç®€ä¸€ä¸‹ï¼ŒæŠŠä¸€äº›é¡¹ç›®åˆå¹¶æˆ<code>ut</code>çš„å‡½æ•°å½¢å¼</li>
<li>(3è¡Œå·¦) å°†<code>exp(-yÂ·Î·Â·h(xn))</code>åœ¨åŸç‚¹xn=0ç‚¹çš„æ³°å‹’å±•å¼€ï¼Œè¿›ä¸€æ­¥åŒ–ç®€å¾—åˆ°å¾—åˆ°<code>(1-ynÂ·Î·Â·h(xn))</code>ï¼›ï¼ˆè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨0è¿™ä¸ªä½ç½®çš„taylorå±•å¼€å‘¢ï¼Œå¯ä»¥ç†è§£æˆh(x)åªæ˜¯æ²¿ç€åŸæ¥çš„Î£1,t-1(alphat*gâ€™(xn)è¿™ä¸ªå‡½æ•°ï¼ŒæŒªåŠ¨çš„äº†ä¸€å°æ­¥ï¼›è¿™ä¸€å°æ­¥ï¼Œå°±æ„å‘³ç€å˜åŒ–å¾ˆå°ï¼Œå˜åŒ–å¾ˆå°ç”šè‡³æ¥è¿‘0ï¼Œå› æ­¤å°±å¯ä»¥åœ¨0ç‚¹taylorå±•å¼€ã€‚ä¸æ™“å¾—è¿™ç§ç†è§£æ˜¯å¦æ­£ç¡®ï¼Œæ„ä¼šå§ï¼‰</li>
<li>(3è¡Œå³) ç„¶åæ‹†æˆä¸¤éƒ¨åˆ†<code>âˆ‘un(t)</code>å’Œ<code>Î·Â·âˆ‘un(t)Â·ynÂ·h(xn)</code>ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯Einï¼Œç¬¬äºŒéƒ¨åˆ†å°±æ˜¯è¦æœ€å°åŒ–çš„ç›®æ ‡ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-04-07.png" alt=""> </li>
</ul>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å‰äººçš„æ™ºæ…§å·²ç»æŠŠç›®æ ‡å‡½æ•°ç»™å¤§å¤§ç®€åŒ–äº†ï¼Œä¸‹é¢éœ€è¦è¦æ±‚çš„ä¸œè¥¿æœ‰ä¿©ï¼š</p>
<p>1ï¼‰<code>h(x)</code>æ˜¯å•¥ï¼Ÿ</p>
<p>2ï¼‰<code>$Î·$</code>æ˜¯å•¥ï¼Ÿ</p>
<h3 id="æ±‚h-x">3.4.1. æ±‚h(x)</h3><p>æˆ‘ä»¬å¯¹<code>âˆ‘un(t)Â·ynÂ·h(xn)</code>æ•´ç†ä¸€ä¸‹ï¼Œå¯¹äºäºŒå…ƒåˆ†ç±»æƒ…å½¢ï¼Œæˆ‘ä»¬æŠŠ<code>yn</code>å’Œ<code>h(xn)</code>æ˜¯å¦åŒå·è¿›è¡Œåˆ†åˆ«è®¨è®ºï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-04-29.png" alt=""> </p>
<p>ä¸Šé¢çš„å…¬å¼ä¸­ï¼Œæˆ‘ä»¬ç‰¹æ„å°†<code>âˆ‘un(t)Â·ynÂ·h(xn)</code>æ‹†æˆ<code>-âˆ‘un(t)</code>å’Œ<code>Ein(h)</code>çš„å½¢å¼ï¼Œè¿™é‡Œæœ€å°åŒ–<code>Ein</code>å¯¹åº”äºAdaBoostä¸­çš„Aï¼ˆå¼±å­¦ä¹ ç®—æ³•ï¼‰ï¼Œå¥½çš„å¼±å­¦ä¹ ç®—æ³•å°±æ˜¯å¯¹åº”äºæ¢¯åº¦ä¸‹é™çš„å‡½æ•°æ–¹å‘ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼šåœ¨AdaBoostçš„è¿‡ç¨‹ä¸­ï¼Œç®—æ³•Aå°±æ˜¯good gtäº†ï¼</p>
<h3 id="æ±‚æœ€ä½³åŒ–æ­¥é•¿-Î·">3.4.2. æ±‚æœ€ä½³åŒ–æ­¥é•¿$Î·$</h3><p>æˆ‘ä»¬è¦æœ€å°åŒ–Eadaï¼Œéœ€è¦æ‰¾åˆ°å¥½çš„å‡½æ•°æ–¹å‘gtï¼Œä½†æ˜¯å¾—æ‰“è¿™ä¸ªgtçš„ä»£ä»·æœ‰äº›å¤§ï¼Œæ¢¯åº¦ä¸‹é™çš„è¿‡ç¨‹ä¸­ï¼Œæ¯èµ°ä¸€å°æ­¥ï¼Œå°±éœ€è¦è®¡ç®—å¾—åˆ°ä¸€ä¸ªgtã€‚å¦‚æœè½¬æ¢ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»ç¡®å®šäº†å¥½çš„gtï¼Œæˆ‘ä»¬å¸Œæœ›å¿«é€Ÿæ‰¾åˆ°æ¢¯åº¦ä¸‹é™çš„æœ€ä½ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æœ€å¤§æ­¥é•¿Î·ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-05-39.png" alt=""> </p>
<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨è´ªå¿ƒç®—æ³•æ¥å¾—åˆ°æœ€å¤§æ­¥é•¿Î·ï¼Œç§°ä¸ºsteepest decent for optimizationã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-05-54.png" alt=""> </p>
<p>è®©Eadaå¯¹Î·æ±‚åå¾®åˆ†ï¼Œå¾—åˆ°æœ€é™¡æ—¶å€™çš„Î·tï¼Œæˆ‘ä»¬å‘ç°è¿™æ—¶Î·tç­‰äºAdaBoostçš„Î±tã€‚æ‰€ä»¥åœ¨AdaBoostä¸­Î±tæ˜¯åœ¨å·å·åœ°åšæœ€ä½³åŒ–çš„å·¥ä½œã€‚</p>
<p>æ ¸å¿ƒåœ¨äºEADAæ˜¯æ€ä¹ˆå˜æˆå¯å¯¹$Î·$æ±‚å¯¼çš„å½¢å¼çš„ï¼š</p>
<p>EADA = u1t<em>exp(-$Î·$) + u2t</em>exp($Î·$)â€¦</p>
<p>EADA1 = u1t<em>exp(-$Î·$) + ut2t</em>0 â€¦ ï¼ˆEADA1åªè€ƒè™‘exp(-$Î·$)çš„é¡¹ï¼Œå…¶ä½™çš„è¡¥ä¸Š0ï¼‰</p>
<p>EADA2 = u1t<em>0 + u2t </em> exp($Î·$) â€¦ï¼ˆEADA2åªè€ƒè™‘exp(+$Î·$)çš„é¡¹ï¼Œå…¶ä½™çš„è¡¥ä¸Š0ï¼‰</p>
<p>åˆ™ï¼ŒEADA = EADA1 + EADA1 = (Î£unt) <em> ( (1-epson)exp(-$Î·$) + epson</em>exp($Î·$) )</p>
<p>éšåçš„æ±‚å¯¼æ­¥éª¤å°±æ˜¯å¾ˆè‡ªç„¶çš„äº†ï¼Œå› æ­¤å°±éªŒè¯äº†ä¹‹å‰çš„ç»“è®ºï¼Œ$Î·$t = sqrt( (1-epsont)/epsont) )å°±æ˜¯æœ€ä¼˜çš„ã€‚å‰ä¸€æ¬¡è¯¾ç›´æ¥ç»™å‡ºäº†è¿™ä¸ªç»“è®ºï¼Œå¹¶æ²¡æœ‰è¯´ä¸ºä»€ä¹ˆï¼Œè¿™æ¬¡ç®—æ˜¯ç»™å‡ºäº†ä¸€ä¸ªç›¸å¯¹ç†è®ºäº›çš„æ¨å¯¼ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼šé€šè¿‡æ±‚è§£<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-13-25-13.png" alt=""><br>ï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ä½³çš„<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-15-13-25-32.png" alt=""> </p>
<h3 id="å°ç»“">3.4.3. å°ç»“</h3><p>åœ¨ç¬¬äºŒå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»å¦å¤–ä¸€ä¸ªè§’åº¦ä»‹ç»äº†AdaBoostç®—æ³•ï¼Œå®ƒå…¶å®æ˜¯steepest gradient decentã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-07-20-06-19.png" alt=""> </p>
<p>ä¸Šé¢çš„å¼å­å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬å°†AdaBoostçš„è¯¯å·®å‡½æ•°çœ‹åšæ˜¯æŒ‡æ•°è¯¯å·®å‡½æ•°ï¼ŒAdaBoostå°±æ˜¯åœ¨è¿™ä¸ªå‡½æ•°ä¸Šä¸€æ­¥ä¸€æ­¥åšæœ€ä½³åŒ–ï¼Œæ¯ä¸€æ­¥æ±‚å¾—ä¸€ä¸ªhï¼Œå¹¶å°†è¯¥hå½“åšæ˜¯gtï¼Œå†³å®šè¿™ä¸ªgtä¸Šé¢è¦èµ°å¤šé•¿çš„è·ç¦»Î·tï¼Œæœ€ç»ˆå¾—åˆ°è¿™ä¸ªgtçš„ç¥¨æ•°Î±tã€‚</p>
<h1 id="AdaBoostå†³ç­–æ ‘æ€»ç»“">4. AdaBoostå†³ç­–æ ‘æ€»ç»“</h1><ol>
<li>AdaBoostæœ¬æ¬¡çš„u(t+1)ä¸<code>exp(-yn( æŠ•ç¥¨åˆ†æ•° on xn))</code>æˆæ­£æ¯”</li>
<li>AdaBooståœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ˜¯è®©<code>âˆ‘un(t)</code>è¶Šæ¥è¶Šå°çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé€æ¸è¾¾åˆ°SVMä¸­æœ€å¤§åˆ†ç±»é—´éš”çš„æ•ˆæœ</li>
<li>ä¸Šç›®æ ‡ä¸æœ€å°åŒ–è¯¯å·®å‡½æ•°<code>err(s,y) = exp(-ys)</code>ç­‰ä»·</li>
<li>è¦ä½¿å¾—<code>err(s,y)</code>æœ€å°ï¼Œå°±éœ€è¦æ±‚å¾—<code>h(x)</code>å’Œ<code>Î·</code></li>
</ol>
<h1 id="å‚è€ƒæ–‡çŒ®">5. å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a href="http://qianjiye.de/2015/01/gradient-boosted-decision-tree" target="_blank" rel="external">æ¢¯åº¦æå‡å†³ç­–æ ‘</a></li>
<li><a href="http://www.cnblogs.com/xbf9xbf/p/4706150.html" target="_blank" rel="external">ã€Gradient Boosted Decision Treeã€‘æ—è½©ç”°æœºå™¨å­¦ä¹ æŠ€æœ¯</a></li>
<li>ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹</li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-AdaBoost]]></title>
      <url>/2017/03/05/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-AdaBoost/</url>
      <content type="html"><![CDATA[<h1 id="Boosting">1. Boosting</h1><p>æå‡ï¼ˆboostingï¼‰ï¼šä»å¼±å­¦ä¹ ç®—æ³•ï¼ˆæ­£ç¡®ç‡ä½ï¼‰å‡ºå‘ï¼Œåå¤å­¦ä¹ ï¼Œå¾—åˆ°ä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨ï¼ˆåŸºæœ¬åˆ†ç±»å™¨ï¼‰ï¼Œç„¶åç»„åˆè¿™äº›å¼±åˆ†ç±»å™¨ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ã€‚ï¼ˆä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®ï¼‰</p>
<p>æå‡ï¼ˆboostingï¼‰æ–¹æ³•éœ€è¦è§£å†³çš„é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•è·å¾—æ›´å¤šçš„å¼±åˆ†ç±»å™¨â€”â€”â€”â€”å¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„æƒå€¼æˆ–æ¦‚ç‡åˆ†å¸ƒâ€”â€”â€”â€”æé«˜è¢«å‰ä¸€è½®é”™è¯¯åˆ†ç±»æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½è¢«æ­£ç¡®åˆ†ç±»æ ·æœ¬çš„æƒå€¼ã€‚</li>
<li>å¦‚ä½•å°†å¼±åˆ†ç±»å™¨åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨â€”â€”â€”â€”åŠ æƒå¤šæ•°è¡¨å†³ï¼šåŠ å¤§è¯¯å·®å°çš„åˆ†ç±»å™¨çš„æƒå€¼ï¼Œå‡å°è¯¯å·®å¤§çš„åˆ†ç±»å™¨çš„æƒå€¼ã€‚</li>
</ul>
<p>æå‡æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæœ€å…·ä»£è¡¨æ€§çš„å°±æ˜¯AdaBoostç®—æ³•ã€‚</p>
<h1 id="AdaBoostç®—æ³•">2. AdaBoostç®—æ³•</h1><p>å‡è®¾ç»™å®šä¸€ä¸ªäºŒåˆ†ç±»è®­ç»ƒæ•°æ®é›†$T=\{(x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N)\}$</p>
<p>å…¶ä¸­ï¼Œæ¯ä¸ªæ ·æœ¬ç‚¹ç”±<code>å®ä¾‹+æ ‡è®°</code>ç»„æˆ</p>
<p>å®ä¾‹ï¼š$x_i\in X \subseteq R^n $</p>
<p>æ ‡è®°ï¼š$y_i \in Y={-1,+1}$</p>
<p><code>AdaBoost</code>åˆ©ç”¨ä»¥ä¸‹ç®—æ³•ï¼Œä»è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ ä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨æˆ–åŸºæœ¬åˆ†ç±»å™¨ï¼Œå¹¶å°†è¿™äº›å¼±åˆ†ç±»å™¨çº¿æ€§ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨</p>
<p><strong>è¾“å…¥</strong>:</p>
<ul>
<li>æ•°æ®é›†$T=\{(x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N)\}$</li>
<li>å¼±å­¦ä¹ ç®—æ³•</li>
</ul>
<p><strong>è¾“å‡º</strong>ï¼šæœ€ç»ˆåˆ†ç±»å™¨$G(x)$</p>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>åˆå§‹åŒ–è®­ç»ƒæ•°æ®çš„æƒå€¼(æ¯ä¸ªéƒ½è®¾ä¸º1/N)ï¼š</li>
</ol>
<p>$$D_1=(w_{11},w_{1i},â€¦,w_{1N}),w_{1i}=\frac{1}{N},i=1,2,â€¦,N$$</p>
<ol>
<li>å¯¹$m=1,2,â€¦,M$:</li>
</ol>
<ul>
<li>ä½¿ç”¨å¸¦æƒå€¼$D_m$çš„è®­ç»ƒé›†å­¦ä¹ ï¼Œå¾—åˆ°åŸºæœ¬åˆ†ç±»å™¨$G_m(x):X\rightarrow \{-1,+1\}$</li>
<li>è®¡ç®—$G_m(x)$åœ¨è®­ç»ƒé›†ä¸Šçš„åˆ†ç±»è¯¯å·®ç‡ï¼š$$e_m=P(G_m(x_i)\neq y_i)=\sum_{n=1}^N w_{mi}I(G_m(x_i)\neq y_i)$$</li>
</ul>
<ol>
<li>è®¡ç®—$G_m(x)$çš„ç³»æ•°ï¼š$$\alpha_m=\frac{1}{2}log\frac{1-e_m}{e_m}$$</li>
<li>æ›´æ–°è®­ç»ƒé›†æƒå€¼ï¼š</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-06-22-49-14.png" alt=""> </p>
<ol>
<li>æ„å»ºåŸºæœ¬åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆï¼š</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-06-22-49-54.png" alt=""> </p>
<h1 id="AdaBoostç®—æ³•æ¨å¯¼">3. AdaBoostç®—æ³•æ¨å¯¼</h1><h2 id="Boot-strapping">3.1. Boot strapping</h2><p>Boot strappingï¼Œæ‹”é´æ³•ï¼šåˆ©ç”¨æœ‰é™çš„æ ·æœ¬èµ„æ–™ç»ç”±<strong>å¤šæ¬¡é‡å¤æŠ½æ ·</strong>ï¼Œé‡æ–°å»ºç«‹èµ·è¶³ä»¥ä»£è¡¨æ¯ä½“æ ·æœ¬åˆ†å¸ƒä¹‹æ–°æ ·æœ¬ã€‚</p>
<p>å¤šæ¬¡ä¹‹åï¼Œå¾—åˆ°ä¸€ä¸ªéçº¿æ€§çš„ç»“æœï¼ˆé»‘è‰²çº¿ï¼‰<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-17-37-57.png" alt=""> </p>
<h2 id="åŸºæœ¬ç®—æ³•å¼•å…¥æƒé‡">3.2. åŸºæœ¬ç®—æ³•å¼•å…¥æƒé‡</h2><p>å·²çŸ¥ï¼šä¸€ç¬”æ•°æ®$D=\{(x_1,y_1),(x_2,y_2),(x_3,y_3),(x_4,y_4)\}$<br>æ ¹æ®<code>D</code>ç®—å‡ºæ¥çš„è¾“å…¥è¯¯å·®Einä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-29-41.png" alt=""> </p>
<p>é€šè¿‡Boot strappingï¼Œå¾—åˆ°æ–°çš„ä¸€ç¬”æ•°æ®$D_t=\{(x_1,y_1),(x_1,y_1),(x_2,y_2),(x_4,y_4)\}$<br>å¯¹åº”åœ°ï¼Œæ ¹æ®<code>Dt</code>ç®—å‡ºæ¥çš„Einä¸ºï¼š<br>ï¼ˆå¢åŠ ä¸€ä¸ªæƒé‡uå³å¯ï¼‰<br><code>u1=2,u2=1,u3=0,u4=1</code><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-31-04.png" alt=""> </p>
<p><strong>ç»“è®ºï¼šæ¯ä¸€ä¸ªbootstrappingå¾—åˆ°äº†ä¸€ä¸ªæƒé‡<code>u</code></strong></p>
<h2 id="ä¼˜åŒ–æƒé‡u">3.3. ä¼˜åŒ–æƒé‡u</h2><h3 id="ä¼˜åŒ–åŸç†">3.3.1. ä¼˜åŒ–åŸç†</h3><ul>
<li>æ¯ä¸€ä¸ªbootstrappingå¾—åˆ°äº†ä¸€ä¸ªæƒé‡`uã€‚</li>
<li>ä¸ºäº†ç»¼åˆå¾—åˆ°æ›´å¥½çš„g,åˆ™éœ€è¦æŠ½å–çš„æ•°æ®é›†å¾—åˆ°çš„gå°½é‡åœ°ä¸åŒã€‚</li>
<li>æ”¹å˜<code>u</code>ï¼Œä½¿å¾—<code>g</code>å·®å¼‚æ›´å¤§ï¼Œæ‰ä¼šæ›´å¥½åœ°æ”¹è¿›æœ€ç»ˆç»“æœ</li>
</ul>
<p>å¾—åˆ°gå·®å¼‚å¾ˆå¤§çš„æ–¹æ³•ï¼š</p>
<ul>
<li>ç¬¬ä¸€è½®$u_n^t$æ—¶ï¼Œå¾—åˆ°$g_t$<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-39-48.png" alt=""> </li>
<li>ç¬¬äºŒè½®ï¼Œé€‰æ‹©ä¸€ä¸ª åœ¨$g_t$ è¡¨ç°ä¸å¥½çš„ $u_n^{t+1}$  ï¼Œå¾—åˆ° $g_{t+1}$ <img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-41-02.png" alt=""><br>â€“ è¡¨ç°ä¸å¥½çš„å®šä¹‰ï¼š<br>â€” å°†$u_n^{t+1}$ä½œç”¨åœ¨$g_t$ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ªå½’ä¸€åŒ–çš„é”™è¯¯ç‡<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-45-01.png" alt=""><br>â€” ä¸ºäº†ç®€ä¾¿ï¼Œå®šä¹‰æ©™è‰²æ–¹å—ä¸ºæ‰€æœ‰çŠ¯é”™è¯¯çš„$u_n^{t+1}$çš„ç´¯åŠ ï¼Œç»¿è‰²åœ†å½¢ä¸ºæ‰€æœ‰æ­£ç¡®çš„$u_n^{t+1}$ç´¯åŠ <br>â€” å³ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-47-12.png" alt=""><br>â€“ è¡¨ç°ä¸å¥½çš„é€‰æ‹©æ–¹æ³•ï¼š<br>â€” å°†æœ¬æ¬¡æ­£ç¡®çš„$u_n^t$ï¼Œé™¤ä»¥ä¸€ä¸ªé”™è¯¯çš„æ¯”ä¾‹ï¼ˆç¼©å°æ­£ç¡®ï¼‰ï¼Œèµ‹ç»™$u_n^{t+1}$<br>â€” å°†æœ¬æ¬¡é”™è¯¯çš„$u_n^t$ï¼Œä¹˜ä»¥ä¸€ä¸ªæ­£ç¡®çš„æ¯”ä¾‹ï¼ˆæ”¾å¤§é”™è¯¯ï¼‰ï¼Œèµ‹ç»™$u_n^{t+1}$<br>â€” è¿™æ ·å¾—åˆ°çš„$u_n^{t+1}$çš„æ¯”ç‡å°±ä¼šä¸º2/1<br>â€” å³ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-51-21.png" alt=""> </li>
</ul>
<h3 id="ä¼˜åŒ–æƒé‡uçš„æ–¹æ³•â€”â€”â€”â€”æ”¾ç¼©å› å­">3.3.2. ä¼˜åŒ–æƒé‡uçš„æ–¹æ³•â€”â€”â€”â€”æ”¾ç¼©å› å­</h3><p>æ”¾ç¼©å› å­-Adaptive Boosting Algorithm<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-02-12.png" alt=""> </p>
<ul>
<li>â—†tæœ‰æ›´æ¸…æ™°çš„ç‰©ç†æ„ä¹‰ï¼Œé€šå¸¸æƒ…å†µä¸‹Îµt &lt; 1/2ï¼ˆå› ä¸ºæ˜¯å­¦ä¹ ä¹‹åçš„ç»“æœï¼Œé”™è¯¯ç‡åº”è¯¥å°äº0.5ï¼‰ï¼Œ</li>
<li>â—†tå°†å¤§äº1ï¼›</li>
<li>é‚£ä¹ˆï¼ŒçŠ¯é”™çš„æ•°æ®å°†ä¹˜ä¸Šå¤§äº1çš„æ•°ï¼Œæ­£ç¡®æ•°æ®å°†é™¤ä»¥å¤§äº1çš„æ•°</li>
<li>ä½¿å¾—æå‡äº†çŠ¯é”™æ•°æ®çš„æƒé‡(scale up incorrect)ï¼Œ</li>
<li>é™ä½åšå¯¹æ•°æ®çš„æƒé‡(scale down correct)</li>
<li>è¿™æ ·ä½¿å¾—æ›´åŠ ä¸“æ³¨åœ¨çŠ¯äº†é”™çš„åœ°æ–¹ï¼Œæ¥å¾—åˆ°ä¸ä¸€æ ·çš„å‡è®¾(diverse hypotheses)ã€‚</li>
</ul>
<h2 id="Linear-Aggregationï¼ˆèšé›†ï¼‰-åˆæˆæœ€ç»ˆçš„g">3.4. Linear Aggregationï¼ˆèšé›†ï¼‰ - åˆæˆæœ€ç»ˆçš„g</h2><p>ç›®æ ‡ï¼šåˆæˆæœ€ç»ˆçš„çš„$G(x)=sign(\sum_{t=1}^T\alpha_t g_t(x)$</p>
<ul>
<li>å…¶ä¸­ $\alpha_t$æ˜¯ç³»æ•°</li>
<li>è¦æ±‚å¥½çš„$g_t$ï¼ˆé”™è¯¯ç‡ä½ï¼‰ï¼Œ$\alpha_t$åº”è¯¥å¤§ä¸€äº›</li>
<li>åçš„$g_t$ï¼ˆé”™è¯¯ç‡é«˜ï¼‰ï¼Œ$\alpha_t$åº”è¯¥å°ä¸€äº›</li>
<li>è€Œâ—†tä¸é”™è¯¯ç‡æˆåæ¯”</li>
<li>åˆ™å¯ä»¤$\alpha_t=ln(\text{â—†t})$</li>
</ul>
<p>ç®—æ³•æµç¨‹ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-21-25.png" alt=""> </p>
<p>è¿™é‡Œä¹‹æ‰€ä»¥è®¤ä¸ºÎ±t = ln(â—†t)ï¼Œå¤„äºä¸‹é¢çš„è€ƒè™‘ï¼š<br>å¦‚æœÎµt = 1/2ï¼Œ é‚£ä¹ˆâ—†t = 1ï¼Œåˆ™Î±t = 0ï¼Œæ„æ€æ˜¯éšæœºä¹±çŒœçš„æƒ…å†µä¸‹ï¼ˆäºŒå…ƒåˆ†ç±»é”™è¯¯ç‡ä¸º0.5ï¼‰ï¼Œè®¤ä¸ºæ˜¯åçš„gï¼Œåˆ™ä¸€ç¥¨ä¸ç»™ä¸ªï¼Œä¸ä½¿ç”¨è¯¥g<br>å¦‚æœÎµt = 0ï¼Œ é‚£ä¹ˆâ—†t = âˆï¼Œåˆ™Î±t = âˆï¼Œæ„æ€æ˜¯æ­£ç¡®ç‡ä¸º0çš„æƒ…å†µï¼Œç»™å®ƒæ— é™å¤šç¥¨æ•°</p>
<h1 id="AdaBoost-è‡ªé€‚åº”ä¼˜åŒ–ç®—æ³•æ€»ç»“">4. AdaBoost è‡ªé€‚åº”ä¼˜åŒ–ç®—æ³•æ€»ç»“</h1><p>è‡ªé€‚åº”ä¼˜åŒ–ç®—æ³• = ç®€å•çš„å­¦ä¹ A + æ”¾ç¼©æƒé‡ + åˆæˆå¾—åˆ°g<br>å³ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-25-49.png" alt=""> </p>
<p>AdaBoostç®—æ³•å®Œæ•´æµç¨‹<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-26-16.png" alt=""> </p>
<h1 id="AdaBoostç†è®ºç‰¹æ€§">5. AdaBoostç†è®ºç‰¹æ€§</h1><p>é€šè¿‡ä¹‹å‰çš„VC Boundï¼Œæ¥çº¦æŸæµ‹è¯•è¯¯å·®ï¼Œå…¶ä¸­è“è‰²çš„éƒ¨åˆ†æ˜¯æ¨¡å‹çš„å¤æ‚åº¦ï¼ŒO(dvc(H))ä¸ºgçš„æ¨¡å‹å¤æ‚åº¦ï¼Œè€ŒO(dvc(H))Â·TÂ·logTæ˜¯æ¨¡å‹Gçš„å¤æ‚åº¦ã€‚åŸä½œè€…è¯æ˜è¯´ï¼Œå¯ä»¥ç”¨O(logN)æ¬¡è¿­ä»£å¯ä»¥å°†Ein(G)åšåˆ°å¾ˆå°ï¼Œå¹¶ä¸”å½“æ•°æ®é‡Nè¶³å¤Ÿå¤šçš„æƒ…å†µä¸‹ï¼Œåˆå¯ä»¥ä½¿å¾—æ¨¡å‹å¤æ‚åº¦å˜å¾—å¾ˆå°ï¼Œä»è€Œä½¿å¾—æ¨¡å‹å¤æ‚åº¦å¾—åˆ°æ§åˆ¶ã€‚æœ€ç»ˆé¢„æµ‹æ•ˆæœEoutä¹Ÿä¼šå¾ˆå¥½ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-27-24.png" alt=""><br>AdaBoostçš„ä¿è¯æ˜¯è®©ä¸€ä¸ªå¾ˆå¼±çš„ç®—æ³•ä¸æ–­å˜å¼ºï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¾ˆå¼ºæ˜¯ç®—æ³•ï¼ˆEin=0ï¼ŒEout is smallï¼‰ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-27-48.png" alt=""> </p>
<h1 id="Adaptive-Boostingçš„å®é™…åº”ç”¨è¡¨ç°">6. Adaptive Boostingçš„å®é™…åº”ç”¨è¡¨ç°</h1><p>ä¸Šé¢çš„AdaBooståªéœ€è¦ä¸€ä¸ªå¾ˆå¼±çš„ç®—æ³•å°±å¯ä»¥ä½¿ç”¨ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å†³ç­–æ¡©(Decision Stump)ï¼Œè¯¥æ¨¡å‹ç›¸å½“äºåœ¨æŸä¸€ä¸ªç»´åº¦ä¸Šçš„Perceptronæ¨¡å‹ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-28-27.png" alt=""> </p>
<h1 id="èšåˆï¼ˆaggregationï¼‰æ¨¡å‹æ€»ç»“">7. èšåˆï¼ˆaggregationï¼‰æ¨¡å‹æ€»ç»“</h1><p>aggregation æ¨¡å‹ä¸»è¦åº”ç”¨åœ¨å°†å¾—åˆ°çš„å¤šä¸ªé¢„æµ‹å‡½æ•°$g_t$èšåˆåœ¨ä¸€èµ·ï¼Œå¾—åˆ°æ›´å¥½çš„$g_t$ï¼ˆå³æ›´å¥½çš„åˆ†ç±»å™¨ï¼‰çš„æ–¹å¼</p>
<p>èšåˆæ–¹å¼ä¸»è¦é¢å‘ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>blending:å·²ç»æœ‰äº†ä¸€å †$g_t$åœ¨æ‰‹ä¸Šï¼ˆå¯èƒ½æ˜¯å·²çŸ¥çš„ï¼Œå¯èƒ½æ˜¯æ±‚å¾—çš„ï¼‰ã€‚</li>
<li>learningï¼šä¸å·²çŸ¥$g_t$ï¼Œéœ€è¦é€šè¿‡ä¸€å®šæ–¹å¼æ±‚å¾—å¾ˆå¤š$g_t$</li>
</ul>
<p>learningçš„åˆ†ä¸ºä¸‰ç§æƒ…å†µ</p>
<ul>
<li>æŠŠgçœ‹åšæ˜¯åŒç­‰åœ°ä½ï¼Œé€šè¿‡æŠ•ç¥¨æˆ–è€…å¹³å‡çš„æ–¹å¼å°†å®ƒä»¬åˆèµ·æ¥ï¼Œç§°ä¸ºBagging</li>
<li>gæ˜¯ä¸å¹³ç­‰çš„ï¼Œæœ‰å¥½æœ‰åï¼Œä¸€ä¸ªå¯è¡Œçš„åšæ³•æ˜¯æŠŠgå½“æˆæ˜¯ç‰¹å¾çš„è½¬æ¢ï¼Œç„¶åä¸¢è¿›çº¿æ€§æ¨¡å‹è®­ç»ƒå°±å¯ä»¥äº†ï¼Œè¿™ç§°ä¸ºAdaBoost</li>
<li>å¦‚æœæ˜¯ä¸åŒçš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨ä¸åŒçš„gï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»ç„¶å¯ä»¥å°†gå½“åšæ˜¯ç‰¹å¾è½¬æ¢ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ä¸€ä¸ªéçº¿æ€§æ¨¡å‹æ¥å¾—åˆ°æœ€ç»ˆçš„æ¨¡å‹å‚æ•°ï¼Œè¿™å°±æ˜¯ä¸‹æ–‡è¦ä»‹ç»çš„å†³ç­–æ ‘ç®—æ³•</li>
</ul>
<table>
<thead>
<tr>
<th>$g_t$ç±»å‹</th>
<th style="text-align:right">blending</th>
<th style="text-align:center">learning</th>
</tr>
</thead>
<tbody>
<tr>
<td>å„$g_t$ç­‰æƒé‡å‹ï¼ˆuniformï¼‰</td>
<td style="text-align:right">æŠ•ç¥¨æ–¹å¼/å¹³å‡æ–¹å¼</td>
<td style="text-align:center">Bagging</td>
</tr>
<tr>
<td>$g_t$æƒé‡ä¸ç­‰å‹ï¼ˆnon-uniformï¼‰</td>
<td style="text-align:right">çº¿æ€§èšåˆ</td>
<td style="text-align:center">AdaBoost</td>
</tr>
<tr>
<td>ä¸åŒæƒ…å½¢ç”¨ä¸åŒ$g_t$ï¼ˆconditionalï¼‰</td>
<td style="text-align:right">stacking</td>
<td style="text-align:center">å†³ç­–æ ‘</td>
</tr>
</tbody>
</table>
<h1 id="AdaBoostæ€è·¯æ€»ç»“">8. AdaBoostæ€è·¯æ€»ç»“</h1><ul>
<li>ä¸€èˆ¬ï¼Œæ•°æ®é‡è¿‡å°‘æ—¶ï¼Œæˆ‘ä»¬æ— æ³•å¾—åˆ°æ›´å¥½çš„g.</li>
<li>å› æ­¤æˆ‘ä»¬é‡‡å–BootStrappingæ–¹æ³•ï¼Œç”Ÿæˆå¤šä¸ªæ•°æ®é›†ï¼Œå¾—åˆ°å¤šä¸ªg</li>
<li>æœ€ååˆæˆæœ€å¥½çš„g</li>
</ul>
<h1 id="AdaBoostä¼ªä»£ç ">9. AdaBoostä¼ªä»£ç </h1><pre><code>å¯¹æ¯æ¬¡è¿­ä»£ï¼š
    ç”¨buildStump()å‡½æ•°æ‰¾åˆ°æœ€ä½³å•å±‚å†³ç­–æ ‘
    å°†æœ€ä½³å•å±‚å†³ç­–æ ‘åŠ å…¥åˆ°å•å±‚å†³ç­–æ ‘æ•°ç»„
    è®¡ç®—alpha
    è®¡ç®—æ–°çš„æƒé‡å‘é‡D
    æ›´æ–°ç´¯ç§¯ç±»åˆ«ä¼°è®¡å€¼
    å¦‚æœé”™è¯¯ç‡ç­‰äº0ï¼Œåˆ™é€€å‡ºå¾ªç¯
</code></pre><p>å‚è€ƒæ–‡çŒ®</p>
<ol>
<li>ã€Šæœºå™¨å­¦ä¹ æŠ€æ³•ã€‹ï¼Œæ—è½©ç”°</li>
<li><a href="http://blog.csdn.net/JasonDing1354/article/details/46462711" target="_blank" rel="external">Jason Dingï¼Œã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘è‡ªé€‚åº”æå‡</a></li>
<li><a href="http://blog.jasonding.top/2015/07/22/Machine%20Learning/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E3%80%91%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95/" target="_blank" rel="external">Jason Dingï¼Œã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘å†³ç­–æ ‘ç®—æ³•</a></li>
</ol>
<p>å¤‡æ³¨ï¼šæœ¬èŠ‚æ˜¯ã€Šæœºå™¨å­¦ä¹ æŠ€æ³•ã€‹ç¬¬8ç« +ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ç¬¬8ç« ç¬”è®°</p>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[éšæœºæ£®æ—ç®—æ³•]]></title>
      <url>/2017/03/05/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97%E7%AE%97%E6%B3%95/</url>
      <content type="html"><![CDATA[<p><strong>å¼•è¨€</strong></p>
<p>å›é¡¾ä¹‹å‰å­¦ä¹ è¿‡çš„ä¸¤ä¸ªç®—æ³•ï¼š</p>
<ul>
<li>Bagging<br>â€“ ç®€è¦ï¼šé€šè¿‡bootstrappingå¾—åˆ°ä¸ä¸€æ ·çš„æ•°æ®ï¼Œå¾—åˆ°ä¸åŒçš„gï¼Œå¯¹gå–å¹³å‡å¾—åˆ°G<br>â€“ ç‰¹ç‚¹ï¼šé€šè¿‡æŠ•ç¥¨å’Œå¹³å‡çš„æ–¹å¼æ¥é™ä½å¯¹ä¸åŒæ•°æ®çš„æ•æ„Ÿæ€§ï¼ˆvarianceçš„æ•ˆæœï¼‰</li>
<li>å†³ç­–æ ‘<br>â€“ ç®€è¦ï¼šé€šè¿‡é€’å½’æ–¹å¼å»ºç«‹å­æ ‘ï¼Œæœ€ç»ˆå¾—åˆ°å®Œæ•´çš„æ ‘<br>â€“ ç‰¹ç‚¹ï¼šå¯¹ä¸åŒæ•°æ®è¾ƒæ•æ„Ÿï¼ˆç®—æ³•çš„varianceå¾ˆå¤§ï¼‰</li>
<li>éšæœºæ£®æ—<br>â€“ ä¸¤è€…çš„ç»“åˆ</li>
</ul>
<h1 id="éšæœºæ£®æ—ç®—æ³•">1. éšæœºæ£®æ—ç®—æ³•</h1><p>æ¦‚è¿°ï¼šåˆ©ç”¨éšæœºçš„æ–¹å¼å°†è®¸å¤šå†³ç­–æ ‘ç»„åˆæˆä¸€ä¸ªæ£®æ—,æ¯ä¸ªå†³ç­–æ ‘$g_t(t)$åœ¨åˆ†ç±»çš„æ—¶å€™æŠ•ç¥¨å†³å®šæµ‹è¯•æ ·æœ¬çš„æœ€ç»ˆç±»åˆ«ã€‚åœ¨å¾—åˆ°æ£®æ—ä¹‹åï¼Œå½“æœ‰ä¸€ä¸ªæ–°çš„è¾“å…¥æ ·æœ¬è¿›å…¥çš„æ—¶å€™ï¼Œå°±è®©æ£®æ—ä¸­çš„æ¯ä¸€æ£µå†³ç­–æ ‘åˆ†åˆ«è¿›è¡Œä¸€ä¸‹åˆ¤æ–­ï¼Œçœ‹çœ‹è¿™ä¸ªæ ·æœ¬åº”è¯¥å±äºå“ªä¸€ç±»ï¼ˆå¯¹äºåˆ†ç±»ç®—æ³•ï¼‰ï¼Œç„¶åçœ‹çœ‹å“ªä¸€ç±»è¢«é€‰æ‹©æœ€å¤šï¼Œå°±é¢„æµ‹è¿™ä¸ªæ ·æœ¬ä¸ºé‚£ä¸€ç±»ã€‚</p>
<p>è¯¦ç»†ç®—æ³•ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-17-09-01.png" alt=""> </p>
<ul>
<li>å·¦è¾¹çš„æ€»ç®—æ³•æ˜¯Baggingæ€æƒ³â€“ä½“ç°éšæœºæ€§</li>
<li><p>å…¶ä¸­ä¸ºæ¯ä¸ª$g_t(t)$å»ºæ ‘æ—¶ï¼Œæ˜¯å†³ç­–æ ‘çš„æ€æƒ³â€“ä½“ç°æ£®æ—</p>
</li>
<li><p>å¹¶è¡Œè®¡ç®—çš„å¯èƒ½æ€§ï¼šéšæœºæ£®æ—ç®—æ³•ä»Baggingè¿‡ç¨‹ä¸­å¯ä»¥åˆ†é…åˆ°ä¸åŒçš„è®¡ç®—æœºä¸­è¿›è¡Œè®¡ç®—ï¼Œæ¯å°è®¡ç®—æœºå¯ä»¥ç‹¬ç«‹å­¦ä¹ ä¸€æ£µæ ‘ï¼Œä¸åŒçš„æ ‘ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ã€‚è¿™ä½¿å¾—Baggingè¿‡ç¨‹å¾ˆå®¹æ˜“å®ç°å¹¶è¡ŒåŒ–ã€‚</p>
</li>
</ul>
<h1 id="ç‰¹å¾æŠ•å½±ï¼ˆFeature-Project">2. ç‰¹å¾æŠ•å½±ï¼ˆFeature Project)</h1><ul>
<li>åŸæ¥åœ¨Baggingä¸­ï¼Œæˆ‘ä»¬å¯¹æ•°æ®è¿›è¡ŒæŠ½å–ï¼Œå¾—åˆ°ä¸åŒçš„æ•°æ®é›†ï¼Œä»è€Œäº§ç”Ÿä¸åŒçš„$g_t$</li>
<li>åœ¨éšæœºæ£®æ—ç®—æ³•ä¸­ï¼Œé™¤äº†å¯¹æ•°æ®æŠ½å–ï¼Œä¹Ÿå¯ä»¥åœ¨<strong>ç‰¹å¾</strong>è¿™ä¸€è§’åº¦æŠ½å–</li>
<li>ä¾‹ï¼Œå¦‚æœäº‹å…ˆæˆ‘ä»¬æœ‰100ä¸ªç‰¹å¾ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æŠ½å–10ä¸ªç‰¹å¾<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-20-34-44.png" alt=""> </li>
</ul>
<ul>
<li>å¾—åˆ°æ•°æ®é›†<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-20-34-07.png" alt=""> </li>
<li><p>æ¥è®­ç»ƒä¸€æ£µæ ‘ï¼Œè¿™æ ·çš„æ–¹å¼æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°å¾ˆä¸ä¸€æ ·çš„æ ‘ï¼Œå…¶å¯¹äºåˆ†ç±»çš„æ ‡å‡†æ˜¾ç„¶ä¹Ÿå¾ˆä¸ä¸€æ ·</p>
</li>
<li><p>è¿™ç­‰æ•ˆäºä¸€ä¸ªç‰¹å¾è½¬æ¢ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»100ç»´åº¦åˆ°10ä¸ªç»´åº¦çš„è½¬æ¢ä¸­ï¼Œç›¸å½“äºä½œäº†ä½ç»´åº¦çš„æŠ•å½±(Projection)</p>
</li>
<li><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-20-34-18.png" alt=""> </p>
</li>
</ul>
<ul>
<li>å¾—åˆ°çš„ç‰¹å¾å®é™…ä¸Šæ˜¯åŸå§‹ç‰¹å¾çš„éšæœºå­é›†ï¼Œè¿™ä½¿å¾—ç”Ÿæˆæ¨¡å‹è¿‡ç¨‹ä¸­çš„æ•ˆç‡ä¹Ÿå¤§å¤§æé«˜äº†</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-17-17-10.png" alt=""> </p>
<h1 id="ç‰¹å¾æ‰©å±•ï¼ˆfeature-Expansionï¼‰">3. ç‰¹å¾æ‰©å±•ï¼ˆfeature Expansionï¼‰</h1><p>æ¯æ¬¡éšæœºæŠ½å–å­ç©ºé—´ <code>ç­‰æ•ˆäº</code> å¯¹åŸæ¥çš„ç‰¹å¾å‘é‡å·¦ä¹˜ä¸€ä¸ª<strong>æŠ•å½±çŸ©é˜µ</strong>$P$,ä½¿å¾—$\Phi(X)=P\cdot x$</p>
<p>æ›´åŠ æœ‰èƒ½åŠ›çš„ç‰¹å¾æŠ•å½±å°±æ˜¯ä¸å†å•ä¸€é€‰å–å•ä¸€ç»´åº¦çš„ç‰¹å¾ï¼Œè€Œæ˜¯å°†å¤šä¸ªç»´åº¦çš„ç‰¹å¾è¿›è¡Œç»„åˆ(éšæœºçš„æ–¹å‘)ï¼Œå¾—åˆ°æ–°çš„ä¸€ç»´çš„ç‰¹å¾ï¼Œè¿™ç§°ä¸º<strong>ç‰¹å¾æ‰©å±•</strong>ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-18-43-19.png" alt=""> </p>
<ul>
<li>å°†å¤šä¸ªæ–¹å‘çš„ç‰¹å¾éšæœºåˆèµ·æ¥(combination)ï¼Œå³å¯¹äºæŠ•å½±çŸ©é˜µ$P$çš„æ¯ä¸€ä¸ªæ–¹å‘$p_i$ï¼Œä¸å†å›ºå®šæ–¹å‘ï¼ˆrowï¼‰ã€‚å³å˜ä¸º$\Phi_i(X)=P_i^T\cdot x$<br>â€“ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šè€ƒè™‘<code>low-dimensional</code>ï¼Œå³æŠ•å½±è¿‡å»æ—¶ï¼Œä¸€èˆ¬æ¯æ¬¡é€‰å–å°‘é‡ç»´åº¦è¿›è¡ŒæŠ•å½±ã€‚å³åªæœ‰$dâ€™â€™$çš„<code>éé›¶é¡¹</code>è¢«æŠ•å½±è¿‡å»</li>
<li>è¿™æ ·çš„æ–¹å¼ï¼ŒåŒ…å«äº†éšæœºæŠ½å–ï¼ˆrandom subspaceï¼‰çš„æ€æƒ³</li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œæ¯æ¬¡æŠ•å½±éƒ½é‡‡ç”¨æ–°çš„ä¸ä¸€æ ·çš„æŠ•å½±</li>
</ul>
<h1 id="éšæœºæ£®æ—çš„é‡‡æ ·è¿‡ç¨‹">4. éšæœºæ£®æ—çš„é‡‡æ ·è¿‡ç¨‹</h1><p>åœ¨å»ºç«‹æ£®æ—çš„æ¯é¢—å†³ç­–æ ‘$g_t$çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆéœ€è¦éšæœºé‡‡æ ·æ•°æ®ç‚¹ã€‚</p>
<p>ä¸æ˜¯æ‰€æœ‰æ•°æ®ç‚¹éƒ½èƒ½è¢«é‡‡åˆ°ã€‚ä»¥ä¸‹ä»‹ç»OOBç‚¹</p>
<h2 id="Out-of-bagï¼ˆOOBï¼‰ç‚¹">4.1. Out-of-bagï¼ˆOOBï¼‰ç‚¹</h2><p>OOBç‚¹ï¼šåœ¨bootstrappingè¿‡ç¨‹ä¸­ï¼Œæœ‰äº›æ•°æ®å¯èƒ½æ²¡æœ‰è¢«é€‰æ‹©ï¼Œè¿™äº›æ•°æ®è¢«ç§°ä¸ºOOBç‚¹ã€‚ä¾‹å¦‚ä¸‹è¡¨ï¼Œå¯¹äºè®­ç»ƒæ¯ä¸€ä¸ªå†³ç­–æ ‘$g_t$ï¼Œå…¶ä¸­ç”¨*å·æ ‡æ³¨çš„å°±æ˜¯$g_t$çš„OOB<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-19-18-06.png" alt=""> </p>
<h3 id="OOBç‚¹ä¸ªæ•°">4.1.1. OOBç‚¹ä¸ªæ•°</h3><p>å‡è®¾bootstrappingæŠ½äº†$Nâ€™$æ¬¡æ•°æ®ï¼Œæ¢è®¨ä¼šæœ‰å¤šå°‘æ•°æ®ä¸ä¼šè¢«æŠ½åˆ°ï¼š</p>
<ul>
<li>è‹¥$Nâ€™=N$ï¼ŒæŸä¸ªæ•°æ®$(x_n,y_n)$ä»æœªè¢«æŠ½åˆ°çš„æ¦‚ç‡æ˜¯$(1-\frac{1}{N})^N$<br>$$(1-\frac{1}{N})^N=\frac{1}{\frac{N}{N-1}^N}\approx \frac{1}{e}$$</li>
<li>é‚£ä¹ˆæ¯ä¸ªå†³ç­–æ ‘$g_t$OOBé›†åˆçš„å¤§å°å°±çº¦ä¸º$\frac{1}{e}N\approx 0.3N$</li>
</ul>
<h3 id="OOBç”¨é€”-éªŒè¯éšæœºæ£®æ—çš„G">4.1.2. OOBç”¨é€”-éªŒè¯éšæœºæ£®æ—çš„G</h3><p>å¯ä»¥ç”¨æ¥åšæµ‹è¯•é›†-é—®é¢˜åœ¨äºâ€”â€”â€”â€”éªŒè¯<code>g</code>è¿˜æ˜¯<code>G</code>ï¼Ÿ<br>ä»¥æ•°æ®é›†$(x_N,y_N)ä¸ºä¾‹$</p>
<ul>
<li>éªŒè¯$g$çš„å¿…è¦æ€§ä¸å¤§</li>
<li>éªŒè¯$G$ä¸æ–¹ä¾¿</li>
<li>å¯ä»¥ç”¨æ¥éªŒè¯<code>é™¤äº†g1ä¹‹å¤–çš„G</code> = $G_N^-(x)=average(g_2,g_3,g_T)$</li>
<li>æ€»ä¹‹ï¼Œç”¨æ¥éªŒè¯$G$è¡¨ç°æ˜¯å¦å¥½çš„æ–¹å¼ï¼š<br>$$E_{oob}(G)=\frac{1}{N}\sum_1^N error(y_n,G_n^-(x_n))$$</li>
</ul>
<h1 id="ç‰¹å¾é€‰æ‹©ï¼ˆfeature-selectionï¼‰">5. ç‰¹å¾é€‰æ‹©ï¼ˆfeature selectionï¼‰</h1><p>ç›®çš„ï¼šè‡ªåŠ¨é€‰æ‹©éœ€è¦çš„ç‰¹å¾ï¼Œå»é™¤å†—ä½™ã€ä¸ç›¸å…³çš„ç‰¹å¾<br>ä¼˜ç‚¹ï¼šé™ç»´ï¼Œå‡å°‘å¤æ‚åº¦ï¼›å‡å°‘å™ªå£°ï¼Œæé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›ï¼›ç‰©ç†æ„ä¹‰ï¼›<br>ç¼ºç‚¹ï¼šè®¡ç®—é‡å¤§ï¼›å¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆï¼›</p>
<p>ä¸‹é¢ä»‹ç»ç‰¹å¾é€‰æ‹©çš„æ–¹æ³•ã€‚</p>
<h2 id="æ ¹æ®é‡è¦æ€§é€‰æ‹©ï¼ˆçº¿æ€§çš„ï¼‰">5.1. æ ¹æ®é‡è¦æ€§é€‰æ‹©ï¼ˆçº¿æ€§çš„ï¼‰</h2><ul>
<li>ç»™æ¯ä¸ªç‰¹å¾ç®—ä¸€ä¸ªæƒé‡ï¼ˆåˆ†æ•°ï¼‰</li>
<li>é—®é¢˜ï¼šç‰¹å¾é€‰æ‹©æ˜¯çº¿æ€§çš„ï¼Œä¸ç¬¦åˆéšæœºæ£®æ—çš„éçº¿æ€§ç‰¹ç‚¹</li>
</ul>
<h2 id="ç½®æ¢æ£€éªŒï¼ˆéçº¿æ€§çš„ï¼ŒPermutation-Testï¼‰">5.2. ç½®æ¢æ£€éªŒï¼ˆéçº¿æ€§çš„ï¼ŒPermutation Testï¼‰</h2><p>é—®é¢˜ï¼šæ¯ä¸ªç‰¹å¾æ˜¯æœ‰å™ªéŸ³çš„ï¼Œç”±äºå™ªéŸ³çš„å­˜åœ¨ï¼Œå¯¼è‡´æŸäº›åŸæœ¬å¾ˆä¼˜ç§€çš„ç‰¹å¾çš„åˆ†æ•°è¢«é™ä½</p>
<p>è§£å†³æ–¹æ³•ï¼šå°†ç¬¬iä¸ªç»´åº¦ç‰¹å¾çš„æ‰€æœ‰æ•°æ®é‡æ–°çš„éšæœºè°ƒæ•´ä½ç½®ï¼Œç„¶åæ¯”è¾ƒä¸€ä¸‹åŸå§‹æ•°æ®å’Œè°ƒæ•´ä¹‹åçš„æ•°æ®è¡¨ç°çš„å·®è·ï¼Œæ¥è¯„ä»·è¿™ä¸ªç»´åº¦çš„ç‰¹å¾æ˜¯æœ‰å¤šä¹ˆé‡è¦ã€‚</p>
<ul>
<li>è°ƒæ•´æ–¹æ³•1ï¼šé«˜æ–¯ä»€ä¹ˆçš„ï¼Œä½†ä¼šæ”¹å˜æ•°æ®åŸå§‹åˆ†å¸ƒ</li>
<li>è°ƒæ•´æ–¹æ³•2ï¼šéšæœºé‡æ’ï¼Œå³ç½®æ¢æ£€éªŒã€‚å°†æŸä¸€ç»´åº¦çš„æ•°æ®éšæœºé‡æ’ï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªç»´åº¦æœ‰å¤šé‡è¦ã€‚</li>
</ul>
<h2 id="åœ¨Out-Of-Bag-Estimateè¿‡ç¨‹ä¸­åšPermutation-Test">5.3. åœ¨Out-Of-Bag Estimateè¿‡ç¨‹ä¸­åšPermutation Test</h2><p>åœ¨éšæœºæ£®æ—ä¸­å¯ä»¥ç”¨OOBä»£æ›¿éªŒè¯çš„è¿‡ç¨‹ï¼Œä¸ºäº†ç®€åŒ–Permutation Testå¸¦æ¥çš„é‡æ–°è¿›è¡Œè®­ç»ƒçš„ä»£ä»·ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨OOB Exampleï¼ˆbootstrapè¿‡ç¨‹ä¸­æ²¡æœ‰é€‰å–çš„æ•°æ®ï¼‰è¿›è¡ŒéªŒè¯çš„è¿‡ç¨‹ä¸­åšä¸€äº›ä¿®æ”¹ï¼Œå³åœ¨éªŒè¯çš„æ—¶å€™å»è¿›è¡ŒPermutation Testï¼Œè€Œéè®­ç»ƒæ—¶è¿›è¡Œã€‚<br>åœ¨æ±‚Eoob(G)æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡G-(xn)æ¥è®¡ç®—ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå°†x(n)ä¿®æ”¹æˆx(n,i)ï¼Œå°±å¯ä»¥ä¸ç”¨å¯¹Gè¿›è¡Œä¿®æ”¹äº†ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-20-17-46.png" alt=""><br>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé¢å¯¹éçº¿æ€§çš„é—®é¢˜æ—¶ï¼Œå¯ä»¥é€šè¿‡éšæœºæ£®æ—çš„æ–¹æ³•æ¥è¿›è¡Œåˆæ­¥çš„ç‰¹å¾é€‰æ‹©ã€‚</p>
<p> <img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-20-16-21.png" alt=""> </p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<ol>
<li><a href="http://database.51cto.com/art/201407/444788.htm" target="_blank" rel="external">æœºå™¨å­¦ä¹ çš„ç®—æ³•(1):å†³ç­–æ ‘ä¹‹éšæœºæ£®æ—</a></li>
<li>æœºå™¨å­¦ä¹ æŠ€æ³•</li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[å†³ç­–æ ‘å’ŒCART]]></title>
      <url>/2017/03/05/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E5%86%B3%E7%AD%96%E6%A0%91%E5%92%8CCART/</url>
      <content type="html"><![CDATA[<h1 id="å†³ç­–æ ‘ç®€ä»‹">1. å†³ç­–æ ‘ç®€ä»‹</h1><p>æ¨¡ä»¿äººç±»å†³ç­–çš„è¿‡ç¨‹</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-12-43-33.png" alt=""> </p>
<ul>
<li>ä¼˜ç‚¹ï¼šå¥½ç†è§£ï¼›ç®€å•</li>
<li>ç¼ºç‚¹ï¼šç¼ºå°‘å¾ˆå¼ºçš„ç†è®ºæ”¯æŒï¼›æ ‘ç»“æ„ä¸å”¯ä¸€ï¼›</li>
</ul>
<h2 id="å†³ç­–æ ‘çš„è¡¨è¾¾æ–¹å¼">1.1. å†³ç­–æ ‘çš„è¡¨è¾¾æ–¹å¼</h2><p>å¦‚ä¸Šå›¾æ‰€ç¤ºçš„å†³ç­–æ ‘ï¼Œæˆ‘ä»¬ç”¨$G(x)$æ¥è¡¨è¾¾å†³ç­–æ ‘ï¼š</p>
<p>$$G(x)=\sum_{t=1}^T q_t(x)\cdot g_t(x) $$</p>
<p>tips:</p>
<ul>
<li>$g(x)$æ˜¯æœ€ç»ˆçš„å†³ç­–ï¼ˆ<code>Y or N</code>ï¼‰ï¼Œå¶å­èŠ‚ç‚¹</li>
<li>$q_t(x)$æ˜¯æ¡ä»¶ï¼Œ<code>condition</code>ã€‚å°±æ˜¯æ©˜è‰²ç®­å¤´çš„åˆ¤æ–­è¿‡ç¨‹</li>
<li>å†…éƒ¨çš„å†³ç­–è¿‡ç¨‹ï¼Œä¾‹å¦‚<code>deadline?</code>ï¼Œå†…éƒ¨èŠ‚ç‚¹</li>
</ul>
<p>é‚£ä¹ˆå†³ç­–æ ‘çš„è¡¨è¾¾å°±æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>è·¯å¾„è§’åº¦ã€‚å°†æ¯ä¸ªä»æ ¹åˆ°å¶å­çš„è·¯å¾„ä½œä¸ºä¸€ä¸ªå‡è®¾gï¼Œé€šè¿‡ä¸åŒçš„æ¡ä»¶ç»„åˆå¾—åˆ°æœ€åçš„G(X)ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-12-53-15.png" alt=""> </p>
</li>
<li><p>é€’å½’è§’åº¦ã€‚çˆ¶æ ‘æ˜¯ç”±å­æ ‘é€’å½’å®šä¹‰çš„<code>tree=(root,sub-trees)</code><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-12-53-25.png" alt=""> </p>
</li>
</ul>
<h2 id="åŸºæœ¬æµç¨‹">1.2. åŸºæœ¬æµç¨‹</h2><ol>
<li>å¦‚ä½•åˆ†æ”¯ï¼ˆbranching criteriaï¼‰ï¼Œå³å¦‚ä½•å¾—åˆ°$b(x)$</li>
<li>æ ¹æ®åˆ†æ”¯ï¼Œæ•°æ®å¦‚ä½•åˆ†å—</li>
<li>æ ¹æ®æ•°æ®ï¼Œå¦‚ä½•å­¦ä¹ å­æ ‘</li>
<li>å¾—åˆ°æœ€ç»ˆçš„å†³ç­–æ ‘</li>
</ol>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-15-33-51.png" alt=""> </p>
<h1 id="CARTç®—æ³•">2. CARTç®—æ³•</h1><ul>
<li>Classification And Regression Treeï¼Œåˆ†ç±»å›å½’æ ‘</li>
<li>äºŒå‰æ ‘ï¼ˆåªæœ‰æ˜¯ã€å¦ï¼‰</li>
<li>è¾“å…¥ï¼šéšæœºå˜é‡$X$</li>
<li>è¾“å‡ºï¼šéšæœºå˜é‡$Y$çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ</li>
<li>$g_t(x)$è¿”å›ä¸€ä¸ªå¸¸æ•°ï¼ˆæ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œåˆ°è¾¾å¶å­èŠ‚ç‚¹æ—¶ï¼Œæ ¹æ®å‰©ä¸‹çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œè¾“å‡ºä¸€ä¸ªå¸¸æ•°ï¼‰</li>
</ul>
<h2 id="çº¯åº¦">2.1. çº¯åº¦</h2><h3 id="çº¯åº¦çš„å®šä¹‰">2.1.1. çº¯åº¦çš„å®šä¹‰</h3><ul>
<li>CARTç®—æ³•ä¸­æ¯ä¸ªèŠ‚ç‚¹ï¼ˆçœ‹åšæ˜¯ä¸€ä¸ªå†³ç­–æ¡©decision stumpï¼‰å¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œå¦‚æœåˆ†å‡ºæ¥çš„æ•°æ®çš„yéƒ½å¾ˆæ¥è¿‘ï¼ˆå›å½’é—®é¢˜ï¼‰æˆ–è€…éƒ½ä¸€æ ·ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´è¿™æ ·çš„æ•°æ®æ˜¯â€œçº¯çš„â€ï¼Œè¿™æ ·ç”¨æ ‡é‡å¯¹æ•°æ®è¿›è¡Œé¢„æµ‹å¯ä»¥å¾—åˆ°æ¯”è¾ƒå°çš„è¯¯å·®ã€‚</li>
</ul>
<p>CARTåˆ†æ”¯$b(x)$ä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-16-03-33.png" alt=""> </p>
<ul>
<li>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„å…¬å¼ï¼Œæ¥è®¡ç®—å¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å†³ç­–æ¡©æ¥è¯´ï¼Œåˆ†å‡ºæ¥çš„ä¸¤ä»½æ•°æ®çš„çº¯åº¦æ˜¯æ€æ ·çš„ã€‚</li>
<li>è¯¥å…¬å¼é€šè¿‡è®¡ç®—æ•°æ®é›†<code>Diï¼ˆi=1 or 2ï¼‰</code>çš„çº¯åº¦å¹¶æ ¹æ®æ•°æ®é›†çš„æ•°é‡å¯¹å…¶è¿›è¡ŒåŠ æƒ</li>
<li>å…¶åŠ æƒçš„æ„ä¹‰æ˜¯å¦‚æœæ•°æ®é›†çš„æ•°é‡æ¯”è¾ƒå¤§çš„è¯ï¼Œé‚£ä¸ªçº¯åº¦å¯¹å…¶æ¯”è¾ƒé‡è¦</li>
<li>åä¹‹ï¼Œå°±ä¸é‚£ä¹ˆé‡è¦ã€‚</li>
<li>CARTé€šè¿‡åˆ†å‡ºçš„ä¸¤éƒ¨åˆ†æ•°æ®ç»¼åˆèµ·æ¥çš„çº¯åº¦å¯¹å†³ç­–æ¡©è¿›è¡Œé€‰æ‹©ï¼Œé€‰æ‹©â€œæœ€çº¯â€çš„åˆ†å‰²æ–¹å¼ä½œä¸ºå½“å‰çš„åˆ†æ”¯ã€‚</li>
</ul>
<h3 id="çº¯åº¦çš„è®¡ç®—å‡½æ•°">2.1.2. çº¯åº¦çš„è®¡ç®—å‡½æ•°</h3><p>æˆ‘ä»¬å¯ä»¥å°†åˆ†å‰²å‡ºæ¥çš„æ•°æ®å’Œå›ä¼ çš„å¸¸æ•°çš„è¯¯å·®ä½œä¸ºè¯„ä»·çº¯åº¦çš„æ–¹æ³•ï¼Œåˆ©ç”¨æ•°æ®çš„yå’Œå›ä¼ çš„y_baçš„å‡æ–¹è¯¯å·®æ¥è¯„ä»·å›å½’é—®é¢˜çš„çº¯åº¦ï¼›åˆ©ç”¨0/1è¯¯å·®å‡½æ•°æ¥è¯„ä»·åˆ†ç±»é—®é¢˜çš„çº¯åº¦ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-16-11-16.png" alt=""> </p>
<p>å¦‚æœæ˜¯åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåˆ«çš„æ–¹æ³•ã€‚é€šè¿‡åŸºå°¼ä¸çº¯åº¦æ¥åº¦é‡åˆ†ç±»é—®é¢˜çš„çº¯åº¦é—®é¢˜ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-16-11-41.png" alt=""> </p>
<h2 id="ç»ˆæ­¢æ¡ä»¶">2.2. ç»ˆæ­¢æ¡ä»¶</h2><p>CARTä¸­æœ‰ä¸¤ç§è¢«è¿«ç»ˆæ­¢çš„æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><code>yn</code>éƒ½ä¸€æ ·ï¼Œè¿™æ—¶ä¸çº¯åº¦ä¸º0ï¼Œäºæ˜¯å¯ä»¥å¾—åˆ°<code>gt(x)=yn</code>ï¼›</li>
<li><code>xn</code>éƒ½ä¸€æ ·ï¼Œå°±æ²¡æœ‰ç»§ç»­åˆ†å‰²çš„å¯èƒ½äº†ã€‚</li>
<li>CARTæ ‘é•¿åˆ°è¢«è¿«åœä¸‹æ¥çš„æƒ…å†µï¼Œç§°ä¸ºå®Œå…¨é•¿æˆçš„æ ‘ï¼ˆfully-grown treeï¼‰ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯CARTç®—æ³•å®Œæ•´æµç¨‹ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-16-19-09.png" alt=""> </p>
<h2 id="CARTå‰ªæ">2.3. CARTå‰ªæ</h2><p>é¢„é˜²è¿‡æ‹Ÿåˆ</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-05-16-20-48.png" alt=""> </p>
<p>ä¸Šå›¾å‘Šè¯‰æˆ‘ä»¬ä½¿ç”¨å¶å­çš„æ•°ç›®ä½œä¸ºæ­£åˆ™é¡¹ï¼ˆregularizerï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ­£åˆ™åŒ–çš„å†³ç­–æ ‘ã€‚<br>å…³äºå‰ªæçš„å…·ä½“åšæ³•æ—¶ï¼š</p>
<ul>
<li>é¦–å…ˆå¾—åˆ°å®Œå…¨é•¿æˆçš„æ ‘ä½œä¸º<code>G(0)</code>ï¼›</li>
<li>ç„¶åè¯•å›¾æ‘˜æ‰ä¸€ç‰‡å¶å­ï¼Œå°†æ‰€æœ‰æ‘˜æ‰ä¸€ç‰‡å¶å­åçš„æ ‘è®¡ç®—<code>Ein</code>ï¼Œå°†æœ€å°çš„é‚£æ£µæ‘˜æ‰ä¸€ç‰‡å¶å­çš„æ•°ä½œä¸º<code>G(1)</code>ï¼›</li>
<li>å¦‚æ­¤è¿™èˆ¬ï¼Œå¾—åˆ°æ‘˜æ‰ä¸¤ç‰‡å¶å­çš„æœ€ä¼˜æ ‘<code>G(2)</code>ï¼Œè¿™æ ·ä¸æ–­å‰ªæï¼Œç›´åˆ°æ ¹ç»“ç‚¹ï¼Œå½¢æˆä¸€ä¸ªå­æ ‘åºåˆ—ï¼›</li>
<li>æœ€ç»ˆå¯¹è¿™ä¸ªå­æ ‘åºåˆ—ä½¿ç”¨<code>argmin Ein(G)+Î»Î©(G)</code>æ¥å¾—åˆ°æœ€åçš„è¾“å‡ºã€‚</li>
</ul>
<h1 id="å‚è€ƒèµ„æ–™">3. å‚è€ƒèµ„æ–™</h1><ol>
<li><a href="http://blog.jasonding.top/2015/07/22/Machine%20Learning/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E3%80%91%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95/" target="_blank" rel="external">Jason Dingï¼Œå†³ç­–æ ‘ç®—æ³•</a></li>
<li>æœºå™¨å­¦ä¹ æŠ€æ³•è¯¾ç¨‹ï¼Œæ—è½©ç”°ï¼Œå°æ¹¾å¤§å­¦</li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-boostingå’Œbagging]]></title>
      <url>/2017/03/04/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-boosting%E5%92%8Cbagging/</url>
      <content type="html"><![CDATA[<p>è¿™ä½å‰è¾ˆå†™çš„å¾ˆå¥½ã€‚ä»Šå¤©ä¹Ÿæ²¡æœ‰æ—¶é—´çœ‹è§†é¢‘ã€‚çœ‹çœ‹ä»–çš„åšå®¢ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚<a href="http://blog.jasonding.top/2015/06/10/Machine%20Learning/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E3%80%91%E6%B7%B7%E5%90%88%E5%92%8C%E8%A3%85%E8%A2%8B/" target="_blank" rel="external">æ··åˆå’Œè£…è¢‹</a></p>
<h1 id="bagging">1. bagging</h1><p>baggingâ€”â€”åŸºäºæ•°æ®éšæœºé‡æŠ½æ ·çš„åˆ†ç±»å™¨æ„å»ºæ–¹æ³•ã€‚</p>
<h1 id="boosting">2. boosting</h1><p>æ–°çš„åˆ†ç±»å™¨æ ¹æ®å·²è®­ç»ƒå‡ºçš„åˆ†ç±»å™¨çš„æ€§èƒ½æ¥è¿›è¡Œè®­ç»ƒï¼›<br>åˆ†ç±»ç»“æœåŸºäºæ‰€æœ‰åˆ†ç±»å™¨çš„åŠ æƒæ±‚å’Œå¾—åˆ°ã€‚</p>
<h1 id="baggingå’ŒboostingåŒºåˆ«">3. baggingå’ŒboostingåŒºåˆ«</h1><p>Bagging æ˜¯ Bootstrap Aggregating çš„ç®€ç§°ï¼Œæ„æ€å°±æ˜¯å†å–æ · (Bootstrap) ç„¶ååœ¨æ¯ä¸ªæ ·æœ¬ä¸Šè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å–å¹³å‡ï¼Œæ‰€ä»¥æ˜¯é™ä½æ¨¡å‹çš„ variance. Bagging æ¯”å¦‚ Random Forest è¿™ç§å…ˆå¤©å¹¶è¡Œçš„ç®—æ³•éƒ½æœ‰è¿™ä¸ªæ•ˆæœã€‚</p>
<p>Boosting åˆ™æ˜¯è¿­ä»£ç®—æ³•ï¼Œæ¯ä¸€æ¬¡è¿­ä»£éƒ½æ ¹æ®ä¸Šä¸€æ¬¡è¿­ä»£çš„é¢„æµ‹ç»“æœå¯¹æ ·æœ¬è¿›è¡ŒåŠ æƒï¼Œæ‰€ä»¥éšç€è¿­ä»£ä¸æ–­è¿›è¡Œï¼Œè¯¯å·®ä¼šè¶Šæ¥è¶Šå°ï¼Œæ‰€ä»¥æ¨¡å‹çš„ bias ä¼šä¸æ–­é™ä½ã€‚è¿™ç§ç®—æ³•æ— æ³•å¹¶è¡Œï¼Œä¾‹å­æ¯”å¦‚ Adaptive Boosting.</p>
<p>ä½œè€…ï¼šåŒ¿åç”¨æˆ·<br>é“¾æ¥ï¼š<a href="https://www.zhihu.com/question/26760839/answer/33963551" target="_blank" rel="external">https://www.zhihu.com/question/26760839/answer/33963551</a><br>æ¥æºï¼šçŸ¥ä¹<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒã€‚</p>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[O2Oä¼˜æƒ åˆ¸é¢„æµ‹â€”â€”æ€è·¯æ€»ç»“]]></title>
      <url>/2017/03/03/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-O2O%E4%BC%98%E6%83%A0%E5%88%B8%E9%A2%84%E6%B5%8B-%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹å„ç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ„Ÿè§‰æ²¡æœ‰å®æˆ˜ï¼Œæ€»æ˜¯ç©ºç©ºçš„ã€‚åˆšå¥½è¿™ä¸ªæœˆæ²¡ä»€ä¹ˆäº‹æƒ…ï¼Œè¶æ­¤æœºä¼šæ‹¿<a href="https://tianchi.shuju.aliyun.com/getStart/information.htm?spm=5176.100067.5678.2.SfEzJi&amp;raceId=231593" target="_blank" rel="external">èµ›é¢˜</a>ç»ƒä¹ ä¸€ä¸‹ã€‚</p>
<h1 id="èµ„æ–™æ•´ç†">1. èµ„æ–™æ•´ç†</h1><ol>
<li><a href="https://github.com/wepe/O2O-Coupon-Usage-Forecast" target="_blank" rel="external">é˜¿é‡Œå¤©æ± O2Oä¼˜æƒ åˆ¸æ¶ˆè´¹è¡Œä¸ºé¢„æµ‹ç«èµ›ä¼˜èƒœæ–¹æ¡ˆ</a>ã€‚ç¬¬ä¸€åã€‚åŒ—å¤§ã€‚è§£é¢˜æ€è·¯ã€‚</li>
<li><a href="http://blog.csdn.net/shine19930820/article/details/53995369" target="_blank" rel="external">O2Oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹æ€è·¯æ€»ç»“</a>ã€‚16åã€‚è§£é¢˜æ€è·¯ã€‚</li>
<li><a href="http://blog.csdn.net/bryan__/article/details/53907292" target="_blank" rel="external">O2Oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹å¤èµ›ç¬¬ä¸‰åæ€è·¯</a>ã€‚3åã€‚PPT.</li>
<li><a href="https://www.zhihu.com/question/42154455/answer/124080774" target="_blank" rel="external">å„ç«èµ›QQç¾¤</a></li>
<li><a href="http://www.datafountain.cn/data/science/player/competition/detail/description/238" target="_blank" rel="external">ç«èµ›å®˜ç½‘</a></li>
<li><a href="https://bbs.aliyun.com/thread/254.html?spm=5176.bbsl254.0.0.sBagXf&amp;type=1214&amp;type=1214#tabA" target="_blank" rel="external">è®ºå›ä¸“åŒº</a></li>
<li><a href="https://tianchi.shuju.aliyun.com/getStart/introduction.htm?spm=5176.100066.333.1.osUTZq&amp;raceId=231593" target="_blank" rel="external">å¤©æ± æ–°äººå®æˆ˜èµ›[o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹]</a></li>
<li>ä¹Ÿå¯ä»¥å»å¤©æ± å®˜ç½‘ä¸Šï¼Œç‚¹å­¦ä¹ å…¥å£ï¼Œä¸‹é¢çš„è§†é¢‘ï¼Œè¿™è¾¹ä¹Ÿæœ‰å¯¹è¿™æ¬¡020æ¯”èµ›çš„ä¸€äº›è§†é¢‘è§£è¯´ </li>
<li><a href="https://bbs.aliyun.com/read/273638.html" target="_blank" rel="external">æ•°åŠ å¹³å°æŒ‡å—ï¼‹æ–‡æ¡£ã€è§†é¢‘ã€FAQåŠç²¾åå¸–å¹²è´§é›†é”¦</a></li>
<li><a href="http://www.jianshu.com/p/00dba98eb1d0" target="_blank" rel="external">æ•°æ®ç§‘å­¦å®Œæ•´å­¦ä¹ è·¯å¾„</a></li>
</ol>
<h1 id="èµ›é¢˜èƒŒæ™¯">2. èµ›é¢˜èƒŒæ™¯</h1><ul>
<li>O2Oï¼ˆOnline to Offlineï¼‰æ¶ˆè´¹</li>
<li>O2Oï¼šæ˜¯æŒ‡å°†çº¿ä¸‹çš„å•†åŠ¡æœºä¼šä¸äº’è”ç½‘ç»“åˆï¼Œè®©äº’è”ç½‘æˆä¸ºçº¿ä¸‹äº¤æ˜“çš„å¹³å°</li>
<li>ä»¥ä¼˜æƒ åˆ¸ç›˜æ´»è€ç”¨æˆ·æˆ–å¸å¼•æ–°å®¢æˆ·è¿›åº—æ¶ˆè´¹æ˜¯O2Oçš„ä¸€ç§é‡è¦è¥é”€æ–¹å¼</li>
</ul>
<h1 id="èµ›é¢˜ç›®æ ‡">3. èµ›é¢˜ç›®æ ‡</h1><ul>
<li>ä¸ªæ€§åŒ–æŠ•æ”¾ä¼˜æƒ åˆ¸ï¼Œæé«˜æ ¸é”€ç‡</li>
<li>é€šè¿‡åˆ†æå»ºæ¨¡ï¼Œç²¾å‡†é¢„æµ‹ç”¨æˆ·æ˜¯å¦ä¼šåœ¨è§„å®šæ—¶é—´å†…ä½¿ç”¨ç›¸åº”ä¼˜æƒ åˆ¸</li>
<li>å·²çŸ¥ï¼šç”¨æˆ·åœ¨2016å¹´1æœˆ1æ—¥è‡³2016å¹´6æœˆ30æ—¥ä¹‹é—´çœŸå®çº¿ä¸Šçº¿ä¸‹æ¶ˆè´¹è¡Œä¸º</li>
<li>é¢„æµ‹ï¼šç”¨æˆ·åœ¨2016å¹´7æœˆé¢†å–ä¼˜æƒ åˆ¸å15å¤©ä»¥å†…çš„ä½¿ç”¨æƒ…å†µ</li>
<li>è¯„ä»·æ ‡å‡†ï¼šä¼˜æƒ åˆ¸æ ¸é”€é¢„æµ‹çš„å¹³å‡AUCï¼ˆROCæ›²çº¿ä¸‹é¢ç§¯ï¼‰ã€‚å³å¯¹æ¯ä¸ªä¼˜æƒ åˆ¸coupon_idå•ç‹¬è®¡ç®—æ ¸é”€é¢„æµ‹çš„AUCå€¼ï¼Œå†å¯¹æ‰€æœ‰ä¼˜æƒ åˆ¸çš„AUCå€¼æ±‚å¹³å‡ä½œä¸ºæœ€ç»ˆçš„è¯„ä»·æ ‡å‡†ã€‚ å…³äºAUCçš„å«ä¹‰ä¸å…·ä½“è®¡ç®—æ–¹æ³•ï¼Œå¯å‚è€ƒç»´åŸºç™¾ç§‘</li>
</ul>
<h1 id="æ•°æ®æè¿°åŠåˆ†æ">4. æ•°æ®æè¿°åŠåˆ†æ</h1><h4 id="æ•°æ®æè¿°">4.0.0.1. æ•°æ®æè¿°</h4><ul>
<li>Table 1: ç”¨æˆ·çº¿ä¸‹æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸ºï¼Œccf_offline_stage1_train.csv</li>
<li>Table 2: ç”¨æˆ·çº¿ä¸Šç‚¹å‡»/æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸ºï¼Œccf_online_stage1_train</li>
<li>Table 3ï¼šç”¨æˆ·O2Oçº¿ä¸‹ä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹æ ·æœ¬ï¼Œccf_offline_stage1_test_revised.csv</li>
<li>Table 4ï¼šé€‰æ‰‹æäº¤æ–‡ä»¶å­—æ®µï¼Œå…¶ä¸­user_id,coupon_idå’Œdate_receivedå‡æ¥è‡ªTable 3,è€ŒProbabilityä¸ºé¢„æµ‹å€¼</li>
</ul>
<p><strong> TABLE 1ï¼š ç”¨æˆ·çº¿ä¸‹æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º </strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-21-57-25.png" alt=""> </p>
<p><strong> Table 2: ç”¨æˆ·çº¿ä¸Šç‚¹å‡»/æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-21-58-04.png" alt=""> </p>
<p><strong> Table 3ï¼šç”¨æˆ·O2Oçº¿ä¸‹ä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹æ ·æœ¬</strong><br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-21-58-29.png" alt=""> </p>
<p><strong> Table 4é€‰æ‰‹æäº¤æ–‡ä»¶å­—æ®µ</strong><br>å…¶ä¸­user_id,coupon_idå’Œdate_receivedå‡æ¥è‡ªTable 3,è€ŒProbabilityä¸ºé¢„æµ‹å€¼<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-21-58-40.png" alt=""> </p>
<h4 id="æ•°æ®åˆ†æ">4.0.0.2. æ•°æ®åˆ†æ</h4><h3 id="åˆæ­¥åˆ†æ">4.0.1. åˆæ­¥åˆ†æ</h3><p><strong> TABLE 1 åˆ†æ </strong></p>
<ul>
<li>ç‰¹ç‚¹ï¼š<br>â€“ æ ‡é¢˜ï¼šç”¨æˆ·çº¿ä¸‹æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º<br>â€“ åœºæ™¯ï¼šçº¿ä¸‹<br>â€“ è¡Œä¸ºï¼šæ¶ˆè´¹ã€ä¼˜æƒ åˆ¸é¢†å–<br>â€“ æ•°æ®ï¼šä¼˜æƒ åˆ¸é¢†å–ã€ä½¿ç”¨æƒ…å†µï¼Œæ¶ˆè´¹æƒ…å†µï¼Œç”¨æˆ·å¸¸æ´»åŠ¨åœ°ç‚¹ä¸æœ€è¿‘é—¨åº—è·ç¦»</li>
<li>åˆ†æ1ï¼šç”¨æˆ·è¡Œä¸ºæœ‰ä¸‰ç§æƒ…å†µ<br>â€“ é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; æœªæ¶ˆè´¹ = è´Ÿæ ·æœ¬ ï¼ˆDate=null &amp; Coupon_id != nullï¼‰<br>â€“ æ²¡é¢†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹ï¼ˆDate!=null &amp; Coupon_id = nullï¼‰<br>â€“ é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹ï¼ˆDate!=null &amp; Coupon_id != nullï¼‰<br>â€“ æ€»ç»“ï¼šæœ¬æ•°æ®ä½œä¸ºåˆ»ç”»ç”¨æˆ·ç‰¹ç‚¹çš„ä¸»è¦ä¾æ®è¾ƒä¸ºåˆç†</li>
<li>åˆ†æ2ï¼šä¼˜æƒ ç‡<br>â€“ æ€»ç»“ï¼šæœ‰å¯èƒ½ç”¨æˆ·ä¼šæ ¹æ®ä¼˜æƒ ç‡æ¥å†³å®šæ˜¯å¦è¿›è¡Œæ¶ˆè´¹</li>
<li>åˆ†æ3ï¼šè·ç¦»<br>â€“ ç¦»ç”¨æˆ·è¿‘çš„é—¨åº—å¯èƒ½ä¼šæ€»é¢†å–ä¼˜æƒ åˆ¸ï¼Œä½†ä¸ä¸€å®šä¼šä½¿ç”¨ã€‚<br>â€“ ç¦»ç”¨æˆ·è¿œçš„é—¨åº—å¦‚æœæœ‰ä¼˜æƒ åˆ¸ï¼Œåˆ™å¯èƒ½ä¼šä¸ºäº†å¾ˆå¤§çš„ä¼˜æƒ ç‡ä¸“ç¨‹å»ä½¿ç”¨ã€‚</li>
<li>æ€»ç»“<br>â€“ æœ¬æ•°æ®é›†ä¸»è¦åˆ»ç”»çº¿ä¸‹ç”¨æˆ·ç‰¹å¾ã€‚</li>
</ul>
<p><strong> TABLE 2 åˆ†æ </strong></p>
<ul>
<li>ç‰¹ç‚¹ï¼š<br>â€“ æ ‡é¢˜ï¼šç”¨æˆ·çº¿ä¸Šç‚¹å‡»/æ¶ˆè´¹å’Œä¼˜æƒ åˆ¸é¢†å–è¡Œä¸º<br>â€“ åœºæ™¯ï¼šçº¿ä¸Š<br>â€“ è¡Œä¸ºï¼šç‚¹å‡»ã€æ¶ˆè´¹ã€ä¼˜æƒ åˆ¸é¢†å–<br>â€“ æ•°æ®ï¼šç”¨æˆ·æ˜¯å¦ç‚¹å‡»ã€‚è´­ä¹°ã€‚é¢†å–ä¼˜æƒ åˆ¸ã€‚</li>
<li>åˆ†æ1ï¼šç”¨æˆ·è¡Œä¸ºæœ‰ä¸‰ç§æƒ…å†µ<br>â€“ é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; æœªæ¶ˆè´¹ = è´Ÿæ ·æœ¬ï¼ˆDate=null &amp; Coupon_id != nullï¼‰<br>â€“ æ²¡é¢†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹ ï¼ˆDate!=null &amp; Coupon_id = nullï¼‰<br>â€“ é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹ ï¼ˆDate!=null &amp; Coupon_id != nullï¼‰</li>
<li>åˆ†æ2ï¼šç”¨æˆ·ç‚¹å‡»ã€æ¶ˆè´¹ã€ä¼˜æƒ åˆ¸æƒ…å†µ<br>â€“ ç”¨æˆ·ç‚¹å‡»äº† &amp;&amp; æ²¡é¢†ä¼˜æƒ åˆ¸ &amp;&amp; æœªæ¶ˆè´¹ = è´Ÿæ ·æœ¬<br>â€“ ç”¨æˆ·ç‚¹å‡»äº† &amp;&amp; é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; æœªæ¶ˆè´¹<br>â€“ ç”¨æˆ·ç‚¹å‡»äº† &amp;&amp; é¢†äº†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹<br>â€“ ç”¨æˆ·ç‚¹å‡»äº† &amp;&amp; æ²¡é¢†ä¼˜æƒ åˆ¸ &amp;&amp; å·²æ¶ˆè´¹<br>â€“ ç”¨æˆ·æ²¡ç‚¹å‡» </li>
<li>æ€»ç»“<br>â€“ æœ¬æ•°æ®é›†ä¸»è¦åˆ»ç”»çº¿ä¸Šç”¨æˆ·ç‰¹å¾ã€‚</li>
</ul>
<p><strong> Table 3ï¼šç”¨æˆ·O2Oçº¿ä¸‹ä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹æ ·æœ¬ </strong></p>
<ul>
<li>æµ‹è¯•é›†</li>
</ul>
<h3 id="è®¤è¯†æ•°æ®">4.0.2. è®¤è¯†æ•°æ®</h3><p>æ„Ÿè°¢weponçš„<a href="https://tianchi.shuju.aliyun.com/video.htm?spm=5176.100258.100258.3.1O7LLR" target="_blank" rel="external">æ— ç§å¥‰çŒ®</a></p>
<p>å¯¹æä¾›çš„æ•°æ®åšä¸€äº›åŸºæœ¬çš„ç»Ÿè®¡ï¼Œæœ‰åŠ©äºå¯¹èµ›é¢˜çš„ç†è§£ï¼Œå¯ä»¥ç†Ÿæ‚‰ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæ–¹ä¾¿åé¢çš„ç‰¹å¾å·¥ç¨‹ã€‚</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-12-21-38-50.png" alt=""> </p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-12-21-39-13.png" alt=""> </p>
<h1 id="ç‰¹å¾æå–">5. ç‰¹å¾æå–</h1><ul>
<li>ç‰¹å¾æå–ï¼šå°†åŸå§‹ç‰¹å¾è½¬æ¢ä¸ºä¸€ç»„å…·æœ‰æ˜æ˜¾ç‰©ç†æ„ä¹‰ï¼ˆGaborã€å‡ ä½•ç‰¹å¾[è§’ç‚¹ã€ä¸å˜é‡]ã€çº¹ç†[LBP HOG]ï¼‰æˆ–è€…ç»Ÿè®¡æ„ä¹‰æˆ–æ ¸çš„ç‰¹å¾</li>
<li>ç»éªŒä¸Šæ¥è¯´ï¼Œè¿™äº›ç‰¹å¾æå–çš„è¶Šå¤šè¶Šå¥½ï¼Œå¹¶ä¸ç”¨æ‹…å¿ƒç‰¹å¾è¿‡å¤šï¼Œå› ä¸ºæ¨èç³»ç»Ÿçš„æ•°æ®é‡éƒ½æ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”åŸºäºä¸€äº›è§„åˆ™å¯ä»¥å¾ˆå¥½çš„ç­›é€‰ç‰¹å¾ã€‚</li>
<li>ç¬¬ä¸€æ¬¡åšç‰¹å¾æå–ï¼Œå¾ˆå¤šä¸œè¥¿æƒ³å¾—ä¸å¤Ÿå‘¨åˆ°ã€‚å‚è€ƒäº†å¾ˆå¤šç¬¬ä¸€åçš„æ€æƒ³ã€‚</li>
</ul>
<h4 id="ç”¨æˆ·ç‰¹å¾">5.0.0.1. ç”¨æˆ·ç‰¹å¾</h4><p>ç”¨é€”ï¼šæè¿°ç”¨æˆ·æ¶ˆè´¹åå¥½</p>
<p>çº¿ä¸‹ï¼š</p>
<ol>
<li>é¢†å–ä¼˜æƒ åˆ¸ç‡ï¼ˆé¢†å–æ¬¡æ•°/æ€»æ¬¡æ•°ï¼‰</li>
<li>ä¼˜æƒ åˆ¸æ ¸é”€ç‡ï¼ˆä¼˜æƒ åˆ¸ä½¿ç”¨æ¬¡æ•°/ä¼˜æƒ åˆ¸é¢†å–æ¬¡æ•°ï¼‰</li>
<li>æ¶ˆè´¹ç‡ï¼ˆæ¶ˆè´¹æ¬¡æ•°/æ€»æ¬¡æ•°ï¼‰</li>
<li>æ ¸é”€æ—¶çš„ä¼˜æƒ ç‡</li>
<li>é¢†å–ã€ä½¿ç”¨ä¼˜æƒ åˆ¸é—´éš”</li>
<li>userç»å¸¸æ´»åŠ¨çš„åœ°ç‚¹ç¦»å¹³å‡/æœ€å¤§/æœ€å°ç”¨æˆ·-å•†å®¶çš„æœ€è¿‘é—¨åº—è·ç¦»</li>
<li>æ¶ˆè´¹é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸é¢†å–é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸ä½¿ç”¨é¢‘æ•°</li>
<li>ç”¨æˆ·æ»¡å‡ä¼˜æƒ åˆ¸æ ¸é”€ç‡ï¼ˆæ»¡å‡ä¼˜æƒ åˆ¸ä½¿ç”¨æ¬¡æ•°/ä¼˜æƒ åˆ¸é¢†å–æ¬¡æ•°ï¼‰</li>
<li>ç”¨æˆ·æ»¡å‡ä¼˜æƒ åˆ¸æ ¸é”€æ¯”é‡ï¼ˆæ»¡å‡ä¼˜æƒ åˆ¸ä½¿ç”¨æ¬¡æ•°/ä¼˜æƒ åˆ¸ä½¿ç”¨æ¬¡æ•°ï¼‰</li>
<li>æ ¸é”€ä¼˜æƒ åˆ¸çš„å¹³å‡/æœ€ä½/æœ€é«˜æ¶ˆè´¹æ‰“ç‡</li>
<li>æ ¸é”€è¿‡çš„å•†æˆ·æ•°é‡ï¼Œä»¥åŠä¸åŒå•†å®¶çš„æ¯”é‡</li>
<li>æ ¸é”€è¿‡çš„ä¸åŒä¼˜æƒ åˆ¸æ•°é‡ï¼Œä»¥åŠå…¶ä¸ä¼˜æƒ åˆ¸ç§ç±»æ•°çš„æ¯”é‡</li>
<li>å¹³å‡æ¯ä¸ªå•†å®¶æ ¸é”€å¤šå°‘å¼ ä¼˜æƒ åˆ¸</li>
</ol>
<p>çº¿ä¸Šï¼š</p>
<ol>
<li>ä¼˜æƒ åˆ¸é¢†å–ç‡ï¼ˆé¢†å–/æ€»ï¼‰</li>
<li>ç‚¹å‡»é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸é¢†å–é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸ä½¿ç”¨é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸æ ¸é”€ç‡ï¼ˆä½¿ç”¨/é¢†å–ï¼‰</li>
<li>æ¶ˆè´¹é¢‘æ•°</li>
<li>æ¶ˆè´¹ç‡ï¼ˆæ¶ˆè´¹æ¬¡æ•°/æ€»ï¼‰</li>
<li>æ ¸é”€æ—¶çš„ä¼˜æƒ ç‡</li>
<li>é¢†å–ã€ä½¿ç”¨ä¼˜æƒ åˆ¸é—´éš”</li>
<li>ç”¨æˆ·çº¿ä¸Šä¸æ¶ˆè´¹æ¬¡æ•°</li>
<li>ç”¨æˆ·çº¿ä¸‹ä¸æ¶ˆè´¹æ¬¡æ•°å çº¿ä¸Šçº¿ä¸‹æ€»çš„ä¸æ¶ˆè´¹æ¬¡æ•°çš„æ¯”é‡</li>
<li>ç”¨æˆ·çº¿ä¸‹çš„ä¼˜æƒ åˆ¸æ ¸é”€æ¬¡æ•°å çº¿ä¸Šçº¿ä¸‹æ€»çš„ä¼˜æƒ åˆ¸æ ¸é”€æ¬¡æ•°çš„æ¯”é‡</li>
</ol>
<h4 id="çº¿ä¸‹æ¶ˆè´¹çš„ä¼˜æƒ åˆ¸ç‰¹å¾">5.0.0.2. çº¿ä¸‹æ¶ˆè´¹çš„ä¼˜æƒ åˆ¸ç‰¹å¾</h4><ol>
<li>ä¼˜æƒ ç‡</li>
<li>ä¼˜æƒ åˆ¸è¢«é¢†å–æ¬¡æ•°</li>
<li>ä¼˜æƒ åˆ¸æ ¸é”€ç‡</li>
<li>é¢†å–ã€ä½¿ç”¨ä¼˜æƒ åˆ¸é—´éš”</li>
</ol>
<h4 id="çº¿ä¸Šå•†æˆ·ç‰¹å¾">5.0.0.3. çº¿ä¸Šå•†æˆ·ç‰¹å¾</h4><ol>
<li>ç‚¹å‡»é¢‘æ•°</li>
<li>è´­ä¹°é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸è¢«é¢†å–é¢‘æ•°</li>
<li>ä¼˜æƒ åˆ¸è¢«ä½¿ç”¨é¢‘æ•°</li>
<li>æ¶ˆè´¹ç‡ï¼ˆè´­ä¹°/æ€»ï¼‰</li>
<li>ä¼˜æƒ åˆ¸é¢†å–ç‡ï¼ˆé¢†å–/æ€»ï¼‰</li>
<li>ä¼˜æƒ åˆ¸æ ¸é”€ç‡ï¼ˆä½¿ç”¨/é¢†å–ï¼‰</li>
<li>ä¼˜æƒ ç‡</li>
<li>é¢†å–ã€ä½¿ç”¨ä¼˜æƒ åˆ¸é—´éš”</li>
</ol>
<p>ç°åœ¨é‡åˆ°äº†ä¸€äº›ç“¶é¢ˆã€‚å‚è€ƒäº†å‰äººçš„æ•™ç¨‹<a href="http://www.jianshu.com/p/00dba98eb1d0" target="_blank" rel="external">æ•°æ®ç§‘å­¦å®Œæ•´å­¦ä¹ è·¯å¾„</a>ï¼Œå‘ç°è‡ªå·±åŸºç¡€è¿˜æ˜¯ä¸å¤Ÿæ‰å®ã€‚å†³å®šå…ˆçœ‹çœ‹æœºå™¨å­¦ä¹ æŠ€æ³•æ•™ç¨‹ï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>
<p>=======2017.3.1======</p>
<p>çœ‹äº†ä¸€ä¸‹GBDTï¼Œå‘ç°æˆ‘çš„ç–‘é—®è¿˜æ˜¯ä¸èƒ½è§£å†³ã€‚</p>
<ul>
<li>å¤šç±»ç‰¹å¾ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</li>
<li>å¤„ç†çš„æµç¨‹ç©¶ç«Ÿæ˜¯æ€æ ·çš„ï¼Ÿ</li>
</ul>
<p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘å†³å®šå¼€å§‹æ·±å…¥åˆ†æç¬¬ä¸€åçš„é˜Ÿä¼çš„<a href="https://github.com/wepe/O2O-Coupon-Usage-Forecast" target="_blank" rel="external">é˜¿é‡Œå¤©æ± O2Oä¼˜æƒ åˆ¸æ¶ˆè´¹è¡Œä¸ºé¢„æµ‹ç«èµ›ä¼˜èƒœæ–¹æ¡ˆ</a>æºç ã€‚</p>
<p>=======2017.3.8======</p>
<p>ç®—æ˜¯å¤§è‡´çœ‹å®Œäº†å‰è¾ˆçš„ä»£ç ã€‚è§æœ¬åšå®¢æ–‡ç« â€œO2Oä¼˜æƒ åˆ¸é¢„æµ‹â€”â€”å¯¹ç¬¬ä¸€åçš„æ€è·¯æºç åˆ†æâ€</p>
<p>è¿™å…¶ä¸­çš„å¥¥å¦™æ·±ä¸å¯æµ‹ã€‚</p>
<p>çŸ¥è¯†ç´¯ç§¯ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚åŠ æ²¹å§ã€‚</p>
<p>=======2017.3.12======</p>
]]></content>
      
        <categories>
            
            <category> o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-SVM]]></title>
      <url>/2017/03/03/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-SVM/</url>
      <content type="html"><![CDATA[<h1 id="SVMç®€ä»‹">1. SVMç®€ä»‹</h1><p>SVM - Support Vector Machines, æ”¯æŒå‘é‡æœºã€‚æ˜¯äºŒåˆ†ç±»æ¨¡å‹ã€‚</p>
<h1 id="çº¿æ€§å¯åˆ†SVM">2. çº¿æ€§å¯åˆ†SVM</h1><h2 id="æ¦‚å¿µå¤ä¹ ">2.1. æ¦‚å¿µå¤ä¹ </h2><p><a href="http://blog.csdn.net/kaka19880812/article/details/46419269" target="_blank" rel="external">å‚è€ƒæ–‡çŒ®</a></p>
<p><em>è¾“å…¥ç©ºé—´</em>ï¼šè¾“å…¥æ‰€æœ‰å¯èƒ½çš„å–å€¼çš„é›†åˆ</p>
<p><em>ç‰¹å¾å‘é‡</em>ï¼šæ¯ä¸ªå…·ä½“çš„è¾“å…¥</p>
<p><em>ç‰¹å¾ç©ºé—´</em>ï¼šæ‰€æœ‰ç‰¹å¾å‘é‡å­˜åœ¨çš„ç©ºé—´ã€‚ç‰¹å¾ç©ºé—´å¯ä»¥æ˜¯è¾“å…¥ç©ºé—´ï¼Œä¹Ÿå¯ä»¥ç”±è¾“å…¥ç©ºé—´æ˜ å°„å¾—åˆ°ã€‚æ¨¡å‹å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šã€‚</p>
<p><em>è¾“å‡ºç©ºé—´</em>ï¼šè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„å–å€¼çš„é›†åˆ</p>
<h2 id="çº¿æ€§å¯åˆ†SVMå­¦ä¹ ç›®æ ‡">2.2. çº¿æ€§å¯åˆ†SVMå­¦ä¹ ç›®æ ‡</h2><p>åœ¨ç‰¹å¾ç©ºé—´æ‰¾åˆ°ä¸€ä¸ªåˆ†ç¦»è¶…å¹³é¢ $wx+b=0$ï¼Œå¹¶ä¸”é—´éš”æœ€å¤§ã€‚</p>
<h2 id="SVMä¸PLAåŒºåˆ«">2.3. SVMä¸PLAåŒºåˆ«</h2><p>PLA:è¯¯åˆ†ç±»æœ€å°ç­–ç•¥ï¼Œæ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ã€‚è§£ä¸å”¯ä¸€ã€‚<br>çº¿æ€§å¯åˆ†SVM:é—´éš”æœ€å¤§åŒ–ï¼Œæ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ã€‚è§£å”¯ä¸€ã€‚</p>
<h2 id="å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”">2.4. å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-13-44-02.png" alt=""> </p>
<ul>
<li>ä¸€ä¸ªç‚¹è·ç¦»åˆ†ç¦»è¶…å¹³é¢çš„è¿œè¿‘<code>|wx+b|</code> æ˜¯ åˆ†ç±»é¢„æµ‹çš„<strong>ç¡®ä¿¡ç¨‹åº¦</strong>ã€‚ä¾‹å¦‚å°†Aåˆ†ä¸º0çš„ç¡®ä¿¡åº¦å¾ˆé«˜ï¼Œè€Œå°†Cåˆ†ä¸º0çš„ç¡®ä¿¡åº¦è¾ƒä½</li>
<li><code>wx+b</code>ä¸<code>y</code>çš„ç¬¦å·ä¸€è‡´ï¼Œåˆ™åˆ†ç±»æ­£ç¡®</li>
<li><strong>å‡½æ•°é—´éš”</strong>ï¼š<code>y(wx+b)</code>ï¼Œè¡¨ç¤ºåˆ†ç±»çš„æ­£ç¡®æ€§åŠç¡®ä¿¡åº¦</li>
<li><strong>è¶…å¹³é¢çš„å‡½æ•°é—´éš”*</strong>ï¼š<code>min{y(wx+b)}</code></li>
<li><strong>å‡ ä½•é—´éš”</strong>ï¼šè§„èŒƒåŒ–<code>||w||=1</code>ï¼Œå³ä¸º$y(\frac{w}{||w||}\cdot x + \frac{b}{||w||})$ï¼Œä½¿å¾—é—´éš”å›ºå®šã€‚ï¼ˆå› ä¸ºwå’Œbæˆæ¯”ä¾‹å¢åŠ æ—¶ï¼Œè¶…å¹³é¢ä¸ä¼šæ”¹å˜ï¼Œä½†å‡½æ•°é—´éš”ä¼šå˜å¤§ï¼‰</li>
</ul>
<h1 id="SVMåŸºæœ¬ç®—æ³•">3. SVMåŸºæœ¬ç®—æ³•</h1><h2 id="æ ‡å‡†é—®é¢˜">3.1. æ ‡å‡†é—®é¢˜</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-14-56-13.png" alt=""> </p>
<h2 id="ç®—æ³•çš„æ¨å¯¼">3.2. ç®—æ³•çš„æ¨å¯¼</h2><ul>
<li>ä¸€å¼€å§‹çš„ç›®æ ‡æ˜¯ï¼š<br>â€“ ç›®æ ‡ï¼šæ±‚å¾—ä¸€ä¸ªxï¼Œä½¿å¾—marginæœ€å¤§<br>â€“ æ¡ä»¶ï¼š<br>â€” æ¯ä¸ªç‚¹éƒ½è¢«æ­£ç¡®åˆ†ç±»ï¼ˆ<code>b</code>è¢«å¡å…¥äº†<code>w</code>çŸ©é˜µé‡Œï¼‰<br>â€” maginæ˜¯æœ€è¿‘çš„ç‚¹çš„è·ç¦»<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-22-00.png" alt=""> </li>
</ul>
<ul>
<li><p>ä»è·ç¦»çš„ç†è§£å…¥æ‰‹ï¼Œå¦‚å›¾æ‰€ç¤º<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-07-16.png" alt=""> </p>
</li>
<li><p><code>w</code>çš„ç†è§£<br>â€“ ç°è‰²æ˜¯åˆ†å‰²å¹³é¢<br>â€“ $xâ€™$å’Œ$xâ€™â€™$æ˜¯å¹³é¢ä¸Šçš„ä¸¤ä¸ªç‚¹ï¼Œåˆ™å®ƒä¿©æ»¡è¶³$w^T Xâ€™ = -b$ï¼Œ$w^T xâ€™â€™ = -b$<br>â€“ ä¸¤å¼ç›¸å‡ï¼Œå¾—åˆ° $w^T(xâ€™â€™ - xâ€™)=0$<br>â€“ åˆ™<strong><code>w</code>å‚ç›´äºå¹³é¢</strong>ï¼Œå³wæ˜¯å¹³é¢çš„æ³•å‘é‡<br>â€“ é‚£ä¹ˆdistæ˜¯å‘é‡$xâ€™ xâ€™â€™$åœ¨<code>w</code>ä¸Šçš„æŠ•å½±</p>
</li>
</ul>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-15-32.png" alt=""> </p>
<ul>
<li><p>è€Œ<code>y(wx+b)&gt;0</code>ï¼Œåˆ™è·ç¦»å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-18-42.png" alt=""> </p>
</li>
<li><p>å› æ­¤ï¼Œæ–°çš„ç®—æ³•ç›®æ ‡ä¸º<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-19-57.png" alt=""> </p>
</li>
<li><p>å½’ä¸€åŒ–æ¡ä»¶ï¼š<code>margin=y(wx+b)=1</code>,å¾—åˆ°æ–°ç›®æ ‡<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-29-24.png" alt=""> </p>
</li>
<li><p>å¯¹ç›®æ ‡è¿›è¡Œæ”¾ç¼©ï¼Œæ–¹ä¾¿è§£<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-31-16.png" alt=""> </p>
</li>
<li><p>å†å°†æœ€å¤§åŒ–å˜ä¸ºæœ€å°åŒ–ï¼Œä¹Ÿæ‹¿èµ°||w||çš„æ ¹å·<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-33-31.png" alt=""> </p>
</li>
</ul>
<h3 id="æ”¯æŒå‘é‡">3.2.1. æ”¯æŒå‘é‡</h3><ul>
<li>åœ¨çº¿æ€§å¯åˆ†çš„æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ•°æ®é›†çš„æ ·æœ¬ç‚¹ä¸­ä¸åˆ†ç¦»è¶…å¹³é¢è·ç¦»æœ€è¿‘çš„æ ·æœ¬ç‚¹çš„å®ä¾‹ï¼Œå«åš<strong>æ”¯æŒå‘é‡</strong>ï¼ˆsupport vectorï¼‰</li>
<li>æ”¯æŒå‘é‡æ˜¯ä½¿å¾—çº¦æŸæ¡ä»¶ç­‰å·æˆç«‹çš„ç‚¹</li>
<li>å†³å®šåˆ†ç¦»è¶…å¹³é¢æ—¶ï¼Œåªæœ‰æ”¯æŒå‘é‡èµ·ä½œç”¨ï¼Œè€Œå…¶ä»–ç‚¹ä¸èµ·ä½œç”¨</li>
<li>åœ¨H1ï¼ŒH2ä¸Šçš„ç‚¹å°±æ˜¯æ”¯æ’‘å‘é‡ï¼ˆå¾ˆå°‘ï¼Œä½†å¾ˆé‡è¦çš„ç‚¹ï¼‰</li>
</ul>
<h3 id="é—´éš”-margin">3.2.2. é—´éš” margin</h3><p>H1ï¼ŒH2ä¹‹é—´ï¼Œ$margin=\frac{2}{||w||}$</p>
<h3 id="é—´éš”è¾¹ç•Œ">3.2.3. é—´éš”è¾¹ç•Œ</h3><p>H1ï¼ŒH2<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-15-06-02.png" alt=""> </p>
<h3 id="æ ‡å‡†é—®é¢˜çš„æ±‚è§£">3.2.4. æ ‡å‡†é—®é¢˜çš„æ±‚è§£</h3><ul>
<li>ç›®æ ‡æ˜¯äºŒæ¬¡çš„ï¼Œæ¡ä»¶æ˜¯çº¿æ€§çš„</li>
<li><p>åˆ™è¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œæœ‰å›ºå®šçš„è§£</p>
</li>
<li><p>æˆ‘ä»¬çš„æ ‡å‡†é—®é¢˜ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-47-03.png" alt=""> </p>
</li>
<li><p>æ ‡å‡†äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-47-26.png" alt=""> </p>
</li>
<li><p>ç³»æ•°ä»£å…¥ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-16-47-47.png" alt=""> </p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çº¿æ€§æ¨¡å‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-LR]]></title>
      <url>/2017/03/02/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-LR/</url>
      <content type="html"><![CDATA[<p>åœ¨è¯´LRä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹logisticåˆ†å¸ƒã€‚</p>
<h1 id="logisticåˆ†å¸ƒ">1. logisticåˆ†å¸ƒ</h1><p>å¦‚æœè¿ç»­éšæœºå˜é‡$X$æœä»logisticåˆ†å¸ƒï¼Œåˆ™$X$å…·æœ‰ä¸‹åˆ—<strong>åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°</strong>ï¼š</p>
<p>$$<br>F(x)=P(X&lt;=x)=\frac{1}{1+e^{-(x-u)/r}}<br>$$</p>
<p>$$<br>f(x)=Fâ€™(x)=\frac{e^{-(x-u)/r}}{r(1+e^{-(x-u)/r})^2}<br>$$</p>
<p>å…¶ä¸­</p>
<p>$u$ä¸ºä½ç½®å‚æ•°</p>
<p>$r&gt;0$ä¸ºå½¢çŠ¶å‚æ•°</p>
<p>å…¶ä¸­ï¼Œå¯†åº¦å‡½æ•°ä¸åˆ†å¸ƒå‡½æ•°çš„å½¢çŠ¶å¦‚å›¾æ‰€ç¤º<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-02-20-46-41.png" alt=""> </p>
<p><strong>å¤‡æ³¨ï¼šåˆ†å¸ƒå¯†åº¦å‡½æ•°ä¸åˆ†å¸ƒå‡½æ•°</strong></p>
<p>æ¦‚ç‡å¯†åº¦å‡½æ•°$f(x)$ï¼šè¡¨ç¤ºç¬æ—¶å€¼è½åœ¨æŸåŒºé—´çš„æ¦‚ç‡ï¼Œæ˜¯å¹…å€¼çš„æ¦‚ç‡ã€‚++ç”¨æ¥æè¿°è¿ç»­å‹éšæœºå˜é‡å–å€¼çš„å¯†é›†ç¨‹åº¦çš„ã€‚++$f(x)$è¡¨ç¤ºX=xçš„æ¦‚ç‡æ˜¯$\int_0^1f(x)$ã€‚</p>
<p>$P(X=x|x \in (0,1))=\int_0^1f(x)$</p>
<p>åˆ†å¸ƒå‡½æ•°$F(x)$ï¼šæè¿°éšæœºå˜é‡è½åœ¨ä»»ä¸€åŒºé—´çš„æ¦‚ç‡ã€‚</p>
<p>$F(x)=P(X&lt;=x)$</p>
<p>å…³ç³»ï¼š</p>
<p>åˆ†å¸ƒå‡½æ•°$F(x)$æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°$f(x)$ä»è´Ÿæ— ç©·åˆ°æ­£æ— ç©·ä¸Šçš„ç§¯åˆ†ï¼›</p>
<p>åœ¨åæ ‡è½´ä¸Šï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å‡½æ•°å€¼yè¡¨ç¤ºè½åœ¨xç‚¹ä¸Šçš„æ¦‚ç‡ä¸ºyï¼›åˆ†å¸ƒå‡½æ•°çš„å‡½æ•°å€¼yåˆ™è¡¨ç¤ºxè½åœ¨åŒºé—´(-âˆä¸Šçš„æ¦‚ç‡ã€‚</p>
<h1 id="äºŒé¡¹logisticå›å½’æ¨¡å‹">2. äºŒé¡¹logisticå›å½’æ¨¡å‹</h1><p><strong>ç”¨é€”ï¼šä¼°è®¡æŸä¸ªå€¼çš„ä¸ºå“ªä¸€ç±»çš„æ¦‚ç‡</strong></p>
<p>logisticå›å½’æ˜¯åˆ†ç±»é—®é¢˜ã€‚å‰é¢æˆ‘ä»¬è®²çš„åˆ†ç±»é—®é¢˜çš„è¾“å‡ºéƒ½æ˜¯ â€œyesâ€æˆ–è€…â€œnoâ€ã€‚ä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯æ€»æ˜¯å¸Œæœ›ç»“æœé‚£ä¹ˆè‚¯å®šï¼Œè€Œæ˜¯æ¦‚ç‡ï¼ˆå‘ç”Ÿçš„å¯èƒ½æ€§ï¼‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›çŸ¥é“è¿™ä¸ªæˆ¿å­åœ¨ç¬¬ä¸‰ä¸ªæ˜ŸæœŸè¢«å–å‡ºå»çš„æ¦‚ç‡ã€‚é‚£ä¹ˆä»¥å‰çš„åˆ†ç±»ç®—æ³•å°±æ— æ³•ä½¿ç”¨äº†ï¼Œè¿™æ—¶logistic å›å½’å°±æ´¾ä¸Šäº†ç”¨åœºã€‚ </p>
<p><strong>å®šä¹‰</strong></p>
<p>äºŒé¡¹logisticå›å½’æ¨¡å‹æ˜¯å¦‚ä¸‹çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒï¼š</p>
<p>$$<br>P(Y=1|x)=\frac{exp(wx+b)}{1+exp(wx+b)}<br>$$</p>
<p>$$<br>P(Y=0|x)=\frac{1}{1+exp(wx+b)}<br>$$</p>
<p>å…¶ä¸­ï¼š<br>$x \in R^n$ ï¼šè¾“å…¥</p>
<p>$Y \in (0,1)$ ï¼šè¾“å‡º</p>
<p>ç»™å®š$x$ï¼Œå¯ä»¥æ±‚å¾—$P(Y=1|x)$å’Œ$P(Y=0|x)$</p>
<p><strong>logisticå›å½’æ¨¡å‹çš„ç‰¹ç‚¹</strong></p>
<p>å‡ ç‡ï¼ˆoddsï¼‰= è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡/è¯¥äº‹ä»¶ä¸è¯¥å‘ç”Ÿçš„æ¦‚ç‡ï¼Œåˆ™å¯¹æ•°å‡ ç‡ï¼š</p>
<p>$$<br>log(odds)=log(\frac{p}{1-p})=log(\frac{P(Y=1|x)}{1-P(Y=1|x)})=wx<br>$$</p>
<p>åˆ™ï¼šè¾“å‡ºY=1çš„å¯¹æ•°å‡ ç‡=è¾“å…¥xçš„çº¿æ€§å‡½æ•°</p>
<h1 id="æ¨¡å‹å‚æ•°ä¼°è®¡">3. æ¨¡å‹å‚æ•°ä¼°è®¡</h1><p>è¾“å…¥ï¼š ä¸€å †ï¼ˆx,yï¼‰</p>
<p>ç›®æ ‡ï¼šä¼°è®¡å‚æ•°w,b</p>
<p>æ–¹æ³•ï¼šæå¤§ä¼¼ç„¶æ³•</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-02-21-35-03.png" alt=""> </p>
<h1 id="æ€»ç»“">4. æ€»ç»“</h1><ol>
<li>é€»è¾‘å›å½’æ˜¯ä¸€ç§é¢„æµ‹yçš„å„ç±»åˆ«çš„æ¦‚ç‡çš„æ¨¡å‹ï¼Œå³è®¡ç®—P(Y=1|x)æˆ–è€…P(Y=0|x)</li>
<li>ä¸æœºå™¨å­¦ä¹ è¿‡ç¨‹ç±»ä¼¼ï¼Œå³ é€šè¿‡å·²çŸ¥çš„å¤§é‡ï¼ˆx,yï¼‰ï¼Œæ‹Ÿåˆè®¡ç®—å‚æ•°w,bï¼›å†ç”¨y=wx+bæ¥è®¡ç®—æ–°çš„xä¸‹çš„yï¼›æŠŠyè¾“å…¥sigmoidå‡½æ•°ä¸­ï¼Œå¾—åˆ°yä¸º1çš„æ¦‚ç‡ã€‚</li>
</ol>
<h1 id="LRæ¨å¯¼ï¼ˆsigmoidï¼ŒæŸå¤±å‡½æ•°ï¼Œæ¢¯åº¦ï¼Œå‚æ•°æ›´æ–°å…¬å¼ï¼‰">5. LRæ¨å¯¼ï¼ˆsigmoidï¼ŒæŸå¤±å‡½æ•°ï¼Œæ¢¯åº¦ï¼Œå‚æ•°æ›´æ–°å…¬å¼ï¼‰</h1><p>è¿™ç¯‡æ–‡ç« éå¸¸è¯¦ç»†åœ°ä»‹ç»äº†é€»è¾‘å›å½’çš„æ¨å¯¼ã€‚éå¸¸æœ‰ç”¨ã€‚æˆ‘åœ¨æ­¤å¤„è¿›è¡Œäº†è½¬è½½ã€‚</p>
<h2 id="å£°æ˜">5.1. å£°æ˜</h2><ol>
<li>$ x(1),x(2),â€¦,x(m) $ è¡¨ç¤º n ç»´ç©ºé—´çš„ä¸€ä¸ªæ ·æœ¬ï¼Œ$x(i)$ è¡¨ç¤ºç¬¬iä¸ªæ ·æœ¬ï¼Œ$x(i)_j$ è¡¨ç¤ºç¬¬iä¸ªæ ·æœ¬çš„ç¬¬jç»´çš„æ•°æ®ï¼ˆå› ä¸º$x$æ˜¯ä¸€ä¸ªnç»´å‘é‡ï¼‰ã€‚</li>
<li>$y(1),y(2),â€¦,y(m)$ è¡¨ç¤º k ç»´ç©ºé—´çš„ä¸€ä¸ªè§‚æµ‹ç»“æœï¼Œè®°kä»1,2,â€¦,kå˜åŒ–ï¼Œå³åˆ†ç±»é—®é¢˜ä¸­çš„kä¸ªç±»åˆ«ï¼Œä¹Ÿå¯ä»¥0ä¸ºä¸‹æ ‡å¼€å§‹ï¼Œä¸å½±å“æ¨å¯¼ã€‚</li>
<li>$\pi()$æ˜¯æˆ‘ä»¬å­¦ä¹ åˆ°çš„æ¦‚ç‡å‡½æ•°ï¼Œå®ç°æ ·æœ¬æ•°æ®åˆ°é¢„æµ‹ç»“æœçš„æ˜ å°„ï¼š$R^n\rightarrow R^k$ï¼Œï¼ˆå…¶å®å°±æ˜¯æ ·æœ¬ç»è¿‡å‡½æ•° $\pi()$è®¡ç®—åå¾—åˆ°å„ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ï¼Œå³ä¸€ä¸ªkç»´å‘é‡ï¼‰ï¼Œ<br>$\pi(x)_uâ€‹$è¡¨ç¤ºæ•°æ®æ ·æœ¬xå±äºç±»åˆ«uçš„æ¦‚ç‡ï¼Œæˆ‘ä»¬å¸Œæœ›$\pi()â€‹$å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</li>
</ol>
<blockquote>
<ol>
<li>$\pi(x)_v&gt;0$  (æ ·æœ¬xå±äºç±»åˆ«vçš„æ¦‚ç‡å¤§äº0ï¼Œæ˜¾ç„¶æ¦‚ç‡å¿…é¡»å¤§äº0)</li>
<li>$\sum_{v=1}^k\pi(x)_v = 1$,æ ·æœ¬xå±äºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡å’Œä¸º1</li>
<li>$\pi(x(i))_{y(i)}åœ¨æ‰€æœ‰ç±»åˆ«æ¦‚ç‡ä¸­æœ€å¤§$</li>
</ol>
</blockquote>
<ol>
<li>$A(u,v)$æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå‡½æ•°ï¼Œ$å½“u=væ—¶A(u,v)=1ï¼Œå½“u\neq væ—¶A(u,v)=0ï¼Œå¦‚A(u,y(i))$è¡¨ç¤ºç¬¬iä¸ªè§‚æµ‹ç»“æœæ˜¯å¦ä¸ºu</li>
</ol>
<h2 id="é€»è¾‘å›å½’æ±‚è§£åˆ†ç±»é—®é¢˜è¿‡ç¨‹">5.2. é€»è¾‘å›å½’æ±‚è§£åˆ†ç±»é—®é¢˜è¿‡ç¨‹</h2><p>å¯¹äºäºŒåˆ†ç±»é—®é¢˜æœ‰k=2ï¼Œå¯¹çº¿æ€§å›å½’å‡½æ•°$\lambda x$è¿›è¡Œéçº¿æ€§æ˜ å°„å¾—åˆ°ï¼š</p>
<p>$$ \pi(x)_1 = \frac{\rm e^{\lambda \cdot x}}{\rm e^{\lambda \cdot x}+1}\tag{1} $$<br> $$ \pi(x)_2 = 1-\pi(x)_1= \frac{1}{\rm e^{\lambda \cdot x}+1}\tag{2} $$<br>å¯¹äºå¤šåˆ†ç±»é—®é¢˜æœ‰ï¼š<br> $$ \pi(x) = \frac{\rm e^{\lambda _v\cdot x}}{\sum_{u=1}^m\rm e^{\lambda_u \cdot x}}\tag{3} $$<br>å¯¹$\lambda$æ±‚åå¯¼å¯å¾—ï¼š</p>
<p>$$ \begin{aligned}<br>u = v æ—¶ï¼Œ<br>\frac {\partial\,\pi (x)_v}{\lambda_{v,j}} &amp;= \frac{x_j\rm e^{\lambda _{v,j}\cdot x}\cdot \sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x}-x_j\rm e^{\lambda _{v,j}\cdot x}\rm e^{\lambda _{v,j}\cdot x}}{(\sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x})^2}\\<br>&amp; = \frac{x_j\rm e^{\lambda _{v,j}\cdot x}}{\sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x}} \cdot \frac{\sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x}-\rm e^{\lambda_{v,j}\cdot x}}{\sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x}}\\&amp; = x_j \pi(x)_v(1-\pi(x)_v)\end{aligned}\tag{4} $$ </p>
<p>$$<br>\begin{aligned}<br>u \neq v æ—¶<br>\frac {\partial\,\pi (x)_v}{\lambda_{u,j}}&amp;=-\frac{\rm e^{\lambda_{v,j} \cdot x} \cdot (x_j\rm e^{\lambda_{u,j} \cdot x})}{(\sum_{u=1}^m\rm e^{\lambda_{u,j} \cdot x})^2} \\<br>&amp;= -x_j \pi(x)_v\pi(x)_u, u\neq væ—¶<br>\end{aligned}<br>\tag{5}<br>$$<br>è¯¥åˆ†ç±»é—®é¢˜çš„æœ€å¤§ä¼¼ç„¶å‡½æ•°ä¸ºï¼š<br> $$ L(\lambda)=\prod_{i=1}^m \pi(x(i))_{y(i)}\tag{6} $$<br>å–å¯¹æ•°å¾—ï¼š<br> $$ f(\lambda)=\log L(\lambda)=\sum_{i=1}^m \log(\pi(x(i))_{y(i)})\tag{7} $$<br>æ±‚ä¼¼ç„¶å‡½æ•°æœ€å¤§å€¼ï¼Œä»¤ï¼š<br>$$<br>\begin{aligned}<br>\frac{\partial\,f(\lambda)}{\partial \,\lambda_{u,j}} &amp;=\frac{\partial}{\partial \,\lambda_{u,j}}\sum_{i=1}^m \log(\pi(x(i))_{y(i)}) \\<br>&amp;= \sum_{i=1}^m \frac{1}{\pi(x(i))_{y(i)}}\frac{\partial}{\partial \,\lambda_{u,j}}\pi(x(i))_{y(i)} \\<br>&amp;= \sum_{\begin{array}{c}i=1,\\y(i)=u\end{array}}^m \frac{1}{\pi(x(i))_{y(i)}}\frac{\partial}{\partial \,\lambda_{u,j}}\pi(x(i))_{u} + \sum_{\begin{array}{c}i=1,\\y(i)\neq u\end{array}}^m \frac{1}{\pi(x(i))_{y(i)}}\frac{\partial}{\partial \,\lambda_{u,j}}\pi(x(i))_{y(i)}\\<br>&amp;= \sum_{\begin{array}{c}i=1,\\y(i)=u\end{array}}^m \frac{1}{\pi(x(i))_{y(i)}}x(i)_j\pi(x(i))_u(1-\pi(x(i))_u) \\<br>&amp;\quad - \sum_{\begin{array}{c}i=1,\\y(i)\neq u\end{array}}^m \frac{1}{\pi(x(i))_{y(i)}}x(i)_j\pi(x(i))_{y(i)} \pi(x(i))_u\\<br>&amp;= \sum_{\begin{array}{c}i=1,\\y(i)=u\end{array}}^m x(i)_j(1-\pi(x(i))_u)-\sum_{\begin{array}{c}i=1,\\y(i)\neq u\end{array}}^m x(i)_j \pi(x(i))_u \\<br>&amp;= \sum_{\begin{array}{c}i=1,\\y(i)=u\end{array}}^m x(i)_j - \sum_{i=1}^m x(i)_j\pi(x(i))_u \\<br>&amp;= 0<br>\end{aligned}<br>\tag{8}<br>$$<br>å¾—ï¼š<br> $$ \sum_{\begin{array}{c}i=1,\\y(i)=u\end{array}}^m x(i)_j = \sum_{i=1}^m x(i)_j\pi(x(i))_u\tag{9} $$<br>ä»£å…¥$A(u,y(i))=1$å¾—ï¼š<br> $$ \sum_{i=1}^m x(i)_j\pi(x(i))_u = \sum_{i=1}^m x(i)_jA(u,y(i))\tag{10} $$<br>ç»¼ä¸Šæœ‰ï¼š<br> $$ \frac{\partial\,f(\lambda)}{\partial \,\lambda_{u,j}}=\sum_{i=1}^m x(i)_j(A(u,y(i))-\pi(x(i))_u)\tag{11} $$<br>åˆ™å‚æ•°æ›´æ–°å…¬å¼ä¸ºï¼š</p>
<p>$$ \begin{aligned}\lambda_{u,j} &amp;= \lambda_{u,j} - \alpha \cdot \frac{\partial\,f(\lambda)}{\partial \,\lambda_{u,j}} \\&amp;= \lambda_{u,j} - \alpha \cdot \sum_{i=1}^m x(i)_j(A(u,y(i))-\pi(x(i))_u)\end{aligned}\tag{12} $$ </p>
<h2 id="sigmoidå‡½æ•°çš„ç”±æ¥ï¼ˆæœ€å¤§ç†µï¼‰">5.3. sigmoidå‡½æ•°çš„ç”±æ¥ï¼ˆæœ€å¤§ç†µï¼‰</h2><p>ç”±ä¸Šæ–‡å·²çŸ¥$\pi()$å…·åº”æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p>
<blockquote>
<ol>
<li>æ ·æœ¬xå±äºç±»åˆ«vçš„æ¦‚ç‡å¤§äº0ï¼Œæ˜¾ç„¶æ¦‚ç‡å¿…é¡»å¤§äº0$\pi(x)_v&gt;0\tag{13}$ </li>
<li>æ ·æœ¬xå±äºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡å’Œä¸º1 $\sum_{v=1}^k\pi(x)_v = 1\tag{14}$</li>
<li>$\pi(x(i))_{y(i)}åœ¨æ‰€æœ‰ç±»åˆ«æ¦‚ç‡ä¸­æœ€å¤§$</li>
</ol>
</blockquote>
<p>å…¶ä¸­å¯¹æœ€åä¸€ä¸ªæ¡ä»¶ç­‰ä»·äºå°½å¯èƒ½çš„è®©$\pi(x(i))\rightarrow y(i)$ å³ $\pi(x(i))\rightarrow A(u,y(i))$ï¼Œç†æƒ³æƒ…å†µä¸º$\pi(x(i))= A(u,y(i))$å›ºæœ‰ï¼š<br> $$ \sum_{i=1}^m x(i)_j\pi(x(i))_u = \sum_{i=1}^m x(i)_jA(u,y(i))\tag{15}ï¼Œå¯¹æ‰€æœ‰çš„uï¼Œjéƒ½æˆç«‹ $$ </p>
<p>å¯¹æ‰€æœ‰ç±»åˆ«åŠæ‰€æœ‰æ ·æœ¬å–$\pi()$çš„ç†µï¼Œå¾—ï¼š<br> $$ f(v,i)=-\sum_{v=1}^k\sum_{i=1}^m\pi(x(i))_v \log(\pi(x(i))_v)\tag{16} $$<br>å¾—åˆ°ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼š</p>
<p><img src="http://om1bxijvl.bkt.clouddn.com/2017-11-06-23-03-41.png" alt=""> </p>
<p>$$\left{<br>\begin{aligned}<br>max f(v,i)=max (-\sum_{v=1}^k \sum_{i=1}^m pi(x(i))_v log(Ï€(x(i))_v))\\<br>\pi(x)_v&gt;0\\<br>\sum_{v=1}^k Ï€(x)_v = 1\\<br>\sum_{i=1}^m x(i)_j Ï€(x(i))_u = \sum_{i=1}^m x(i)_j A(u,y(i))<br>\end{aligned}<br>\right.<br>\tag{17}$$<br>åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§æ±‚è¿™ä¸ªä¼˜åŒ–é—®é¢˜çš„å¯¹å¶é—®é¢˜ï¼Œé¦–å…ˆå¼•å…¥æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>
<p>$$ \begin{aligned}L &amp;= \sum_{j=1}^n\sum_{v=1}^k\lambda_{v,j} \left( \sum_{i=1}^m\pi(x(i))_vx(i)_j-A(v,y(i))x(i)_j \right)\\&amp;+ \sum_{v=1}^k\sum_{i=1}^m\beta_i(\pi(x(i))_v-1)\\&amp;- \sum_{v=1}^k\sum_{i=1}^m\pi(x(i))_v\log(\pi(x(i))_v)\end{aligned}\tag{18} $$<br>å…¶ä¸­ $$ \beta&lt;0 $$ ,ç”±KKTæ¡ä»¶æœ‰ï¼š<br>$$ \frac{\partial\,L}{\partial \,\pi(x(i))_u} = \lambda_u\cdot x(i)+\beta_i-\log(\pi(x(i))_u) - 1 = 0  \quadå¯¹æ‰€æœ‰i,u \tag{19}$$</p>
<p>$$åˆ™ï¼š\pi(x(i))_u = e^{\lambda_u \cdot x(i)+\beta_i-1} \tag{20}$$ </p>
<p>åˆ™ï¼š $$\pi(x(i))_u = e^{\lambda_u \cdot x(i)+\beta_i-1} \tag{20}$$<br>ç”±ï¼ˆ14ï¼‰å¼å¾—åˆ°ï¼š<br> $$  \sum_{v=1}^k e^{\lambda_u \cdot x(i)+\beta_i-1} = 1\ $$<br>å³ï¼š $$e^\beta=\frac{1}{\sum_{v=1}^ke^{\lambda_u \cdot x(i)-1}} \tag{21} $$<br>ä»£å…¥ï¼ˆ21ï¼‰å¼æ¶ˆå»å¸¸æ•°é¡¹å¾—ï¼š<br> $$ \pi(x(i))_u=\frac{e^{\lambda_u \cdot x}}{\sum_{v=1}^ke^{\lambda_u \cdot x}}\tag{22} $$<br>å³å¤šåˆ†ç±»é—®é¢˜å¯¹åº”çš„sigmoidå‡½æ•°</p>
<h1 id="å…¶å®ƒæ–‡çŒ®">6. å…¶å®ƒæ–‡çŒ®</h1><ol>
<li><a href="http://blog.csdn.net/cyh_24/article/details/50359055" target="_blank" rel="external">Logistic Regression çš„å‰ä¸–ä»Šç”Ÿï¼ˆç†è®ºç¯‡ï¼‰</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[SQLæ¸¸æ ‡]]></title>
      <url>/2017/03/02/SQL-SQL%E6%B8%B8%E6%A0%87/</url>
      <content type="html"><![CDATA[<h1 id="ç®€ä»‹">1. ç®€ä»‹</h1><h3 id="åœºæ™¯">1.0.1. åœºæ™¯</h3><p>ä»æŸä¸€ç»“æœé›†ä¸­åœ°é€ä¸€è¯»è®°å½•</p>
<h3 id="æ¸¸æ ‡æœ¬è´¨">1.0.2. æ¸¸æ ‡æœ¬è´¨</h3><p>èƒ½ä»åŒ…æ‹¬å¤šæ¡æ•°æ®è®°å½•çš„ç»“æœé›†ä¸­æ¯æ¬¡æå–ä¸€æ¡è®°å½•çš„æœºåˆ¶ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå®è´¨æ˜¯é¢å‘é›†åˆçš„ï¼Œåœ¨MS SQL SERVER ä¸­å¹¶æ²¡æœ‰ä¸€ç§æè¿°è¡¨ä¸­å•ä¸€è®°å½•çš„è¡¨è¾¾å½¢å¼ï¼Œé™¤éä½¿ç”¨where å­å¥æ¥é™åˆ¶åªæœ‰ä¸€æ¡è®°å½•è¢«é€‰ä¸­ã€‚å› æ­¤æˆ‘ä»¬å¿…é¡»å€ŸåŠ©äºæ¸¸æ ‡æ¥è¿›è¡Œé¢å‘å•æ¡è®°å½•çš„æ•°æ®å¤„ç†ã€‚</p>
<h3 id="æ¸¸æ ‡ç§ç±»">1.0.3. æ¸¸æ ‡ç§ç±»</h3><ul>
<li>Transact_SQL æ¸¸æ ‡</li>
<li>API æ¸¸æ ‡</li>
<li>å®¢æˆ·æ¸¸æ ‡</li>
</ul>
<h1 id="æ¸¸æ ‡æ“ä½œ">2. æ¸¸æ ‡æ“ä½œ</h1><p>ä½¿ç”¨æ¸¸æ ‡æœ‰å››ç§åŸºæœ¬çš„æ­¥éª¤:å£°æ˜æ¸¸æ ‡ã€æ‰“å¼€æ¸¸æ ‡ã€æå–æ•°æ®ã€å…³é—­æ¸¸æ ‡ã€‚</p>
<h3 id="å£°æ˜æ¸¸æ ‡">2.0.1. å£°æ˜æ¸¸æ ‡</h3><p>æ¸¸æ ‡çš„å£°æ˜åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†:æ¸¸æ ‡çš„åç§° + è¿™ä¸ªæ¸¸æ ‡æ‰€ç”¨åˆ°çš„SQLè¯­å¥ã€‚</p>
<p>ä¾‹ï¼šè¦å£°æ˜ä¸€ä¸ªå«ä½œCus-tomerCursorçš„æ¸¸æ ‡ç”¨ä»¥æŸ¥è¯¢åœ°å€åœ¨åŒ—äº¬çš„å®¢æˆ·çš„å§“åã€å¸å·åŠå…¶ä½™é¢: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">DECLARE CustomerCursor CURSOR FOR </div><div class="line">SELECT acct_no,name,balance </div><div class="line">FROM customer </div><div class="line">WHERE province=&quot;åŒ—äº¬&quot;;</div></pre></td></tr></table></figure>
<p>TIPS:</p>
<ul>
<li>å£°æ˜æ¸¸æ ‡çš„è¿™ä¸€æ®µä»£ç è¡Œæ˜¯ä¸æ‰§è¡Œçš„,ä¸èƒ½å°†debugæ—¶çš„æ–­ç‚¹è®¾åœ¨è¿™ä¸€ä»£ç è¡Œä¸Š,ä¹Ÿä¸èƒ½ç”¨IFè¯­å¥æ¥å£°æ˜ä¸¤ä¸ªåŒåçš„æ¸¸æ ‡,å¦‚ä¸‹åˆ—çš„ä»£ç å°±æ˜¯é”™è¯¯çš„ã€‚ </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">IF Is_prov=&quot;åŒ—äº¬&quot;THEN </div><div class="line">DECLARE CustomerCursor CURSOR FOR </div><div class="line">SELECT acct_no,name,balance </div><div class="line">FROM customer </div><div class="line">WHERE province=&quot;åŒ—äº¬&quot;; </div><div class="line">ELSE </div><div class="line">DECLARE CustomerCursor CURSOR FOR </div><div class="line">SELECT acct_no,name,balance </div><div class="line">FROM customer </div><div class="line">WHERE provinceã€ˆã€‰&quot;åŒ—äº¬&quot;; </div><div class="line">END IF</div></pre></td></tr></table></figure>
<h3 id="æ‰“å¼€æ¸¸æ ‡">2.0.2. æ‰“å¼€æ¸¸æ ‡</h3><p>æ‰“å¼€æ¸¸æ ‡æ˜¯æ‰§è¡Œä¸å…¶ç›¸å…³çš„ä¸€æ®µSQLè¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OPEN CustomerCursor;</div></pre></td></tr></table></figure>
<h3 id="æå–æ•°æ®">2.0.3. æå–æ•°æ®</h3><p>å¿…é¡»ç”¨FETCHè¯­å¥æ¥å–å¾—æ•°æ®ã€‚</p>
<p>ä¸€æ¡FETCHè¯­å¥ä¸€æ¬¡å¯ä»¥å°†ä¸€æ¡è®°å½•æ”¾å…¥ç¨‹åºå‘˜æŒ‡å®šçš„å˜é‡ä¸­ã€‚</p>
<p>äº‹å®ä¸Š,++FETCHè¯­å¥æ˜¯æ¸¸æ ‡ä½¿ç”¨çš„æ ¸å¿ƒ++ã€‚</p>
<h4 id="ç”¨æ¸¸æ ‡æå–ä¸€æ¡æ•°æ®">2.0.3.1. ç”¨æ¸¸æ ‡æå–ä¸€æ¡æ•°æ®:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">FETCH CustmerCur-sor </div><div class="line">INTO:ls_acct_no, </div><div class="line">    :ls_name, </div><div class="line">    :ll_balance;</div></pre></td></tr></table></figure>
<h4 id="ç”¨æ¸¸æ ‡éå†å¾ˆå¤šæ¡æ•°æ®ï¼š">2.0.3.2. ç”¨æ¸¸æ ‡éå†å¾ˆå¤šæ¡æ•°æ®ï¼š</h4><p>è€Œåœ¨å¤šæ•°æƒ…å†µä¸‹,æˆ‘ä»¬æ‰€æƒ³è¦ä½œçš„æ˜¯åœ¨æ•°æ®åº“ä¸­ä»ç¬¬ä¸€æ¡è®°å½•å¼€å§‹æå–,ä¸€ç›´åˆ°ç»“æŸã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è¦å°†æ¸¸æ ‡æå–æ•°æ®çš„è¯­å¥æ”¾åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…,ç›´è‡³å°†ç»“æœé›†ä¸­çš„å…¨éƒ¨æ•°æ®æå–å,è·³å‡ºå¾ªç¯åœˆã€‚</p>
<p><strong>é€šè¿‡æ£€æµ‹SQLCA.SQL-CODEçš„å€¼,å¯ä»¥å¾—çŸ¥æœ€åä¸€æ¡FETCHè¯­å¥æ˜¯å¦æˆåŠŸã€‚</strong></p>
<p>ä¸€èˆ¬,å½“SQLCODEå€¼ä¸º0æ—¶è¡¨æ˜ä¸€åˆ‡æ­£å¸¸,100è¡¨ç¤ºå·²ç»å–åˆ°äº†ç»“æœé›†çš„æœ«å°¾,è€Œå…¶å®ƒå€¼å‡è¡¨æ˜æ“ä½œå‡ºäº†é—®é¢˜,è¿™æ ·æˆ‘ä»¬å¯ä»¥ç¼–å†™ä»¥ä¸‹çš„ä»£ç : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">lb_continue=True </div><div class="line">ll_total=0 </div><div class="line">DO WHILE lb_continue </div><div class="line">    FETCH CustomerCur-sor </div><div class="line">    INTO:ls_acct_no, </div><div class="line">        :ls_name, </div><div class="line">        :ll_balance; </div><div class="line">    If sqlca.sqlcode=0 Then  #å¦‚æœSQLCA.SQL-CODE==0ï¼Œåˆ™ä¸€åˆ‡æ­£å¸¸</div><div class="line">        ll_total+=ll_balance </div><div class="line">    Else #è·³å‡ºå¾ªç¯</div><div class="line">        lb_continue=False </div><div class="line">    End If </div><div class="line">LOOP</div></pre></td></tr></table></figure>
<h3 id="å…³é—­æ¸¸æ ‡">2.0.4. å…³é—­æ¸¸æ ‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CLOSE CustomerCursor;</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨Whereå­å¥å­">2.0.5. ä½¿ç”¨Whereå­å¥å­</h3><p>æˆ‘ä»¬å¯ä»¥åŠ¨æ€åœ°å®šä¹‰æ¸¸æ ‡ä¸­çš„Whereå­å¥çš„å‚æ•°,ä¾‹å¦‚åœ¨æœ¬ä¾‹ä¸­æˆ‘ä»¬æ˜¯ç›´æ¥å®šä¹‰äº†æŸ¥è¯¢çœä»½æ˜¯åŒ—äº¬çš„è®°å½•,ä½†ä¹Ÿè®¸åœ¨åº”ç”¨ä¸­æˆ‘ä»¬è¦ä½¿ç”¨ä¸€ä¸ªä¸‹æ‹‰å¼åˆ—è¡¨æ¡†,ç”±ç”¨æˆ·æ¥é€‰æ‹©è¦æŸ¥è¯¢çš„çœä»½,æˆ‘ä»¬è¯¥æ€æ ·åšå‘¢?<br>æˆ‘ä»¬åœ¨å‰é¢æ›¾ç»æåˆ°è¿‡,DECLAREè¯­å¥çš„ä½œç”¨åªæ˜¯å®šä¹‰ä¸€ä¸ªæ¸¸æ ‡,åœ¨OPENè¯­å¥ä¸­è¿™ä¸ªæ¸¸æ ‡æ‰ä¼šçœŸæ­£åœ°è¢«æ‰§è¡Œã€‚äº†è§£äº†è¿™äº›,æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°è¿™æ ·çš„åŠŸèƒ½,åœ¨DECLAREçš„Whereå­å¥ä¸­åŠ å…¥å˜é‡ä½œå‚æ•°,å¦‚ä¸‹æ‰€ç¤º: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">DECLARE CustomerCursor CURSOR FOR </div><div class="line">SELCECT acct_no,name,balance </div><div class="line">FROM customer </div><div class="line">WHERE province=:ls_province; </div><div class="line">âˆ¥å®šä¹‰ls_provinceçš„å€¼ </div><div class="line">OPEN CustomerCursor;</div></pre></td></tr></table></figure>
<h3 id="æ¸¸æ ‡çš„ç±»å‹">2.0.6. æ¸¸æ ‡çš„ç±»å‹</h3><p>åŒå…¶å®ƒå˜é‡ä¸€æ ·,æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰æ¸¸æ ‡çš„è®¿é—®ç±»å‹:å…¨å±€ã€å…±äº«ã€å®ä¾‹æˆ–å±€éƒ¨,æ¸¸æ ‡å˜é‡çš„å‘½åè§„èŒƒå»ºè®®ä¹ŸåŒå…¶å®ƒå˜é‡ä¸€æ ·ã€‚ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">--å£°æ˜æ¸¸æ ‡</div><div class="line">declare my_cursor cursor keyset for select * from info</div><div class="line">--åˆ é™¤æ¸¸æ ‡èµ„æº</div><div class="line">deallocate my_cursor</div><div class="line">--æ‰“å¼€æ¸¸æ ‡,åœ¨æ¸¸æ ‡å…³é—­æˆ–åˆ é™¤å‰éƒ½æœ‰æ•ˆ</div><div class="line">open my_cursor</div><div class="line">--å…³é—­æ¸¸æ ‡</div><div class="line">close my_cursor</div><div class="line">--å£°æ˜å±€éƒ¨å˜é‡</div><div class="line">declare @id int,@name varchar(20),@address varchar(20)</div><div class="line">--å®šä½åˆ°æŒ‡å®šä½ç½®çš„è®°å½•</div><div class="line">fetch absolute 56488 from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div><div class="line">--å®šä½åˆ°å½“å‰è®°å½•ç›¸å¯¹ä½ç½®è®°å½•</div><div class="line">fetch relative -88 from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div><div class="line">--å®šä½åˆ°å½“å‰è®°å½•å‰ä¸€æ¡</div><div class="line">fetch prior from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div><div class="line">--å®šä½åˆ°å½“å‰è®°å½•åä¸€æ¡</div><div class="line">fetch next from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div><div class="line">--å®šä½åˆ°é¦–è®°å½•</div><div class="line">fetch first from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div><div class="line">--å®šä½åˆ°å°¾è®°å½•</div><div class="line">fetch last from my_cursor into @id,@name,@address</div><div class="line">select @id as id,@name as name,@address as address</div></pre></td></tr></table></figure>
<p>å®ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">use database1</div><div class="line">declare my_cursor cursor scroll dynamic</div><div class="line"> /**//*scrollè¡¨ç¤ºå¯éšæ„ç§»åŠ¨æ¸¸æ ‡æŒ‡é’ˆï¼ˆå¦åˆ™åªèƒ½å‘å‰ï¼‰ï¼Œdynamicè¡¨ç¤ºå¯ä»¥è¯»å†™æ¸¸æ ‡ï¼ˆå¦åˆ™æ¸¸æ ‡åªè¯»ï¼‰*/</div><div class="line">for</div><div class="line">select productname from  product</div><div class="line">open my_cursor</div><div class="line">declare @pname sysname</div><div class="line">fetch next from my_cursor into @pname</div><div class="line">while(@@fetch_status=0)</div><div class="line">  begin</div><div class="line">    print &apos;Product Name: &apos; + @pname</div><div class="line">    fetch next from my_cursor into @pname</div><div class="line">  end</div><div class="line">fetch first from my_cursor into @pname</div><div class="line">print @pname</div><div class="line">/**//*update product set productname=&apos;zzg&apos; where current of my_cursor */</div><div class="line">/**//*delete from product where current of my_cursor */</div><div class="line">close my_cursor</div><div class="line">deallocate my_cursor</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> SQL </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ä»å‡ºç§Ÿè½¦è¡Œé©¶æ•°æ®ç­›é€‰å‡ºODç‚¹æ•°æ®]]></title>
      <url>/2017/03/02/%E4%BB%8E%E5%87%BA%E7%A7%9F%E8%BD%A6%E8%A1%8C%E9%A9%B6%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89%E5%87%BAOD%E7%82%B9%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<p>åŠ¨æ‰‹å‰å…ˆåŠ¨è„‘ï¼Œè¿™å¥è¯çŒ®ç»™è‡ªå·±ã€‚</p>
<h2 id="ç›®æ ‡">0.1. ç›®æ ‡</h2><p>ä»å‡ºç§Ÿè½¦è¡Œé©¶æ•°æ®ä¸­ï¼Œç­›é€‰å‡ºODç‚¹ã€‚</p>
<h2 id="æ•°æ®é›†">0.2. æ•°æ®é›†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">åç§°ï¼š2012å¹´11æœˆ1æ—¥ åŒ—äº¬å¸‚å‡ºç§Ÿè½¦GPSæ•°æ®</div><div class="line"></div><div class="line">æ ¼å¼ï¼štxtæ–‡æœ¬æ–‡ä»¶</div><div class="line"></div><div class="line">æ•°æ®é¡¹åŠé¡ºåºï¼šè½¦è¾†æ ‡è¯†,è§¦å‘äº‹ä»¶,è¿è¥çŠ¶æ€,GPSæ—¶é—´,GPSç»åº¦,GPSçº¬åº¦,GPSé€Ÿåº¦,GPSæ–¹å‘,GPSçŠ¶æ€</div><div class="line">è½¦è¾†æ ‡è¯†ï¼š6ä¸ªå­—ç¬¦</div><div class="line">è§¦å‘äº‹ä»¶ï¼š0=å˜ç©ºè½¦ï¼Œ1=å˜è½½å®¢ï¼Œ2=è®¾é˜²ï¼Œ3=æ’¤é˜²ï¼Œ4=å…¶å®ƒ</div><div class="line">è¿è¥çŠ¶æ€ï¼š0=ç©ºè½¦ï¼Œ1=è½½å®¢ï¼Œ2=é©»è½¦ï¼Œ3=åœè¿ï¼Œ4=å…¶å®ƒ</div><div class="line">GPSæ—¶é—´</div><div class="line">GPSç»åº¦</div><div class="line">GPSçº¬åº¦</div><div class="line">GPSé€Ÿåº¦ï¼šå–å€¼000-255å†…æ•´æ•°ï¼Œä»¥å…¬é‡Œ/å°æ—¶ä¸ºå•ä½</div><div class="line">GPSæ–¹ä½ï¼šå–å€¼000-360å†…æ•´æ•°ï¼Œä»¥åº¦ä¸ºå•ä½</div><div class="line">GPSçŠ¶æ€ï¼š0=æ— æ•ˆï¼Œ1=æœ‰æ•ˆ</div><div class="line">ç»“æŸä¸²ï¼šå›è½¦ç¬¦+æ¢è¡Œç¬¦</div><div class="line"></div><div class="line">æ•°æ®ç¤ºä¾‹:</div><div class="line">123456,0,0,20110414160613,116.4078674,40.2220650,21,274,1</div></pre></td></tr></table></figure>
<h2 id="æ€è·¯">0.3. æ€è·¯</h2><ol>
<li>å°†æ•°æ®ç‚¹æŒ‰ç…§â€œè½¦ç‰Œå·ã€è¿è¥æ—¶é—´ã€è¿è¥çŠ¶æ€â€ä¾æ¬¡ä»å°åˆ°å¤§æ’åº</li>
<li>ç­›å‡ºåŒä¸€è½¦ç‰Œå·çš„è¿è¥çŠ¶æ€å˜åŒ–çš„æ—¶åˆ»çš„æ•°æ®</li>
</ol>
<h2 id="æ–¹æ³•">0.4. æ–¹æ³•</h2><ul>
<li><p>æ–¹æ³•ä¸€ï¼šå¯¼å…¥æ•°æ®åº“ï¼Œå†å†™è„šæœ¬æ“ä½œæ•°æ®ã€‚å¯èƒ½æ˜¯æˆ‘å¯¹æ•°æ®åº“å®åœ¨æ²¡ç¼˜åˆ†ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰æˆåŠŸã€‚</p>
</li>
<li><p>æ–¹æ³•äºŒï¼šå°†è½¦ç‰Œå·åˆ†æ®µåï¼Œåœ¨æ¯æ®µä¸Šè¿›è¡Œå¦‚ä¸Šæ€è·¯æ‰€ç¤ºçš„æ“ä½œã€‚</p>
</li>
</ul>
<p>ä¸ºäº†æ›´å¥½åœ°åˆ†æ®µï¼Œæˆ‘ä»¬å…ˆå¯¹è½¦ç‰Œå·æ®µè¿›è¡Œåˆ†æã€‚</p>
<h3 id="è½¦ç‰Œå·æ®µåˆ†æ">0.4.1. è½¦ç‰Œå·æ®µåˆ†æ</h3><p>æŸ¥è¯¢è½¦çš„æ•°ç›®ï¼š12409ä¸ª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT COUNT(DISTINCT id) FROM SET1</div></pre></td></tr></table></figure>
<p>è„šæœ¬åï¼šdata1IDcount.py</p>
<p>åœ°å€ï¼š81æœåŠ¡å™¨ä¸Šï¼ŒD:\jiayi\wxt</p>
<p>å¬è¯´æ•°æ®é›†æœ‰ä¸‰åƒå¤šä¸‡ï¼Œæ‰€ä»¥æˆ‘å†³å®šæ¯ä¸€åƒä¸ªæ•°æ®å–ä¸€æ¡è¿›è¡Œç²—ç•¥åˆ†æã€‚</p>
<p>è½¦ç‰Œå·åˆ†å¸ƒï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-01-15-01-24.png" alt=""> </p>
<p>ç»“æœï¼š</p>
<ol>
<li>è½¦ç‰Œå·åˆ†å¸ƒåœ¨1-800000ä¹‹é—´</li>
<li>100000-200000çš„è½¦æœ€å¤š</li>
<li>ä¸€å…±æœ‰32885600æ¡æ•°æ®</li>
</ol>
<h3 id="åˆ†æ®µ">0.4.2. åˆ†æ®µ</h3><p>è„šæœ¬åï¼šdata2cut.py</p>
<p>åˆ†æ®µæ³•ï¼šå°†è½¦ç‰Œå·åˆ†ä¸º10æ®µï¼Œå…¶ä¸­100000-200000ä¸ºä¸‰æ®µï¼Œå…¶ä½™æ®µå‡åˆ†ã€‚ <del>ç®€å•èµ·è§ï¼Œè¿˜æ˜¯å°†è½¦ç‰Œå·å‡åˆ†ä¸ºåæ®µäº†(ERROR:Errcode: 28 - No space left on device))</del></p>
<p>è¿˜æ˜¯é‡‡ç”¨äº†æ•°æ®åº“ã€‚æ˜¯ç¦ä¸æ˜¯ç¥¸ï¼Œæ˜¯ç¥¸èº²ä¸è¿‡å‘€ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-01-19-49-25.png" alt=""> </p>
<h3 id="ä¼ªä»£ç ">0.4.3. ä¼ªä»£ç </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">for i = 0:10000:800000</div><div class="line">    # ä¸ºæœ¬åŒºé—´æ•°æ®å»ºç«‹æ–°è¡¨ï¼Œå¹¶æ’å…¥æ•°æ®</div><div class="line">    CREATE TABLE to this range</div><div class="line">    INSERT data </div><div class="line">    #å°†æœ¬åŒºé—´æ•°æ®æ’åº</div><div class="line">    ORDER BY id,timen,opevent</div><div class="line">    #éå†ï¼Œç­›å‡ºæœ¬æ®µçš„ODç‚¹</div><div class="line">    for line in this range table</div><div class="line">    </div><div class="line">        #å¦‚æœæœ¬æ¡æ•°æ®æ˜¯è·³è·ƒç‚¹ï¼Œåˆ™æ’å…¥åˆ°ODè¡¨ä¸­</div><div class="line">        #vehicle:ä¸Šä¸€æ¡æ•°æ®çš„è½¦ç‰Œå·</div><div class="line">        #pre:ä¸Šä¸€æ¡æ•°æ®çš„opevent</div><div class="line">        </div><div class="line">        #ç¬¬ä¸€æ¡æ•°æ®</div><div class="line">        if vehicle==&quot;&quot;:</div><div class="line">            vehicle = row[0]</div><div class="line">            pre=row[2]</div><div class="line">        else:#ä»ç¬¬äºŒæ¡è®°å½•å¼€å§‹</div><div class="line">            # å¦‚æœä¸ä¸Šä¸€æ¡æ˜¯ä¸€ä¸ªè½¦</div><div class="line">            if vehicle==row[0]:</div><div class="line">                #å¦‚æœä¸ä¸Šä¸€æ¡è®°å½•æ˜¯åŒä¸€ä¸ªè½¦ï¼Œä¸”eventæœ‰å˜åŒ–</div><div class="line">                if pre!=row[2]:</div><div class="line">                    INSERT to OD_table</div><div class="line">                    pre=row[2]</div><div class="line">                    vehicle=row[0]</div><div class="line">                else:</div><div class="line">                    continue</div><div class="line">            #å¦‚æœä¸ä¸Šä¸€æ¡ä¸æ˜¯åŒä¸€ä¸ªè½¦</div><div class="line">            else:</div><div class="line">                vehicle=row[0]</div><div class="line">                pre=row[2]</div></pre></td></tr></table></figure>
<h3 id="ç»“æœ">0.4.4. ç»“æœ</h3><p>åŸå§‹æ•°æ®ï¼šdata.set1ï¼Œ32885600ä¸ª</p>
<p>ODç‚¹ï¼šdata.set1_od ,645271ä¸ª</p>
]]></content>
      
        
        <tags>
            
            <tag> æ•°æ®é¢„å¤„ç† </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ROCå’ŒAUC]]></title>
      <url>/2017/03/01/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5-O2O%E4%BC%98%E6%83%A0%E5%88%B8%E9%A2%84%E6%B5%8B-ROC%E5%92%8CAUC/</url>
      <content type="html"><![CDATA[<h3 id="AUCå®šä¹‰">0.0.1. AUCå®šä¹‰</h3><p>ç”¨é€”ï¼šç”¨æ¥åº¦é‡åˆ†ç±»æ¨¡å‹å¥½åçš„ä¸€ä¸ªæ ‡å‡†<br>èƒŒæ™¯ï¼š</p>
<ul>
<li>æœ‰äº›æ—¶å€™ï¼Œä»…ä»…ä¾é æ­£ç¡®ç‡æ˜¯ä¸å¦¥å½“çš„ã€‚</li>
<li>èƒ½å®¢è§‚åæ˜ å¯¹æ­£æ ·æœ¬ã€è´Ÿæ ·æœ¬ç»¼åˆé¢„æµ‹çš„èƒ½åŠ›ï¼Œè¿˜è¦è€ƒè™‘æ¶ˆé™¤æ ·æœ¬å€¾æ–œçš„å½±å“ã€‚</li>
</ul>
<h3 id="ROC">0.0.2. ROC</h3><ul>
<li>ROC:Receiver Operating Characteristic</li>
<li>ROCæ›²çº¿ï¼šæ¨ªåæ ‡æ˜¯false positive rate(FPR)ï¼Œçºµåæ ‡æ˜¯true positive rate(TPR)ã€‚</li>
<li>å¯¹æŸä¸ªåˆ†ç±»å™¨è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å…¶åœ¨æµ‹è¯•æ ·æœ¬ä¸Šçš„è¡¨ç°å¾—åˆ°ä¸€ä¸ªTPRå’ŒFPRç‚¹å¯¹ã€‚è¿™æ ·ï¼Œæ­¤åˆ†ç±»å™¨å°±å¯ä»¥æ˜ å°„æˆROCå¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ã€‚</li>
<li>è°ƒæ•´è¿™ä¸ªåˆ†ç±»å™¨åˆ†ç±»æ—¶å€™ä½¿ç”¨çš„é˜ˆå€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»è¿‡(0, 0)ï¼Œ(1, 1)çš„æ›²çº¿ï¼Œè¿™å°±æ˜¯æ­¤åˆ†ç±»å™¨çš„ROCæ›²çº¿ã€‚</li>
</ul>
<p>tipï¼šFPRå’ŒTPR<br>å…ˆæ¥çœ‹ä¸€ä¸ªæ™®éçš„äºŒåˆ†ç±»é—®é¢˜çš„ç»“æœï¼Œé¢„æµ‹å€¼å’Œå®é™…å€¼æœ‰4ç§ç»„åˆæƒ…å†µï¼Œçœ‹ä¸‹é¢çš„è¡¨æ ¼ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-22-18-05.png" alt=""><br>æˆ‘ä»¬å®šä¹‰<br>$$ TruePositiveRate(TPR) = \frac{TP}{TP+FN=P} = \frac{æ­£ç¡®é¢„æµ‹1}{æ­£ç¡®é¢„æµ‹1+é”™è¯¯é¢„æµ‹1=1çš„æ•°é‡}=å®é™…æ­£æ ·æœ¬æ­£ç¡®é¢„æµ‹çš„æ¯”ä¾‹$$<br>$$ FalsePositiveRate(FPR) = \frac{FP}{FP+TN=N} = \frac{é”™è¯¯é¢„æµ‹0}{é”™è¯¯é¢„æµ‹0+æ­£ç¡®é¢„æµ‹0=0çš„æ•°é‡}=å®é™…è´Ÿæ ·æœ¬é”™è¯¯é¢„æµ‹çš„æ¯”ä¾‹$$</p>
<h4 id="å¦‚ä½•ä¸€ä¸ªåˆ†ç±»å™¨çš„ç”»ROCæ›²çº¿">0.0.2.1. å¦‚ä½•ä¸€ä¸ªåˆ†ç±»å™¨çš„ç”»ROCæ›²çº¿</h4><p>æ¦‚ç‡è¾“å‡ºï¼šå³è¡¨ç¤ºåˆ†ç±»å™¨è®¤ä¸ºæŸä¸ªæ ·æœ¬å…·æœ‰å¤šå¤§çš„æ¦‚ç‡å±äºæ­£æ ·æœ¬ï¼ˆæˆ–è´Ÿæ ·æœ¬ï¼‰ï¼Œæ¥åŠ¨æ€è°ƒæ•´ä¸€ä¸ªæ ·æœ¬æ˜¯å¦å±äºæ­£è´Ÿæ ·æœ¬<br>ä¾‹ï¼š</p>
<ul>
<li>å›¾ä¸­å…±æœ‰20ä¸ªæµ‹è¯•æ ·æœ¬</li>
<li>â€œClassâ€ä¸€æ è¡¨ç¤ºæ¯ä¸ªæµ‹è¯•æ ·æœ¬çœŸæ­£çš„æ ‡ç­¾ï¼ˆpè¡¨ç¤ºæ­£æ ·æœ¬ï¼Œnè¡¨ç¤ºè´Ÿæ ·æœ¬ï¼‰</li>
<li>â€œScoreâ€è¡¨ç¤ºæ¯ä¸ªæµ‹è¯•æ ·æœ¬å±äºæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-22-38-47.png" alt=""><br>æ­¥éª¤ï¼š</li>
<li>ä»é«˜åˆ°ä½ï¼Œä¾æ¬¡å°†â€œScoreâ€å€¼ä½œä¸ºé˜ˆå€¼ï¼Œå½“æµ‹è¯•æ ·æœ¬å±äºæ­£æ ·æœ¬çš„æ¦‚ç‡å¤§äºæˆ–ç­‰äºè¿™ä¸ªé˜ˆå€¼æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä¸ºæ­£æ ·æœ¬ï¼Œå¦åˆ™ä¸ºè´Ÿæ ·æœ¬ã€‚</li>
<li>ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºå›¾ä¸­çš„ç¬¬4ä¸ªæ ·æœ¬ï¼Œå…¶â€œScoreâ€å€¼ä¸º0.6ï¼Œé‚£ä¹ˆæ ·æœ¬1ï¼Œ2ï¼Œ3ï¼Œ4éƒ½è¢«è®¤ä¸ºæ˜¯æ­£æ ·æœ¬ï¼Œå› ä¸ºå®ƒä»¬çš„â€œScoreâ€å€¼éƒ½å¤§äºç­‰äº0.6ï¼Œè€Œå…¶ä»–æ ·æœ¬åˆ™éƒ½è®¤ä¸ºæ˜¯è´Ÿæ ·æœ¬ã€‚</li>
<li>æ¯æ¬¡é€‰å–ä¸€ä¸ªä¸åŒçš„é˜ˆå€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ç»„FPRå’ŒTPRï¼Œå³ROCæ›²çº¿ä¸Šçš„ä¸€ç‚¹ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä¸€å…±å¾—åˆ°äº†20ç»„FPRå’ŒTPRçš„å€¼ï¼Œå°†å®ƒä»¬ç”»åœ¨ROCæ›²çº¿çš„ç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-22-39-56.png" alt=""> </li>
<li>å½“æˆ‘ä»¬å°†é˜ˆå€¼è®¾ç½®ä¸º1å’Œ0æ—¶ï¼Œåˆ†åˆ«å¯ä»¥å¾—åˆ°ROCæ›²çº¿ä¸Šçš„(0,0)å’Œ(1,1)ä¸¤ä¸ªç‚¹ã€‚å°†è¿™äº›(FPR,TPR)å¯¹è¿æ¥èµ·æ¥ï¼Œå°±å¾—åˆ°äº†ROCæ›²çº¿ã€‚</li>
<li>å½“é˜ˆå€¼å–å€¼è¶Šå¤šï¼ŒROCæ›²çº¿è¶Šå¹³æ»‘ã€‚</li>
</ul>
<h3 id="AUC">0.0.3. AUC</h3><ul>
<li>AUCçš„å€¼å°±æ˜¯å¤„äºROC curveä¸‹æ–¹çš„é‚£éƒ¨åˆ†é¢ç§¯çš„å¤§å°</li>
<li>é€šå¸¸ï¼ŒAUCçš„å€¼ä»‹äº0.5åˆ°1.0ä¹‹é—´</li>
<li>è¾ƒå¤§çš„AUCä»£è¡¨äº†è¾ƒå¥½çš„performance</li>
</ul>
<h4 id="è®¡ç®—AUCçš„æ–¹æ³•">0.0.3.1. è®¡ç®—AUCçš„æ–¹æ³•</h4><ul>
<li>ç›´æ¥è®¡ç®—AUCæ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ‰€ä»¥å°±ä½¿ç”¨äº†AUCçš„ä¸€ä¸ªæ€§è´¨ï¼ˆå®ƒå’ŒWilcoxon-Mann-Witney Testæ˜¯ç­‰ä»·çš„ï¼‰æ¥è¿›è¡Œè®¡ç®—ã€‚</li>
<li>Wilcoxon-Mann-Witney Testå°±æ˜¯æµ‹è¯•ä»»æ„ç»™ä¸€ä¸ªæ­£ç±»æ ·æœ¬å’Œä¸€ä¸ªè´Ÿç±»æ ·æœ¬ï¼Œæ­£ç±»æ ·æœ¬çš„scoreæœ‰å¤šå¤§çš„æ¦‚ç‡å¤§äºè´Ÿç±»æ ·æœ¬çš„scoreã€‚</li>
<li>æœ‰äº†è¿™ä¸ªå®šä¹‰ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¦å¤–ä¸€ä¸­è®¡ç®—AUCçš„åŠæ³•ï¼šå¾—åˆ°è¿™ä¸ªæ¦‚ç‡ã€‚</li>
</ul>
<h5 id="æ–¹æ³•ä¸€">0.0.3.1.1. æ–¹æ³•ä¸€</h5><p>ç»Ÿè®¡ä¸€ä¸‹æ‰€æœ‰çš„ MÃ—N(Mä¸ºæ­£ç±»æ ·æœ¬çš„æ•°ç›®ï¼ŒNä¸ºè´Ÿç±»æ ·æœ¬çš„æ•°ç›®)ä¸ªæ­£è´Ÿæ ·æœ¬å¯¹ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªç»„ä¸­çš„æ­£æ ·æœ¬çš„scoreå¤§äºè´Ÿæ ·æœ¬çš„scoreã€‚å½“äºŒå…ƒç»„ä¸­æ­£è´Ÿæ ·æœ¬çš„ scoreç›¸ç­‰çš„æ—¶å€™ï¼ŒæŒ‰ç…§0.5è®¡ç®—ã€‚ç„¶åé™¤ä»¥MNã€‚å®ç°è¿™ä¸ªæ–¹æ³•çš„å¤æ‚åº¦ä¸ºO(n^2)ã€‚nä¸ºæ ·æœ¬æ•°ï¼ˆå³n=M+Nï¼‰ã€‚<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-03-22-43-59.png" alt=""> </p>
<h5 id="æ–¹æ³•äºŒ">0.0.3.1.2. æ–¹æ³•äºŒ</h5><p>ç¬¬äºŒç§æ–¹æ³•å®é™…ä¸Šå’Œä¸Šè¿°æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¤æ‚åº¦å‡å°äº†ã€‚</p>
<ul>
<li>é¦–å…ˆå¯¹scoreä»å¤§åˆ°å°æ’åº</li>
<li>ç„¶åä»¤æœ€å¤§scoreå¯¹åº”çš„sample çš„rankä¸ºnï¼Œç¬¬äºŒå¤§scoreå¯¹åº”sampleçš„rankä¸ºn-1ï¼Œä»¥æ­¤ç±»æ¨</li>
<li>ç„¶åæŠŠæ‰€æœ‰çš„æ­£ç±»æ ·æœ¬çš„rankç›¸åŠ ï¼Œå†å‡å»æ­£ç±»æ ·æœ¬çš„scoreä¸ºæœ€å°çš„é‚£Mä¸ªå€¼çš„æƒ…å†µã€‚</li>
<li>å¾—åˆ°çš„å°±æ˜¯æ‰€æœ‰çš„æ ·æœ¬ä¸­æœ‰å¤šå°‘å¯¹æ­£ç±»æ ·æœ¬çš„scoreå¤§äºè´Ÿç±»æ ·æœ¬çš„scoreã€‚</li>
<li>ç„¶åå†é™¤ä»¥MÃ—Nã€‚å³<br><code>AUC=((æ‰€æœ‰çš„æ­£ä¾‹ä½ç½®ç›¸åŠ )-M*(M+1))/(M*N)</code></li>
</ul>
<p>å¦å¤–ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå†å­˜åœ¨scoreç›¸ç­‰çš„æƒ…å†µæ—¶ï¼Œå¯¹ç›¸ç­‰scoreçš„æ ·æœ¬ï¼Œéœ€è¦ èµ‹äºˆç›¸åŒçš„rank(æ— è®ºè¿™ä¸ªç›¸ç­‰çš„scoreæ˜¯å‡ºç°åœ¨åŒç±»æ ·æœ¬è¿˜æ˜¯ä¸åŒç±»çš„æ ·æœ¬ä¹‹é—´ï¼Œéƒ½éœ€è¦è¿™æ ·å¤„ç†)ã€‚å…·ä½“æ“ä½œå°±æ˜¯å†æŠŠæ‰€æœ‰è¿™äº›scoreç›¸ç­‰çš„æ ·æœ¬ çš„rankå–å¹³å‡ã€‚ç„¶åå†ä½¿ç”¨ä¸Šè¿°å…¬å¼ã€‚</p>
<h3 id="å‚è€ƒæ–‡çŒ®">0.0.4. å‚è€ƒæ–‡çŒ®</h3><ol>
<li><a href="https://www.zybuluo.com/frank-shaw/note/152851" target="_blank" rel="external">è¯„ä»·åˆ†ç±»å™¨æ€§èƒ½æŒ‡æ ‡ä¹‹AUCã€ROC</a></li>
<li><a href="http://www.cnblogs.com/lixiaolun/p/4053499.html" target="_blank" rel="external">AUC(Area Under roc Curve)å­¦ä¹ ç¬”è®°</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> o2oä¼˜æƒ åˆ¸ä½¿ç”¨é¢„æµ‹ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®—æ³•-PLA-çº¿æ€§æ„ŸçŸ¥æœº]]></title>
      <url>/2017/02/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-PLA-%E7%BA%BF%E6%80%A7%E6%84%9F%E7%9F%A5%E6%9C%BA/</url>
      <content type="html"><![CDATA[<p>æ„Ÿè§‰è‡ªå·±è®°æ€§è¶Šæ¥è¶Šå·®ã€‚å¯’å‡å‰çœ‹çš„ä¸œè¥¿ï¼Œå›æ¥å¿˜å¾—ä¸€å¹²äºŒå‡€ã€‚ä»æ­¤è®¤çœŸåšç¬”è®°ï¼Œä¸èƒ½å†é‡è¹ˆè¦†è¾™ã€‚â€”â€”é¢˜è®°<br>ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨markdownï¼Œä¸å¤ªä¹ æƒ¯ï¼Œåé¢çš„å…¬å¼æ²¡æœ‰ç»§ç»­æ‰“ã€‚ç°åœ¨å»å­¦ä¹ ä¸€ä¸‹å¥½ç”¨ä¸€äº›çš„å…¬å¼ç¼–è¾‘æ–¹æ³•ï¼‰</p>
<h1 id="ç®€ä»‹">1. ç®€ä»‹</h1><p>å®šä¹‰ï¼šæ„ŸçŸ¥æœºæ˜¯äºŒç±»åˆ†ç±»çš„çº¿æ€§æ¨¡å‹ã€‚</p>
<p>è¾“å…¥ï¼šå®ä¾‹çš„ç‰¹å¾å‘é‡</p>
<p>è¾“å‡ºï¼šå®ä¾‹çš„ç±»åˆ«ï¼ˆÂ±1ï¼‰</p>
<h1 id="æ„ŸçŸ¥æœºæ¨¡å‹">2. æ„ŸçŸ¥æœºæ¨¡å‹</h1><p>æ„ŸçŸ¥æœºâ€”â€”ç”±è¾“å…¥ç©ºé—´åˆ°è¾“å‡ºç©ºé—´çš„å‡½æ•°ï¼š</p>
<p>$$<br>f(x)=sign(wx+b)<br>$$</p>
<p>###Tips:<br>$ w \in R^n $ï¼šæƒå€¼ï¼Œweight<br>$ b \in R $ï¼šåå€¼ï¼Œbias<br>è¾“å…¥ç©ºé—´ï¼ˆç‰¹å¾ç©ºé—´ï¼‰ï¼š$ X \in R^n $<br>è¾“å‡ºç©ºé—´ï¼š$ y={+1,-1} $<br>è¾“å…¥ï¼š$ x \in X $è¡¨ç¤ºå®ä¾‹çš„ç‰¹å¾å‘é‡ï¼Œå¯¹åº”äºè¾“å…¥ç©ºé—´çš„ç‚¹<br>è¾“å‡ºï¼š$ y \in Y $ï¼Œè¡¨ç¤ºå®ä¾‹çš„ç±»åˆ«</p>
<h1 id="æ„ŸçŸ¥æœºå­¦ä¹ ç­–ç•¥">3. æ„ŸçŸ¥æœºå­¦ä¹ ç­–ç•¥</h1><ol>
<li>æ„ŸçŸ¥æœºå­¦ä¹ ç›®æ ‡ï¼šæ±‚å¾—ä¸€ä¸ªèƒ½å°†è®­ç»ƒé›†æ­£å®ä¾‹ç‚¹å’Œè´Ÿå®ä¾‹ç‚¹å®Œå…¨æ­£ç¡®åˆ†å¼€çš„åˆ†ç¦»è¶…å¹³é¢ = ç¡®å®šæ¨¡å‹å‚æ•°w,bã€‚</li>
<li>æ„ŸçŸ¥æœºå­¦ä¹ ç­–ç•¥ï¼šå®šä¹‰ï¼ˆç»éªŒï¼‰æŸå¤±å‡½æ•°å¹¶å°†æŸå¤±å‡½æ•°æå°åŒ–ã€‚</li>
<li>æŸå¤±å‡½æ•°çš„é€‰æ‹©ï¼š</li>
</ol>
<ul>
<li>ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ä¸­ä»‹ç»åˆ°çš„æŸå¤±å‡½æ•°ï¼šæ‰€æœ‰è¯¯åˆ†ç±»ç‚¹åˆ°è¶…å¹³é¢Sçš„æ€»è·ç¦»ï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-02-27-22-03-00.png" alt=""><br>ä¸€èˆ¬ä¸è€ƒè™‘w,å³æŸå¤±å‡½æ•°ä¸ºï¼š<img src="http://om1bxijvl.bkt.clouddn.com/2017-02-27-22-05-23.png" alt=""><br>M:è¯¯åˆ†ç±»ç‚¹çš„ä¸ªæ•°</li>
<li>ã€Šè¥¿ç“œä¹¦ã€‹é‡Œæåˆ°çš„è¯¯å·®æ˜¯å‡æ–¹è¯¯å·®ï¼š<img src="https://ooo.0o0.ooo/2017/07/11/59648c8143357.png" alt=""><br>ç„¶åç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£w,bã€‚</li>
</ul>
<ol>
<li>è¯¯åˆ†ç±»ç‚¹è¶Šå°‘ï¼ŒæŸå¤±å‡½æ•°è¶Šå°ã€‚</li>
</ol>
<p><strong>å°†æ„ŸçŸ¥æœºå­¦ä¹ é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£æŸå¤±å‡½æ•°æœ€ä¼˜åŒ–é—®é¢˜</strong><br>â€‹    </p>
<h1 id="æ„ŸçŸ¥æœºå­¦ä¹ ç®—æ³•">4. æ„ŸçŸ¥æœºå­¦ä¹ ç®—æ³•</h1><h2 id="æ„ŸçŸ¥æœºå­¦ä¹ ç®—æ³•çš„åŸå§‹å½¢å¼">4.1. æ„ŸçŸ¥æœºå­¦ä¹ ç®—æ³•çš„åŸå§‹å½¢å¼</h2><p><img src="http://om1bxijvl.bkt.clouddn.com/2017-02-27-22-06-33.png" alt=""> </p>
<h2 id="ç®—æ³•çš„æ”¶æ•›æ€§">4.2. ç®—æ³•çš„æ”¶æ•›æ€§</h2>]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çº¿æ€§æ¨¡å‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¸ƒç½®å®Œæ¯•]]></title>
      <url>/2017/02/28/blog-%E5%B8%83%E7%BD%AE%E5%AE%8C%E6%AF%95/</url>
      <content type="html"><![CDATA[<p>å¯ç®—æ˜¯æŠŠåšå®¢å¸ƒç½®å¾—å·®ä¸å¤šäº†ã€‚è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½å¾…å®Œå–„ï¼Œå…ˆè®°ä¸‹æ¥ï¼Œæ—¥åå†è¯´ã€‚</p>
<p>1.RSSè®¢é˜…åŠŸèƒ½</p>
<p>2.æ–°æµªå¾®åšåœˆ</p>
<p>3.æœç´¢åŠŸèƒ½</p>
<p>4.è¯„è®ºåŠŸèƒ½</p>
<p>5.è®¿é—®é‡ç»Ÿè®¡</p>
<p>6.æ•°å­¦å…¬å¼æ”¯æŒã€‚å·²è§£å†³ã€‚<a href="https://weylmann.github.io/2017/02/21/%E7%94%A8github-hexo-mathjax-%E9%83%A8%E7%BD%B2%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" target="_blank" rel="external">å‚è€ƒæ–‡çŒ®ï¼Œç¨‹æ•°çš„åšå®¢</a></p>
<p>7.å›¾ç‰‡ä¸€é”®ä¸Šä¼ åˆ°å›¾åºŠï¼Œå·²è§£å†³ã€‚<a href="https://github.com/kingname/MarkdownPicPicker" target="_blank" rel="external">å‚è€ƒæ–‡çŒ®MarkdownPicPicker-master</a></p>
<p>8.sublime text<a href="http://jingyan.baidu.com/article/f006222838bac2fbd2f0c87d.html" target="_blank" rel="external">ç¼–è¾‘md</a>ã€‚<a href="http://www.cnblogs.com/Richard-Core/p/Sublime-MarkDown.html" target="_blank" rel="external">WEBå®æ—¶åˆ·æ–°</a>ã€‚<a href="https://packagecontrol.io/packages/auto-save" target="_blank" rel="external">sublimeå®æ—¶ä¿å­˜</a></p>
<ol>
<li><a href="https://github.com/HarleyWang93/blog/issues/26" target="_blank" rel="external">ç«™é•¿ç»Ÿè®¡</a></li>
<li><a href="https://zetaoyang.github.io/post/2016/07/08/hexo-localsearch.html" target="_blank" rel="external">æœç´¢å¼•æ“</a></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">9.ä¸€é”®å‘å¸ƒåŠŸèƒ½[å·²è§£å†³](http://blog.csdn.net/anonymalias/article/details/50528946)</div><div class="line"></div><div class="line">10.[ä¸ºHexoåšå®¢æ ‡é¢˜è‡ªåŠ¨æ·»åŠ åºå·ï¼šhexo-heading-index](http://www.qingpingshan.com/jianzhan/cms/212734.html)</div></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> çæŠ˜è…¾ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœºå™¨å­¦ä¹ ç®€ä»‹]]></title>
      <url>/2017/02/27/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%80%E4%BB%8B/</url>
      <content type="html"><![CDATA[<p>å¾ˆå¤šä¸œè¥¿çœ‹äº†å°±å¿˜ã€‚ä¸€å®šè¦å¥½å¥½åšç¬”è®°ã€‚</p>
<p>æœ¬èŠ‚ä¸»è¦è®°å½•ã€Šæœºå™¨å­¦ä¹ åŸºçŸ³ã€‹çš„å¸¸è§ç¬¦å·ã€‚</p>
<h1 id="åŸºç¡€ç¬¦å·">1. åŸºç¡€ç¬¦å·</h1><p>è¾“å…¥ï¼š $ x \in X $<br>è¾“å‡ºï¼š $y \in Y $<br>ç›®æ ‡å‡½æ•°ï¼š $f:X\rightarrow Y $ ï¼ˆç†æƒ³ä¸­çš„ï¼Œå®é™…å¾—ä¸åˆ°ï¼‰<br>å‡è®¾å‡½æ•°ï¼š$g:X\rightarrow Y $ ï¼Œåˆç§°ä¸º<code>hypothesis</code>ï¼ˆå­¦ä¹ åˆ°çš„gï¼Œå¸Œæœ›è·Ÿfè¶Šåƒè¶Šå¥½ï¼‰<br>$g \in H $<br>å‡è®¾å‡½æ•°é›†åˆï¼š$H = \{h_k\} $ <code>hypothesis set</code><br>è®­ç»ƒé›†ï¼š$D=\{(x_1,y_1),â€¦,(x_N,y_N)\}$<br>æœºå™¨å­¦ä¹ æ¼”ç®—æ³•ï¼š$A$</p>
<h1 id="æœºå™¨å­¦ä¹ æµç¨‹">2. æœºå™¨å­¦ä¹ æµç¨‹</h1><ul>
<li>ä»æ•°æ®é›†Då‡ºå‘</li>
<li>é€šè¿‡æ¼”ç®—æ³•Aï¼Œæ¥è®¡ç®—å‡ºä¸€ä¸ªgï¼Œä½¿å¾—gå¾ˆæ¥è¿‘f<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-19-09-29.png" alt=""> </li>
</ul>
<h1 id="è¯¯å·®E">3. è¯¯å·®E</h1><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆå…¬å¼æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œåªå¥½æ‰‹åŠ¨å±•å›¾äº†<br>è¾“å…¥è¯¯å·®ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-44-49.png" alt=""> </p>
<p>$$E_{in}(h)=\frac{1}{N} \sum_{n=1}^N(h(x_n)-y_n)^2$$</p>
<ul>
<li>æ ·æœ¬ï¼ˆè®­ç»ƒé›†ï¼‰ä¸­å‡ºç°çš„é”™è¯¯ç‡</li>
</ul>
<p>è¾“å‡ºè¯¯å·®ï¼š<br><img src="http://om1bxijvl.bkt.clouddn.com/2017-03-04-20-45-03.png" alt=""> </p>
<p>$$E_{out}(h)=\mathcal{E}_{(x,y)\text~P}(w^Tx-y)^2$$</p>
<ul>
<li>æ€»ä½“ï¼ˆæµ‹è¯•é›†+è®­ç»ƒé›†ï¼‰ä¸­å‡ºç°çš„é”™è¯¯ç‡</li>
</ul>
]]></content>
      
        <categories>
            
            <category> æœºå™¨å­¦ä¹ ç®—æ³• </category>
            
        </categories>
        
        
    </entry>
    
  
  
</search>
